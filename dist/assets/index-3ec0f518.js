var WI=Object.defineProperty;var ZI=(e,t,i)=>t in e?WI(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i;var YI=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports);var ei=(e,t,i)=>(ZI(e,typeof t!="symbol"?t+"":t,i),i);var R$=YI((Z$,cC)=>{(function(){try{var e=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},t=new Error().stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="f3069ae2-49ec-4e15-bed7-10be79b7e890",e._sentryDebugIdIdentifier="sentry-dbid-f3069ae2-49ec-4e15-bed7-10be79b7e890")}catch{}})();(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const u of document.querySelectorAll('link[rel="modulepreload"]'))a(u);new MutationObserver(u=>{for(const d of u)if(d.type==="childList")for(const p of d.addedNodes)p.tagName==="LINK"&&p.rel==="modulepreload"&&a(p)}).observe(document,{childList:!0,subtree:!0});function i(u){const d={};return u.integrity&&(d.integrity=u.integrity),u.referrerPolicy&&(d.referrerPolicy=u.referrerPolicy),u.crossOrigin==="use-credentials"?d.credentials="include":u.crossOrigin==="anonymous"?d.credentials="omit":d.credentials="same-origin",d}function a(u){if(u.ep)return;u.ep=!0;const d=i(u);fetch(u.href,d)}})();function Oy(e,t){const i=Object.create(null),a=e.split(",");for(let u=0;u<a.length;u++)i[a[u]]=!0;return t?u=>!!i[u.toLowerCase()]:u=>!!i[u]}const ri={},Mc=[],$s=()=>{},XI=()=>!1,KI=/^on[^a-z]/,Yp=e=>KI.test(e),By=e=>e.startsWith("onUpdate:"),Ai=Object.assign,Fy=(e,t)=>{const i=e.indexOf(t);i>-1&&e.splice(i,1)},JI=Object.prototype.hasOwnProperty,Mn=(e,t)=>JI.call(e,t),en=Array.isArray,Dc=e=>Xp(e)==="[object Map]",$w=e=>Xp(e)==="[object Set]",cn=e=>typeof e=="function",Ei=e=>typeof e=="string",Ny=e=>typeof e=="symbol",ni=e=>e!==null&&typeof e=="object",Vw=e=>ni(e)&&cn(e.then)&&cn(e.catch),jw=Object.prototype.toString,Xp=e=>jw.call(e),QI=e=>Xp(e).slice(8,-1),Gw=e=>Xp(e)==="[object Object]",Uy=e=>Ei(e)&&e!=="NaN"&&e[0]!=="-"&&""+parseInt(e,10)===e,rp=Oy(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),Kp=e=>{const t=Object.create(null);return i=>t[i]||(t[i]=e(i))},ek=/-(\w)/g,Cs=Kp(e=>e.replace(ek,(t,i)=>i?i.toUpperCase():"")),tk=/\B([A-Z])/g,Jc=Kp(e=>e.replace(tk,"-$1").toLowerCase()),Qc=Kp(e=>e.charAt(0).toUpperCase()+e.slice(1)),Gg=Kp(e=>e?`on${Qc(e)}`:""),$h=(e,t)=>!Object.is(e,t),sp=(e,t)=>{for(let i=0;i<e.length;i++)e[i](t)},gp=(e,t,i)=>{Object.defineProperty(e,t,{configurable:!0,enumerable:!1,value:i})},y_=e=>{const t=parseFloat(e);return isNaN(t)?e:t},nk=e=>{const t=Ei(e)?Number(e):NaN;return isNaN(t)?e:t};let Gx;const v_=()=>Gx||(Gx=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function $y(e){if(en(e)){const t={};for(let i=0;i<e.length;i++){const a=e[i],u=Ei(a)?ak(a):$y(a);if(u)for(const d in u)t[d]=u[d]}return t}else{if(Ei(e))return e;if(ni(e))return e}}const ik=/;(?![^(]*\))/g,rk=/:([^]+)/,sk=/\/\*[^]*?\*\//g;function ak(e){const t={};return e.replace(sk,"").split(ik).forEach(i=>{if(i){const a=i.split(rk);a.length>1&&(t[a[0].trim()]=a[1].trim())}}),t}function Jp(e){let t="";if(Ei(e))t=e;else if(en(e))for(let i=0;i<e.length;i++){const a=Jp(e[i]);a&&(t+=a+" ")}else if(ni(e))for(const i in e)e[i]&&(t+=i+" ");return t.trim()}const ok="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",lk=Oy(ok);function qw(e){return!!e||e===""}const Ui=e=>Ei(e)?e:e==null?"":en(e)||ni(e)&&(e.toString===jw||!cn(e.toString))?JSON.stringify(e,Hw,2):String(e),Hw=(e,t)=>t&&t.__v_isRef?Hw(e,t.value):Dc(t)?{[`Map(${t.size})`]:[...t.entries()].reduce((i,[a,u])=>(i[`${a} =>`]=u,i),{})}:$w(t)?{[`Set(${t.size})`]:[...t.values()]}:ni(t)&&!en(t)&&!Gw(t)?String(t):t;let ss;class Ww{constructor(t=!1){this.detached=t,this._active=!0,this.effects=[],this.cleanups=[],this.parent=ss,!t&&ss&&(this.index=(ss.scopes||(ss.scopes=[])).push(this)-1)}get active(){return this._active}run(t){if(this._active){const i=ss;try{return ss=this,t()}finally{ss=i}}}on(){ss=this}off(){ss=this.parent}stop(t){if(this._active){let i,a;for(i=0,a=this.effects.length;i<a;i++)this.effects[i].stop();for(i=0,a=this.cleanups.length;i<a;i++)this.cleanups[i]();if(this.scopes)for(i=0,a=this.scopes.length;i<a;i++)this.scopes[i].stop(!0);if(!this.detached&&this.parent&&!t){const u=this.parent.scopes.pop();u&&u!==this&&(this.parent.scopes[this.index]=u,u.index=this.index)}this.parent=void 0,this._active=!1}}}function pd(e){return new Ww(e)}function ck(e,t=ss){t&&t.active&&t.effects.push(e)}function Zw(){return ss}function Wr(e){ss&&ss.cleanups.push(e)}const Vy=e=>{const t=new Set(e);return t.w=0,t.n=0,t},Yw=e=>(e.w&Co)>0,Xw=e=>(e.n&Co)>0,uk=({deps:e})=>{if(e.length)for(let t=0;t<e.length;t++)e[t].w|=Co},hk=e=>{const{deps:t}=e;if(t.length){let i=0;for(let a=0;a<t.length;a++){const u=t[a];Yw(u)&&!Xw(u)?u.delete(e):t[i++]=u,u.w&=~Co,u.n&=~Co}t.length=i}},_p=new WeakMap;let Sh=0,Co=1;const x_=30;let Ns;const fl=Symbol(""),b_=Symbol("");class jy{constructor(t,i=null,a){this.fn=t,this.scheduler=i,this.active=!0,this.deps=[],this.parent=void 0,ck(this,a)}run(){if(!this.active)return this.fn();let t=Ns,i=wo;for(;t;){if(t===this)return;t=t.parent}try{return this.parent=Ns,Ns=this,wo=!0,Co=1<<++Sh,Sh<=x_?uk(this):qx(this),this.fn()}finally{Sh<=x_&&hk(this),Co=1<<--Sh,Ns=this.parent,wo=i,this.parent=void 0,this.deferStop&&this.stop()}}stop(){Ns===this?this.deferStop=!0:this.active&&(qx(this),this.onStop&&this.onStop(),this.active=!1)}}function qx(e){const{deps:t}=e;if(t.length){for(let i=0;i<t.length;i++)t[i].delete(e);t.length=0}}let wo=!0;const Kw=[];function eu(){Kw.push(wo),wo=!1}function tu(){const e=Kw.pop();wo=e===void 0?!0:e}function Zr(e,t,i){if(wo&&Ns){let a=_p.get(e);a||_p.set(e,a=new Map);let u=a.get(i);u||a.set(i,u=Vy()),Jw(u)}}function Jw(e,t){let i=!1;Sh<=x_?Xw(e)||(e.n|=Co,i=!Yw(e)):i=!e.has(Ns),i&&(e.add(Ns),Ns.deps.push(e))}function Da(e,t,i,a,u,d){const p=_p.get(e);if(!p)return;let l=[];if(t==="clear")l=[...p.values()];else if(i==="length"&&en(e)){const b=Number(a);p.forEach((w,C)=>{(C==="length"||C>=b)&&l.push(w)})}else switch(i!==void 0&&l.push(p.get(i)),t){case"add":en(e)?Uy(i)&&l.push(p.get("length")):(l.push(p.get(fl)),Dc(e)&&l.push(p.get(b_)));break;case"delete":en(e)||(l.push(p.get(fl)),Dc(e)&&l.push(p.get(b_)));break;case"set":Dc(e)&&l.push(p.get(fl));break}if(l.length===1)l[0]&&w_(l[0]);else{const b=[];for(const w of l)w&&b.push(...w);w_(Vy(b))}}function w_(e,t){const i=en(e)?e:[...e];for(const a of i)a.computed&&Hx(a);for(const a of i)a.computed||Hx(a)}function Hx(e,t){(e!==Ns||e.allowRecurse)&&(e.scheduler?e.scheduler():e.run())}function dk(e,t){var i;return(i=_p.get(e))==null?void 0:i.get(t)}const fk=Oy("__proto__,__v_isRef,__isVue"),Qw=new Set(Object.getOwnPropertyNames(Symbol).filter(e=>e!=="arguments"&&e!=="caller").map(e=>Symbol[e]).filter(Ny)),pk=Gy(),mk=Gy(!1,!0),gk=Gy(!0),Wx=_k();function _k(){const e={};return["includes","indexOf","lastIndexOf"].forEach(t=>{e[t]=function(...i){const a=sn(this);for(let d=0,p=this.length;d<p;d++)Zr(a,"get",d+"");const u=a[t](...i);return u===-1||u===!1?a[t](...i.map(sn)):u}}),["push","pop","shift","unshift","splice"].forEach(t=>{e[t]=function(...i){eu();const a=sn(this)[t].apply(this,i);return tu(),a}}),e}function yk(e){const t=sn(this);return Zr(t,"has",e),t.hasOwnProperty(e)}function Gy(e=!1,t=!1){return function(a,u,d){if(u==="__v_isReactive")return!e;if(u==="__v_isReadonly")return e;if(u==="__v_isShallow")return t;if(u==="__v_raw"&&d===(e?t?Lk:rS:t?iS:nS).get(a))return a;const p=en(a);if(!e){if(p&&Mn(Wx,u))return Reflect.get(Wx,u,d);if(u==="hasOwnProperty")return yk}const l=Reflect.get(a,u,d);return(Ny(u)?Qw.has(u):fk(u))||(e||Zr(a,"get",u),t)?l:Kn(l)?p&&Uy(u)?l:l.value:ni(l)?e?md(l):Ki(l):l}}const vk=eS(),xk=eS(!0);function eS(e=!1){return function(i,a,u,d){let p=i[a];if(Fc(p)&&Kn(p)&&!Kn(u))return!1;if(!e&&(!yp(u)&&!Fc(u)&&(p=sn(p),u=sn(u)),!en(i)&&Kn(p)&&!Kn(u)))return p.value=u,!0;const l=en(i)&&Uy(a)?Number(a)<i.length:Mn(i,a),b=Reflect.set(i,a,u,d);return i===sn(d)&&(l?$h(u,p)&&Da(i,"set",a,u):Da(i,"add",a,u)),b}}function bk(e,t){const i=Mn(e,t);e[t];const a=Reflect.deleteProperty(e,t);return a&&i&&Da(e,"delete",t,void 0),a}function wk(e,t){const i=Reflect.has(e,t);return(!Ny(t)||!Qw.has(t))&&Zr(e,"has",t),i}function Sk(e){return Zr(e,"iterate",en(e)?"length":fl),Reflect.ownKeys(e)}const tS={get:pk,set:vk,deleteProperty:bk,has:wk,ownKeys:Sk},Ek={get:gk,set(e,t){return!0},deleteProperty(e,t){return!0}},Tk=Ai({},tS,{get:mk,set:xk}),qy=e=>e,Qp=e=>Reflect.getPrototypeOf(e);function Mf(e,t,i=!1,a=!1){e=e.__v_raw;const u=sn(e),d=sn(t);i||(t!==d&&Zr(u,"get",t),Zr(u,"get",d));const{has:p}=Qp(u),l=a?qy:i?Zy:Vh;if(p.call(u,t))return l(e.get(t));if(p.call(u,d))return l(e.get(d));e!==u&&e.get(t)}function Df(e,t=!1){const i=this.__v_raw,a=sn(i),u=sn(e);return t||(e!==u&&Zr(a,"has",e),Zr(a,"has",u)),e===u?i.has(e):i.has(e)||i.has(u)}function Lf(e,t=!1){return e=e.__v_raw,!t&&Zr(sn(e),"iterate",fl),Reflect.get(e,"size",e)}function Zx(e){e=sn(e);const t=sn(this);return Qp(t).has.call(t,e)||(t.add(e),Da(t,"add",e,e)),this}function Yx(e,t){t=sn(t);const i=sn(this),{has:a,get:u}=Qp(i);let d=a.call(i,e);d||(e=sn(e),d=a.call(i,e));const p=u.call(i,e);return i.set(e,t),d?$h(t,p)&&Da(i,"set",e,t):Da(i,"add",e,t),this}function Xx(e){const t=sn(this),{has:i,get:a}=Qp(t);let u=i.call(t,e);u||(e=sn(e),u=i.call(t,e)),a&&a.call(t,e);const d=t.delete(e);return u&&Da(t,"delete",e,void 0),d}function Kx(){const e=sn(this),t=e.size!==0,i=e.clear();return t&&Da(e,"clear",void 0,void 0),i}function zf(e,t){return function(a,u){const d=this,p=d.__v_raw,l=sn(p),b=t?qy:e?Zy:Vh;return!e&&Zr(l,"iterate",fl),p.forEach((w,C)=>a.call(u,b(w),b(C),d))}}function Of(e,t,i){return function(...a){const u=this.__v_raw,d=sn(u),p=Dc(d),l=e==="entries"||e===Symbol.iterator&&p,b=e==="keys"&&p,w=u[e](...a),C=i?qy:t?Zy:Vh;return!t&&Zr(d,"iterate",b?b_:fl),{next(){const{value:I,done:M}=w.next();return M?{value:I,done:M}:{value:l?[C(I[0]),C(I[1])]:C(I),done:M}},[Symbol.iterator](){return this}}}}function oo(e){return function(...t){return e==="delete"?!1:this}}function Ck(){const e={get(d){return Mf(this,d)},get size(){return Lf(this)},has:Df,add:Zx,set:Yx,delete:Xx,clear:Kx,forEach:zf(!1,!1)},t={get(d){return Mf(this,d,!1,!0)},get size(){return Lf(this)},has:Df,add:Zx,set:Yx,delete:Xx,clear:Kx,forEach:zf(!1,!0)},i={get(d){return Mf(this,d,!0)},get size(){return Lf(this,!0)},has(d){return Df.call(this,d,!0)},add:oo("add"),set:oo("set"),delete:oo("delete"),clear:oo("clear"),forEach:zf(!0,!1)},a={get(d){return Mf(this,d,!0,!0)},get size(){return Lf(this,!0)},has(d){return Df.call(this,d,!0)},add:oo("add"),set:oo("set"),delete:oo("delete"),clear:oo("clear"),forEach:zf(!0,!0)};return["keys","values","entries",Symbol.iterator].forEach(d=>{e[d]=Of(d,!1,!1),i[d]=Of(d,!0,!1),t[d]=Of(d,!1,!0),a[d]=Of(d,!0,!0)}),[e,i,t,a]}const[Ik,kk,Ak,Pk]=Ck();function Hy(e,t){const i=t?e?Pk:Ak:e?kk:Ik;return(a,u,d)=>u==="__v_isReactive"?!e:u==="__v_isReadonly"?e:u==="__v_raw"?a:Reflect.get(Mn(i,u)&&u in a?i:a,u,d)}const Rk={get:Hy(!1,!1)},Mk={get:Hy(!1,!0)},Dk={get:Hy(!0,!1)},nS=new WeakMap,iS=new WeakMap,rS=new WeakMap,Lk=new WeakMap;function zk(e){switch(e){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function Ok(e){return e.__v_skip||!Object.isExtensible(e)?0:zk(QI(e))}function Ki(e){return Fc(e)?e:Wy(e,!1,tS,Rk,nS)}function Bk(e){return Wy(e,!1,Tk,Mk,iS)}function md(e){return Wy(e,!0,Ek,Dk,rS)}function Wy(e,t,i,a,u){if(!ni(e)||e.__v_raw&&!(t&&e.__v_isReactive))return e;const d=u.get(e);if(d)return d;const p=Ok(e);if(p===0)return e;const l=new Proxy(e,p===2?a:i);return u.set(e,l),l}function So(e){return Fc(e)?So(e.__v_raw):!!(e&&e.__v_isReactive)}function Fc(e){return!!(e&&e.__v_isReadonly)}function yp(e){return!!(e&&e.__v_isShallow)}function sS(e){return So(e)||Fc(e)}function sn(e){const t=e&&e.__v_raw;return t?sn(t):e}function em(e){return gp(e,"__v_skip",!0),e}const Vh=e=>ni(e)?Ki(e):e,Zy=e=>ni(e)?md(e):e;function aS(e){wo&&Ns&&(e=sn(e),Jw(e.dep||(e.dep=Vy())))}function oS(e,t){e=sn(e);const i=e.dep;i&&w_(i)}function Kn(e){return!!(e&&e.__v_isRef===!0)}function Kt(e){return lS(e,!1)}function Sn(e){return lS(e,!0)}function lS(e,t){return Kn(e)?e:new Fk(e,t)}class Fk{constructor(t,i){this.__v_isShallow=i,this.dep=void 0,this.__v_isRef=!0,this._rawValue=i?t:sn(t),this._value=i?t:Vh(t)}get value(){return aS(this),this._value}set value(t){const i=this.__v_isShallow||yp(t)||Fc(t);t=i?t:sn(t),$h(t,this._rawValue)&&(this._rawValue=t,this._value=i?t:Vh(t),oS(this))}}function ur(e){return Kn(e)?e.value:e}const Nk={get:(e,t,i)=>ur(Reflect.get(e,t,i)),set:(e,t,i,a)=>{const u=e[t];return Kn(u)&&!Kn(i)?(u.value=i,!0):Reflect.set(e,t,i,a)}};function cS(e){return So(e)?e:new Proxy(e,Nk)}function tm(e){const t=en(e)?new Array(e.length):{};for(const i in e)t[i]=uS(e,i);return t}class Uk{constructor(t,i,a){this._object=t,this._key=i,this._defaultValue=a,this.__v_isRef=!0}get value(){const t=this._object[this._key];return t===void 0?this._defaultValue:t}set value(t){this._object[this._key]=t}get dep(){return dk(sn(this._object),this._key)}}class $k{constructor(t){this._getter=t,this.__v_isRef=!0,this.__v_isReadonly=!0}get value(){return this._getter()}}function wn(e,t,i){return Kn(e)?e:cn(e)?new $k(e):ni(e)&&arguments.length>1?uS(e,t,i):Kt(e)}function uS(e,t,i){const a=e[t];return Kn(a)?a:new Uk(e,t,i)}class Vk{constructor(t,i,a,u){this._setter=i,this.dep=void 0,this.__v_isRef=!0,this.__v_isReadonly=!1,this._dirty=!0,this.effect=new jy(t,()=>{this._dirty||(this._dirty=!0,oS(this))}),this.effect.computed=this,this.effect.active=this._cacheable=!u,this.__v_isReadonly=a}get value(){const t=sn(this);return aS(t),(t._dirty||!t._cacheable)&&(t._dirty=!1,t._value=t.effect.run()),t._value}set value(t){this._setter(t)}}function jk(e,t,i=!1){let a,u;const d=cn(e);return d?(a=e,u=$s):(a=e.get,u=e.set),new Vk(a,u,d||!u,i)}function Eo(e,t,i,a){let u;try{u=a?e(...a):e()}catch(d){nm(d,t,i)}return u}function Ts(e,t,i,a){if(cn(e)){const d=Eo(e,t,i,a);return d&&Vw(d)&&d.catch(p=>{nm(p,t,i)}),d}const u=[];for(let d=0;d<e.length;d++)u.push(Ts(e[d],t,i,a));return u}function nm(e,t,i,a=!0){const u=t?t.vnode:null;if(t){let d=t.parent;const p=t.proxy,l=i;for(;d;){const w=d.ec;if(w){for(let C=0;C<w.length;C++)if(w[C](e,p,l)===!1)return}d=d.parent}const b=t.appContext.config.errorHandler;if(b){Eo(b,null,10,[e,p,l]);return}}Gk(e,i,u,a)}function Gk(e,t,i,a=!0){console.error(e)}let jh=!1,S_=!1;const gr=[];let oa=0;const Lc=[];let Aa=null,ol=0;const hS=Promise.resolve();let Yy=null;function yr(e){const t=Yy||hS;return e?t.then(this?e.bind(this):e):t}function qk(e){let t=oa+1,i=gr.length;for(;t<i;){const a=t+i>>>1;Gh(gr[a])<e?t=a+1:i=a}return t}function Xy(e){(!gr.length||!gr.includes(e,jh&&e.allowRecurse?oa+1:oa))&&(e.id==null?gr.push(e):gr.splice(qk(e.id),0,e),dS())}function dS(){!jh&&!S_&&(S_=!0,Yy=hS.then(pS))}function Hk(e){const t=gr.indexOf(e);t>oa&&gr.splice(t,1)}function Wk(e){en(e)?Lc.push(...e):(!Aa||!Aa.includes(e,e.allowRecurse?ol+1:ol))&&Lc.push(e),dS()}function Jx(e,t=jh?oa+1:0){for(;t<gr.length;t++){const i=gr[t];i&&i.pre&&(gr.splice(t,1),t--,i())}}function fS(e){if(Lc.length){const t=[...new Set(Lc)];if(Lc.length=0,Aa){Aa.push(...t);return}for(Aa=t,Aa.sort((i,a)=>Gh(i)-Gh(a)),ol=0;ol<Aa.length;ol++)Aa[ol]();Aa=null,ol=0}}const Gh=e=>e.id==null?1/0:e.id,Zk=(e,t)=>{const i=Gh(e)-Gh(t);if(i===0){if(e.pre&&!t.pre)return-1;if(t.pre&&!e.pre)return 1}return i};function pS(e){S_=!1,jh=!0,gr.sort(Zk);const t=$s;try{for(oa=0;oa<gr.length;oa++){const i=gr[oa];i&&i.active!==!1&&Eo(i,null,14)}}finally{oa=0,gr.length=0,fS(),jh=!1,Yy=null,(gr.length||Lc.length)&&pS()}}function Yk(e,t,...i){if(e.isUnmounted)return;const a=e.vnode.props||ri;let u=i;const d=t.startsWith("update:"),p=d&&t.slice(7);if(p&&p in a){const C=`${p==="modelValue"?"model":p}Modifiers`,{number:I,trim:M}=a[C]||ri;M&&(u=i.map(O=>Ei(O)?O.trim():O)),I&&(u=i.map(y_))}let l,b=a[l=Gg(t)]||a[l=Gg(Cs(t))];!b&&d&&(b=a[l=Gg(Jc(t))]),b&&Ts(b,e,6,u);const w=a[l+"Once"];if(w){if(!e.emitted)e.emitted={};else if(e.emitted[l])return;e.emitted[l]=!0,Ts(w,e,6,u)}}function mS(e,t,i=!1){const a=t.emitsCache,u=a.get(e);if(u!==void 0)return u;const d=e.emits;let p={},l=!1;if(!cn(e)){const b=w=>{const C=mS(w,t,!0);C&&(l=!0,Ai(p,C))};!i&&t.mixins.length&&t.mixins.forEach(b),e.extends&&b(e.extends),e.mixins&&e.mixins.forEach(b)}return!d&&!l?(ni(e)&&a.set(e,null),null):(en(d)?d.forEach(b=>p[b]=null):Ai(p,d),ni(e)&&a.set(e,p),p)}function im(e,t){return!e||!Yp(t)?!1:(t=t.slice(2).replace(/Once$/,""),Mn(e,t[0].toLowerCase()+t.slice(1))||Mn(e,Jc(t))||Mn(e,t))}let Hr=null,gS=null;function vp(e){const t=Hr;return Hr=e,gS=e&&e.type.__scopeId||null,t}function _S(e,t=Hr,i){if(!t||e._n)return e;const a=(...u)=>{a._d&&hb(-1);const d=vp(t);let p;try{p=e(...u)}finally{vp(d),a._d&&hb(1)}return p};return a._n=!0,a._c=!0,a._d=!0,a}function qg(e){const{type:t,vnode:i,proxy:a,withProxy:u,props:d,propsOptions:[p],slots:l,attrs:b,emit:w,render:C,renderCache:I,data:M,setupState:O,ctx:j,inheritAttrs:Z}=e;let ue,ce;const ve=vp(e);try{if(i.shapeFlag&4){const Ae=u||a;ue=sa(C.call(Ae,Ae,I,d,O,M,j)),ce=b}else{const Ae=t;ue=sa(Ae.length>1?Ae(d,{attrs:b,slots:l,emit:w}):Ae(d,null)),ce=t.props?b:Xk(b)}}catch(Ae){Ph.length=0,nm(Ae,e,1),ue=le(Vs)}let ye=ue;if(ce&&Z!==!1){const Ae=Object.keys(ce),{shapeFlag:Be}=ye;Ae.length&&Be&7&&(p&&Ae.some(By)&&(ce=Kk(ce,p)),ye=La(ye,ce))}return i.dirs&&(ye=La(ye),ye.dirs=ye.dirs?ye.dirs.concat(i.dirs):i.dirs),i.transition&&(ye.transition=i.transition),ue=ye,vp(ve),ue}const Xk=e=>{let t;for(const i in e)(i==="class"||i==="style"||Yp(i))&&((t||(t={}))[i]=e[i]);return t},Kk=(e,t)=>{const i={};for(const a in e)(!By(a)||!(a.slice(9)in t))&&(i[a]=e[a]);return i};function Jk(e,t,i){const{props:a,children:u,component:d}=e,{props:p,children:l,patchFlag:b}=t,w=d.emitsOptions;if(t.dirs||t.transition)return!0;if(i&&b>=0){if(b&1024)return!0;if(b&16)return a?Qx(a,p,w):!!p;if(b&8){const C=t.dynamicProps;for(let I=0;I<C.length;I++){const M=C[I];if(p[M]!==a[M]&&!im(w,M))return!0}}}else return(u||l)&&(!l||!l.$stable)?!0:a===p?!1:a?p?Qx(a,p,w):!0:!!p;return!1}function Qx(e,t,i){const a=Object.keys(t);if(a.length!==Object.keys(e).length)return!0;for(let u=0;u<a.length;u++){const d=a[u];if(t[d]!==e[d]&&!im(i,d))return!0}return!1}function Qk({vnode:e,parent:t},i){for(;t&&t.subTree===e;)(e=t.vnode).el=i,t=t.parent}const eA=e=>e.__isSuspense;function tA(e,t){t&&t.pendingBranch?en(e)?t.effects.push(...e):t.effects.push(e):Wk(e)}function Ua(e,t){return Ky(e,null,t)}const Bf={};function En(e,t,i){return Ky(e,t,i)}function Ky(e,t,{immediate:i,deep:a,flush:u,onTrack:d,onTrigger:p}=ri){var l;const b=Zw()===((l=Vi)==null?void 0:l.scope)?Vi:null;let w,C=!1,I=!1;if(Kn(e)?(w=()=>e.value,C=yp(e)):So(e)?(w=()=>e,a=!0):en(e)?(I=!0,C=e.some(Ae=>So(Ae)||yp(Ae)),w=()=>e.map(Ae=>{if(Kn(Ae))return Ae.value;if(So(Ae))return ul(Ae);if(cn(Ae))return Eo(Ae,b,2)})):cn(e)?t?w=()=>Eo(e,b,2):w=()=>{if(!(b&&b.isUnmounted))return M&&M(),Ts(e,b,3,[O])}:w=$s,t&&a){const Ae=w;w=()=>ul(Ae())}let M,O=Ae=>{M=ve.onStop=()=>{Eo(Ae,b,4)}},j;if(Yh)if(O=$s,t?i&&Ts(t,b,3,[w(),I?[]:void 0,O]):w(),u==="sync"){const Ae=YA();j=Ae.__watcherHandles||(Ae.__watcherHandles=[])}else return $s;let Z=I?new Array(e.length).fill(Bf):Bf;const ue=()=>{if(ve.active)if(t){const Ae=ve.run();(a||C||(I?Ae.some((Be,Le)=>$h(Be,Z[Le])):$h(Ae,Z)))&&(M&&M(),Ts(t,b,3,[Ae,Z===Bf?void 0:I&&Z[0]===Bf?[]:Z,O]),Z=Ae)}else ve.run()};ue.allowRecurse=!!t;let ce;u==="sync"?ce=ue:u==="post"?ce=()=>qr(ue,b&&b.suspense):(ue.pre=!0,b&&(ue.id=b.uid),ce=()=>Xy(ue));const ve=new jy(w,ce);t?i?ue():Z=ve.run():u==="post"?qr(ve.run.bind(ve),b&&b.suspense):ve.run();const ye=()=>{ve.stop(),b&&b.scope&&Fy(b.scope.effects,ve)};return j&&j.push(ye),ye}function nA(e,t,i){const a=this.proxy,u=Ei(e)?e.includes(".")?yS(a,e):()=>a[e]:e.bind(a,a);let d;cn(t)?d=t:(d=t.handler,i=t);const p=Vi;Nc(this);const l=Ky(u,d.bind(a),i);return p?Nc(p):pl(),l}function yS(e,t){const i=t.split(".");return()=>{let a=e;for(let u=0;u<i.length&&a;u++)a=a[i[u]];return a}}function ul(e,t){if(!ni(e)||e.__v_skip||(t=t||new Set,t.has(e)))return e;if(t.add(e),Kn(e))ul(e.value,t);else if(en(e))for(let i=0;i<e.length;i++)ul(e[i],t);else if($w(e)||Dc(e))e.forEach(i=>{ul(i,t)});else if(Gw(e))for(const i in e)ul(e[i],t);return e}function us(e,t){const i=Hr;if(i===null)return e;const a=cm(i)||i.proxy,u=e.dirs||(e.dirs=[]);for(let d=0;d<t.length;d++){let[p,l,b,w=ri]=t[d];p&&(cn(p)&&(p={mounted:p,updated:p}),p.deep&&ul(l),u.push({dir:p,instance:a,value:l,oldValue:void 0,arg:b,modifiers:w}))}return e}function il(e,t,i,a){const u=e.dirs,d=t&&t.dirs;for(let p=0;p<u.length;p++){const l=u[p];d&&(l.oldValue=d[p].value);let b=l.dir[a];b&&(eu(),Ts(b,i,8,[e.el,l,e,t]),tu())}}function vS(){const e={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return wl(()=>{e.isMounted=!0}),Va(()=>{e.isUnmounting=!0}),e}const ws=[Function,Array],xS={mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:ws,onEnter:ws,onAfterEnter:ws,onEnterCancelled:ws,onBeforeLeave:ws,onLeave:ws,onAfterLeave:ws,onLeaveCancelled:ws,onBeforeAppear:ws,onAppear:ws,onAfterAppear:ws,onAppearCancelled:ws},iA={name:"BaseTransition",props:xS,setup(e,{slots:t}){const i=av(),a=vS();let u;return()=>{const d=t.default&&Jy(t.default(),!0);if(!d||!d.length)return;let p=d[0];if(d.length>1){for(const Z of d)if(Z.type!==Vs){p=Z;break}}const l=sn(e),{mode:b}=l;if(a.isLeaving)return Hg(p);const w=eb(p);if(!w)return Hg(p);const C=qh(w,l,a,i);Hh(w,C);const I=i.subTree,M=I&&eb(I);let O=!1;const{getTransitionKey:j}=w.type;if(j){const Z=j();u===void 0?u=Z:Z!==u&&(u=Z,O=!0)}if(M&&M.type!==Vs&&(!ll(w,M)||O)){const Z=qh(M,l,a,i);if(Hh(M,Z),b==="out-in")return a.isLeaving=!0,Z.afterLeave=()=>{a.isLeaving=!1,i.update.active!==!1&&i.update()},Hg(p);b==="in-out"&&w.type!==Vs&&(Z.delayLeave=(ue,ce,ve)=>{const ye=bS(a,M);ye[String(M.key)]=M,ue._leaveCb=()=>{ce(),ue._leaveCb=void 0,delete C.delayedLeave},C.delayedLeave=ve})}return p}}},rA=iA;function bS(e,t){const{leavingVNodes:i}=e;let a=i.get(t.type);return a||(a=Object.create(null),i.set(t.type,a)),a}function qh(e,t,i,a){const{appear:u,mode:d,persisted:p=!1,onBeforeEnter:l,onEnter:b,onAfterEnter:w,onEnterCancelled:C,onBeforeLeave:I,onLeave:M,onAfterLeave:O,onLeaveCancelled:j,onBeforeAppear:Z,onAppear:ue,onAfterAppear:ce,onAppearCancelled:ve}=t,ye=String(e.key),Ae=bS(i,e),Be=(U,H)=>{U&&Ts(U,a,9,H)},Le=(U,H)=>{const he=H[1];Be(U,H),en(U)?U.every(xe=>xe.length<=1)&&he():U.length<=1&&he()},Ie={mode:d,persisted:p,beforeEnter(U){let H=l;if(!i.isMounted)if(u)H=Z||l;else return;U._leaveCb&&U._leaveCb(!0);const he=Ae[ye];he&&ll(e,he)&&he.el._leaveCb&&he.el._leaveCb(),Be(H,[U])},enter(U){let H=b,he=w,xe=C;if(!i.isMounted)if(u)H=ue||b,he=ce||w,xe=ve||C;else return;let we=!1;const oe=U._enterCb=ke=>{we||(we=!0,ke?Be(xe,[U]):Be(he,[U]),Ie.delayedLeave&&Ie.delayedLeave(),U._enterCb=void 0)};H?Le(H,[U,oe]):oe()},leave(U,H){const he=String(e.key);if(U._enterCb&&U._enterCb(!0),i.isUnmounting)return H();Be(I,[U]);let xe=!1;const we=U._leaveCb=oe=>{xe||(xe=!0,H(),oe?Be(j,[U]):Be(O,[U]),U._leaveCb=void 0,Ae[he]===e&&delete Ae[he])};Ae[he]=e,M?Le(M,[U,we]):we()},clone(U){return qh(U,t,i,a)}};return Ie}function Hg(e){if(sm(e))return e=La(e),e.children=null,e}function eb(e){return sm(e)?e.children?e.children[0]:void 0:e}function Hh(e,t){e.shapeFlag&6&&e.component?Hh(e.component.subTree,t):e.shapeFlag&128?(e.ssContent.transition=t.clone(e.ssContent),e.ssFallback.transition=t.clone(e.ssFallback)):e.transition=t}function Jy(e,t=!1,i){let a=[],u=0;for(let d=0;d<e.length;d++){let p=e[d];const l=i==null?p.key:String(i)+String(p.key!=null?p.key:d);p.type===gn?(p.patchFlag&128&&u++,a=a.concat(Jy(p.children,t,l))):(t||p.type!==Vs)&&a.push(l!=null?La(p,{key:l}):p)}if(u>1)for(let d=0;d<a.length;d++)a[d].patchFlag=-2;return a}function rm(e,t){return cn(e)?(()=>Ai({name:e.name},t,{setup:e}))():e}const ap=e=>!!e.type.__asyncLoader,sm=e=>e.type.__isKeepAlive;function sA(e,t){wS(e,"a",t)}function aA(e,t){wS(e,"da",t)}function wS(e,t,i=Vi){const a=e.__wdc||(e.__wdc=()=>{let u=i;for(;u;){if(u.isDeactivated)return;u=u.parent}return e()});if(am(t,a,i),i){let u=i.parent;for(;u&&u.parent;)sm(u.parent.vnode)&&oA(a,t,i,u),u=u.parent}}function oA(e,t,i,a){const u=am(t,e,a,!0);ES(()=>{Fy(a[t],u)},i)}function am(e,t,i=Vi,a=!1){if(i){const u=i[e]||(i[e]=[]),d=t.__weh||(t.__weh=(...p)=>{if(i.isUnmounted)return;eu(),Nc(i);const l=Ts(t,i,e,p);return pl(),tu(),l});return a?u.unshift(d):u.push(d),d}}const $a=e=>(t,i=Vi)=>(!Yh||e==="sp")&&am(e,(...a)=>t(...a),i),Qy=$a("bm"),wl=$a("m"),lA=$a("bu"),SS=$a("u"),Va=$a("bum"),ES=$a("um"),cA=$a("sp"),uA=$a("rtg"),hA=$a("rtc");function dA(e,t=Vi){am("ec",e,t)}const ev="components",fA="directives";function lr(e,t){return tv(ev,e,!0,t)||e}const TS=Symbol.for("v-ndc");function pA(e){return Ei(e)?tv(ev,e,!1)||e:e||TS}function yl(e){return tv(fA,e)}function tv(e,t,i=!0,a=!1){const u=Hr||Vi;if(u){const d=u.type;if(e===ev){const l=HA(d,!1);if(l&&(l===t||l===Cs(t)||l===Qc(Cs(t))))return d}const p=tb(u[e]||d[e],t)||tb(u.appContext[e],t);return!p&&a?d:p}}function tb(e,t){return e&&(e[t]||e[Cs(t)]||e[Qc(Cs(t))])}function zc(e,t,i,a){let u;const d=i&&i[a];if(en(e)||Ei(e)){u=new Array(e.length);for(let p=0,l=e.length;p<l;p++)u[p]=t(e[p],p,void 0,d&&d[p])}else if(typeof e=="number"){u=new Array(e);for(let p=0;p<e;p++)u[p]=t(p+1,p,void 0,d&&d[p])}else if(ni(e))if(e[Symbol.iterator])u=Array.from(e,(p,l)=>t(p,l,void 0,d&&d[l]));else{const p=Object.keys(e);u=new Array(p.length);for(let l=0,b=p.length;l<b;l++){const w=p[l];u[l]=t(e[w],w,l,d&&d[l])}}else u=[];return i&&(i[a]=u),u}const E_=e=>e?OS(e)?cm(e)||e.proxy:E_(e.parent):null,kh=Ai(Object.create(null),{$:e=>e,$el:e=>e.vnode.el,$data:e=>e.data,$props:e=>e.props,$attrs:e=>e.attrs,$slots:e=>e.slots,$refs:e=>e.refs,$parent:e=>E_(e.parent),$root:e=>E_(e.root),$emit:e=>e.emit,$options:e=>nv(e),$forceUpdate:e=>e.f||(e.f=()=>Xy(e.update)),$nextTick:e=>e.n||(e.n=yr.bind(e.proxy)),$watch:e=>nA.bind(e)}),Wg=(e,t)=>e!==ri&&!e.__isScriptSetup&&Mn(e,t),mA={get({_:e},t){const{ctx:i,setupState:a,data:u,props:d,accessCache:p,type:l,appContext:b}=e;let w;if(t[0]!=="$"){const O=p[t];if(O!==void 0)switch(O){case 1:return a[t];case 2:return u[t];case 4:return i[t];case 3:return d[t]}else{if(Wg(a,t))return p[t]=1,a[t];if(u!==ri&&Mn(u,t))return p[t]=2,u[t];if((w=e.propsOptions[0])&&Mn(w,t))return p[t]=3,d[t];if(i!==ri&&Mn(i,t))return p[t]=4,i[t];T_&&(p[t]=0)}}const C=kh[t];let I,M;if(C)return t==="$attrs"&&Zr(e,"get",t),C(e);if((I=l.__cssModules)&&(I=I[t]))return I;if(i!==ri&&Mn(i,t))return p[t]=4,i[t];if(M=b.config.globalProperties,Mn(M,t))return M[t]},set({_:e},t,i){const{data:a,setupState:u,ctx:d}=e;return Wg(u,t)?(u[t]=i,!0):a!==ri&&Mn(a,t)?(a[t]=i,!0):Mn(e.props,t)||t[0]==="$"&&t.slice(1)in e?!1:(d[t]=i,!0)},has({_:{data:e,setupState:t,accessCache:i,ctx:a,appContext:u,propsOptions:d}},p){let l;return!!i[p]||e!==ri&&Mn(e,p)||Wg(t,p)||(l=d[0])&&Mn(l,p)||Mn(a,p)||Mn(kh,p)||Mn(u.config.globalProperties,p)},defineProperty(e,t,i){return i.get!=null?e._.accessCache[t]=0:Mn(i,"value")&&this.set(e,t,i.value,null),Reflect.defineProperty(e,t,i)}};function nb(e){return en(e)?e.reduce((t,i)=>(t[i]=null,t),{}):e}let T_=!0;function gA(e){const t=nv(e),i=e.proxy,a=e.ctx;T_=!1,t.beforeCreate&&ib(t.beforeCreate,e,"bc");const{data:u,computed:d,methods:p,watch:l,provide:b,inject:w,created:C,beforeMount:I,mounted:M,beforeUpdate:O,updated:j,activated:Z,deactivated:ue,beforeDestroy:ce,beforeUnmount:ve,destroyed:ye,unmounted:Ae,render:Be,renderTracked:Le,renderTriggered:Ie,errorCaptured:U,serverPrefetch:H,expose:he,inheritAttrs:xe,components:we,directives:oe,filters:ke}=t;if(w&&_A(w,a,null),p)for(const Ve in p){const $e=p[Ve];cn($e)&&(a[Ve]=$e.bind(i))}if(u){const Ve=u.call(i,i);ni(Ve)&&(e.data=Ki(Ve))}if(T_=!0,d)for(const Ve in d){const $e=d[Ve],He=cn($e)?$e.bind(i,i):cn($e.get)?$e.get.bind(i,i):$s,kt=!cn($e)&&cn($e.set)?$e.set.bind(i):$s,Ct=Ce({get:He,set:kt});Object.defineProperty(a,Ve,{enumerable:!0,configurable:!0,get:()=>Ct.value,set:rt=>Ct.value=rt})}if(l)for(const Ve in l)CS(l[Ve],a,i,Ve);if(b){const Ve=cn(b)?b.call(i):b;Reflect.ownKeys(Ve).forEach($e=>{_r($e,Ve[$e])})}C&&ib(C,e,"c");function et(Ve,$e){en($e)?$e.forEach(He=>Ve(He.bind(i))):$e&&Ve($e.bind(i))}if(et(Qy,I),et(wl,M),et(lA,O),et(SS,j),et(sA,Z),et(aA,ue),et(dA,U),et(hA,Le),et(uA,Ie),et(Va,ve),et(ES,Ae),et(cA,H),en(he))if(he.length){const Ve=e.exposed||(e.exposed={});he.forEach($e=>{Object.defineProperty(Ve,$e,{get:()=>i[$e],set:He=>i[$e]=He})})}else e.exposed||(e.exposed={});Be&&e.render===$s&&(e.render=Be),xe!=null&&(e.inheritAttrs=xe),we&&(e.components=we),oe&&(e.directives=oe)}function _A(e,t,i=$s){en(e)&&(e=C_(e));for(const a in e){const u=e[a];let d;ni(u)?"default"in u?d=Jn(u.from||a,u.default,!0):d=Jn(u.from||a):d=Jn(u),Kn(d)?Object.defineProperty(t,a,{enumerable:!0,configurable:!0,get:()=>d.value,set:p=>d.value=p}):t[a]=d}}function ib(e,t,i){Ts(en(e)?e.map(a=>a.bind(t.proxy)):e.bind(t.proxy),t,i)}function CS(e,t,i,a){const u=a.includes(".")?yS(i,a):()=>i[a];if(Ei(e)){const d=t[e];cn(d)&&En(u,d)}else if(cn(e))En(u,e.bind(i));else if(ni(e))if(en(e))e.forEach(d=>CS(d,t,i,a));else{const d=cn(e.handler)?e.handler.bind(i):t[e.handler];cn(d)&&En(u,d,e)}}function nv(e){const t=e.type,{mixins:i,extends:a}=t,{mixins:u,optionsCache:d,config:{optionMergeStrategies:p}}=e.appContext,l=d.get(t);let b;return l?b=l:!u.length&&!i&&!a?b=t:(b={},u.length&&u.forEach(w=>xp(b,w,p,!0)),xp(b,t,p)),ni(t)&&d.set(t,b),b}function xp(e,t,i,a=!1){const{mixins:u,extends:d}=t;d&&xp(e,d,i,!0),u&&u.forEach(p=>xp(e,p,i,!0));for(const p in t)if(!(a&&p==="expose")){const l=yA[p]||i&&i[p];e[p]=l?l(e[p],t[p]):t[p]}return e}const yA={data:rb,props:sb,emits:sb,methods:Eh,computed:Eh,beforeCreate:Pr,created:Pr,beforeMount:Pr,mounted:Pr,beforeUpdate:Pr,updated:Pr,beforeDestroy:Pr,beforeUnmount:Pr,destroyed:Pr,unmounted:Pr,activated:Pr,deactivated:Pr,errorCaptured:Pr,serverPrefetch:Pr,components:Eh,directives:Eh,watch:xA,provide:rb,inject:vA};function rb(e,t){return t?e?function(){return Ai(cn(e)?e.call(this,this):e,cn(t)?t.call(this,this):t)}:t:e}function vA(e,t){return Eh(C_(e),C_(t))}function C_(e){if(en(e)){const t={};for(let i=0;i<e.length;i++)t[e[i]]=e[i];return t}return e}function Pr(e,t){return e?[...new Set([].concat(e,t))]:t}function Eh(e,t){return e?Ai(Object.create(null),e,t):t}function sb(e,t){return e?en(e)&&en(t)?[...new Set([...e,...t])]:Ai(Object.create(null),nb(e),nb(t??{})):t}function xA(e,t){if(!e)return t;if(!t)return e;const i=Ai(Object.create(null),e);for(const a in t)i[a]=Pr(e[a],t[a]);return i}function IS(){return{app:null,config:{isNativeTag:XI,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let bA=0;function wA(e,t){return function(a,u=null){cn(a)||(a=Ai({},a)),u!=null&&!ni(u)&&(u=null);const d=IS(),p=new Set;let l=!1;const b=d.app={_uid:bA++,_component:a,_props:u,_container:null,_context:d,_instance:null,version:XA,get config(){return d.config},set config(w){},use(w,...C){return p.has(w)||(w&&cn(w.install)?(p.add(w),w.install(b,...C)):cn(w)&&(p.add(w),w(b,...C))),b},mixin(w){return d.mixins.includes(w)||d.mixins.push(w),b},component(w,C){return C?(d.components[w]=C,b):d.components[w]},directive(w,C){return C?(d.directives[w]=C,b):d.directives[w]},mount(w,C,I){if(!l){const M=le(a,u);return M.appContext=d,C&&t?t(M,w):e(M,w,I),l=!0,b._container=w,w.__vue_app__=b,cm(M.component)||M.component.proxy}},unmount(){l&&(e(null,b._container),delete b._container.__vue_app__)},provide(w,C){return d.provides[w]=C,b},runWithContext(w){Wh=b;try{return w()}finally{Wh=null}}};return b}}let Wh=null;function _r(e,t){if(Vi){let i=Vi.provides;const a=Vi.parent&&Vi.parent.provides;a===i&&(i=Vi.provides=Object.create(a)),i[e]=t}}function Jn(e,t,i=!1){const a=Vi||Hr;if(a||Wh){const u=a?a.parent==null?a.vnode.appContext&&a.vnode.appContext.provides:a.parent.provides:Wh._context.provides;if(u&&e in u)return u[e];if(arguments.length>1)return i&&cn(t)?t.call(a&&a.proxy):t}}function SA(){return!!(Vi||Hr||Wh)}function EA(e,t,i,a=!1){const u={},d={};gp(d,lm,1),e.propsDefaults=Object.create(null),kS(e,t,u,d);for(const p in e.propsOptions[0])p in u||(u[p]=void 0);i?e.props=a?u:Bk(u):e.type.props?e.props=u:e.props=d,e.attrs=d}function TA(e,t,i,a){const{props:u,attrs:d,vnode:{patchFlag:p}}=e,l=sn(u),[b]=e.propsOptions;let w=!1;if((a||p>0)&&!(p&16)){if(p&8){const C=e.vnode.dynamicProps;for(let I=0;I<C.length;I++){let M=C[I];if(im(e.emitsOptions,M))continue;const O=t[M];if(b)if(Mn(d,M))O!==d[M]&&(d[M]=O,w=!0);else{const j=Cs(M);u[j]=I_(b,l,j,O,e,!1)}else O!==d[M]&&(d[M]=O,w=!0)}}}else{kS(e,t,u,d)&&(w=!0);let C;for(const I in l)(!t||!Mn(t,I)&&((C=Jc(I))===I||!Mn(t,C)))&&(b?i&&(i[I]!==void 0||i[C]!==void 0)&&(u[I]=I_(b,l,I,void 0,e,!0)):delete u[I]);if(d!==l)for(const I in d)(!t||!Mn(t,I))&&(delete d[I],w=!0)}w&&Da(e,"set","$attrs")}function kS(e,t,i,a){const[u,d]=e.propsOptions;let p=!1,l;if(t)for(let b in t){if(rp(b))continue;const w=t[b];let C;u&&Mn(u,C=Cs(b))?!d||!d.includes(C)?i[C]=w:(l||(l={}))[C]=w:im(e.emitsOptions,b)||(!(b in a)||w!==a[b])&&(a[b]=w,p=!0)}if(d){const b=sn(i),w=l||ri;for(let C=0;C<d.length;C++){const I=d[C];i[I]=I_(u,b,I,w[I],e,!Mn(w,I))}}return p}function I_(e,t,i,a,u,d){const p=e[i];if(p!=null){const l=Mn(p,"default");if(l&&a===void 0){const b=p.default;if(p.type!==Function&&!p.skipFactory&&cn(b)){const{propsDefaults:w}=u;i in w?a=w[i]:(Nc(u),a=w[i]=b.call(null,t),pl())}else a=b}p[0]&&(d&&!l?a=!1:p[1]&&(a===""||a===Jc(i))&&(a=!0))}return a}function AS(e,t,i=!1){const a=t.propsCache,u=a.get(e);if(u)return u;const d=e.props,p={},l=[];let b=!1;if(!cn(e)){const C=I=>{b=!0;const[M,O]=AS(I,t,!0);Ai(p,M),O&&l.push(...O)};!i&&t.mixins.length&&t.mixins.forEach(C),e.extends&&C(e.extends),e.mixins&&e.mixins.forEach(C)}if(!d&&!b)return ni(e)&&a.set(e,Mc),Mc;if(en(d))for(let C=0;C<d.length;C++){const I=Cs(d[C]);ab(I)&&(p[I]=ri)}else if(d)for(const C in d){const I=Cs(C);if(ab(I)){const M=d[C],O=p[I]=en(M)||cn(M)?{type:M}:Ai({},M);if(O){const j=cb(Boolean,O.type),Z=cb(String,O.type);O[0]=j>-1,O[1]=Z<0||j<Z,(j>-1||Mn(O,"default"))&&l.push(I)}}}const w=[p,l];return ni(e)&&a.set(e,w),w}function ab(e){return e[0]!=="$"}function ob(e){const t=e&&e.toString().match(/^\s*(function|class) (\w+)/);return t?t[2]:e===null?"null":""}function lb(e,t){return ob(e)===ob(t)}function cb(e,t){return en(t)?t.findIndex(i=>lb(i,e)):cn(t)&&lb(t,e)?0:-1}const PS=e=>e[0]==="_"||e==="$stable",iv=e=>en(e)?e.map(sa):[sa(e)],CA=(e,t,i)=>{if(t._n)return t;const a=_S((...u)=>iv(t(...u)),i);return a._c=!1,a},RS=(e,t,i)=>{const a=e._ctx;for(const u in e){if(PS(u))continue;const d=e[u];if(cn(d))t[u]=CA(u,d,a);else if(d!=null){const p=iv(d);t[u]=()=>p}}},MS=(e,t)=>{const i=iv(t);e.slots.default=()=>i},IA=(e,t)=>{if(e.vnode.shapeFlag&32){const i=t._;i?(e.slots=sn(t),gp(t,"_",i)):RS(t,e.slots={})}else e.slots={},t&&MS(e,t);gp(e.slots,lm,1)},kA=(e,t,i)=>{const{vnode:a,slots:u}=e;let d=!0,p=ri;if(a.shapeFlag&32){const l=t._;l?i&&l===1?d=!1:(Ai(u,t),!i&&l===1&&delete u._):(d=!t.$stable,RS(t,u)),p=t}else t&&(MS(e,t),p={default:1});if(d)for(const l in u)!PS(l)&&!(l in p)&&delete u[l]};function k_(e,t,i,a,u=!1){if(en(e)){e.forEach((M,O)=>k_(M,t&&(en(t)?t[O]:t),i,a,u));return}if(ap(a)&&!u)return;const d=a.shapeFlag&4?cm(a.component)||a.component.proxy:a.el,p=u?null:d,{i:l,r:b}=e,w=t&&t.r,C=l.refs===ri?l.refs={}:l.refs,I=l.setupState;if(w!=null&&w!==b&&(Ei(w)?(C[w]=null,Mn(I,w)&&(I[w]=null)):Kn(w)&&(w.value=null)),cn(b))Eo(b,l,12,[p,C]);else{const M=Ei(b),O=Kn(b);if(M||O){const j=()=>{if(e.f){const Z=M?Mn(I,b)?I[b]:C[b]:b.value;u?en(Z)&&Fy(Z,d):en(Z)?Z.includes(d)||Z.push(d):M?(C[b]=[d],Mn(I,b)&&(I[b]=C[b])):(b.value=[d],e.k&&(C[e.k]=b.value))}else M?(C[b]=p,Mn(I,b)&&(I[b]=p)):O&&(b.value=p,e.k&&(C[e.k]=p))};p?(j.id=-1,qr(j,i)):j()}}}const qr=tA;function AA(e){return PA(e)}function PA(e,t){const i=v_();i.__VUE__=!0;const{insert:a,remove:u,patchProp:d,createElement:p,createText:l,createComment:b,setText:w,setElementText:C,parentNode:I,nextSibling:M,setScopeId:O=$s,insertStaticContent:j}=e,Z=(Y,ie,W,De=null,Ue=null,Ne=null,Ze=!1,ct=null,dt=!!ie.dynamicChildren)=>{if(Y===ie)return;Y&&!ll(Y,ie)&&(De=Se(Y),rt(Y,Ue,Ne,!0),Y=null),ie.patchFlag===-2&&(dt=!1,ie.dynamicChildren=null);const{type:nt,ref:ut,shapeFlag:mt}=ie;switch(nt){case gd:ue(Y,ie,W,De);break;case Vs:ce(Y,ie,W,De);break;case Zg:Y==null&&ve(ie,W,De,Ze);break;case gn:we(Y,ie,W,De,Ue,Ne,Ze,ct,dt);break;default:mt&1?Be(Y,ie,W,De,Ue,Ne,Ze,ct,dt):mt&6?oe(Y,ie,W,De,Ue,Ne,Ze,ct,dt):(mt&64||mt&128)&&nt.process(Y,ie,W,De,Ue,Ne,Ze,ct,dt,Oe)}ut!=null&&Ue&&k_(ut,Y&&Y.ref,Ne,ie||Y,!ie)},ue=(Y,ie,W,De)=>{if(Y==null)a(ie.el=l(ie.children),W,De);else{const Ue=ie.el=Y.el;ie.children!==Y.children&&w(Ue,ie.children)}},ce=(Y,ie,W,De)=>{Y==null?a(ie.el=b(ie.children||""),W,De):ie.el=Y.el},ve=(Y,ie,W,De)=>{[Y.el,Y.anchor]=j(Y.children,ie,W,De,Y.el,Y.anchor)},ye=({el:Y,anchor:ie},W,De)=>{let Ue;for(;Y&&Y!==ie;)Ue=M(Y),a(Y,W,De),Y=Ue;a(ie,W,De)},Ae=({el:Y,anchor:ie})=>{let W;for(;Y&&Y!==ie;)W=M(Y),u(Y),Y=W;u(ie)},Be=(Y,ie,W,De,Ue,Ne,Ze,ct,dt)=>{Ze=Ze||ie.type==="svg",Y==null?Le(ie,W,De,Ue,Ne,Ze,ct,dt):H(Y,ie,Ue,Ne,Ze,ct,dt)},Le=(Y,ie,W,De,Ue,Ne,Ze,ct)=>{let dt,nt;const{type:ut,props:mt,shapeFlag:Mt,transition:wt,dirs:Ge}=Y;if(dt=Y.el=p(Y.type,Ne,mt&&mt.is,mt),Mt&8?C(dt,Y.children):Mt&16&&U(Y.children,dt,null,De,Ue,Ne&&ut!=="foreignObject",Ze,ct),Ge&&il(Y,null,De,"created"),Ie(dt,Y,Y.scopeId,Ze,De),mt){for(const Zt in mt)Zt!=="value"&&!rp(Zt)&&d(dt,Zt,null,mt[Zt],Ne,Y.children,De,Ue,qe);"value"in mt&&d(dt,"value",null,mt.value),(nt=mt.onVnodeBeforeMount)&&na(nt,De,Y)}Ge&&il(Y,null,De,"beforeMount");const tn=(!Ue||Ue&&!Ue.pendingBranch)&&wt&&!wt.persisted;tn&&wt.beforeEnter(dt),a(dt,ie,W),((nt=mt&&mt.onVnodeMounted)||tn||Ge)&&qr(()=>{nt&&na(nt,De,Y),tn&&wt.enter(dt),Ge&&il(Y,null,De,"mounted")},Ue)},Ie=(Y,ie,W,De,Ue)=>{if(W&&O(Y,W),De)for(let Ne=0;Ne<De.length;Ne++)O(Y,De[Ne]);if(Ue){let Ne=Ue.subTree;if(ie===Ne){const Ze=Ue.vnode;Ie(Y,Ze,Ze.scopeId,Ze.slotScopeIds,Ue.parent)}}},U=(Y,ie,W,De,Ue,Ne,Ze,ct,dt=0)=>{for(let nt=dt;nt<Y.length;nt++){const ut=Y[nt]=ct?fo(Y[nt]):sa(Y[nt]);Z(null,ut,ie,W,De,Ue,Ne,Ze,ct)}},H=(Y,ie,W,De,Ue,Ne,Ze)=>{const ct=ie.el=Y.el;let{patchFlag:dt,dynamicChildren:nt,dirs:ut}=ie;dt|=Y.patchFlag&16;const mt=Y.props||ri,Mt=ie.props||ri;let wt;W&&rl(W,!1),(wt=Mt.onVnodeBeforeUpdate)&&na(wt,W,ie,Y),ut&&il(ie,Y,W,"beforeUpdate"),W&&rl(W,!0);const Ge=Ue&&ie.type!=="foreignObject";if(nt?he(Y.dynamicChildren,nt,ct,W,De,Ge,Ne):Ze||$e(Y,ie,ct,null,W,De,Ge,Ne,!1),dt>0){if(dt&16)xe(ct,ie,mt,Mt,W,De,Ue);else if(dt&2&&mt.class!==Mt.class&&d(ct,"class",null,Mt.class,Ue),dt&4&&d(ct,"style",mt.style,Mt.style,Ue),dt&8){const tn=ie.dynamicProps;for(let Zt=0;Zt<tn.length;Zt++){const dn=tn[Zt],zn=mt[dn],at=Mt[dn];(at!==zn||dn==="value")&&d(ct,dn,zn,at,Ue,Y.children,W,De,qe)}}dt&1&&Y.children!==ie.children&&C(ct,ie.children)}else!Ze&&nt==null&&xe(ct,ie,mt,Mt,W,De,Ue);((wt=Mt.onVnodeUpdated)||ut)&&qr(()=>{wt&&na(wt,W,ie,Y),ut&&il(ie,Y,W,"updated")},De)},he=(Y,ie,W,De,Ue,Ne,Ze)=>{for(let ct=0;ct<ie.length;ct++){const dt=Y[ct],nt=ie[ct],ut=dt.el&&(dt.type===gn||!ll(dt,nt)||dt.shapeFlag&70)?I(dt.el):W;Z(dt,nt,ut,null,De,Ue,Ne,Ze,!0)}},xe=(Y,ie,W,De,Ue,Ne,Ze)=>{if(W!==De){if(W!==ri)for(const ct in W)!rp(ct)&&!(ct in De)&&d(Y,ct,W[ct],null,Ze,ie.children,Ue,Ne,qe);for(const ct in De){if(rp(ct))continue;const dt=De[ct],nt=W[ct];dt!==nt&&ct!=="value"&&d(Y,ct,nt,dt,Ze,ie.children,Ue,Ne,qe)}"value"in De&&d(Y,"value",W.value,De.value)}},we=(Y,ie,W,De,Ue,Ne,Ze,ct,dt)=>{const nt=ie.el=Y?Y.el:l(""),ut=ie.anchor=Y?Y.anchor:l("");let{patchFlag:mt,dynamicChildren:Mt,slotScopeIds:wt}=ie;wt&&(ct=ct?ct.concat(wt):wt),Y==null?(a(nt,W,De),a(ut,W,De),U(ie.children,W,ut,Ue,Ne,Ze,ct,dt)):mt>0&&mt&64&&Mt&&Y.dynamicChildren?(he(Y.dynamicChildren,Mt,W,Ue,Ne,Ze,ct),(ie.key!=null||Ue&&ie===Ue.subTree)&&rv(Y,ie,!0)):$e(Y,ie,W,ut,Ue,Ne,Ze,ct,dt)},oe=(Y,ie,W,De,Ue,Ne,Ze,ct,dt)=>{ie.slotScopeIds=ct,Y==null?ie.shapeFlag&512?Ue.ctx.activate(ie,W,De,Ze,dt):ke(ie,W,De,Ue,Ne,Ze,dt):tt(Y,ie,dt)},ke=(Y,ie,W,De,Ue,Ne,Ze)=>{const ct=Y.component=$A(Y,De,Ue);if(sm(Y)&&(ct.ctx.renderer=Oe),VA(ct),ct.asyncDep){if(Ue&&Ue.registerDep(ct,et),!Y.el){const dt=ct.subTree=le(Vs);ce(null,dt,ie,W)}return}et(ct,Y,ie,W,Ue,Ne,Ze)},tt=(Y,ie,W)=>{const De=ie.component=Y.component;if(Jk(Y,ie,W))if(De.asyncDep&&!De.asyncResolved){Ve(De,ie,W);return}else De.next=ie,Hk(De.update),De.update();else ie.el=Y.el,De.vnode=ie},et=(Y,ie,W,De,Ue,Ne,Ze)=>{const ct=()=>{if(Y.isMounted){let{next:ut,bu:mt,u:Mt,parent:wt,vnode:Ge}=Y,tn=ut,Zt;rl(Y,!1),ut?(ut.el=Ge.el,Ve(Y,ut,Ze)):ut=Ge,mt&&sp(mt),(Zt=ut.props&&ut.props.onVnodeBeforeUpdate)&&na(Zt,wt,ut,Ge),rl(Y,!0);const dn=qg(Y),zn=Y.subTree;Y.subTree=dn,Z(zn,dn,I(zn.el),Se(zn),Y,Ue,Ne),ut.el=dn.el,tn===null&&Qk(Y,dn.el),Mt&&qr(Mt,Ue),(Zt=ut.props&&ut.props.onVnodeUpdated)&&qr(()=>na(Zt,wt,ut,Ge),Ue)}else{let ut;const{el:mt,props:Mt}=ie,{bm:wt,m:Ge,parent:tn}=Y,Zt=ap(ie);if(rl(Y,!1),wt&&sp(wt),!Zt&&(ut=Mt&&Mt.onVnodeBeforeMount)&&na(ut,tn,ie),rl(Y,!0),mt&&ft){const dn=()=>{Y.subTree=qg(Y),ft(mt,Y.subTree,Y,Ue,null)};Zt?ie.type.__asyncLoader().then(()=>!Y.isUnmounted&&dn()):dn()}else{const dn=Y.subTree=qg(Y);Z(null,dn,W,De,Y,Ue,Ne),ie.el=dn.el}if(Ge&&qr(Ge,Ue),!Zt&&(ut=Mt&&Mt.onVnodeMounted)){const dn=ie;qr(()=>na(ut,tn,dn),Ue)}(ie.shapeFlag&256||tn&&ap(tn.vnode)&&tn.vnode.shapeFlag&256)&&Y.a&&qr(Y.a,Ue),Y.isMounted=!0,ie=W=De=null}},dt=Y.effect=new jy(ct,()=>Xy(nt),Y.scope),nt=Y.update=()=>dt.run();nt.id=Y.uid,rl(Y,!0),nt()},Ve=(Y,ie,W)=>{ie.component=Y;const De=Y.vnode.props;Y.vnode=ie,Y.next=null,TA(Y,ie.props,De,W),kA(Y,ie.children,W),eu(),Jx(),tu()},$e=(Y,ie,W,De,Ue,Ne,Ze,ct,dt=!1)=>{const nt=Y&&Y.children,ut=Y?Y.shapeFlag:0,mt=ie.children,{patchFlag:Mt,shapeFlag:wt}=ie;if(Mt>0){if(Mt&128){kt(nt,mt,W,De,Ue,Ne,Ze,ct,dt);return}else if(Mt&256){He(nt,mt,W,De,Ue,Ne,Ze,ct,dt);return}}wt&8?(ut&16&&qe(nt,Ue,Ne),mt!==nt&&C(W,mt)):ut&16?wt&16?kt(nt,mt,W,De,Ue,Ne,Ze,ct,dt):qe(nt,Ue,Ne,!0):(ut&8&&C(W,""),wt&16&&U(mt,W,De,Ue,Ne,Ze,ct,dt))},He=(Y,ie,W,De,Ue,Ne,Ze,ct,dt)=>{Y=Y||Mc,ie=ie||Mc;const nt=Y.length,ut=ie.length,mt=Math.min(nt,ut);let Mt;for(Mt=0;Mt<mt;Mt++){const wt=ie[Mt]=dt?fo(ie[Mt]):sa(ie[Mt]);Z(Y[Mt],wt,W,null,Ue,Ne,Ze,ct,dt)}nt>ut?qe(Y,Ue,Ne,!0,!1,mt):U(ie,W,De,Ue,Ne,Ze,ct,dt,mt)},kt=(Y,ie,W,De,Ue,Ne,Ze,ct,dt)=>{let nt=0;const ut=ie.length;let mt=Y.length-1,Mt=ut-1;for(;nt<=mt&&nt<=Mt;){const wt=Y[nt],Ge=ie[nt]=dt?fo(ie[nt]):sa(ie[nt]);if(ll(wt,Ge))Z(wt,Ge,W,null,Ue,Ne,Ze,ct,dt);else break;nt++}for(;nt<=mt&&nt<=Mt;){const wt=Y[mt],Ge=ie[Mt]=dt?fo(ie[Mt]):sa(ie[Mt]);if(ll(wt,Ge))Z(wt,Ge,W,null,Ue,Ne,Ze,ct,dt);else break;mt--,Mt--}if(nt>mt){if(nt<=Mt){const wt=Mt+1,Ge=wt<ut?ie[wt].el:De;for(;nt<=Mt;)Z(null,ie[nt]=dt?fo(ie[nt]):sa(ie[nt]),W,Ge,Ue,Ne,Ze,ct,dt),nt++}}else if(nt>Mt)for(;nt<=mt;)rt(Y[nt],Ue,Ne,!0),nt++;else{const wt=nt,Ge=nt,tn=new Map;for(nt=Ge;nt<=Mt;nt++){const fn=ie[nt]=dt?fo(ie[nt]):sa(ie[nt]);fn.key!=null&&tn.set(fn.key,nt)}let Zt,dn=0;const zn=Mt-Ge+1;let at=!1,jt=0;const qt=new Array(zn);for(nt=0;nt<zn;nt++)qt[nt]=0;for(nt=wt;nt<=mt;nt++){const fn=Y[nt];if(dn>=zn){rt(fn,Ue,Ne,!0);continue}let Ot;if(fn.key!=null)Ot=tn.get(fn.key);else for(Zt=Ge;Zt<=Mt;Zt++)if(qt[Zt-Ge]===0&&ll(fn,ie[Zt])){Ot=Zt;break}Ot===void 0?rt(fn,Ue,Ne,!0):(qt[Ot-Ge]=nt+1,Ot>=jt?jt=Ot:at=!0,Z(fn,ie[Ot],W,null,Ue,Ne,Ze,ct,dt),dn++)}const Dn=at?RA(qt):Mc;for(Zt=Dn.length-1,nt=zn-1;nt>=0;nt--){const fn=Ge+nt,Ot=ie[fn],Fr=fn+1<ut?ie[fn+1].el:De;qt[nt]===0?Z(null,Ot,W,Fr,Ue,Ne,Ze,ct,dt):at&&(Zt<0||nt!==Dn[Zt]?Ct(Ot,W,Fr,2):Zt--)}}},Ct=(Y,ie,W,De,Ue=null)=>{const{el:Ne,type:Ze,transition:ct,children:dt,shapeFlag:nt}=Y;if(nt&6){Ct(Y.component.subTree,ie,W,De);return}if(nt&128){Y.suspense.move(ie,W,De);return}if(nt&64){Ze.move(Y,ie,W,Oe);return}if(Ze===gn){a(Ne,ie,W);for(let mt=0;mt<dt.length;mt++)Ct(dt[mt],ie,W,De);a(Y.anchor,ie,W);return}if(Ze===Zg){ye(Y,ie,W);return}if(De!==2&&nt&1&&ct)if(De===0)ct.beforeEnter(Ne),a(Ne,ie,W),qr(()=>ct.enter(Ne),Ue);else{const{leave:mt,delayLeave:Mt,afterLeave:wt}=ct,Ge=()=>a(Ne,ie,W),tn=()=>{mt(Ne,()=>{Ge(),wt&&wt()})};Mt?Mt(Ne,Ge,tn):tn()}else a(Ne,ie,W)},rt=(Y,ie,W,De=!1,Ue=!1)=>{const{type:Ne,props:Ze,ref:ct,children:dt,dynamicChildren:nt,shapeFlag:ut,patchFlag:mt,dirs:Mt}=Y;if(ct!=null&&k_(ct,null,W,Y,!0),ut&256){ie.ctx.deactivate(Y);return}const wt=ut&1&&Mt,Ge=!ap(Y);let tn;if(Ge&&(tn=Ze&&Ze.onVnodeBeforeUnmount)&&na(tn,ie,Y),ut&6)Lt(Y.component,W,De);else{if(ut&128){Y.suspense.unmount(W,De);return}wt&&il(Y,null,ie,"beforeUnmount"),ut&64?Y.type.remove(Y,ie,W,Ue,Oe,De):nt&&(Ne!==gn||mt>0&&mt&64)?qe(nt,ie,W,!1,!0):(Ne===gn&&mt&384||!Ue&&ut&16)&&qe(dt,ie,W),De&&It(Y)}(Ge&&(tn=Ze&&Ze.onVnodeUnmounted)||wt)&&qr(()=>{tn&&na(tn,ie,Y),wt&&il(Y,null,ie,"unmounted")},W)},It=Y=>{const{type:ie,el:W,anchor:De,transition:Ue}=Y;if(ie===gn){Vt(W,De);return}if(ie===Zg){Ae(Y);return}const Ne=()=>{u(W),Ue&&!Ue.persisted&&Ue.afterLeave&&Ue.afterLeave()};if(Y.shapeFlag&1&&Ue&&!Ue.persisted){const{leave:Ze,delayLeave:ct}=Ue,dt=()=>Ze(W,Ne);ct?ct(Y.el,Ne,dt):dt()}else Ne()},Vt=(Y,ie)=>{let W;for(;Y!==ie;)W=M(Y),u(Y),Y=W;u(ie)},Lt=(Y,ie,W)=>{const{bum:De,scope:Ue,update:Ne,subTree:Ze,um:ct}=Y;De&&sp(De),Ue.stop(),Ne&&(Ne.active=!1,rt(Ze,Y,ie,W)),ct&&qr(ct,ie),qr(()=>{Y.isUnmounted=!0},ie),ie&&ie.pendingBranch&&!ie.isUnmounted&&Y.asyncDep&&!Y.asyncResolved&&Y.suspenseId===ie.pendingId&&(ie.deps--,ie.deps===0&&ie.resolve())},qe=(Y,ie,W,De=!1,Ue=!1,Ne=0)=>{for(let Ze=Ne;Ze<Y.length;Ze++)rt(Y[Ze],ie,W,De,Ue)},Se=Y=>Y.shapeFlag&6?Se(Y.component.subTree):Y.shapeFlag&128?Y.suspense.next():M(Y.anchor||Y.el),Ye=(Y,ie,W)=>{Y==null?ie._vnode&&rt(ie._vnode,null,null,!0):Z(ie._vnode||null,Y,ie,null,null,null,W),Jx(),fS(),ie._vnode=Y},Oe={p:Z,um:rt,m:Ct,r:It,mt:ke,mc:U,pc:$e,pbc:he,n:Se,o:e};let je,ft;return t&&([je,ft]=t(Oe)),{render:Ye,hydrate:je,createApp:wA(Ye,je)}}function rl({effect:e,update:t},i){e.allowRecurse=t.allowRecurse=i}function rv(e,t,i=!1){const a=e.children,u=t.children;if(en(a)&&en(u))for(let d=0;d<a.length;d++){const p=a[d];let l=u[d];l.shapeFlag&1&&!l.dynamicChildren&&((l.patchFlag<=0||l.patchFlag===32)&&(l=u[d]=fo(u[d]),l.el=p.el),i||rv(p,l)),l.type===gd&&(l.el=p.el)}}function RA(e){const t=e.slice(),i=[0];let a,u,d,p,l;const b=e.length;for(a=0;a<b;a++){const w=e[a];if(w!==0){if(u=i[i.length-1],e[u]<w){t[a]=u,i.push(a);continue}for(d=0,p=i.length-1;d<p;)l=d+p>>1,e[i[l]]<w?d=l+1:p=l;w<e[i[d]]&&(d>0&&(t[a]=i[d-1]),i[d]=a)}}for(d=i.length,p=i[d-1];d-- >0;)i[d]=p,p=t[p];return i}const MA=e=>e.__isTeleport,Ah=e=>e&&(e.disabled||e.disabled===""),ub=e=>typeof SVGElement<"u"&&e instanceof SVGElement,A_=(e,t)=>{const i=e&&e.to;return Ei(i)?t?t(i):null:i},DA={__isTeleport:!0,process(e,t,i,a,u,d,p,l,b,w){const{mc:C,pc:I,pbc:M,o:{insert:O,querySelector:j,createText:Z,createComment:ue}}=w,ce=Ah(t.props);let{shapeFlag:ve,children:ye,dynamicChildren:Ae}=t;if(e==null){const Be=t.el=Z(""),Le=t.anchor=Z("");O(Be,i,a),O(Le,i,a);const Ie=t.target=A_(t.props,j),U=t.targetAnchor=Z("");Ie&&(O(U,Ie),p=p||ub(Ie));const H=(he,xe)=>{ve&16&&C(ye,he,xe,u,d,p,l,b)};ce?H(i,Le):Ie&&H(Ie,U)}else{t.el=e.el;const Be=t.anchor=e.anchor,Le=t.target=e.target,Ie=t.targetAnchor=e.targetAnchor,U=Ah(e.props),H=U?i:Le,he=U?Be:Ie;if(p=p||ub(Le),Ae?(M(e.dynamicChildren,Ae,H,u,d,p,l),rv(e,t,!0)):b||I(e,t,H,he,u,d,p,l,!1),ce)U||Ff(t,i,Be,w,1);else if((t.props&&t.props.to)!==(e.props&&e.props.to)){const xe=t.target=A_(t.props,j);xe&&Ff(t,xe,null,w,0)}else U&&Ff(t,Le,Ie,w,1)}DS(t)},remove(e,t,i,a,{um:u,o:{remove:d}},p){const{shapeFlag:l,children:b,anchor:w,targetAnchor:C,target:I,props:M}=e;if(I&&d(C),(p||!Ah(M))&&(d(w),l&16))for(let O=0;O<b.length;O++){const j=b[O];u(j,t,i,!0,!!j.dynamicChildren)}},move:Ff,hydrate:LA};function Ff(e,t,i,{o:{insert:a},m:u},d=2){d===0&&a(e.targetAnchor,t,i);const{el:p,anchor:l,shapeFlag:b,children:w,props:C}=e,I=d===2;if(I&&a(p,t,i),(!I||Ah(C))&&b&16)for(let M=0;M<w.length;M++)u(w[M],t,i,2);I&&a(l,t,i)}function LA(e,t,i,a,u,d,{o:{nextSibling:p,parentNode:l,querySelector:b}},w){const C=t.target=A_(t.props,b);if(C){const I=C._lpa||C.firstChild;if(t.shapeFlag&16)if(Ah(t.props))t.anchor=w(p(e),t,l(e),i,a,u,d),t.targetAnchor=I;else{t.anchor=p(e);let M=I;for(;M;)if(M=p(M),M&&M.nodeType===8&&M.data==="teleport anchor"){t.targetAnchor=M,C._lpa=t.targetAnchor&&p(t.targetAnchor);break}w(I,t,C,i,a,u,d)}DS(t)}return t.anchor&&p(t.anchor)}const zA=DA;function DS(e){const t=e.ctx;if(t&&t.ut){let i=e.children[0].el;for(;i!==e.targetAnchor;)i.nodeType===1&&i.setAttribute("data-v-owner",t.uid),i=i.nextSibling;t.ut()}}const gn=Symbol.for("v-fgt"),gd=Symbol.for("v-txt"),Vs=Symbol.for("v-cmt"),Zg=Symbol.for("v-stc"),Ph=[];let Us=null;function ln(e=!1){Ph.push(Us=e?null:[])}function OA(){Ph.pop(),Us=Ph[Ph.length-1]||null}let Zh=1;function hb(e){Zh+=e}function LS(e){return e.dynamicChildren=Zh>0?Us||Mc:null,OA(),Zh>0&&Us&&Us.push(e),e}function pn(e,t,i,a,u,d){return LS(Bt(e,t,i,a,u,d,!0))}function om(e,t,i,a,u){return LS(le(e,t,i,a,u,!0))}function P_(e){return e?e.__v_isVNode===!0:!1}function ll(e,t){return e.type===t.type&&e.key===t.key}const lm="__vInternal",zS=({key:e})=>e??null,op=({ref:e,ref_key:t,ref_for:i})=>(typeof e=="number"&&(e=""+e),e!=null?Ei(e)||Kn(e)||cn(e)?{i:Hr,r:e,k:t,f:!!i}:e:null);function Bt(e,t=null,i=null,a=0,u=null,d=e===gn?0:1,p=!1,l=!1){const b={__v_isVNode:!0,__v_skip:!0,type:e,props:t,key:t&&zS(t),ref:t&&op(t),scopeId:gS,slotScopeIds:null,children:i,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetAnchor:null,staticCount:0,shapeFlag:d,patchFlag:a,dynamicProps:u,dynamicChildren:null,appContext:null,ctx:Hr};return l?(sv(b,i),d&128&&e.normalize(b)):i&&(b.shapeFlag|=Ei(i)?8:16),Zh>0&&!p&&Us&&(b.patchFlag>0||d&6)&&b.patchFlag!==32&&Us.push(b),b}const le=BA;function BA(e,t=null,i=null,a=0,u=null,d=!1){if((!e||e===TS)&&(e=Vs),P_(e)){const l=La(e,t,!0);return i&&sv(l,i),Zh>0&&!d&&Us&&(l.shapeFlag&6?Us[Us.indexOf(e)]=l:Us.push(l)),l.patchFlag|=-2,l}if(WA(e)&&(e=e.__vccOpts),t){t=FA(t);let{class:l,style:b}=t;l&&!Ei(l)&&(t.class=Jp(l)),ni(b)&&(sS(b)&&!en(b)&&(b=Ai({},b)),t.style=$y(b))}const p=Ei(e)?1:eA(e)?128:MA(e)?64:ni(e)?4:cn(e)?2:0;return Bt(e,t,i,a,u,p,d,!0)}function FA(e){return e?sS(e)||lm in e?Ai({},e):e:null}function La(e,t,i=!1){const{props:a,ref:u,patchFlag:d,children:p}=e,l=t?Pn(a||{},t):a;return{__v_isVNode:!0,__v_skip:!0,type:e.type,props:l,key:l&&zS(l),ref:t&&t.ref?i&&u?en(u)?u.concat(op(t)):[u,op(t)]:op(t):u,scopeId:e.scopeId,slotScopeIds:e.slotScopeIds,children:p,target:e.target,targetAnchor:e.targetAnchor,staticCount:e.staticCount,shapeFlag:e.shapeFlag,patchFlag:t&&e.type!==gn?d===-1?16:d|16:d,dynamicProps:e.dynamicProps,dynamicChildren:e.dynamicChildren,appContext:e.appContext,dirs:e.dirs,transition:e.transition,component:e.component,suspense:e.suspense,ssContent:e.ssContent&&La(e.ssContent),ssFallback:e.ssFallback&&La(e.ssFallback),el:e.el,anchor:e.anchor,ctx:e.ctx,ce:e.ce}}function To(e=" ",t=0){return le(gd,null,e,t)}function ar(e="",t=!1){return t?(ln(),om(Vs,null,e)):le(Vs,null,e)}function sa(e){return e==null||typeof e=="boolean"?le(Vs):en(e)?le(gn,null,e.slice()):typeof e=="object"?fo(e):le(gd,null,String(e))}function fo(e){return e.el===null&&e.patchFlag!==-1||e.memo?e:La(e)}function sv(e,t){let i=0;const{shapeFlag:a}=e;if(t==null)t=null;else if(en(t))i=16;else if(typeof t=="object")if(a&65){const u=t.default;u&&(u._c&&(u._d=!1),sv(e,u()),u._c&&(u._d=!0));return}else{i=32;const u=t._;!u&&!(lm in t)?t._ctx=Hr:u===3&&Hr&&(Hr.slots._===1?t._=1:(t._=2,e.patchFlag|=1024))}else cn(t)?(t={default:t,_ctx:Hr},i=32):(t=String(t),a&64?(i=16,t=[To(t)]):i=8);e.children=t,e.shapeFlag|=i}function Pn(...e){const t={};for(let i=0;i<e.length;i++){const a=e[i];for(const u in a)if(u==="class")t.class!==a.class&&(t.class=Jp([t.class,a.class]));else if(u==="style")t.style=$y([t.style,a.style]);else if(Yp(u)){const d=t[u],p=a[u];p&&d!==p&&!(en(d)&&d.includes(p))&&(t[u]=d?[].concat(d,p):p)}else u!==""&&(t[u]=a[u])}return t}function na(e,t,i,a=null){Ts(e,t,7,[i,a])}const NA=IS();let UA=0;function $A(e,t,i){const a=e.type,u=(t?t.appContext:e.appContext)||NA,d={uid:UA++,vnode:e,type:a,parent:t,appContext:u,root:null,next:null,subTree:null,effect:null,update:null,scope:new Ww(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:t?t.provides:Object.create(u.provides),accessCache:null,renderCache:[],components:null,directives:null,propsOptions:AS(a,u),emitsOptions:mS(a,u),emit:null,emitted:null,propsDefaults:ri,inheritAttrs:a.inheritAttrs,ctx:ri,data:ri,props:ri,attrs:ri,slots:ri,refs:ri,setupState:ri,setupContext:null,attrsProxy:null,slotsProxy:null,suspense:i,suspenseId:i?i.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return d.ctx={_:d},d.root=t?t.root:d,d.emit=Yk.bind(null,d),e.ce&&e.ce(d),d}let Vi=null;const av=()=>Vi||Hr;let ov,xc,db="__VUE_INSTANCE_SETTERS__";(xc=v_()[db])||(xc=v_()[db]=[]),xc.push(e=>Vi=e),ov=e=>{xc.length>1?xc.forEach(t=>t(e)):xc[0](e)};const Nc=e=>{ov(e),e.scope.on()},pl=()=>{Vi&&Vi.scope.off(),ov(null)};function OS(e){return e.vnode.shapeFlag&4}let Yh=!1;function VA(e,t=!1){Yh=t;const{props:i,children:a}=e.vnode,u=OS(e);EA(e,i,u,t),IA(e,a);const d=u?jA(e,t):void 0;return Yh=!1,d}function jA(e,t){const i=e.type;e.accessCache=Object.create(null),e.proxy=em(new Proxy(e.ctx,mA));const{setup:a}=i;if(a){const u=e.setupContext=a.length>1?qA(e):null;Nc(e),eu();const d=Eo(a,e,0,[e.props,u]);if(tu(),pl(),Vw(d)){if(d.then(pl,pl),t)return d.then(p=>{fb(e,p,t)}).catch(p=>{nm(p,e,0)});e.asyncDep=d}else fb(e,d,t)}else BS(e,t)}function fb(e,t,i){cn(t)?e.type.__ssrInlineRender?e.ssrRender=t:e.render=t:ni(t)&&(e.setupState=cS(t)),BS(e,i)}let pb;function BS(e,t,i){const a=e.type;if(!e.render){if(!t&&pb&&!a.render){const u=a.template||nv(e).template;if(u){const{isCustomElement:d,compilerOptions:p}=e.appContext.config,{delimiters:l,compilerOptions:b}=a,w=Ai(Ai({isCustomElement:d,delimiters:l},p),b);a.render=pb(u,w)}}e.render=a.render||$s}Nc(e),eu(),gA(e),tu(),pl()}function GA(e){return e.attrsProxy||(e.attrsProxy=new Proxy(e.attrs,{get(t,i){return Zr(e,"get","$attrs"),t[i]}}))}function qA(e){const t=i=>{e.exposed=i||{}};return{get attrs(){return GA(e)},slots:e.slots,emit:e.emit,expose:t}}function cm(e){if(e.exposed)return e.exposeProxy||(e.exposeProxy=new Proxy(cS(em(e.exposed)),{get(t,i){if(i in t)return t[i];if(i in kh)return kh[i](e)},has(t,i){return i in t||i in kh}}))}function HA(e,t=!0){return cn(e)?e.displayName||e.name:e.name||t&&e.__name}function WA(e){return cn(e)&&"__vccOpts"in e}const Ce=(e,t)=>jk(e,t,Yh);function Ro(e,t,i){const a=arguments.length;return a===2?ni(t)&&!en(t)?P_(t)?le(e,null,[t]):le(e,t):le(e,null,t):(a>3?i=Array.prototype.slice.call(arguments,2):a===3&&P_(i)&&(i=[i]),le(e,t,i))}const ZA=Symbol.for("v-scx"),YA=()=>Jn(ZA),XA="3.3.4",KA="http://www.w3.org/2000/svg",cl=typeof document<"u"?document:null,mb=cl&&cl.createElement("template"),JA={insert:(e,t,i)=>{t.insertBefore(e,i||null)},remove:e=>{const t=e.parentNode;t&&t.removeChild(e)},createElement:(e,t,i,a)=>{const u=t?cl.createElementNS(KA,e):cl.createElement(e,i?{is:i}:void 0);return e==="select"&&a&&a.multiple!=null&&u.setAttribute("multiple",a.multiple),u},createText:e=>cl.createTextNode(e),createComment:e=>cl.createComment(e),setText:(e,t)=>{e.nodeValue=t},setElementText:(e,t)=>{e.textContent=t},parentNode:e=>e.parentNode,nextSibling:e=>e.nextSibling,querySelector:e=>cl.querySelector(e),setScopeId(e,t){e.setAttribute(t,"")},insertStaticContent(e,t,i,a,u,d){const p=i?i.previousSibling:t.lastChild;if(u&&(u===d||u.nextSibling))for(;t.insertBefore(u.cloneNode(!0),i),!(u===d||!(u=u.nextSibling)););else{mb.innerHTML=a?`<svg>${e}</svg>`:e;const l=mb.content;if(a){const b=l.firstChild;for(;b.firstChild;)l.appendChild(b.firstChild);l.removeChild(b)}t.insertBefore(l,i)}return[p?p.nextSibling:t.firstChild,i?i.previousSibling:t.lastChild]}};function QA(e,t,i){const a=e._vtc;a&&(t=(t?[t,...a]:[...a]).join(" ")),t==null?e.removeAttribute("class"):i?e.setAttribute("class",t):e.className=t}function eP(e,t,i){const a=e.style,u=Ei(i);if(i&&!u){if(t&&!Ei(t))for(const d in t)i[d]==null&&R_(a,d,"");for(const d in i)R_(a,d,i[d])}else{const d=a.display;u?t!==i&&(a.cssText=i):t&&e.removeAttribute("style"),"_vod"in e&&(a.display=d)}}const gb=/\s*!important$/;function R_(e,t,i){if(en(i))i.forEach(a=>R_(e,t,a));else if(i==null&&(i=""),t.startsWith("--"))e.setProperty(t,i);else{const a=tP(e,t);gb.test(i)?e.setProperty(Jc(a),i.replace(gb,""),"important"):e[a]=i}}const _b=["Webkit","Moz","ms"],Yg={};function tP(e,t){const i=Yg[t];if(i)return i;let a=Cs(t);if(a!=="filter"&&a in e)return Yg[t]=a;a=Qc(a);for(let u=0;u<_b.length;u++){const d=_b[u]+a;if(d in e)return Yg[t]=d}return t}const yb="http://www.w3.org/1999/xlink";function nP(e,t,i,a,u){if(a&&t.startsWith("xlink:"))i==null?e.removeAttributeNS(yb,t.slice(6,t.length)):e.setAttributeNS(yb,t,i);else{const d=lk(t);i==null||d&&!qw(i)?e.removeAttribute(t):e.setAttribute(t,d?"":i)}}function iP(e,t,i,a,u,d,p){if(t==="innerHTML"||t==="textContent"){a&&p(a,u,d),e[t]=i??"";return}const l=e.tagName;if(t==="value"&&l!=="PROGRESS"&&!l.includes("-")){e._value=i;const w=l==="OPTION"?e.getAttribute("value"):e.value,C=i??"";w!==C&&(e.value=C),i==null&&e.removeAttribute(t);return}let b=!1;if(i===""||i==null){const w=typeof e[t];w==="boolean"?i=qw(i):i==null&&w==="string"?(i="",b=!0):w==="number"&&(i=0,b=!0)}try{e[t]=i}catch{}b&&e.removeAttribute(t)}function Cc(e,t,i,a){e.addEventListener(t,i,a)}function rP(e,t,i,a){e.removeEventListener(t,i,a)}function sP(e,t,i,a,u=null){const d=e._vei||(e._vei={}),p=d[t];if(a&&p)p.value=a;else{const[l,b]=aP(t);if(a){const w=d[t]=cP(a,u);Cc(e,l,w,b)}else p&&(rP(e,l,p,b),d[t]=void 0)}}const vb=/(?:Once|Passive|Capture)$/;function aP(e){let t;if(vb.test(e)){t={};let a;for(;a=e.match(vb);)e=e.slice(0,e.length-a[0].length),t[a[0].toLowerCase()]=!0}return[e[2]===":"?e.slice(3):Jc(e.slice(2)),t]}let Xg=0;const oP=Promise.resolve(),lP=()=>Xg||(oP.then(()=>Xg=0),Xg=Date.now());function cP(e,t){const i=a=>{if(!a._vts)a._vts=Date.now();else if(a._vts<=i.attached)return;Ts(uP(a,i.value),t,5,[a])};return i.value=e,i.attached=lP(),i}function uP(e,t){if(en(t)){const i=e.stopImmediatePropagation;return e.stopImmediatePropagation=()=>{i.call(e),e._stopped=!0},t.map(a=>u=>!u._stopped&&a&&a(u))}else return t}const xb=/^on[a-z]/,hP=(e,t,i,a,u=!1,d,p,l,b)=>{t==="class"?QA(e,a,u):t==="style"?eP(e,i,a):Yp(t)?By(t)||sP(e,t,i,a,p):(t[0]==="."?(t=t.slice(1),!0):t[0]==="^"?(t=t.slice(1),!1):dP(e,t,a,u))?iP(e,t,a,d,p,l,b):(t==="true-value"?e._trueValue=a:t==="false-value"&&(e._falseValue=a),nP(e,t,a,u))};function dP(e,t,i,a){return a?!!(t==="innerHTML"||t==="textContent"||t in e&&xb.test(t)&&cn(i)):t==="spellcheck"||t==="draggable"||t==="translate"||t==="form"||t==="list"&&e.tagName==="INPUT"||t==="type"&&e.tagName==="TEXTAREA"||xb.test(t)&&Ei(i)?!1:t in e}const lo="transition",_h="animation",za=(e,{slots:t})=>Ro(rA,NS(e),t);za.displayName="Transition";const FS={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String},fP=za.props=Ai({},xS,FS),sl=(e,t=[])=>{en(e)?e.forEach(i=>i(...t)):e&&e(...t)},bb=e=>e?en(e)?e.some(t=>t.length>1):e.length>1:!1;function NS(e){const t={};for(const we in e)we in FS||(t[we]=e[we]);if(e.css===!1)return t;const{name:i="v",type:a,duration:u,enterFromClass:d=`${i}-enter-from`,enterActiveClass:p=`${i}-enter-active`,enterToClass:l=`${i}-enter-to`,appearFromClass:b=d,appearActiveClass:w=p,appearToClass:C=l,leaveFromClass:I=`${i}-leave-from`,leaveActiveClass:M=`${i}-leave-active`,leaveToClass:O=`${i}-leave-to`}=e,j=pP(u),Z=j&&j[0],ue=j&&j[1],{onBeforeEnter:ce,onEnter:ve,onEnterCancelled:ye,onLeave:Ae,onLeaveCancelled:Be,onBeforeAppear:Le=ce,onAppear:Ie=ve,onAppearCancelled:U=ye}=t,H=(we,oe,ke)=>{uo(we,oe?C:l),uo(we,oe?w:p),ke&&ke()},he=(we,oe)=>{we._isLeaving=!1,uo(we,I),uo(we,O),uo(we,M),oe&&oe()},xe=we=>(oe,ke)=>{const tt=we?Ie:ve,et=()=>H(oe,we,ke);sl(tt,[oe,et]),wb(()=>{uo(oe,we?b:d),ka(oe,we?C:l),bb(tt)||Sb(oe,a,Z,et)})};return Ai(t,{onBeforeEnter(we){sl(ce,[we]),ka(we,d),ka(we,p)},onBeforeAppear(we){sl(Le,[we]),ka(we,b),ka(we,w)},onEnter:xe(!1),onAppear:xe(!0),onLeave(we,oe){we._isLeaving=!0;const ke=()=>he(we,oe);ka(we,I),$S(),ka(we,M),wb(()=>{we._isLeaving&&(uo(we,I),ka(we,O),bb(Ae)||Sb(we,a,ue,ke))}),sl(Ae,[we,ke])},onEnterCancelled(we){H(we,!1),sl(ye,[we])},onAppearCancelled(we){H(we,!0),sl(U,[we])},onLeaveCancelled(we){he(we),sl(Be,[we])}})}function pP(e){if(e==null)return null;if(ni(e))return[Kg(e.enter),Kg(e.leave)];{const t=Kg(e);return[t,t]}}function Kg(e){return nk(e)}function ka(e,t){t.split(/\s+/).forEach(i=>i&&e.classList.add(i)),(e._vtc||(e._vtc=new Set)).add(t)}function uo(e,t){t.split(/\s+/).forEach(a=>a&&e.classList.remove(a));const{_vtc:i}=e;i&&(i.delete(t),i.size||(e._vtc=void 0))}function wb(e){requestAnimationFrame(()=>{requestAnimationFrame(e)})}let mP=0;function Sb(e,t,i,a){const u=e._endId=++mP,d=()=>{u===e._endId&&a()};if(i)return setTimeout(d,i);const{type:p,timeout:l,propCount:b}=US(e,t);if(!p)return a();const w=p+"end";let C=0;const I=()=>{e.removeEventListener(w,M),d()},M=O=>{O.target===e&&++C>=b&&I()};setTimeout(()=>{C<b&&I()},l+1),e.addEventListener(w,M)}function US(e,t){const i=window.getComputedStyle(e),a=j=>(i[j]||"").split(", "),u=a(`${lo}Delay`),d=a(`${lo}Duration`),p=Eb(u,d),l=a(`${_h}Delay`),b=a(`${_h}Duration`),w=Eb(l,b);let C=null,I=0,M=0;t===lo?p>0&&(C=lo,I=p,M=d.length):t===_h?w>0&&(C=_h,I=w,M=b.length):(I=Math.max(p,w),C=I>0?p>w?lo:_h:null,M=C?C===lo?d.length:b.length:0);const O=C===lo&&/\b(transform|all)(,|$)/.test(a(`${lo}Property`).toString());return{type:C,timeout:I,propCount:M,hasTransform:O}}function Eb(e,t){for(;e.length<t.length;)e=e.concat(e);return Math.max(...t.map((i,a)=>Tb(i)+Tb(e[a])))}function Tb(e){return Number(e.slice(0,-1).replace(",","."))*1e3}function $S(){return document.body.offsetHeight}const VS=new WeakMap,jS=new WeakMap,GS={name:"TransitionGroup",props:Ai({},fP,{tag:String,moveClass:String}),setup(e,{slots:t}){const i=av(),a=vS();let u,d;return SS(()=>{if(!u.length)return;const p=e.moveClass||`${e.name||"v"}-move`;if(!bP(u[0].el,i.vnode.el,p))return;u.forEach(yP),u.forEach(vP);const l=u.filter(xP);$S(),l.forEach(b=>{const w=b.el,C=w.style;ka(w,p),C.transform=C.webkitTransform=C.transitionDuration="";const I=w._moveCb=M=>{M&&M.target!==w||(!M||/transform$/.test(M.propertyName))&&(w.removeEventListener("transitionend",I),w._moveCb=null,uo(w,p))};w.addEventListener("transitionend",I)})}),()=>{const p=sn(e),l=NS(p);let b=p.tag||gn;u=d,d=t.default?Jy(t.default()):[];for(let w=0;w<d.length;w++){const C=d[w];C.key!=null&&Hh(C,qh(C,l,a,i))}if(u)for(let w=0;w<u.length;w++){const C=u[w];Hh(C,qh(C,l,a,i)),VS.set(C,C.el.getBoundingClientRect())}return le(b,null,d)}}},gP=e=>delete e.mode;GS.props;const _P=GS;function yP(e){const t=e.el;t._moveCb&&t._moveCb(),t._enterCb&&t._enterCb()}function vP(e){jS.set(e,e.el.getBoundingClientRect())}function xP(e){const t=VS.get(e),i=jS.get(e),a=t.left-i.left,u=t.top-i.top;if(a||u){const d=e.el.style;return d.transform=d.webkitTransform=`translate(${a}px,${u}px)`,d.transitionDuration="0s",e}}function bP(e,t,i){const a=e.cloneNode();e._vtc&&e._vtc.forEach(p=>{p.split(/\s+/).forEach(l=>l&&a.classList.remove(l))}),i.split(/\s+/).forEach(p=>p&&a.classList.add(p)),a.style.display="none";const u=t.nodeType===1?t:t.parentNode;u.appendChild(a);const{hasTransform:d}=US(a);return u.removeChild(a),d}const Cb=e=>{const t=e.props["onUpdate:modelValue"]||!1;return en(t)?i=>sp(t,i):t};function wP(e){e.target.composing=!0}function Ib(e){const t=e.target;t.composing&&(t.composing=!1,t.dispatchEvent(new Event("input")))}const SP={created(e,{modifiers:{lazy:t,trim:i,number:a}},u){e._assign=Cb(u);const d=a||u.props&&u.props.type==="number";Cc(e,t?"change":"input",p=>{if(p.target.composing)return;let l=e.value;i&&(l=l.trim()),d&&(l=y_(l)),e._assign(l)}),i&&Cc(e,"change",()=>{e.value=e.value.trim()}),t||(Cc(e,"compositionstart",wP),Cc(e,"compositionend",Ib),Cc(e,"change",Ib))},mounted(e,{value:t}){e.value=t??""},beforeUpdate(e,{value:t,modifiers:{lazy:i,trim:a,number:u}},d){if(e._assign=Cb(d),e.composing||document.activeElement===e&&e.type!=="range"&&(i||a&&e.value.trim()===t||(u||e.type==="number")&&y_(e.value)===t))return;const p=t??"";e.value!==p&&(e.value=p)}},nu={beforeMount(e,{value:t},{transition:i}){e._vod=e.style.display==="none"?"":e.style.display,i&&t?i.beforeEnter(e):yh(e,t)},mounted(e,{value:t},{transition:i}){i&&t&&i.enter(e)},updated(e,{value:t,oldValue:i},{transition:a}){!t!=!i&&(a?t?(a.beforeEnter(e),yh(e,!0),a.enter(e)):a.leave(e,()=>{yh(e,!1)}):yh(e,t))},beforeUnmount(e,{value:t}){yh(e,t)}};function yh(e,t){e.style.display=t?e._vod:"none"}const EP=Ai({patchProp:hP},JA);let kb;function TP(){return kb||(kb=AA(EP))}const CP=(...e)=>{const t=TP().createApp(...e),{mount:i}=t;return t.mount=a=>{const u=IP(a);if(!u)return;const d=t._component;!cn(d)&&!d.render&&!d.template&&(d.template=u.innerHTML),u.innerHTML="";const p=i(u,!1,u instanceof SVGElement);return u instanceof Element&&(u.removeAttribute("v-cloak"),u.setAttribute("data-v-app","")),p},t};function IP(e){return Ei(e)?document.querySelector(e):e}var kP=!1;/*!
  * pinia v2.1.4
  * (c) 2023 Eduardo San Martin Morote
  * @license MIT
  */let qS;const um=e=>qS=e,HS=Symbol();function M_(e){return e&&typeof e=="object"&&Object.prototype.toString.call(e)==="[object Object]"&&typeof e.toJSON!="function"}var Rh;(function(e){e.direct="direct",e.patchObject="patch object",e.patchFunction="patch function"})(Rh||(Rh={}));function AP(){const e=pd(!0),t=e.run(()=>Kt({}));let i=[],a=[];const u=em({install(d){um(u),u._a=d,d.provide(HS,u),d.config.globalProperties.$pinia=u,a.forEach(p=>i.push(p)),a=[]},use(d){return!this._a&&!kP?a.push(d):i.push(d),this},_p:i,_a:null,_e:e,_s:new Map,state:t});return u}const WS=()=>{};function Ab(e,t,i,a=WS){e.push(t);const u=()=>{const d=e.indexOf(t);d>-1&&(e.splice(d,1),a())};return!i&&Zw()&&Wr(u),u}function bc(e,...t){e.slice().forEach(i=>{i(...t)})}const PP=e=>e();function D_(e,t){e instanceof Map&&t instanceof Map&&t.forEach((i,a)=>e.set(a,i)),e instanceof Set&&t instanceof Set&&t.forEach(e.add,e);for(const i in t){if(!t.hasOwnProperty(i))continue;const a=t[i],u=e[i];M_(u)&&M_(a)&&e.hasOwnProperty(i)&&!Kn(a)&&!So(a)?e[i]=D_(u,a):e[i]=a}return e}const RP=Symbol();function MP(e){return!M_(e)||!e.hasOwnProperty(RP)}const{assign:ho}=Object;function DP(e){return!!(Kn(e)&&e.effect)}function LP(e,t,i,a){const{state:u,actions:d,getters:p}=t,l=i.state.value[e];let b;function w(){l||(i.state.value[e]=u?u():{});const C=tm(i.state.value[e]);return ho(C,d,Object.keys(p||{}).reduce((I,M)=>(I[M]=em(Ce(()=>{um(i);const O=i._s.get(e);return p[M].call(O,O)})),I),{}))}return b=ZS(e,w,t,i,a,!0),b}function ZS(e,t,i={},a,u,d){let p;const l=ho({actions:{}},i),b={deep:!0};let w,C,I=[],M=[],O;const j=a.state.value[e];!d&&!j&&(a.state.value[e]={}),Kt({});let Z;function ue(U){let H;w=C=!1,typeof U=="function"?(U(a.state.value[e]),H={type:Rh.patchFunction,storeId:e,events:O}):(D_(a.state.value[e],U),H={type:Rh.patchObject,payload:U,storeId:e,events:O});const he=Z=Symbol();yr().then(()=>{Z===he&&(w=!0)}),C=!0,bc(I,H,a.state.value[e])}const ce=d?function(){const{state:H}=i,he=H?H():{};this.$patch(xe=>{ho(xe,he)})}:WS;function ve(){p.stop(),I=[],M=[],a._s.delete(e)}function ye(U,H){return function(){um(a);const he=Array.from(arguments),xe=[],we=[];function oe(et){xe.push(et)}function ke(et){we.push(et)}bc(M,{args:he,name:U,store:Be,after:oe,onError:ke});let tt;try{tt=H.apply(this&&this.$id===e?this:Be,he)}catch(et){throw bc(we,et),et}return tt instanceof Promise?tt.then(et=>(bc(xe,et),et)).catch(et=>(bc(we,et),Promise.reject(et))):(bc(xe,tt),tt)}}const Ae={_p:a,$id:e,$onAction:Ab.bind(null,M),$patch:ue,$reset:ce,$subscribe(U,H={}){const he=Ab(I,U,H.detached,()=>xe()),xe=p.run(()=>En(()=>a.state.value[e],we=>{(H.flush==="sync"?C:w)&&U({storeId:e,type:Rh.direct,events:O},we)},ho({},b,H)));return he},$dispose:ve},Be=Ki(Ae);a._s.set(e,Be);const Le=a._a&&a._a.runWithContext||PP,Ie=a._e.run(()=>(p=pd(),Le(()=>p.run(t))));for(const U in Ie){const H=Ie[U];if(Kn(H)&&!DP(H)||So(H))d||(j&&MP(H)&&(Kn(H)?H.value=j[U]:D_(H,j[U])),a.state.value[e][U]=H);else if(typeof H=="function"){const he=ye(U,H);Ie[U]=he,l.actions[U]=H}}return ho(Be,Ie),ho(sn(Be),Ie),Object.defineProperty(Be,"$state",{get:()=>a.state.value[e],set:U=>{ue(H=>{ho(H,U)})}}),a._p.forEach(U=>{ho(Be,p.run(()=>U({store:Be,app:a._a,pinia:a,options:l})))}),j&&d&&i.hydrate&&i.hydrate(Be.$state,j),w=!0,C=!0,Be}function lv(e,t,i){let a,u;const d=typeof t=="function";typeof e=="string"?(a=e,u=d?i:t):(u=e,a=e.id);function p(l,b){const w=SA();return l=l||(w?Jn(HS,null):null),l&&um(l),l=qS,l._s.has(a)||(d?ZS(a,t,u,l):LP(a,u,l)),l._s.get(a)}return p.$id=a,p}function vl(e,t){let i;function a(){i=pd(),i.run(()=>t.length?t(()=>{i==null||i.stop(),a()}):t())}En(e,u=>{u&&!i?a():u||(i==null||i.stop(),i=void 0)},{immediate:!0}),Wr(()=>{i==null||i.stop()})}function YS(e,t,i){const a=t.length-1;if(a<0)return e===void 0?i:e;for(let u=0;u<a;u++){if(e==null)return i;e=e[t[u]]}return e==null||e[t[a]]===void 0?i:e[t[a]]}function iu(e,t){if(e===t)return!0;if(e instanceof Date&&t instanceof Date&&e.getTime()!==t.getTime()||e!==Object(e)||t!==Object(t))return!1;const i=Object.keys(e);return i.length!==Object.keys(t).length?!1:i.every(a=>iu(e[a],t[a]))}function L_(e,t,i){return e==null||!t||typeof t!="string"?i:e[t]!==void 0?e[t]:(t=t.replace(/\[(\w+)\]/g,".$1"),t=t.replace(/^\./,""),YS(e,t.split("."),i))}function la(e,t,i){if(t==null)return e===void 0?i:e;if(e!==Object(e)){if(typeof t!="function")return i;const u=t(e,i);return typeof u>"u"?i:u}if(typeof t=="string")return L_(e,t,i);if(Array.isArray(t))return YS(e,t,i);if(typeof t!="function")return i;const a=t(e,i);return typeof a>"u"?i:a}function XS(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return Array.from({length:e},(i,a)=>t+a)}function mn(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"px";if(!(e==null||e===""))return isNaN(+e)?String(e):isFinite(+e)?`${Number(e)}${t}`:void 0}function z_(e){return e!==null&&typeof e=="object"&&!Array.isArray(e)}function O_(e){return e&&"$el"in e?e.$el:e}const Pb=Object.freeze({enter:13,tab:9,delete:46,esc:27,space:32,up:38,down:40,left:37,right:39,end:35,home:36,del:46,backspace:8,insert:45,pageup:33,pagedown:34,shift:16});function Jg(e,t){return t.every(i=>e.hasOwnProperty(i))}function _d(e,t,i){const a=Object.create(null),u=Object.create(null);for(const d in e)t.some(p=>p instanceof RegExp?p.test(d):p===d)&&!(i!=null&&i.some(p=>p===d))?a[d]=e[d]:u[d]=e[d];return[a,u]}function cv(e,t){const i={...e};return t.forEach(a=>delete i[a]),i}function uv(e){return _d(e,["class","style","id",/^data-/])}function ua(e){return e==null?[]:Array.isArray(e)?e:[e]}function B_(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;return Math.max(t,Math.min(i,e))}function Rb(e,t){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"0";return e+i.repeat(Math.max(0,t-e.length))}function zP(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;const i=[];let a=0;for(;a<e.length;)i.push(e.substr(a,t)),a+=t;return i}function Es(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=arguments.length>2?arguments[2]:void 0;const a={};for(const u in e)a[u]=e[u];for(const u in t){const d=e[u],p=t[u];if(z_(d)&&z_(p)){a[u]=Es(d,p,i);continue}if(Array.isArray(d)&&Array.isArray(p)&&i){a[u]=i(d,p);continue}a[u]=p}return a}function KS(e){return e.map(t=>t.type===gn?KS(t.children):t).flat()}function ml(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";if(ml.cache.has(e))return ml.cache.get(e);const t=e.replace(/[^a-z]/gi,"-").replace(/\B([A-Z])/g,"-$1").toLowerCase();return ml.cache.set(e,t),t}ml.cache=new Map;function Mh(e,t){if(!t||typeof t!="object")return[];if(Array.isArray(t))return t.map(i=>Mh(e,i)).flat(1);if(Array.isArray(t.children))return t.children.map(i=>Mh(e,i)).flat(1);if(t.component){if(Object.getOwnPropertySymbols(t.component.provides).includes(e))return[t.component];if(t.component.subTree)return Mh(e,t.component.subTree).flat(1)}return[]}function hv(e){const t=Ki({}),i=Ce(e);return Ua(()=>{for(const a in i.value)t[a]=i.value[a]},{flush:"sync"}),tm(t)}function bp(e,t){return e.includes(t)}const OP=/^on[^a-z]/,dv=e=>OP.test(e);function JS(e){return e[2].toLowerCase()+e.slice(3)}const ha=()=>[Function,Array];function Mb(e,t){return t="on"+Qc(t),!!(e[t]||e[`${t}Once`]||e[`${t}Capture`]||e[`${t}OnceCapture`]||e[`${t}CaptureOnce`])}function BP(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),a=1;a<t;a++)i[a-1]=arguments[a];if(Array.isArray(e))for(const u of e)u(...i);else typeof e=="function"&&e(...i)}function FP(e){const t=["button","[href]",'input:not([type="hidden"])',"select","textarea","[tabindex]"].map(i=>`${i}:not([tabindex="-1"]):not([disabled])`).join(", ");return[...e.querySelectorAll(t)]}function wp(e,t){var u,d,p;const i=FP(e),a=i.indexOf(document.activeElement);if(!t)(e===document.activeElement||!e.contains(document.activeElement))&&((u=i[0])==null||u.focus());else if(t==="first")(d=i[0])==null||d.focus();else if(t==="last")(p=i.at(-1))==null||p.focus();else{let l,b=a;const w=t==="next"?1:-1;do b+=w,l=i[b];while((!l||l.offsetParent==null)&&b<i.length&&b>=0);l?l.focus():wp(e,t==="next"?"first":"last")}}function NP(){}const QS=["top","bottom"],UP=["start","end","left","right"];function F_(e,t){let[i,a]=e.split(" ");return a||(a=bp(QS,i)?"start":bp(UP,i)?"top":"center"),{side:Db(i,t),align:Db(a,t)}}function Db(e,t){return e==="start"?t?"right":"left":e==="end"?t?"left":"right":e}function Qg(e){return{side:{center:"center",top:"bottom",bottom:"top",left:"right",right:"left"}[e.side],align:e.align}}function e_(e){return{side:e.side,align:{center:"center",top:"bottom",bottom:"top",left:"right",right:"left"}[e.align]}}function Lb(e){return{side:e.align,align:e.side}}function zb(e){return bp(QS,e.side)?"y":"x"}class Oc{constructor(t){let{x:i,y:a,width:u,height:d}=t;this.x=i,this.y=a,this.width=u,this.height=d}get top(){return this.y}get bottom(){return this.y+this.height}get left(){return this.x}get right(){return this.x+this.width}}function Ob(e,t){return{x:{before:Math.max(0,t.left-e.left),after:Math.max(0,e.right-t.right)},y:{before:Math.max(0,t.top-e.top),after:Math.max(0,e.bottom-t.bottom)}}}function fv(e){const t=e.getBoundingClientRect(),i=getComputedStyle(e),a=i.transform;if(a){let u,d,p,l,b;if(a.startsWith("matrix3d("))u=a.slice(9,-1).split(/, /),d=+u[0],p=+u[5],l=+u[12],b=+u[13];else if(a.startsWith("matrix("))u=a.slice(7,-1).split(/, /),d=+u[0],p=+u[3],l=+u[4],b=+u[5];else return new Oc(t);const w=i.transformOrigin,C=t.x-l-(1-d)*parseFloat(w),I=t.y-b-(1-p)*parseFloat(w.slice(w.indexOf(" ")+1)),M=d?t.width/d:e.offsetWidth+1,O=p?t.height/p:e.offsetHeight+1;return new Oc({x:C,y:I,width:M,height:O})}else return new Oc(t)}function Ac(e,t,i){if(typeof e.animate>"u")return{finished:Promise.resolve()};let a;try{a=e.animate(t,i)}catch{return{finished:Promise.resolve()}}return typeof a.finished>"u"&&(a.finished=new Promise(u=>{a.onfinish=()=>{u(a)}})),a}const lp=new WeakMap;function $P(e,t){Object.keys(t).forEach(i=>{if(dv(i)){const a=JS(i),u=lp.get(e);if(t[i]==null)u==null||u.forEach(d=>{const[p,l]=d;p===a&&(e.removeEventListener(a,l),u.delete(d))});else if(!u||![...u].some(d=>d[0]===a&&d[1]===t[i])){e.addEventListener(a,t[i]);const d=u||new Set;d.add([a,t[i]]),lp.has(e)||lp.set(e,d)}}else t[i]==null?e.removeAttribute(i):e.setAttribute(i,t[i])})}function VP(e,t){Object.keys(t).forEach(i=>{if(dv(i)){const a=JS(i),u=lp.get(e);u==null||u.forEach(d=>{const[p,l]=d;p===a&&(e.removeEventListener(a,l),u.delete(d))})}else e.removeAttribute(i)})}function jP(e,t){t=Array.isArray(t)?t.slice(0,-1).map(i=>`'${i}'`).join(", ")+` or '${t.at(-1)}'`:`'${t}'`}const Sp=.20689655172413793,GP=e=>e>Sp**3?Math.cbrt(e):e/(3*Sp**2)+4/29,qP=e=>e>Sp?e**3:3*Sp**2*(e-4/29);function eE(e){const t=GP,i=t(e[1]);return[116*i-16,500*(t(e[0]/.95047)-i),200*(i-t(e[2]/1.08883))]}function tE(e){const t=qP,i=(e[0]+16)/116;return[t(i+e[1]/500)*.95047,t(i),t(i-e[2]/200)*1.08883]}const HP=[[3.2406,-1.5372,-.4986],[-.9689,1.8758,.0415],[.0557,-.204,1.057]],WP=e=>e<=.0031308?e*12.92:1.055*e**(1/2.4)-.055,ZP=[[.4124,.3576,.1805],[.2126,.7152,.0722],[.0193,.1192,.9505]],YP=e=>e<=.04045?e/12.92:((e+.055)/1.055)**2.4;function nE(e){const t=Array(3),i=WP,a=HP;for(let u=0;u<3;++u)t[u]=Math.round(B_(i(a[u][0]*e[0]+a[u][1]*e[1]+a[u][2]*e[2]))*255);return{r:t[0],g:t[1],b:t[2]}}function pv(e){let{r:t,g:i,b:a}=e;const u=[0,0,0],d=YP,p=ZP;t=d(t/255),i=d(i/255),a=d(a/255);for(let l=0;l<3;++l)u[l]=p[l][0]*t+p[l][1]*i+p[l][2]*a;return u}function Bb(e){return!!e&&/^(#|var\(--|(rgb|hsl)a?\()/.test(e)}const Fb=/^(?<fn>(?:rgb|hsl)a?)\((?<values>.+)\)/,XP={rgb:(e,t,i,a)=>({r:e,g:t,b:i,a}),rgba:(e,t,i,a)=>({r:e,g:t,b:i,a}),hsl:(e,t,i,a)=>Nb({h:e,s:t,l:i,a}),hsla:(e,t,i,a)=>Nb({h:e,s:t,l:i,a}),hsv:(e,t,i,a)=>Xh({h:e,s:t,v:i,a}),hsva:(e,t,i,a)=>Xh({h:e,s:t,v:i,a})};function hl(e){if(typeof e=="number")return{r:(e&16711680)>>16,g:(e&65280)>>8,b:e&255};if(typeof e=="string"&&Fb.test(e)){const{groups:t}=e.match(Fb),{fn:i,values:a}=t,u=a.split(/,\s*/).map(d=>d.endsWith("%")&&["hsl","hsla","hsv","hsva"].includes(i)?parseFloat(d)/100:parseFloat(d));return XP[i](...u)}else if(typeof e=="string"){let t=e.startsWith("#")?e.slice(1):e;return[3,4].includes(t.length)?t=t.split("").map(i=>i+i).join(""):[6,8].includes(t.length),JP(t)}else if(typeof e=="object"){if(Jg(e,["r","g","b"]))return e;if(Jg(e,["h","s","l"]))return Xh(iE(e));if(Jg(e,["h","s","v"]))return Xh(e)}throw new TypeError(`Invalid color: ${e==null?e:String(e)||e.constructor.name}
Expected #hex, #hexa, rgb(), rgba(), hsl(), hsla(), object or number`)}function Xh(e){const{h:t,s:i,v:a,a:u}=e,d=l=>{const b=(l+t/60)%6;return a-a*i*Math.max(Math.min(b,4-b,1),0)},p=[d(5),d(3),d(1)].map(l=>Math.round(l*255));return{r:p[0],g:p[1],b:p[2],a:u}}function Nb(e){return Xh(iE(e))}function iE(e){const{h:t,s:i,l:a,a:u}=e,d=a+i*Math.min(a,1-a),p=d===0?0:2-2*a/d;return{h:t,s:p,v:d,a:u}}function Nf(e){const t=Math.round(e).toString(16);return("00".substr(0,2-t.length)+t).toUpperCase()}function KP(e){let{r:t,g:i,b:a,a:u}=e;return`#${[Nf(t),Nf(i),Nf(a),u!==void 0?Nf(Math.round(u*255)):""].join("")}`}function JP(e){e=QP(e);let[t,i,a,u]=zP(e,2).map(d=>parseInt(d,16));return u=u===void 0?u:u/255,{r:t,g:i,b:a,a:u}}function QP(e){return e.startsWith("#")&&(e=e.slice(1)),e=e.replace(/([^0-9a-f])/gi,"F"),(e.length===3||e.length===4)&&(e=e.split("").map(t=>t+t).join("")),e.length!==6&&(e=Rb(Rb(e,6),8,"F")),e}function eR(e,t){const i=eE(pv(e));return i[0]=i[0]+t*10,nE(tE(i))}function tR(e,t){const i=eE(pv(e));return i[0]=i[0]-t*10,nE(tE(i))}function nR(e){const t=hl(e);return pv(t)[1]}function Ft(e,t){return i=>Object.keys(e).reduce((a,u)=>{const p=typeof e[u]=="object"&&e[u]!=null&&!Array.isArray(e[u])?e[u]:{type:e[u]};return i&&u in i?a[u]={...p,default:i[u]}:a[u]=p,t&&!a[u].source&&(a[u].source=t),a},{})}const ci=Ft({class:[String,Array],style:{type:[String,Array,Object],default:null}},"component");function ru(e){if(e._setup=e._setup??e.setup,!e.name)return e;if(e._setup){e.props=Ft(e.props??{},e.name)();const t=Object.keys(e.props);e.filterProps=function(a){return _d(a,t,["class","style"])},e.props._as=String,e.setup=function(a,u){const d=_v();if(!d.value)return e._setup(a,u);const{props:p,provideSubDefaults:l}=hR(a,a._as??e.name,d),b=e._setup(p,u);return l(),b}}return e}function Tn(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return t=>(e?ru:rm)(t)}function rE(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"div",i=arguments.length>2?arguments[2]:void 0;return Tn()({name:i??Qc(Cs(e.replace(/__/g,"-"))),props:{tag:{type:String,default:t},...ci()},setup(a,u){let{slots:d}=u;return()=>{var p;return Ro(a.tag,{class:[e,a.class],style:a.style},(p=d.default)==null?void 0:p.call(d))}}})}function sE(e){if(typeof e.getRootNode!="function"){for(;e.parentNode;)e=e.parentNode;return e!==document?null:document}const t=e.getRootNode();return t!==document&&t.getRootNode({composed:!0})!==document?null:t}const Ep="cubic-bezier(0.4, 0, 0.2, 1)",iR="cubic-bezier(0.0, 0, 0.2, 1)",rR="cubic-bezier(0.4, 0, 1, 1)";function Lr(e,t){const i=av();if(!i)throw new Error(`[Vuetify] ${e} ${t||"must be called from inside a setup function"}`);return i}function Mo(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"composables";const t=Lr(e).type;return ml((t==null?void 0:t.aliasName)||(t==null?void 0:t.name))}let aE=0,cp=new WeakMap;function Hs(){const e=Lr("getUid");if(cp.has(e))return cp.get(e);{const t=aE++;return cp.set(e,t),t}}Hs.reset=()=>{aE=0,cp=new WeakMap};function sR(e){for(;e;){if(mv(e))return e;e=e.parentElement}return document.scrollingElement}function Tp(e,t){const i=[];if(t&&e&&!t.contains(e))return i;for(;e&&(mv(e)&&i.push(e),e!==t);)e=e.parentElement;return i}function mv(e){if(!e||e.nodeType!==Node.ELEMENT_NODE)return!1;const t=window.getComputedStyle(e);return t.overflowY==="scroll"||t.overflowY==="auto"&&e.scrollHeight>e.clientHeight}const ji=typeof window<"u",gv=ji&&"IntersectionObserver"in window,aR=ji&&("ontouchstart"in window||window.navigator.maxTouchPoints>0),N_=ji&&typeof CSS<"u"&&typeof CSS.supports<"u"&&CSS.supports("selector(:focus-visible)");function oR(e){const{provides:t}=Lr("injectSelf");if(t&&e in t)return t[e]}function lR(e){for(;e;){if(window.getComputedStyle(e).position==="fixed")return!0;e=e.offsetParent}return!1}function Hn(e){const t=Lr("useRender");t.render=e}const Kh=Symbol.for("vuetify:defaults");function cR(e){return Kt(e)}function _v(){const e=Jn(Kh);if(!e)throw new Error("[Vuetify] Could not find defaults instance");return e}function yd(e,t){const i=_v(),a=Kt(e),u=Ce(()=>{if(ur(t==null?void 0:t.disabled))return i.value;const p=ur(t==null?void 0:t.scoped),l=ur(t==null?void 0:t.reset),b=ur(t==null?void 0:t.root);let w=Es(a.value,{prev:i.value});if(p)return w;if(l||b){const C=Number(l||1/0);for(let I=0;I<=C&&!(!w||!("prev"in w));I++)w=w.prev;return w&&typeof b=="string"&&b in w&&(w=Es(Es(w,{prev:w}),w[b])),w}return w.prev?Es(w.prev,w):w});return _r(Kh,u),u}function uR(e,t){var i,a;return typeof((i=e.props)==null?void 0:i[t])<"u"||typeof((a=e.props)==null?void 0:a[ml(t)])<"u"}function hR(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:_v();const a=Lr("useDefaults");if(t=t??a.type.name??a.type.__name,!t)throw new Error("[Vuetify] Could not determine component name");const u=Ce(()=>{var b;return(b=i.value)==null?void 0:b[e._as??t]}),d=new Proxy(e,{get(b,w){var I,M,O,j;const C=Reflect.get(b,w);return w==="class"||w==="style"?[(I=u.value)==null?void 0:I[w],C].filter(Z=>Z!=null):typeof w=="string"&&!uR(a.vnode,w)?((M=u.value)==null?void 0:M[w])??((j=(O=i.value)==null?void 0:O.global)==null?void 0:j[w])??C:C}}),p=Sn();Ua(()=>{if(u.value){const b=Object.entries(u.value).filter(w=>{let[C]=w;return C.startsWith(C[0].toUpperCase())});b.length&&(p.value=Object.fromEntries(b))}});function l(){vl(p,()=>{var b;yd(Es(((b=oR(Kh))==null?void 0:b.value)??{},p.value))})}return{props:d,provideSubDefaults:l}}const U_=Symbol.for("vuetify:display"),Ub={mobileBreakpoint:"lg",thresholds:{xs:0,sm:600,md:960,lg:1280,xl:1920,xxl:2560}},dR=function(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Ub;return Es(Ub,e)};function $b(e){return ji&&!e?window.innerWidth:typeof e=="object"&&e.clientWidth||0}function Vb(e){return ji&&!e?window.innerHeight:typeof e=="object"&&e.clientHeight||0}function jb(e){const t=ji&&!e?window.navigator.userAgent:"ssr";function i(j){return!!t.match(j)}const a=i(/android/i),u=i(/iphone|ipad|ipod/i),d=i(/cordova/i),p=i(/electron/i),l=i(/chrome/i),b=i(/edge/i),w=i(/firefox/i),C=i(/opera/i),I=i(/win/i),M=i(/mac/i),O=i(/linux/i);return{android:a,ios:u,cordova:d,electron:p,chrome:l,edge:b,firefox:w,opera:C,win:I,mac:M,linux:O,touch:aR,ssr:t==="ssr"}}function fR(e,t){const{thresholds:i,mobileBreakpoint:a}=dR(e),u=Sn(Vb(t)),d=Sn(jb(t)),p=Ki({}),l=Sn($b(t));function b(){u.value=Vb(),l.value=$b()}function w(){b(),d.value=jb()}return Ua(()=>{const C=l.value<i.sm,I=l.value<i.md&&!C,M=l.value<i.lg&&!(I||C),O=l.value<i.xl&&!(M||I||C),j=l.value<i.xxl&&!(O||M||I||C),Z=l.value>=i.xxl,ue=C?"xs":I?"sm":M?"md":O?"lg":j?"xl":"xxl",ce=typeof a=="number"?a:i[a],ve=l.value<ce;p.xs=C,p.sm=I,p.md=M,p.lg=O,p.xl=j,p.xxl=Z,p.smAndUp=!C,p.mdAndUp=!(C||I),p.lgAndUp=!(C||I||M),p.xlAndUp=!(C||I||M||O),p.smAndDown=!(M||O||j||Z),p.mdAndDown=!(O||j||Z),p.lgAndDown=!(j||Z),p.xlAndDown=!Z,p.name=ue,p.height=u.value,p.width=l.value,p.mobile=ve,p.mobileBreakpoint=a,p.platform=d.value,p.thresholds=i}),ji&&window.addEventListener("resize",b,{passive:!0}),{...tm(p),update:w,ssr:!!t}}function pR(){const e=Jn(U_);if(!e)throw new Error("Could not find Vuetify display injection");return e}const mR={collapse:"mdi-chevron-up",complete:"mdi-check",cancel:"mdi-close-circle",close:"mdi-close",delete:"mdi-close-circle",clear:"mdi-close-circle",success:"mdi-check-circle",info:"mdi-information",warning:"mdi-alert-circle",error:"mdi-close-circle",prev:"mdi-chevron-left",next:"mdi-chevron-right",checkboxOn:"mdi-checkbox-marked",checkboxOff:"mdi-checkbox-blank-outline",checkboxIndeterminate:"mdi-minus-box",delimiter:"mdi-circle",sortAsc:"mdi-arrow-up",sortDesc:"mdi-arrow-down",expand:"mdi-chevron-down",menu:"mdi-menu",subgroup:"mdi-menu-down",dropdown:"mdi-menu-down",radioOn:"mdi-radiobox-marked",radioOff:"mdi-radiobox-blank",edit:"mdi-pencil",ratingEmpty:"mdi-star-outline",ratingFull:"mdi-star",ratingHalf:"mdi-star-half-full",loading:"mdi-cached",first:"mdi-page-first",last:"mdi-page-last",unfold:"mdi-unfold-more-horizontal",file:"mdi-paperclip",plus:"mdi-plus",minus:"mdi-minus",calendar:"mdi-calendar"},gR={component:e=>Ro(lE,{...e,class:"mdi"})},ki=[String,Function,Object,Array],$_=Symbol.for("vuetify:icons"),hm=Ft({icon:{type:ki},tag:{type:String,required:!0}},"icon"),Gb=Tn()({name:"VComponentIcon",props:hm(),setup(e,t){let{slots:i}=t;return()=>{const a=e.icon;return le(e.tag,null,{default:()=>{var u;return[e.icon?le(a,null,null):(u=i.default)==null?void 0:u.call(i)]}})}}}),oE=ru({name:"VSvgIcon",inheritAttrs:!1,props:hm(),setup(e,t){let{attrs:i}=t;return()=>le(e.tag,Pn(i,{style:null}),{default:()=>[le("svg",{class:"v-icon__svg",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",role:"img","aria-hidden":"true"},[Array.isArray(e.icon)?e.icon.map(a=>Array.isArray(a)?le("path",{d:a[0],"fill-opacity":a[1]},null):le("path",{d:a},null)):le("path",{d:e.icon},null)])]})}});ru({name:"VLigatureIcon",props:hm(),setup(e){return()=>le(e.tag,null,{default:()=>[e.icon]})}});const lE=ru({name:"VClassIcon",props:hm(),setup(e){return()=>le(e.tag,{class:e.icon},null)}}),_R={svg:{component:oE},class:{component:lE}};function yR(e){return Es({defaultSet:"mdi",sets:{..._R,mdi:gR},aliases:{...mR,vuetify:["M8.2241 14.2009L12 21L22 3H14.4459L8.2241 14.2009Z",["M7.26303 12.4733L7.00113 12L2 3H12.5261C12.5261 3 12.5261 3 12.5261 3L7.26303 12.4733Z",.6]],"vuetify-outline":"svg:M7.26 12.47 12.53 3H2L7.26 12.47ZM14.45 3 8.22 14.2 12 21 22 3H14.45ZM18.6 5 12 16.88 10.51 14.2 15.62 5ZM7.26 8.35 5.4 5H9.13L7.26 8.35Z"}},e)}const vR=e=>{const t=Jn($_);if(!t)throw new Error("Missing Vuetify Icons provide!");return{iconData:Ce(()=>{var b;const a=ur(e);if(!a)return{component:Gb};let u=a;if(typeof u=="string"&&(u=u.trim(),u.startsWith("$")&&(u=(b=t.aliases)==null?void 0:b[u.slice(1)])),!u)throw new Error(`Could not find aliased icon "${a}"`);if(Array.isArray(u))return{component:oE,icon:u};if(typeof u!="string")return{component:Gb,icon:u};const d=Object.keys(t.sets).find(w=>typeof u=="string"&&u.startsWith(`${w}:`)),p=d?u.slice(d.length+1):u;return{component:t.sets[d??t.defaultSet].component,icon:p}})}},xR={badge:"Badge",close:"Close",dataIterator:{noResultsText:"No matching records found",loadingText:"Loading items..."},dataTable:{itemsPerPageText:"Rows per page:",ariaLabel:{sortDescending:"Sorted descending.",sortAscending:"Sorted ascending.",sortNone:"Not sorted.",activateNone:"Activate to remove sorting.",activateDescending:"Activate to sort descending.",activateAscending:"Activate to sort ascending."},sortBy:"Sort by"},dataFooter:{itemsPerPageText:"Items per page:",itemsPerPageAll:"All",nextPage:"Next page",prevPage:"Previous page",firstPage:"First page",lastPage:"Last page",pageText:"{0}-{1} of {2}"},dateRangeInput:{divider:"to"},datePicker:{ok:"OK",cancel:"Cancel",range:{title:"Select dates",header:"Enter dates"},title:"Select date",header:"Enter date",input:{placeholder:"Enter date"}},noDataText:"No data available",carousel:{prev:"Previous visual",next:"Next visual",ariaLabel:{delimiter:"Carousel slide {0} of {1}"}},calendar:{moreEvents:"{0} more"},input:{clear:"Clear {0}",prependAction:"{0} prepended action",appendAction:"{0} appended action"},fileInput:{counter:"{0} files",counterSize:"{0} files ({1} in total)"},timePicker:{am:"AM",pm:"PM"},pagination:{ariaLabel:{root:"Pagination Navigation",next:"Next page",previous:"Previous page",page:"Go to page {0}",currentPage:"Page {0}, Current page",first:"First page",last:"Last page"}},rating:{ariaLabel:{item:"Rating {0} of {1}"}},loading:"Loading...",infiniteScroll:{loadMore:"Load more",empty:"No more"}},bR={af:!1,ar:!0,bg:!1,ca:!1,ckb:!1,cs:!1,de:!1,el:!1,en:!1,es:!1,et:!1,fa:!0,fi:!1,fr:!1,hr:!1,hu:!1,he:!0,id:!1,it:!1,ja:!1,ko:!1,lv:!1,lt:!1,nl:!1,no:!1,pl:!1,pt:!1,ro:!1,ru:!1,sk:!1,sl:!1,srCyrl:!1,srLatn:!1,sv:!1,th:!1,tr:!1,az:!1,uk:!1,vi:!1,zhHans:!1,zhHant:!1};function Si(e,t,i){let a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:I=>I,u=arguments.length>4&&arguments[4]!==void 0?arguments[4]:I=>I;const d=Lr("useProxiedModel"),p=Kt(e[t]!==void 0?e[t]:i),l=ml(t),w=Ce(l!==t?()=>{var I,M,O,j;return e[t],!!(((I=d.vnode.props)!=null&&I.hasOwnProperty(t)||(M=d.vnode.props)!=null&&M.hasOwnProperty(l))&&((O=d.vnode.props)!=null&&O.hasOwnProperty(`onUpdate:${t}`)||(j=d.vnode.props)!=null&&j.hasOwnProperty(`onUpdate:${l}`)))}:()=>{var I,M;return e[t],!!((I=d.vnode.props)!=null&&I.hasOwnProperty(t)&&((M=d.vnode.props)!=null&&M.hasOwnProperty(`onUpdate:${t}`)))});vl(()=>!w.value,()=>{En(()=>e[t],I=>{p.value=I})});const C=Ce({get(){const I=e[t];return a(w.value?I:p.value)},set(I){const M=u(I),O=sn(w.value?e[t]:p.value);O===M||a(O)===I||(p.value=M,d==null||d.emit(`update:${t}`,M))}});return Object.defineProperty(C,"externalValue",{get:()=>w.value?e[t]:p.value}),C}const qb="$vuetify.",Hb=(e,t)=>e.replace(/\{(\d+)\}/g,(i,a)=>String(t[+a])),cE=(e,t,i)=>function(a){for(var u=arguments.length,d=new Array(u>1?u-1:0),p=1;p<u;p++)d[p-1]=arguments[p];if(!a.startsWith(qb))return Hb(a,d);const l=a.replace(qb,""),b=e.value&&i.value[e.value],w=t.value&&i.value[t.value];let C=L_(b,l,null);return C||(`${a}${e.value}`,C=L_(w,l,null)),C||(C=a),typeof C!="string"&&(C=a),Hb(C,d)};function uE(e,t){return(i,a)=>new Intl.NumberFormat([e.value,t.value],a).format(i)}function t_(e,t,i){const a=Si(e,t,e[t]??i.value);return a.value=e[t]??i.value,En(i,u=>{e[t]==null&&(a.value=i.value)}),a}function hE(e){return t=>{const i=t_(t,"locale",e.current),a=t_(t,"fallback",e.fallback),u=t_(t,"messages",e.messages);return{name:"vuetify",current:i,fallback:a,messages:u,t:cE(i,a,u),n:uE(i,a),provide:hE({current:i,fallback:a,messages:u})}}}function wR(e){const t=Sn((e==null?void 0:e.locale)??"en"),i=Sn((e==null?void 0:e.fallback)??"en"),a=Kt({en:xR,...e==null?void 0:e.messages});return{name:"vuetify",current:t,fallback:i,messages:a,t:cE(t,i,a),n:uE(t,i),provide:hE({current:t,fallback:i,messages:a})}}const Cp=Symbol.for("vuetify:locale");function SR(e){return e.name!=null}function ER(e){const t=e!=null&&e.adapter&&SR(e==null?void 0:e.adapter)?e==null?void 0:e.adapter:wR(e),i=TR(t,e);return{...t,...i}}function dm(){const e=Jn(Cp);if(!e)throw new Error("[Vuetify] Could not find injected locale instance");return e}function TR(e,t){const i=Kt((t==null?void 0:t.rtl)??bR),a=Ce(()=>i.value[e.current.value]??!1);return{isRtl:a,rtl:i,rtlClasses:Ce(()=>`v-locale--is-${a.value?"rtl":"ltr"}`)}}function su(){const e=Jn(Cp);if(!e)throw new Error("[Vuetify] Could not find injected rtl instance");return{isRtl:e.isRtl,rtlClasses:e.rtlClasses}}const wc=2.4,Wb=.2126729,Zb=.7151522,Yb=.072175,CR=.55,IR=.58,kR=.57,AR=.62,Uf=.03,Xb=1.45,PR=5e-4,RR=1.25,MR=1.25,Kb=.078,Jb=12.82051282051282,$f=.06,Qb=.001;function e1(e,t){const i=(e.r/255)**wc,a=(e.g/255)**wc,u=(e.b/255)**wc,d=(t.r/255)**wc,p=(t.g/255)**wc,l=(t.b/255)**wc;let b=i*Wb+a*Zb+u*Yb,w=d*Wb+p*Zb+l*Yb;if(b<=Uf&&(b+=(Uf-b)**Xb),w<=Uf&&(w+=(Uf-w)**Xb),Math.abs(w-b)<PR)return 0;let C;if(w>b){const I=(w**CR-b**IR)*RR;C=I<Qb?0:I<Kb?I-I*Jb*$f:I-$f}else{const I=(w**AR-b**kR)*MR;C=I>-Qb?0:I>-Kb?I-I*Jb*$f:I+$f}return C*100}const Ip=Symbol.for("vuetify:theme"),Yr=Ft({theme:String},"theme"),vh={defaultTheme:"light",variations:{colors:[],lighten:0,darken:0},themes:{light:{dark:!1,colors:{background:"#FFFFFF",surface:"#FFFFFF","surface-variant":"#424242","on-surface-variant":"#EEEEEE",primary:"#6200EE","primary-darken-1":"#3700B3",secondary:"#03DAC6","secondary-darken-1":"#018786",error:"#B00020",info:"#2196F3",success:"#4CAF50",warning:"#FB8C00"},variables:{"border-color":"#000000","border-opacity":.12,"high-emphasis-opacity":.87,"medium-emphasis-opacity":.6,"disabled-opacity":.38,"idle-opacity":.04,"hover-opacity":.04,"focus-opacity":.12,"selected-opacity":.08,"activated-opacity":.12,"pressed-opacity":.12,"dragged-opacity":.08,"theme-kbd":"#212529","theme-on-kbd":"#FFFFFF","theme-code":"#F5F5F5","theme-on-code":"#000000"}},dark:{dark:!0,colors:{background:"#121212",surface:"#212121","surface-variant":"#BDBDBD","on-surface-variant":"#424242",primary:"#BB86FC","primary-darken-1":"#3700B3",secondary:"#03DAC5","secondary-darken-1":"#03DAC5",error:"#CF6679",info:"#2196F3",success:"#4CAF50",warning:"#FB8C00"},variables:{"border-color":"#FFFFFF","border-opacity":.12,"high-emphasis-opacity":1,"medium-emphasis-opacity":.7,"disabled-opacity":.5,"idle-opacity":.1,"hover-opacity":.04,"focus-opacity":.12,"selected-opacity":.08,"activated-opacity":.12,"pressed-opacity":.16,"dragged-opacity":.08,"theme-kbd":"#212529","theme-on-kbd":"#FFFFFF","theme-code":"#343434","theme-on-code":"#CCCCCC"}}}};function DR(){var i,a;let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:vh;if(!e)return{...vh,isDisabled:!0};const t={};for(const[u,d]of Object.entries(e.themes??{})){const p=d.dark||u==="dark"?(i=vh.themes)==null?void 0:i.dark:(a=vh.themes)==null?void 0:a.light;t[u]=Es(p,d)}return Es(vh,{...e,themes:t})}function LR(e){const t=Ki(DR(e)),i=Kt(t.defaultTheme),a=Kt(t.themes),u=Ce(()=>{const C={};for(const[I,M]of Object.entries(a.value)){const O=C[I]={...M,colors:{...M.colors}};if(t.variations)for(const j of t.variations.colors){const Z=O.colors[j];if(Z)for(const ue of["lighten","darken"]){const ce=ue==="lighten"?eR:tR;for(const ve of XS(t.variations[ue],1))O.colors[`${j}-${ue}-${ve}`]=KP(ce(hl(Z),ve))}}for(const j of Object.keys(O.colors)){if(/^on-[a-z]/.test(j)||O.colors[`on-${j}`])continue;const Z=`on-${j}`,ue=hl(O.colors[j]),ce=Math.abs(e1(hl(0),ue)),ve=Math.abs(e1(hl(16777215),ue));O.colors[Z]=ve>Math.min(ce,50)?"#fff":"#000"}}return C}),d=Ce(()=>u.value[i.value]),p=Ce(()=>{const C=[];d.value.dark&&al(C,":root",["color-scheme: dark"]),al(C,":root",t1(d.value));for(const[j,Z]of Object.entries(u.value))al(C,`.v-theme--${j}`,[`color-scheme: ${Z.dark?"dark":"normal"}`,...t1(Z)]);const I=[],M=[],O=new Set(Object.values(u.value).flatMap(j=>Object.keys(j.colors)));for(const j of O)/^on-[a-z]/.test(j)?al(M,`.${j}`,[`color: rgb(var(--v-theme-${j})) !important`]):(al(I,`.bg-${j}`,[`--v-theme-overlay-multiplier: var(--v-theme-${j}-overlay-multiplier)`,`background-color: rgb(var(--v-theme-${j})) !important`,`color: rgb(var(--v-theme-on-${j})) !important`]),al(M,`.text-${j}`,[`color: rgb(var(--v-theme-${j})) !important`]),al(M,`.border-${j}`,[`--v-border-color: var(--v-theme-${j})`]));return C.push(...I,...M),C.map((j,Z)=>Z===0?j:`    ${j}`).join("")});function l(){return{style:[{children:p.value,id:"vuetify-theme-stylesheet",nonce:t.cspNonce||!1}]}}function b(C){if(t.isDisabled)return;const I=C._context.provides.usehead;if(I)if(I.push){const O=I.push(l);En(p,()=>{O.patch(l)})}else ji?(I.addHeadObjs(Ce(l)),Ua(()=>I.updateDOM())):I.addHeadObjs(l());else{let j=function(){if(typeof document<"u"&&!O){const Z=document.createElement("style");Z.type="text/css",Z.id="vuetify-theme-stylesheet",t.cspNonce&&Z.setAttribute("nonce",t.cspNonce),O=Z,document.head.appendChild(O)}O&&(O.innerHTML=p.value)};var M=j;let O=ji?document.getElementById("vuetify-theme-stylesheet"):null;En(p,j,{immediate:!0})}}const w=Ce(()=>t.isDisabled?void 0:`v-theme--${i.value}`);return{install:b,isDisabled:t.isDisabled,name:i,themes:a,current:d,computedThemes:u,themeClasses:w,styles:p,global:{name:i,current:d}}}function Is(e){Lr("provideTheme");const t=Jn(Ip,null);if(!t)throw new Error("Could not find Vuetify theme injection");const i=Ce(()=>e.theme??(t==null?void 0:t.name.value)),a=Ce(()=>t.isDisabled?void 0:`v-theme--${i.value}`),u={...t,name:i,themeClasses:a};return _r(Ip,u),u}function al(e,t,i){e.push(`${t} {
`,...i.map(a=>`  ${a};
`),`}
`)}function t1(e){const t=e.dark?2:1,i=e.dark?1:2,a=[];for(const[u,d]of Object.entries(e.colors)){const p=hl(d);a.push(`--v-theme-${u}: ${p.r},${p.g},${p.b}`),u.startsWith("on-")||a.push(`--v-theme-${u}-overlay-multiplier: ${nR(d)>.18?t:i}`)}for(const[u,d]of Object.entries(e.variables)){const p=typeof d=="string"&&d.startsWith("#")?hl(d):void 0,l=p?`${p.r}, ${p.g}, ${p.b}`:void 0;a.push(`--v-${u}: ${l??d}`)}return a}const V_={"001":1,AD:1,AE:6,AF:6,AG:0,AI:1,AL:1,AM:1,AN:1,AR:1,AS:0,AT:1,AU:1,AX:1,AZ:1,BA:1,BD:0,BE:1,BG:1,BH:6,BM:1,BN:1,BR:0,BS:0,BT:0,BW:0,BY:1,BZ:0,CA:0,CH:1,CL:1,CM:1,CN:1,CO:0,CR:1,CY:1,CZ:1,DE:1,DJ:6,DK:1,DM:0,DO:0,DZ:6,EC:1,EE:1,EG:6,ES:1,ET:0,FI:1,FJ:1,FO:1,FR:1,GB:1,"GB-alt-variant":0,GE:1,GF:1,GP:1,GR:1,GT:0,GU:0,HK:0,HN:0,HR:1,HU:1,ID:0,IE:1,IL:0,IN:0,IQ:6,IR:6,IS:1,IT:1,JM:0,JO:6,JP:0,KE:0,KG:1,KH:0,KR:0,KW:6,KZ:1,LA:0,LB:1,LI:1,LK:1,LT:1,LU:1,LV:1,LY:6,MC:1,MD:1,ME:1,MH:0,MK:1,MM:0,MN:1,MO:0,MQ:1,MT:0,MV:5,MX:0,MY:1,MZ:0,NI:0,NL:1,NO:1,NP:0,NZ:1,OM:6,PA:0,PE:0,PH:0,PK:0,PL:1,PR:0,PT:0,PY:0,QA:6,RE:1,RO:1,RS:1,RU:1,SA:0,SD:6,SE:1,SG:0,SI:1,SK:1,SM:1,SV:0,SY:6,TH:0,TJ:1,TM:1,TR:1,TT:0,TW:0,UA:1,UM:0,US:0,UY:1,UZ:1,VA:1,VE:0,VI:0,VN:1,WS:0,XK:1,YE:0,ZA:0,ZW:0};function zR(e,t){const i=[];let a=[];const u=dE(e),d=fE(e),p=u.getDay()-V_[t.slice(-2).toUpperCase()],l=d.getDay()-V_[t.slice(-2).toUpperCase()];for(let b=0;b<p;b++){const w=new Date(u);w.setDate(w.getDate()-(p-b)),a.push(w)}for(let b=1;b<=d.getDate();b++){const w=new Date(e.getFullYear(),e.getMonth(),b);a.push(w),a.length===7&&(i.push(a),a=[])}for(let b=1;b<7-l;b++){const w=new Date(d);w.setDate(w.getDate()+b),a.push(w)}return i.push(a),i}function dE(e){return new Date(e.getFullYear(),e.getMonth(),1)}function fE(e){return new Date(e.getFullYear(),e.getMonth()+1,0)}function OR(e){if(e==null)return new Date;if(e instanceof Date)return e;if(typeof e=="string"){const t=Date.parse(e);if(!isNaN(t))return new Date(t)}return null}const n1=new Date(2e3,0,2);function BR(e){const t=V_[e.slice(-2).toUpperCase()];return XS(7).map(i=>{const a=new Date(n1);return a.setDate(n1.getDate()+t+i),new Intl.DateTimeFormat(e,{weekday:"short"}).format(a)})}function FR(e,t,i){const a=new Date(e);let u={};switch(t){case"fullDateWithWeekday":u={weekday:"long",day:"numeric",month:"long",year:"numeric"};break;case"normalDateWithWeekday":u={weekday:"short",day:"numeric",month:"short"};break;case"keyboardDate":u={};break;case"monthAndDate":u={month:"long",day:"numeric"};break;case"monthAndYear":u={month:"long",year:"numeric"};break;case"dayOfMonth":u={day:"numeric"};break;default:u={timeZone:"UTC",timeZoneName:"short"}}return new Intl.DateTimeFormat(i,u).format(a)}function NR(e,t){const i=new Date(e);return i.setDate(i.getDate()+t),i}function UR(e,t){const i=new Date(e);return i.setMonth(i.getMonth()+t),i}function $R(e){return e.getFullYear()}function VR(e){return e.getMonth()}function jR(e){return new Date(e.getFullYear(),0,1)}function GR(e){return new Date(e.getFullYear(),11,31)}function qR(e,t){return j_(e,t[0])&&WR(e,t[1])}function HR(e){const t=new Date(e);return t instanceof Date&&!isNaN(t.getTime())}function j_(e,t){return e.getTime()>t.getTime()}function WR(e,t){return e.getTime()<t.getTime()}function i1(e,t){return e.getTime()===t.getTime()}function ZR(e,t){return e.getDate()===t.getDate()&&e.getMonth()===t.getMonth()&&e.getFullYear()===t.getFullYear()}function YR(e,t){return e.getMonth()===t.getMonth()&&e.getFullYear()===t.getFullYear()}function XR(e,t,i){const a=new Date(e),u=new Date(t);return i==="month"?a.getMonth()-u.getMonth()+(a.getFullYear()-u.getFullYear())*12:Math.floor((a.getTime()-u.getTime())/(1e3*60*60*24))}function KR(e,t){const i=new Date(e);return i.setFullYear(t),i}class JR{constructor(t){this.locale=t.locale}date(t){return OR(t)}toJsDate(t){return t}addDays(t,i){return NR(t,i)}addMonths(t,i){return UR(t,i)}getWeekArray(t){return zR(t,this.locale)}startOfMonth(t){return dE(t)}endOfMonth(t){return fE(t)}format(t,i){return FR(t,i,this.locale)}isEqual(t,i){return i1(t,i)}isValid(t){return HR(t)}isWithinRange(t,i){return qR(t,i)}isAfter(t,i){return j_(t,i)}isBefore(t,i){return!j_(t,i)&&!i1(t,i)}isSameDay(t,i){return ZR(t,i)}isSameMonth(t,i){return YR(t,i)}setYear(t,i){return KR(t,i)}getDiff(t,i,a){return XR(t,i,a)}getWeekdays(){return BR(this.locale)}getYear(t){return $R(t)}getMonth(t){return VR(t)}startOfYear(t){return jR(t)}endOfYear(t){return GR(t)}}const r1=Symbol.for("vuetify:date-adapter");function QR(e){return Es({adapter:JR,locale:{af:"af-ZA",bg:"bg-BG",ca:"ca-ES",ckb:"",cs:"",de:"de-DE",el:"el-GR",en:"en-US",et:"et-EE",fa:"fa-IR",fi:"fi-FI",hr:"hr-HR",hu:"hu-HU",he:"he-IL",id:"id-ID",it:"it-IT",ja:"ja-JP",ko:"ko-KR",lv:"lv-LV",lt:"lt-LT",nl:"nl-NL",no:"nn-NO",pl:"pl-PL",pt:"pt-PT",ro:"ro-RO",ru:"ru-RU",sk:"sk-SK",sl:"sl-SI",srCyrl:"sr-SP",srLatn:"sr-SP",sv:"sv-SE",th:"th-TH",tr:"tr-TR",az:"az-AZ",uk:"uk-UA",vi:"vi-VN",zhHans:"zh-CN",zhHant:"zh-TW"}},e)}function pE(e){const t=Kt(),i=Kt();if(ji){const a=new ResizeObserver(u=>{e==null||e(u,a),u.length&&(i.value=u[0].contentRect)});Va(()=>{a.disconnect()}),En(t,(u,d)=>{d&&(a.unobserve(O_(d)),i.value=void 0),u&&a.observe(O_(u))},{flush:"post"})}return{resizeRef:t,contentRect:md(i)}}const s1=Symbol.for("vuetify:layout"),eM=Symbol.for("vuetify:layout-item"),a1=1e3,tM=Ft({overlaps:{type:Array,default:()=>[]},fullHeight:Boolean},"layout"),nM=(e,t,i,a)=>{let u={top:0,left:0,right:0,bottom:0};const d=[{id:"",layer:{...u}}];for(const p of e){const l=t.get(p),b=i.get(p),w=a.get(p);if(!l||!b||!w)continue;const C={...u,[l.value]:parseInt(u[l.value],10)+(w.value?parseInt(b.value,10):0)};d.push({id:p,layer:C}),u=C}return d};function iM(e){const t=Jn(s1,null),i=Ce(()=>t?t.rootZIndex.value-100:a1),a=Kt([]),u=Ki(new Map),d=Ki(new Map),p=Ki(new Map),l=Ki(new Map),b=Ki(new Map),{resizeRef:w,contentRect:C}=pE(),I=Ce(()=>{const Le=new Map,Ie=e.overlaps??[];for(const U of Ie.filter(H=>H.includes(":"))){const[H,he]=U.split(":");if(!a.value.includes(H)||!a.value.includes(he))continue;const xe=u.get(H),we=u.get(he),oe=d.get(H),ke=d.get(he);!xe||!we||!oe||!ke||(Le.set(he,{position:xe.value,amount:parseInt(oe.value,10)}),Le.set(H,{position:we.value,amount:-parseInt(ke.value,10)}))}return Le}),M=Ce(()=>{const Le=[...new Set([...p.values()].map(U=>U.value))].sort((U,H)=>U-H),Ie=[];for(const U of Le){const H=a.value.filter(he=>{var xe;return((xe=p.get(he))==null?void 0:xe.value)===U});Ie.push(...H)}return nM(Ie,u,d,l)}),O=Ce(()=>!Array.from(b.values()).some(Le=>Le.value)),j=Ce(()=>M.value[M.value.length-1].layer),Z=Ce(()=>({"--v-layout-left":mn(j.value.left),"--v-layout-right":mn(j.value.right),"--v-layout-top":mn(j.value.top),"--v-layout-bottom":mn(j.value.bottom),...O.value?void 0:{transition:"none"}})),ue=Ce(()=>M.value.slice(1).map((Le,Ie)=>{let{id:U}=Le;const{layer:H}=M.value[Ie],he=d.get(U),xe=u.get(U);return{id:U,...H,size:Number(he.value),position:xe.value}})),ce=Le=>ue.value.find(Ie=>Ie.id===Le),ve=Lr("createLayout"),ye=Sn(!1);wl(()=>{ye.value=!0}),_r(s1,{register:(Le,Ie)=>{let{id:U,order:H,position:he,layoutSize:xe,elementSize:we,active:oe,disableTransitions:ke,absolute:tt}=Ie;p.set(U,H),u.set(U,he),d.set(U,xe),l.set(U,oe),ke&&b.set(U,ke);const Ve=Mh(eM,ve==null?void 0:ve.vnode).indexOf(Le);Ve>-1?a.value.splice(Ve,0,U):a.value.push(U);const $e=Ce(()=>ue.value.findIndex(rt=>rt.id===U)),He=Ce(()=>i.value+M.value.length*2-$e.value*2),kt=Ce(()=>{const rt=he.value==="left"||he.value==="right",It=he.value==="right",Vt=he.value==="bottom",Lt={[he.value]:0,zIndex:He.value,transform:`translate${rt?"X":"Y"}(${(oe.value?0:-110)*(It||Vt?-1:1)}%)`,position:tt.value||i.value!==a1?"absolute":"fixed",...O.value?void 0:{transition:"none"}};if(!ye.value)return Lt;const qe=ue.value[$e.value];if(!qe)throw new Error(`[Vuetify] Could not find layout item "${U}"`);const Se=I.value.get(U);return Se&&(qe[Se.position]+=Se.amount),{...Lt,height:rt?`calc(100% - ${qe.top}px - ${qe.bottom}px)`:we.value?`${we.value}px`:void 0,left:It?void 0:`${qe.left}px`,right:It?`${qe.right}px`:void 0,top:he.value!=="bottom"?`${qe.top}px`:void 0,bottom:he.value!=="top"?`${qe.bottom}px`:void 0,width:rt?we.value?`${we.value}px`:void 0:`calc(100% - ${qe.left}px - ${qe.right}px)`}}),Ct=Ce(()=>({zIndex:He.value-1}));return{layoutItemStyles:kt,layoutItemScrimStyles:Ct,zIndex:He}},unregister:Le=>{p.delete(Le),u.delete(Le),d.delete(Le),l.delete(Le),b.delete(Le),a.value=a.value.filter(Ie=>Ie!==Le)},mainRect:j,mainStyles:Z,getLayoutItem:ce,items:ue,layoutRect:C,rootZIndex:i});const Ae=Ce(()=>["v-layout",{"v-layout--full-height":e.fullHeight}]),Be=Ce(()=>({zIndex:i.value,position:t?"relative":void 0,overflow:t?"hidden":void 0}));return{layoutClasses:Ae,layoutStyles:Be,getLayoutItem:ce,items:ue,layoutRect:C,layoutRef:w}}function mE(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{blueprint:t,...i}=e,a=Es(t,i),{aliases:u={},components:d={},directives:p={}}=a,l=cR(a.defaults),b=fR(a.display,a.ssr),w=LR(a.theme),C=yR(a.icons),I=ER(a.locale),M=QR(a.date);return{install:j=>{for(const Z in p)j.directive(Z,p[Z]);for(const Z in d)j.component(Z,d[Z]);for(const Z in u)j.component(Z,ru({...u[Z],name:Z,aliasName:u[Z].name}));if(w.install(j),j.provide(Kh,l),j.provide(U_,b),j.provide(Ip,w),j.provide($_,C),j.provide(Cp,I),j.provide(r1,M),ji&&a.ssr)if(j.$nuxt)j.$nuxt.hook("app:suspense:resolve",()=>{b.update()});else{const{mount:Z}=j;j.mount=function(){const ue=Z(...arguments);return yr(()=>b.update()),j.mount=Z,ue}}Hs.reset(),j.mixin({computed:{$vuetify(){return Ki({defaults:Sc.call(this,Kh),display:Sc.call(this,U_),theme:Sc.call(this,Ip),icons:Sc.call(this,$_),locale:Sc.call(this,Cp),date:Sc.call(this,r1)})}}})},defaults:l,display:b,theme:w,icons:C,locale:I,date:M}}const rM="3.3.6";mE.version=rM;function Sc(e){var a,u;const t=this.$,i=((a=t.parent)==null?void 0:a.provides)??((u=t.vnode.appContext)==null?void 0:u.provides);if(i&&e in i)return i[e]}var sM=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};sM.SENTRY_RELEASE={id:"5bd55e71901583927965f54eb2a1f3a6540b212d"};const aM=mE({theme:{defaultTheme:"light"}}),gE=Symbol("vue-facing-decorator-slot");class oM{constructor(t){this.names=new Map,this.inComponent=!1,this.cachedVueComponent=null,this.master=t}obtainMap(t){let i=this.names.get(t);return i||(i=new Map,this.names.set(t,i)),i}}function lM(e){if(fm(e))throw"";const t=new oM(e);return Object.defineProperty(e,gE,{enumerable:!1,value:t}),t}function fm(e){var t;return(t=Object.getOwnPropertyDescriptor(e,gE))===null||t===void 0?void 0:t.value}function Qi(e){const t=fm(e);return t||lM(e)}function cM(e,t){return e.reduce((i,a)=>(i[a]=t[a],i),{})}function yv(e){const t=[];let i=e;do t.unshift(i),i=Object.getPrototypeOf(i);while(i.constructor!==bv&&!fm(i));return t}function _E(e){let t=Object.getPrototypeOf(e);for(;t.constructor!==bv;){const i=fm(t);if(i)return i;t=Object.getPrototypeOf(t)}return null}function yE(e,t){return e.filter(i=>{let a=t;for(;a!=null;){for(const u of a.names.keys()){if(["watch","hooks","setup","emits"].includes(u))continue;if(a.names.get(u).has(i))return!1}a=_E(a.master)}return!0})}function vv(e,t){const i=Object.getOwnPropertyDescriptors(e);return Object.keys(i).filter(a=>t(i[a],a))}function xv(e){function t(i,a){if(a)e(i,a);else return function(u,d){e(u,d,i)}}return t}const uM=e=>e instanceof Promise;function hM(e,t){const a=Qi(e.prototype).obtainMap("setup");if(a.size===0)return;const u=function(d,p){const l={};let b=null;for(const w of a.keys()){const C=a.get(w).setupFunction(d,p);uM(C)?(b??(b=[]),b.push(C.then(I=>{l[w]=I}))):l[w]=C}return Array.isArray(b)?Promise.all(b).then(()=>l):l};t.setup=u}function dM(e,t){var i;(i=t.computed)!==null&&i!==void 0||(t.computed={});const a=Qi(e.prototype),u=a.obtainMap("computed"),d=a.obtainMap("vanilla");yv(e.prototype).forEach(l=>{vv(l,(b,w)=>(typeof b.get=="function"||typeof b.set=="function")&&!d.has(w)).forEach(b=>{u.set(b,!0);const w=Object.getOwnPropertyDescriptor(l,b);t.computed[b]={get:typeof w.get=="function"?w.get:void 0,set:typeof w.set=="function"?w.set:void 0}})})}function fM(e,t,i,a){var u;(u=t.data)!==null&&u!==void 0||(t.data={});const d=new e(t,i);let p=vv(d,b=>!!b.enumerable);const l=Qi(e.prototype);p=yE(p,l),Object.assign(t.data,cM(p,d))}const pM=["beforeCreate","created","beforeMount","mounted","beforeUpdate","updated","activated","deactivated","beforeDestroy","beforeUnmount","destroyed","unmounted","renderTracked","renderTriggered","errorCaptured","serverPrefetch","render"];function mM(e,t){var i,a;const u=Qi(e.prototype),d=yv(e.prototype),p=u.obtainMap("hooks");(i=t.hooks)!==null&&i!==void 0||(t.hooks={}),(a=t.methods)!==null&&a!==void 0||(t.methods={});const l={},b={};d.forEach(C=>{yE(vv(C,(I,M)=>M==="constructor"?!1:typeof I.value=="function"),u).forEach(I=>{pM.includes(I)||p.has(I)?l[I]=C[I]:b[I]=C[I]})}),Object.assign(t.methods,b);const w=t.beforeCreateCallbacks;if(w&&w.length>0){const C=l.beforeCreate;l.beforeCreate=function(){w.forEach(I=>I.apply(this,arguments)),C&&C.apply(this,arguments)}}Object.assign(t.hooks,l)}function vE(e,t){var i;(i=e.beforeCreateCallbacks)!==null&&i!==void 0||(e.beforeCreateCallbacks=[]),e.beforeCreateCallbacks.push(function(){const a=this;t(a).forEach((d,p)=>{Object.defineProperty(a,p,d)})})}const gM=xv(function(e,t){Qi(e).obtainMap("ref").set(t,!0)});function _M(e,t){const a=Qi(e.prototype).obtainMap("ref");a&&vE(t,u=>{const d=new Map;return a.forEach((p,l)=>{d.set(l,{get:function(){return u.$refs[l]},set:void 0})}),d})}function Ws(e,t){return function(i,a){const d=Qi(i).obtainMap("watch"),p=Object.assign({},t??{},{key:e,handler:i[a]});if(d.has(a)){const l=d.get(a);Array.isArray(l)?l.push(p):d.set(a,[l,p])}else d.set(a,p)}}function yM(e,t){var i;(i=t.watch)!==null&&i!==void 0||(t.watch={});const u=Qi(e.prototype).obtainMap("watch");u&&u.forEach((d,p)=>{(Array.isArray(d)?d:[d]).forEach(b=>{if(!t.watch[b.key])t.watch[b.key]=b;else{const w=t.watch[b.key];Array.isArray(w)?w.push(b):t.watch[b.key]=[w,b]}})})}const Xr=xv(function(e,t,i){const u=Qi(e).obtainMap("props"),d=Object.assign({},i??{});u.set(t,d)});function vM(e,t){var i;(i=t.props)!==null&&i!==void 0||(t.props={});const u=Qi(e.prototype).obtainMap("props");u&&u.forEach((d,p)=>{t.props[p]=d})}function xM(e,t){var i;(i=t.inject)!==null&&i!==void 0||(t.inject={});const u=Qi(e.prototype).obtainMap("inject");u&&u.forEach((d,p)=>{t.inject[p]=d})}var bM=globalThis&&globalThis.__awaiter||function(e,t,i,a){function u(d){return d instanceof i?d:new i(function(p){p(d)})}return new(i||(i=Promise))(function(d,p){function l(C){try{w(a.next(C))}catch(I){p(I)}}function b(C){try{w(a.throw(C))}catch(I){p(I)}}function w(C){C.done?d(C.value):u(C.value).then(l,b)}w((a=a.apply(e,t||[])).next())})};const wM=xv(function(e,t,i){Qi(e).obtainMap("emit").set(t,typeof i>"u"?null:i)});function SM(e,t){var i;(i=t.methods)!==null&&i!==void 0||(t.methods={});const a=e.prototype,u=Qi(a),d=u.obtainMap("emit"),p=u.obtainMap("emits");d&&d.forEach((l,b)=>{const w=l===null?b:l;p.set(w,!0),t.methods[b]=function(){return bM(this,arguments,void 0,function*(){const C=a[b].apply(this,arguments);if(C instanceof Promise){const I=yield C;this.$emit(w,I)}else this.$emit(w,C)})}})}function EM(e,t){var i;(i=t.computed)!==null&&i!==void 0||(t.computed={});const u=Qi(e.prototype).obtainMap("v-model");u&&u.size>0&&u.forEach((d,p)=>{var l;const b=(l=d&&d.name)!==null&&l!==void 0?l:"modelValue";t.computed[p]={get:function(){return this[b]},set:function(w){this.$emit(`update:${b}`,w)}}})}function TM(e,t){const a=Qi(e.prototype).obtainMap("vanilla"),u=yv(e.prototype),d=new Map;vE(t,p=>(u.forEach(l=>{const b=Object.getOwnPropertyDescriptors(l);for(const w in b){const C=b[w];C&&a.has(w)&&(typeof C.get=="function"||typeof C.set=="function")&&d.set(w,{set:typeof C.set=="function"?C.set.bind(p):void 0,get:typeof C.get=="function"?C.get.bind(p):void 0})}}),d))}const CM=[];function IM(e,t){const i={};hM(e,i),EM(e,i),dM(e,i),yM(e,i),vM(e,i),xM(e,i),SM(e,i),_M(e,i),mM(e,i),TM(e,i);const a=i.setup?function(d,p){return i.setup(d,p)}:void 0;return Object.assign(Object.assign({setup:a,data(){var d;return delete i.data,fM(e,i,this),(d=i.data)!==null&&d!==void 0?d:{}},methods:i.methods,computed:i.computed,watch:i.watch,props:i.props,inject:i.inject},i.hooks),{extends:t})}function kM(e,t,i){const a=IM(e,i),u=Qi(e.prototype);Object.keys(t).reduce((p,l)=>(["options","modifier","emits","setup"].includes(l)||(p[l]=t[l]),p),a);let d=Array.from(u.obtainMap("emits").keys());if(Array.isArray(t.emits)&&(d=Array.from(new Set([...d,...t.emits]))),a.emits=d,CM.forEach(p=>{p.creator.apply({},[a,p.key])}),t.setup)if(!a.setup)a.setup=t.setup;else{const p=a.setup,l=t.setup,b=function(w,C){const I=l(w,C),M=p(w,C);return M instanceof Promise||I instanceof Promise?Promise.all([I,M]).then(O=>Object.assign({},O[0],O[1])):Object.assign({},I,M)};a.setup=b}return t.options&&Object.assign(a,t.options),t.modifier&&t.modifier(a),rm(a)}function AM(e,t){const i=Qi(e.prototype);i.inComponent=!0;const a=_E(e.prototype);if(a){if(!a.inComponent)throw"Class should be decorated by Component or ComponentBase: "+i.master;if(a.cachedVueComponent===null)throw"Component decorator 1"}const u=kM(e,t,a===null?void 0:a.cachedVueComponent);u.__vfdConstructor=e,i.cachedVueComponent=u}function PM(e,t){return typeof e=="function"?t(e,{}):function(i){return t(i,e)}}function zr(e){return PM(e,function(t,i){return AM(t,i),Qi(t.prototype).cachedVueComponent})}const bv=class{constructor(e,t){const i=e.props;i&&Object.keys(i).forEach(a=>{this[a]=t[a]})}},Or=bv,Yn=lv("filter",{state:()=>({search:"",isMapSynced:!1,resetTrigger:!1,mapShownAssociations:[],countriesFilter:[],thematicsFilter:[],countries:[],thematics:[{value:"accueil",label:"Accueil, assistance et orientation"},{value:"accompagnement",label:"Accompagnement  des migrants de retour"},{value:"humanitaire",label:"Assistance humanitaire (rfugies, dplacs, apatrides)"},{value:"cohesion",label:"Cohsion sociale et vivre ensemble, lutte contre les discriminations"},{value:"droit",label:"Droit et protection des migrants"},{value:"education_sante",label:"Education et sant"},{value:"enfants",label:"Enfants et migration"},{value:"genre",label:"Genre et migration"},{value:"gouvernance",label:"Gouvernance et politiques migratoires"},{value:"professionnel",label:"Formation, insertion professionnelle, intgration conomique"},{value:"developpement",label:"Migration et dveloppement "},{value:"plaidoyer",label:"Plaidoyer et sensibilisation"},{value:"circulation",label:"Prvention de la migration irrgulire, promotion de la migration lgale et de la libert de circulation"},{value:"autre_theme",label:"Autre"}]}),getters:{getThematicName:e=>t=>{var i;return((i=e.thematics.find(a=>a.value===t))==null?void 0:i.label)??null}},actions:{}}),zi=lv("associations",{state:()=>({associations:[],activeAssociationId:null,hoveredAssociationId:null}),getters:{filteredAssociationsWithoutMapFilter:e=>{let t=e.associations;if(Yn().countriesFilter.length&&(t=t.filter(i=>Yn().countriesFilter.includes(i.country))),Yn().thematicsFilter.length&&(t=t.filter(i=>i.thematics.some(a=>Yn().thematicsFilter.includes(a)))),Yn().search!==""){let i=[];t.forEach(a=>{let u=a.name.normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLowerCase(),d=Yn().search.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"");u.includes(d)&&i.push(a)}),t=i}return t},filteredAssociations(){let e=this.filteredAssociationsWithoutMapFilter;return Yn().isMapSynced&&(e=e.filter(t=>Yn().mapShownAssociations.includes(t.id))),e.sort((t,i)=>t.name.localeCompare(i.name))},activeAssociation:e=>e.associations.find(t=>t.id===e.activeAssociationId)??null},actions:{}}),mi=lv("app",{state:()=>({isAboutModalShown:!1,isRedirectionModalShown:!1,isInfoPanelShown:!1,isFiltersBarShown:!1,isDownloadShown:!1,triggerZoomReset:!1,downloadReports:[{name:"Rsultats synthtiques Tunisie",filename:"Rsultats synthtiques_Tunisie.pdf"},{name:"Synthse Nationale Cte d'Ivoire",filename:"Synthse Nationale _Cte d'Ivoire.pdf"},{name:"Synthse Nationale Sngal",filename:"Synthse Nationale_Sngal.pdf"}]}),getters:{},actions:{}});var xE=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function RM(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var bE={exports:{}};(function(e,t){(function(i,a){e.exports=a()})(xE,function(){var i,a,u;function d(l,b){if(!i)i=b;else if(!a)a=b;else{var w="var sharedChunk = {}; ("+i+")(sharedChunk); ("+a+")(sharedChunk);",C={};i(C),u=b(C),typeof window<"u"&&(u.workerUrl=window.URL.createObjectURL(new Blob([w],{type:"text/javascript"})))}}d(["exports"],function(l){function b(s){return s&&s.__esModule&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s}var w=C;function C(s,n){this.x=s,this.y=n}C.prototype={clone:function(){return new C(this.x,this.y)},add:function(s){return this.clone()._add(s)},sub:function(s){return this.clone()._sub(s)},multByPoint:function(s){return this.clone()._multByPoint(s)},divByPoint:function(s){return this.clone()._divByPoint(s)},mult:function(s){return this.clone()._mult(s)},div:function(s){return this.clone()._div(s)},rotate:function(s){return this.clone()._rotate(s)},rotateAround:function(s,n){return this.clone()._rotateAround(s,n)},matMult:function(s){return this.clone()._matMult(s)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(s){return this.x===s.x&&this.y===s.y},dist:function(s){return Math.sqrt(this.distSqr(s))},distSqr:function(s){var n=s.x-this.x,o=s.y-this.y;return n*n+o*o},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(s){return Math.atan2(this.y-s.y,this.x-s.x)},angleWith:function(s){return this.angleWithSep(s.x,s.y)},angleWithSep:function(s,n){return Math.atan2(this.x*n-this.y*s,this.x*s+this.y*n)},_matMult:function(s){var n=s[2]*this.x+s[3]*this.y;return this.x=s[0]*this.x+s[1]*this.y,this.y=n,this},_add:function(s){return this.x+=s.x,this.y+=s.y,this},_sub:function(s){return this.x-=s.x,this.y-=s.y,this},_mult:function(s){return this.x*=s,this.y*=s,this},_div:function(s){return this.x/=s,this.y/=s,this},_multByPoint:function(s){return this.x*=s.x,this.y*=s.y,this},_divByPoint:function(s){return this.x/=s.x,this.y/=s.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var s=this.y;return this.y=this.x,this.x=-s,this},_rotate:function(s){var n=Math.cos(s),o=Math.sin(s),h=o*this.x+n*this.y;return this.x=n*this.x-o*this.y,this.y=h,this},_rotateAround:function(s,n){var o=Math.cos(s),h=Math.sin(s),g=n.y+h*(this.x-n.x)+o*(this.y-n.y);return this.x=n.x+o*(this.x-n.x)-h*(this.y-n.y),this.y=g,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},C.convert=function(s){return s instanceof C?s:Array.isArray(s)?new C(s[0],s[1]):s};var I=b(w),M=O;function O(s,n,o,h){this.cx=3*s,this.bx=3*(o-s)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*n,this.by=3*(h-n)-this.cy,this.ay=1-this.cy-this.by,this.p1x=s,this.p1y=n,this.p2x=o,this.p2y=h}O.prototype={sampleCurveX:function(s){return((this.ax*s+this.bx)*s+this.cx)*s},sampleCurveY:function(s){return((this.ay*s+this.by)*s+this.cy)*s},sampleCurveDerivativeX:function(s){return(3*this.ax*s+2*this.bx)*s+this.cx},solveCurveX:function(s,n){if(n===void 0&&(n=1e-6),s<0)return 0;if(s>1)return 1;for(var o=s,h=0;h<8;h++){var g=this.sampleCurveX(o)-s;if(Math.abs(g)<n)return o;var y=this.sampleCurveDerivativeX(o);if(Math.abs(y)<1e-6)break;o-=g/y}var v=0,S=1;for(o=s,h=0;h<20&&(g=this.sampleCurveX(o),!(Math.abs(g-s)<n));h++)s>g?v=o:S=o,o=.5*(S-v)+v;return o},solve:function(s,n){return this.sampleCurveY(this.solveCurveX(s,n))}};var j=b(M);function Z(s,n,o,h){const g=new j(s,n,o,h);return function(y){return g.solve(y)}}const ue=Z(.25,.1,.25,1);function ce(s,n,o){return Math.min(o,Math.max(n,s))}function ve(s,n,o){const h=o-n,g=((s-n)%h+h)%h+n;return g===n?o:g}function ye(s,...n){for(const o of n)for(const h in o)s[h]=o[h];return s}let Ae=1;function Be(s,n){s.forEach(o=>{n[o]&&(n[o]=n[o].bind(n))})}function Le(s,n,o){const h={};for(const g in s)h[g]=n.call(o||this,s[g],g,s);return h}function Ie(s,n,o){const h={};for(const g in s)n.call(o||this,s[g],g,s)&&(h[g]=s[g]);return h}function U(s){return Array.isArray(s)?s.map(U):typeof s=="object"&&s?Le(s,U):s}const H={};function he(s){H[s]||(typeof console<"u"&&console.warn(s),H[s]=!0)}function xe(s,n,o){return(o.y-s.y)*(n.x-s.x)>(n.y-s.y)*(o.x-s.x)}function we(s){let n=0;for(let o,h,g=0,y=s.length,v=y-1;g<y;v=g++)o=s[g],h=s[v],n+=(h.x-o.x)*(o.y+h.y);return n}function oe(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}let ke=null;function tt(s){if(ke==null){const n=s.navigator?s.navigator.userAgent:null;ke=!!s.safari||!(!n||!(/\b(iPad|iPhone|iPod)\b/.test(n)||n.match("Safari")&&!n.match("Chrome")))}return ke}function et(s){return typeof ImageBitmap<"u"&&s instanceof ImageBitmap}const Ve="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let $e,He;const kt={now:typeof performance<"u"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),frame(s){const n=requestAnimationFrame(s);return{cancel:()=>cancelAnimationFrame(n)}},getImageData(s,n=0){return this.getImageCanvasContext(s).getImageData(-n,-n,s.width+2*n,s.height+2*n)},getImageCanvasContext(s){const n=window.document.createElement("canvas"),o=n.getContext("2d",{willReadFrequently:!0});if(!o)throw new Error("failed to create canvas 2d context");return n.width=s.width,n.height=s.height,o.drawImage(s,0,0,s.width,s.height),o},resolveURL:s=>($e||($e=document.createElement("a")),$e.href=s,$e.href),hardwareConcurrency:typeof navigator<"u"&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return!!matchMedia&&(He==null&&(He=matchMedia("(prefers-reduced-motion: reduce)")),He.matches)}},Ct={MAX_PARALLEL_IMAGE_REQUESTS:16,MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:8,MAX_TILE_CACHE_ZOOM_LEVELS:5,REGISTERED_PROTOCOLS:{},WORKER_URL:""};class rt extends Error{constructor(n,o,h,g){super(`AJAXError: ${o} (${n}): ${h}`),this.status=n,this.statusText=o,this.url=h,this.body=g}}const It=oe()?()=>self.worker&&self.worker.referrer:()=>(window.location.protocol==="blob:"?window.parent:window).location.href,Vt=s=>Ct.REGISTERED_PROTOCOLS[s.substring(0,s.indexOf("://"))];function Lt(s,n){const o=new AbortController,h=new Request(s.url,{method:s.method||"GET",body:s.body,credentials:s.credentials,headers:s.headers,referrer:It(),signal:o.signal});let g=!1,y=!1;return s.type==="json"&&h.headers.set("Accept","application/json"),y||fetch(h).then(v=>v.ok?(S=>{(s.type==="arrayBuffer"||s.type==="image"?S.arrayBuffer():s.type==="json"?S.json():S.text()).then(T=>{y||(g=!0,n(null,T,S.headers.get("Cache-Control"),S.headers.get("Expires")))}).catch(T=>{y||n(new Error(T.message))})})(v):v.blob().then(S=>n(new rt(v.status,v.statusText,s.url,S)))).catch(v=>{v.code!==20&&n(new Error(v.message))}),{cancel:()=>{y=!0,g||o.abort()}}}const qe=function(s,n){if(/:\/\//.test(s.url)&&!/^https?:|^file:/.test(s.url)){if(oe()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",s,n);if(!oe())return(Vt(s.url)||Lt)(s,n)}if(!(/^file:/.test(o=s.url)||/^file:/.test(It())&&!/^\w+:/.test(o))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return Lt(s,n);if(oe()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",s,n,void 0,!0)}var o;return function(h,g){const y=new XMLHttpRequest;y.open(h.method||"GET",h.url,!0),h.type!=="arrayBuffer"&&h.type!=="image"||(y.responseType="arraybuffer");for(const v in h.headers)y.setRequestHeader(v,h.headers[v]);return h.type==="json"&&(y.responseType="text",y.setRequestHeader("Accept","application/json")),y.withCredentials=h.credentials==="include",y.onerror=()=>{g(new Error(y.statusText))},y.onload=()=>{if((y.status>=200&&y.status<300||y.status===0)&&y.response!==null){let v=y.response;if(h.type==="json")try{v=JSON.parse(y.response)}catch(S){return g(S)}g(null,v,y.getResponseHeader("Cache-Control"),y.getResponseHeader("Expires"))}else{const v=new Blob([y.response],{type:y.getResponseHeader("Content-Type")});g(new rt(y.status,y.statusText,h.url,v))}},y.send(h.body),{cancel:()=>y.abort()}}(s,n)},Se=function(s,n){return qe(ye(s,{type:"arrayBuffer"}),n)};function Ye(s){if(!s||s.indexOf("://")<=0||s.indexOf("data:image/")===0||s.indexOf("blob:")===0)return!0;const n=new URL(s),o=window.location;return n.protocol===o.protocol&&n.host===o.host}function Oe(s,n,o){o[s]&&o[s].indexOf(n)!==-1||(o[s]=o[s]||[],o[s].push(n))}function je(s,n,o){if(o&&o[s]){const h=o[s].indexOf(n);h!==-1&&o[s].splice(h,1)}}class ft{constructor(n,o={}){ye(this,o),this.type=n}}class Y extends ft{constructor(n,o={}){super("error",ye({error:n},o))}}class ie{on(n,o){return this._listeners=this._listeners||{},Oe(n,o,this._listeners),this}off(n,o){return je(n,o,this._listeners),je(n,o,this._oneTimeListeners),this}once(n,o){return o?(this._oneTimeListeners=this._oneTimeListeners||{},Oe(n,o,this._oneTimeListeners),this):new Promise(h=>this.once(n,h))}fire(n,o){typeof n=="string"&&(n=new ft(n,o||{}));const h=n.type;if(this.listens(h)){n.target=this;const g=this._listeners&&this._listeners[h]?this._listeners[h].slice():[];for(const S of g)S.call(this,n);const y=this._oneTimeListeners&&this._oneTimeListeners[h]?this._oneTimeListeners[h].slice():[];for(const S of y)je(h,S,this._oneTimeListeners),S.call(this,n);const v=this._eventedParent;v&&(ye(n,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),v.fire(n))}else n instanceof Y&&console.error(n.error);return this}listens(n){return this._listeners&&this._listeners[n]&&this._listeners[n].length>0||this._oneTimeListeners&&this._oneTimeListeners[n]&&this._oneTimeListeners[n].length>0||this._eventedParent&&this._eventedParent.listens(n)}setEventedParent(n,o){return this._eventedParent=n,this._eventedParentData=o,this}}var W={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{}},default:"mapbox"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};const De=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function Ue(s,n){const o={};for(const h in s)h!=="ref"&&(o[h]=s[h]);return De.forEach(h=>{h in n&&(o[h]=n[h])}),o}function Ne(s,n){if(Array.isArray(s)){if(!Array.isArray(n)||s.length!==n.length)return!1;for(let o=0;o<s.length;o++)if(!Ne(s[o],n[o]))return!1;return!0}if(typeof s=="object"&&s!==null&&n!==null){if(typeof n!="object"||Object.keys(s).length!==Object.keys(n).length)return!1;for(const o in s)if(!Ne(s[o],n[o]))return!1;return!0}return s===n}const Ze={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight"};function ct(s,n,o){o.push({command:Ze.addSource,args:[s,n[s]]})}function dt(s,n,o){n.push({command:Ze.removeSource,args:[s]}),o[s]=!0}function nt(s,n,o,h){dt(s,o,h),ct(s,n,o)}function ut(s,n,o){let h;for(h in s[o])if(Object.prototype.hasOwnProperty.call(s[o],h)&&h!=="data"&&!Ne(s[o][h],n[o][h]))return!1;for(h in n[o])if(Object.prototype.hasOwnProperty.call(n[o],h)&&h!=="data"&&!Ne(s[o][h],n[o][h]))return!1;return!0}function mt(s,n,o,h,g,y){let v;for(v in n=n||{},s=s||{})Object.prototype.hasOwnProperty.call(s,v)&&(Ne(s[v],n[v])||o.push({command:y,args:[h,v,n[v],g]}));for(v in n)Object.prototype.hasOwnProperty.call(n,v)&&!Object.prototype.hasOwnProperty.call(s,v)&&(Ne(s[v],n[v])||o.push({command:y,args:[h,v,n[v],g]}))}function Mt(s){return s.id}function wt(s,n){return s[n.id]=n,s}class Ge{constructor(n,o,h,g){this.message=(n?`${n}: `:"")+h,g&&(this.identifier=g),o!=null&&o.__line__&&(this.line=o.__line__)}}function tn(s,...n){for(const o of n)for(const h in o)s[h]=o[h];return s}class Zt extends Error{constructor(n,o){super(o),this.message=o,this.key=n}}class dn{constructor(n,o=[]){this.parent=n,this.bindings={};for(const[h,g]of o)this.bindings[h]=g}concat(n){return new dn(this,n)}get(n){if(this.bindings[n])return this.bindings[n];if(this.parent)return this.parent.get(n);throw new Error(`${n} not found in scope.`)}has(n){return!!this.bindings[n]||!!this.parent&&this.parent.has(n)}}const zn={kind:"null"},at={kind:"number"},jt={kind:"string"},qt={kind:"boolean"},Dn={kind:"color"},fn={kind:"object"},Ot={kind:"value"},Fr={kind:"collator"},ks={kind:"formatted"},Kr={kind:"padding"},As={kind:"resolvedImage"};function Oi(s,n){return{kind:"array",itemType:s,N:n}}function Un(s){if(s.kind==="array"){const n=Un(s.itemType);return typeof s.N=="number"?`array<${n}, ${s.N}>`:s.itemType.kind==="value"?"array":`array<${n}>`}return s.kind}const Lo=[zn,at,jt,qt,Dn,ks,fn,Oi(Ot),Kr,As];function ds(s,n){if(n.kind==="error")return null;if(s.kind==="array"){if(n.kind==="array"&&(n.N===0&&n.itemType.kind==="value"||!ds(s.itemType,n.itemType))&&(typeof s.N!="number"||s.N===n.N))return null}else{if(s.kind===n.kind)return null;if(s.kind==="value"){for(const o of Lo)if(!ds(o,n))return null}}return`Expected ${Un(s)} but found ${Un(n)} instead.`}function ne(s,n){return n.some(o=>o.kind===s.kind)}function F(s,n){return n.some(o=>o==="null"?s===null:o==="array"?Array.isArray(s):o==="object"?s&&!Array.isArray(s)&&typeof s=="object":o===typeof s)}function $(s,n){return s.kind==="array"&&n.kind==="array"?s.itemType.kind===n.itemType.kind&&typeof s.N=="number":s.kind===n.kind}const X=.96422,ae=.82521,de=4/29,be=6/29,me=3*be*be,fe=be*be*be,Te=Math.PI/180,Xe=180/Math.PI;function Je(s){return(s%=360)<0&&(s+=360),s}function Ke([s,n,o,h]){let g,y;const v=Jt((.2225045*(s=Gt(s))+.7168786*(n=Gt(n))+.0606169*(o=Gt(o)))/1);s===n&&n===o?g=y=v:(g=Jt((.4360747*s+.3850649*n+.1430804*o)/X),y=Jt((.0139322*s+.0971045*n+.7141733*o)/ae));const S=116*v-16;return[S<0?0:S,500*(g-v),200*(v-y),h]}function Gt(s){return s<=.04045?s/12.92:Math.pow((s+.055)/1.055,2.4)}function Jt(s){return s>fe?Math.pow(s,1/3):s/me+de}function Pt([s,n,o,h]){let g=(s+16)/116,y=isNaN(n)?g:g+n/500,v=isNaN(o)?g:g-o/200;return g=1*Xt(g),y=X*Xt(y),v=ae*Xt(v),[Nt(3.1338561*y-1.6168667*g-.4906146*v),Nt(-.9787684*y+1.9161415*g+.033454*v),Nt(.0719453*y-.2289914*g+1.4052427*v),h]}function Nt(s){return(s=s<=.00304?12.92*s:1.055*Math.pow(s,1/2.4)-.055)<0?0:s>1?1:s}function Xt(s){return s>be?s*s*s:me*(s-de)}function hn(s){return parseInt(s.padEnd(2,s),16)/255}function rn(s,n){return yn(n?s/100:s,0,1)}function yn(s,n,o){return Math.min(Math.max(n,s),o)}function Bn(s){return!s.some(Number.isNaN)}const gi={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};class Yt{constructor(n,o,h,g=1,y=!0){this.r=n,this.g=o,this.b=h,this.a=g,y||(this.r*=g,this.g*=g,this.b*=g,g||this.overwriteGetter("rgb",[n,o,h,g]))}static parse(n){if(n instanceof Yt)return n;if(typeof n!="string")return;const o=function(h){if((h=h.toLowerCase())==="transparent")return[0,0,0,0];const g=gi[h];if(g){const[v,S,T]=g;return[v/255,S/255,T/255,1]}if(h.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(h)){const v=h.length<6?1:2;let S=1;return[hn(h.slice(S,S+=v)),hn(h.slice(S,S+=v)),hn(h.slice(S,S+=v)),hn(h.slice(S,S+v)||"ff")]}if(h.startsWith("rgb")){const v=h.match(/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(v){const[S,T,R,D,B,N,V,q,te,Q,_e,Ee]=v,pe=[D||" ",V||" ",Q].join("");if(pe==="  "||pe==="  /"||pe===",,"||pe===",,,"){const Re=[R,N,te].join(""),ze=Re==="%%%"?100:Re===""?255:0;if(ze){const We=[yn(+T/ze,0,1),yn(+B/ze,0,1),yn(+q/ze,0,1),_e?rn(+_e,Ee):1];if(Bn(We))return We}}return}}const y=h.match(/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(y){const[v,S,T,R,D,B,N,V,q]=y,te=[T||" ",D||" ",N].join("");if(te==="  "||te==="  /"||te===",,"||te===",,,"){const Q=[+S,yn(+R,0,100),yn(+B,0,100),V?rn(+V,q):1];if(Bn(Q))return function([_e,Ee,pe,Re]){function ze(We){const Tt=(We+_e/30)%12,Rt=Ee*Math.min(pe,1-pe);return pe-Rt*Math.max(-1,Math.min(Tt-3,9-Tt,1))}return _e=Je(_e),Ee/=100,pe/=100,[ze(0),ze(8),ze(4),Re]}(Q)}}}(n);return o?new Yt(...o,!1):void 0}get rgb(){const{r:n,g:o,b:h,a:g}=this,y=g||1/0;return this.overwriteGetter("rgb",[n/y,o/y,h/y,g])}get hcl(){return this.overwriteGetter("hcl",function(n){const[o,h,g,y]=Ke(n),v=Math.sqrt(h*h+g*g);return[Math.round(1e4*v)?Je(Math.atan2(g,h)*Xe):NaN,v,o,y]}(this.rgb))}get lab(){return this.overwriteGetter("lab",Ke(this.rgb))}overwriteGetter(n,o){return Object.defineProperty(this,n,{value:o}),o}toString(){const[n,o,h,g]=this.rgb;return`rgba(${[n,o,h].map(y=>Math.round(255*y)).join(",")},${g})`}}Yt.black=new Yt(0,0,0,1),Yt.white=new Yt(1,1,1,1),Yt.transparent=new Yt(0,0,0,0),Yt.red=new Yt(1,0,0,1);class ii{constructor(n,o,h){this.sensitivity=n?o?"variant":"case":o?"accent":"base",this.locale=h,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(n,o){return this.collator.compare(n,o)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class Zs{constructor(n,o,h,g,y){this.text=n,this.image=o,this.scale=h,this.fontStack=g,this.textColor=y}}class Bi{constructor(n){this.sections=n}static fromString(n){return new Bi([new Zs(n,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(n=>n.text.length!==0||n.image&&n.image.name.length!==0)}static factory(n){return n instanceof Bi?n:Bi.fromString(n)}toString(){return this.sections.length===0?"":this.sections.map(n=>n.text).join("")}}class vr{constructor(n){this.values=n.slice()}static parse(n){if(n instanceof vr)return n;if(typeof n=="number")return new vr([n,n,n,n]);if(Array.isArray(n)&&!(n.length<1||n.length>4)){for(const o of n)if(typeof o!="number")return;switch(n.length){case 1:n=[n[0],n[0],n[0],n[0]];break;case 2:n=[n[0],n[1],n[0],n[1]];break;case 3:n=[n[0],n[1],n[2],n[1]]}return new vr(n)}}toString(){return JSON.stringify(this.values)}}class Nr{constructor(n){this.name=n.name,this.available=n.available}toString(){return this.name}static fromString(n){return n?new Nr({name:n,available:!1}):null}}function ja(s,n,o,h){return typeof s=="number"&&s>=0&&s<=255&&typeof n=="number"&&n>=0&&n<=255&&typeof o=="number"&&o>=0&&o<=255?h===void 0||typeof h=="number"&&h>=0&&h<=1?null:`Invalid rgba value [${[s,n,o,h].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof h=="number"?[s,n,o,h]:[s,n,o]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function Tl(s){if(s===null||typeof s=="string"||typeof s=="boolean"||typeof s=="number"||s instanceof Yt||s instanceof ii||s instanceof Bi||s instanceof vr||s instanceof Nr)return!0;if(Array.isArray(s)){for(const n of s)if(!Tl(n))return!1;return!0}if(typeof s=="object"){for(const n in s)if(!Tl(s[n]))return!1;return!0}return!1}function _i(s){if(s===null)return zn;if(typeof s=="string")return jt;if(typeof s=="boolean")return qt;if(typeof s=="number")return at;if(s instanceof Yt)return Dn;if(s instanceof ii)return Fr;if(s instanceof Bi)return ks;if(s instanceof vr)return Kr;if(s instanceof Nr)return As;if(Array.isArray(s)){const n=s.length;let o;for(const h of s){const g=_i(h);if(o){if(o===g)continue;o=Ot;break}o=g}return Oi(o||Ot,n)}return fn}function zo(s){const n=typeof s;return s===null?"":n==="string"||n==="number"||n==="boolean"?String(s):s instanceof Yt||s instanceof Bi||s instanceof vr||s instanceof Nr?s.toString():JSON.stringify(s)}class Ys{constructor(n,o){this.type=n,this.value=o}static parse(n,o){if(n.length!==2)return o.error(`'literal' expression requires exactly one argument, but found ${n.length-1} instead.`);if(!Tl(n[1]))return o.error("invalid value");const h=n[1];let g=_i(h);const y=o.expectedType;return g.kind!=="array"||g.N!==0||!y||y.kind!=="array"||typeof y.N=="number"&&y.N!==0||(g=y),new Ys(g,h)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}class ui{constructor(n){this.name="ExpressionEvaluationError",this.message=n}toJSON(){return this.message}}const Cl={string:jt,number:at,boolean:qt,object:fn};class Jr{constructor(n,o){this.type=n,this.args=o}static parse(n,o){if(n.length<2)return o.error("Expected at least one argument.");let h,g=1;const y=n[0];if(y==="array"){let S,T;if(n.length>2){const R=n[1];if(typeof R!="string"||!(R in Cl)||R==="object")return o.error('The item type argument of "array" must be one of string, number, boolean',1);S=Cl[R],g++}else S=Ot;if(n.length>3){if(n[2]!==null&&(typeof n[2]!="number"||n[2]<0||n[2]!==Math.floor(n[2])))return o.error('The length argument to "array" must be a positive integer literal',2);T=n[2],g++}h=Oi(S,T)}else{if(!Cl[y])throw new Error(`Types doesn't contain name = ${y}`);h=Cl[y]}const v=[];for(;g<n.length;g++){const S=o.parse(n[g],g,Ot);if(!S)return null;v.push(S)}return new Jr(h,v)}evaluate(n){for(let o=0;o<this.args.length;o++){const h=this.args[o].evaluate(n);if(!ds(this.type,_i(h)))return h;if(o===this.args.length-1)throw new ui(`Expected value to be of type ${Un(this.type)}, but found ${Un(_i(h))} instead.`)}throw new Error}eachChild(n){this.args.forEach(n)}outputDefined(){return this.args.every(n=>n.outputDefined())}}const Id={"to-boolean":qt,"to-color":Dn,"to-number":at,"to-string":jt};class Fi{constructor(n,o){this.type=n,this.args=o}static parse(n,o){if(n.length<2)return o.error("Expected at least one argument.");const h=n[0];if(!Id[h])throw new Error(`Can't parse ${h} as it is not part of the known types`);if((h==="to-boolean"||h==="to-string")&&n.length!==2)return o.error("Expected one argument.");const g=Id[h],y=[];for(let v=1;v<n.length;v++){const S=o.parse(n[v],v,Ot);if(!S)return null;y.push(S)}return new Fi(g,y)}evaluate(n){if(this.type.kind==="boolean")return!!this.args[0].evaluate(n);if(this.type.kind==="color"){let o,h;for(const g of this.args){if(o=g.evaluate(n),h=null,o instanceof Yt)return o;if(typeof o=="string"){const y=n.parseColor(o);if(y)return y}else if(Array.isArray(o)&&(h=o.length<3||o.length>4?`Invalid rbga value ${JSON.stringify(o)}: expected an array containing either three or four numeric values.`:ja(o[0],o[1],o[2],o[3]),!h))return new Yt(o[0]/255,o[1]/255,o[2]/255,o[3])}throw new ui(h||`Could not parse color from value '${typeof o=="string"?o:JSON.stringify(o)}'`)}if(this.type.kind==="padding"){let o;for(const h of this.args){o=h.evaluate(n);const g=vr.parse(o);if(g)return g}throw new ui(`Could not parse padding from value '${typeof o=="string"?o:JSON.stringify(o)}'`)}if(this.type.kind==="number"){let o=null;for(const h of this.args){if(o=h.evaluate(n),o===null)return 0;const g=Number(o);if(!isNaN(g))return g}throw new ui(`Could not convert ${JSON.stringify(o)} to number.`)}return this.type.kind==="formatted"?Bi.fromString(zo(this.args[0].evaluate(n))):this.type.kind==="resolvedImage"?Nr.fromString(zo(this.args[0].evaluate(n))):zo(this.args[0].evaluate(n))}eachChild(n){this.args.forEach(n)}outputDefined(){return this.args.every(n=>n.outputDefined())}}const mu=["Unknown","Point","LineString","Polygon"];class Il{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?mu[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(n){let o=this._parseColorCache[n];return o||(o=this._parseColorCache[n]=Yt.parse(n)),o}}class Xs{constructor(n,o,h=[],g,y=new dn,v=[]){this.registry=n,this.path=h,this.key=h.map(S=>`[${S}]`).join(""),this.scope=y,this.errors=v,this.expectedType=g,this._isConstant=o}parse(n,o,h,g,y={}){return o?this.concat(o,h,g)._parse(n,y):this._parse(n,y)}_parse(n,o){function h(g,y,v){return v==="assert"?new Jr(y,[g]):v==="coerce"?new Fi(y,[g]):g}if(n!==null&&typeof n!="string"&&typeof n!="boolean"&&typeof n!="number"||(n=["literal",n]),Array.isArray(n)){if(n.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const g=n[0];if(typeof g!="string")return this.error(`Expression name must be a string, but found ${typeof g} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const y=this.registry[g];if(y){let v=y.parse(n,this);if(!v)return null;if(this.expectedType){const S=this.expectedType,T=v.type;if(S.kind!=="string"&&S.kind!=="number"&&S.kind!=="boolean"&&S.kind!=="object"&&S.kind!=="array"||T.kind!=="value")if(S.kind!=="color"&&S.kind!=="formatted"&&S.kind!=="resolvedImage"||T.kind!=="value"&&T.kind!=="string")if(S.kind!=="padding"||T.kind!=="value"&&T.kind!=="number"&&T.kind!=="array"){if(this.checkSubtype(S,T))return null}else v=h(v,S,o.typeAnnotation||"coerce");else v=h(v,S,o.typeAnnotation||"coerce");else v=h(v,S,o.typeAnnotation||"assert")}if(!(v instanceof Ys)&&v.type.kind!=="resolvedImage"&&this._isConstant(v)){const S=new Il;try{v=new Ys(v.type,v.evaluate(S))}catch(T){return this.error(T.message),null}}return v}return this.error(`Unknown expression "${g}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(n===void 0?"'undefined' value invalid. Use null instead.":typeof n=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof n} instead.`)}concat(n,o,h){const g=typeof n=="number"?this.path.concat(n):this.path,y=h?this.scope.concat(h):this.scope;return new Xs(this.registry,this._isConstant,g,o||null,y,this.errors)}error(n,...o){const h=`${this.key}${o.map(g=>`[${g}]`).join("")}`;this.errors.push(new Zt(h,n))}checkSubtype(n,o){const h=ds(n,o);return h&&this.error(h),h}}class In{constructor(n,o,h){this.type=Fr,this.locale=h,this.caseSensitive=n,this.diacriticSensitive=o}static parse(n,o){if(n.length!==2)return o.error("Expected one argument.");const h=n[1];if(typeof h!="object"||Array.isArray(h))return o.error("Collator options argument must be an object.");const g=o.parse(h["case-sensitive"]!==void 0&&h["case-sensitive"],1,qt);if(!g)return null;const y=o.parse(h["diacritic-sensitive"]!==void 0&&h["diacritic-sensitive"],1,qt);if(!y)return null;let v=null;return h.locale&&(v=o.parse(h.locale,1,jt),!v)?null:new In(g,y,v)}evaluate(n){return new ii(this.caseSensitive.evaluate(n),this.diacriticSensitive.evaluate(n),this.locale?this.locale.evaluate(n):null)}eachChild(n){n(this.caseSensitive),n(this.diacriticSensitive),this.locale&&n(this.locale)}outputDefined(){return!1}}const Ks=8192;function Oo(s,n){s[0]=Math.min(s[0],n[0]),s[1]=Math.min(s[1],n[1]),s[2]=Math.max(s[2],n[0]),s[3]=Math.max(s[3],n[1])}function kl(s,n){return!(s[0]<=n[0]||s[2]>=n[2]||s[1]<=n[1]||s[3]>=n[3])}function kd(s,n){const o=(180+s[0])/360,h=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+s[1]*Math.PI/360)))/360,g=Math.pow(2,n.z);return[Math.round(o*g*Ks),Math.round(h*g*Ks)]}function Ad(s,n,o){const h=s[0]-n[0],g=s[1]-n[1],y=s[0]-o[0],v=s[1]-o[1];return h*v-y*g==0&&h*y<=0&&g*v<=0}function gu(s,n){let o=!1;for(let v=0,S=n.length;v<S;v++){const T=n[v];for(let R=0,D=T.length;R<D-1;R++){if(Ad(s,T[R],T[R+1]))return!1;(g=T[R])[1]>(h=s)[1]!=(y=T[R+1])[1]>h[1]&&h[0]<(y[0]-g[0])*(h[1]-g[1])/(y[1]-g[1])+g[0]&&(o=!o)}}var h,g,y;return o}function Pd(s,n){for(let o=0;o<n.length;o++)if(gu(s,n[o]))return!0;return!1}function _u(s,n,o,h){const g=h[0]-o[0],y=h[1]-o[1],v=(s[0]-o[0])*y-g*(s[1]-o[1]),S=(n[0]-o[0])*y-g*(n[1]-o[1]);return v>0&&S<0||v<0&&S>0}function Om(s,n,o){for(const R of o)for(let D=0;D<R.length-1;++D)if((S=[(v=R[D+1])[0]-(y=R[D])[0],v[1]-y[1]])[0]*(T=[(g=n)[0]-(h=s)[0],g[1]-h[1]])[1]-S[1]*T[0]!=0&&_u(h,g,y,v)&&_u(y,v,h,g))return!0;var h,g,y,v,S,T;return!1}function Rd(s,n){for(let o=0;o<s.length;++o)if(!gu(s[o],n))return!1;for(let o=0;o<s.length-1;++o)if(Om(s[o],s[o+1],n))return!1;return!0}function Bm(s,n){for(let o=0;o<n.length;o++)if(Rd(s,n[o]))return!0;return!1}function yu(s,n,o){const h=[];for(let g=0;g<s.length;g++){const y=[];for(let v=0;v<s[g].length;v++){const S=kd(s[g][v],o);Oo(n,S),y.push(S)}h.push(y)}return h}function vu(s,n,o){const h=[];for(let g=0;g<s.length;g++){const y=yu(s[g],n,o);h.push(y)}return h}function xu(s,n,o,h){if(s[0]<o[0]||s[0]>o[2]){const g=.5*h;let y=s[0]-o[0]>g?-h:o[0]-s[0]>g?h:0;y===0&&(y=s[0]-o[2]>g?-h:o[2]-s[0]>g?h:0),s[0]+=y}Oo(n,s)}function Md(s,n,o,h){const g=Math.pow(2,h.z)*Ks,y=[h.x*Ks,h.y*Ks],v=[];for(const S of s)for(const T of S){const R=[T.x+y[0],T.y+y[1]];xu(R,n,o,g),v.push(R)}return v}function Dd(s,n,o,h){const g=Math.pow(2,h.z)*Ks,y=[h.x*Ks,h.y*Ks],v=[];for(const T of s){const R=[];for(const D of T){const B=[D.x+y[0],D.y+y[1]];Oo(n,B),R.push(B)}v.push(R)}if(n[2]-n[0]<=g/2){(S=n)[0]=S[1]=1/0,S[2]=S[3]=-1/0;for(const T of v)for(const R of T)xu(R,n,o,g)}var S;return v}class Ps{constructor(n,o){this.type=qt,this.geojson=n,this.geometries=o}static parse(n,o){if(n.length!==2)return o.error(`'within' expression requires exactly one argument, but found ${n.length-1} instead.`);if(Tl(n[1])){const h=n[1];if(h.type==="FeatureCollection")for(let g=0;g<h.features.length;++g){const y=h.features[g].geometry.type;if(y==="Polygon"||y==="MultiPolygon")return new Ps(h,h.features[g].geometry)}else if(h.type==="Feature"){const g=h.geometry.type;if(g==="Polygon"||g==="MultiPolygon")return new Ps(h,h.geometry)}else if(h.type==="Polygon"||h.type==="MultiPolygon")return new Ps(h,h)}return o.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(n){if(n.geometry()!=null&&n.canonicalID()!=null){if(n.geometryType()==="Point")return function(o,h){const g=[1/0,1/0,-1/0,-1/0],y=[1/0,1/0,-1/0,-1/0],v=o.canonicalID();if(h.type==="Polygon"){const S=yu(h.coordinates,y,v),T=Md(o.geometry(),g,y,v);if(!kl(g,y))return!1;for(const R of T)if(!gu(R,S))return!1}if(h.type==="MultiPolygon"){const S=vu(h.coordinates,y,v),T=Md(o.geometry(),g,y,v);if(!kl(g,y))return!1;for(const R of T)if(!Pd(R,S))return!1}return!0}(n,this.geometries);if(n.geometryType()==="LineString")return function(o,h){const g=[1/0,1/0,-1/0,-1/0],y=[1/0,1/0,-1/0,-1/0],v=o.canonicalID();if(h.type==="Polygon"){const S=yu(h.coordinates,y,v),T=Dd(o.geometry(),g,y,v);if(!kl(g,y))return!1;for(const R of T)if(!Rd(R,S))return!1}if(h.type==="MultiPolygon"){const S=vu(h.coordinates,y,v),T=Dd(o.geometry(),g,y,v);if(!kl(g,y))return!1;for(const R of T)if(!Bm(R,S))return!1}return!0}(n,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}class Al{constructor(n,o){this.type=o.type,this.name=n,this.boundExpression=o}static parse(n,o){if(n.length!==2||typeof n[1]!="string")return o.error("'var' expression requires exactly one string literal argument.");const h=n[1];return o.scope.has(h)?new Al(h,o.scope.get(h)):o.error(`Unknown variable "${h}". Make sure "${h}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(n){return this.boundExpression.evaluate(n)}eachChild(){}outputDefined(){return!1}}class Ur{constructor(n,o,h,g){this.name=n,this.type=o,this._evaluate=h,this.args=g}evaluate(n){return this._evaluate(n,this.args)}eachChild(n){this.args.forEach(n)}outputDefined(){return!1}static parse(n,o){const h=n[0],g=Ur.definitions[h];if(!g)return o.error(`Unknown expression "${h}". If you wanted a literal array, use ["literal", [...]].`,0);const y=Array.isArray(g)?g[0]:g.type,v=Array.isArray(g)?[[g[1],g[2]]]:g.overloads,S=v.filter(([R])=>!Array.isArray(R)||R.length===n.length-1);let T=null;for(const[R,D]of S){T=new Xs(o.registry,Pl,o.path,null,o.scope);const B=[];let N=!1;for(let V=1;V<n.length;V++){const q=n[V],te=Array.isArray(R)?R[V-1]:R.type,Q=T.parse(q,1+B.length,te);if(!Q){N=!0;break}B.push(Q)}if(!N)if(Array.isArray(R)&&R.length!==B.length)T.error(`Expected ${R.length} arguments, but found ${B.length} instead.`);else{for(let V=0;V<B.length;V++){const q=Array.isArray(R)?R[V]:R.type,te=B[V];T.concat(V+1).checkSubtype(q,te.type)}if(T.errors.length===0)return new Ur(h,y,D,B)}}if(S.length===1)o.errors.push(...T.errors);else{const R=(S.length?S:v).map(([B])=>{return N=B,Array.isArray(N)?`(${N.map(Un).join(", ")})`:`(${Un(N.type)}...)`;var N}).join(" | "),D=[];for(let B=1;B<n.length;B++){const N=o.parse(n[B],1+D.length);if(!N)return null;D.push(Un(N.type))}o.error(`Expected arguments of type ${R}, but found (${D.join(", ")}) instead.`)}return null}static register(n,o){Ur.definitions=o;for(const h in o)n[h]=Ur}}function Pl(s){if(s instanceof Al)return Pl(s.boundExpression);if(s instanceof Ur&&s.name==="error"||s instanceof In||s instanceof Ps)return!1;const n=s instanceof Fi||s instanceof Jr;let o=!0;return s.eachChild(h=>{o=n?o&&Pl(h):o&&h instanceof Ys}),!!o&&Bo(s)&&Rl(s,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}function Bo(s){if(s instanceof Ur&&(s.name==="get"&&s.args.length===1||s.name==="feature-state"||s.name==="has"&&s.args.length===1||s.name==="properties"||s.name==="geometry-type"||s.name==="id"||/^filter-/.test(s.name))||s instanceof Ps)return!1;let n=!0;return s.eachChild(o=>{n&&!Bo(o)&&(n=!1)}),n}function Ga(s){if(s instanceof Ur&&s.name==="feature-state")return!1;let n=!0;return s.eachChild(o=>{n&&!Ga(o)&&(n=!1)}),n}function Rl(s,n){if(s instanceof Ur&&n.indexOf(s.name)>=0)return!1;let o=!0;return s.eachChild(h=>{o&&!Rl(h,n)&&(o=!1)}),o}function Ml(s,n){const o=s.length-1;let h,g,y=0,v=o,S=0;for(;y<=v;)if(S=Math.floor((y+v)/2),h=s[S],g=s[S+1],h<=n){if(S===o||n<g)return S;y=S+1}else{if(!(h>n))throw new ui("Input is not a number.");v=S-1}return 0}class qa{constructor(n,o,h){this.type=n,this.input=o,this.labels=[],this.outputs=[];for(const[g,y]of h)this.labels.push(g),this.outputs.push(y)}static parse(n,o){if(n.length-1<4)return o.error(`Expected at least 4 arguments, but found only ${n.length-1}.`);if((n.length-1)%2!=0)return o.error("Expected an even number of arguments.");const h=o.parse(n[1],1,at);if(!h)return null;const g=[];let y=null;o.expectedType&&o.expectedType.kind!=="value"&&(y=o.expectedType);for(let v=1;v<n.length;v+=2){const S=v===1?-1/0:n[v],T=n[v+1],R=v,D=v+1;if(typeof S!="number")return o.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',R);if(g.length&&g[g.length-1][0]>=S)return o.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',R);const B=o.parse(T,D,y);if(!B)return null;y=y||B.type,g.push([S,B])}return new qa(y,h,g)}evaluate(n){const o=this.labels,h=this.outputs;if(o.length===1)return h[0].evaluate(n);const g=this.input.evaluate(n);if(g<=o[0])return h[0].evaluate(n);const y=o.length;return g>=o[y-1]?h[y-1].evaluate(n):h[Ml(o,g)].evaluate(n)}eachChild(n){n(this.input);for(const o of this.outputs)n(o)}outputDefined(){return this.outputs.every(n=>n.outputDefined())}}function Ha(s,n,o){return s+o*(n-s)}function Dl(s,n,o){return s.map((h,g)=>Ha(h,n[g],o))}const xr={number:Ha,color:function(s,n,o,h="rgb"){switch(h){case"rgb":{const[g,y,v,S]=Dl(s.rgb,n.rgb,o);return new Yt(g,y,v,S,!1)}case"hcl":{const[g,y,v,S]=s.hcl,[T,R,D,B]=n.hcl;let N,V;if(isNaN(g)||isNaN(T))isNaN(g)?isNaN(T)?N=NaN:(N=T,v!==1&&v!==0||(V=R)):(N=g,D!==1&&D!==0||(V=y));else{let Ee=T-g;T>g&&Ee>180?Ee-=360:T<g&&g-T>180&&(Ee+=360),N=g+o*Ee}const[q,te,Q,_e]=function([Ee,pe,Re,ze]){return Ee=isNaN(Ee)?0:Ee*Te,Pt([Re,Math.cos(Ee)*pe,Math.sin(Ee)*pe,ze])}([N,V??Ha(y,R,o),Ha(v,D,o),Ha(S,B,o)]);return new Yt(q,te,Q,_e,!1)}case"lab":{const[g,y,v,S]=Pt(Dl(s.lab,n.lab,o));return new Yt(g,y,v,S,!1)}}},array:Dl,padding:function(s,n,o){return new vr(Dl(s.values,n.values,o))}};class br{constructor(n,o,h,g,y){this.type=n,this.operator=o,this.interpolation=h,this.input=g,this.labels=[],this.outputs=[];for(const[v,S]of y)this.labels.push(v),this.outputs.push(S)}static interpolationFactor(n,o,h,g){let y=0;if(n.name==="exponential")y=bu(o,n.base,h,g);else if(n.name==="linear")y=bu(o,1,h,g);else if(n.name==="cubic-bezier"){const v=n.controlPoints;y=new j(v[0],v[1],v[2],v[3]).solve(bu(o,1,h,g))}return y}static parse(n,o){let[h,g,y,...v]=n;if(!Array.isArray(g)||g.length===0)return o.error("Expected an interpolation type expression.",1);if(g[0]==="linear")g={name:"linear"};else if(g[0]==="exponential"){const R=g[1];if(typeof R!="number")return o.error("Exponential interpolation requires a numeric base.",1,1);g={name:"exponential",base:R}}else{if(g[0]!=="cubic-bezier")return o.error(`Unknown interpolation type ${String(g[0])}`,1,0);{const R=g.slice(1);if(R.length!==4||R.some(D=>typeof D!="number"||D<0||D>1))return o.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);g={name:"cubic-bezier",controlPoints:R}}}if(n.length-1<4)return o.error(`Expected at least 4 arguments, but found only ${n.length-1}.`);if((n.length-1)%2!=0)return o.error("Expected an even number of arguments.");if(y=o.parse(y,2,at),!y)return null;const S=[];let T=null;h==="interpolate-hcl"||h==="interpolate-lab"?T=Dn:o.expectedType&&o.expectedType.kind!=="value"&&(T=o.expectedType);for(let R=0;R<v.length;R+=2){const D=v[R],B=v[R+1],N=R+3,V=R+4;if(typeof D!="number")return o.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',N);if(S.length&&S[S.length-1][0]>=D)return o.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',N);const q=o.parse(B,V,T);if(!q)return null;T=T||q.type,S.push([D,q])}return $(T,at)||$(T,Dn)||$(T,Kr)||$(T,Oi(at))?new br(T,h,g,y,S):o.error(`Type ${Un(T)} is not interpolatable.`)}evaluate(n){const o=this.labels,h=this.outputs;if(o.length===1)return h[0].evaluate(n);const g=this.input.evaluate(n);if(g<=o[0])return h[0].evaluate(n);const y=o.length;if(g>=o[y-1])return h[y-1].evaluate(n);const v=Ml(o,g),S=br.interpolationFactor(this.interpolation,g,o[v],o[v+1]),T=h[v].evaluate(n),R=h[v+1].evaluate(n);switch(this.operator){case"interpolate":return xr[this.type.kind](T,R,S);case"interpolate-hcl":return xr.color(T,R,S,"hcl");case"interpolate-lab":return xr.color(T,R,S,"lab")}}eachChild(n){n(this.input);for(const o of this.outputs)n(o)}outputDefined(){return this.outputs.every(n=>n.outputDefined())}}function bu(s,n,o,h){const g=h-o,y=s-o;return g===0?0:n===1?y/g:(Math.pow(n,y)-1)/(Math.pow(n,g)-1)}class Ll{constructor(n,o){this.type=n,this.args=o}static parse(n,o){if(n.length<2)return o.error("Expectected at least one argument.");let h=null;const g=o.expectedType;g&&g.kind!=="value"&&(h=g);const y=[];for(const S of n.slice(1)){const T=o.parse(S,1+y.length,h,void 0,{typeAnnotation:"omit"});if(!T)return null;h=h||T.type,y.push(T)}if(!h)throw new Error("No output type");const v=g&&y.some(S=>ds(g,S.type));return new Ll(v?Ot:h,y)}evaluate(n){let o,h=null,g=0;for(const y of this.args)if(g++,h=y.evaluate(n),h&&h instanceof Nr&&!h.available&&(o||(o=h.name),h=null,g===this.args.length&&(h=o)),h!==null)break;return h}eachChild(n){this.args.forEach(n)}outputDefined(){return this.args.every(n=>n.outputDefined())}}class zl{constructor(n,o){this.type=o.type,this.bindings=[].concat(n),this.result=o}evaluate(n){return this.result.evaluate(n)}eachChild(n){for(const o of this.bindings)n(o[1]);n(this.result)}static parse(n,o){if(n.length<4)return o.error(`Expected at least 3 arguments, but found ${n.length-1} instead.`);const h=[];for(let y=1;y<n.length-1;y+=2){const v=n[y];if(typeof v!="string")return o.error(`Expected string, but found ${typeof v} instead.`,y);if(/[^a-zA-Z0-9_]/.test(v))return o.error("Variable names must contain only alphanumeric characters or '_'.",y);const S=o.parse(n[y+1],y+1);if(!S)return null;h.push([v,S])}const g=o.parse(n[n.length-1],n.length-1,o.expectedType,h);return g?new zl(h,g):null}outputDefined(){return this.result.outputDefined()}}class wu{constructor(n,o,h){this.type=n,this.index=o,this.input=h}static parse(n,o){if(n.length!==3)return o.error(`Expected 2 arguments, but found ${n.length-1} instead.`);const h=o.parse(n[1],1,at),g=o.parse(n[2],2,Oi(o.expectedType||Ot));return h&&g?new wu(g.type.itemType,h,g):null}evaluate(n){const o=this.index.evaluate(n),h=this.input.evaluate(n);if(o<0)throw new ui(`Array index out of bounds: ${o} < 0.`);if(o>=h.length)throw new ui(`Array index out of bounds: ${o} > ${h.length-1}.`);if(o!==Math.floor(o))throw new ui(`Array index must be an integer, but found ${o} instead.`);return h[o]}eachChild(n){n(this.index),n(this.input)}outputDefined(){return!1}}class Fo{constructor(n,o){this.type=qt,this.needle=n,this.haystack=o}static parse(n,o){if(n.length!==3)return o.error(`Expected 2 arguments, but found ${n.length-1} instead.`);const h=o.parse(n[1],1,Ot),g=o.parse(n[2],2,Ot);return h&&g?ne(h.type,[qt,jt,at,zn,Ot])?new Fo(h,g):o.error(`Expected first argument to be of type boolean, string, number or null, but found ${Un(h.type)} instead`):null}evaluate(n){const o=this.needle.evaluate(n),h=this.haystack.evaluate(n);if(!h)return!1;if(!F(o,["boolean","string","number","null"]))throw new ui(`Expected first argument to be of type boolean, string, number or null, but found ${Un(_i(o))} instead.`);if(!F(h,["string","array"]))throw new ui(`Expected second argument to be of type array or string, but found ${Un(_i(h))} instead.`);return h.indexOf(o)>=0}eachChild(n){n(this.needle),n(this.haystack)}outputDefined(){return!0}}class ga{constructor(n,o,h){this.type=at,this.needle=n,this.haystack=o,this.fromIndex=h}static parse(n,o){if(n.length<=2||n.length>=5)return o.error(`Expected 3 or 4 arguments, but found ${n.length-1} instead.`);const h=o.parse(n[1],1,Ot),g=o.parse(n[2],2,Ot);if(!h||!g)return null;if(!ne(h.type,[qt,jt,at,zn,Ot]))return o.error(`Expected first argument to be of type boolean, string, number or null, but found ${Un(h.type)} instead`);if(n.length===4){const y=o.parse(n[3],3,at);return y?new ga(h,g,y):null}return new ga(h,g)}evaluate(n){const o=this.needle.evaluate(n),h=this.haystack.evaluate(n);if(!F(o,["boolean","string","number","null"]))throw new ui(`Expected first argument to be of type boolean, string, number or null, but found ${Un(_i(o))} instead.`);if(!F(h,["string","array"]))throw new ui(`Expected second argument to be of type array or string, but found ${Un(_i(h))} instead.`);if(this.fromIndex){const g=this.fromIndex.evaluate(n);return h.indexOf(o,g)}return h.indexOf(o)}eachChild(n){n(this.needle),n(this.haystack),this.fromIndex&&n(this.fromIndex)}outputDefined(){return!1}}class vn{constructor(n,o,h,g,y,v){this.inputType=n,this.type=o,this.input=h,this.cases=g,this.outputs=y,this.otherwise=v}static parse(n,o){if(n.length<5)return o.error(`Expected at least 4 arguments, but found only ${n.length-1}.`);if(n.length%2!=1)return o.error("Expected an even number of arguments.");let h,g;o.expectedType&&o.expectedType.kind!=="value"&&(g=o.expectedType);const y={},v=[];for(let R=2;R<n.length-1;R+=2){let D=n[R];const B=n[R+1];Array.isArray(D)||(D=[D]);const N=o.concat(R);if(D.length===0)return N.error("Expected at least one branch label.");for(const q of D){if(typeof q!="number"&&typeof q!="string")return N.error("Branch labels must be numbers or strings.");if(typeof q=="number"&&Math.abs(q)>Number.MAX_SAFE_INTEGER)return N.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof q=="number"&&Math.floor(q)!==q)return N.error("Numeric branch labels must be integer values.");if(h){if(N.checkSubtype(h,_i(q)))return null}else h=_i(q);if(y[String(q)]!==void 0)return N.error("Branch labels must be unique.");y[String(q)]=v.length}const V=o.parse(B,R,g);if(!V)return null;g=g||V.type,v.push(V)}const S=o.parse(n[1],1,Ot);if(!S)return null;const T=o.parse(n[n.length-1],n.length-1,g);return T?S.type.kind!=="value"&&o.concat(1).checkSubtype(h,S.type)?null:new vn(h,g,S,y,v,T):null}evaluate(n){const o=this.input.evaluate(n);return(_i(o)===this.inputType&&this.outputs[this.cases[o]]||this.otherwise).evaluate(n)}eachChild(n){n(this.input),this.outputs.forEach(n),n(this.otherwise)}outputDefined(){return this.outputs.every(n=>n.outputDefined())&&this.otherwise.outputDefined()}}class Su{constructor(n,o,h){this.type=n,this.branches=o,this.otherwise=h}static parse(n,o){if(n.length<4)return o.error(`Expected at least 3 arguments, but found only ${n.length-1}.`);if(n.length%2!=0)return o.error("Expected an odd number of arguments.");let h;o.expectedType&&o.expectedType.kind!=="value"&&(h=o.expectedType);const g=[];for(let v=1;v<n.length-1;v+=2){const S=o.parse(n[v],v,qt);if(!S)return null;const T=o.parse(n[v+1],v+1,h);if(!T)return null;g.push([S,T]),h=h||T.type}const y=o.parse(n[n.length-1],n.length-1,h);if(!y)return null;if(!h)throw new Error("Can't infer output type");return new Su(h,g,y)}evaluate(n){for(const[o,h]of this.branches)if(o.evaluate(n))return h.evaluate(n);return this.otherwise.evaluate(n)}eachChild(n){for(const[o,h]of this.branches)n(o),n(h);n(this.otherwise)}outputDefined(){return this.branches.every(([n,o])=>o.outputDefined())&&this.otherwise.outputDefined()}}class Ol{constructor(n,o,h,g){this.type=n,this.input=o,this.beginIndex=h,this.endIndex=g}static parse(n,o){if(n.length<=2||n.length>=5)return o.error(`Expected 3 or 4 arguments, but found ${n.length-1} instead.`);const h=o.parse(n[1],1,Ot),g=o.parse(n[2],2,at);if(!h||!g)return null;if(!ne(h.type,[Oi(Ot),jt,Ot]))return o.error(`Expected first argument to be of type array or string, but found ${Un(h.type)} instead`);if(n.length===4){const y=o.parse(n[3],3,at);return y?new Ol(h.type,h,g,y):null}return new Ol(h.type,h,g)}evaluate(n){const o=this.input.evaluate(n),h=this.beginIndex.evaluate(n);if(!F(o,["string","array"]))throw new ui(`Expected first argument to be of type array or string, but found ${Un(_i(o))} instead.`);if(this.endIndex){const g=this.endIndex.evaluate(n);return o.slice(h,g)}return o.slice(h)}eachChild(n){n(this.input),n(this.beginIndex),this.endIndex&&n(this.endIndex)}outputDefined(){return!1}}function Ld(s,n){return s==="=="||s==="!="?n.kind==="boolean"||n.kind==="string"||n.kind==="number"||n.kind==="null"||n.kind==="value":n.kind==="string"||n.kind==="number"||n.kind==="value"}function zd(s,n,o,h){return h.compare(n,o)===0}function Wa(s,n,o){const h=s!=="=="&&s!=="!=";return class wE{constructor(y,v,S){this.type=qt,this.lhs=y,this.rhs=v,this.collator=S,this.hasUntypedArgument=y.type.kind==="value"||v.type.kind==="value"}static parse(y,v){if(y.length!==3&&y.length!==4)return v.error("Expected two or three arguments.");const S=y[0];let T=v.parse(y[1],1,Ot);if(!T)return null;if(!Ld(S,T.type))return v.concat(1).error(`"${S}" comparisons are not supported for type '${Un(T.type)}'.`);let R=v.parse(y[2],2,Ot);if(!R)return null;if(!Ld(S,R.type))return v.concat(2).error(`"${S}" comparisons are not supported for type '${Un(R.type)}'.`);if(T.type.kind!==R.type.kind&&T.type.kind!=="value"&&R.type.kind!=="value")return v.error(`Cannot compare types '${Un(T.type)}' and '${Un(R.type)}'.`);h&&(T.type.kind==="value"&&R.type.kind!=="value"?T=new Jr(R.type,[T]):T.type.kind!=="value"&&R.type.kind==="value"&&(R=new Jr(T.type,[R])));let D=null;if(y.length===4){if(T.type.kind!=="string"&&R.type.kind!=="string"&&T.type.kind!=="value"&&R.type.kind!=="value")return v.error("Cannot use collator to compare non-string types.");if(D=v.parse(y[3],3,Fr),!D)return null}return new wE(T,R,D)}evaluate(y){const v=this.lhs.evaluate(y),S=this.rhs.evaluate(y);if(h&&this.hasUntypedArgument){const T=_i(v),R=_i(S);if(T.kind!==R.kind||T.kind!=="string"&&T.kind!=="number")throw new ui(`Expected arguments for "${s}" to be (string, string) or (number, number), but found (${T.kind}, ${R.kind}) instead.`)}if(this.collator&&!h&&this.hasUntypedArgument){const T=_i(v),R=_i(S);if(T.kind!=="string"||R.kind!=="string")return n(y,v,S)}return this.collator?o(y,v,S,this.collator.evaluate(y)):n(y,v,S)}eachChild(y){y(this.lhs),y(this.rhs),this.collator&&y(this.collator)}outputDefined(){return!0}}}const Fm=Wa("==",function(s,n,o){return n===o},zd),Nm=Wa("!=",function(s,n,o){return n!==o},function(s,n,o,h){return!zd(0,n,o,h)}),Um=Wa("<",function(s,n,o){return n<o},function(s,n,o,h){return h.compare(n,o)<0}),$m=Wa(">",function(s,n,o){return n>o},function(s,n,o,h){return h.compare(n,o)>0}),Vm=Wa("<=",function(s,n,o){return n<=o},function(s,n,o,h){return h.compare(n,o)<=0}),jm=Wa(">=",function(s,n,o){return n>=o},function(s,n,o,h){return h.compare(n,o)>=0});class Eu{constructor(n,o,h,g,y){this.type=jt,this.number=n,this.locale=o,this.currency=h,this.minFractionDigits=g,this.maxFractionDigits=y}static parse(n,o){if(n.length!==3)return o.error("Expected two arguments.");const h=o.parse(n[1],1,at);if(!h)return null;const g=n[2];if(typeof g!="object"||Array.isArray(g))return o.error("NumberFormat options argument must be an object.");let y=null;if(g.locale&&(y=o.parse(g.locale,1,jt),!y))return null;let v=null;if(g.currency&&(v=o.parse(g.currency,1,jt),!v))return null;let S=null;if(g["min-fraction-digits"]&&(S=o.parse(g["min-fraction-digits"],1,at),!S))return null;let T=null;return g["max-fraction-digits"]&&(T=o.parse(g["max-fraction-digits"],1,at),!T)?null:new Eu(h,y,v,S,T)}evaluate(n){return new Intl.NumberFormat(this.locale?this.locale.evaluate(n):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(n):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(n):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(n):void 0}).format(this.number.evaluate(n))}eachChild(n){n(this.number),this.locale&&n(this.locale),this.currency&&n(this.currency),this.minFractionDigits&&n(this.minFractionDigits),this.maxFractionDigits&&n(this.maxFractionDigits)}outputDefined(){return!1}}class Bl{constructor(n){this.type=ks,this.sections=n}static parse(n,o){if(n.length<2)return o.error("Expected at least one argument.");const h=n[1];if(!Array.isArray(h)&&typeof h=="object")return o.error("First argument must be an image or text section.");const g=[];let y=!1;for(let v=1;v<=n.length-1;++v){const S=n[v];if(y&&typeof S=="object"&&!Array.isArray(S)){y=!1;let T=null;if(S["font-scale"]&&(T=o.parse(S["font-scale"],1,at),!T))return null;let R=null;if(S["text-font"]&&(R=o.parse(S["text-font"],1,Oi(jt)),!R))return null;let D=null;if(S["text-color"]&&(D=o.parse(S["text-color"],1,Dn),!D))return null;const B=g[g.length-1];B.scale=T,B.font=R,B.textColor=D}else{const T=o.parse(n[v],1,Ot);if(!T)return null;const R=T.type.kind;if(R!=="string"&&R!=="value"&&R!=="null"&&R!=="resolvedImage")return o.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");y=!0,g.push({content:T,scale:null,font:null,textColor:null})}}return new Bl(g)}evaluate(n){return new Bi(this.sections.map(o=>{const h=o.content.evaluate(n);return _i(h)===As?new Zs("",h,null,null,null):new Zs(zo(h),null,o.scale?o.scale.evaluate(n):null,o.font?o.font.evaluate(n).join(","):null,o.textColor?o.textColor.evaluate(n):null)}))}eachChild(n){for(const o of this.sections)n(o.content),o.scale&&n(o.scale),o.font&&n(o.font),o.textColor&&n(o.textColor)}outputDefined(){return!1}}class Tu{constructor(n){this.type=As,this.input=n}static parse(n,o){if(n.length!==2)return o.error("Expected two arguments.");const h=o.parse(n[1],1,jt);return h?new Tu(h):o.error("No image name provided.")}evaluate(n){const o=this.input.evaluate(n),h=Nr.fromString(o);return h&&n.availableImages&&(h.available=n.availableImages.indexOf(o)>-1),h}eachChild(n){n(this.input)}outputDefined(){return!1}}class Cu{constructor(n){this.type=at,this.input=n}static parse(n,o){if(n.length!==2)return o.error(`Expected 1 argument, but found ${n.length-1} instead.`);const h=o.parse(n[1],1);return h?h.type.kind!=="array"&&h.type.kind!=="string"&&h.type.kind!=="value"?o.error(`Expected argument of type string or array, but found ${Un(h.type)} instead.`):new Cu(h):null}evaluate(n){const o=this.input.evaluate(n);if(typeof o=="string"||Array.isArray(o))return o.length;throw new ui(`Expected value to be of type string or array, but found ${Un(_i(o))} instead.`)}eachChild(n){n(this.input)}outputDefined(){return!1}}const Za={"==":Fm,"!=":Nm,">":$m,"<":Um,">=":jm,"<=":Vm,array:Jr,at:wu,boolean:Jr,case:Su,coalesce:Ll,collator:In,format:Bl,image:Tu,in:Fo,"index-of":ga,interpolate:br,"interpolate-hcl":br,"interpolate-lab":br,length:Cu,let:zl,literal:Ys,match:vn,number:Jr,"number-format":Eu,object:Jr,slice:Ol,step:qa,string:Jr,"to-boolean":Fi,"to-color":Fi,"to-number":Fi,"to-string":Fi,var:Al,within:Ps};function Od(s,[n,o,h,g]){n=n.evaluate(s),o=o.evaluate(s),h=h.evaluate(s);const y=g?g.evaluate(s):1,v=ja(n,o,h,y);if(v)throw new ui(v);return new Yt(n/255,o/255,h/255,y,!1)}function Bd(s,n){return s in n}function Iu(s,n){const o=n[s];return o===void 0?null:o}function _a(s){return{type:s}}function Fd(s){return{result:"success",value:s}}function Ya(s){return{result:"error",value:s}}function Xa(s){return s["property-type"]==="data-driven"||s["property-type"]==="cross-faded-data-driven"}function Nd(s){return!!s.expression&&s.expression.parameters.indexOf("zoom")>-1}function ku(s){return!!s.expression&&s.expression.interpolated}function Rn(s){return s instanceof Number?"number":s instanceof String?"string":s instanceof Boolean?"boolean":Array.isArray(s)?"array":s===null?"null":typeof s}function Fl(s){return typeof s=="object"&&s!==null&&!Array.isArray(s)}function Gm(s){return s}function Ud(s,n){const o=n.type==="color",h=s.stops&&typeof s.stops[0][0]=="object",g=h||!(h||s.property!==void 0),y=s.type||(ku(n)?"exponential":"interval");if(o||n.type==="padding"){const D=o?Yt.parse:vr.parse;(s=tn({},s)).stops&&(s.stops=s.stops.map(B=>[B[0],D(B[1])])),s.default=D(s.default?s.default:n.default)}if(s.colorSpace&&(v=s.colorSpace)!=="rgb"&&v!=="hcl"&&v!=="lab")throw new Error(`Unknown color space: "${s.colorSpace}"`);var v;let S,T,R;if(y==="exponential")S=$d;else if(y==="interval")S=Au;else if(y==="categorical"){S=qm,T=Object.create(null);for(const D of s.stops)T[D[0]]=D[1];R=typeof s.stops[0][0]}else{if(y!=="identity")throw new Error(`Unknown function type "${y}"`);S=Hm}if(h){const D={},B=[];for(let q=0;q<s.stops.length;q++){const te=s.stops[q],Q=te[0].zoom;D[Q]===void 0&&(D[Q]={zoom:Q,type:s.type,property:s.property,default:s.default,stops:[]},B.push(Q)),D[Q].stops.push([te[0].value,te[1]])}const N=[];for(const q of B)N.push([D[q].zoom,Ud(D[q],n)]);const V={name:"linear"};return{kind:"composite",interpolationType:V,interpolationFactor:br.interpolationFactor.bind(void 0,V),zoomStops:N.map(q=>q[0]),evaluate:({zoom:q},te)=>$d({stops:N,base:s.base},n,q).evaluate(q,te)}}if(g){const D=y==="exponential"?{name:"exponential",base:s.base!==void 0?s.base:1}:null;return{kind:"camera",interpolationType:D,interpolationFactor:br.interpolationFactor.bind(void 0,D),zoomStops:s.stops.map(B=>B[0]),evaluate:({zoom:B})=>S(s,n,B,T,R)}}return{kind:"source",evaluate(D,B){const N=B&&B.properties?B.properties[s.property]:void 0;return N===void 0?No(s.default,n.default):S(s,n,N,T,R)}}}function No(s,n,o){return s!==void 0?s:n!==void 0?n:o!==void 0?o:void 0}function qm(s,n,o,h,g){return No(typeof o===g?h[o]:void 0,s.default,n.default)}function Au(s,n,o){if(Rn(o)!=="number")return No(s.default,n.default);const h=s.stops.length;if(h===1||o<=s.stops[0][0])return s.stops[0][1];if(o>=s.stops[h-1][0])return s.stops[h-1][1];const g=Ml(s.stops.map(y=>y[0]),o);return s.stops[g][1]}function $d(s,n,o){const h=s.base!==void 0?s.base:1;if(Rn(o)!=="number")return No(s.default,n.default);const g=s.stops.length;if(g===1||o<=s.stops[0][0])return s.stops[0][1];if(o>=s.stops[g-1][0])return s.stops[g-1][1];const y=Ml(s.stops.map(D=>D[0]),o),v=function(D,B,N,V){const q=V-N,te=D-N;return q===0?0:B===1?te/q:(Math.pow(B,te)-1)/(Math.pow(B,q)-1)}(o,h,s.stops[y][0],s.stops[y+1][0]),S=s.stops[y][1],T=s.stops[y+1][1],R=xr[n.type]||Gm;return typeof S.evaluate=="function"?{evaluate(...D){const B=S.evaluate.apply(void 0,D),N=T.evaluate.apply(void 0,D);if(B!==void 0&&N!==void 0)return R(B,N,v,s.colorSpace)}}:R(S,T,v,s.colorSpace)}function Hm(s,n,o){switch(n.type){case"color":o=Yt.parse(o);break;case"formatted":o=Bi.fromString(o.toString());break;case"resolvedImage":o=Nr.fromString(o.toString());break;case"padding":o=vr.parse(o);break;default:Rn(o)===n.type||n.type==="enum"&&n.values[o]||(o=void 0)}return No(o,s.default,n.default)}Ur.register(Za,{error:[{kind:"error"},[jt],(s,[n])=>{throw new ui(n.evaluate(s))}],typeof:[jt,[Ot],(s,[n])=>Un(_i(n.evaluate(s)))],"to-rgba":[Oi(at,4),[Dn],(s,[n])=>{const[o,h,g,y]=n.evaluate(s).rgb;return[255*o,255*h,255*g,y]}],rgb:[Dn,[at,at,at],Od],rgba:[Dn,[at,at,at,at],Od],has:{type:qt,overloads:[[[jt],(s,[n])=>Bd(n.evaluate(s),s.properties())],[[jt,fn],(s,[n,o])=>Bd(n.evaluate(s),o.evaluate(s))]]},get:{type:Ot,overloads:[[[jt],(s,[n])=>Iu(n.evaluate(s),s.properties())],[[jt,fn],(s,[n,o])=>Iu(n.evaluate(s),o.evaluate(s))]]},"feature-state":[Ot,[jt],(s,[n])=>Iu(n.evaluate(s),s.featureState||{})],properties:[fn,[],s=>s.properties()],"geometry-type":[jt,[],s=>s.geometryType()],id:[Ot,[],s=>s.id()],zoom:[at,[],s=>s.globals.zoom],"heatmap-density":[at,[],s=>s.globals.heatmapDensity||0],"line-progress":[at,[],s=>s.globals.lineProgress||0],accumulated:[Ot,[],s=>s.globals.accumulated===void 0?null:s.globals.accumulated],"+":[at,_a(at),(s,n)=>{let o=0;for(const h of n)o+=h.evaluate(s);return o}],"*":[at,_a(at),(s,n)=>{let o=1;for(const h of n)o*=h.evaluate(s);return o}],"-":{type:at,overloads:[[[at,at],(s,[n,o])=>n.evaluate(s)-o.evaluate(s)],[[at],(s,[n])=>-n.evaluate(s)]]},"/":[at,[at,at],(s,[n,o])=>n.evaluate(s)/o.evaluate(s)],"%":[at,[at,at],(s,[n,o])=>n.evaluate(s)%o.evaluate(s)],ln2:[at,[],()=>Math.LN2],pi:[at,[],()=>Math.PI],e:[at,[],()=>Math.E],"^":[at,[at,at],(s,[n,o])=>Math.pow(n.evaluate(s),o.evaluate(s))],sqrt:[at,[at],(s,[n])=>Math.sqrt(n.evaluate(s))],log10:[at,[at],(s,[n])=>Math.log(n.evaluate(s))/Math.LN10],ln:[at,[at],(s,[n])=>Math.log(n.evaluate(s))],log2:[at,[at],(s,[n])=>Math.log(n.evaluate(s))/Math.LN2],sin:[at,[at],(s,[n])=>Math.sin(n.evaluate(s))],cos:[at,[at],(s,[n])=>Math.cos(n.evaluate(s))],tan:[at,[at],(s,[n])=>Math.tan(n.evaluate(s))],asin:[at,[at],(s,[n])=>Math.asin(n.evaluate(s))],acos:[at,[at],(s,[n])=>Math.acos(n.evaluate(s))],atan:[at,[at],(s,[n])=>Math.atan(n.evaluate(s))],min:[at,_a(at),(s,n)=>Math.min(...n.map(o=>o.evaluate(s)))],max:[at,_a(at),(s,n)=>Math.max(...n.map(o=>o.evaluate(s)))],abs:[at,[at],(s,[n])=>Math.abs(n.evaluate(s))],round:[at,[at],(s,[n])=>{const o=n.evaluate(s);return o<0?-Math.round(-o):Math.round(o)}],floor:[at,[at],(s,[n])=>Math.floor(n.evaluate(s))],ceil:[at,[at],(s,[n])=>Math.ceil(n.evaluate(s))],"filter-==":[qt,[jt,Ot],(s,[n,o])=>s.properties()[n.value]===o.value],"filter-id-==":[qt,[Ot],(s,[n])=>s.id()===n.value],"filter-type-==":[qt,[jt],(s,[n])=>s.geometryType()===n.value],"filter-<":[qt,[jt,Ot],(s,[n,o])=>{const h=s.properties()[n.value],g=o.value;return typeof h==typeof g&&h<g}],"filter-id-<":[qt,[Ot],(s,[n])=>{const o=s.id(),h=n.value;return typeof o==typeof h&&o<h}],"filter->":[qt,[jt,Ot],(s,[n,o])=>{const h=s.properties()[n.value],g=o.value;return typeof h==typeof g&&h>g}],"filter-id->":[qt,[Ot],(s,[n])=>{const o=s.id(),h=n.value;return typeof o==typeof h&&o>h}],"filter-<=":[qt,[jt,Ot],(s,[n,o])=>{const h=s.properties()[n.value],g=o.value;return typeof h==typeof g&&h<=g}],"filter-id-<=":[qt,[Ot],(s,[n])=>{const o=s.id(),h=n.value;return typeof o==typeof h&&o<=h}],"filter->=":[qt,[jt,Ot],(s,[n,o])=>{const h=s.properties()[n.value],g=o.value;return typeof h==typeof g&&h>=g}],"filter-id->=":[qt,[Ot],(s,[n])=>{const o=s.id(),h=n.value;return typeof o==typeof h&&o>=h}],"filter-has":[qt,[Ot],(s,[n])=>n.value in s.properties()],"filter-has-id":[qt,[],s=>s.id()!==null&&s.id()!==void 0],"filter-type-in":[qt,[Oi(jt)],(s,[n])=>n.value.indexOf(s.geometryType())>=0],"filter-id-in":[qt,[Oi(Ot)],(s,[n])=>n.value.indexOf(s.id())>=0],"filter-in-small":[qt,[jt,Oi(Ot)],(s,[n,o])=>o.value.indexOf(s.properties()[n.value])>=0],"filter-in-large":[qt,[jt,Oi(Ot)],(s,[n,o])=>function(h,g,y,v){for(;y<=v;){const S=y+v>>1;if(g[S]===h)return!0;g[S]>h?v=S-1:y=S+1}return!1}(s.properties()[n.value],o.value,0,o.value.length-1)],all:{type:qt,overloads:[[[qt,qt],(s,[n,o])=>n.evaluate(s)&&o.evaluate(s)],[_a(qt),(s,n)=>{for(const o of n)if(!o.evaluate(s))return!1;return!0}]]},any:{type:qt,overloads:[[[qt,qt],(s,[n,o])=>n.evaluate(s)||o.evaluate(s)],[_a(qt),(s,n)=>{for(const o of n)if(o.evaluate(s))return!0;return!1}]]},"!":[qt,[qt],(s,[n])=>!n.evaluate(s)],"is-supported-script":[qt,[jt],(s,[n])=>{const o=s.globals&&s.globals.isSupportedScript;return!o||o(n.evaluate(s))}],upcase:[jt,[jt],(s,[n])=>n.evaluate(s).toUpperCase()],downcase:[jt,[jt],(s,[n])=>n.evaluate(s).toLowerCase()],concat:[jt,_a(Ot),(s,n)=>n.map(o=>zo(o.evaluate(s))).join("")],"resolved-locale":[jt,[Fr],(s,[n])=>n.evaluate(s).resolvedLocale()]});class Pu{constructor(n,o){var h;this.expression=n,this._warningHistory={},this._evaluator=new Il,this._defaultValue=o?(h=o).type==="color"&&Fl(h.default)?new Yt(0,0,0,0):h.type==="color"?Yt.parse(h.default)||null:h.type==="padding"?vr.parse(h.default)||null:h.default===void 0?null:h.default:null,this._enumValues=o&&o.type==="enum"?o.values:null}evaluateWithoutErrorHandling(n,o,h,g,y,v){return this._evaluator.globals=n,this._evaluator.feature=o,this._evaluator.featureState=h,this._evaluator.canonical=g,this._evaluator.availableImages=y||null,this._evaluator.formattedSection=v,this.expression.evaluate(this._evaluator)}evaluate(n,o,h,g,y,v){this._evaluator.globals=n,this._evaluator.feature=o||null,this._evaluator.featureState=h||null,this._evaluator.canonical=g,this._evaluator.availableImages=y||null,this._evaluator.formattedSection=v||null;try{const S=this.expression.evaluate(this._evaluator);if(S==null||typeof S=="number"&&S!=S)return this._defaultValue;if(this._enumValues&&!(S in this._enumValues))throw new ui(`Expected value to be one of ${Object.keys(this._enumValues).map(T=>JSON.stringify(T)).join(", ")}, but found ${JSON.stringify(S)} instead.`);return S}catch(S){return this._warningHistory[S.message]||(this._warningHistory[S.message]=!0,typeof console<"u"&&console.warn(S.message)),this._defaultValue}}}function Nl(s){return Array.isArray(s)&&s.length>0&&typeof s[0]=="string"&&s[0]in Za}function Qn(s,n){const o=new Xs(Za,Pl,[],n?function(g){const y={color:Dn,string:jt,number:at,enum:jt,boolean:qt,formatted:ks,padding:Kr,resolvedImage:As};return g.type==="array"?Oi(y[g.value]||Ot,g.length):y[g.type]}(n):void 0),h=o.parse(s,void 0,void 0,void 0,n&&n.type==="string"?{typeAnnotation:"coerce"}:void 0);return h?Fd(new Pu(h,n)):Ya(o.errors)}class Ru{constructor(n,o){this.kind=n,this._styleExpression=o,this.isStateDependent=n!=="constant"&&!Ga(o.expression)}evaluateWithoutErrorHandling(n,o,h,g,y,v){return this._styleExpression.evaluateWithoutErrorHandling(n,o,h,g,y,v)}evaluate(n,o,h,g,y,v){return this._styleExpression.evaluate(n,o,h,g,y,v)}}class un{constructor(n,o,h,g){this.kind=n,this.zoomStops=h,this._styleExpression=o,this.isStateDependent=n!=="camera"&&!Ga(o.expression),this.interpolationType=g}evaluateWithoutErrorHandling(n,o,h,g,y,v){return this._styleExpression.evaluateWithoutErrorHandling(n,o,h,g,y,v)}evaluate(n,o,h,g,y,v){return this._styleExpression.evaluate(n,o,h,g,y,v)}interpolationFactor(n,o,h){return this.interpolationType?br.interpolationFactor(this.interpolationType,n,o,h):0}}function Ul(s,n){const o=Qn(s,n);if(o.result==="error")return o;const h=o.value.expression,g=Bo(h);if(!g&&!Xa(n))return Ya([new Zt("","data expressions not supported")]);const y=Rl(h,["zoom"]);if(!y&&!Nd(n))return Ya([new Zt("","zoom expressions not supported")]);const v=Fn(h);return v||y?v instanceof Zt?Ya([v]):v instanceof br&&!ku(n)?Ya([new Zt("",'"interpolate" expressions cannot be used with this property')]):Fd(v?new un(g?"camera":"composite",o.value,v.labels,v instanceof br?v.interpolation:void 0):new Ru(g?"constant":"source",o.value)):Ya([new Zt("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class $n{constructor(n,o){this._parameters=n,this._specification=o,tn(this,Ud(this._parameters,this._specification))}static deserialize(n){return new $n(n._parameters,n._specification)}static serialize(n){return{_parameters:n._parameters,_specification:n._specification}}}function Fn(s){let n=null;if(s instanceof zl)n=Fn(s.result);else if(s instanceof Ll){for(const o of s.args)if(n=Fn(o),n)break}else(s instanceof qa||s instanceof br)&&s.input instanceof Ur&&s.input.name==="zoom"&&(n=s);return n instanceof Zt||s.eachChild(o=>{const h=Fn(o);h instanceof Zt?n=h:!n&&h?n=new Zt("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):n&&h&&n!==h&&(n=new Zt("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),n}function Ka(s){if(s===!0||s===!1)return!0;if(!Array.isArray(s)||s.length===0)return!1;switch(s[0]){case"has":return s.length>=2&&s[1]!=="$id"&&s[1]!=="$type";case"in":return s.length>=3&&(typeof s[1]!="string"||Array.isArray(s[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return s.length!==3||Array.isArray(s[1])||Array.isArray(s[2]);case"any":case"all":for(const n of s.slice(1))if(!Ka(n)&&typeof n!="boolean")return!1;return!0;default:return!0}}const Vd={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function Mu(s){if(s==null)return{filter:()=>!0,needGeometry:!1};Ka(s)||(s=$l(s));const n=Qn(s,Vd);if(n.result==="error")throw new Error(n.value.map(o=>`${o.key}: ${o.message}`).join(", "));return{filter:(o,h,g)=>n.value.evaluate(o,h,{},g),needGeometry:jd(s)}}function Wm(s,n){return s<n?-1:s>n?1:0}function jd(s){if(!Array.isArray(s))return!1;if(s[0]==="within")return!0;for(let n=1;n<s.length;n++)if(jd(s[n]))return!0;return!1}function $l(s){if(!s)return!0;const n=s[0];return s.length<=1?n!=="any":n==="=="?Vl(s[1],s[2],"=="):n==="!="?Uo(Vl(s[1],s[2],"==")):n==="<"||n===">"||n==="<="||n===">="?Vl(s[1],s[2],n):n==="any"?(o=s.slice(1),["any"].concat(o.map($l))):n==="all"?["all"].concat(s.slice(1).map($l)):n==="none"?["all"].concat(s.slice(1).map($l).map(Uo)):n==="in"?Du(s[1],s.slice(2)):n==="!in"?Uo(Du(s[1],s.slice(2))):n==="has"?Lu(s[1]):n==="!has"?Uo(Lu(s[1])):n!=="within"||s;var o}function Vl(s,n,o){switch(s){case"$type":return[`filter-type-${o}`,n];case"$id":return[`filter-id-${o}`,n];default:return[`filter-${o}`,s,n]}}function Du(s,n){if(n.length===0)return!1;switch(s){case"$type":return["filter-type-in",["literal",n]];case"$id":return["filter-id-in",["literal",n]];default:return n.length>200&&!n.some(o=>typeof o!=typeof n[0])?["filter-in-large",s,["literal",n.sort(Wm)]]:["filter-in-small",s,["literal",n]]}}function Lu(s){switch(s){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",s]}}function Uo(s){return["!",s]}function $o(s){const n=typeof s;if(n==="number"||n==="boolean"||n==="string"||s==null)return JSON.stringify(s);if(Array.isArray(s)){let g="[";for(const y of s)g+=`${$o(y)},`;return`${g}]`}const o=Object.keys(s).sort();let h="{";for(let g=0;g<o.length;g++)h+=`${JSON.stringify(o[g])}:${$o(s[o[g]])},`;return`${h}}`}function Zm(s){let n="";for(const o of De)n+=`/${$o(s[o])}`;return n}function Gd(s){const n=s.value;return n?[new Ge(s.key,n,"constants have been deprecated as of v8")]:[]}function hi(s){return s instanceof Number||s instanceof String||s instanceof Boolean?s.valueOf():s}function ya(s){if(Array.isArray(s))return s.map(ya);if(s instanceof Object&&!(s instanceof Number||s instanceof String||s instanceof Boolean)){const n={};for(const o in s)n[o]=ya(s[o]);return n}return hi(s)}function $r(s){const n=s.key,o=s.value,h=s.valueSpec||{},g=s.objectElementValidators||{},y=s.style,v=s.styleSpec,S=s.validateSpec;let T=[];const R=Rn(o);if(R!=="object")return[new Ge(n,o,`object expected, ${R} found`)];for(const D in o){const B=D.split(".")[0],N=h[B]||h["*"];let V;if(g[B])V=g[B];else if(h[B])V=S;else if(g["*"])V=g["*"];else{if(!h["*"]){T.push(new Ge(n,o[D],`unknown property "${D}"`));continue}V=S}T=T.concat(V({key:(n&&`${n}.`)+D,value:o[D],valueSpec:N,style:y,styleSpec:v,object:o,objectKey:D,validateSpec:S},o))}for(const D in h)g[D]||h[D].required&&h[D].default===void 0&&o[D]===void 0&&T.push(new Ge(n,o,`missing required property "${D}"`));return T}function qd(s){const n=s.value,o=s.valueSpec,h=s.style,g=s.styleSpec,y=s.key,v=s.arrayElementValidator||s.validateSpec;if(Rn(n)!=="array")return[new Ge(y,n,`array expected, ${Rn(n)} found`)];if(o.length&&n.length!==o.length)return[new Ge(y,n,`array length ${o.length} expected, length ${n.length} found`)];if(o["min-length"]&&n.length<o["min-length"])return[new Ge(y,n,`array length at least ${o["min-length"]} expected, length ${n.length} found`)];let S={type:o.value,values:o.values};g.$version<7&&(S.function=o.function),Rn(o.value)==="object"&&(S=o.value);let T=[];for(let R=0;R<n.length;R++)T=T.concat(v({array:n,arrayIndex:R,value:n[R],valueSpec:S,validateSpec:s.validateSpec,style:h,styleSpec:g,key:`${y}[${R}]`}));return T}function zu(s){const n=s.key,o=s.value,h=s.valueSpec;let g=Rn(o);return g==="number"&&o!=o&&(g="NaN"),g!=="number"?[new Ge(n,o,`number expected, ${g} found`)]:"minimum"in h&&o<h.minimum?[new Ge(n,o,`${o} is less than the minimum value ${h.minimum}`)]:"maximum"in h&&o>h.maximum?[new Ge(n,o,`${o} is greater than the maximum value ${h.maximum}`)]:[]}function Hd(s){const n=s.valueSpec,o=hi(s.value.type);let h,g,y,v={};const S=o!=="categorical"&&s.value.property===void 0,T=!S,R=Rn(s.value.stops)==="array"&&Rn(s.value.stops[0])==="array"&&Rn(s.value.stops[0][0])==="object",D=$r({key:s.key,value:s.value,valueSpec:s.styleSpec.function,validateSpec:s.validateSpec,style:s.style,styleSpec:s.styleSpec,objectElementValidators:{stops:function(V){if(o==="identity")return[new Ge(V.key,V.value,'identity function may not have a "stops" property')];let q=[];const te=V.value;return q=q.concat(qd({key:V.key,value:te,valueSpec:V.valueSpec,validateSpec:V.validateSpec,style:V.style,styleSpec:V.styleSpec,arrayElementValidator:B})),Rn(te)==="array"&&te.length===0&&q.push(new Ge(V.key,te,"array must have at least one stop")),q},default:function(V){return V.validateSpec({key:V.key,value:V.value,valueSpec:n,validateSpec:V.validateSpec,style:V.style,styleSpec:V.styleSpec})}}});return o==="identity"&&S&&D.push(new Ge(s.key,s.value,'missing required property "property"')),o==="identity"||s.value.stops||D.push(new Ge(s.key,s.value,'missing required property "stops"')),o==="exponential"&&s.valueSpec.expression&&!ku(s.valueSpec)&&D.push(new Ge(s.key,s.value,"exponential functions not supported")),s.styleSpec.$version>=8&&(T&&!Xa(s.valueSpec)?D.push(new Ge(s.key,s.value,"property functions not supported")):S&&!Nd(s.valueSpec)&&D.push(new Ge(s.key,s.value,"zoom functions not supported"))),o!=="categorical"&&!R||s.value.property!==void 0||D.push(new Ge(s.key,s.value,'"property" property is required')),D;function B(V){let q=[];const te=V.value,Q=V.key;if(Rn(te)!=="array")return[new Ge(Q,te,`array expected, ${Rn(te)} found`)];if(te.length!==2)return[new Ge(Q,te,`array length 2 expected, length ${te.length} found`)];if(R){if(Rn(te[0])!=="object")return[new Ge(Q,te,`object expected, ${Rn(te[0])} found`)];if(te[0].zoom===void 0)return[new Ge(Q,te,"object stop key must have zoom")];if(te[0].value===void 0)return[new Ge(Q,te,"object stop key must have value")];if(y&&y>hi(te[0].zoom))return[new Ge(Q,te[0].zoom,"stop zoom values must appear in ascending order")];hi(te[0].zoom)!==y&&(y=hi(te[0].zoom),g=void 0,v={}),q=q.concat($r({key:`${Q}[0]`,value:te[0],valueSpec:{zoom:{}},validateSpec:V.validateSpec,style:V.style,styleSpec:V.styleSpec,objectElementValidators:{zoom:zu,value:N}}))}else q=q.concat(N({key:`${Q}[0]`,value:te[0],valueSpec:{},validateSpec:V.validateSpec,style:V.style,styleSpec:V.styleSpec},te));return Nl(ya(te[1]))?q.concat([new Ge(`${Q}[1]`,te[1],"expressions are not allowed in function stops.")]):q.concat(V.validateSpec({key:`${Q}[1]`,value:te[1],valueSpec:n,validateSpec:V.validateSpec,style:V.style,styleSpec:V.styleSpec}))}function N(V,q){const te=Rn(V.value),Q=hi(V.value),_e=V.value!==null?V.value:q;if(h){if(te!==h)return[new Ge(V.key,_e,`${te} stop domain type must match previous stop domain type ${h}`)]}else h=te;if(te!=="number"&&te!=="string"&&te!=="boolean")return[new Ge(V.key,_e,"stop domain value must be a number, string, or boolean")];if(te!=="number"&&o!=="categorical"){let Ee=`number expected, ${te} found`;return Xa(n)&&o===void 0&&(Ee+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new Ge(V.key,_e,Ee)]}return o!=="categorical"||te!=="number"||isFinite(Q)&&Math.floor(Q)===Q?o!=="categorical"&&te==="number"&&g!==void 0&&Q<g?[new Ge(V.key,_e,"stop domain values must appear in ascending order")]:(g=Q,o==="categorical"&&Q in v?[new Ge(V.key,_e,"stop domain values must be unique")]:(v[Q]=!0,[])):[new Ge(V.key,_e,`integer expected, found ${Q}`)]}}function va(s){const n=(s.expressionContext==="property"?Ul:Qn)(ya(s.value),s.valueSpec);if(n.result==="error")return n.value.map(h=>new Ge(`${s.key}${h.key}`,s.value,h.message));const o=n.value.expression||n.value._styleExpression.expression;if(s.expressionContext==="property"&&s.propertyKey==="text-font"&&!o.outputDefined())return[new Ge(s.key,s.value,`Invalid data expression for "${s.propertyKey}". Output values must be contained as literals within the expression.`)];if(s.expressionContext==="property"&&s.propertyType==="layout"&&!Ga(o))return[new Ge(s.key,s.value,'"feature-state" data expressions are not supported with layout properties.')];if(s.expressionContext==="filter"&&!Ga(o))return[new Ge(s.key,s.value,'"feature-state" data expressions are not supported with filters.')];if(s.expressionContext&&s.expressionContext.indexOf("cluster")===0){if(!Rl(o,["zoom","feature-state"]))return[new Ge(s.key,s.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(s.expressionContext==="cluster-initial"&&!Bo(o))return[new Ge(s.key,s.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Vo(s){const n=s.key,o=s.value,h=s.valueSpec,g=[];return Array.isArray(h.values)?h.values.indexOf(hi(o))===-1&&g.push(new Ge(n,o,`expected one of [${h.values.join(", ")}], ${JSON.stringify(o)} found`)):Object.keys(h.values).indexOf(hi(o))===-1&&g.push(new Ge(n,o,`expected one of [${Object.keys(h.values).join(", ")}], ${JSON.stringify(o)} found`)),g}function Ja(s){return Ka(ya(s.value))?va(tn({},s,{expressionContext:"filter",valueSpec:{value:"boolean"}})):Wd(s)}function Wd(s){const n=s.value,o=s.key;if(Rn(n)!=="array")return[new Ge(o,n,`array expected, ${Rn(n)} found`)];const h=s.styleSpec;let g,y=[];if(n.length<1)return[new Ge(o,n,"filter array must have at least 1 element")];switch(y=y.concat(Vo({key:`${o}[0]`,value:n[0],valueSpec:h.filter_operator,style:s.style,styleSpec:s.styleSpec})),hi(n[0])){case"<":case"<=":case">":case">=":n.length>=2&&hi(n[1])==="$type"&&y.push(new Ge(o,n,`"$type" cannot be use with operator "${n[0]}"`));case"==":case"!=":n.length!==3&&y.push(new Ge(o,n,`filter array for operator "${n[0]}" must have 3 elements`));case"in":case"!in":n.length>=2&&(g=Rn(n[1]),g!=="string"&&y.push(new Ge(`${o}[1]`,n[1],`string expected, ${g} found`)));for(let v=2;v<n.length;v++)g=Rn(n[v]),hi(n[1])==="$type"?y=y.concat(Vo({key:`${o}[${v}]`,value:n[v],valueSpec:h.geometry_type,style:s.style,styleSpec:s.styleSpec})):g!=="string"&&g!=="number"&&g!=="boolean"&&y.push(new Ge(`${o}[${v}]`,n[v],`string, number, or boolean expected, ${g} found`));break;case"any":case"all":case"none":for(let v=1;v<n.length;v++)y=y.concat(Wd({key:`${o}[${v}]`,value:n[v],style:s.style,styleSpec:s.styleSpec}));break;case"has":case"!has":g=Rn(n[1]),n.length!==2?y.push(new Ge(o,n,`filter array for "${n[0]}" operator must have 2 elements`)):g!=="string"&&y.push(new Ge(`${o}[1]`,n[1],`string expected, ${g} found`));break;case"within":g=Rn(n[1]),n.length!==2?y.push(new Ge(o,n,`filter array for "${n[0]}" operator must have 2 elements`)):g!=="object"&&y.push(new Ge(`${o}[1]`,n[1],`object expected, ${g} found`))}return y}function Ou(s,n){const o=s.key,h=s.validateSpec,g=s.style,y=s.styleSpec,v=s.value,S=s.objectKey,T=y[`${n}_${s.layerType}`];if(!T)return[];const R=S.match(/^(.*)-transition$/);if(n==="paint"&&R&&T[R[1]]&&T[R[1]].transition)return h({key:o,value:v,valueSpec:y.transition,style:g,styleSpec:y});const D=s.valueSpec||T[S];if(!D)return[new Ge(o,v,`unknown property "${S}"`)];let B;if(Rn(v)==="string"&&Xa(D)&&!D.tokens&&(B=/^{([^}]+)}$/.exec(v)))return[new Ge(o,v,`"${S}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(B[1])} }\`.`)];const N=[];return s.layerType==="symbol"&&(S==="text-field"&&g&&!g.glyphs&&N.push(new Ge(o,v,'use of "text-field" requires a style "glyphs" property')),S==="text-font"&&Fl(ya(v))&&hi(v.type)==="identity"&&N.push(new Ge(o,v,'"text-font" does not support identity functions'))),N.concat(h({key:s.key,value:v,valueSpec:D,style:g,styleSpec:y,expressionContext:"property",propertyType:n,propertyKey:S}))}function Bu(s){return Ou(s,"paint")}function Zd(s){return Ou(s,"layout")}function jl(s){let n=[];const o=s.value,h=s.key,g=s.style,y=s.styleSpec;o.type||o.ref||n.push(new Ge(h,o,'either "type" or "ref" is required'));let v=hi(o.type);const S=hi(o.ref);if(o.id){const T=hi(o.id);for(let R=0;R<s.arrayIndex;R++){const D=g.layers[R];hi(D.id)===T&&n.push(new Ge(h,o.id,`duplicate layer id "${o.id}", previously used at line ${D.id.__line__}`))}}if("ref"in o){let T;["type","source","source-layer","filter","layout"].forEach(R=>{R in o&&n.push(new Ge(h,o[R],`"${R}" is prohibited for ref layers`))}),g.layers.forEach(R=>{hi(R.id)===S&&(T=R)}),T?T.ref?n.push(new Ge(h,o.ref,"ref cannot reference another ref layer")):v=hi(T.type):n.push(new Ge(h,o.ref,`ref layer "${S}" not found`))}else if(v!=="background")if(o.source){const T=g.sources&&g.sources[o.source],R=T&&hi(T.type);T?R==="vector"&&v==="raster"?n.push(new Ge(h,o.source,`layer "${o.id}" requires a raster source`)):R==="raster"&&v!=="raster"?n.push(new Ge(h,o.source,`layer "${o.id}" requires a vector source`)):R!=="vector"||o["source-layer"]?R==="raster-dem"&&v!=="hillshade"?n.push(new Ge(h,o.source,"raster-dem source can only be used with layer type 'hillshade'.")):v!=="line"||!o.paint||!o.paint["line-gradient"]||R==="geojson"&&T.lineMetrics||n.push(new Ge(h,o,`layer "${o.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):n.push(new Ge(h,o,`layer "${o.id}" must specify a "source-layer"`)):n.push(new Ge(h,o.source,`source "${o.source}" not found`))}else n.push(new Ge(h,o,'missing required property "source"'));return n=n.concat($r({key:h,value:o,valueSpec:y.layer,style:s.style,styleSpec:s.styleSpec,validateSpec:s.validateSpec,objectElementValidators:{"*":()=>[],type:()=>s.validateSpec({key:`${h}.type`,value:o.type,valueSpec:y.layer.type,style:s.style,styleSpec:s.styleSpec,validateSpec:s.validateSpec,object:o,objectKey:"type"}),filter:Ja,layout:T=>$r({layer:o,key:T.key,value:T.value,style:T.style,styleSpec:T.styleSpec,validateSpec:T.validateSpec,objectElementValidators:{"*":R=>Zd(tn({layerType:v},R))}}),paint:T=>$r({layer:o,key:T.key,value:T.value,style:T.style,styleSpec:T.styleSpec,validateSpec:T.validateSpec,objectElementValidators:{"*":R=>Bu(tn({layerType:v},R))}})}})),n}function fs(s){const n=s.value,o=s.key,h=Rn(n);return h!=="string"?[new Ge(o,n,`string expected, ${h} found`)]:[]}const Gl={promoteId:function({key:s,value:n}){if(Rn(n)==="string")return fs({key:s,value:n});{const o=[];for(const h in n)o.push(...fs({key:`${s}.${h}`,value:n[h]}));return o}}};function ql(s){const n=s.value,o=s.key,h=s.styleSpec,g=s.style,y=s.validateSpec;if(!n.type)return[new Ge(o,n,'"type" is required')];const v=hi(n.type);let S;switch(v){case"vector":case"raster":case"raster-dem":return S=$r({key:o,value:n,valueSpec:h[`source_${v.replace("-","_")}`],style:s.style,styleSpec:h,objectElementValidators:Gl,validateSpec:y}),S;case"geojson":if(S=$r({key:o,value:n,valueSpec:h.source_geojson,style:g,styleSpec:h,validateSpec:y,objectElementValidators:Gl}),n.cluster)for(const T in n.clusterProperties){const[R,D]=n.clusterProperties[T],B=typeof R=="string"?[R,["accumulated"],["get",T]]:R;S.push(...va({key:`${o}.${T}.map`,value:D,validateSpec:y,expressionContext:"cluster-map"})),S.push(...va({key:`${o}.${T}.reduce`,value:B,validateSpec:y,expressionContext:"cluster-reduce"}))}return S;case"video":return $r({key:o,value:n,valueSpec:h.source_video,style:g,validateSpec:y,styleSpec:h});case"image":return $r({key:o,value:n,valueSpec:h.source_image,style:g,validateSpec:y,styleSpec:h});case"canvas":return[new Ge(o,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Vo({key:`${o}.type`,value:n.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:g,validateSpec:y,styleSpec:h})}}function Yd(s){const n=s.value,o=s.styleSpec,h=o.light,g=s.style;let y=[];const v=Rn(n);if(n===void 0)return y;if(v!=="object")return y=y.concat([new Ge("light",n,`object expected, ${v} found`)]),y;for(const S in n){const T=S.match(/^(.*)-transition$/);y=y.concat(T&&h[T[1]]&&h[T[1]].transition?s.validateSpec({key:S,value:n[S],valueSpec:o.transition,validateSpec:s.validateSpec,style:g,styleSpec:o}):h[S]?s.validateSpec({key:S,value:n[S],valueSpec:h[S],validateSpec:s.validateSpec,style:g,styleSpec:o}):[new Ge(S,n[S],`unknown property "${S}"`)])}return y}function jo(s){const n=s.value,o=s.styleSpec,h=o.terrain,g=s.style;let y=[];const v=Rn(n);if(n===void 0)return y;if(v!=="object")return y=y.concat([new Ge("terrain",n,`object expected, ${v} found`)]),y;for(const S in n)y=y.concat(h[S]?s.validateSpec({key:S,value:n[S],valueSpec:h[S],validateSpec:s.validateSpec,style:g,styleSpec:o}):[new Ge(S,n[S],`unknown property "${S}"`)]);return y}function Xd(s){let n=[];const o=s.value,h=s.key;if(Array.isArray(o)){const g=[],y=[];for(const v in o)o[v].id&&g.includes(o[v].id)&&n.push(new Ge(h,o,`all the sprites' ids must be unique, but ${o[v].id} is duplicated`)),g.push(o[v].id),o[v].url&&y.includes(o[v].url)&&n.push(new Ge(h,o,`all the sprites' URLs must be unique, but ${o[v].url} is duplicated`)),y.push(o[v].url),n=n.concat($r({key:`${h}[${v}]`,value:o[v],valueSpec:{id:{type:"string",required:!0},url:{type:"string",required:!0}},validateSpec:s.validateSpec}));return n}return fs({key:h,value:o})}const Kd={"*":()=>[],array:qd,boolean:function(s){const n=s.value,o=s.key,h=Rn(n);return h!=="boolean"?[new Ge(o,n,`boolean expected, ${h} found`)]:[]},number:zu,color:function(s){const n=s.key,o=s.value,h=Rn(o);return h!=="string"?[new Ge(n,o,`color expected, ${h} found`)]:Yt.parse(String(o))?[]:[new Ge(n,o,`color expected, "${o}" found`)]},constants:Gd,enum:Vo,filter:Ja,function:Hd,layer:jl,object:$r,source:ql,light:Yd,terrain:jo,string:fs,formatted:function(s){return fs(s).length===0?[]:va(s)},resolvedImage:function(s){return fs(s).length===0?[]:va(s)},padding:function(s){const n=s.key,o=s.value;if(Rn(o)==="array"){if(o.length<1||o.length>4)return[new Ge(n,o,`padding requires 1 to 4 values; ${o.length} values found`)];const h={type:"number"};let g=[];for(let y=0;y<o.length;y++)g=g.concat(s.validateSpec({key:`${n}[${y}]`,value:o[y],validateSpec:s.validateSpec,valueSpec:h}));return g}return zu({key:n,value:o,valueSpec:{}})},sprite:Xd};function Go(s){const n=s.value,o=s.valueSpec,h=s.styleSpec;return s.validateSpec=Go,o.expression&&Fl(hi(n))?Hd(s):o.expression&&Nl(ya(n))?va(s):o.type&&Kd[o.type]?Kd[o.type](s):$r(tn({},s,{valueSpec:o.type?h[o.type]:o}))}function Jd(s){const n=s.value,o=s.key,h=fs(s);return h.length||(n.indexOf("{fontstack}")===-1&&h.push(new Ge(o,n,'"glyphs" url must include a "{fontstack}" token')),n.indexOf("{range}")===-1&&h.push(new Ge(o,n,'"glyphs" url must include a "{range}" token'))),h}function ps(s,n=W){let o=[];return o=o.concat(Go({key:"",value:s,valueSpec:n.$root,styleSpec:n,style:s,validateSpec:Go,objectElementValidators:{glyphs:Jd,"*":()=>[]}})),s.constants&&(o=o.concat(Gd({key:"constants",value:s.constants,style:s,styleSpec:n,validateSpec:Go}))),qo(o)}function Vr(s){return function(n){return s({...n,validateSpec:Go})}}function qo(s){return[].concat(s).sort((n,o)=>n.line-o.line)}function yi(s){return function(...n){return qo(s.apply(this,n))}}ps.source=yi(Vr(ql)),ps.sprite=yi(Vr(Xd)),ps.glyphs=yi(Vr(Jd)),ps.light=yi(Vr(Yd)),ps.terrain=yi(Vr(jo)),ps.layer=yi(Vr(jl)),ps.filter=yi(Vr(Ja)),ps.paintProperty=yi(Vr(Bu)),ps.layoutProperty=yi(Vr(Zd));const Js=ps,Ym=Js.light,Xm=Js.paintProperty,Km=Js.layoutProperty;function Qa(s,n){let o=!1;if(n&&n.length)for(const h of n)s.fire(new Y(new Error(h.message))),o=!0;return o}class Ho{constructor(n,o,h){const g=this.cells=[];if(n instanceof ArrayBuffer){this.arrayBuffer=n;const v=new Int32Array(this.arrayBuffer);n=v[0],this.d=(o=v[1])+2*(h=v[2]);for(let T=0;T<this.d*this.d;T++){const R=v[3+T],D=v[3+T+1];g.push(R===D?null:v.subarray(R,D))}const S=v[3+g.length+1];this.keys=v.subarray(v[3+g.length],S),this.bboxes=v.subarray(S),this.insert=this._insertReadonly}else{this.d=o+2*h;for(let v=0;v<this.d*this.d;v++)g.push([]);this.keys=[],this.bboxes=[]}this.n=o,this.extent=n,this.padding=h,this.scale=o/n,this.uid=0;const y=h/o*n;this.min=-y,this.max=n+y}insert(n,o,h,g,y){this._forEachCell(o,h,g,y,this._insertCell,this.uid++,void 0,void 0),this.keys.push(n),this.bboxes.push(o),this.bboxes.push(h),this.bboxes.push(g),this.bboxes.push(y)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(n,o,h,g,y,v){this.cells[y].push(v)}query(n,o,h,g,y){const v=this.min,S=this.max;if(n<=v&&o<=v&&S<=h&&S<=g&&!y)return Array.prototype.slice.call(this.keys);{const T=[];return this._forEachCell(n,o,h,g,this._queryCell,T,{},y),T}}_queryCell(n,o,h,g,y,v,S,T){const R=this.cells[y];if(R!==null){const D=this.keys,B=this.bboxes;for(let N=0;N<R.length;N++){const V=R[N];if(S[V]===void 0){const q=4*V;(T?T(B[q+0],B[q+1],B[q+2],B[q+3]):n<=B[q+2]&&o<=B[q+3]&&h>=B[q+0]&&g>=B[q+1])?(S[V]=!0,v.push(D[V])):S[V]=!1}}}}_forEachCell(n,o,h,g,y,v,S,T){const R=this._convertToCellCoord(n),D=this._convertToCellCoord(o),B=this._convertToCellCoord(h),N=this._convertToCellCoord(g);for(let V=R;V<=B;V++)for(let q=D;q<=N;q++){const te=this.d*q+V;if((!T||T(this._convertFromCellCoord(V),this._convertFromCellCoord(q),this._convertFromCellCoord(V+1),this._convertFromCellCoord(q+1)))&&y.call(this,n,o,h,g,te,v,S,T))return}}_convertFromCellCoord(n){return(n-this.padding)/this.scale}_convertToCellCoord(n){return Math.max(0,Math.min(this.d-1,Math.floor(n*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;const n=this.cells,o=3+this.cells.length+1+1;let h=0;for(let v=0;v<this.cells.length;v++)h+=this.cells[v].length;const g=new Int32Array(o+h+this.keys.length+this.bboxes.length);g[0]=this.extent,g[1]=this.n,g[2]=this.padding;let y=o;for(let v=0;v<n.length;v++){const S=n[v];g[3+v]=y,g.set(S,y),y+=S.length}return g[3+n.length]=y,g.set(this.keys,y),y+=this.keys.length,g[3+n.length+1]=y,g.set(this.bboxes,y),y+=this.bboxes.length,g.buffer}static serialize(n,o){const h=n.toArrayBuffer();return o&&o.push(h),{buffer:h}}static deserialize(n){return new Ho(n.buffer)}}const ms={};function At(s,n,o={}){if(ms[s])throw new Error(`${s} is already registered.`);Object.defineProperty(n,"_classRegistryKey",{value:s,writeable:!1}),ms[s]={klass:n,omit:o.omit||[],shallow:o.shallow||[]}}At("Object",Object),At("TransferableGridIndex",Ho),At("Color",Yt),At("Error",Error),At("AJAXError",rt),At("ResolvedImage",Nr),At("StylePropertyFunction",$n),At("StyleExpression",Pu,{omit:["_evaluator"]}),At("ZoomDependentExpression",un),At("ZoomConstantExpression",Ru),At("CompoundExpression",Ur,{omit:["_evaluate"]});for(const s in Za)Za[s]._classRegistryKey||At(`Expression_${s}`,Za[s]);function Hl(s){return s&&typeof ArrayBuffer<"u"&&(s instanceof ArrayBuffer||s.constructor&&s.constructor.name==="ArrayBuffer")}function Wo(s,n){if(s==null||typeof s=="boolean"||typeof s=="number"||typeof s=="string"||s instanceof Boolean||s instanceof Number||s instanceof String||s instanceof Date||s instanceof RegExp||s instanceof Blob)return s;if(Hl(s)||et(s))return n&&n.push(s),s;if(ArrayBuffer.isView(s)){const o=s;return n&&n.push(o.buffer),o}if(s instanceof ImageData)return n&&n.push(s.data.buffer),s;if(Array.isArray(s)){const o=[];for(const h of s)o.push(Wo(h,n));return o}if(typeof s=="object"){const o=s.constructor,h=o._classRegistryKey;if(!h)throw new Error("can't serialize object of unregistered class");if(!ms[h])throw new Error(`${h} is not registered.`);const g=o.serialize?o.serialize(s,n):{};if(o.serialize){if(n&&g===n[n.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(const y in s){if(!s.hasOwnProperty(y)||ms[h].omit.indexOf(y)>=0)continue;const v=s[y];g[y]=ms[h].shallow.indexOf(y)>=0?v:Wo(v,n)}s instanceof Error&&(g.message=s.message)}if(g.$name)throw new Error("$name property is reserved for worker serialization logic.");return h!=="Object"&&(g.$name=h),g}throw new Error("can't serialize object of type "+typeof s)}function Rs(s){if(s==null||typeof s=="boolean"||typeof s=="number"||typeof s=="string"||s instanceof Boolean||s instanceof Number||s instanceof String||s instanceof Date||s instanceof RegExp||s instanceof Blob||Hl(s)||et(s)||ArrayBuffer.isView(s)||s instanceof ImageData)return s;if(Array.isArray(s))return s.map(Rs);if(typeof s=="object"){const n=s.$name||"Object";if(!ms[n])throw new Error(`can't deserialize unregistered class ${n}`);const{klass:o}=ms[n];if(!o)throw new Error(`can't deserialize unregistered class ${n}`);if(o.deserialize)return o.deserialize(s);const h=Object.create(o.prototype);for(const g of Object.keys(s)){if(g==="$name")continue;const y=s[g];h[g]=ms[n].shallow.indexOf(g)>=0?y:Rs(y)}return h}throw new Error("can't deserialize object of type "+typeof s)}class Qd{constructor(){this.first=!0}update(n,o){const h=Math.floor(n);return this.first?(this.first=!1,this.lastIntegerZoom=h,this.lastIntegerZoomTime=0,this.lastZoom=n,this.lastFloorZoom=h,!0):(this.lastFloorZoom>h?(this.lastIntegerZoom=h+1,this.lastIntegerZoomTime=o):this.lastFloorZoom<h&&(this.lastIntegerZoom=h,this.lastIntegerZoomTime=o),n!==this.lastZoom&&(this.lastZoom=n,this.lastFloorZoom=h,!0))}}const vt={"Latin-1 Supplement":s=>s>=128&&s<=255,Arabic:s=>s>=1536&&s<=1791,"Arabic Supplement":s=>s>=1872&&s<=1919,"Arabic Extended-A":s=>s>=2208&&s<=2303,"Hangul Jamo":s=>s>=4352&&s<=4607,"Unified Canadian Aboriginal Syllabics":s=>s>=5120&&s<=5759,Khmer:s=>s>=6016&&s<=6143,"Unified Canadian Aboriginal Syllabics Extended":s=>s>=6320&&s<=6399,"General Punctuation":s=>s>=8192&&s<=8303,"Letterlike Symbols":s=>s>=8448&&s<=8527,"Number Forms":s=>s>=8528&&s<=8591,"Miscellaneous Technical":s=>s>=8960&&s<=9215,"Control Pictures":s=>s>=9216&&s<=9279,"Optical Character Recognition":s=>s>=9280&&s<=9311,"Enclosed Alphanumerics":s=>s>=9312&&s<=9471,"Geometric Shapes":s=>s>=9632&&s<=9727,"Miscellaneous Symbols":s=>s>=9728&&s<=9983,"Miscellaneous Symbols and Arrows":s=>s>=11008&&s<=11263,"CJK Radicals Supplement":s=>s>=11904&&s<=12031,"Kangxi Radicals":s=>s>=12032&&s<=12255,"Ideographic Description Characters":s=>s>=12272&&s<=12287,"CJK Symbols and Punctuation":s=>s>=12288&&s<=12351,Hiragana:s=>s>=12352&&s<=12447,Katakana:s=>s>=12448&&s<=12543,Bopomofo:s=>s>=12544&&s<=12591,"Hangul Compatibility Jamo":s=>s>=12592&&s<=12687,Kanbun:s=>s>=12688&&s<=12703,"Bopomofo Extended":s=>s>=12704&&s<=12735,"CJK Strokes":s=>s>=12736&&s<=12783,"Katakana Phonetic Extensions":s=>s>=12784&&s<=12799,"Enclosed CJK Letters and Months":s=>s>=12800&&s<=13055,"CJK Compatibility":s=>s>=13056&&s<=13311,"CJK Unified Ideographs Extension A":s=>s>=13312&&s<=19903,"Yijing Hexagram Symbols":s=>s>=19904&&s<=19967,"CJK Unified Ideographs":s=>s>=19968&&s<=40959,"Yi Syllables":s=>s>=40960&&s<=42127,"Yi Radicals":s=>s>=42128&&s<=42191,"Hangul Jamo Extended-A":s=>s>=43360&&s<=43391,"Hangul Syllables":s=>s>=44032&&s<=55215,"Hangul Jamo Extended-B":s=>s>=55216&&s<=55295,"Private Use Area":s=>s>=57344&&s<=63743,"CJK Compatibility Ideographs":s=>s>=63744&&s<=64255,"Arabic Presentation Forms-A":s=>s>=64336&&s<=65023,"Vertical Forms":s=>s>=65040&&s<=65055,"CJK Compatibility Forms":s=>s>=65072&&s<=65103,"Small Form Variants":s=>s>=65104&&s<=65135,"Arabic Presentation Forms-B":s=>s>=65136&&s<=65279,"Halfwidth and Fullwidth Forms":s=>s>=65280&&s<=65519};function Wl(s){for(const n of s)if(Zl(n.charCodeAt(0)))return!0;return!1}function Fu(s){for(const n of s)if(!ef(n.charCodeAt(0)))return!1;return!0}function ef(s){return!(vt.Arabic(s)||vt["Arabic Supplement"](s)||vt["Arabic Extended-A"](s)||vt["Arabic Presentation Forms-A"](s)||vt["Arabic Presentation Forms-B"](s))}function Zl(s){return!(s!==746&&s!==747&&(s<4352||!(vt["Bopomofo Extended"](s)||vt.Bopomofo(s)||vt["CJK Compatibility Forms"](s)&&!(s>=65097&&s<=65103)||vt["CJK Compatibility Ideographs"](s)||vt["CJK Compatibility"](s)||vt["CJK Radicals Supplement"](s)||vt["CJK Strokes"](s)||!(!vt["CJK Symbols and Punctuation"](s)||s>=12296&&s<=12305||s>=12308&&s<=12319||s===12336)||vt["CJK Unified Ideographs Extension A"](s)||vt["CJK Unified Ideographs"](s)||vt["Enclosed CJK Letters and Months"](s)||vt["Hangul Compatibility Jamo"](s)||vt["Hangul Jamo Extended-A"](s)||vt["Hangul Jamo Extended-B"](s)||vt["Hangul Jamo"](s)||vt["Hangul Syllables"](s)||vt.Hiragana(s)||vt["Ideographic Description Characters"](s)||vt.Kanbun(s)||vt["Kangxi Radicals"](s)||vt["Katakana Phonetic Extensions"](s)||vt.Katakana(s)&&s!==12540||!(!vt["Halfwidth and Fullwidth Forms"](s)||s===65288||s===65289||s===65293||s>=65306&&s<=65310||s===65339||s===65341||s===65343||s>=65371&&s<=65503||s===65507||s>=65512&&s<=65519)||!(!vt["Small Form Variants"](s)||s>=65112&&s<=65118||s>=65123&&s<=65126)||vt["Unified Canadian Aboriginal Syllabics"](s)||vt["Unified Canadian Aboriginal Syllabics Extended"](s)||vt["Vertical Forms"](s)||vt["Yijing Hexagram Symbols"](s)||vt["Yi Syllables"](s)||vt["Yi Radicals"](s))))}function tf(s){return!(Zl(s)||function(n){return!!(vt["Latin-1 Supplement"](n)&&(n===167||n===169||n===174||n===177||n===188||n===189||n===190||n===215||n===247)||vt["General Punctuation"](n)&&(n===8214||n===8224||n===8225||n===8240||n===8241||n===8251||n===8252||n===8258||n===8263||n===8264||n===8265||n===8273)||vt["Letterlike Symbols"](n)||vt["Number Forms"](n)||vt["Miscellaneous Technical"](n)&&(n>=8960&&n<=8967||n>=8972&&n<=8991||n>=8996&&n<=9e3||n===9003||n>=9085&&n<=9114||n>=9150&&n<=9165||n===9167||n>=9169&&n<=9179||n>=9186&&n<=9215)||vt["Control Pictures"](n)&&n!==9251||vt["Optical Character Recognition"](n)||vt["Enclosed Alphanumerics"](n)||vt["Geometric Shapes"](n)||vt["Miscellaneous Symbols"](n)&&!(n>=9754&&n<=9759)||vt["Miscellaneous Symbols and Arrows"](n)&&(n>=11026&&n<=11055||n>=11088&&n<=11097||n>=11192&&n<=11243)||vt["CJK Symbols and Punctuation"](n)||vt.Katakana(n)||vt["Private Use Area"](n)||vt["CJK Compatibility Forms"](n)||vt["Small Form Variants"](n)||vt["Halfwidth and Fullwidth Forms"](n)||n===8734||n===8756||n===8757||n>=9984&&n<=10087||n>=10102&&n<=10131||n===65532||n===65533)}(s))}function Yl(s){return s>=1424&&s<=2303||vt["Arabic Presentation Forms-A"](s)||vt["Arabic Presentation Forms-B"](s)}function Xl(s,n){return!(!n&&Yl(s)||s>=2304&&s<=3583||s>=3840&&s<=4255||vt.Khmer(s))}function nf(s){for(const n of s)if(Yl(n.charCodeAt(0)))return!0;return!1}const Nu="deferred",Kl="loading",Uu="loaded";let Zo=null,hr="unavailable",Qs=null;const rf=function(s){s&&typeof s=="string"&&s.indexOf("NetworkError")>-1&&(hr="error"),Zo&&Zo(s)};function $u(){Jl.fire(new ft("pluginStateChange",{pluginStatus:hr,pluginURL:Qs}))}const Jl=new ie,Vu=function(){return hr},sf=function(){if(hr!==Nu||!Qs)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");hr=Kl,$u(),Qs&&Se({url:Qs},s=>{s?rf(s):(hr=Uu,$u())})},jr={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>hr===Uu||jr.applyArabicShaping!=null,isLoading:()=>hr===Kl,setState(s){if(!oe())throw new Error("Cannot set the state of the rtl-text-plugin when not in the web-worker context");hr=s.pluginStatus,Qs=s.pluginURL},isParsed(){if(!oe())throw new Error("rtl-text-plugin is only parsed on the worker-threads");return jr.applyArabicShaping!=null&&jr.processBidirectionalText!=null&&jr.processStyledBidirectionalText!=null},getPluginURL(){if(!oe())throw new Error("rtl-text-plugin url can only be queried from the worker threads");return Qs}};class Wn{constructor(n,o){this.zoom=n,o?(this.now=o.now,this.fadeDuration=o.fadeDuration,this.zoomHistory=o.zoomHistory,this.transition=o.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new Qd,this.transition={})}isSupportedScript(n){return function(o,h){for(const g of o)if(!Xl(g.charCodeAt(0),h))return!1;return!0}(n,jr.isLoaded())}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const n=this.zoom,o=n-Math.floor(n),h=this.crossFadingFactor();return n>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:o+(1-o)*h}:{fromScale:.5,toScale:1,t:1-(1-h)*o}}}class Ql{constructor(n,o){this.property=n,this.value=o,this.expression=function(h,g){if(Fl(h))return new $n(h,g);if(Nl(h)){const y=Ul(h,g);if(y.result==="error")throw new Error(y.value.map(v=>`${v.key}: ${v.message}`).join(", "));return y.value}{let y=h;return g.type==="color"&&typeof h=="string"?y=Yt.parse(h):g.type!=="padding"||typeof h!="number"&&!Array.isArray(h)||(y=vr.parse(h)),{kind:"constant",evaluate:()=>y}}}(o===void 0?n.specification.default:o,n.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(n,o,h){return this.property.possiblyEvaluate(this,n,o,h)}}class ju{constructor(n){this.property=n,this.value=new Ql(n,void 0)}transitioned(n,o){return new Yo(this.property,this.value,o,ye({},n.transition,this.transition),n.now)}untransitioned(){return new Yo(this.property,this.value,null,{},0)}}class af{constructor(n){this._properties=n,this._values=Object.create(n.defaultTransitionablePropertyValues)}getValue(n){return U(this._values[n].value.value)}setValue(n,o){Object.prototype.hasOwnProperty.call(this._values,n)||(this._values[n]=new ju(this._values[n].property)),this._values[n].value=new Ql(this._values[n].property,o===null?void 0:U(o))}getTransition(n){return U(this._values[n].transition)}setTransition(n,o){Object.prototype.hasOwnProperty.call(this._values,n)||(this._values[n]=new ju(this._values[n].property)),this._values[n].transition=U(o)||void 0}serialize(){const n={};for(const o of Object.keys(this._values)){const h=this.getValue(o);h!==void 0&&(n[o]=h);const g=this.getTransition(o);g!==void 0&&(n[`${o}-transition`]=g)}return n}transitioned(n,o){const h=new of(this._properties);for(const g of Object.keys(this._values))h._values[g]=this._values[g].transitioned(n,o._values[g]);return h}untransitioned(){const n=new of(this._properties);for(const o of Object.keys(this._values))n._values[o]=this._values[o].untransitioned();return n}}class Yo{constructor(n,o,h,g,y){this.property=n,this.value=o,this.begin=y+g.delay||0,this.end=this.begin+g.duration||0,n.specification.transition&&(g.delay||g.duration)&&(this.prior=h)}possiblyEvaluate(n,o,h){const g=n.now||0,y=this.value.possiblyEvaluate(n,o,h),v=this.prior;if(v){if(g>this.end)return this.prior=null,y;if(this.value.isDataDriven())return this.prior=null,y;if(g<this.begin)return v.possiblyEvaluate(n,o,h);{const S=(g-this.begin)/(this.end-this.begin);return this.property.interpolate(v.possiblyEvaluate(n,o,h),y,function(T){if(T<=0)return 0;if(T>=1)return 1;const R=T*T,D=R*T;return 4*(T<.5?D:3*(T-R)+D-.75)}(S))}}return y}}class of{constructor(n){this._properties=n,this._values=Object.create(n.defaultTransitioningPropertyValues)}possiblyEvaluate(n,o,h){const g=new ec(this._properties);for(const y of Object.keys(this._values))g._values[y]=this._values[y].possiblyEvaluate(n,o,h);return g}hasTransition(){for(const n of Object.keys(this._values))if(this._values[n].prior)return!0;return!1}}class Gu{constructor(n){this._properties=n,this._values=Object.create(n.defaultPropertyValues)}getValue(n){return U(this._values[n].value)}setValue(n,o){this._values[n]=new Ql(this._values[n].property,o===null?void 0:U(o))}serialize(){const n={};for(const o of Object.keys(this._values)){const h=this.getValue(o);h!==void 0&&(n[o]=h)}return n}possiblyEvaluate(n,o,h){const g=new ec(this._properties);for(const y of Object.keys(this._values))g._values[y]=this._values[y].possiblyEvaluate(n,o,h);return g}}class gs{constructor(n,o,h){this.property=n,this.value=o,this.parameters=h}isConstant(){return this.value.kind==="constant"}constantOr(n){return this.value.kind==="constant"?this.value.value:n}evaluate(n,o,h,g){return this.property.evaluate(this.value,this.parameters,n,o,h,g)}}class ec{constructor(n){this._properties=n,this._values=Object.create(n.defaultPossiblyEvaluatedValues)}get(n){return this._values[n]}}class zt{constructor(n){this.specification=n}possiblyEvaluate(n,o){if(n.isDataDriven())throw new Error("Value should not be data driven");return n.expression.evaluate(o)}interpolate(n,o,h){const g=xr[this.specification.type];return g?g(n,o,h):n}}class Ht{constructor(n,o){this.specification=n,this.overrides=o}possiblyEvaluate(n,o,h,g){return new gs(this,n.expression.kind==="constant"||n.expression.kind==="camera"?{kind:"constant",value:n.expression.evaluate(o,null,{},h,g)}:n.expression,o)}interpolate(n,o,h){if(n.value.kind!=="constant"||o.value.kind!=="constant")return n;if(n.value.value===void 0||o.value.value===void 0)return new gs(this,{kind:"constant",value:void 0},n.parameters);const g=xr[this.specification.type];if(g){const y=g(n.value.value,o.value.value,h);return new gs(this,{kind:"constant",value:y},n.parameters)}return n}evaluate(n,o,h,g,y,v){return n.kind==="constant"?n.value:n.evaluate(o,h,g,y,v)}}class Xo extends Ht{possiblyEvaluate(n,o,h,g){if(n.value===void 0)return new gs(this,{kind:"constant",value:void 0},o);if(n.expression.kind==="constant"){const y=n.expression.evaluate(o,null,{},h,g),v=n.property.specification.type==="resolvedImage"&&typeof y!="string"?y.name:y,S=this._calculate(v,v,v,o);return new gs(this,{kind:"constant",value:S},o)}if(n.expression.kind==="camera"){const y=this._calculate(n.expression.evaluate({zoom:o.zoom-1}),n.expression.evaluate({zoom:o.zoom}),n.expression.evaluate({zoom:o.zoom+1}),o);return new gs(this,{kind:"constant",value:y},o)}return new gs(this,n.expression,o)}evaluate(n,o,h,g,y,v){if(n.kind==="source"){const S=n.evaluate(o,h,g,y,v);return this._calculate(S,S,S,o)}return n.kind==="composite"?this._calculate(n.evaluate({zoom:Math.floor(o.zoom)-1},h,g),n.evaluate({zoom:Math.floor(o.zoom)},h,g),n.evaluate({zoom:Math.floor(o.zoom)+1},h,g),o):n.value}_calculate(n,o,h,g){return g.zoom>g.zoomHistory.lastIntegerZoom?{from:n,to:o}:{from:h,to:o}}interpolate(n){return n}}class qu{constructor(n){this.specification=n}possiblyEvaluate(n,o,h,g){if(n.value!==void 0){if(n.expression.kind==="constant"){const y=n.expression.evaluate(o,null,{},h,g);return this._calculate(y,y,y,o)}return this._calculate(n.expression.evaluate(new Wn(Math.floor(o.zoom-1),o)),n.expression.evaluate(new Wn(Math.floor(o.zoom),o)),n.expression.evaluate(new Wn(Math.floor(o.zoom+1),o)),o)}}_calculate(n,o,h,g){return g.zoom>g.zoomHistory.lastIntegerZoom?{from:n,to:o}:{from:h,to:o}}interpolate(n){return n}}class Hu{constructor(n){this.specification=n}possiblyEvaluate(n,o,h,g){return!!n.expression.evaluate(o,null,{},h,g)}interpolate(){return!1}}class dr{constructor(n){this.properties=n,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const o in n){const h=n[o];h.specification.overridable&&this.overridableProperties.push(o);const g=this.defaultPropertyValues[o]=new Ql(h,void 0),y=this.defaultTransitionablePropertyValues[o]=new ju(h);this.defaultTransitioningPropertyValues[o]=y.untransitioned(),this.defaultPossiblyEvaluatedValues[o]=g.possiblyEvaluate({})}}}At("DataDrivenProperty",Ht),At("DataConstantProperty",zt),At("CrossFadedDataDrivenProperty",Xo),At("CrossFadedProperty",qu),At("ColorRampProperty",Hu);const lf="-transition";class _s extends ie{constructor(n,o){if(super(),this.id=n.id,this.type=n.type,this._featureFilter={filter:()=>!0,needGeometry:!1},n.type!=="custom"&&(this.metadata=n.metadata,this.minzoom=n.minzoom,this.maxzoom=n.maxzoom,n.type!=="background"&&(this.source=n.source,this.sourceLayer=n["source-layer"],this.filter=n.filter),o.layout&&(this._unevaluatedLayout=new Gu(o.layout)),o.paint)){this._transitionablePaint=new af(o.paint);for(const h in n.paint)this.setPaintProperty(h,n.paint[h],{validate:!1});for(const h in n.layout)this.setLayoutProperty(h,n.layout[h],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new ec(o.paint)}}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(n){return n==="visibility"?this.visibility:this._unevaluatedLayout.getValue(n)}setLayoutProperty(n,o,h={}){o!=null&&this._validate(Km,`layers.${this.id}.layout.${n}`,n,o,h)||(n!=="visibility"?this._unevaluatedLayout.setValue(n,o):this.visibility=o)}getPaintProperty(n){return n.endsWith(lf)?this._transitionablePaint.getTransition(n.slice(0,-11)):this._transitionablePaint.getValue(n)}setPaintProperty(n,o,h={}){if(o!=null&&this._validate(Xm,`layers.${this.id}.paint.${n}`,n,o,h))return!1;if(n.endsWith(lf))return this._transitionablePaint.setTransition(n.slice(0,-11),o||void 0),!1;{const g=this._transitionablePaint._values[n],y=g.property.specification["property-type"]==="cross-faded-data-driven",v=g.value.isDataDriven(),S=g.value;this._transitionablePaint.setValue(n,o),this._handleSpecialPaintPropertyUpdate(n);const T=this._transitionablePaint._values[n].value;return T.isDataDriven()||v||y||this._handleOverridablePaintPropertyUpdate(n,S,T)}}_handleSpecialPaintPropertyUpdate(n){}_handleOverridablePaintPropertyUpdate(n,o,h){return!1}isHidden(n){return!!(this.minzoom&&n<this.minzoom)||!!(this.maxzoom&&n>=this.maxzoom)||this.visibility==="none"}updateTransitions(n){this._transitioningPaint=this._transitionablePaint.transitioned(n,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(n,o){n.getCrossfadeParameters&&(this._crossfadeParameters=n.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(n,void 0,o)),this.paint=this._transitioningPaint.possiblyEvaluate(n,void 0,o)}serialize(){const n={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(n.layout=n.layout||{},n.layout.visibility=this.visibility),Ie(n,(o,h)=>!(o===void 0||h==="layout"&&!Object.keys(o).length||h==="paint"&&!Object.keys(o).length))}_validate(n,o,h,g,y={}){return(!y||y.validate!==!1)&&Qa(this,n.call(Js,{key:o,layerType:this.type,objectKey:h,value:g,styleSpec:W,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const n in this.paint._values){const o=this.paint.get(n);if(o instanceof gs&&Xa(o.property.specification)&&(o.value.kind==="source"||o.value.kind==="composite")&&o.value.isStateDependent)return!0}return!1}}const Jm={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class Ms{constructor(n,o){this._structArray=n,this._pos1=o*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class si{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(n,o){return n._trim(),o&&(n.isTransferred=!0,o.push(n.arrayBuffer)),{length:n.length,arrayBuffer:n.arrayBuffer}}static deserialize(n){const o=Object.create(this.prototype);return o.arrayBuffer=n.arrayBuffer,o.length=n.length,o.capacity=n.arrayBuffer.byteLength/o.bytesPerElement,o._refreshViews(),o}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(n){this.reserve(n),this.length=n}reserve(n){if(n>this.capacity){this.capacity=Math.max(n,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const o=this.uint8;this._refreshViews(),o&&this.uint8.set(o)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function vi(s,n=1){let o=0,h=0;return{members:s.map(g=>{const y=Jm[g.type].BYTES_PER_ELEMENT,v=o=cf(o,Math.max(n,y)),S=g.components||1;return h=Math.max(h,y),o+=y*S,{name:g.name,type:g.type,components:S,offset:v}}),size:cf(o,Math.max(h,n)),alignment:n}}function cf(s,n){return Math.ceil(s/n)*n}class eo extends si{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,o){const h=this.length;return this.resize(h+1),this.emplace(h,n,o)}emplace(n,o,h){const g=2*n;return this.int16[g+0]=o,this.int16[g+1]=h,n}}eo.prototype.bytesPerElement=4,At("StructArrayLayout2i4",eo);class tc extends si{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,o,h){const g=this.length;return this.resize(g+1),this.emplace(g,n,o,h)}emplace(n,o,h,g){const y=3*n;return this.int16[y+0]=o,this.int16[y+1]=h,this.int16[y+2]=g,n}}tc.prototype.bytesPerElement=6,At("StructArrayLayout3i6",tc);class Wu extends si{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,o,h,g){const y=this.length;return this.resize(y+1),this.emplace(y,n,o,h,g)}emplace(n,o,h,g,y){const v=4*n;return this.int16[v+0]=o,this.int16[v+1]=h,this.int16[v+2]=g,this.int16[v+3]=y,n}}Wu.prototype.bytesPerElement=8,At("StructArrayLayout4i8",Wu);class ys extends si{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,o,h,g,y,v){const S=this.length;return this.resize(S+1),this.emplace(S,n,o,h,g,y,v)}emplace(n,o,h,g,y,v,S){const T=6*n;return this.int16[T+0]=o,this.int16[T+1]=h,this.int16[T+2]=g,this.int16[T+3]=y,this.int16[T+4]=v,this.int16[T+5]=S,n}}ys.prototype.bytesPerElement=12,At("StructArrayLayout2i4i12",ys);class nc extends si{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,o,h,g,y,v){const S=this.length;return this.resize(S+1),this.emplace(S,n,o,h,g,y,v)}emplace(n,o,h,g,y,v,S){const T=4*n,R=8*n;return this.int16[T+0]=o,this.int16[T+1]=h,this.uint8[R+4]=g,this.uint8[R+5]=y,this.uint8[R+6]=v,this.uint8[R+7]=S,n}}nc.prototype.bytesPerElement=8,At("StructArrayLayout2i4ub8",nc);class xa extends si{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,o){const h=this.length;return this.resize(h+1),this.emplace(h,n,o)}emplace(n,o,h){const g=2*n;return this.float32[g+0]=o,this.float32[g+1]=h,n}}xa.prototype.bytesPerElement=8,At("StructArrayLayout2f8",xa);class ic extends si{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,o,h,g,y,v,S,T,R,D){const B=this.length;return this.resize(B+1),this.emplace(B,n,o,h,g,y,v,S,T,R,D)}emplace(n,o,h,g,y,v,S,T,R,D,B){const N=10*n;return this.uint16[N+0]=o,this.uint16[N+1]=h,this.uint16[N+2]=g,this.uint16[N+3]=y,this.uint16[N+4]=v,this.uint16[N+5]=S,this.uint16[N+6]=T,this.uint16[N+7]=R,this.uint16[N+8]=D,this.uint16[N+9]=B,n}}ic.prototype.bytesPerElement=20,At("StructArrayLayout10ui20",ic);class Ko extends si{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,o,h,g,y,v,S,T,R,D,B,N){const V=this.length;return this.resize(V+1),this.emplace(V,n,o,h,g,y,v,S,T,R,D,B,N)}emplace(n,o,h,g,y,v,S,T,R,D,B,N,V){const q=12*n;return this.int16[q+0]=o,this.int16[q+1]=h,this.int16[q+2]=g,this.int16[q+3]=y,this.uint16[q+4]=v,this.uint16[q+5]=S,this.uint16[q+6]=T,this.uint16[q+7]=R,this.int16[q+8]=D,this.int16[q+9]=B,this.int16[q+10]=N,this.int16[q+11]=V,n}}Ko.prototype.bytesPerElement=24,At("StructArrayLayout4i4ui4i24",Ko);class Zu extends si{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,o,h){const g=this.length;return this.resize(g+1),this.emplace(g,n,o,h)}emplace(n,o,h,g){const y=3*n;return this.float32[y+0]=o,this.float32[y+1]=h,this.float32[y+2]=g,n}}Zu.prototype.bytesPerElement=12,At("StructArrayLayout3f12",Zu);class to extends si{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(n){const o=this.length;return this.resize(o+1),this.emplace(o,n)}emplace(n,o){return this.uint32[1*n+0]=o,n}}to.prototype.bytesPerElement=4,At("StructArrayLayout1ul4",to);class ba extends si{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,o,h,g,y,v,S,T,R){const D=this.length;return this.resize(D+1),this.emplace(D,n,o,h,g,y,v,S,T,R)}emplace(n,o,h,g,y,v,S,T,R,D){const B=10*n,N=5*n;return this.int16[B+0]=o,this.int16[B+1]=h,this.int16[B+2]=g,this.int16[B+3]=y,this.int16[B+4]=v,this.int16[B+5]=S,this.uint32[N+3]=T,this.uint16[B+8]=R,this.uint16[B+9]=D,n}}ba.prototype.bytesPerElement=20,At("StructArrayLayout6i1ul2ui20",ba);class Yu extends si{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,o,h,g,y,v){const S=this.length;return this.resize(S+1),this.emplace(S,n,o,h,g,y,v)}emplace(n,o,h,g,y,v,S){const T=6*n;return this.int16[T+0]=o,this.int16[T+1]=h,this.int16[T+2]=g,this.int16[T+3]=y,this.int16[T+4]=v,this.int16[T+5]=S,n}}Yu.prototype.bytesPerElement=12,At("StructArrayLayout2i2i2i12",Yu);class rc extends si{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,o,h,g,y){const v=this.length;return this.resize(v+1),this.emplace(v,n,o,h,g,y)}emplace(n,o,h,g,y,v){const S=4*n,T=8*n;return this.float32[S+0]=o,this.float32[S+1]=h,this.float32[S+2]=g,this.int16[T+6]=y,this.int16[T+7]=v,n}}rc.prototype.bytesPerElement=16,At("StructArrayLayout2f1f2i16",rc);class wa extends si{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,o,h,g){const y=this.length;return this.resize(y+1),this.emplace(y,n,o,h,g)}emplace(n,o,h,g,y){const v=12*n,S=3*n;return this.uint8[v+0]=o,this.uint8[v+1]=h,this.float32[S+1]=g,this.float32[S+2]=y,n}}wa.prototype.bytesPerElement=12,At("StructArrayLayout2ub2f12",wa);class sc extends si{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,o,h){const g=this.length;return this.resize(g+1),this.emplace(g,n,o,h)}emplace(n,o,h,g){const y=3*n;return this.uint16[y+0]=o,this.uint16[y+1]=h,this.uint16[y+2]=g,n}}sc.prototype.bytesPerElement=6,At("StructArrayLayout3ui6",sc);class Xu extends si{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,o,h,g,y,v,S,T,R,D,B,N,V,q,te,Q,_e){const Ee=this.length;return this.resize(Ee+1),this.emplace(Ee,n,o,h,g,y,v,S,T,R,D,B,N,V,q,te,Q,_e)}emplace(n,o,h,g,y,v,S,T,R,D,B,N,V,q,te,Q,_e,Ee){const pe=24*n,Re=12*n,ze=48*n;return this.int16[pe+0]=o,this.int16[pe+1]=h,this.uint16[pe+2]=g,this.uint16[pe+3]=y,this.uint32[Re+2]=v,this.uint32[Re+3]=S,this.uint32[Re+4]=T,this.uint16[pe+10]=R,this.uint16[pe+11]=D,this.uint16[pe+12]=B,this.float32[Re+7]=N,this.float32[Re+8]=V,this.uint8[ze+36]=q,this.uint8[ze+37]=te,this.uint8[ze+38]=Q,this.uint32[Re+10]=_e,this.int16[pe+22]=Ee,n}}Xu.prototype.bytesPerElement=48,At("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",Xu);class ac extends si{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,o,h,g,y,v,S,T,R,D,B,N,V,q,te,Q,_e,Ee,pe,Re,ze,We,Tt,Rt,xt,_t,pt,bt){const yt=this.length;return this.resize(yt+1),this.emplace(yt,n,o,h,g,y,v,S,T,R,D,B,N,V,q,te,Q,_e,Ee,pe,Re,ze,We,Tt,Rt,xt,_t,pt,bt)}emplace(n,o,h,g,y,v,S,T,R,D,B,N,V,q,te,Q,_e,Ee,pe,Re,ze,We,Tt,Rt,xt,_t,pt,bt,yt){const lt=34*n,$t=17*n;return this.int16[lt+0]=o,this.int16[lt+1]=h,this.int16[lt+2]=g,this.int16[lt+3]=y,this.int16[lt+4]=v,this.int16[lt+5]=S,this.int16[lt+6]=T,this.int16[lt+7]=R,this.uint16[lt+8]=D,this.uint16[lt+9]=B,this.uint16[lt+10]=N,this.uint16[lt+11]=V,this.uint16[lt+12]=q,this.uint16[lt+13]=te,this.uint16[lt+14]=Q,this.uint16[lt+15]=_e,this.uint16[lt+16]=Ee,this.uint16[lt+17]=pe,this.uint16[lt+18]=Re,this.uint16[lt+19]=ze,this.uint16[lt+20]=We,this.uint16[lt+21]=Tt,this.uint16[lt+22]=Rt,this.uint32[$t+12]=xt,this.float32[$t+13]=_t,this.float32[$t+14]=pt,this.float32[$t+15]=bt,this.float32[$t+16]=yt,n}}ac.prototype.bytesPerElement=68,At("StructArrayLayout8i15ui1ul4f68",ac);class oc extends si{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n){const o=this.length;return this.resize(o+1),this.emplace(o,n)}emplace(n,o){return this.float32[1*n+0]=o,n}}oc.prototype.bytesPerElement=4,At("StructArrayLayout1f4",oc);class lc extends si{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,o,h){const g=this.length;return this.resize(g+1),this.emplace(g,n,o,h)}emplace(n,o,h,g){const y=4*n;return this.uint32[2*n+0]=o,this.uint16[y+2]=h,this.uint16[y+3]=g,n}}lc.prototype.bytesPerElement=8,At("StructArrayLayout1ul2ui8",lc);class m extends si{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,o){const h=this.length;return this.resize(h+1),this.emplace(h,n,o)}emplace(n,o,h){const g=2*n;return this.uint16[g+0]=o,this.uint16[g+1]=h,n}}m.prototype.bytesPerElement=4,At("StructArrayLayout2ui4",m);class r extends si{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n){const o=this.length;return this.resize(o+1),this.emplace(o,n)}emplace(n,o){return this.uint16[1*n+0]=o,n}}r.prototype.bytesPerElement=2,At("StructArrayLayout1ui2",r);class c extends si{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,o,h,g){const y=this.length;return this.resize(y+1),this.emplace(y,n,o,h,g)}emplace(n,o,h,g,y){const v=4*n;return this.float32[v+0]=o,this.float32[v+1]=h,this.float32[v+2]=g,this.float32[v+3]=y,n}}c.prototype.bytesPerElement=16,At("StructArrayLayout4f16",c);class f extends Ms{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new I(this.anchorPointX,this.anchorPointY)}}f.prototype.size=20;class _ extends ba{get(n){return new f(this,n)}}At("CollisionBoxArray",_);class x extends Ms{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(n){this._structArray.uint8[this._pos1+37]=n}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(n){this._structArray.uint8[this._pos1+38]=n}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(n){this._structArray.uint32[this._pos4+10]=n}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}x.prototype.size=48;class E extends Xu{get(n){return new x(this,n)}}At("PlacedSymbolArray",E);class A extends Ms{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(n){this._structArray.uint32[this._pos4+12]=n}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get textOffset0(){return this._structArray.float32[this._pos4+14]}get textOffset1(){return this._structArray.float32[this._pos4+15]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+16]}}A.prototype.size=68;class k extends ac{get(n){return new A(this,n)}}At("SymbolInstanceArray",k);class P extends oc{getoffsetX(n){return this.float32[1*n+0]}}At("GlyphOffsetArray",P);class z extends tc{getx(n){return this.int16[3*n+0]}gety(n){return this.int16[3*n+1]}gettileUnitDistanceFromAnchor(n){return this.int16[3*n+2]}}At("SymbolLineVertexArray",z);class L extends Ms{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}L.prototype.size=8;class G extends lc{get(n){return new L(this,n)}}At("FeatureIndexArray",G);class ee extends eo{}class K extends eo{}class J extends eo{}class se extends ys{}class ge extends nc{}class Me extends xa{}class re extends ic{}class Pe extends Ko{}class Fe extends Zu{}class Qe extends to{}class ot extends Yu{}class ht extends wa{}class it extends sc{}class St extends m{}const Ut=vi([{name:"a_pos",components:2,type:"Int16"}],4),{members:Qt}=Ut;class gt{constructor(n=[]){this.segments=n}prepareSegment(n,o,h,g){let y=this.segments[this.segments.length-1];return n>gt.MAX_VERTEX_ARRAY_LENGTH&&he(`Max vertices per segment is ${gt.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${n}`),(!y||y.vertexLength+n>gt.MAX_VERTEX_ARRAY_LENGTH||y.sortKey!==g)&&(y={vertexOffset:o.length,primitiveOffset:h.length,vertexLength:0,primitiveLength:0},g!==void 0&&(y.sortKey=g),this.segments.push(y)),y}get(){return this.segments}destroy(){for(const n of this.segments)for(const o in n.vaos)n.vaos[o].destroy()}static simpleSegment(n,o,h,g){return new gt([{vertexOffset:n,primitiveOffset:o,vertexLength:h,primitiveLength:g,vaos:{},sortKey:0}])}}function Wt(s,n){return 256*(s=ce(Math.floor(s),0,255))+ce(Math.floor(n),0,255)}gt.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,At("SegmentVector",gt);const Et=vi([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]);var xn={exports:{}},di={exports:{}};di.exports=function(s,n){var o,h,g,y,v,S,T,R;for(h=s.length-(o=3&s.length),g=n,v=3432918353,S=461845907,R=0;R<h;)T=255&s.charCodeAt(R)|(255&s.charCodeAt(++R))<<8|(255&s.charCodeAt(++R))<<16|(255&s.charCodeAt(++R))<<24,++R,g=27492+(65535&(y=5*(65535&(g=(g^=T=(65535&(T=(T=(65535&T)*v+(((T>>>16)*v&65535)<<16)&4294967295)<<15|T>>>17))*S+(((T>>>16)*S&65535)<<16)&4294967295)<<13|g>>>19))+((5*(g>>>16)&65535)<<16)&4294967295))+((58964+(y>>>16)&65535)<<16);switch(T=0,o){case 3:T^=(255&s.charCodeAt(R+2))<<16;case 2:T^=(255&s.charCodeAt(R+1))<<8;case 1:g^=T=(65535&(T=(T=(65535&(T^=255&s.charCodeAt(R)))*v+(((T>>>16)*v&65535)<<16)&4294967295)<<15|T>>>17))*S+(((T>>>16)*S&65535)<<16)&4294967295}return g^=s.length,g=2246822507*(65535&(g^=g>>>16))+((2246822507*(g>>>16)&65535)<<16)&4294967295,g=3266489909*(65535&(g^=g>>>13))+((3266489909*(g>>>16)&65535)<<16)&4294967295,(g^=g>>>16)>>>0};var bn=di.exports,nn={exports:{}};nn.exports=function(s,n){for(var o,h=s.length,g=n^h,y=0;h>=4;)o=1540483477*(65535&(o=255&s.charCodeAt(y)|(255&s.charCodeAt(++y))<<8|(255&s.charCodeAt(++y))<<16|(255&s.charCodeAt(++y))<<24))+((1540483477*(o>>>16)&65535)<<16),g=1540483477*(65535&g)+((1540483477*(g>>>16)&65535)<<16)^(o=1540483477*(65535&(o^=o>>>24))+((1540483477*(o>>>16)&65535)<<16)),h-=4,++y;switch(h){case 3:g^=(255&s.charCodeAt(y+2))<<16;case 2:g^=(255&s.charCodeAt(y+1))<<8;case 1:g=1540483477*(65535&(g^=255&s.charCodeAt(y)))+((1540483477*(g>>>16)&65535)<<16)}return g=1540483477*(65535&(g^=g>>>13))+((1540483477*(g>>>16)&65535)<<16),(g^=g>>>15)>>>0};var ai=bn,er=nn.exports;xn.exports=ai,xn.exports.murmur3=ai,xn.exports.murmur2=er;var fi=b(xn.exports);class Pi{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(n,o,h,g){this.ids.push(wr(n)),this.positions.push(o,h,g)}getPositions(n){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");const o=wr(n);let h=0,g=this.ids.length-1;for(;h<g;){const v=h+g>>1;this.ids[v]>=o?g=v:h=v+1}const y=[];for(;this.ids[h]===o;)y.push({index:this.positions[3*h],start:this.positions[3*h+1],end:this.positions[3*h+2]}),h++;return y}static serialize(n,o){const h=new Float64Array(n.ids),g=new Uint32Array(n.positions);return Qr(h,g,0,h.length-1),o&&o.push(h.buffer,g.buffer),{ids:h,positions:g}}static deserialize(n){const o=new Pi;return o.ids=n.ids,o.positions=n.positions,o.indexed=!0,o}}function wr(s){const n=+s;return!isNaN(n)&&n<=Number.MAX_SAFE_INTEGER?n:fi(String(s))}function Qr(s,n,o,h){for(;o<h;){const g=s[o+h>>1];let y=o-1,v=h+1;for(;;){do y++;while(s[y]<g);do v--;while(s[v]>g);if(y>=v)break;es(s,y,v),es(n,3*y,3*v),es(n,3*y+1,3*v+1),es(n,3*y+2,3*v+2)}v-o<h-v?(Qr(s,n,o,v),o=v+1):(Qr(s,n,v+1,h),h=v)}}function es(s,n,o){const h=s[n];s[n]=s[o],s[o]=h}At("FeaturePositionMap",Pi);class tr{constructor(n,o){this.gl=n.gl,this.location=o}}class vs extends tr{constructor(n,o){super(n,o),this.current=0}set(n){this.current!==n&&(this.current=n,this.gl.uniform1f(this.location,n))}}class Jo extends tr{constructor(n,o){super(n,o),this.current=[0,0,0,0]}set(n){n[0]===this.current[0]&&n[1]===this.current[1]&&n[2]===this.current[2]&&n[3]===this.current[3]||(this.current=n,this.gl.uniform4f(this.location,n[0],n[1],n[2],n[3]))}}class Gi extends tr{constructor(n,o){super(n,o),this.current=Yt.transparent}set(n){n.r===this.current.r&&n.g===this.current.g&&n.b===this.current.b&&n.a===this.current.a||(this.current=n,this.gl.uniform4f(this.location,n.r,n.g,n.b,n.a))}}const Ri=new Float32Array(16);function Cn(s){return[Wt(255*s.r,255*s.g),Wt(255*s.b,255*s.a)]}class Ti{constructor(n,o,h){this.value=n,this.uniformNames=o.map(g=>`u_${g}`),this.type=h}setUniform(n,o,h){n.set(h.constantOr(this.value))}getBinding(n,o,h){return this.type==="color"?new Gi(n,o):new vs(n,o)}}class Mi{constructor(n,o){this.uniformNames=o.map(h=>`u_${h}`),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(n,o){this.pixelRatioFrom=o.pixelRatio,this.pixelRatioTo=n.pixelRatio,this.patternFrom=o.tlbr,this.patternTo=n.tlbr}setUniform(n,o,h,g){const y=g==="u_pattern_to"?this.patternTo:g==="u_pattern_from"?this.patternFrom:g==="u_pixel_ratio_to"?this.pixelRatioTo:g==="u_pixel_ratio_from"?this.pixelRatioFrom:null;y&&n.set(y)}getBinding(n,o,h){return h.substr(0,9)==="u_pattern"?new Jo(n,o):new vs(n,o)}}class kn{constructor(n,o,h,g){this.expression=n,this.type=h,this.maxValue=0,this.paintVertexAttributes=o.map(y=>({name:`a_${y}`,type:"Float32",components:h==="color"?2:1,offset:0})),this.paintVertexArray=new g}populatePaintArray(n,o,h,g,y){const v=this.paintVertexArray.length,S=this.expression.evaluate(new Wn(0),o,{},g,[],y);this.paintVertexArray.resize(n),this._setPaintValue(v,n,S)}updatePaintArray(n,o,h,g){const y=this.expression.evaluate({zoom:0},h,g);this._setPaintValue(n,o,y)}_setPaintValue(n,o,h){if(this.type==="color"){const g=Cn(h);for(let y=n;y<o;y++)this.paintVertexArray.emplace(y,g[0],g[1])}else{for(let g=n;g<o;g++)this.paintVertexArray.emplace(g,h);this.maxValue=Math.max(this.maxValue,Math.abs(h))}}upload(n){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=n.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Ci{constructor(n,o,h,g,y,v){this.expression=n,this.uniformNames=o.map(S=>`u_${S}_t`),this.type=h,this.useIntegerZoom=g,this.zoom=y,this.maxValue=0,this.paintVertexAttributes=o.map(S=>({name:`a_${S}`,type:"Float32",components:h==="color"?4:2,offset:0})),this.paintVertexArray=new v}populatePaintArray(n,o,h,g,y){const v=this.expression.evaluate(new Wn(this.zoom),o,{},g,[],y),S=this.expression.evaluate(new Wn(this.zoom+1),o,{},g,[],y),T=this.paintVertexArray.length;this.paintVertexArray.resize(n),this._setPaintValue(T,n,v,S)}updatePaintArray(n,o,h,g){const y=this.expression.evaluate({zoom:this.zoom},h,g),v=this.expression.evaluate({zoom:this.zoom+1},h,g);this._setPaintValue(n,o,y,v)}_setPaintValue(n,o,h,g){if(this.type==="color"){const y=Cn(h),v=Cn(g);for(let S=n;S<o;S++)this.paintVertexArray.emplace(S,y[0],y[1],v[0],v[1])}else{for(let y=n;y<o;y++)this.paintVertexArray.emplace(y,h,g);this.maxValue=Math.max(this.maxValue,Math.abs(h),Math.abs(g))}}upload(n){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=n.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(n,o){const h=this.useIntegerZoom?Math.floor(o.zoom):o.zoom,g=ce(this.expression.interpolationFactor(h,this.zoom,this.zoom+1),0,1);n.set(g)}getBinding(n,o,h){return new vs(n,o)}}class Sr{constructor(n,o,h,g,y,v){this.expression=n,this.type=o,this.useIntegerZoom=h,this.zoom=g,this.layerId=v,this.zoomInPaintVertexArray=new y,this.zoomOutPaintVertexArray=new y}populatePaintArray(n,o,h){const g=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(n),this.zoomOutPaintVertexArray.resize(n),this._setPaintValues(g,n,o.patterns&&o.patterns[this.layerId],h)}updatePaintArray(n,o,h,g,y){this._setPaintValues(n,o,h.patterns&&h.patterns[this.layerId],y)}_setPaintValues(n,o,h,g){if(!g||!h)return;const{min:y,mid:v,max:S}=h,T=g[y],R=g[v],D=g[S];if(T&&R&&D)for(let B=n;B<o;B++)this.zoomInPaintVertexArray.emplace(B,R.tl[0],R.tl[1],R.br[0],R.br[1],T.tl[0],T.tl[1],T.br[0],T.br[1],R.pixelRatio,T.pixelRatio),this.zoomOutPaintVertexArray.emplace(B,R.tl[0],R.tl[1],R.br[0],R.br[1],D.tl[0],D.tl[1],D.br[0],D.br[1],R.pixelRatio,D.pixelRatio)}upload(n){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=n.createVertexBuffer(this.zoomInPaintVertexArray,Et.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=n.createVertexBuffer(this.zoomOutPaintVertexArray,Et.members,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class cc{constructor(n,o,h){this.binders={},this._buffers=[];const g=[];for(const y in n.paint._values){if(!h(y))continue;const v=n.paint.get(y);if(!(v instanceof gs&&Xa(v.property.specification)))continue;const S=Qm(y,n.type),T=v.value,R=v.property.specification.type,D=v.property.useIntegerZoom,B=v.property.specification["property-type"],N=B==="cross-faded"||B==="cross-faded-data-driven";if(T.kind==="constant")this.binders[y]=N?new Mi(T.value,S):new Ti(T.value,S,R),g.push(`/u_${y}`);else if(T.kind==="source"||N){const V=uf(y,R,"source");this.binders[y]=N?new Sr(T,R,D,o,V,n.id):new kn(T,S,R,V),g.push(`/a_${y}`)}else{const V=uf(y,R,"composite");this.binders[y]=new Ci(T,S,R,D,o,V),g.push(`/z_${y}`)}}this.cacheKey=g.sort().join("")}getMaxValue(n){const o=this.binders[n];return o instanceof kn||o instanceof Ci?o.maxValue:0}populatePaintArrays(n,o,h,g,y){for(const v in this.binders){const S=this.binders[v];(S instanceof kn||S instanceof Ci||S instanceof Sr)&&S.populatePaintArray(n,o,h,g,y)}}setConstantPatternPositions(n,o){for(const h in this.binders){const g=this.binders[h];g instanceof Mi&&g.setConstantPatternPositions(n,o)}}updatePaintArrays(n,o,h,g,y){let v=!1;for(const S in n){const T=o.getPositions(S);for(const R of T){const D=h.feature(R.index);for(const B in this.binders){const N=this.binders[B];if((N instanceof kn||N instanceof Ci||N instanceof Sr)&&N.expression.isStateDependent===!0){const V=g.paint.get(B);N.expression=V.value,N.updatePaintArray(R.start,R.end,D,n[S],y),v=!0}}}}return v}defines(){const n=[];for(const o in this.binders){const h=this.binders[o];(h instanceof Ti||h instanceof Mi)&&n.push(...h.uniformNames.map(g=>`#define HAS_UNIFORM_${g}`))}return n}getBinderAttributes(){const n=[];for(const o in this.binders){const h=this.binders[o];if(h instanceof kn||h instanceof Ci)for(let g=0;g<h.paintVertexAttributes.length;g++)n.push(h.paintVertexAttributes[g].name);else if(h instanceof Sr)for(let g=0;g<Et.members.length;g++)n.push(Et.members[g].name)}return n}getBinderUniforms(){const n=[];for(const o in this.binders){const h=this.binders[o];if(h instanceof Ti||h instanceof Mi||h instanceof Ci)for(const g of h.uniformNames)n.push(g)}return n}getPaintVertexBuffers(){return this._buffers}getUniforms(n,o){const h=[];for(const g in this.binders){const y=this.binders[g];if(y instanceof Ti||y instanceof Mi||y instanceof Ci){for(const v of y.uniformNames)if(o[v]){const S=y.getBinding(n,o[v],v);h.push({name:v,property:g,binding:S})}}}return h}setUniforms(n,o,h,g){for(const{name:y,property:v,binding:S}of o)this.binders[v].setUniform(S,g,h.get(v),y)}updatePaintBuffers(n){this._buffers=[];for(const o in this.binders){const h=this.binders[o];if(n&&h instanceof Sr){const g=n.fromScale===2?h.zoomInPaintVertexBuffer:h.zoomOutPaintVertexBuffer;g&&this._buffers.push(g)}else(h instanceof kn||h instanceof Ci)&&h.paintVertexBuffer&&this._buffers.push(h.paintVertexBuffer)}}upload(n){for(const o in this.binders){const h=this.binders[o];(h instanceof kn||h instanceof Ci||h instanceof Sr)&&h.upload(n)}this.updatePaintBuffers()}destroy(){for(const n in this.binders){const o=this.binders[n];(o instanceof kn||o instanceof Ci||o instanceof Sr)&&o.destroy()}}}class Ds{constructor(n,o,h=()=>!0){this.programConfigurations={};for(const g of n)this.programConfigurations[g.id]=new cc(g,o,h);this.needsUpload=!1,this._featureMap=new Pi,this._bufferOffset=0}populatePaintArrays(n,o,h,g,y,v){for(const S in this.programConfigurations)this.programConfigurations[S].populatePaintArrays(n,o,g,y,v);o.id!==void 0&&this._featureMap.add(o.id,h,this._bufferOffset,n),this._bufferOffset=n,this.needsUpload=!0}updatePaintArrays(n,o,h,g){for(const y of h)this.needsUpload=this.programConfigurations[y.id].updatePaintArrays(n,this._featureMap,o,y,g)||this.needsUpload}get(n){return this.programConfigurations[n]}upload(n){if(this.needsUpload){for(const o in this.programConfigurations)this.programConfigurations[o].upload(n);this.needsUpload=!1}}destroy(){for(const n in this.programConfigurations)this.programConfigurations[n].destroy()}}function Qm(s,n){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[s]||[s.replace(`${n}-`,"").replace(/-/g,"_")]}function uf(s,n,o){const h={color:{source:xa,composite:c},number:{source:oc,composite:xa}},g=function(y){return{"line-pattern":{source:re,composite:re},"fill-pattern":{source:re,composite:re},"fill-extrusion-pattern":{source:re,composite:re}}[y]}(s);return g&&g[o]||h[n][o]}At("ConstantBinder",Ti),At("CrossFadedConstantBinder",Mi),At("SourceExpressionBinder",kn),At("CrossFadedCompositeBinder",Sr),At("CompositeExpressionBinder",Ci),At("ProgramConfiguration",cc,{omit:["_buffers"]}),At("ProgramConfigurationSet",Ds);var Gn=8192;const Ku=Math.pow(2,14)-1,Qo=-Ku-1;function Ls(s){const n=Gn/s.extent,o=s.loadGeometry();for(let h=0;h<o.length;h++){const g=o[h];for(let y=0;y<g.length;y++){const v=g[y],S=Math.round(v.x*n),T=Math.round(v.y*n);v.x=ce(S,Qo,Ku),v.y=ce(T,Qo,Ku),(S<v.x||S>v.x+1||T<v.y||T>v.y+1)&&he("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return o}function el(s,n){return{type:s.type,id:s.id,properties:s.properties,geometry:n?Ls(s):[]}}function hf(s,n,o,h,g){s.emplaceBack(2*n+(h+1)/2,2*o+(g+1)/2)}class eg{constructor(n){this.zoom=n.zoom,this.overscaling=n.overscaling,this.layers=n.layers,this.layerIds=this.layers.map(o=>o.id),this.index=n.index,this.hasPattern=!1,this.layoutVertexArray=new K,this.indexArray=new it,this.segments=new gt,this.programConfigurations=new Ds(n.layers,n.zoom),this.stateDependentLayerIds=this.layers.filter(o=>o.isStateDependent()).map(o=>o.id)}populate(n,o,h){const g=this.layers[0],y=[];let v=null,S=!1;g.type==="circle"&&(v=g.layout.get("circle-sort-key"),S=!v.isConstant());for(const{feature:T,id:R,index:D,sourceLayerIndex:B}of n){const N=this.layers[0]._featureFilter.needGeometry,V=el(T,N);if(!this.layers[0]._featureFilter.filter(new Wn(this.zoom),V,h))continue;const q=S?v.evaluate(V,{},h):void 0,te={id:R,properties:T.properties,type:T.type,sourceLayerIndex:B,index:D,geometry:N?V.geometry:Ls(T),patterns:{},sortKey:q};y.push(te)}S&&y.sort((T,R)=>T.sortKey-R.sortKey);for(const T of y){const{geometry:R,index:D,sourceLayerIndex:B}=T,N=n[D].feature;this.addFeature(T,R,D,h),o.featureIndex.insert(N,R,D,B,this.index)}}update(n,o,h){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(n,o,this.stateDependentLayers,h)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(n){this.uploaded||(this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,Qt),this.indexBuffer=n.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(n),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(n,o,h,g){for(const y of o)for(const v of y){const S=v.x,T=v.y;if(S<0||S>=Gn||T<0||T>=Gn)continue;const R=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,n.sortKey),D=R.vertexLength;hf(this.layoutVertexArray,S,T,-1,-1),hf(this.layoutVertexArray,S,T,1,-1),hf(this.layoutVertexArray,S,T,1,1),hf(this.layoutVertexArray,S,T,-1,1),this.indexArray.emplaceBack(D,D+1,D+2),this.indexArray.emplaceBack(D,D+3,D+2),R.vertexLength+=4,R.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,n,h,{},g)}}function f0(s,n){for(let o=0;o<s.length;o++)if(uc(n,s[o]))return!0;for(let o=0;o<n.length;o++)if(uc(s,n[o]))return!0;return!!tg(s,n)}function uC(s,n,o){return!!uc(s,n)||!!ng(n,s,o)}function p0(s,n){if(s.length===1)return g0(n,s[0]);for(let o=0;o<n.length;o++){const h=n[o];for(let g=0;g<h.length;g++)if(uc(s,h[g]))return!0}for(let o=0;o<s.length;o++)if(g0(n,s[o]))return!0;for(let o=0;o<n.length;o++)if(tg(s,n[o]))return!0;return!1}function hC(s,n,o){if(s.length>1){if(tg(s,n))return!0;for(let h=0;h<n.length;h++)if(ng(n[h],s,o))return!0}for(let h=0;h<s.length;h++)if(ng(s[h],n,o))return!0;return!1}function tg(s,n){if(s.length===0||n.length===0)return!1;for(let o=0;o<s.length-1;o++){const h=s[o],g=s[o+1];for(let y=0;y<n.length-1;y++)if(dC(h,g,n[y],n[y+1]))return!0}return!1}function dC(s,n,o,h){return xe(s,o,h)!==xe(n,o,h)&&xe(s,n,o)!==xe(s,n,h)}function ng(s,n,o){const h=o*o;if(n.length===1)return s.distSqr(n[0])<h;for(let g=1;g<n.length;g++)if(m0(s,n[g-1],n[g])<h)return!0;return!1}function m0(s,n,o){const h=n.distSqr(o);if(h===0)return s.distSqr(n);const g=((s.x-n.x)*(o.x-n.x)+(s.y-n.y)*(o.y-n.y))/h;return s.distSqr(g<0?n:g>1?o:o.sub(n)._mult(g)._add(n))}function g0(s,n){let o,h,g,y=!1;for(let v=0;v<s.length;v++){o=s[v];for(let S=0,T=o.length-1;S<o.length;T=S++)h=o[S],g=o[T],h.y>n.y!=g.y>n.y&&n.x<(g.x-h.x)*(n.y-h.y)/(g.y-h.y)+h.x&&(y=!y)}return y}function uc(s,n){let o=!1;for(let h=0,g=s.length-1;h<s.length;g=h++){const y=s[h],v=s[g];y.y>n.y!=v.y>n.y&&n.x<(v.x-y.x)*(n.y-y.y)/(v.y-y.y)+y.x&&(o=!o)}return o}function fC(s,n,o){const h=o[0],g=o[2];if(s.x<h.x&&n.x<h.x||s.x>g.x&&n.x>g.x||s.y<h.y&&n.y<h.y||s.y>g.y&&n.y>g.y)return!1;const y=xe(s,n,o[0]);return y!==xe(s,n,o[1])||y!==xe(s,n,o[2])||y!==xe(s,n,o[3])}function Ju(s,n,o){const h=n.paint.get(s).value;return h.kind==="constant"?h.value:o.programConfigurations.get(n.id).getMaxValue(s)}function df(s){return Math.sqrt(s[0]*s[0]+s[1]*s[1])}function ff(s,n,o,h,g){if(!n[0]&&!n[1])return s;const y=I.convert(n)._mult(g);o==="viewport"&&y._rotate(-h);const v=[];for(let S=0;S<s.length;S++)v.push(s[S].sub(y));return v}let _0,y0;At("CircleBucket",eg,{omit:["layers"]});var pC={get paint(){return y0=y0||new dr({"circle-radius":new Ht(W.paint_circle["circle-radius"]),"circle-color":new Ht(W.paint_circle["circle-color"]),"circle-blur":new Ht(W.paint_circle["circle-blur"]),"circle-opacity":new Ht(W.paint_circle["circle-opacity"]),"circle-translate":new zt(W.paint_circle["circle-translate"]),"circle-translate-anchor":new zt(W.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new zt(W.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new zt(W.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Ht(W.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Ht(W.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Ht(W.paint_circle["circle-stroke-opacity"])})},get layout(){return _0=_0||new dr({"circle-sort-key":new Ht(W.layout_circle["circle-sort-key"])})}},fr=1e-6,hc=typeof Float32Array<"u"?Float32Array:Array;function ig(s){return s[0]=1,s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=1,s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[10]=1,s[11]=0,s[12]=0,s[13]=0,s[14]=0,s[15]=1,s}function v0(s,n,o){var h=n[0],g=n[1],y=n[2],v=n[3],S=n[4],T=n[5],R=n[6],D=n[7],B=n[8],N=n[9],V=n[10],q=n[11],te=n[12],Q=n[13],_e=n[14],Ee=n[15],pe=o[0],Re=o[1],ze=o[2],We=o[3];return s[0]=pe*h+Re*S+ze*B+We*te,s[1]=pe*g+Re*T+ze*N+We*Q,s[2]=pe*y+Re*R+ze*V+We*_e,s[3]=pe*v+Re*D+ze*q+We*Ee,s[4]=(pe=o[4])*h+(Re=o[5])*S+(ze=o[6])*B+(We=o[7])*te,s[5]=pe*g+Re*T+ze*N+We*Q,s[6]=pe*y+Re*R+ze*V+We*_e,s[7]=pe*v+Re*D+ze*q+We*Ee,s[8]=(pe=o[8])*h+(Re=o[9])*S+(ze=o[10])*B+(We=o[11])*te,s[9]=pe*g+Re*T+ze*N+We*Q,s[10]=pe*y+Re*R+ze*V+We*_e,s[11]=pe*v+Re*D+ze*q+We*Ee,s[12]=(pe=o[12])*h+(Re=o[13])*S+(ze=o[14])*B+(We=o[15])*te,s[13]=pe*g+Re*T+ze*N+We*Q,s[14]=pe*y+Re*R+ze*V+We*_e,s[15]=pe*v+Re*D+ze*q+We*Ee,s}Math.hypot||(Math.hypot=function(){for(var s=0,n=arguments.length;n--;)s+=arguments[n]*arguments[n];return Math.sqrt(s)});var Qu,mC=v0;function pf(s,n,o){var h=n[0],g=n[1],y=n[2],v=n[3];return s[0]=o[0]*h+o[4]*g+o[8]*y+o[12]*v,s[1]=o[1]*h+o[5]*g+o[9]*y+o[13]*v,s[2]=o[2]*h+o[6]*g+o[10]*y+o[14]*v,s[3]=o[3]*h+o[7]*g+o[11]*y+o[15]*v,s}function x0(s,n){const o=pf([],[s.x,s.y,0,1],n);return new I(o[0]/o[3],o[1]/o[3])}Qu=new hc(4),hc!=Float32Array&&(Qu[0]=0,Qu[1]=0,Qu[2]=0,Qu[3]=0);class b0 extends eg{}let w0;At("HeatmapBucket",b0,{omit:["layers"]});var gC={get paint(){return w0=w0||new dr({"heatmap-radius":new Ht(W.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Ht(W.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new zt(W.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Hu(W.paint_heatmap["heatmap-color"]),"heatmap-opacity":new zt(W.paint_heatmap["heatmap-opacity"])})}};function rg(s,{width:n,height:o},h,g){if(g){if(g instanceof Uint8ClampedArray)g=new Uint8Array(g.buffer);else if(g.length!==n*o*h)throw new RangeError(`mismatched image size. expected: ${g.length} but got: ${n*o*h}`)}else g=new Uint8Array(n*o*h);return s.width=n,s.height=o,s.data=g,s}function S0(s,{width:n,height:o},h){if(n===s.width&&o===s.height)return;const g=rg({},{width:n,height:o},h);sg(s,g,{x:0,y:0},{x:0,y:0},{width:Math.min(s.width,n),height:Math.min(s.height,o)},h),s.width=n,s.height=o,s.data=g.data}function sg(s,n,o,h,g,y){if(g.width===0||g.height===0)return n;if(g.width>s.width||g.height>s.height||o.x>s.width-g.width||o.y>s.height-g.height)throw new RangeError("out of range source coordinates for image copy");if(g.width>n.width||g.height>n.height||h.x>n.width-g.width||h.y>n.height-g.height)throw new RangeError("out of range destination coordinates for image copy");const v=s.data,S=n.data;if(v===S)throw new Error("srcData equals dstData, so image is already copied");for(let T=0;T<g.height;T++){const R=((o.y+T)*s.width+o.x)*y,D=((h.y+T)*n.width+h.x)*y;for(let B=0;B<g.width*y;B++)S[D+B]=v[R+B]}return n}class eh{constructor(n,o){rg(this,n,1,o)}resize(n){S0(this,n,1)}clone(){return new eh({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(n,o,h,g,y){sg(n,o,h,g,y,1)}}class ts{constructor(n,o){rg(this,n,4,o)}resize(n){S0(this,n,4)}replace(n,o){o?this.data.set(n):this.data=n instanceof Uint8ClampedArray?new Uint8Array(n.buffer):n}clone(){return new ts({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(n,o,h,g,y){sg(n,o,h,g,y,4)}}function E0(s){const n={},o=s.resolution||256,h=s.clips?s.clips.length:1,g=s.image||new ts({width:o,height:h});if(Math.log(o)/Math.LN2%1!=0)throw new Error(`width is not a power of 2 - ${o}`);const y=(v,S,T)=>{n[s.evaluationKey]=T;const R=s.expression.evaluate(n);g.data[v+S+0]=Math.floor(255*R.r/R.a),g.data[v+S+1]=Math.floor(255*R.g/R.a),g.data[v+S+2]=Math.floor(255*R.b/R.a),g.data[v+S+3]=Math.floor(255*R.a)};if(s.clips)for(let v=0,S=0;v<h;++v,S+=4*o)for(let T=0,R=0;T<o;T++,R+=4){const D=T/(o-1),{start:B,end:N}=s.clips[v];y(S,R,B*(1-D)+N*D)}else for(let v=0,S=0;v<o;v++,S+=4)y(0,S,v/(o-1));return g}let T0;At("AlphaImage",eh),At("RGBAImage",ts);var _C={get paint(){return T0=T0||new dr({"hillshade-illumination-direction":new zt(W.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new zt(W.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new zt(W.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new zt(W.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new zt(W.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new zt(W.paint_hillshade["hillshade-accent-color"])})}};const yC=vi([{name:"a_pos",components:2,type:"Int16"}],4),{members:vC}=yC;var ag={exports:{}};function mf(s,n,o){o=o||2;var h,g,y,v,S,T,R,D=n&&n.length,B=D?n[0]*o:s.length,N=C0(s,0,B,o,!0),V=[];if(!N||N.next===N.prev)return V;if(D&&(N=function(te,Q,_e,Ee){var pe,Re,ze,We=[];for(pe=0,Re=Q.length;pe<Re;pe++)(ze=C0(te,Q[pe]*Ee,pe<Re-1?Q[pe+1]*Ee:te.length,Ee,!1))===ze.next&&(ze.steiner=!0),We.push(IC(ze));for(We.sort(EC),pe=0;pe<We.length;pe++)_e=TC(We[pe],_e);return _e}(s,n,N,o)),s.length>80*o){h=y=s[0],g=v=s[1];for(var q=o;q<B;q+=o)(S=s[q])<h&&(h=S),(T=s[q+1])<g&&(g=T),S>y&&(y=S),T>v&&(v=T);R=(R=Math.max(y-h,v-g))!==0?32767/R:0}return th(N,V,o,h,g,R,0),V}function C0(s,n,o,h,g){var y,v;if(g===cg(s,n,o,h)>0)for(y=n;y<o;y+=h)v=A0(y,s[y],s[y+1],v);else for(y=o-h;y>=n;y-=h)v=A0(y,s[y],s[y+1],v);return v&&gf(v,v.next)&&(ih(v),v=v.next),v}function tl(s,n){if(!s)return s;n||(n=s);var o,h=s;do if(o=!1,h.steiner||!gf(h,h.next)&&pi(h.prev,h,h.next)!==0)h=h.next;else{if(ih(h),(h=n=h.prev)===h.next)break;o=!0}while(o||h!==n);return n}function th(s,n,o,h,g,y,v){if(s){!v&&y&&function(D,B,N,V){var q=D;do q.z===0&&(q.z=og(q.x,q.y,B,N,V)),q.prevZ=q.prev,q.nextZ=q.next,q=q.next;while(q!==D);q.prevZ.nextZ=null,q.prevZ=null,function(te){var Q,_e,Ee,pe,Re,ze,We,Tt,Rt=1;do{for(_e=te,te=null,Re=null,ze=0;_e;){for(ze++,Ee=_e,We=0,Q=0;Q<Rt&&(We++,Ee=Ee.nextZ);Q++);for(Tt=Rt;We>0||Tt>0&&Ee;)We!==0&&(Tt===0||!Ee||_e.z<=Ee.z)?(pe=_e,_e=_e.nextZ,We--):(pe=Ee,Ee=Ee.nextZ,Tt--),Re?Re.nextZ=pe:te=pe,pe.prevZ=Re,Re=pe;_e=Ee}Re.nextZ=null,Rt*=2}while(ze>1)}(q)}(s,h,g,y);for(var S,T,R=s;s.prev!==s.next;)if(S=s.prev,T=s.next,y?bC(s,h,g,y):xC(s))n.push(S.i/o|0),n.push(s.i/o|0),n.push(T.i/o|0),ih(s),s=T.next,R=T.next;else if((s=T)===R){v?v===1?th(s=wC(tl(s),n,o),n,o,h,g,y,2):v===2&&SC(s,n,o,h,g,y):th(tl(s),n,o,h,g,y,1);break}}}function xC(s){var n=s.prev,o=s,h=s.next;if(pi(n,o,h)>=0)return!1;for(var g=n.x,y=o.x,v=h.x,S=n.y,T=o.y,R=h.y,D=g<y?g<v?g:v:y<v?y:v,B=S<T?S<R?S:R:T<R?T:R,N=g>y?g>v?g:v:y>v?y:v,V=S>T?S>R?S:R:T>R?T:R,q=h.next;q!==n;){if(q.x>=D&&q.x<=N&&q.y>=B&&q.y<=V&&dc(g,S,y,T,v,R,q.x,q.y)&&pi(q.prev,q,q.next)>=0)return!1;q=q.next}return!0}function bC(s,n,o,h){var g=s.prev,y=s,v=s.next;if(pi(g,y,v)>=0)return!1;for(var S=g.x,T=y.x,R=v.x,D=g.y,B=y.y,N=v.y,V=S<T?S<R?S:R:T<R?T:R,q=D<B?D<N?D:N:B<N?B:N,te=S>T?S>R?S:R:T>R?T:R,Q=D>B?D>N?D:N:B>N?B:N,_e=og(V,q,n,o,h),Ee=og(te,Q,n,o,h),pe=s.prevZ,Re=s.nextZ;pe&&pe.z>=_e&&Re&&Re.z<=Ee;){if(pe.x>=V&&pe.x<=te&&pe.y>=q&&pe.y<=Q&&pe!==g&&pe!==v&&dc(S,D,T,B,R,N,pe.x,pe.y)&&pi(pe.prev,pe,pe.next)>=0||(pe=pe.prevZ,Re.x>=V&&Re.x<=te&&Re.y>=q&&Re.y<=Q&&Re!==g&&Re!==v&&dc(S,D,T,B,R,N,Re.x,Re.y)&&pi(Re.prev,Re,Re.next)>=0))return!1;Re=Re.nextZ}for(;pe&&pe.z>=_e;){if(pe.x>=V&&pe.x<=te&&pe.y>=q&&pe.y<=Q&&pe!==g&&pe!==v&&dc(S,D,T,B,R,N,pe.x,pe.y)&&pi(pe.prev,pe,pe.next)>=0)return!1;pe=pe.prevZ}for(;Re&&Re.z<=Ee;){if(Re.x>=V&&Re.x<=te&&Re.y>=q&&Re.y<=Q&&Re!==g&&Re!==v&&dc(S,D,T,B,R,N,Re.x,Re.y)&&pi(Re.prev,Re,Re.next)>=0)return!1;Re=Re.nextZ}return!0}function wC(s,n,o){var h=s;do{var g=h.prev,y=h.next.next;!gf(g,y)&&I0(g,h,h.next,y)&&nh(g,y)&&nh(y,g)&&(n.push(g.i/o|0),n.push(h.i/o|0),n.push(y.i/o|0),ih(h),ih(h.next),h=s=y),h=h.next}while(h!==s);return tl(h)}function SC(s,n,o,h,g,y){var v=s;do{for(var S=v.next.next;S!==v.prev;){if(v.i!==S.i&&kC(v,S)){var T=k0(v,S);return v=tl(v,v.next),T=tl(T,T.next),th(v,n,o,h,g,y,0),void th(T,n,o,h,g,y,0)}S=S.next}v=v.next}while(v!==s)}function EC(s,n){return s.x-n.x}function TC(s,n){var o=function(g,y){var v,S=y,T=g.x,R=g.y,D=-1/0;do{if(R<=S.y&&R>=S.next.y&&S.next.y!==S.y){var B=S.x+(R-S.y)*(S.next.x-S.x)/(S.next.y-S.y);if(B<=T&&B>D&&(D=B,v=S.x<S.next.x?S:S.next,B===T))return v}S=S.next}while(S!==y);if(!v)return null;var N,V=v,q=v.x,te=v.y,Q=1/0;S=v;do T>=S.x&&S.x>=q&&T!==S.x&&dc(R<te?T:D,R,q,te,R<te?D:T,R,S.x,S.y)&&(N=Math.abs(R-S.y)/(T-S.x),nh(S,g)&&(N<Q||N===Q&&(S.x>v.x||S.x===v.x&&CC(v,S)))&&(v=S,Q=N)),S=S.next;while(S!==V);return v}(s,n);if(!o)return n;var h=k0(o,s);return tl(h,h.next),tl(o,o.next)}function CC(s,n){return pi(s.prev,s,n.prev)<0&&pi(n.next,s,s.next)<0}function og(s,n,o,h,g){return(s=1431655765&((s=858993459&((s=252645135&((s=16711935&((s=(s-o)*g|0)|s<<8))|s<<4))|s<<2))|s<<1))|(n=1431655765&((n=858993459&((n=252645135&((n=16711935&((n=(n-h)*g|0)|n<<8))|n<<4))|n<<2))|n<<1))<<1}function IC(s){var n=s,o=s;do(n.x<o.x||n.x===o.x&&n.y<o.y)&&(o=n),n=n.next;while(n!==s);return o}function dc(s,n,o,h,g,y,v,S){return(g-v)*(n-S)>=(s-v)*(y-S)&&(s-v)*(h-S)>=(o-v)*(n-S)&&(o-v)*(y-S)>=(g-v)*(h-S)}function kC(s,n){return s.next.i!==n.i&&s.prev.i!==n.i&&!function(o,h){var g=o;do{if(g.i!==o.i&&g.next.i!==o.i&&g.i!==h.i&&g.next.i!==h.i&&I0(g,g.next,o,h))return!0;g=g.next}while(g!==o);return!1}(s,n)&&(nh(s,n)&&nh(n,s)&&function(o,h){var g=o,y=!1,v=(o.x+h.x)/2,S=(o.y+h.y)/2;do g.y>S!=g.next.y>S&&g.next.y!==g.y&&v<(g.next.x-g.x)*(S-g.y)/(g.next.y-g.y)+g.x&&(y=!y),g=g.next;while(g!==o);return y}(s,n)&&(pi(s.prev,s,n.prev)||pi(s,n.prev,n))||gf(s,n)&&pi(s.prev,s,s.next)>0&&pi(n.prev,n,n.next)>0)}function pi(s,n,o){return(n.y-s.y)*(o.x-n.x)-(n.x-s.x)*(o.y-n.y)}function gf(s,n){return s.x===n.x&&s.y===n.y}function I0(s,n,o,h){var g=yf(pi(s,n,o)),y=yf(pi(s,n,h)),v=yf(pi(o,h,s)),S=yf(pi(o,h,n));return g!==y&&v!==S||!(g!==0||!_f(s,o,n))||!(y!==0||!_f(s,h,n))||!(v!==0||!_f(o,s,h))||!(S!==0||!_f(o,n,h))}function _f(s,n,o){return n.x<=Math.max(s.x,o.x)&&n.x>=Math.min(s.x,o.x)&&n.y<=Math.max(s.y,o.y)&&n.y>=Math.min(s.y,o.y)}function yf(s){return s>0?1:s<0?-1:0}function nh(s,n){return pi(s.prev,s,s.next)<0?pi(s,n,s.next)>=0&&pi(s,s.prev,n)>=0:pi(s,n,s.prev)<0||pi(s,s.next,n)<0}function k0(s,n){var o=new lg(s.i,s.x,s.y),h=new lg(n.i,n.x,n.y),g=s.next,y=n.prev;return s.next=n,n.prev=s,o.next=g,g.prev=o,h.next=o,o.prev=h,y.next=h,h.prev=y,h}function A0(s,n,o,h){var g=new lg(s,n,o);return h?(g.next=h.next,g.prev=h,h.next.prev=g,h.next=g):(g.prev=g,g.next=g),g}function ih(s){s.next.prev=s.prev,s.prev.next=s.next,s.prevZ&&(s.prevZ.nextZ=s.nextZ),s.nextZ&&(s.nextZ.prevZ=s.prevZ)}function lg(s,n,o){this.i=s,this.x=n,this.y=o,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function cg(s,n,o,h){for(var g=0,y=n,v=o-h;y<o;y+=h)g+=(s[v]-s[y])*(s[y+1]+s[v+1]),v=y;return g}ag.exports=mf,ag.exports.default=mf,mf.deviation=function(s,n,o,h){var g=n&&n.length,y=Math.abs(cg(s,0,g?n[0]*o:s.length,o));if(g)for(var v=0,S=n.length;v<S;v++)y-=Math.abs(cg(s,n[v]*o,v<S-1?n[v+1]*o:s.length,o));var T=0;for(v=0;v<h.length;v+=3){var R=h[v]*o,D=h[v+1]*o,B=h[v+2]*o;T+=Math.abs((s[R]-s[B])*(s[D+1]-s[R+1])-(s[R]-s[D])*(s[B+1]-s[R+1]))}return y===0&&T===0?0:Math.abs((T-y)/y)},mf.flatten=function(s){for(var n=s[0][0].length,o={vertices:[],holes:[],dimensions:n},h=0,g=0;g<s.length;g++){for(var y=0;y<s[g].length;y++)for(var v=0;v<n;v++)o.vertices.push(s[g][y][v]);g>0&&o.holes.push(h+=s[g-1].length)}return o};var P0=b(ag.exports);function AC(s,n,o,h,g){R0(s,n,o||0,h||s.length-1,g||PC)}function R0(s,n,o,h,g){for(;h>o;){if(h-o>600){var y=h-o+1,v=n-o+1,S=Math.log(y),T=.5*Math.exp(2*S/3),R=.5*Math.sqrt(S*T*(y-T)/y)*(v-y/2<0?-1:1);R0(s,n,Math.max(o,Math.floor(n-v*T/y+R)),Math.min(h,Math.floor(n+(y-v)*T/y+R)),g)}var D=s[n],B=o,N=h;for(rh(s,o,n),g(s[h],D)>0&&rh(s,o,h);B<N;){for(rh(s,B,N),B++,N--;g(s[B],D)<0;)B++;for(;g(s[N],D)>0;)N--}g(s[o],D)===0?rh(s,o,N):rh(s,++N,h),N<=n&&(o=N+1),n<=N&&(h=N-1)}}function rh(s,n,o){var h=s[n];s[n]=s[o],s[o]=h}function PC(s,n){return s<n?-1:s>n?1:0}function ug(s,n){const o=s.length;if(o<=1)return[s];const h=[];let g,y;for(let v=0;v<o;v++){const S=we(s[v]);S!==0&&(s[v].area=Math.abs(S),y===void 0&&(y=S<0),y===S<0?(g&&h.push(g),g=[s[v]]):g.push(s[v]))}if(g&&h.push(g),n>1)for(let v=0;v<h.length;v++)h[v].length<=n||(AC(h[v],n,1,h[v].length-1,RC),h[v]=h[v].slice(0,n));return h}function RC(s,n){return n.area-s.area}function hg(s,n,o){const h=o.patternDependencies;let g=!1;for(const y of n){const v=y.paint.get(`${s}-pattern`);v.isConstant()||(g=!0);const S=v.constantOr(null);S&&(g=!0,h[S.to]=!0,h[S.from]=!0)}return g}function dg(s,n,o,h,g){const y=g.patternDependencies;for(const v of n){const S=v.paint.get(`${s}-pattern`).value;if(S.kind!=="constant"){let T=S.evaluate({zoom:h-1},o,{},g.availableImages),R=S.evaluate({zoom:h},o,{},g.availableImages),D=S.evaluate({zoom:h+1},o,{},g.availableImages);T=T&&T.name?T.name:T,R=R&&R.name?R.name:R,D=D&&D.name?D.name:D,y[T]=!0,y[R]=!0,y[D]=!0,o.patterns[v.id]={min:T,mid:R,max:D}}}return o}class fg{constructor(n){this.zoom=n.zoom,this.overscaling=n.overscaling,this.layers=n.layers,this.layerIds=this.layers.map(o=>o.id),this.index=n.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new J,this.indexArray=new it,this.indexArray2=new St,this.programConfigurations=new Ds(n.layers,n.zoom),this.segments=new gt,this.segments2=new gt,this.stateDependentLayerIds=this.layers.filter(o=>o.isStateDependent()).map(o=>o.id)}populate(n,o,h){this.hasPattern=hg("fill",this.layers,o);const g=this.layers[0].layout.get("fill-sort-key"),y=!g.isConstant(),v=[];for(const{feature:S,id:T,index:R,sourceLayerIndex:D}of n){const B=this.layers[0]._featureFilter.needGeometry,N=el(S,B);if(!this.layers[0]._featureFilter.filter(new Wn(this.zoom),N,h))continue;const V=y?g.evaluate(N,{},h,o.availableImages):void 0,q={id:T,properties:S.properties,type:S.type,sourceLayerIndex:D,index:R,geometry:B?N.geometry:Ls(S),patterns:{},sortKey:V};v.push(q)}y&&v.sort((S,T)=>S.sortKey-T.sortKey);for(const S of v){const{geometry:T,index:R,sourceLayerIndex:D}=S;if(this.hasPattern){const B=dg("fill",this.layers,S,this.zoom,o);this.patternFeatures.push(B)}else this.addFeature(S,T,R,h,{});o.featureIndex.insert(n[R].feature,T,R,D,this.index)}}update(n,o,h){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(n,o,this.stateDependentLayers,h)}addFeatures(n,o,h){for(const g of this.patternFeatures)this.addFeature(g,g.geometry,g.index,o,h)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(n){this.uploaded||(this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,vC),this.indexBuffer=n.createIndexBuffer(this.indexArray),this.indexBuffer2=n.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(n),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(n,o,h,g,y){for(const v of ug(o,500)){let S=0;for(const V of v)S+=V.length;const T=this.segments.prepareSegment(S,this.layoutVertexArray,this.indexArray),R=T.vertexLength,D=[],B=[];for(const V of v){if(V.length===0)continue;V!==v[0]&&B.push(D.length/2);const q=this.segments2.prepareSegment(V.length,this.layoutVertexArray,this.indexArray2),te=q.vertexLength;this.layoutVertexArray.emplaceBack(V[0].x,V[0].y),this.indexArray2.emplaceBack(te+V.length-1,te),D.push(V[0].x),D.push(V[0].y);for(let Q=1;Q<V.length;Q++)this.layoutVertexArray.emplaceBack(V[Q].x,V[Q].y),this.indexArray2.emplaceBack(te+Q-1,te+Q),D.push(V[Q].x),D.push(V[Q].y);q.vertexLength+=V.length,q.primitiveLength+=V.length}const N=P0(D,B);for(let V=0;V<N.length;V+=3)this.indexArray.emplaceBack(R+N[V],R+N[V+1],R+N[V+2]);T.vertexLength+=S,T.primitiveLength+=N.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,n,h,y,g)}}let M0,D0;At("FillBucket",fg,{omit:["layers","patternFeatures"]});var MC={get paint(){return D0=D0||new dr({"fill-antialias":new zt(W.paint_fill["fill-antialias"]),"fill-opacity":new Ht(W.paint_fill["fill-opacity"]),"fill-color":new Ht(W.paint_fill["fill-color"]),"fill-outline-color":new Ht(W.paint_fill["fill-outline-color"]),"fill-translate":new zt(W.paint_fill["fill-translate"]),"fill-translate-anchor":new zt(W.paint_fill["fill-translate-anchor"]),"fill-pattern":new Xo(W.paint_fill["fill-pattern"])})},get layout(){return M0=M0||new dr({"fill-sort-key":new Ht(W.layout_fill["fill-sort-key"])})}};const DC=vi([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),LC=vi([{name:"a_centroid",components:2,type:"Int16"}],4),{members:zC}=DC;var no={},OC=w,L0=fc;function fc(s,n,o,h,g){this.properties={},this.extent=o,this.type=0,this._pbf=s,this._geometry=-1,this._keys=h,this._values=g,s.readFields(BC,this,n)}function BC(s,n,o){s==1?n.id=o.readVarint():s==2?function(h,g){for(var y=h.readVarint()+h.pos;h.pos<y;){var v=g._keys[h.readVarint()],S=g._values[h.readVarint()];g.properties[v]=S}}(o,n):s==3?n.type=o.readVarint():s==4&&(n._geometry=o.pos)}function FC(s){for(var n,o,h=0,g=0,y=s.length,v=y-1;g<y;v=g++)h+=((o=s[v]).x-(n=s[g]).x)*(n.y+o.y);return h}fc.types=["Unknown","Point","LineString","Polygon"],fc.prototype.loadGeometry=function(){var s=this._pbf;s.pos=this._geometry;for(var n,o=s.readVarint()+s.pos,h=1,g=0,y=0,v=0,S=[];s.pos<o;){if(g<=0){var T=s.readVarint();h=7&T,g=T>>3}if(g--,h===1||h===2)y+=s.readSVarint(),v+=s.readSVarint(),h===1&&(n&&S.push(n),n=[]),n.push(new OC(y,v));else{if(h!==7)throw new Error("unknown command "+h);n&&n.push(n[0].clone())}}return n&&S.push(n),S},fc.prototype.bbox=function(){var s=this._pbf;s.pos=this._geometry;for(var n=s.readVarint()+s.pos,o=1,h=0,g=0,y=0,v=1/0,S=-1/0,T=1/0,R=-1/0;s.pos<n;){if(h<=0){var D=s.readVarint();o=7&D,h=D>>3}if(h--,o===1||o===2)(g+=s.readSVarint())<v&&(v=g),g>S&&(S=g),(y+=s.readSVarint())<T&&(T=y),y>R&&(R=y);else if(o!==7)throw new Error("unknown command "+o)}return[v,T,S,R]},fc.prototype.toGeoJSON=function(s,n,o){var h,g,y=this.extent*Math.pow(2,o),v=this.extent*s,S=this.extent*n,T=this.loadGeometry(),R=fc.types[this.type];function D(V){for(var q=0;q<V.length;q++){var te=V[q];V[q]=[360*(te.x+v)/y-180,360/Math.PI*Math.atan(Math.exp((180-360*(te.y+S)/y)*Math.PI/180))-90]}}switch(this.type){case 1:var B=[];for(h=0;h<T.length;h++)B[h]=T[h][0];D(T=B);break;case 2:for(h=0;h<T.length;h++)D(T[h]);break;case 3:for(T=function(V){var q=V.length;if(q<=1)return[V];for(var te,Q,_e=[],Ee=0;Ee<q;Ee++){var pe=FC(V[Ee]);pe!==0&&(Q===void 0&&(Q=pe<0),Q===pe<0?(te&&_e.push(te),te=[V[Ee]]):te.push(V[Ee]))}return te&&_e.push(te),_e}(T),h=0;h<T.length;h++)for(g=0;g<T[h].length;g++)D(T[h][g])}T.length===1?T=T[0]:R="Multi"+R;var N={type:"Feature",geometry:{type:R,coordinates:T},properties:this.properties};return"id"in this&&(N.id=this.id),N};var NC=L0,z0=O0;function O0(s,n){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=s,this._keys=[],this._values=[],this._features=[],s.readFields(UC,this,n),this.length=this._features.length}function UC(s,n,o){s===15?n.version=o.readVarint():s===1?n.name=o.readString():s===5?n.extent=o.readVarint():s===2?n._features.push(o.pos):s===3?n._keys.push(o.readString()):s===4&&n._values.push(function(h){for(var g=null,y=h.readVarint()+h.pos;h.pos<y;){var v=h.readVarint()>>3;g=v===1?h.readString():v===2?h.readFloat():v===3?h.readDouble():v===4?h.readVarint64():v===5?h.readVarint():v===6?h.readSVarint():v===7?h.readBoolean():null}return g}(o))}O0.prototype.feature=function(s){if(s<0||s>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[s];var n=this._pbf.readVarint()+this._pbf.pos;return new NC(this._pbf,n,this.extent,this._keys,this._values)};var $C=z0;function VC(s,n,o){if(s===3){var h=new $C(o,o.readVarint()+o.pos);h.length&&(n[h.name]=h)}}no.VectorTile=function(s,n){this.layers=s.readFields(VC,{},n)},no.VectorTileFeature=L0,no.VectorTileLayer=z0;const jC=no.VectorTileFeature.types,pg=Math.pow(2,13);function sh(s,n,o,h,g,y,v,S){s.emplaceBack(n,o,2*Math.floor(h*pg)+v,g*pg*2,y*pg*2,Math.round(S))}class mg{constructor(n){this.zoom=n.zoom,this.overscaling=n.overscaling,this.layers=n.layers,this.layerIds=this.layers.map(o=>o.id),this.index=n.index,this.hasPattern=!1,this.layoutVertexArray=new se,this.centroidVertexArray=new ee,this.indexArray=new it,this.programConfigurations=new Ds(n.layers,n.zoom),this.segments=new gt,this.stateDependentLayerIds=this.layers.filter(o=>o.isStateDependent()).map(o=>o.id)}populate(n,o,h){this.features=[],this.hasPattern=hg("fill-extrusion",this.layers,o);for(const{feature:g,id:y,index:v,sourceLayerIndex:S}of n){const T=this.layers[0]._featureFilter.needGeometry,R=el(g,T);if(!this.layers[0]._featureFilter.filter(new Wn(this.zoom),R,h))continue;const D={id:y,sourceLayerIndex:S,index:v,geometry:T?R.geometry:Ls(g),properties:g.properties,type:g.type,patterns:{}};this.hasPattern?this.features.push(dg("fill-extrusion",this.layers,D,this.zoom,o)):this.addFeature(D,D.geometry,v,h,{}),o.featureIndex.insert(g,D.geometry,v,S,this.index,!0)}}addFeatures(n,o,h){for(const g of this.features){const{geometry:y}=g;this.addFeature(g,y,g.index,o,h)}}update(n,o,h){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(n,o,this.stateDependentLayers,h)}isEmpty(){return this.layoutVertexArray.length===0&&this.centroidVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(n){this.uploaded||(this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,zC),this.centroidVertexBuffer=n.createVertexBuffer(this.centroidVertexArray,LC.members,!0),this.indexBuffer=n.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(n),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(n,o,h,g,y){const v={x:0,y:0,vertexCount:0};for(const S of ug(o,500)){let T=0;for(const q of S)T+=q.length;let R=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray);for(const q of S){if(q.length===0||qC(q))continue;let te=0;for(let Q=0;Q<q.length;Q++){const _e=q[Q];if(Q>=1){const Ee=q[Q-1];if(!GC(_e,Ee)){R.vertexLength+4>gt.MAX_VERTEX_ARRAY_LENGTH&&(R=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const pe=_e.sub(Ee)._perp()._unit(),Re=Ee.dist(_e);te+Re>32768&&(te=0),sh(this.layoutVertexArray,_e.x,_e.y,pe.x,pe.y,0,0,te),sh(this.layoutVertexArray,_e.x,_e.y,pe.x,pe.y,0,1,te),v.x+=2*_e.x,v.y+=2*_e.y,v.vertexCount+=2,te+=Re,sh(this.layoutVertexArray,Ee.x,Ee.y,pe.x,pe.y,0,0,te),sh(this.layoutVertexArray,Ee.x,Ee.y,pe.x,pe.y,0,1,te),v.x+=2*Ee.x,v.y+=2*Ee.y,v.vertexCount+=2;const ze=R.vertexLength;this.indexArray.emplaceBack(ze,ze+2,ze+1),this.indexArray.emplaceBack(ze+1,ze+2,ze+3),R.vertexLength+=4,R.primitiveLength+=2}}}}if(R.vertexLength+T>gt.MAX_VERTEX_ARRAY_LENGTH&&(R=this.segments.prepareSegment(T,this.layoutVertexArray,this.indexArray)),jC[n.type]!=="Polygon")continue;const D=[],B=[],N=R.vertexLength;for(const q of S)if(q.length!==0){q!==S[0]&&B.push(D.length/2);for(let te=0;te<q.length;te++){const Q=q[te];sh(this.layoutVertexArray,Q.x,Q.y,0,0,1,1,0),v.x+=Q.x,v.y+=Q.y,v.vertexCount+=1,D.push(Q.x),D.push(Q.y)}}const V=P0(D,B);for(let q=0;q<V.length;q+=3)this.indexArray.emplaceBack(N+V[q],N+V[q+2],N+V[q+1]);R.primitiveLength+=V.length/3,R.vertexLength+=T}for(let S=0;S<v.vertexCount;S++)this.centroidVertexArray.emplaceBack(Math.floor(v.x/v.vertexCount),Math.floor(v.y/v.vertexCount));this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,n,h,y,g)}}function GC(s,n){return s.x===n.x&&(s.x<0||s.x>Gn)||s.y===n.y&&(s.y<0||s.y>Gn)}function qC(s){return s.every(n=>n.x<0)||s.every(n=>n.x>Gn)||s.every(n=>n.y<0)||s.every(n=>n.y>Gn)}let B0;At("FillExtrusionBucket",mg,{omit:["layers","features"]});var HC={get paint(){return B0=B0||new dr({"fill-extrusion-opacity":new zt(W["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Ht(W["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new zt(W["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new zt(W["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Xo(W["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Ht(W["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Ht(W["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new zt(W["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})}};function ah(s,n){return s.x*n.x+s.y*n.y}function F0(s,n){if(s.length===1){let o=0;const h=n[o++];let g;for(;!g||h.equals(g);)if(g=n[o++],!g)return 1/0;for(;o<n.length;o++){const y=n[o],v=s[0],S=g.sub(h),T=y.sub(h),R=v.sub(h),D=ah(S,S),B=ah(S,T),N=ah(T,T),V=ah(R,S),q=ah(R,T),te=D*N-B*B,Q=(N*V-B*q)/te,_e=(D*q-B*V)/te,Ee=h.z*(1-Q-_e)+g.z*Q+y.z*_e;if(isFinite(Ee))return Ee}return 1/0}{let o=1/0;for(const h of n)o=Math.min(o,h.z);return o}}const WC=vi([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:ZC}=WC,YC=vi([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:XC}=YC,KC=no.VectorTileFeature.types,JC=Math.cos(Math.PI/180*37.5),N0=Math.pow(2,14)/.5;class gg{constructor(n){this.zoom=n.zoom,this.overscaling=n.overscaling,this.layers=n.layers,this.layerIds=this.layers.map(o=>o.id),this.index=n.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(o=>{this.gradients[o.id]={}}),this.layoutVertexArray=new ge,this.layoutVertexArray2=new Me,this.indexArray=new it,this.programConfigurations=new Ds(n.layers,n.zoom),this.segments=new gt,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(o=>o.isStateDependent()).map(o=>o.id)}populate(n,o,h){this.hasPattern=hg("line",this.layers,o);const g=this.layers[0].layout.get("line-sort-key"),y=!g.isConstant(),v=[];for(const{feature:S,id:T,index:R,sourceLayerIndex:D}of n){const B=this.layers[0]._featureFilter.needGeometry,N=el(S,B);if(!this.layers[0]._featureFilter.filter(new Wn(this.zoom),N,h))continue;const V=y?g.evaluate(N,{},h):void 0,q={id:T,properties:S.properties,type:S.type,sourceLayerIndex:D,index:R,geometry:B?N.geometry:Ls(S),patterns:{},sortKey:V};v.push(q)}y&&v.sort((S,T)=>S.sortKey-T.sortKey);for(const S of v){const{geometry:T,index:R,sourceLayerIndex:D}=S;if(this.hasPattern){const B=dg("line",this.layers,S,this.zoom,o);this.patternFeatures.push(B)}else this.addFeature(S,T,R,h,{});o.featureIndex.insert(n[R].feature,T,R,D,this.index)}}update(n,o,h){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(n,o,this.stateDependentLayers,h)}addFeatures(n,o,h){for(const g of this.patternFeatures)this.addFeature(g,g.geometry,g.index,o,h)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(n){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=n.createVertexBuffer(this.layoutVertexArray2,XC)),this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,ZC),this.indexBuffer=n.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(n),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(n){if(n.properties&&Object.prototype.hasOwnProperty.call(n.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(n.properties,"mapbox_clip_end"))return{start:+n.properties.mapbox_clip_start,end:+n.properties.mapbox_clip_end}}addFeature(n,o,h,g,y){const v=this.layers[0].layout,S=v.get("line-join").evaluate(n,{}),T=v.get("line-cap"),R=v.get("line-miter-limit"),D=v.get("line-round-limit");this.lineClips=this.lineFeatureClips(n);for(const B of o)this.addLine(B,n,S,T,R,D);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,n,h,y,g)}addLine(n,o,h,g,y,v){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let _e=0;_e<n.length-1;_e++)this.totalDistance+=n[_e].dist(n[_e+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const S=KC[o.type]==="Polygon";let T=n.length;for(;T>=2&&n[T-1].equals(n[T-2]);)T--;let R=0;for(;R<T-1&&n[R].equals(n[R+1]);)R++;if(T<(S?3:2))return;h==="bevel"&&(y=1.05);const D=this.overscaling<=16?15*Gn/(512*this.overscaling):0,B=this.segments.prepareSegment(10*T,this.layoutVertexArray,this.indexArray);let N,V,q,te,Q;this.e1=this.e2=-1,S&&(N=n[T-2],Q=n[R].sub(N)._unit()._perp());for(let _e=R;_e<T;_e++){if(q=_e===T-1?S?n[R+1]:void 0:n[_e+1],q&&n[_e].equals(q))continue;Q&&(te=Q),N&&(V=N),N=n[_e],Q=q?q.sub(N)._unit()._perp():te,te=te||Q;let Ee=te.add(Q);Ee.x===0&&Ee.y===0||Ee._unit();const pe=te.x*Q.x+te.y*Q.y,Re=Ee.x*Q.x+Ee.y*Q.y,ze=Re!==0?1/Re:1/0,We=2*Math.sqrt(2-2*Re),Tt=Re<JC&&V&&q,Rt=te.x*Q.y-te.y*Q.x>0;if(Tt&&_e>R){const pt=N.dist(V);if(pt>2*D){const bt=N.sub(N.sub(V)._mult(D/pt)._round());this.updateDistance(V,bt),this.addCurrentVertex(bt,te,0,0,B),V=bt}}const xt=V&&q;let _t=xt?h:S?"butt":g;if(xt&&_t==="round"&&(ze<v?_t="miter":ze<=2&&(_t="fakeround")),_t==="miter"&&ze>y&&(_t="bevel"),_t==="bevel"&&(ze>2&&(_t="flipbevel"),ze<y&&(_t="miter")),V&&this.updateDistance(V,N),_t==="miter")Ee._mult(ze),this.addCurrentVertex(N,Ee,0,0,B);else if(_t==="flipbevel"){if(ze>100)Ee=Q.mult(-1);else{const pt=ze*te.add(Q).mag()/te.sub(Q).mag();Ee._perp()._mult(pt*(Rt?-1:1))}this.addCurrentVertex(N,Ee,0,0,B),this.addCurrentVertex(N,Ee.mult(-1),0,0,B)}else if(_t==="bevel"||_t==="fakeround"){const pt=-Math.sqrt(ze*ze-1),bt=Rt?pt:0,yt=Rt?0:pt;if(V&&this.addCurrentVertex(N,te,bt,yt,B),_t==="fakeround"){const lt=Math.round(180*We/Math.PI/20);for(let $t=1;$t<lt;$t++){let Dt=$t/lt;if(Dt!==.5){const qn=Dt-.5;Dt+=Dt*qn*(Dt-1)*((1.0904+pe*(pe*(3.55645-1.43519*pe)-3.2452))*qn*qn+(.848013+pe*(.215638*pe-1.06021)))}const an=Q.sub(te)._mult(Dt)._add(te)._unit()._mult(Rt?-1:1);this.addHalfVertex(N,an.x,an.y,!1,Rt,0,B)}}q&&this.addCurrentVertex(N,Q,-bt,-yt,B)}else if(_t==="butt")this.addCurrentVertex(N,Ee,0,0,B);else if(_t==="square"){const pt=V?1:-1;this.addCurrentVertex(N,Ee,pt,pt,B)}else _t==="round"&&(V&&(this.addCurrentVertex(N,te,0,0,B),this.addCurrentVertex(N,te,1,1,B,!0)),q&&(this.addCurrentVertex(N,Q,-1,-1,B,!0),this.addCurrentVertex(N,Q,0,0,B)));if(Tt&&_e<T-1){const pt=N.dist(q);if(pt>2*D){const bt=N.add(q.sub(N)._mult(D/pt)._round());this.updateDistance(N,bt),this.addCurrentVertex(bt,Q,0,0,B),N=bt}}}}addCurrentVertex(n,o,h,g,y,v=!1){const S=o.y*g-o.x,T=-o.y-o.x*g;this.addHalfVertex(n,o.x+o.y*h,o.y-o.x*h,v,!1,h,y),this.addHalfVertex(n,S,T,v,!0,-g,y),this.distance>N0/2&&this.totalDistance===0&&(this.distance=0,this.updateScaledDistance(),this.addCurrentVertex(n,o,h,g,y,v))}addHalfVertex({x:n,y:o},h,g,y,v,S,T){const R=.5*(this.lineClips?this.scaledDistance*(N0-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((n<<1)+(y?1:0),(o<<1)+(v?1:0),Math.round(63*h)+128,Math.round(63*g)+128,1+(S===0?0:S<0?-1:1)|(63&R)<<2,R>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);const D=T.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,D),T.primitiveLength++),v?this.e2=D:this.e1=D}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(n,o){this.distance+=n.dist(o),this.updateScaledDistance()}}let U0,$0;At("LineBucket",gg,{omit:["layers","patternFeatures"]});var V0={get paint(){return $0=$0||new dr({"line-opacity":new Ht(W.paint_line["line-opacity"]),"line-color":new Ht(W.paint_line["line-color"]),"line-translate":new zt(W.paint_line["line-translate"]),"line-translate-anchor":new zt(W.paint_line["line-translate-anchor"]),"line-width":new Ht(W.paint_line["line-width"]),"line-gap-width":new Ht(W.paint_line["line-gap-width"]),"line-offset":new Ht(W.paint_line["line-offset"]),"line-blur":new Ht(W.paint_line["line-blur"]),"line-dasharray":new qu(W.paint_line["line-dasharray"]),"line-pattern":new Xo(W.paint_line["line-pattern"]),"line-gradient":new Hu(W.paint_line["line-gradient"])})},get layout(){return U0=U0||new dr({"line-cap":new zt(W.layout_line["line-cap"]),"line-join":new Ht(W.layout_line["line-join"]),"line-miter-limit":new zt(W.layout_line["line-miter-limit"]),"line-round-limit":new zt(W.layout_line["line-round-limit"]),"line-sort-key":new Ht(W.layout_line["line-sort-key"])})}};class QC extends Ht{possiblyEvaluate(n,o){return o=new Wn(Math.floor(o.zoom),{now:o.now,fadeDuration:o.fadeDuration,zoomHistory:o.zoomHistory,transition:o.transition}),super.possiblyEvaluate(n,o)}evaluate(n,o,h,g){return o=ye({},o,{zoom:Math.floor(o.zoom)}),super.evaluate(n,o,h,g)}}let vf;function j0(s,n){return n>0?n+2*s:s}const eI=vi([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),tI=vi([{name:"a_projected_pos",components:3,type:"Float32"}],4);vi([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const nI=vi([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]);vi([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const G0=vi([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),iI=vi([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function rI(s,n,o){return s.sections.forEach(h=>{h.text=function(g,y,v){const S=y.layout.get("text-transform").evaluate(v,{});return S==="uppercase"?g=g.toLocaleUpperCase():S==="lowercase"&&(g=g.toLocaleLowerCase()),jr.applyArabicShaping&&(g=jr.applyArabicShaping(g)),g}(h.text,n,o)}),s}vi([{name:"triangle",components:3,type:"Uint16"}]),vi([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),vi([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),vi([{type:"Float32",name:"offsetX"}]),vi([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);const oh={"!":"","#":"",$:"","%":"","&":"","(":"",")":"","*":"","+":"",",":"","-":"",".":"","/":"",":":"",";":"","<":"","=":"",">":"","?":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""};var Di=24,q0=On,H0=function(s,n,o,h,g){var y,v,S=8*g-h-1,T=(1<<S)-1,R=T>>1,D=-7,B=o?g-1:0,N=o?-1:1,V=s[n+B];for(B+=N,y=V&(1<<-D)-1,V>>=-D,D+=S;D>0;y=256*y+s[n+B],B+=N,D-=8);for(v=y&(1<<-D)-1,y>>=-D,D+=h;D>0;v=256*v+s[n+B],B+=N,D-=8);if(y===0)y=1-R;else{if(y===T)return v?NaN:1/0*(V?-1:1);v+=Math.pow(2,h),y-=R}return(V?-1:1)*v*Math.pow(2,y-h)},W0=function(s,n,o,h,g,y){var v,S,T,R=8*y-g-1,D=(1<<R)-1,B=D>>1,N=g===23?Math.pow(2,-24)-Math.pow(2,-77):0,V=h?0:y-1,q=h?1:-1,te=n<0||n===0&&1/n<0?1:0;for(n=Math.abs(n),isNaN(n)||n===1/0?(S=isNaN(n)?1:0,v=D):(v=Math.floor(Math.log(n)/Math.LN2),n*(T=Math.pow(2,-v))<1&&(v--,T*=2),(n+=v+B>=1?N/T:N*Math.pow(2,1-B))*T>=2&&(v++,T/=2),v+B>=D?(S=0,v=D):v+B>=1?(S=(n*T-1)*Math.pow(2,g),v+=B):(S=n*Math.pow(2,B-1)*Math.pow(2,g),v=0));g>=8;s[o+V]=255&S,V+=q,S/=256,g-=8);for(v=v<<g|S,R+=g;R>0;s[o+V]=255&v,V+=q,v/=256,R-=8);s[o+V-q]|=128*te};function On(s){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(s)?s:new Uint8Array(s||0),this.pos=0,this.type=0,this.length=this.buf.length}On.Varint=0,On.Fixed64=1,On.Bytes=2,On.Fixed32=5;var _g=4294967296,Z0=1/_g,Y0=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function Sa(s){return s.type===On.Bytes?s.readVarint()+s.pos:s.pos+1}function pc(s,n,o){return o?4294967296*n+(s>>>0):4294967296*(n>>>0)+(s>>>0)}function X0(s,n,o){var h=n<=16383?1:n<=2097151?2:n<=268435455?3:Math.floor(Math.log(n)/(7*Math.LN2));o.realloc(h);for(var g=o.pos-1;g>=s;g--)o.buf[g+h]=o.buf[g]}function sI(s,n){for(var o=0;o<s.length;o++)n.writeVarint(s[o])}function aI(s,n){for(var o=0;o<s.length;o++)n.writeSVarint(s[o])}function oI(s,n){for(var o=0;o<s.length;o++)n.writeFloat(s[o])}function lI(s,n){for(var o=0;o<s.length;o++)n.writeDouble(s[o])}function cI(s,n){for(var o=0;o<s.length;o++)n.writeBoolean(s[o])}function uI(s,n){for(var o=0;o<s.length;o++)n.writeFixed32(s[o])}function hI(s,n){for(var o=0;o<s.length;o++)n.writeSFixed32(s[o])}function dI(s,n){for(var o=0;o<s.length;o++)n.writeFixed64(s[o])}function fI(s,n){for(var o=0;o<s.length;o++)n.writeSFixed64(s[o])}function xf(s,n){return(s[n]|s[n+1]<<8|s[n+2]<<16)+16777216*s[n+3]}function mc(s,n,o){s[o]=n,s[o+1]=n>>>8,s[o+2]=n>>>16,s[o+3]=n>>>24}function K0(s,n){return(s[n]|s[n+1]<<8|s[n+2]<<16)+(s[n+3]<<24)}On.prototype={destroy:function(){this.buf=null},readFields:function(s,n,o){for(o=o||this.length;this.pos<o;){var h=this.readVarint(),g=h>>3,y=this.pos;this.type=7&h,s(g,n,this),this.pos===y&&this.skip(h)}return n},readMessage:function(s,n){return this.readFields(s,n,this.readVarint()+this.pos)},readFixed32:function(){var s=xf(this.buf,this.pos);return this.pos+=4,s},readSFixed32:function(){var s=K0(this.buf,this.pos);return this.pos+=4,s},readFixed64:function(){var s=xf(this.buf,this.pos)+xf(this.buf,this.pos+4)*_g;return this.pos+=8,s},readSFixed64:function(){var s=xf(this.buf,this.pos)+K0(this.buf,this.pos+4)*_g;return this.pos+=8,s},readFloat:function(){var s=H0(this.buf,this.pos,!0,23,4);return this.pos+=4,s},readDouble:function(){var s=H0(this.buf,this.pos,!0,52,8);return this.pos+=8,s},readVarint:function(s){var n,o,h=this.buf;return n=127&(o=h[this.pos++]),o<128?n:(n|=(127&(o=h[this.pos++]))<<7,o<128?n:(n|=(127&(o=h[this.pos++]))<<14,o<128?n:(n|=(127&(o=h[this.pos++]))<<21,o<128?n:function(g,y,v){var S,T,R=v.buf;if(S=(112&(T=R[v.pos++]))>>4,T<128||(S|=(127&(T=R[v.pos++]))<<3,T<128)||(S|=(127&(T=R[v.pos++]))<<10,T<128)||(S|=(127&(T=R[v.pos++]))<<17,T<128)||(S|=(127&(T=R[v.pos++]))<<24,T<128)||(S|=(1&(T=R[v.pos++]))<<31,T<128))return pc(g,S,y);throw new Error("Expected varint not more than 10 bytes")}(n|=(15&(o=h[this.pos]))<<28,s,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var s=this.readVarint();return s%2==1?(s+1)/-2:s/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var s=this.readVarint()+this.pos,n=this.pos;return this.pos=s,s-n>=12&&Y0?function(o,h,g){return Y0.decode(o.subarray(h,g))}(this.buf,n,s):function(o,h,g){for(var y="",v=h;v<g;){var S,T,R,D=o[v],B=null,N=D>239?4:D>223?3:D>191?2:1;if(v+N>g)break;N===1?D<128&&(B=D):N===2?(192&(S=o[v+1]))==128&&(B=(31&D)<<6|63&S)<=127&&(B=null):N===3?(T=o[v+2],(192&(S=o[v+1]))==128&&(192&T)==128&&((B=(15&D)<<12|(63&S)<<6|63&T)<=2047||B>=55296&&B<=57343)&&(B=null)):N===4&&(T=o[v+2],R=o[v+3],(192&(S=o[v+1]))==128&&(192&T)==128&&(192&R)==128&&((B=(15&D)<<18|(63&S)<<12|(63&T)<<6|63&R)<=65535||B>=1114112)&&(B=null)),B===null?(B=65533,N=1):B>65535&&(B-=65536,y+=String.fromCharCode(B>>>10&1023|55296),B=56320|1023&B),y+=String.fromCharCode(B),v+=N}return y}(this.buf,n,s)},readBytes:function(){var s=this.readVarint()+this.pos,n=this.buf.subarray(this.pos,s);return this.pos=s,n},readPackedVarint:function(s,n){if(this.type!==On.Bytes)return s.push(this.readVarint(n));var o=Sa(this);for(s=s||[];this.pos<o;)s.push(this.readVarint(n));return s},readPackedSVarint:function(s){if(this.type!==On.Bytes)return s.push(this.readSVarint());var n=Sa(this);for(s=s||[];this.pos<n;)s.push(this.readSVarint());return s},readPackedBoolean:function(s){if(this.type!==On.Bytes)return s.push(this.readBoolean());var n=Sa(this);for(s=s||[];this.pos<n;)s.push(this.readBoolean());return s},readPackedFloat:function(s){if(this.type!==On.Bytes)return s.push(this.readFloat());var n=Sa(this);for(s=s||[];this.pos<n;)s.push(this.readFloat());return s},readPackedDouble:function(s){if(this.type!==On.Bytes)return s.push(this.readDouble());var n=Sa(this);for(s=s||[];this.pos<n;)s.push(this.readDouble());return s},readPackedFixed32:function(s){if(this.type!==On.Bytes)return s.push(this.readFixed32());var n=Sa(this);for(s=s||[];this.pos<n;)s.push(this.readFixed32());return s},readPackedSFixed32:function(s){if(this.type!==On.Bytes)return s.push(this.readSFixed32());var n=Sa(this);for(s=s||[];this.pos<n;)s.push(this.readSFixed32());return s},readPackedFixed64:function(s){if(this.type!==On.Bytes)return s.push(this.readFixed64());var n=Sa(this);for(s=s||[];this.pos<n;)s.push(this.readFixed64());return s},readPackedSFixed64:function(s){if(this.type!==On.Bytes)return s.push(this.readSFixed64());var n=Sa(this);for(s=s||[];this.pos<n;)s.push(this.readSFixed64());return s},skip:function(s){var n=7&s;if(n===On.Varint)for(;this.buf[this.pos++]>127;);else if(n===On.Bytes)this.pos=this.readVarint()+this.pos;else if(n===On.Fixed32)this.pos+=4;else{if(n!==On.Fixed64)throw new Error("Unimplemented type: "+n);this.pos+=8}},writeTag:function(s,n){this.writeVarint(s<<3|n)},realloc:function(s){for(var n=this.length||16;n<this.pos+s;)n*=2;if(n!==this.length){var o=new Uint8Array(n);o.set(this.buf),this.buf=o,this.length=n}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(s){this.realloc(4),mc(this.buf,s,this.pos),this.pos+=4},writeSFixed32:function(s){this.realloc(4),mc(this.buf,s,this.pos),this.pos+=4},writeFixed64:function(s){this.realloc(8),mc(this.buf,-1&s,this.pos),mc(this.buf,Math.floor(s*Z0),this.pos+4),this.pos+=8},writeSFixed64:function(s){this.realloc(8),mc(this.buf,-1&s,this.pos),mc(this.buf,Math.floor(s*Z0),this.pos+4),this.pos+=8},writeVarint:function(s){(s=+s||0)>268435455||s<0?function(n,o){var h,g;if(n>=0?(h=n%4294967296|0,g=n/4294967296|0):(g=~(-n/4294967296),4294967295^(h=~(-n%4294967296))?h=h+1|0:(h=0,g=g+1|0)),n>=18446744073709552e3||n<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");o.realloc(10),function(y,v,S){S.buf[S.pos++]=127&y|128,y>>>=7,S.buf[S.pos++]=127&y|128,y>>>=7,S.buf[S.pos++]=127&y|128,y>>>=7,S.buf[S.pos++]=127&y|128,S.buf[S.pos]=127&(y>>>=7)}(h,0,o),function(y,v){var S=(7&y)<<4;v.buf[v.pos++]|=S|((y>>>=3)?128:0),y&&(v.buf[v.pos++]=127&y|((y>>>=7)?128:0),y&&(v.buf[v.pos++]=127&y|((y>>>=7)?128:0),y&&(v.buf[v.pos++]=127&y|((y>>>=7)?128:0),y&&(v.buf[v.pos++]=127&y|((y>>>=7)?128:0),y&&(v.buf[v.pos++]=127&y)))))}(g,o)}(s,this):(this.realloc(4),this.buf[this.pos++]=127&s|(s>127?128:0),s<=127||(this.buf[this.pos++]=127&(s>>>=7)|(s>127?128:0),s<=127||(this.buf[this.pos++]=127&(s>>>=7)|(s>127?128:0),s<=127||(this.buf[this.pos++]=s>>>7&127))))},writeSVarint:function(s){this.writeVarint(s<0?2*-s-1:2*s)},writeBoolean:function(s){this.writeVarint(!!s)},writeString:function(s){s=String(s),this.realloc(4*s.length),this.pos++;var n=this.pos;this.pos=function(h,g,y){for(var v,S,T=0;T<g.length;T++){if((v=g.charCodeAt(T))>55295&&v<57344){if(!S){v>56319||T+1===g.length?(h[y++]=239,h[y++]=191,h[y++]=189):S=v;continue}if(v<56320){h[y++]=239,h[y++]=191,h[y++]=189,S=v;continue}v=S-55296<<10|v-56320|65536,S=null}else S&&(h[y++]=239,h[y++]=191,h[y++]=189,S=null);v<128?h[y++]=v:(v<2048?h[y++]=v>>6|192:(v<65536?h[y++]=v>>12|224:(h[y++]=v>>18|240,h[y++]=v>>12&63|128),h[y++]=v>>6&63|128),h[y++]=63&v|128)}return y}(this.buf,s,this.pos);var o=this.pos-n;o>=128&&X0(n,o,this),this.pos=n-1,this.writeVarint(o),this.pos+=o},writeFloat:function(s){this.realloc(4),W0(this.buf,s,this.pos,!0,23,4),this.pos+=4},writeDouble:function(s){this.realloc(8),W0(this.buf,s,this.pos,!0,52,8),this.pos+=8},writeBytes:function(s){var n=s.length;this.writeVarint(n),this.realloc(n);for(var o=0;o<n;o++)this.buf[this.pos++]=s[o]},writeRawMessage:function(s,n){this.pos++;var o=this.pos;s(n,this);var h=this.pos-o;h>=128&&X0(o,h,this),this.pos=o-1,this.writeVarint(h),this.pos+=h},writeMessage:function(s,n,o){this.writeTag(s,On.Bytes),this.writeRawMessage(n,o)},writePackedVarint:function(s,n){n.length&&this.writeMessage(s,sI,n)},writePackedSVarint:function(s,n){n.length&&this.writeMessage(s,aI,n)},writePackedBoolean:function(s,n){n.length&&this.writeMessage(s,cI,n)},writePackedFloat:function(s,n){n.length&&this.writeMessage(s,oI,n)},writePackedDouble:function(s,n){n.length&&this.writeMessage(s,lI,n)},writePackedFixed32:function(s,n){n.length&&this.writeMessage(s,uI,n)},writePackedSFixed32:function(s,n){n.length&&this.writeMessage(s,hI,n)},writePackedFixed64:function(s,n){n.length&&this.writeMessage(s,dI,n)},writePackedSFixed64:function(s,n){n.length&&this.writeMessage(s,fI,n)},writeBytesField:function(s,n){this.writeTag(s,On.Bytes),this.writeBytes(n)},writeFixed32Field:function(s,n){this.writeTag(s,On.Fixed32),this.writeFixed32(n)},writeSFixed32Field:function(s,n){this.writeTag(s,On.Fixed32),this.writeSFixed32(n)},writeFixed64Field:function(s,n){this.writeTag(s,On.Fixed64),this.writeFixed64(n)},writeSFixed64Field:function(s,n){this.writeTag(s,On.Fixed64),this.writeSFixed64(n)},writeVarintField:function(s,n){this.writeTag(s,On.Varint),this.writeVarint(n)},writeSVarintField:function(s,n){this.writeTag(s,On.Varint),this.writeSVarint(n)},writeStringField:function(s,n){this.writeTag(s,On.Bytes),this.writeString(n)},writeFloatField:function(s,n){this.writeTag(s,On.Fixed32),this.writeFloat(n)},writeDoubleField:function(s,n){this.writeTag(s,On.Fixed64),this.writeDouble(n)},writeBooleanField:function(s,n){this.writeVarintField(s,!!n)}};var yg=b(q0);const vg=3;function pI(s,n,o){s===1&&o.readMessage(mI,n)}function mI(s,n,o){if(s===3){const{id:h,bitmap:g,width:y,height:v,left:S,top:T,advance:R}=o.readMessage(gI,{});n.push({id:h,bitmap:new eh({width:y+2*vg,height:v+2*vg},g),metrics:{width:y,height:v,left:S,top:T,advance:R}})}}function gI(s,n,o){s===1?n.id=o.readVarint():s===2?n.bitmap=o.readBytes():s===3?n.width=o.readVarint():s===4?n.height=o.readVarint():s===5?n.left=o.readSVarint():s===6?n.top=o.readSVarint():s===7&&(n.advance=o.readVarint())}const J0=vg;function Q0(s){let n=0,o=0;for(const v of s)n+=v.w*v.h,o=Math.max(o,v.w);s.sort((v,S)=>S.h-v.h);const h=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(n/.95)),o),h:1/0}];let g=0,y=0;for(const v of s)for(let S=h.length-1;S>=0;S--){const T=h[S];if(!(v.w>T.w||v.h>T.h)){if(v.x=T.x,v.y=T.y,y=Math.max(y,v.y+v.h),g=Math.max(g,v.x+v.w),v.w===T.w&&v.h===T.h){const R=h.pop();S<h.length&&(h[S]=R)}else v.h===T.h?(T.x+=v.w,T.w-=v.w):v.w===T.w?(T.y+=v.h,T.h-=v.h):(h.push({x:T.x+v.w,y:T.y,w:T.w-v.w,h:v.h}),T.y+=v.h,T.h-=v.h);break}}return{w:g,h:y,fill:n/(g*y)||0}}const Er=1;class xg{constructor(n,{pixelRatio:o,version:h,stretchX:g,stretchY:y,content:v}){this.paddedRect=n,this.pixelRatio=o,this.stretchX=g,this.stretchY=y,this.content=v,this.version=h}get tl(){return[this.paddedRect.x+Er,this.paddedRect.y+Er]}get br(){return[this.paddedRect.x+this.paddedRect.w-Er,this.paddedRect.y+this.paddedRect.h-Er]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2*Er)/this.pixelRatio,(this.paddedRect.h-2*Er)/this.pixelRatio]}}class ex{constructor(n,o){const h={},g={};this.haveRenderCallbacks=[];const y=[];this.addImages(n,h,y),this.addImages(o,g,y);const{w:v,h:S}=Q0(y),T=new ts({width:v||1,height:S||1});for(const R in n){const D=n[R],B=h[R].paddedRect;ts.copy(D.data,T,{x:0,y:0},{x:B.x+Er,y:B.y+Er},D.data)}for(const R in o){const D=o[R],B=g[R].paddedRect,N=B.x+Er,V=B.y+Er,q=D.data.width,te=D.data.height;ts.copy(D.data,T,{x:0,y:0},{x:N,y:V},D.data),ts.copy(D.data,T,{x:0,y:te-1},{x:N,y:V-1},{width:q,height:1}),ts.copy(D.data,T,{x:0,y:0},{x:N,y:V+te},{width:q,height:1}),ts.copy(D.data,T,{x:q-1,y:0},{x:N-1,y:V},{width:1,height:te}),ts.copy(D.data,T,{x:0,y:0},{x:N+q,y:V},{width:1,height:te})}this.image=T,this.iconPositions=h,this.patternPositions=g}addImages(n,o,h){for(const g in n){const y=n[g],v={x:0,y:0,w:y.data.width+2*Er,h:y.data.height+2*Er};h.push(v),o[g]=new xg(v,y),y.hasRenderCallback&&this.haveRenderCallbacks.push(g)}}patchUpdatedImages(n,o){n.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const h in n.updatedImages)this.patchUpdatedImage(this.iconPositions[h],n.getImage(h),o),this.patchUpdatedImage(this.patternPositions[h],n.getImage(h),o)}patchUpdatedImage(n,o,h){if(!n||!o||n.version===o.version)return;n.version=o.version;const[g,y]=n.tl;h.update(o.data,void 0,{x:g,y})}}var io;At("ImagePosition",xg),At("ImageAtlas",ex),l.WritingMode=void 0,(io=l.WritingMode||(l.WritingMode={}))[io.none=0]="none",io[io.horizontal=1]="horizontal",io[io.vertical=2]="vertical",io[io.horizontalOnly=3]="horizontalOnly";const lh=-17;class ch{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(n,o){const h=new ch;return h.scale=n||1,h.fontStack=o,h}static forImage(n){const o=new ch;return o.imageName=n,o}}class gc{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(n,o){const h=new gc;for(let g=0;g<n.sections.length;g++){const y=n.sections[g];y.image?h.addImageSection(y):h.addTextSection(y,o)}return h}length(){return this.text.length}getSection(n){return this.sections[this.sectionIndex[n]]}getSectionIndex(n){return this.sectionIndex[n]}getCharCode(n){return this.text.charCodeAt(n)}verticalizePunctuation(){this.text=function(n){let o="";for(let h=0;h<n.length;h++){const g=n.charCodeAt(h+1)||null,y=n.charCodeAt(h-1)||null;o+=g&&tf(g)&&!oh[n[h+1]]||y&&tf(y)&&!oh[n[h-1]]||!oh[n[h]]?n[h]:oh[n[h]]}return o}(this.text)}trim(){let n=0;for(let h=0;h<this.text.length&&wf[this.text.charCodeAt(h)];h++)n++;let o=this.text.length;for(let h=this.text.length-1;h>=0&&h>=n&&wf[this.text.charCodeAt(h)];h--)o--;this.text=this.text.substring(n,o),this.sectionIndex=this.sectionIndex.slice(n,o)}substring(n,o){const h=new gc;return h.text=this.text.substring(n,o),h.sectionIndex=this.sectionIndex.slice(n,o),h.sections=this.sections,h}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((n,o)=>Math.max(n,this.sections[o].scale),0)}addTextSection(n,o){this.text+=n.text,this.sections.push(ch.forText(n.scale,n.fontStack||o));const h=this.sections.length-1;for(let g=0;g<n.text.length;++g)this.sectionIndex.push(h)}addImageSection(n){const o=n.image?n.image.name:"";if(o.length===0)return void he("Can't add FormattedSection with an empty image.");const h=this.getNextImageSectionCharCode();h?(this.text+=String.fromCharCode(h),this.sections.push(ch.forImage(o)),this.sectionIndex.push(this.sections.length-1)):he("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function bf(s,n,o,h,g,y,v,S,T,R,D,B,N,V,q,te){const Q=gc.fromFeature(s,g);let _e;B===l.WritingMode.vertical&&Q.verticalizePunctuation();const{processBidirectionalText:Ee,processStyledBidirectionalText:pe}=jr;if(Ee&&Q.sections.length===1){_e=[];const We=Ee(Q.toString(),bg(Q,R,y,n,h,V,q));for(const Tt of We){const Rt=new gc;Rt.text=Tt,Rt.sections=Q.sections;for(let xt=0;xt<Tt.length;xt++)Rt.sectionIndex.push(0);_e.push(Rt)}}else if(pe){_e=[];const We=pe(Q.text,Q.sectionIndex,bg(Q,R,y,n,h,V,q));for(const Tt of We){const Rt=new gc;Rt.text=Tt[0],Rt.sectionIndex=Tt[1],Rt.sections=Q.sections,_e.push(Rt)}}else _e=function(We,Tt){const Rt=[],xt=We.text;let _t=0;for(const pt of Tt)Rt.push(We.substring(_t,pt)),_t=pt;return _t<xt.length&&Rt.push(We.substring(_t,xt.length)),Rt}(Q,bg(Q,R,y,n,h,V,q));const Re=[],ze={positionedLines:Re,text:Q.toString(),top:D[1],bottom:D[1],left:D[0],right:D[0],writingMode:B,iconsInText:!1,verticalizable:!1};return function(We,Tt,Rt,xt,_t,pt,bt,yt,lt,$t,Dt,an){let qn=0,Zn=lh,Ii=0,is=0;const qi=yt==="right"?1:yt==="left"?0:.5;let xi=0;for(const bi of _t){bi.trim();const Wi=bi.getMaxScale(),ir=(Wi-1)*Di,pr={positionedGlyphs:[],lineOffset:0};We.positionedLines[xi]=pr;const Cr=pr.positionedGlyphs;let Ir=0;if(!bi.length()){Zn+=pt,++xi;continue}for(let Zi=0;Zi<bi.length();Zi++){const on=bi.getSection(Zi),Gr=bi.getSectionIndex(Zi),Yi=bi.getCharCode(Zi);let rr=0,xs=null,zs=null,Os=null,Ea=Di;const bs=!(lt===l.WritingMode.horizontal||!Dt&&!Zl(Yi)||Dt&&(wf[Yi]||(Li=Yi,vt.Arabic(Li)||vt["Arabic Supplement"](Li)||vt["Arabic Extended-A"](Li)||vt["Arabic Presentation Forms-A"](Li)||vt["Arabic Presentation Forms-B"](Li))));if(on.imageName){const rs=xt[on.imageName];if(!rs)continue;Os=on.imageName,We.iconsInText=We.iconsInText||!0,zs=rs.paddedRect;const kr=rs.displaySize;on.scale=on.scale*Di/an,xs={width:kr[0],height:kr[1],left:Er,top:-J0,advance:bs?kr[1]:kr[0]},rr=ir+(Di-kr[1]*on.scale),Ea=xs.advance;const Ta=bs?kr[0]*on.scale-Di*Wi:kr[1]*on.scale-Di*Wi;Ta>0&&Ta>Ir&&(Ir=Ta)}else{const rs=Rt[on.fontStack],kr=rs&&rs[Yi];if(kr&&kr.rect)zs=kr.rect,xs=kr.metrics;else{const Ta=Tt[on.fontStack],ph=Ta&&Ta[Yi];if(!ph)continue;xs=ph.metrics}rr=(Wi-on.scale)*Di}bs?(We.verticalizable=!0,Cr.push({glyph:Yi,imageName:Os,x:qn,y:Zn+rr,vertical:bs,scale:on.scale,fontStack:on.fontStack,sectionIndex:Gr,metrics:xs,rect:zs}),qn+=Ea*on.scale+$t):(Cr.push({glyph:Yi,imageName:Os,x:qn,y:Zn+rr,vertical:bs,scale:on.scale,fontStack:on.fontStack,sectionIndex:Gr,metrics:xs,rect:zs}),qn+=xs.advance*on.scale+$t)}Cr.length!==0&&(Ii=Math.max(qn-$t,Ii),vI(Cr,0,Cr.length-1,qi,Ir)),qn=0;const oi=pt*Wi+Ir;pr.lineOffset=Math.max(Ir,ir),Zn+=oi,is=Math.max(oi,is),++xi}var Li;const Hi=Zn-lh,{horizontalAlign:nr,verticalAlign:Tr}=wg(bt);(function(bi,Wi,ir,pr,Cr,Ir,oi,Zi,on){const Gr=(Wi-ir)*Cr;let Yi=0;Yi=Ir!==oi?-Zi*pr-lh:(-pr*on+.5)*oi;for(const rr of bi)for(const xs of rr.positionedGlyphs)xs.x+=Gr,xs.y+=Yi})(We.positionedLines,qi,nr,Tr,Ii,is,pt,Hi,_t.length),We.top+=-Tr*Hi,We.bottom=We.top+Hi,We.left+=-nr*Ii,We.right=We.left+Ii}(ze,n,o,h,_e,v,S,T,B,R,N,te),!function(We){for(const Tt of We)if(Tt.positionedGlyphs.length!==0)return!1;return!0}(Re)&&ze}const wf={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},_I={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function tx(s,n,o,h,g,y){if(n.imageName){const v=h[n.imageName];return v?v.displaySize[0]*n.scale*Di/y+g:0}{const v=o[n.fontStack],S=v&&v[s];return S?S.metrics.advance*n.scale+g:0}}function nx(s,n,o,h){const g=Math.pow(s-n,2);return h?s<n?g/2:2*g:g+Math.abs(o)*o}function yI(s,n,o){let h=0;return s===10&&(h-=1e4),o&&(h+=150),s!==40&&s!==65288||(h+=50),n!==41&&n!==65289||(h+=50),h}function ix(s,n,o,h,g,y){let v=null,S=nx(n,o,g,y);for(const T of h){const R=nx(n-T.x,o,g,y)+T.badness;R<=S&&(v=T,S=R)}return{index:s,x:n,priorBreak:v,badness:S}}function rx(s){return s?rx(s.priorBreak).concat(s.index):[]}function bg(s,n,o,h,g,y,v){if(y!=="point")return[];if(!s)return[];const S=[],T=function(N,V,q,te,Q,_e){let Ee=0;for(let pe=0;pe<N.length();pe++){const Re=N.getSection(pe);Ee+=tx(N.getCharCode(pe),Re,te,Q,V,_e)}return Ee/Math.max(1,Math.ceil(Ee/q))}(s,n,o,h,g,v),R=s.text.indexOf("")>=0;let D=0;for(let N=0;N<s.length();N++){const V=s.getSection(N),q=s.getCharCode(N);if(wf[q]||(D+=tx(q,V,h,g,n,v)),N<s.length()-1){const te=!((B=q)<11904||!(vt["Bopomofo Extended"](B)||vt.Bopomofo(B)||vt["CJK Compatibility Forms"](B)||vt["CJK Compatibility Ideographs"](B)||vt["CJK Compatibility"](B)||vt["CJK Radicals Supplement"](B)||vt["CJK Strokes"](B)||vt["CJK Symbols and Punctuation"](B)||vt["CJK Unified Ideographs Extension A"](B)||vt["CJK Unified Ideographs"](B)||vt["Enclosed CJK Letters and Months"](B)||vt["Halfwidth and Fullwidth Forms"](B)||vt.Hiragana(B)||vt["Ideographic Description Characters"](B)||vt["Kangxi Radicals"](B)||vt["Katakana Phonetic Extensions"](B)||vt.Katakana(B)||vt["Vertical Forms"](B)||vt["Yi Radicals"](B)||vt["Yi Syllables"](B)));(_I[q]||te||V.imageName)&&S.push(ix(N+1,D,T,S,yI(q,s.getCharCode(N+1),te&&R),!1))}}var B;return rx(ix(s.length(),D,T,S,0,!0))}function wg(s){let n=.5,o=.5;switch(s){case"right":case"top-right":case"bottom-right":n=1;break;case"left":case"top-left":case"bottom-left":n=0}switch(s){case"bottom":case"bottom-right":case"bottom-left":o=1;break;case"top":case"top-right":case"top-left":o=0}return{horizontalAlign:n,verticalAlign:o}}function vI(s,n,o,h,g){if(!h&&!g)return;const y=s[o],v=(s[o].x+y.metrics.advance*y.scale)*h;for(let S=n;S<=o;S++)s[S].x-=v,s[S].y+=g}function xI(s,n,o){const{horizontalAlign:h,verticalAlign:g}=wg(o),y=n[0]-s.displaySize[0]*h,v=n[1]-s.displaySize[1]*g;return{image:s,top:v,bottom:v+s.displaySize[1],left:y,right:y+s.displaySize[0]}}function sx(s,n,o,h,g,y){const v=s.image;let S;if(v.content){const Q=v.content,_e=v.pixelRatio||1;S=[Q[0]/_e,Q[1]/_e,v.displaySize[0]-Q[2]/_e,v.displaySize[1]-Q[3]/_e]}const T=n.left*y,R=n.right*y;let D,B,N,V;o==="width"||o==="both"?(V=g[0]+T-h[3],B=g[0]+R+h[1]):(V=g[0]+(T+R-v.displaySize[0])/2,B=V+v.displaySize[0]);const q=n.top*y,te=n.bottom*y;return o==="height"||o==="both"?(D=g[1]+q-h[0],N=g[1]+te+h[2]):(D=g[1]+(q+te-v.displaySize[1])/2,N=D+v.displaySize[1]),{image:v,top:D,right:B,bottom:N,left:V,collisionPadding:S}}const uh=255,ea=128,ro=uh*ea;function ax(s,n){const{expression:o}=n;if(o.kind==="constant")return{kind:"constant",layoutSize:o.evaluate(new Wn(s+1))};if(o.kind==="source")return{kind:"source"};{const{zoomStops:h,interpolationType:g}=o;let y=0;for(;y<h.length&&h[y]<=s;)y++;y=Math.max(0,y-1);let v=y;for(;v<h.length&&h[v]<s+1;)v++;v=Math.min(h.length-1,v);const S=h[y],T=h[v];return o.kind==="composite"?{kind:"composite",minZoom:S,maxZoom:T,interpolationType:g}:{kind:"camera",minZoom:S,maxZoom:T,minSize:o.evaluate(new Wn(S)),maxSize:o.evaluate(new Wn(T)),interpolationType:g}}}function Sg(s,n,o){let h="never";const g=s.get(n);return g?h=g:s.get(o)&&(h="always"),h}const bI=no.VectorTileFeature.types,wI=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Sf(s,n,o,h,g,y,v,S,T,R,D,B,N){const V=S?Math.min(ro,Math.round(S[0])):0,q=S?Math.min(ro,Math.round(S[1])):0;s.emplaceBack(n,o,Math.round(32*h),Math.round(32*g),y,v,(V<<1)+(T?1:0),q,16*R,16*D,256*B,256*N)}function Eg(s,n,o){s.emplaceBack(n.x,n.y,o),s.emplaceBack(n.x,n.y,o),s.emplaceBack(n.x,n.y,o),s.emplaceBack(n.x,n.y,o)}function SI(s){for(const n of s.sections)if(nf(n.text))return!0;return!1}class Tg{constructor(n){this.layoutVertexArray=new Pe,this.indexArray=new it,this.programConfigurations=n,this.segments=new gt,this.dynamicLayoutVertexArray=new Fe,this.opacityVertexArray=new Qe,this.hasVisibleVertices=!1,this.placedSymbolArray=new E}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(n,o,h,g){this.isEmpty()||(h&&(this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,eI.members),this.indexBuffer=n.createIndexBuffer(this.indexArray,o),this.dynamicLayoutVertexBuffer=n.createVertexBuffer(this.dynamicLayoutVertexArray,tI.members,!0),this.opacityVertexBuffer=n.createVertexBuffer(this.opacityVertexArray,wI,!0),this.opacityVertexBuffer.itemSize=1),(h||g)&&this.programConfigurations.upload(n))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}At("SymbolBuffers",Tg);class Cg{constructor(n,o,h){this.layoutVertexArray=new n,this.layoutAttributes=o,this.indexArray=new h,this.segments=new gt,this.collisionVertexArray=new ht}upload(n){this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=n.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=n.createVertexBuffer(this.collisionVertexArray,nI.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}At("CollisionBuffers",Cg);class _c{constructor(n){this.collisionBoxArray=n.collisionBoxArray,this.zoom=n.zoom,this.overscaling=n.overscaling,this.layers=n.layers,this.layerIds=this.layers.map(v=>v.id),this.index=n.index,this.pixelRatio=n.pixelRatio,this.sourceLayerIndex=n.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=ig([]),this.placementViewportMatrix=ig([]);const o=this.layers[0]._unevaluatedLayout._values;this.textSizeData=ax(this.zoom,o["text-size"]),this.iconSizeData=ax(this.zoom,o["icon-size"]);const h=this.layers[0].layout,g=h.get("symbol-sort-key"),y=h.get("symbol-z-order");this.canOverlap=Sg(h,"text-overlap","text-allow-overlap")!=="never"||Sg(h,"icon-overlap","icon-allow-overlap")!=="never"||h.get("text-ignore-placement")||h.get("icon-ignore-placement"),this.sortFeaturesByKey=y!=="viewport-y"&&!g.isConstant(),this.sortFeaturesByY=(y==="viewport-y"||y==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,h.get("symbol-placement")==="point"&&(this.writingModes=h.get("text-writing-mode").map(v=>l.WritingMode[v])),this.stateDependentLayerIds=this.layers.filter(v=>v.isStateDependent()).map(v=>v.id),this.sourceID=n.sourceID}createArrays(){this.text=new Tg(new Ds(this.layers,this.zoom,n=>/^text/.test(n))),this.icon=new Tg(new Ds(this.layers,this.zoom,n=>/^icon/.test(n))),this.glyphOffsetArray=new P,this.lineVertexArray=new z,this.symbolInstances=new k}calculateGlyphDependencies(n,o,h,g,y){for(let v=0;v<n.length;v++)if(o[n.charCodeAt(v)]=!0,(h||g)&&y){const S=oh[n.charAt(v)];S&&(o[S.charCodeAt(0)]=!0)}}populate(n,o,h){const g=this.layers[0],y=g.layout,v=y.get("text-font"),S=y.get("text-field"),T=y.get("icon-image"),R=(S.value.kind!=="constant"||S.value.value instanceof Bi&&!S.value.value.isEmpty()||S.value.value.toString().length>0)&&(v.value.kind!=="constant"||v.value.value.length>0),D=T.value.kind!=="constant"||!!T.value.value||Object.keys(T.parameters).length>0,B=y.get("symbol-sort-key");if(this.features=[],!R&&!D)return;const N=o.iconDependencies,V=o.glyphDependencies,q=o.availableImages,te=new Wn(this.zoom);for(const{feature:Q,id:_e,index:Ee,sourceLayerIndex:pe}of n){const Re=g._featureFilter.needGeometry,ze=el(Q,Re);if(!g._featureFilter.filter(te,ze,h))continue;let We,Tt;if(Re||(ze.geometry=Ls(Q)),R){const xt=g.getValueAndResolveTokens("text-field",ze,h,q),_t=Bi.factory(xt);SI(_t)&&(this.hasRTLText=!0),(!this.hasRTLText||Vu()==="unavailable"||this.hasRTLText&&jr.isParsed())&&(We=rI(_t,g,ze))}if(D){const xt=g.getValueAndResolveTokens("icon-image",ze,h,q);Tt=xt instanceof Nr?xt:Nr.fromString(xt)}if(!We&&!Tt)continue;const Rt=this.sortFeaturesByKey?B.evaluate(ze,{},h):void 0;if(this.features.push({id:_e,text:We,icon:Tt,index:Ee,sourceLayerIndex:pe,geometry:ze.geometry,properties:Q.properties,type:bI[Q.type],sortKey:Rt}),Tt&&(N[Tt.name]=!0),We){const xt=v.evaluate(ze,{},h).join(","),_t=y.get("text-rotation-alignment")!=="viewport"&&y.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(l.WritingMode.vertical)>=0;for(const pt of We.sections)if(pt.image)N[pt.image.name]=!0;else{const bt=Wl(We.toString()),yt=pt.fontStack||xt,lt=V[yt]=V[yt]||{};this.calculateGlyphDependencies(pt.text,lt,_t,this.allowVerticalPlacement,bt)}}}y.get("symbol-placement")==="line"&&(this.features=function(Q){const _e={},Ee={},pe=[];let Re=0;function ze(xt){pe.push(Q[xt]),Re++}function We(xt,_t,pt){const bt=Ee[xt];return delete Ee[xt],Ee[_t]=bt,pe[bt].geometry[0].pop(),pe[bt].geometry[0]=pe[bt].geometry[0].concat(pt[0]),bt}function Tt(xt,_t,pt){const bt=_e[_t];return delete _e[_t],_e[xt]=bt,pe[bt].geometry[0].shift(),pe[bt].geometry[0]=pt[0].concat(pe[bt].geometry[0]),bt}function Rt(xt,_t,pt){const bt=pt?_t[0][_t[0].length-1]:_t[0][0];return`${xt}:${bt.x}:${bt.y}`}for(let xt=0;xt<Q.length;xt++){const _t=Q[xt],pt=_t.geometry,bt=_t.text?_t.text.toString():null;if(!bt){ze(xt);continue}const yt=Rt(bt,pt),lt=Rt(bt,pt,!0);if(yt in Ee&&lt in _e&&Ee[yt]!==_e[lt]){const $t=Tt(yt,lt,pt),Dt=We(yt,lt,pe[$t].geometry);delete _e[yt],delete Ee[lt],Ee[Rt(bt,pe[Dt].geometry,!0)]=Dt,pe[$t].geometry=null}else yt in Ee?We(yt,lt,pt):lt in _e?Tt(yt,lt,pt):(ze(xt),_e[yt]=Re-1,Ee[lt]=Re-1)}return pe.filter(xt=>xt.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((Q,_e)=>Q.sortKey-_e.sortKey)}update(n,o,h){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(n,o,this.layers,h),this.icon.programConfigurations.updatePaintArrays(n,o,this.layers,h))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(n){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(n),this.iconCollisionBox.upload(n)),this.text.upload(n,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(n,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(n,o){const h=this.lineVertexArray.length;if(n.segment!==void 0){let g=n.dist(o[n.segment+1]),y=n.dist(o[n.segment]);const v={};for(let S=n.segment+1;S<o.length;S++)v[S]={x:o[S].x,y:o[S].y,tileUnitDistanceFromAnchor:g},S<o.length-1&&(g+=o[S+1].dist(o[S]));for(let S=n.segment||0;S>=0;S--)v[S]={x:o[S].x,y:o[S].y,tileUnitDistanceFromAnchor:y},S>0&&(y+=o[S-1].dist(o[S]));for(let S=0;S<o.length;S++){const T=v[S];this.lineVertexArray.emplaceBack(T.x,T.y,T.tileUnitDistanceFromAnchor)}}return{lineStartIndex:h,lineLength:this.lineVertexArray.length-h}}addSymbols(n,o,h,g,y,v,S,T,R,D,B,N){const V=n.indexArray,q=n.layoutVertexArray,te=n.segments.prepareSegment(4*o.length,q,V,this.canOverlap?v.sortKey:void 0),Q=this.glyphOffsetArray.length,_e=te.vertexLength,Ee=this.allowVerticalPlacement&&S===l.WritingMode.vertical?Math.PI/2:0,pe=v.text&&v.text.sections;for(let Re=0;Re<o.length;Re++){const{tl:ze,tr:We,bl:Tt,br:Rt,tex:xt,pixelOffsetTL:_t,pixelOffsetBR:pt,minFontScaleX:bt,minFontScaleY:yt,glyphOffset:lt,isSDF:$t,sectionIndex:Dt}=o[Re],an=te.vertexLength,qn=lt[1];Sf(q,T.x,T.y,ze.x,qn+ze.y,xt.x,xt.y,h,$t,_t.x,_t.y,bt,yt),Sf(q,T.x,T.y,We.x,qn+We.y,xt.x+xt.w,xt.y,h,$t,pt.x,_t.y,bt,yt),Sf(q,T.x,T.y,Tt.x,qn+Tt.y,xt.x,xt.y+xt.h,h,$t,_t.x,pt.y,bt,yt),Sf(q,T.x,T.y,Rt.x,qn+Rt.y,xt.x+xt.w,xt.y+xt.h,h,$t,pt.x,pt.y,bt,yt),Eg(n.dynamicLayoutVertexArray,T,Ee),V.emplaceBack(an,an+1,an+2),V.emplaceBack(an+1,an+2,an+3),te.vertexLength+=4,te.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(lt[0]),Re!==o.length-1&&Dt===o[Re+1].sectionIndex||n.programConfigurations.populatePaintArrays(q.length,v,v.index,{},N,pe&&pe[Dt])}n.placedSymbolArray.emplaceBack(T.x,T.y,Q,this.glyphOffsetArray.length-Q,_e,R,D,T.segment,h?h[0]:0,h?h[1]:0,g[0],g[1],S,0,!1,0,B)}_addCollisionDebugVertex(n,o,h,g,y,v){return o.emplaceBack(0,0),n.emplaceBack(h.x,h.y,g,y,Math.round(v.x),Math.round(v.y))}addCollisionDebugVertices(n,o,h,g,y,v,S){const T=y.segments.prepareSegment(4,y.layoutVertexArray,y.indexArray),R=T.vertexLength,D=y.layoutVertexArray,B=y.collisionVertexArray,N=S.anchorX,V=S.anchorY;this._addCollisionDebugVertex(D,B,v,N,V,new I(n,o)),this._addCollisionDebugVertex(D,B,v,N,V,new I(h,o)),this._addCollisionDebugVertex(D,B,v,N,V,new I(h,g)),this._addCollisionDebugVertex(D,B,v,N,V,new I(n,g)),T.vertexLength+=4;const q=y.indexArray;q.emplaceBack(R,R+1),q.emplaceBack(R+1,R+2),q.emplaceBack(R+2,R+3),q.emplaceBack(R+3,R),T.primitiveLength+=4}addDebugCollisionBoxes(n,o,h,g){for(let y=n;y<o;y++){const v=this.collisionBoxArray.get(y);this.addCollisionDebugVertices(v.x1,v.y1,v.x2,v.y2,g?this.textCollisionBox:this.iconCollisionBox,v.anchorPoint,h)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new Cg(ot,G0.members,St),this.iconCollisionBox=new Cg(ot,G0.members,St);for(let n=0;n<this.symbolInstances.length;n++){const o=this.symbolInstances.get(n);this.addDebugCollisionBoxes(o.textBoxStartIndex,o.textBoxEndIndex,o,!0),this.addDebugCollisionBoxes(o.verticalTextBoxStartIndex,o.verticalTextBoxEndIndex,o,!0),this.addDebugCollisionBoxes(o.iconBoxStartIndex,o.iconBoxEndIndex,o,!1),this.addDebugCollisionBoxes(o.verticalIconBoxStartIndex,o.verticalIconBoxEndIndex,o,!1)}}_deserializeCollisionBoxesForSymbol(n,o,h,g,y,v,S,T,R){const D={};for(let B=o;B<h;B++){const N=n.get(B);D.textBox={x1:N.x1,y1:N.y1,x2:N.x2,y2:N.y2,anchorPointX:N.anchorPointX,anchorPointY:N.anchorPointY},D.textFeatureIndex=N.featureIndex;break}for(let B=g;B<y;B++){const N=n.get(B);D.verticalTextBox={x1:N.x1,y1:N.y1,x2:N.x2,y2:N.y2,anchorPointX:N.anchorPointX,anchorPointY:N.anchorPointY},D.verticalTextFeatureIndex=N.featureIndex;break}for(let B=v;B<S;B++){const N=n.get(B);D.iconBox={x1:N.x1,y1:N.y1,x2:N.x2,y2:N.y2,anchorPointX:N.anchorPointX,anchorPointY:N.anchorPointY},D.iconFeatureIndex=N.featureIndex;break}for(let B=T;B<R;B++){const N=n.get(B);D.verticalIconBox={x1:N.x1,y1:N.y1,x2:N.x2,y2:N.y2,anchorPointX:N.anchorPointX,anchorPointY:N.anchorPointY},D.verticalIconFeatureIndex=N.featureIndex;break}return D}deserializeCollisionBoxes(n){this.collisionArrays=[];for(let o=0;o<this.symbolInstances.length;o++){const h=this.symbolInstances.get(o);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(n,h.textBoxStartIndex,h.textBoxEndIndex,h.verticalTextBoxStartIndex,h.verticalTextBoxEndIndex,h.iconBoxStartIndex,h.iconBoxEndIndex,h.verticalIconBoxStartIndex,h.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(n,o){const h=n.placedSymbolArray.get(o),g=h.vertexStartIndex+4*h.numGlyphs;for(let y=h.vertexStartIndex;y<g;y+=4)n.indexArray.emplaceBack(y,y+1,y+2),n.indexArray.emplaceBack(y+1,y+2,y+3)}getSortedSymbolIndexes(n){if(this.sortedAngle===n&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const o=Math.sin(n),h=Math.cos(n),g=[],y=[],v=[];for(let S=0;S<this.symbolInstances.length;++S){v.push(S);const T=this.symbolInstances.get(S);g.push(0|Math.round(o*T.anchorX+h*T.anchorY)),y.push(T.featureIndex)}return v.sort((S,T)=>g[S]-g[T]||y[T]-y[S]),v}addToSortKeyRanges(n,o){const h=this.sortKeyRanges[this.sortKeyRanges.length-1];h&&h.sortKey===o?h.symbolInstanceEnd=n+1:this.sortKeyRanges.push({sortKey:o,symbolInstanceStart:n,symbolInstanceEnd:n+1})}sortFeatures(n){if(this.sortFeaturesByY&&this.sortedAngle!==n&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(n),this.sortedAngle=n,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const o of this.symbolInstanceIndexes){const h=this.symbolInstances.get(o);this.featureSortOrder.push(h.featureIndex),[h.rightJustifiedTextSymbolIndex,h.centerJustifiedTextSymbolIndex,h.leftJustifiedTextSymbolIndex].forEach((g,y,v)=>{g>=0&&v.indexOf(g)===y&&this.addIndicesForPlacedSymbol(this.text,g)}),h.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,h.verticalPlacedTextSymbolIndex),h.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,h.placedIconSymbolIndex),h.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,h.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let ox,lx;At("SymbolBucket",_c,{omit:["layers","collisionBoxArray","features","compareText"]}),_c.MAX_GLYPHS=65535,_c.addDynamicAttributes=Eg;var Ig={get paint(){return lx=lx||new dr({"icon-opacity":new Ht(W.paint_symbol["icon-opacity"]),"icon-color":new Ht(W.paint_symbol["icon-color"]),"icon-halo-color":new Ht(W.paint_symbol["icon-halo-color"]),"icon-halo-width":new Ht(W.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Ht(W.paint_symbol["icon-halo-blur"]),"icon-translate":new zt(W.paint_symbol["icon-translate"]),"icon-translate-anchor":new zt(W.paint_symbol["icon-translate-anchor"]),"text-opacity":new Ht(W.paint_symbol["text-opacity"]),"text-color":new Ht(W.paint_symbol["text-color"],{runtimeType:Dn,getOverride:s=>s.textColor,hasOverride:s=>!!s.textColor}),"text-halo-color":new Ht(W.paint_symbol["text-halo-color"]),"text-halo-width":new Ht(W.paint_symbol["text-halo-width"]),"text-halo-blur":new Ht(W.paint_symbol["text-halo-blur"]),"text-translate":new zt(W.paint_symbol["text-translate"]),"text-translate-anchor":new zt(W.paint_symbol["text-translate-anchor"])})},get layout(){return ox=ox||new dr({"symbol-placement":new zt(W.layout_symbol["symbol-placement"]),"symbol-spacing":new zt(W.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new zt(W.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Ht(W.layout_symbol["symbol-sort-key"]),"symbol-z-order":new zt(W.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new zt(W.layout_symbol["icon-allow-overlap"]),"icon-overlap":new zt(W.layout_symbol["icon-overlap"]),"icon-ignore-placement":new zt(W.layout_symbol["icon-ignore-placement"]),"icon-optional":new zt(W.layout_symbol["icon-optional"]),"icon-rotation-alignment":new zt(W.layout_symbol["icon-rotation-alignment"]),"icon-size":new Ht(W.layout_symbol["icon-size"]),"icon-text-fit":new zt(W.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new zt(W.layout_symbol["icon-text-fit-padding"]),"icon-image":new Ht(W.layout_symbol["icon-image"]),"icon-rotate":new Ht(W.layout_symbol["icon-rotate"]),"icon-padding":new Ht(W.layout_symbol["icon-padding"]),"icon-keep-upright":new zt(W.layout_symbol["icon-keep-upright"]),"icon-offset":new Ht(W.layout_symbol["icon-offset"]),"icon-anchor":new Ht(W.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new zt(W.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new zt(W.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new zt(W.layout_symbol["text-rotation-alignment"]),"text-field":new Ht(W.layout_symbol["text-field"]),"text-font":new Ht(W.layout_symbol["text-font"]),"text-size":new Ht(W.layout_symbol["text-size"]),"text-max-width":new Ht(W.layout_symbol["text-max-width"]),"text-line-height":new zt(W.layout_symbol["text-line-height"]),"text-letter-spacing":new Ht(W.layout_symbol["text-letter-spacing"]),"text-justify":new Ht(W.layout_symbol["text-justify"]),"text-radial-offset":new Ht(W.layout_symbol["text-radial-offset"]),"text-variable-anchor":new zt(W.layout_symbol["text-variable-anchor"]),"text-anchor":new Ht(W.layout_symbol["text-anchor"]),"text-max-angle":new zt(W.layout_symbol["text-max-angle"]),"text-writing-mode":new zt(W.layout_symbol["text-writing-mode"]),"text-rotate":new Ht(W.layout_symbol["text-rotate"]),"text-padding":new zt(W.layout_symbol["text-padding"]),"text-keep-upright":new zt(W.layout_symbol["text-keep-upright"]),"text-transform":new Ht(W.layout_symbol["text-transform"]),"text-offset":new Ht(W.layout_symbol["text-offset"]),"text-allow-overlap":new zt(W.layout_symbol["text-allow-overlap"]),"text-overlap":new zt(W.layout_symbol["text-overlap"]),"text-ignore-placement":new zt(W.layout_symbol["text-ignore-placement"]),"text-optional":new zt(W.layout_symbol["text-optional"])})}};class cx{constructor(n){if(n.property.overrides===void 0)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=n.property.overrides?n.property.overrides.runtimeType:zn,this.defaultValue=n}evaluate(n){if(n.formattedSection){const o=this.defaultValue.property.overrides;if(o&&o.hasOverride(n.formattedSection))return o.getOverride(n.formattedSection)}return n.feature&&n.featureState?this.defaultValue.evaluate(n.feature,n.featureState):this.defaultValue.property.specification.default}eachChild(n){this.defaultValue.isConstant()||n(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}At("FormatSectionOverride",cx,{omit:["defaultValue"]});class Ef extends _s{constructor(n){super(n,Ig)}recalculate(n,o){if(super.recalculate(n,o),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")==="map"?"map":"viewport"),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){const h=this.layout.get("text-writing-mode");if(h){const g=[];for(const y of h)g.indexOf(y)<0&&g.push(y);this.layout._values["text-writing-mode"]=g}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(n,o,h,g){const y=this.layout.get(n).evaluate(o,{},h,g),v=this._unevaluatedLayout._values[n];return v.isDataDriven()||Nl(v.value)||!y?y:function(S,T){return T.replace(/{([^{}]+)}/g,(R,D)=>D in S?String(S[D]):"")}(o.properties,y)}createBucket(n){return new _c(n)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(const n of Ig.paint.overridableProperties){if(!Ef.hasPaintOverride(this.layout,n))continue;const o=this.paint.get(n),h=new cx(o),g=new Pu(h,o.property.specification);let y=null;y=o.value.kind==="constant"||o.value.kind==="source"?new Ru("source",g):new un("composite",g,o.value.zoomStops),this.paint._values[n]=new gs(o.property,y,o.parameters)}}_handleOverridablePaintPropertyUpdate(n,o,h){return!(!this.layout||o.isDataDriven()||h.isDataDriven())&&Ef.hasPaintOverride(this.layout,n)}static hasPaintOverride(n,o){const h=n.get("text-field"),g=Ig.paint.properties[o];let y=!1;const v=S=>{for(const T of S)if(g.overrides&&g.overrides.hasOverride(T))return void(y=!0)};if(h.value.kind==="constant"&&h.value.value instanceof Bi)v(h.value.value.sections);else if(h.value.kind==="source"){const S=R=>{y||(R instanceof Ys&&_i(R.value)===ks?v(R.value.sections):R instanceof Bl?v(R.sections):R.eachChild(S))},T=h.value;T._styleExpression&&S(T._styleExpression.expression)}return y}}let ux;var EI={get paint(){return ux=ux||new dr({"background-color":new zt(W.paint_background["background-color"]),"background-pattern":new qu(W.paint_background["background-pattern"]),"background-opacity":new zt(W.paint_background["background-opacity"])})}};let hx;var TI={get paint(){return hx=hx||new dr({"raster-opacity":new zt(W.paint_raster["raster-opacity"]),"raster-hue-rotate":new zt(W.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new zt(W.paint_raster["raster-brightness-min"]),"raster-brightness-max":new zt(W.paint_raster["raster-brightness-max"]),"raster-saturation":new zt(W.paint_raster["raster-saturation"]),"raster-contrast":new zt(W.paint_raster["raster-contrast"]),"raster-resampling":new zt(W.paint_raster["raster-resampling"]),"raster-fade-duration":new zt(W.paint_raster["raster-fade-duration"])})}};class CI extends _s{constructor(n){super(n,{}),this.onAdd=o=>{this.implementation.onAdd&&this.implementation.onAdd(o,o.painter.context.gl)},this.onRemove=o=>{this.implementation.onRemove&&this.implementation.onRemove(o,o.painter.context.gl)},this.implementation=n}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}const II={circle:class extends _s{constructor(s){super(s,pC)}createBucket(s){return new eg(s)}queryRadius(s){const n=s;return Ju("circle-radius",this,n)+Ju("circle-stroke-width",this,n)+df(this.paint.get("circle-translate"))}queryIntersectsFeature(s,n,o,h,g,y,v,S){const T=ff(s,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),y.angle,v),R=this.paint.get("circle-radius").evaluate(n,o)+this.paint.get("circle-stroke-width").evaluate(n,o),D=this.paint.get("circle-pitch-alignment")==="map",B=D?T:function(V,q){return V.map(te=>x0(te,q))}(T,S),N=D?R*v:R;for(const V of h)for(const q of V){const te=D?q:x0(q,S);let Q=N;const _e=pf([],[q.x,q.y,0,1],S);if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?Q*=_e[3]/y.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(Q*=y.cameraToCenterDistance/_e[3]),uC(B,te,Q))return!0}return!1}},heatmap:class extends _s{createBucket(s){return new b0(s)}constructor(s){super(s,gC),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(s){s==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=E0({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(){return 0}queryIntersectsFeature(){return!1}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}},hillshade:class extends _s{constructor(s){super(s,_C)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}},fill:class extends _s{constructor(s){super(s,MC)}recalculate(s,n){super.recalculate(s,n);const o=this.paint._values["fill-outline-color"];o.value.kind==="constant"&&o.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(s){return new fg(s)}queryRadius(){return df(this.paint.get("fill-translate"))}queryIntersectsFeature(s,n,o,h,g,y,v){return p0(ff(s,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),y.angle,v),h)}isTileClipped(){return!0}},"fill-extrusion":class extends _s{constructor(s){super(s,HC)}createBucket(s){return new mg(s)}queryRadius(){return df(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature(s,n,o,h,g,y,v,S){const T=ff(s,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),y.angle,v),R=this.paint.get("fill-extrusion-height").evaluate(n,o),D=this.paint.get("fill-extrusion-base").evaluate(n,o),B=function(V,q,te,Q){const _e=[];for(const Ee of V){const pe=[Ee.x,Ee.y,0,1];pf(pe,pe,q),_e.push(new I(pe[0]/pe[3],pe[1]/pe[3]))}return _e}(T,S),N=function(V,q,te,Q){const _e=[],Ee=[],pe=Q[8]*q,Re=Q[9]*q,ze=Q[10]*q,We=Q[11]*q,Tt=Q[8]*te,Rt=Q[9]*te,xt=Q[10]*te,_t=Q[11]*te;for(const pt of V){const bt=[],yt=[];for(const lt of pt){const $t=lt.x,Dt=lt.y,an=Q[0]*$t+Q[4]*Dt+Q[12],qn=Q[1]*$t+Q[5]*Dt+Q[13],Zn=Q[2]*$t+Q[6]*Dt+Q[14],Ii=Q[3]*$t+Q[7]*Dt+Q[15],is=Zn+ze,qi=Ii+We,xi=an+Tt,Li=qn+Rt,Hi=Zn+xt,nr=Ii+_t,Tr=new I((an+pe)/qi,(qn+Re)/qi);Tr.z=is/qi,bt.push(Tr);const bi=new I(xi/nr,Li/nr);bi.z=Hi/nr,yt.push(bi)}_e.push(bt),Ee.push(yt)}return[_e,Ee]}(h,D,R,S);return function(V,q,te){let Q=1/0;p0(te,q)&&(Q=F0(te,q[0]));for(let _e=0;_e<q.length;_e++){const Ee=q[_e],pe=V[_e];for(let Re=0;Re<Ee.length-1;Re++){const ze=Ee[Re],We=[ze,Ee[Re+1],pe[Re+1],pe[Re],ze];f0(te,We)&&(Q=Math.min(Q,F0(te,We)))}}return Q!==1/0&&Q}(N[0],N[1],B)}},line:class extends _s{constructor(s){super(s,V0),this.gradientVersion=0,vf||(vf=new QC(V0.paint.properties["line-width"].specification),vf.useIntegerZoom=!0)}_handleSpecialPaintPropertyUpdate(s){s==="line-gradient"&&(this.stepInterpolant=this._transitionablePaint._values["line-gradient"].value.expression._styleExpression.expression instanceof qa,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER)}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(s,n){super.recalculate(s,n),this.paint._values["line-floorwidth"]=vf.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,s)}createBucket(s){return new gg(s)}queryRadius(s){const n=s,o=j0(Ju("line-width",this,n),Ju("line-gap-width",this,n)),h=Ju("line-offset",this,n);return o/2+Math.abs(h)+df(this.paint.get("line-translate"))}queryIntersectsFeature(s,n,o,h,g,y,v){const S=ff(s,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),y.angle,v),T=v/2*j0(this.paint.get("line-width").evaluate(n,o),this.paint.get("line-gap-width").evaluate(n,o)),R=this.paint.get("line-offset").evaluate(n,o);return R&&(h=function(D,B){const N=[];for(let V=0;V<D.length;V++){const q=D[V],te=[];for(let Q=0;Q<q.length;Q++){const _e=q[Q-1],Ee=q[Q],pe=q[Q+1],Re=Q===0?new I(0,0):Ee.sub(_e)._unit()._perp(),ze=Q===q.length-1?new I(0,0):pe.sub(Ee)._unit()._perp(),We=Re._add(ze)._unit(),Tt=We.x*ze.x+We.y*ze.y;Tt!==0&&We._mult(1/Tt),te.push(We._mult(B)._add(Ee))}N.push(te)}return N}(h,R*v)),function(D,B,N){for(let V=0;V<B.length;V++){const q=B[V];if(D.length>=3){for(let te=0;te<q.length;te++)if(uc(D,q[te]))return!0}if(hC(D,q,N))return!0}return!1}(S,h,T)}isTileClipped(){return!0}},symbol:Ef,background:class extends _s{constructor(s){super(s,EI)}},raster:class extends _s{constructor(s){super(s,TI)}}};class kI{constructor(n){this._callback=n,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){delete this._channel,this._callback=()=>{}}}const kg=63710088e-1;class so{constructor(n,o){if(isNaN(n)||isNaN(o))throw new Error(`Invalid LngLat object: (${n}, ${o})`);if(this.lng=+n,this.lat=+o,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new so(ve(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(n){const o=Math.PI/180,h=this.lat*o,g=n.lat*o,y=Math.sin(h)*Math.sin(g)+Math.cos(h)*Math.cos(g)*Math.cos((n.lng-this.lng)*o);return kg*Math.acos(Math.min(y,1))}static convert(n){if(n instanceof so)return n;if(Array.isArray(n)&&(n.length===2||n.length===3))return new so(Number(n[0]),Number(n[1]));if(!Array.isArray(n)&&typeof n=="object"&&n!==null)return new so(Number("lng"in n?n.lng:n.lon),Number(n.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const dx=2*Math.PI*kg;function fx(s){return dx*Math.cos(s*Math.PI/180)}function px(s){return(180+s)/360}function mx(s){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+s*Math.PI/360)))/360}function gx(s,n){return s/fx(n)}function Ag(s){return 360/Math.PI*Math.atan(Math.exp((180-360*s)*Math.PI/180))-90}class Tf{constructor(n,o,h=0){this.x=+n,this.y=+o,this.z=+h}static fromLngLat(n,o=0){const h=so.convert(n);return new Tf(px(h.lng),mx(h.lat),gx(o,h.lat))}toLngLat(){return new so(360*this.x-180,Ag(this.y))}toAltitude(){return this.z*fx(Ag(this.y))}meterInMercatorCoordinateUnits(){return 1/dx*(n=Ag(this.y),1/Math.cos(n*Math.PI/180));var n}}function _x(s,n,o){var h=2*Math.PI*6378137/256/Math.pow(2,o);return[s*h-2*Math.PI*6378137/2,n*h-2*Math.PI*6378137/2]}class Pg{constructor(n,o,h){if(n<0||n>25||h<0||h>=Math.pow(2,n)||o<0||o>=Math.pow(2,n))throw new Error(`x=${o}, y=${h}, z=${n} outside of bounds. 0<=x<${Math.pow(2,n)}, 0<=y<${Math.pow(2,n)} 0<=z<=25 `);this.z=n,this.x=o,this.y=h,this.key=hh(0,n,n,o,h)}equals(n){return this.z===n.z&&this.x===n.x&&this.y===n.y}url(n,o,h){const g=(v=this.y,S=this.z,T=_x(256*(y=this.x),256*(v=Math.pow(2,S)-v-1),S),R=_x(256*(y+1),256*(v+1),S),T[0]+","+T[1]+","+R[0]+","+R[1]);var y,v,S,T,R;const D=function(B,N,V){let q,te="";for(let Q=B;Q>0;Q--)q=1<<Q-1,te+=(N&q?1:0)+(V&q?2:0);return te}(this.z,this.x,this.y);return n[(this.x+this.y)%n.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(h==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,o>1?"@2x":"").replace(/{quadkey}/g,D).replace(/{bbox-epsg-3857}/g,g)}isChildOf(n){const o=this.z-n.z;return o>0&&n.x===this.x>>o&&n.y===this.y>>o}getTilePoint(n){const o=Math.pow(2,this.z);return new I((n.x*o-this.x)*Gn,(n.y*o-this.y)*Gn)}toString(){return`${this.z}/${this.x}/${this.y}`}}class yx{constructor(n,o){this.wrap=n,this.canonical=o,this.key=hh(n,o.z,o.z,o.x,o.y)}}class ns{constructor(n,o,h,g,y){if(n<h)throw new Error(`overscaledZ should be >= z; overscaledZ = ${n}; z = ${h}`);this.overscaledZ=n,this.wrap=o,this.canonical=new Pg(h,+g,+y),this.key=hh(o,n,h,g,y)}clone(){return new ns(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(n){return this.overscaledZ===n.overscaledZ&&this.wrap===n.wrap&&this.canonical.equals(n.canonical)}scaledTo(n){if(n>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${n}; overscaledZ = ${this.overscaledZ}`);const o=this.canonical.z-n;return n>this.canonical.z?new ns(n,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new ns(n,this.wrap,n,this.canonical.x>>o,this.canonical.y>>o)}calculateScaledKey(n,o){if(n>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${n}; overscaledZ = ${this.overscaledZ}`);const h=this.canonical.z-n;return n>this.canonical.z?hh(this.wrap*+o,n,this.canonical.z,this.canonical.x,this.canonical.y):hh(this.wrap*+o,n,n,this.canonical.x>>h,this.canonical.y>>h)}isChildOf(n){if(n.wrap!==this.wrap)return!1;const o=this.canonical.z-n.canonical.z;return n.overscaledZ===0||n.overscaledZ<this.overscaledZ&&n.canonical.x===this.canonical.x>>o&&n.canonical.y===this.canonical.y>>o}children(n){if(this.overscaledZ>=n)return[new ns(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const o=this.canonical.z+1,h=2*this.canonical.x,g=2*this.canonical.y;return[new ns(o,this.wrap,o,h,g),new ns(o,this.wrap,o,h+1,g),new ns(o,this.wrap,o,h,g+1),new ns(o,this.wrap,o,h+1,g+1)]}isLessThan(n){return this.wrap<n.wrap||!(this.wrap>n.wrap)&&(this.overscaledZ<n.overscaledZ||!(this.overscaledZ>n.overscaledZ)&&(this.canonical.x<n.canonical.x||!(this.canonical.x>n.canonical.x)&&this.canonical.y<n.canonical.y))}wrapped(){return new ns(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(n){return new ns(this.overscaledZ,n,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new yx(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(n){return this.canonical.getTilePoint(new Tf(n.x-this.wrap,n.y))}}function hh(s,n,o,h,g){(s*=2)<0&&(s=-1*s-1);const y=1<<o;return(y*y*s+y*g+h).toString(36)+o.toString(36)+n.toString(36)}At("CanonicalTileID",Pg),At("OverscaledTileID",ns,{omit:["posMatrix"]});class vx{constructor(n,o,h){if(this.uid=n,o.height!==o.width)throw new RangeError("DEM tiles must be square");if(h&&h!=="mapbox"&&h!=="terrarium")return void he(`"${h}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=o.height;const g=this.dim=o.height-2;this.data=new Uint32Array(o.data.buffer),this.encoding=h||"mapbox";for(let y=0;y<g;y++)this.data[this._idx(-1,y)]=this.data[this._idx(0,y)],this.data[this._idx(g,y)]=this.data[this._idx(g-1,y)],this.data[this._idx(y,-1)]=this.data[this._idx(y,0)],this.data[this._idx(y,g)]=this.data[this._idx(y,g-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(g,-1)]=this.data[this._idx(g-1,0)],this.data[this._idx(-1,g)]=this.data[this._idx(0,g-1)],this.data[this._idx(g,g)]=this.data[this._idx(g-1,g-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let y=0;y<g;y++)for(let v=0;v<g;v++){const S=this.get(y,v);S>this.max&&(this.max=S),S<this.min&&(this.min=S)}}get(n,o){const h=new Uint8Array(this.data.buffer),g=4*this._idx(n,o);return(this.encoding==="terrarium"?this._unpackTerrarium:this._unpackMapbox)(h[g],h[g+1],h[g+2])}getUnpackVector(){return this.encoding==="terrarium"?[256,1,1/256,32768]:[6553.6,25.6,.1,1e4]}_idx(n,o){if(n<-1||n>=this.dim+1||o<-1||o>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(o+1)*this.stride+(n+1)}_unpackMapbox(n,o,h){return(256*n*256+256*o+h)/10-1e4}_unpackTerrarium(n,o,h){return 256*n+o+h/256-32768}getPixels(){return new ts({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(n,o,h){if(this.dim!==n.dim)throw new Error("dem dimension mismatch");let g=o*this.dim,y=o*this.dim+this.dim,v=h*this.dim,S=h*this.dim+this.dim;switch(o){case-1:g=y-1;break;case 1:y=g+1}switch(h){case-1:v=S-1;break;case 1:S=v+1}const T=-o*this.dim,R=-h*this.dim;for(let D=v;D<S;D++)for(let B=g;B<y;B++)this.data[this._idx(B,D)]=n.data[this._idx(B+T,D+R)]}}At("DEMData",vx);class xx{constructor(n){this._stringToNumber={},this._numberToString=[];for(let o=0;o<n.length;o++){const h=n[o];this._stringToNumber[h]=o,this._numberToString[o]=h}}encode(n){return this._stringToNumber[n]}decode(n){if(n>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${n} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[n]}}class bx{constructor(n,o,h,g,y){this.type="Feature",this._vectorTileFeature=n,n._z=o,n._x=h,n._y=g,this.properties=n.properties,this.id=y}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(n){this._geometry=n}toJSON(){const n={geometry:this.geometry};for(const o in this)o!=="_geometry"&&o!=="_vectorTileFeature"&&(n[o]=this[o]);return n}}class wx{constructor(n,o){this.tileID=n,this.x=n.canonical.x,this.y=n.canonical.y,this.z=n.canonical.z,this.grid=new Ho(Gn,16,0),this.grid3D=new Ho(Gn,16,0),this.featureIndexArray=new G,this.promoteId=o}insert(n,o,h,g,y,v){const S=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(h,g,y);const T=v?this.grid3D:this.grid;for(let R=0;R<o.length;R++){const D=o[R],B=[1/0,1/0,-1/0,-1/0];for(let N=0;N<D.length;N++){const V=D[N];B[0]=Math.min(B[0],V.x),B[1]=Math.min(B[1],V.y),B[2]=Math.max(B[2],V.x),B[3]=Math.max(B[3],V.y)}B[0]<Gn&&B[1]<Gn&&B[2]>=0&&B[3]>=0&&T.insert(S,B[0],B[1],B[2],B[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new no.VectorTile(new yg(this.rawTileData)).layers,this.sourceLayerCoder=new xx(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(n,o,h,g){this.loadVTLayers();const y=n.params||{},v=Gn/n.tileSize/n.scale,S=Mu(y.filter),T=n.queryGeometry,R=n.queryPadding*v,D=Ex(T),B=this.grid.query(D.minX-R,D.minY-R,D.maxX+R,D.maxY+R),N=Ex(n.cameraQueryGeometry),V=this.grid3D.query(N.minX-R,N.minY-R,N.maxX+R,N.maxY+R,(Q,_e,Ee,pe)=>function(Re,ze,We,Tt,Rt){for(const _t of Re)if(ze<=_t.x&&We<=_t.y&&Tt>=_t.x&&Rt>=_t.y)return!0;const xt=[new I(ze,We),new I(ze,Rt),new I(Tt,Rt),new I(Tt,We)];if(Re.length>2){for(const _t of xt)if(uc(Re,_t))return!0}for(let _t=0;_t<Re.length-1;_t++)if(fC(Re[_t],Re[_t+1],xt))return!0;return!1}(n.cameraQueryGeometry,Q-R,_e-R,Ee+R,pe+R));for(const Q of V)B.push(Q);B.sort(AI);const q={};let te;for(let Q=0;Q<B.length;Q++){const _e=B[Q];if(_e===te)continue;te=_e;const Ee=this.featureIndexArray.get(_e);let pe=null;this.loadMatchingFeature(q,Ee.bucketIndex,Ee.sourceLayerIndex,Ee.featureIndex,S,y.layers,y.availableImages,o,h,g,(Re,ze,We)=>(pe||(pe=Ls(Re)),ze.queryIntersectsFeature(T,Re,We,pe,this.z,n.transform,v,n.pixelPosMatrix)))}return q}loadMatchingFeature(n,o,h,g,y,v,S,T,R,D,B){const N=this.bucketLayerIDs[o];if(v&&!function(Q,_e){for(let Ee=0;Ee<Q.length;Ee++)if(_e.indexOf(Q[Ee])>=0)return!0;return!1}(v,N))return;const V=this.sourceLayerCoder.decode(h),q=this.vtLayers[V].feature(g);if(y.needGeometry){const Q=el(q,!0);if(!y.filter(new Wn(this.tileID.overscaledZ),Q,this.tileID.canonical))return}else if(!y.filter(new Wn(this.tileID.overscaledZ),q))return;const te=this.getId(q,V);for(let Q=0;Q<N.length;Q++){const _e=N[Q];if(v&&v.indexOf(_e)<0)continue;const Ee=T[_e];if(!Ee)continue;let pe={};te&&D&&(pe=D.getState(Ee.sourceLayer||"_geojsonTileLayer",te));const Re=ye({},R[_e]);Re.paint=Sx(Re.paint,Ee.paint,q,pe,S),Re.layout=Sx(Re.layout,Ee.layout,q,pe,S);const ze=!B||B(q,Ee,pe);if(!ze)continue;const We=new bx(q,this.z,this.x,this.y,te);We.layer=Re;let Tt=n[_e];Tt===void 0&&(Tt=n[_e]=[]),Tt.push({featureIndex:g,feature:We,intersectionZ:ze})}}lookupSymbolFeatures(n,o,h,g,y,v,S,T){const R={};this.loadVTLayers();const D=Mu(y);for(const B of n)this.loadMatchingFeature(R,h,g,B,D,v,S,T,o);return R}hasLayer(n){for(const o of this.bucketLayerIDs)for(const h of o)if(n===h)return!0;return!1}getId(n,o){let h=n.id;return this.promoteId&&(h=n.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[o]],typeof h=="boolean"&&(h=Number(h))),h}}function Sx(s,n,o,h,g){return Le(s,(y,v)=>{const S=n instanceof ec?n.get(v):null;return S&&S.evaluate?S.evaluate(o,h,g):S})}function Ex(s){let n=1/0,o=1/0,h=-1/0,g=-1/0;for(const y of s)n=Math.min(n,y.x),o=Math.min(o,y.y),h=Math.max(h,y.x),g=Math.max(g,y.y);return{minX:n,minY:o,maxX:h,maxY:g}}function AI(s,n){return n-s}function Tx(s,n,o,h,g){const y=[];for(let v=0;v<s.length;v++){const S=s[v];let T;for(let R=0;R<S.length-1;R++){let D=S[R],B=S[R+1];D.x<n&&B.x<n||(D.x<n?D=new I(n,D.y+(n-D.x)/(B.x-D.x)*(B.y-D.y))._round():B.x<n&&(B=new I(n,D.y+(n-D.x)/(B.x-D.x)*(B.y-D.y))._round()),D.y<o&&B.y<o||(D.y<o?D=new I(D.x+(o-D.y)/(B.y-D.y)*(B.x-D.x),o)._round():B.y<o&&(B=new I(D.x+(o-D.y)/(B.y-D.y)*(B.x-D.x),o)._round()),D.x>=h&&B.x>=h||(D.x>=h?D=new I(h,D.y+(h-D.x)/(B.x-D.x)*(B.y-D.y))._round():B.x>=h&&(B=new I(h,D.y+(h-D.x)/(B.x-D.x)*(B.y-D.y))._round()),D.y>=g&&B.y>=g||(D.y>=g?D=new I(D.x+(g-D.y)/(B.y-D.y)*(B.x-D.x),g)._round():B.y>=g&&(B=new I(D.x+(g-D.y)/(B.y-D.y)*(B.x-D.x),g)._round()),T&&D.equals(T[T.length-1])||(T=[D],y.push(T)),T.push(B)))))}}return y}At("FeatureIndex",wx,{omit:["rawTileData","sourceLayerCoder"]});class ao extends I{constructor(n,o,h,g){super(n,o),this.angle=h,g!==void 0&&(this.segment=g)}clone(){return new ao(this.x,this.y,this.angle,this.segment)}}function Cx(s,n,o,h,g){if(n.segment===void 0)return!0;let y=n,v=n.segment+1,S=0;for(;S>-o/2;){if(v--,v<0)return!1;S-=s[v].dist(y),y=s[v]}S+=s[v].dist(s[v+1]),v++;const T=[];let R=0;for(;S<o/2;){const D=s[v],B=s[v+1];if(!B)return!1;let N=s[v-1].angleTo(D)-D.angleTo(B);for(N=Math.abs((N+3*Math.PI)%(2*Math.PI)-Math.PI),T.push({distance:S,angleDelta:N}),R+=N;S-T[0].distance>h;)R-=T.shift().angleDelta;if(R>g)return!1;v++,S+=D.dist(B)}return!0}function Ix(s){let n=0;for(let o=0;o<s.length-1;o++)n+=s[o].dist(s[o+1]);return n}function kx(s,n,o){return s?.6*n*o:0}function Ax(s,n){return Math.max(s?s.right-s.left:0,n?n.right-n.left:0)}function PI(s,n,o,h,g,y){const v=kx(o,g,y),S=Ax(o,h)*y;let T=0;const R=Ix(s)/2;for(let D=0;D<s.length-1;D++){const B=s[D],N=s[D+1],V=B.dist(N);if(T+V>R){const q=(R-T)/V,te=xr.number(B.x,N.x,q),Q=xr.number(B.y,N.y,q),_e=new ao(te,Q,N.angleTo(B),D);return _e._round(),!v||Cx(s,_e,S,v,n)?_e:void 0}T+=V}}function RI(s,n,o,h,g,y,v,S,T){const R=kx(h,y,v),D=Ax(h,g),B=D*v,N=s[0].x===0||s[0].x===T||s[0].y===0||s[0].y===T;return n-B<n/4&&(n=B+n/4),Px(s,N?n/2*S%n:(D/2+2*y)*v*S%n,n,R,o,B,N,!1,T)}function Px(s,n,o,h,g,y,v,S,T){const R=y/2,D=Ix(s);let B=0,N=n-o,V=[];for(let q=0;q<s.length-1;q++){const te=s[q],Q=s[q+1],_e=te.dist(Q),Ee=Q.angleTo(te);for(;N+o<B+_e;){N+=o;const pe=(N-B)/_e,Re=xr.number(te.x,Q.x,pe),ze=xr.number(te.y,Q.y,pe);if(Re>=0&&Re<T&&ze>=0&&ze<T&&N-R>=0&&N+R<=D){const We=new ao(Re,ze,Ee,q);We._round(),h&&!Cx(s,We,y,h,g)||V.push(We)}}B+=_e}return S||V.length||v||(V=Px(s,B/2,o,h,g,y,v,!0,T)),V}At("Anchor",ao);const yc=Er;function Rx(s,n,o,h){const g=[],y=s.image,v=y.pixelRatio,S=y.paddedRect.w-2*yc,T=y.paddedRect.h-2*yc,R=s.right-s.left,D=s.bottom-s.top,B=y.stretchX||[[0,S]],N=y.stretchY||[[0,T]],V=(pt,bt)=>pt+bt[1]-bt[0],q=B.reduce(V,0),te=N.reduce(V,0),Q=S-q,_e=T-te;let Ee=0,pe=q,Re=0,ze=te,We=0,Tt=Q,Rt=0,xt=_e;if(y.content&&h){const pt=y.content;Ee=Cf(B,0,pt[0]),Re=Cf(N,0,pt[1]),pe=Cf(B,pt[0],pt[2]),ze=Cf(N,pt[1],pt[3]),We=pt[0]-Ee,Rt=pt[1]-Re,Tt=pt[2]-pt[0]-pe,xt=pt[3]-pt[1]-ze}const _t=(pt,bt,yt,lt)=>{const $t=If(pt.stretch-Ee,pe,R,s.left),Dt=kf(pt.fixed-We,Tt,pt.stretch,q),an=If(bt.stretch-Re,ze,D,s.top),qn=kf(bt.fixed-Rt,xt,bt.stretch,te),Zn=If(yt.stretch-Ee,pe,R,s.left),Ii=kf(yt.fixed-We,Tt,yt.stretch,q),is=If(lt.stretch-Re,ze,D,s.top),qi=kf(lt.fixed-Rt,xt,lt.stretch,te),xi=new I($t,an),Li=new I(Zn,an),Hi=new I(Zn,is),nr=new I($t,is),Tr=new I(Dt/v,qn/v),bi=new I(Ii/v,qi/v),Wi=n*Math.PI/180;if(Wi){const Cr=Math.sin(Wi),Ir=Math.cos(Wi),oi=[Ir,-Cr,Cr,Ir];xi._matMult(oi),Li._matMult(oi),nr._matMult(oi),Hi._matMult(oi)}const ir=pt.stretch+pt.fixed,pr=bt.stretch+bt.fixed;return{tl:xi,tr:Li,bl:nr,br:Hi,tex:{x:y.paddedRect.x+yc+ir,y:y.paddedRect.y+yc+pr,w:yt.stretch+yt.fixed-ir,h:lt.stretch+lt.fixed-pr},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Tr,pixelOffsetBR:bi,minFontScaleX:Tt/v/R,minFontScaleY:xt/v/D,isSDF:o}};if(h&&(y.stretchX||y.stretchY)){const pt=Mx(B,Q,q),bt=Mx(N,_e,te);for(let yt=0;yt<pt.length-1;yt++){const lt=pt[yt],$t=pt[yt+1];for(let Dt=0;Dt<bt.length-1;Dt++)g.push(_t(lt,bt[Dt],$t,bt[Dt+1]))}}else g.push(_t({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:S+1},{fixed:0,stretch:T+1}));return g}function Cf(s,n,o){let h=0;for(const g of s)h+=Math.max(n,Math.min(o,g[1]))-Math.max(n,Math.min(o,g[0]));return h}function Mx(s,n,o){const h=[{fixed:-yc,stretch:0}];for(const[g,y]of s){const v=h[h.length-1];h.push({fixed:g-v.stretch,stretch:v.stretch}),h.push({fixed:g-v.stretch,stretch:v.stretch+(y-g)})}return h.push({fixed:n+yc,stretch:o}),h}function If(s,n,o,h){return s/n*o+h}function kf(s,n,o,h){return s-n*o/h}class Af{constructor(n,o,h,g,y,v,S,T,R,D){if(this.boxStartIndex=n.length,R){let B=v.top,N=v.bottom;const V=v.collisionPadding;V&&(B-=V[1],N+=V[3]);let q=N-B;q>0&&(q=Math.max(10,q),this.circleDiameter=q)}else{let B=v.top*S-T[0],N=v.bottom*S+T[2],V=v.left*S-T[3],q=v.right*S+T[1];const te=v.collisionPadding;if(te&&(V-=te[0]*S,B-=te[1]*S,q+=te[2]*S,N+=te[3]*S),D){const Q=new I(V,B),_e=new I(q,B),Ee=new I(V,N),pe=new I(q,N),Re=D*Math.PI/180;Q._rotate(Re),_e._rotate(Re),Ee._rotate(Re),pe._rotate(Re),V=Math.min(Q.x,_e.x,Ee.x,pe.x),q=Math.max(Q.x,_e.x,Ee.x,pe.x),B=Math.min(Q.y,_e.y,Ee.y,pe.y),N=Math.max(Q.y,_e.y,Ee.y,pe.y)}n.emplaceBack(o.x,o.y,V,B,q,N,h,g,y)}this.boxEndIndex=n.length}}class MI{constructor(n=[],o=DI){if(this.data=n,this.length=this.data.length,this.compare=o,this.length>0)for(let h=(this.length>>1)-1;h>=0;h--)this._down(h)}push(n){this.data.push(n),this.length++,this._up(this.length-1)}pop(){if(this.length===0)return;const n=this.data[0],o=this.data.pop();return this.length--,this.length>0&&(this.data[0]=o,this._down(0)),n}peek(){return this.data[0]}_up(n){const{data:o,compare:h}=this,g=o[n];for(;n>0;){const y=n-1>>1,v=o[y];if(h(g,v)>=0)break;o[n]=v,n=y}o[n]=g}_down(n){const{data:o,compare:h}=this,g=this.length>>1,y=o[n];for(;n<g;){let v=1+(n<<1),S=o[v];const T=v+1;if(T<this.length&&h(o[T],S)<0&&(v=T,S=o[T]),h(S,y)>=0)break;o[n]=S,n=v}o[n]=y}}function DI(s,n){return s<n?-1:s>n?1:0}function LI(s,n=1,o=!1){let h=1/0,g=1/0,y=-1/0,v=-1/0;const S=s[0];for(let V=0;V<S.length;V++){const q=S[V];(!V||q.x<h)&&(h=q.x),(!V||q.y<g)&&(g=q.y),(!V||q.x>y)&&(y=q.x),(!V||q.y>v)&&(v=q.y)}const T=Math.min(y-h,v-g);let R=T/2;const D=new MI([],zI);if(T===0)return new I(h,g);for(let V=h;V<y;V+=T)for(let q=g;q<v;q+=T)D.push(new vc(V+R,q+R,R,s));let B=function(V){let q=0,te=0,Q=0;const _e=V[0];for(let Ee=0,pe=_e.length,Re=pe-1;Ee<pe;Re=Ee++){const ze=_e[Ee],We=_e[Re],Tt=ze.x*We.y-We.x*ze.y;te+=(ze.x+We.x)*Tt,Q+=(ze.y+We.y)*Tt,q+=3*Tt}return new vc(te/q,Q/q,0,V)}(s),N=D.length;for(;D.length;){const V=D.pop();(V.d>B.d||!B.d)&&(B=V,o&&console.log("found best %d after %d probes",Math.round(1e4*V.d)/1e4,N)),V.max-B.d<=n||(R=V.h/2,D.push(new vc(V.p.x-R,V.p.y-R,R,s)),D.push(new vc(V.p.x+R,V.p.y-R,R,s)),D.push(new vc(V.p.x-R,V.p.y+R,R,s)),D.push(new vc(V.p.x+R,V.p.y+R,R,s)),N+=4)}return o&&(console.log(`num probes: ${N}`),console.log(`best distance: ${B.d}`)),B.p}function zI(s,n){return n.max-s.max}function vc(s,n,o,h){this.p=new I(s,n),this.h=o,this.d=function(g,y){let v=!1,S=1/0;for(let T=0;T<y.length;T++){const R=y[T];for(let D=0,B=R.length,N=B-1;D<B;N=D++){const V=R[D],q=R[N];V.y>g.y!=q.y>g.y&&g.x<(q.x-V.x)*(g.y-V.y)/(q.y-V.y)+V.x&&(v=!v),S=Math.min(S,m0(g,V,q))}}return(v?1:-1)*Math.sqrt(S)}(this.p,h),this.max=this.d+this.h*Math.SQRT2}const Rg=Number.POSITIVE_INFINITY;function Dx(s,n){return n[1]!==Rg?function(o,h,g){let y=0,v=0;switch(h=Math.abs(h),g=Math.abs(g),o){case"top-right":case"top-left":case"top":v=g-7;break;case"bottom-right":case"bottom-left":case"bottom":v=7-g}switch(o){case"top-right":case"bottom-right":case"right":y=-h;break;case"top-left":case"bottom-left":case"left":y=h}return[y,v]}(s,n[0],n[1]):function(o,h){let g=0,y=0;h<0&&(h=0);const v=h/Math.sqrt(2);switch(o){case"top-right":case"top-left":y=v-7;break;case"bottom-right":case"bottom-left":y=7-v;break;case"bottom":y=7-h;break;case"top":y=h-7}switch(o){case"top-right":case"bottom-right":g=-v;break;case"top-left":case"bottom-left":g=v;break;case"left":g=h;break;case"right":g=-h}return[g,y]}(s,n[0])}function Mg(s){switch(s){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function OI(s,n,o,h,g,y,v,S,T,R,D){let B=y.textMaxSize.evaluate(n,{});B===void 0&&(B=v);const N=s.layers[0].layout,V=N.get("icon-offset").evaluate(n,{},D),q=zx(o.horizontal),te=v/24,Q=s.tilePixelRatio*te,_e=s.tilePixelRatio*B/24,Ee=s.tilePixelRatio*S,pe=s.tilePixelRatio*N.get("symbol-spacing"),Re=N.get("text-padding")*s.tilePixelRatio,ze=function(lt,$t,Dt,an=1){const qn=lt.get("icon-padding").evaluate($t,{},Dt),Zn=qn&&qn.values;return[Zn[0]*an,Zn[1]*an,Zn[2]*an,Zn[3]*an]}(N,n,D,s.tilePixelRatio),We=N.get("text-max-angle")/180*Math.PI,Tt=N.get("text-rotation-alignment")!=="viewport"&&N.get("symbol-placement")!=="point",Rt=N.get("icon-rotation-alignment")==="map"&&N.get("symbol-placement")!=="point",xt=N.get("symbol-placement"),_t=pe/2,pt=N.get("icon-text-fit");let bt;h&&pt!=="none"&&(s.allowVerticalPlacement&&o.vertical&&(bt=sx(h,o.vertical,pt,N.get("icon-text-fit-padding"),V,te)),q&&(h=sx(h,q,pt,N.get("icon-text-fit-padding"),V,te)));const yt=(lt,$t)=>{$t.x<0||$t.x>=Gn||$t.y<0||$t.y>=Gn||function(Dt,an,qn,Zn,Ii,is,qi,xi,Li,Hi,nr,Tr,bi,Wi,ir,pr,Cr,Ir,oi,Zi,on,Gr,Yi,rr,xs){const zs=Dt.addToLineVertexArray(an,qn);let Os,Ea,bs,rs,kr=0,Ta=0,ph=0,Nx=0,Ug=-1,$g=-1;const Ca={};let Ux=fi(""),Vg=0,jg=0;if(xi._unevaluatedLayout.getValue("text-radial-offset")===void 0?[Vg,jg]=xi.layout.get("text-offset").evaluate(on,{},rr).map(Ar=>Ar*Di):(Vg=xi.layout.get("text-radial-offset").evaluate(on,{},rr)*Di,jg=Rg),Dt.allowVerticalPlacement&&Zn.vertical){const Ar=xi.layout.get("text-rotate").evaluate(on,{},rr)+90;bs=new Af(Li,an,Hi,nr,Tr,Zn.vertical,bi,Wi,ir,Ar),qi&&(rs=new Af(Li,an,Hi,nr,Tr,qi,Cr,Ir,ir,Ar))}if(Ii){const Ar=xi.layout.get("icon-rotate").evaluate(on,{}),ta=xi.layout.get("icon-text-fit")!=="none",mh=Rx(Ii,Ar,Yi,ta),gh=qi?Rx(qi,Ar,Yi,ta):void 0;Ea=new Af(Li,an,Hi,nr,Tr,Ii,Cr,Ir,!1,Ar),kr=4*mh.length;const jx=Dt.iconSizeData;let nl=null;jx.kind==="source"?(nl=[ea*xi.layout.get("icon-size").evaluate(on,{})],nl[0]>ro&&he(`${Dt.layerIds[0]}: Value for "icon-size" is >= ${uh}. Reduce your "icon-size".`)):jx.kind==="composite"&&(nl=[ea*Gr.compositeIconSizes[0].evaluate(on,{},rr),ea*Gr.compositeIconSizes[1].evaluate(on,{},rr)],(nl[0]>ro||nl[1]>ro)&&he(`${Dt.layerIds[0]}: Value for "icon-size" is >= ${uh}. Reduce your "icon-size".`)),Dt.addSymbols(Dt.icon,mh,nl,Zi,oi,on,l.WritingMode.none,an,zs.lineStartIndex,zs.lineLength,-1,rr),Ug=Dt.icon.placedSymbolArray.length-1,gh&&(Ta=4*gh.length,Dt.addSymbols(Dt.icon,gh,nl,Zi,oi,on,l.WritingMode.vertical,an,zs.lineStartIndex,zs.lineLength,-1,rr),$g=Dt.icon.placedSymbolArray.length-1)}const $x=Object.keys(Zn.horizontal);for(const Ar of $x){const ta=Zn.horizontal[Ar];if(!Os){Ux=fi(ta.text);const gh=xi.layout.get("text-rotate").evaluate(on,{},rr);Os=new Af(Li,an,Hi,nr,Tr,ta,bi,Wi,ir,gh)}const mh=ta.positionedLines.length===1;if(ph+=Lx(Dt,an,ta,is,xi,ir,on,pr,zs,Zn.vertical?l.WritingMode.horizontal:l.WritingMode.horizontalOnly,mh?$x:[Ar],Ca,Ug,Gr,rr),mh)break}Zn.vertical&&(Nx+=Lx(Dt,an,Zn.vertical,is,xi,ir,on,pr,zs,l.WritingMode.vertical,["vertical"],Ca,$g,Gr,rr));const NI=Os?Os.boxStartIndex:Dt.collisionBoxArray.length,UI=Os?Os.boxEndIndex:Dt.collisionBoxArray.length,$I=bs?bs.boxStartIndex:Dt.collisionBoxArray.length,VI=bs?bs.boxEndIndex:Dt.collisionBoxArray.length,jI=Ea?Ea.boxStartIndex:Dt.collisionBoxArray.length,GI=Ea?Ea.boxEndIndex:Dt.collisionBoxArray.length,qI=rs?rs.boxStartIndex:Dt.collisionBoxArray.length,HI=rs?rs.boxEndIndex:Dt.collisionBoxArray.length;let Bs=-1;const Rf=(Ar,ta)=>Ar&&Ar.circleDiameter?Math.max(Ar.circleDiameter,ta):ta;Bs=Rf(Os,Bs),Bs=Rf(bs,Bs),Bs=Rf(Ea,Bs),Bs=Rf(rs,Bs);const Vx=Bs>-1?1:0;Vx&&(Bs*=xs/Di),Dt.glyphOffsetArray.length>=_c.MAX_GLYPHS&&he("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),on.sortKey!==void 0&&Dt.addToSortKeyRanges(Dt.symbolInstances.length,on.sortKey),Dt.symbolInstances.emplaceBack(an.x,an.y,Ca.right>=0?Ca.right:-1,Ca.center>=0?Ca.center:-1,Ca.left>=0?Ca.left:-1,Ca.vertical||-1,Ug,$g,Ux,NI,UI,$I,VI,jI,GI,qI,HI,Hi,ph,Nx,kr,Ta,Vx,0,bi,Vg,jg,Bs)}(s,$t,lt,o,h,g,bt,s.layers[0],s.collisionBoxArray,n.index,n.sourceLayerIndex,s.index,Q,[Re,Re,Re,Re],Tt,T,Ee,ze,Rt,V,n,y,R,D,v)};if(xt==="line")for(const lt of Tx(n.geometry,0,0,Gn,Gn)){const $t=RI(lt,pe,We,o.vertical||q,h,24,_e,s.overscaling,Gn);for(const Dt of $t)q&&BI(s,q.text,_t,Dt)||yt(lt,Dt)}else if(xt==="line-center"){for(const lt of n.geometry)if(lt.length>1){const $t=PI(lt,We,o.vertical||q,h,24,_e);$t&&yt(lt,$t)}}else if(n.type==="Polygon")for(const lt of ug(n.geometry,0)){const $t=LI(lt,16);yt(lt[0],new ao($t.x,$t.y,0))}else if(n.type==="LineString")for(const lt of n.geometry)yt(lt,new ao(lt[0].x,lt[0].y,0));else if(n.type==="Point")for(const lt of n.geometry)for(const $t of lt)yt([$t],new ao($t.x,$t.y,0))}function Lx(s,n,o,h,g,y,v,S,T,R,D,B,N,V,q){const te=function(Ee,pe,Re,ze,We,Tt,Rt,xt){const _t=ze.layout.get("text-rotate").evaluate(Tt,{})*Math.PI/180,pt=[];for(const bt of pe.positionedLines)for(const yt of bt.positionedGlyphs){if(!yt.rect)continue;const lt=yt.rect||{};let $t=J0+1,Dt=!0,an=1,qn=0;const Zn=(We||xt)&&yt.vertical,Ii=yt.metrics.advance*yt.scale/2;if(xt&&pe.verticalizable&&(qn=bt.lineOffset/2-(yt.imageName?-(Di-yt.metrics.width*yt.scale)/2:(yt.scale-1)*Di)),yt.imageName){const oi=Rt[yt.imageName];Dt=oi.sdf,an=oi.pixelRatio,$t=Er/an}const is=We?[yt.x+Ii,yt.y]:[0,0];let qi=We?[0,0]:[yt.x+Ii+Re[0],yt.y+Re[1]-qn],xi=[0,0];Zn&&(xi=qi,qi=[0,0]);const Li=(yt.metrics.left-$t)*yt.scale-Ii+qi[0],Hi=(-yt.metrics.top-$t)*yt.scale+qi[1],nr=Li+lt.w*yt.scale/an,Tr=Hi+lt.h*yt.scale/an,bi=new I(Li,Hi),Wi=new I(nr,Hi),ir=new I(Li,Tr),pr=new I(nr,Tr);if(Zn){const oi=new I(-Ii,Ii-lh),Zi=-Math.PI/2,on=Di/2-Ii,Gr=new I(5-lh-on,-(yt.imageName?on:0)),Yi=new I(...xi);bi._rotateAround(Zi,oi)._add(Gr)._add(Yi),Wi._rotateAround(Zi,oi)._add(Gr)._add(Yi),ir._rotateAround(Zi,oi)._add(Gr)._add(Yi),pr._rotateAround(Zi,oi)._add(Gr)._add(Yi)}if(_t){const oi=Math.sin(_t),Zi=Math.cos(_t),on=[Zi,-oi,oi,Zi];bi._matMult(on),Wi._matMult(on),ir._matMult(on),pr._matMult(on)}const Cr=new I(0,0),Ir=new I(0,0);pt.push({tl:bi,tr:Wi,bl:ir,br:pr,tex:lt,writingMode:pe.writingMode,glyphOffset:is,sectionIndex:yt.sectionIndex,isSDF:Dt,pixelOffsetTL:Cr,pixelOffsetBR:Ir,minFontScaleX:0,minFontScaleY:0})}return pt}(0,o,S,g,y,v,h,s.allowVerticalPlacement),Q=s.textSizeData;let _e=null;Q.kind==="source"?(_e=[ea*g.layout.get("text-size").evaluate(v,{})],_e[0]>ro&&he(`${s.layerIds[0]}: Value for "text-size" is >= ${uh}. Reduce your "text-size".`)):Q.kind==="composite"&&(_e=[ea*V.compositeTextSizes[0].evaluate(v,{},q),ea*V.compositeTextSizes[1].evaluate(v,{},q)],(_e[0]>ro||_e[1]>ro)&&he(`${s.layerIds[0]}: Value for "text-size" is >= ${uh}. Reduce your "text-size".`)),s.addSymbols(s.text,te,_e,S,y,v,R,n,T.lineStartIndex,T.lineLength,N,q);for(const Ee of D)B[Ee]=s.text.placedSymbolArray.length-1;return 4*te.length}function zx(s){for(const n in s)return s[n];return null}function BI(s,n,o,h){const g=s.compareText;if(n in g){const y=g[n];for(let v=y.length-1;v>=0;v--)if(h.dist(y[v])<o)return!0}else g[n]=[];return g[n].push(h),!1}const Ox=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class Dg{static from(n){if(!(n instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[o,h]=new Uint8Array(n,0,2);if(o!==219)throw new Error("Data does not appear to be in a KDBush format.");const g=h>>4;if(g!==1)throw new Error(`Got v${g} data when expected v1.`);const y=Ox[15&h];if(!y)throw new Error("Unrecognized array type.");const[v]=new Uint16Array(n,2,1),[S]=new Uint32Array(n,4,1);return new Dg(S,v,y,n)}constructor(n,o=64,h=Float64Array,g){if(isNaN(n)||n<0)throw new Error(`Unpexpected numItems value: ${n}.`);this.numItems=+n,this.nodeSize=Math.min(Math.max(+o,2),65535),this.ArrayType=h,this.IndexArrayType=n<65536?Uint16Array:Uint32Array;const y=Ox.indexOf(this.ArrayType),v=2*n*this.ArrayType.BYTES_PER_ELEMENT,S=n*this.IndexArrayType.BYTES_PER_ELEMENT,T=(8-S%8)%8;if(y<0)throw new Error(`Unexpected typed array class: ${h}.`);g&&g instanceof ArrayBuffer?(this.data=g,this.ids=new this.IndexArrayType(this.data,8,n),this.coords=new this.ArrayType(this.data,8+S+T,2*n),this._pos=2*n,this._finished=!0):(this.data=new ArrayBuffer(8+v+S+T),this.ids=new this.IndexArrayType(this.data,8,n),this.coords=new this.ArrayType(this.data,8+S+T,2*n),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+y]),new Uint16Array(this.data,2,1)[0]=o,new Uint32Array(this.data,4,1)[0]=n)}add(n,o){const h=this._pos>>1;return this.ids[h]=h,this.coords[this._pos++]=n,this.coords[this._pos++]=o,h}finish(){const n=this._pos>>1;if(n!==this.numItems)throw new Error(`Added ${n} items when expected ${this.numItems}.`);return Lg(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(n,o,h,g){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:y,coords:v,nodeSize:S}=this,T=[0,y.length-1,0],R=[];for(;T.length;){const D=T.pop()||0,B=T.pop()||0,N=T.pop()||0;if(B-N<=S){for(let Q=N;Q<=B;Q++){const _e=v[2*Q],Ee=v[2*Q+1];_e>=n&&_e<=h&&Ee>=o&&Ee<=g&&R.push(y[Q])}continue}const V=N+B>>1,q=v[2*V],te=v[2*V+1];q>=n&&q<=h&&te>=o&&te<=g&&R.push(y[V]),(D===0?n<=q:o<=te)&&(T.push(N),T.push(V-1),T.push(1-D)),(D===0?h>=q:g>=te)&&(T.push(V+1),T.push(B),T.push(1-D))}return R}within(n,o,h){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:g,coords:y,nodeSize:v}=this,S=[0,g.length-1,0],T=[],R=h*h;for(;S.length;){const D=S.pop()||0,B=S.pop()||0,N=S.pop()||0;if(B-N<=v){for(let Q=N;Q<=B;Q++)Fx(y[2*Q],y[2*Q+1],n,o)<=R&&T.push(g[Q]);continue}const V=N+B>>1,q=y[2*V],te=y[2*V+1];Fx(q,te,n,o)<=R&&T.push(g[V]),(D===0?n-h<=q:o-h<=te)&&(S.push(N),S.push(V-1),S.push(1-D)),(D===0?n+h>=q:o+h>=te)&&(S.push(V+1),S.push(B),S.push(1-D))}return T}}function Lg(s,n,o,h,g,y){if(g-h<=o)return;const v=h+g>>1;Bx(s,n,v,h,g,y),Lg(s,n,o,h,v-1,1-y),Lg(s,n,o,v+1,g,1-y)}function Bx(s,n,o,h,g,y){for(;g>h;){if(g-h>600){const R=g-h+1,D=o-h+1,B=Math.log(R),N=.5*Math.exp(2*B/3),V=.5*Math.sqrt(B*N*(R-N)/R)*(D-R/2<0?-1:1);Bx(s,n,o,Math.max(h,Math.floor(o-D*N/R+V)),Math.min(g,Math.floor(o+(R-D)*N/R+V)),y)}const v=n[2*o+y];let S=h,T=g;for(dh(s,n,h,o),n[2*g+y]>v&&dh(s,n,h,g);S<T;){for(dh(s,n,S,T),S++,T--;n[2*S+y]<v;)S++;for(;n[2*T+y]>v;)T--}n[2*h+y]===v?dh(s,n,h,T):(T++,dh(s,n,T,g)),T<=o&&(h=T+1),o<=T&&(g=T-1)}}function dh(s,n,o,h){zg(s,o,h),zg(n,2*o,2*h),zg(n,2*o+1,2*h+1)}function zg(s,n,o){const h=s[n];s[n]=s[o],s[o]=h}function Fx(s,n,o,h){const g=s-o,y=n-h;return g*g+y*y}var Og;l.PerformanceMarkers=void 0,(Og=l.PerformanceMarkers||(l.PerformanceMarkers={})).create="create",Og.load="load",Og.fullLoad="fullLoad";let Pf=null,fh=[];const Bg=1e3/60,Fg="loadTime",Ng="fullLoadTime",FI={mark(s){performance.mark(s)},frame(s){const n=s;Pf!=null&&fh.push(n-Pf),Pf=n},clearMetrics(){Pf=null,fh=[],performance.clearMeasures(Fg),performance.clearMeasures(Ng);for(const s in l.PerformanceMarkers)performance.clearMarks(l.PerformanceMarkers[s])},getPerformanceMetrics(){performance.measure(Fg,l.PerformanceMarkers.create,l.PerformanceMarkers.load),performance.measure(Ng,l.PerformanceMarkers.create,l.PerformanceMarkers.fullLoad);const s=performance.getEntriesByName(Fg)[0].duration,n=performance.getEntriesByName(Ng)[0].duration,o=fh.length,h=1/(fh.reduce((y,v)=>y+v,0)/o/1e3),g=fh.filter(y=>y>Bg).reduce((y,v)=>y+(v-Bg)/Bg,0);return{loadTime:s,fullLoadTime:n,fps:h,percentDroppedFrames:g/(o+g)*100,totalFrames:o}}};l.AJAXError=rt,l.ARRAY_TYPE=hc,l.Actor=class{constructor(s,n,o){this.target=s,this.parent=n,this.mapId=o,this.callbacks={},this.tasks={},this.taskQueue=[],this.cancelCallbacks={},Be(["receive","process"],this),this.invoker=new kI(this.process),this.target.addEventListener("message",this.receive,!1),this.globalScope=oe()?s:window}send(s,n,o,h,g=!1){const y=Math.round(1e18*Math.random()).toString(36).substring(0,10);o&&(this.callbacks[y]=o);const v=tt(this.globalScope)?void 0:[];return this.target.postMessage({id:y,type:s,hasCallback:!!o,targetMapId:h,mustQueue:g,sourceMapId:this.mapId,data:Wo(n,v)},v),{cancel:()=>{o&&delete this.callbacks[y],this.target.postMessage({id:y,type:"<cancel>",targetMapId:h,sourceMapId:this.mapId})}}}receive(s){const n=s.data,o=n.id;if(o&&(!n.targetMapId||this.mapId===n.targetMapId))if(n.type==="<cancel>"){delete this.tasks[o];const h=this.cancelCallbacks[o];delete this.cancelCallbacks[o],h&&h()}else oe()||n.mustQueue?(this.tasks[o]=n,this.taskQueue.push(o),this.invoker.trigger()):this.processTask(o,n)}process(){if(!this.taskQueue.length)return;const s=this.taskQueue.shift(),n=this.tasks[s];delete this.tasks[s],this.taskQueue.length&&this.invoker.trigger(),n&&this.processTask(s,n)}processTask(s,n){if(n.type==="<response>"){const o=this.callbacks[s];delete this.callbacks[s],o&&(n.error?o(Rs(n.error)):o(null,Rs(n.data)))}else{let o=!1;const h=tt(this.globalScope)?void 0:[],g=n.hasCallback?(S,T)=>{o=!0,delete this.cancelCallbacks[s],this.target.postMessage({id:s,type:"<response>",sourceMapId:this.mapId,error:S?Wo(S):null,data:Wo(T,h)},h)}:S=>{o=!0};let y=null;const v=Rs(n.data);if(this.parent[n.type])y=this.parent[n.type](n.sourceMapId,v,g);else if(this.parent.getWorkerSource){const S=n.type.split(".");y=this.parent.getWorkerSource(n.sourceMapId,S[0],v.source)[S[1]](v,g)}else g(new Error(`Could not find function ${n.type}`));!o&&y&&y.cancel&&(this.cancelCallbacks[s]=y.cancel)}}remove(){this.invoker.remove(),this.target.removeEventListener("message",this.receive,!1)}},l.AlphaImage=eh,l.CanonicalTileID=Pg,l.CollisionBoxArray=_,l.CollisionCircleLayoutArray=class extends rc{},l.Color=Yt,l.DEMData=vx,l.DataConstantProperty=zt,l.DictionaryCoder=xx,l.EXTENT=Gn,l.ErrorEvent=Y,l.EvaluationParameters=Wn,l.Event=ft,l.Evented=ie,l.FeatureIndex=wx,l.FillBucket=fg,l.FillExtrusionBucket=mg,l.GeoJSONFeature=bx,l.ImageAtlas=ex,l.ImagePosition=xg,l.KDBush=Dg,l.LineBucket=gg,l.LineStripIndexArray=class extends r{},l.LngLat=so,l.MercatorCoordinate=Tf,l.ONE_EM=Di,l.OverscaledTileID=ns,l.PerformanceUtils=FI,l.Point=I,l.Pos3dArray=class extends tc{},l.PosArray=ee,l.Properties=dr,l.Protobuf=yg,l.QuadTriangleArray=class extends sc{},l.RGBAImage=ts,l.RasterBoundsArray=class extends Wu{},l.RequestPerformance=class{constructor(s){this._marks={start:[s.url,"start"].join("#"),end:[s.url,"end"].join("#"),measure:s.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let s=performance.getEntriesByName(this._marks.measure);return s.length===0&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),s=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),s}},l.SegmentVector=gt,l.SymbolBucket=_c,l.Transitionable=af,l.TriangleIndexArray=it,l.Uniform1f=vs,l.Uniform1i=class extends tr{constructor(s,n){super(s,n),this.current=0}set(s){this.current!==s&&(this.current=s,this.gl.uniform1i(this.location,s))}},l.Uniform2f=class extends tr{constructor(s,n){super(s,n),this.current=[0,0]}set(s){s[0]===this.current[0]&&s[1]===this.current[1]||(this.current=s,this.gl.uniform2f(this.location,s[0],s[1]))}},l.Uniform3f=class extends tr{constructor(s,n){super(s,n),this.current=[0,0,0]}set(s){s[0]===this.current[0]&&s[1]===this.current[1]&&s[2]===this.current[2]||(this.current=s,this.gl.uniform3f(this.location,s[0],s[1],s[2]))}},l.Uniform4f=Jo,l.UniformColor=Gi,l.UniformMatrix4f=class extends tr{constructor(s,n){super(s,n),this.current=Ri}set(s){if(s[12]!==this.current[12]||s[0]!==this.current[0])return this.current=s,void this.gl.uniformMatrix4fv(this.location,!1,s);for(let n=1;n<16;n++)if(s[n]!==this.current[n]){this.current=s,this.gl.uniformMatrix4fv(this.location,!1,s);break}}},l.UnwrappedTileID=yx,l.ValidationError=Ge,l.ZoomHistory=Qd,l.addDynamicAttributes=Eg,l.arrayBufferToImage=function(s,n){const o=new Image;o.onload=()=>{n(null,o),URL.revokeObjectURL(o.src),o.onload=null,window.requestAnimationFrame(()=>{o.src=Ve})},o.onerror=()=>n(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const h=new Blob([new Uint8Array(s)],{type:"image/png"});o.src=s.byteLength?URL.createObjectURL(h):Ve},l.arrayBufferToImageBitmap=function(s,n){const o=new Blob([new Uint8Array(s)],{type:"image/png"});createImageBitmap(o).then(h=>{n(null,h)}).catch(h=>{n(new Error(`Could not load image because of ${h.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})},l.asyncAll=function(s,n,o){if(!s.length)return o(null,[]);let h=s.length;const g=new Array(s.length);let y=null;s.forEach((v,S)=>{n(v,(T,R)=>{T&&(y=T),g[S]=R,--h==0&&o(y,g)})})},l.bezier=Z,l.bindAll=Be,l.clamp=ce,l.clipLine=Tx,l.clone=function(s){var n=new hc(16);return n[0]=s[0],n[1]=s[1],n[2]=s[2],n[3]=s[3],n[4]=s[4],n[5]=s[5],n[6]=s[6],n[7]=s[7],n[8]=s[8],n[9]=s[9],n[10]=s[10],n[11]=s[11],n[12]=s[12],n[13]=s[13],n[14]=s[14],n[15]=s[15],n},l.clone$1=U,l.collisionCircleLayout=iI,l.config=Ct,l.copy=function(s,n){return s[0]=n[0],s[1]=n[1],s[2]=n[2],s[3]=n[3],s[4]=n[4],s[5]=n[5],s[6]=n[6],s[7]=n[7],s[8]=n[8],s[9]=n[9],s[10]=n[10],s[11]=n[11],s[12]=n[12],s[13]=n[13],s[14]=n[14],s[15]=n[15],s},l.create=function(){var s=new hc(16);return hc!=Float32Array&&(s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[11]=0,s[12]=0,s[13]=0,s[14]=0),s[0]=1,s[5]=1,s[10]=1,s[15]=1,s},l.createExpression=Qn,l.createFilter=Mu,l.createLayout=vi,l.createStyleLayer=function(s){return s.type==="custom"?new CI(s):new II[s.type](s)},l.deepEqual=function s(n,o){if(Array.isArray(n)){if(!Array.isArray(o)||n.length!==o.length)return!1;for(let h=0;h<n.length;h++)if(!s(n[h],o[h]))return!1;return!0}if(typeof n=="object"&&n!==null&&o!==null){if(typeof o!="object"||Object.keys(n).length!==Object.keys(o).length)return!1;for(const h in n)if(!s(n[h],o[h]))return!1;return!0}return n===o},l.derefLayers=function(s){s=s.slice();const n=Object.create(null);for(let o=0;o<s.length;o++)n[s[o].id]=s[o];for(let o=0;o<s.length;o++)"ref"in s[o]&&(s[o]=Ue(s[o],n[s[o].ref]));return s},l.diffStyles=function(s,n){if(!s)return[{command:Ze.setStyle,args:[n]}];let o=[];try{if(!Ne(s.version,n.version))return[{command:Ze.setStyle,args:[n]}];Ne(s.center,n.center)||o.push({command:Ze.setCenter,args:[n.center]}),Ne(s.zoom,n.zoom)||o.push({command:Ze.setZoom,args:[n.zoom]}),Ne(s.bearing,n.bearing)||o.push({command:Ze.setBearing,args:[n.bearing]}),Ne(s.pitch,n.pitch)||o.push({command:Ze.setPitch,args:[n.pitch]}),Ne(s.sprite,n.sprite)||o.push({command:Ze.setSprite,args:[n.sprite]}),Ne(s.glyphs,n.glyphs)||o.push({command:Ze.setGlyphs,args:[n.glyphs]}),Ne(s.transition,n.transition)||o.push({command:Ze.setTransition,args:[n.transition]}),Ne(s.light,n.light)||o.push({command:Ze.setLight,args:[n.light]});const h={},g=[];(function(v,S,T,R){let D;for(D in S=S||{},v=v||{})Object.prototype.hasOwnProperty.call(v,D)&&(Object.prototype.hasOwnProperty.call(S,D)||dt(D,T,R));for(D in S)Object.prototype.hasOwnProperty.call(S,D)&&(Object.prototype.hasOwnProperty.call(v,D)?Ne(v[D],S[D])||(v[D].type==="geojson"&&S[D].type==="geojson"&&ut(v,S,D)?T.push({command:Ze.setGeoJSONSourceData,args:[D,S[D].data]}):nt(D,S,T,R)):ct(D,S,T))})(s.sources,n.sources,g,h);const y=[];s.layers&&s.layers.forEach(v=>{h[v.source]?o.push({command:Ze.removeLayer,args:[v.id]}):y.push(v)}),o=o.concat(g),function(v,S,T){S=S||[];const R=(v=v||[]).map(Mt),D=S.map(Mt),B=v.reduce(wt,{}),N=S.reduce(wt,{}),V=R.slice(),q=Object.create(null);let te,Q,_e,Ee,pe,Re,ze;for(te=0,Q=0;te<R.length;te++)_e=R[te],Object.prototype.hasOwnProperty.call(N,_e)?Q++:(T.push({command:Ze.removeLayer,args:[_e]}),V.splice(V.indexOf(_e,Q),1));for(te=0,Q=0;te<D.length;te++)_e=D[D.length-1-te],V[V.length-1-te]!==_e&&(Object.prototype.hasOwnProperty.call(B,_e)?(T.push({command:Ze.removeLayer,args:[_e]}),V.splice(V.lastIndexOf(_e,V.length-Q),1)):Q++,Re=V[V.length-te],T.push({command:Ze.addLayer,args:[N[_e],Re]}),V.splice(V.length-te,0,_e),q[_e]=!0);for(te=0;te<D.length;te++)if(_e=D[te],Ee=B[_e],pe=N[_e],!q[_e]&&!Ne(Ee,pe))if(Ne(Ee.source,pe.source)&&Ne(Ee["source-layer"],pe["source-layer"])&&Ne(Ee.type,pe.type)){for(ze in mt(Ee.layout,pe.layout,T,_e,null,Ze.setLayoutProperty),mt(Ee.paint,pe.paint,T,_e,null,Ze.setPaintProperty),Ne(Ee.filter,pe.filter)||T.push({command:Ze.setFilter,args:[_e,pe.filter]}),Ne(Ee.minzoom,pe.minzoom)&&Ne(Ee.maxzoom,pe.maxzoom)||T.push({command:Ze.setLayerZoomRange,args:[_e,pe.minzoom,pe.maxzoom]}),Ee)Object.prototype.hasOwnProperty.call(Ee,ze)&&ze!=="layout"&&ze!=="paint"&&ze!=="filter"&&ze!=="metadata"&&ze!=="minzoom"&&ze!=="maxzoom"&&(ze.indexOf("paint.")===0?mt(Ee[ze],pe[ze],T,_e,ze.slice(6),Ze.setPaintProperty):Ne(Ee[ze],pe[ze])||T.push({command:Ze.setLayerProperty,args:[_e,ze,pe[ze]]}));for(ze in pe)Object.prototype.hasOwnProperty.call(pe,ze)&&!Object.prototype.hasOwnProperty.call(Ee,ze)&&ze!=="layout"&&ze!=="paint"&&ze!=="filter"&&ze!=="metadata"&&ze!=="minzoom"&&ze!=="maxzoom"&&(ze.indexOf("paint.")===0?mt(Ee[ze],pe[ze],T,_e,ze.slice(6),Ze.setPaintProperty):Ne(Ee[ze],pe[ze])||T.push({command:Ze.setLayerProperty,args:[_e,ze,pe[ze]]}))}else T.push({command:Ze.removeLayer,args:[_e]}),Re=V[V.lastIndexOf(_e)+1],T.push({command:Ze.addLayer,args:[pe,Re]})}(y,n.layers,o)}catch(h){console.warn("Unable to compute style diff:",h),o=[{command:Ze.setStyle,args:[n]}]}return o},l.dot=function(s,n){return s[0]*n[0]+s[1]*n[1]+s[2]*n[2]+s[3]*n[3]},l.earthRadius=kg,l.ease=ue,l.emitValidationErrors=Qa,l.emptyStyle=function(){const s={},n=W.$version;for(const o in W.$root){const h=W.$root[o];if(h.required){let g=null;g=o==="version"?n:h.type==="array"?[]:{},g!=null&&(s[o]=g)}}return s},l.equals=function(s,n){var o=s[0],h=s[1],g=s[2],y=s[3],v=s[4],S=s[5],T=s[6],R=s[7],D=s[8],B=s[9],N=s[10],V=s[11],q=s[12],te=s[13],Q=s[14],_e=s[15],Ee=n[0],pe=n[1],Re=n[2],ze=n[3],We=n[4],Tt=n[5],Rt=n[6],xt=n[7],_t=n[8],pt=n[9],bt=n[10],yt=n[11],lt=n[12],$t=n[13],Dt=n[14],an=n[15];return Math.abs(o-Ee)<=fr*Math.max(1,Math.abs(o),Math.abs(Ee))&&Math.abs(h-pe)<=fr*Math.max(1,Math.abs(h),Math.abs(pe))&&Math.abs(g-Re)<=fr*Math.max(1,Math.abs(g),Math.abs(Re))&&Math.abs(y-ze)<=fr*Math.max(1,Math.abs(y),Math.abs(ze))&&Math.abs(v-We)<=fr*Math.max(1,Math.abs(v),Math.abs(We))&&Math.abs(S-Tt)<=fr*Math.max(1,Math.abs(S),Math.abs(Tt))&&Math.abs(T-Rt)<=fr*Math.max(1,Math.abs(T),Math.abs(Rt))&&Math.abs(R-xt)<=fr*Math.max(1,Math.abs(R),Math.abs(xt))&&Math.abs(D-_t)<=fr*Math.max(1,Math.abs(D),Math.abs(_t))&&Math.abs(B-pt)<=fr*Math.max(1,Math.abs(B),Math.abs(pt))&&Math.abs(N-bt)<=fr*Math.max(1,Math.abs(N),Math.abs(bt))&&Math.abs(V-yt)<=fr*Math.max(1,Math.abs(V),Math.abs(yt))&&Math.abs(q-lt)<=fr*Math.max(1,Math.abs(q),Math.abs(lt))&&Math.abs(te-$t)<=fr*Math.max(1,Math.abs(te),Math.abs($t))&&Math.abs(Q-Dt)<=fr*Math.max(1,Math.abs(Q),Math.abs(Dt))&&Math.abs(_e-an)<=fr*Math.max(1,Math.abs(_e),Math.abs(an))},l.evaluateSizeForFeature=function(s,{uSize:n,uSizeT:o},{lowerSize:h,upperSize:g}){return s.kind==="source"?h/ea:s.kind==="composite"?xr.number(h/ea,g/ea,o):n},l.evaluateSizeForZoom=function(s,n){let o=0,h=0;if(s.kind==="constant")h=s.layoutSize;else if(s.kind!=="source"){const{interpolationType:g,minZoom:y,maxZoom:v}=s,S=g?ce(br.interpolationFactor(g,n,y,v),0,1):0;s.kind==="camera"?h=xr.number(s.minSize,s.maxSize,S):o=S}return{uSizeT:o,uSize:h}},l.evaluateVariableOffset=Dx,l.evented=Jl,l.exported=kt,l.extend=ye,l.filterObject=Ie,l.findLineIntersection=function(s,n,o,h){const g=n.y-s.y,y=n.x-s.x,v=h.y-o.y,S=h.x-o.x,T=v*y-S*g;if(T===0)return null;const R=(S*(s.y-o.y)-v*(s.x-o.x))/T;return new I(s.x+R*y,s.y+R*g)},l.fromScaling=function(s,n){return s[0]=n[0],s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=n[1],s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[10]=n[2],s[11]=0,s[12]=0,s[13]=0,s[14]=0,s[15]=1,s},l.getAnchorAlignment=wg,l.getAnchorJustification=Mg,l.getArrayBuffer=Se,l.getDefaultExportFromCjs=b,l.getJSON=function(s,n){return qe(ye(s,{type:"json"}),n)},l.getOverlapMode=Sg,l.getProtocolAction=Vt,l.getRTLTextPluginStatus=Vu,l.getReferrer=It,l.getVideo=function(s,n){const o=window.document.createElement("video");o.muted=!0,o.onloadstart=function(){n(null,o)};for(let h=0;h<s.length;h++){const g=window.document.createElement("source");Ye(s[h])||(o.crossOrigin="Anonymous"),g.src=s[h],o.appendChild(g)}return{cancel:()=>{}}},l.groupByLayout=function(s,n){const o={};for(let g=0;g<s.length;g++){const y=n&&n[s[g].id]||Zm(s[g]);n&&(n[s[g].id]=y);let v=o[y];v||(v=o[y]=[]),v.push(s[g])}const h=[];for(const g in o)h.push(o[g]);return h},l.identity=ig,l.interpolate=xr,l.invert=function(s,n){var o=n[0],h=n[1],g=n[2],y=n[3],v=n[4],S=n[5],T=n[6],R=n[7],D=n[8],B=n[9],N=n[10],V=n[11],q=n[12],te=n[13],Q=n[14],_e=n[15],Ee=o*S-h*v,pe=o*T-g*v,Re=o*R-y*v,ze=h*T-g*S,We=h*R-y*S,Tt=g*R-y*T,Rt=D*te-B*q,xt=D*Q-N*q,_t=D*_e-V*q,pt=B*Q-N*te,bt=B*_e-V*te,yt=N*_e-V*Q,lt=Ee*yt-pe*bt+Re*pt+ze*_t-We*xt+Tt*Rt;return lt?(s[0]=(S*yt-T*bt+R*pt)*(lt=1/lt),s[1]=(g*bt-h*yt-y*pt)*lt,s[2]=(te*Tt-Q*We+_e*ze)*lt,s[3]=(N*We-B*Tt-V*ze)*lt,s[4]=(T*_t-v*yt-R*xt)*lt,s[5]=(o*yt-g*_t+y*xt)*lt,s[6]=(Q*Re-q*Tt-_e*pe)*lt,s[7]=(D*Tt-N*Re+V*pe)*lt,s[8]=(v*bt-S*_t+R*Rt)*lt,s[9]=(h*_t-o*bt-y*Rt)*lt,s[10]=(q*We-te*Re+_e*Ee)*lt,s[11]=(B*Re-D*We-V*Ee)*lt,s[12]=(S*xt-v*pt-T*Rt)*lt,s[13]=(o*pt-h*xt+g*Rt)*lt,s[14]=(te*pe-q*ze-Q*Ee)*lt,s[15]=(D*ze-B*pe+N*Ee)*lt,s):null},l.isImageBitmap=et,l.isSafari=tt,l.isWorker=oe,l.keysDifference=function(s,n){const o=[];for(const h in s)h in n||o.push(h);return o},l.lazyLoadRTLTextPlugin=function(){jr.isLoading()||jr.isLoaded()||Vu()!=="deferred"||sf()},l.makeRequest=qe,l.mapObject=Le,l.mercatorXfromLng=px,l.mercatorYfromLat=mx,l.mercatorZfromAltitude=gx,l.mul=mC,l.mul$1=function(s,n,o){return s[0]=n[0]*o[0],s[1]=n[1]*o[1],s[2]=n[2]*o[2],s[3]=n[3]*o[3],s},l.multiply=v0,l.nextPowerOfTwo=function(s){return s<=1?1:Math.pow(2,Math.ceil(Math.log(s)/Math.LN2))},l.operations=Ze,l.ortho=function(s,n,o,h,g,y,v){var S=1/(n-o),T=1/(h-g),R=1/(y-v);return s[0]=-2*S,s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=-2*T,s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[10]=2*R,s[11]=0,s[12]=(n+o)*S,s[13]=(g+h)*T,s[14]=(v+y)*R,s[15]=1,s},l.parseCacheControl=function(s){const n={};if(s.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(o,h,g,y)=>{const v=g||y;return n[h]=!v||v.toLowerCase(),""}),n["max-age"]){const o=parseInt(n["max-age"],10);isNaN(o)?delete n["max-age"]:n["max-age"]=o}return n},l.parseGlyphPbf=function(s){return new yg(s).readFields(pI,[])},l.pbf=q0,l.performSymbolLayout=function(s){s.bucket.createArrays(),s.bucket.tilePixelRatio=Gn/(512*s.bucket.overscaling),s.bucket.compareText={},s.bucket.iconsNeedLinear=!1;const n=s.bucket.layers[0].layout,o=s.bucket.layers[0]._unevaluatedLayout._values,h={layoutIconSize:o["icon-size"].possiblyEvaluate(new Wn(s.bucket.zoom+1),s.canonical),layoutTextSize:o["text-size"].possiblyEvaluate(new Wn(s.bucket.zoom+1),s.canonical),textMaxSize:o["text-size"].possiblyEvaluate(new Wn(18))};if(s.bucket.textSizeData.kind==="composite"){const{minZoom:T,maxZoom:R}=s.bucket.textSizeData;h.compositeTextSizes=[o["text-size"].possiblyEvaluate(new Wn(T),s.canonical),o["text-size"].possiblyEvaluate(new Wn(R),s.canonical)]}if(s.bucket.iconSizeData.kind==="composite"){const{minZoom:T,maxZoom:R}=s.bucket.iconSizeData;h.compositeIconSizes=[o["icon-size"].possiblyEvaluate(new Wn(T),s.canonical),o["icon-size"].possiblyEvaluate(new Wn(R),s.canonical)]}const g=n.get("text-line-height")*Di,y=n.get("text-rotation-alignment")!=="viewport"&&n.get("symbol-placement")!=="point",v=n.get("text-keep-upright"),S=n.get("text-size");for(const T of s.bucket.features){const R=n.get("text-font").evaluate(T,{},s.canonical).join(","),D=S.evaluate(T,{},s.canonical),B=h.layoutTextSize.evaluate(T,{},s.canonical),N=h.layoutIconSize.evaluate(T,{},s.canonical),V={horizontal:{},vertical:void 0},q=T.text;let te,Q=[0,0];if(q){const pe=q.toString(),Re=n.get("text-letter-spacing").evaluate(T,{},s.canonical)*Di,ze=Fu(pe)?Re:0,We=n.get("text-anchor").evaluate(T,{},s.canonical),Tt=n.get("text-variable-anchor");if(!Tt){const bt=n.get("text-radial-offset").evaluate(T,{},s.canonical);Q=bt?Dx(We,[bt*Di,Rg]):n.get("text-offset").evaluate(T,{},s.canonical).map(yt=>yt*Di)}let Rt=y?"center":n.get("text-justify").evaluate(T,{},s.canonical);const xt=n.get("symbol-placement"),_t=xt==="point"?n.get("text-max-width").evaluate(T,{},s.canonical)*Di:0,pt=()=>{s.bucket.allowVerticalPlacement&&Wl(pe)&&(V.vertical=bf(q,s.glyphMap,s.glyphPositions,s.imagePositions,R,_t,g,We,"left",ze,Q,l.WritingMode.vertical,!0,xt,B,D))};if(!y&&Tt){const bt=Rt==="auto"?Tt.map(lt=>Mg(lt)):[Rt];let yt=!1;for(let lt=0;lt<bt.length;lt++){const $t=bt[lt];if(!V.horizontal[$t])if(yt)V.horizontal[$t]=V.horizontal[0];else{const Dt=bf(q,s.glyphMap,s.glyphPositions,s.imagePositions,R,_t,g,"center",$t,ze,Q,l.WritingMode.horizontal,!1,xt,B,D);Dt&&(V.horizontal[$t]=Dt,yt=Dt.positionedLines.length===1)}}pt()}else{Rt==="auto"&&(Rt=Mg(We));const bt=bf(q,s.glyphMap,s.glyphPositions,s.imagePositions,R,_t,g,We,Rt,ze,Q,l.WritingMode.horizontal,!1,xt,B,D);bt&&(V.horizontal[Rt]=bt),pt(),Wl(pe)&&y&&v&&(V.vertical=bf(q,s.glyphMap,s.glyphPositions,s.imagePositions,R,_t,g,We,Rt,ze,Q,l.WritingMode.vertical,!1,xt,B,D))}}let _e=!1;if(T.icon&&T.icon.name){const pe=s.imageMap[T.icon.name];pe&&(te=xI(s.imagePositions[T.icon.name],n.get("icon-offset").evaluate(T,{},s.canonical),n.get("icon-anchor").evaluate(T,{},s.canonical)),_e=!!pe.sdf,s.bucket.sdfIcons===void 0?s.bucket.sdfIcons=_e:s.bucket.sdfIcons!==_e&&he("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(pe.pixelRatio!==s.bucket.pixelRatio||n.get("icon-rotate").constantOr(1)!==0)&&(s.bucket.iconsNeedLinear=!0))}const Ee=zx(V.horizontal)||V.vertical;s.bucket.iconsInText=!!Ee&&Ee.iconsInText,(Ee||te)&&OI(s.bucket,T,V,te,s.imageMap,h,B,N,Q,_e,s.canonical)}s.showCollisionBoxes&&s.bucket.generateCollisionDebugBuffers()},l.perspective=function(s,n,o,h,g){var y,v=1/Math.tan(n/2);return s[0]=v/o,s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=v,s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[11]=-1,s[12]=0,s[13]=0,s[15]=0,g!=null&&g!==1/0?(s[10]=(g+h)*(y=1/(h-g)),s[14]=2*g*h*y):(s[10]=-1,s[14]=-2*h),s},l.pick=function(s,n){const o={};for(let h=0;h<n.length;h++){const g=n[h];g in s&&(o[g]=s[g])}return o},l.plugin=jr,l.pointGeometry=w,l.polygonIntersectsPolygon=f0,l.potpack=Q0,l.register=At,l.registerForPluginStateChange=function(s){return s({pluginStatus:hr,pluginURL:Qs}),Jl.on("pluginStateChange",s),s},l.renderColorRamp=E0,l.rotateX=function(s,n,o){var h=Math.sin(o),g=Math.cos(o),y=n[4],v=n[5],S=n[6],T=n[7],R=n[8],D=n[9],B=n[10],N=n[11];return n!==s&&(s[0]=n[0],s[1]=n[1],s[2]=n[2],s[3]=n[3],s[12]=n[12],s[13]=n[13],s[14]=n[14],s[15]=n[15]),s[4]=y*g+R*h,s[5]=v*g+D*h,s[6]=S*g+B*h,s[7]=T*g+N*h,s[8]=R*g-y*h,s[9]=D*g-v*h,s[10]=B*g-S*h,s[11]=N*g-T*h,s},l.rotateZ=function(s,n,o){var h=Math.sin(o),g=Math.cos(o),y=n[0],v=n[1],S=n[2],T=n[3],R=n[4],D=n[5],B=n[6],N=n[7];return n!==s&&(s[8]=n[8],s[9]=n[9],s[10]=n[10],s[11]=n[11],s[12]=n[12],s[13]=n[13],s[14]=n[14],s[15]=n[15]),s[0]=y*g+R*h,s[1]=v*g+D*h,s[2]=S*g+B*h,s[3]=T*g+N*h,s[4]=R*g-y*h,s[5]=D*g-v*h,s[6]=B*g-S*h,s[7]=N*g-T*h,s},l.sameOrigin=Ye,l.scale=function(s,n,o){var h=o[0],g=o[1],y=o[2];return s[0]=n[0]*h,s[1]=n[1]*h,s[2]=n[2]*h,s[3]=n[3]*h,s[4]=n[4]*g,s[5]=n[5]*g,s[6]=n[6]*g,s[7]=n[7]*g,s[8]=n[8]*y,s[9]=n[9]*y,s[10]=n[10]*y,s[11]=n[11]*y,s[12]=n[12],s[13]=n[13],s[14]=n[14],s[15]=n[15],s},l.setRTLTextPlugin=function(s,n,o=!1){if(hr===Nu||hr===Kl||hr===Uu)throw new Error("setRTLTextPlugin cannot be called multiple times.");Qs=kt.resolveURL(s),hr=Nu,Zo=n,$u(),o||sf()},l.sphericalToCartesian=function([s,n,o]){return n+=90,n*=Math.PI/180,o*=Math.PI/180,{x:s*Math.cos(n)*Math.sin(o),y:s*Math.sin(n)*Math.sin(o),z:s*Math.cos(o)}},l.toEvaluationFeature=el,l.transformMat4=pf,l.translate=function(s,n,o){var h,g,y,v,S,T,R,D,B,N,V,q,te=o[0],Q=o[1],_e=o[2];return n===s?(s[12]=n[0]*te+n[4]*Q+n[8]*_e+n[12],s[13]=n[1]*te+n[5]*Q+n[9]*_e+n[13],s[14]=n[2]*te+n[6]*Q+n[10]*_e+n[14],s[15]=n[3]*te+n[7]*Q+n[11]*_e+n[15]):(g=n[1],y=n[2],v=n[3],S=n[4],T=n[5],R=n[6],D=n[7],B=n[8],N=n[9],V=n[10],q=n[11],s[0]=h=n[0],s[1]=g,s[2]=y,s[3]=v,s[4]=S,s[5]=T,s[6]=R,s[7]=D,s[8]=B,s[9]=N,s[10]=V,s[11]=q,s[12]=h*te+S*Q+B*_e+n[12],s[13]=g*te+T*Q+N*_e+n[13],s[14]=y*te+R*Q+V*_e+n[14],s[15]=v*te+D*Q+q*_e+n[15]),s},l.triggerPluginCompletionEvent=rf,l.unicodeBlockLookup=vt,l.uniqueId=function(){return Ae++},l.v8Spec=W,l.validateCustomStyleLayer=function(s){const n=[],o=s.id;return o===void 0&&n.push({message:`layers.${o}: missing required property "id"`}),s.render===void 0&&n.push({message:`layers.${o}: missing required method "render"`}),s.renderingMode&&s.renderingMode!=="2d"&&s.renderingMode!=="3d"&&n.push({message:`layers.${o}: property "renderingMode" must be either "2d" or "3d"`}),n},l.validateLight=Ym,l.validateStyle=Js,l.vectorTile=no,l.warnOnce=he,l.wrap=ve}),d(["./shared"],function(l){class b{constructor(F){this.keyCache={},F&&this.replace(F)}replace(F){this._layerConfigs={},this._layers={},this.update(F,[])}update(F,$){for(const ae of F){this._layerConfigs[ae.id]=ae;const de=this._layers[ae.id]=l.createStyleLayer(ae);de._featureFilter=l.createFilter(de.filter),this.keyCache[ae.id]&&delete this.keyCache[ae.id]}for(const ae of $)delete this.keyCache[ae],delete this._layerConfigs[ae],delete this._layers[ae];this.familiesBySource={};const X=l.groupByLayout(Object.values(this._layerConfigs),this.keyCache);for(const ae of X){const de=ae.map(Je=>this._layers[Je.id]),be=de[0];if(be.visibility==="none")continue;const me=be.source||"";let fe=this.familiesBySource[me];fe||(fe=this.familiesBySource[me]={});const Te=be.sourceLayer||"_geojsonTileLayer";let Xe=fe[Te];Xe||(Xe=fe[Te]=[]),Xe.push(de)}}}class w{constructor(F){const $={},X=[];for(const me in F){const fe=F[me],Te=$[me]={};for(const Xe in fe){const Je=fe[+Xe];if(!Je||Je.bitmap.width===0||Je.bitmap.height===0)continue;const Ke={x:0,y:0,w:Je.bitmap.width+2,h:Je.bitmap.height+2};X.push(Ke),Te[Xe]={rect:Ke,metrics:Je.metrics}}}const{w:ae,h:de}=l.potpack(X),be=new l.AlphaImage({width:ae||1,height:de||1});for(const me in F){const fe=F[me];for(const Te in fe){const Xe=fe[+Te];if(!Xe||Xe.bitmap.width===0||Xe.bitmap.height===0)continue;const Je=$[me][Te].rect;l.AlphaImage.copy(Xe.bitmap,be,{x:0,y:0},{x:Je.x+1,y:Je.y+1},Xe.bitmap)}}this.image=be,this.positions=$}}l.register("GlyphAtlas",w);class C{constructor(F){this.tileID=new l.OverscaledTileID(F.tileID.overscaledZ,F.tileID.wrap,F.tileID.canonical.z,F.tileID.canonical.x,F.tileID.canonical.y),this.uid=F.uid,this.zoom=F.zoom,this.pixelRatio=F.pixelRatio,this.tileSize=F.tileSize,this.source=F.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=F.showCollisionBoxes,this.collectResourceTiming=!!F.collectResourceTiming,this.returnDependencies=!!F.returnDependencies,this.promoteId=F.promoteId}parse(F,$,X,ae,de){this.status="parsing",this.data=F,this.collisionBoxArray=new l.CollisionBoxArray;const be=new l.DictionaryCoder(Object.keys(F.layers).sort()),me=new l.FeatureIndex(this.tileID,this.promoteId);me.bucketLayerIDs=[];const fe={},Te={featureIndex:me,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:X},Xe=$.familiesBySource[this.source];for(const rn in Xe){const yn=F.layers[rn];if(!yn)continue;yn.version===1&&l.warnOnce(`Vector tile source "${this.source}" layer "${rn}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const Bn=be.encode(rn),gi=[];for(let Yt=0;Yt<yn.length;Yt++){const ii=yn.feature(Yt),Zs=me.getId(ii,rn);gi.push({feature:ii,id:Zs,index:Yt,sourceLayerIndex:Bn})}for(const Yt of Xe[rn]){const ii=Yt[0];ii.source!==this.source&&l.warnOnce(`layer.source = ${ii.source} does not equal this.source = ${this.source}`),ii.minzoom&&this.zoom<Math.floor(ii.minzoom)||ii.maxzoom&&this.zoom>=ii.maxzoom||ii.visibility!=="none"&&(I(Yt,this.zoom,X),(fe[ii.id]=ii.createBucket({index:me.bucketLayerIDs.length,layers:Yt,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:Bn,sourceID:this.source})).populate(gi,Te,this.tileID.canonical),me.bucketLayerIDs.push(Yt.map(Zs=>Zs.id)))}}let Je,Ke,Gt,Jt;const Pt=l.mapObject(Te.glyphDependencies,rn=>Object.keys(rn).map(Number));Object.keys(Pt).length?ae.send("getGlyphs",{uid:this.uid,stacks:Pt,source:this.source,tileID:this.tileID,type:"glyphs"},(rn,yn)=>{Je||(Je=rn,Ke=yn,hn.call(this))}):Ke={};const Nt=Object.keys(Te.iconDependencies);Nt.length?ae.send("getImages",{icons:Nt,source:this.source,tileID:this.tileID,type:"icons"},(rn,yn)=>{Je||(Je=rn,Gt=yn,hn.call(this))}):Gt={};const Xt=Object.keys(Te.patternDependencies);function hn(){if(Je)return de(Je);if(Ke&&Gt&&Jt){const rn=new w(Ke),yn=new l.ImageAtlas(Gt,Jt);for(const Bn in fe){const gi=fe[Bn];gi instanceof l.SymbolBucket?(I(gi.layers,this.zoom,X),l.performSymbolLayout({bucket:gi,glyphMap:Ke,glyphPositions:rn.positions,imageMap:Gt,imagePositions:yn.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical})):gi.hasPattern&&(gi instanceof l.LineBucket||gi instanceof l.FillBucket||gi instanceof l.FillExtrusionBucket)&&(I(gi.layers,this.zoom,X),gi.addFeatures(Te,this.tileID.canonical,yn.patternPositions))}this.status="done",de(null,{buckets:Object.values(fe).filter(Bn=>!Bn.isEmpty()),featureIndex:me,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:rn.image,imageAtlas:yn,glyphMap:this.returnDependencies?Ke:null,iconMap:this.returnDependencies?Gt:null,glyphPositions:this.returnDependencies?rn.positions:null})}}Xt.length?ae.send("getImages",{icons:Xt,source:this.source,tileID:this.tileID,type:"patterns"},(rn,yn)=>{Je||(Je=rn,Jt=yn,hn.call(this))}):Jt={},hn.call(this)}}function I(ne,F,$){const X=new l.EvaluationParameters(F);for(const ae of ne)ae.recalculate(X,$)}function M(ne,F){const $=l.getArrayBuffer(ne.request,(X,ae,de,be)=>{X?F(X):ae&&F(null,{vectorTile:new l.vectorTile.VectorTile(new l.Protobuf(ae)),rawData:ae,cacheControl:de,expires:be})});return()=>{$.cancel(),F()}}class O{constructor(F,$,X,ae){this.actor=F,this.layerIndex=$,this.availableImages=X,this.loadVectorData=ae||M,this.loading={},this.loaded={}}loadTile(F,$){const X=F.uid;this.loading||(this.loading={});const ae=!!(F&&F.request&&F.request.collectResourceTiming)&&new l.RequestPerformance(F.request),de=this.loading[X]=new C(F);de.abort=this.loadVectorData(F,(be,me)=>{if(delete this.loading[X],be||!me)return de.status="done",this.loaded[X]=de,$(be);const fe=me.rawData,Te={};me.expires&&(Te.expires=me.expires),me.cacheControl&&(Te.cacheControl=me.cacheControl);const Xe={};if(ae){const Je=ae.finish();Je&&(Xe.resourceTiming=JSON.parse(JSON.stringify(Je)))}de.vectorTile=me.vectorTile,de.parse(me.vectorTile,this.layerIndex,this.availableImages,this.actor,(Je,Ke)=>{if(Je||!Ke)return $(Je);$(null,l.extend({rawTileData:fe.slice(0)},Ke,Te,Xe))}),this.loaded=this.loaded||{},this.loaded[X]=de})}reloadTile(F,$){const X=this.loaded,ae=F.uid,de=this;if(X&&X[ae]){const be=X[ae];be.showCollisionBoxes=F.showCollisionBoxes;const me=(fe,Te)=>{const Xe=be.reloadCallback;Xe&&(delete be.reloadCallback,be.parse(be.vectorTile,de.layerIndex,this.availableImages,de.actor,Xe)),$(fe,Te)};be.status==="parsing"?be.reloadCallback=me:be.status==="done"&&(be.vectorTile?be.parse(be.vectorTile,this.layerIndex,this.availableImages,this.actor,me):me())}}abortTile(F,$){const X=this.loading,ae=F.uid;X&&X[ae]&&X[ae].abort&&(X[ae].abort(),delete X[ae]),$()}removeTile(F,$){const X=this.loaded,ae=F.uid;X&&X[ae]&&delete X[ae],$()}}class j{constructor(){this.loaded={}}loadTile(F,$){const{uid:X,encoding:ae,rawImageData:de}=F,be=l.isImageBitmap(de)?this.getImageData(de):de,me=new l.DEMData(X,be,ae);this.loaded=this.loaded||{},this.loaded[X]=me,$(null,me)}getImageData(F){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(F.width,F.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d",{willReadFrequently:!0})),this.offscreenCanvas.width=F.width,this.offscreenCanvas.height=F.height,this.offscreenCanvasContext.drawImage(F,0,0,F.width,F.height);const $=this.offscreenCanvasContext.getImageData(-1,-1,F.width+2,F.height+2);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),new l.RGBAImage({width:$.width,height:$.height},$.data)}removeTile(F){const $=this.loaded,X=F.uid;$&&$[X]&&delete $[X]}}function Z(ne,F){if(ne.length!==0){ue(ne[0],F);for(var $=1;$<ne.length;$++)ue(ne[$],!F)}}function ue(ne,F){for(var $=0,X=0,ae=0,de=ne.length,be=de-1;ae<de;be=ae++){var me=(ne[ae][0]-ne[be][0])*(ne[be][1]+ne[ae][1]),fe=$+me;X+=Math.abs($)>=Math.abs(me)?$-fe+me:me-fe+$,$=fe}$+X>=0!=!!F&&ne.reverse()}var ce=l.getDefaultExportFromCjs(function ne(F,$){var X,ae=F&&F.type;if(ae==="FeatureCollection")for(X=0;X<F.features.length;X++)ne(F.features[X],$);else if(ae==="GeometryCollection")for(X=0;X<F.geometries.length;X++)ne(F.geometries[X],$);else if(ae==="Feature")ne(F.geometry,$);else if(ae==="Polygon")Z(F.coordinates,$);else if(ae==="MultiPolygon")for(X=0;X<F.coordinates.length;X++)Z(F.coordinates[X],$);return F});const ve=l.vectorTile.VectorTileFeature.prototype.toGeoJSON;var ye={exports:{}},Ae=l.pointGeometry,Be=l.vectorTile.VectorTileFeature,Le=Ie;function Ie(ne,F){this.options=F||{},this.features=ne,this.length=ne.length}function U(ne,F){this.id=typeof ne.id=="number"?ne.id:void 0,this.type=ne.type,this.rawGeometry=ne.type===1?[ne.geometry]:ne.geometry,this.properties=ne.tags,this.extent=F||4096}Ie.prototype.feature=function(ne){return new U(this.features[ne],this.options.extent)},U.prototype.loadGeometry=function(){var ne=this.rawGeometry;this.geometry=[];for(var F=0;F<ne.length;F++){for(var $=ne[F],X=[],ae=0;ae<$.length;ae++)X.push(new Ae($[ae][0],$[ae][1]));this.geometry.push(X)}return this.geometry},U.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var ne=this.geometry,F=1/0,$=-1/0,X=1/0,ae=-1/0,de=0;de<ne.length;de++)for(var be=ne[de],me=0;me<be.length;me++){var fe=be[me];F=Math.min(F,fe.x),$=Math.max($,fe.x),X=Math.min(X,fe.y),ae=Math.max(ae,fe.y)}return[F,X,$,ae]},U.prototype.toGeoJSON=Be.prototype.toGeoJSON;var H=l.pbf,he=Le;function xe(ne){var F=new H;return function($,X){for(var ae in $.layers)X.writeMessage(3,we,$.layers[ae])}(ne,F),F.finish()}function we(ne,F){var $;F.writeVarintField(15,ne.version||1),F.writeStringField(1,ne.name||""),F.writeVarintField(5,ne.extent||4096);var X={keys:[],values:[],keycache:{},valuecache:{}};for($=0;$<ne.length;$++)X.feature=ne.feature($),F.writeMessage(2,oe,X);var ae=X.keys;for($=0;$<ae.length;$++)F.writeStringField(3,ae[$]);var de=X.values;for($=0;$<de.length;$++)F.writeMessage(4,$e,de[$])}function oe(ne,F){var $=ne.feature;$.id!==void 0&&F.writeVarintField(1,$.id),F.writeMessage(2,ke,ne),F.writeVarintField(3,$.type),F.writeMessage(4,Ve,$)}function ke(ne,F){var $=ne.feature,X=ne.keys,ae=ne.values,de=ne.keycache,be=ne.valuecache;for(var me in $.properties){var fe=$.properties[me],Te=de[me];if(fe!==null){Te===void 0&&(X.push(me),de[me]=Te=X.length-1),F.writeVarint(Te);var Xe=typeof fe;Xe!=="string"&&Xe!=="boolean"&&Xe!=="number"&&(fe=JSON.stringify(fe));var Je=Xe+":"+fe,Ke=be[Je];Ke===void 0&&(ae.push(fe),be[Je]=Ke=ae.length-1),F.writeVarint(Ke)}}}function tt(ne,F){return(F<<3)+(7&ne)}function et(ne){return ne<<1^ne>>31}function Ve(ne,F){for(var $=ne.loadGeometry(),X=ne.type,ae=0,de=0,be=$.length,me=0;me<be;me++){var fe=$[me],Te=1;X===1&&(Te=fe.length),F.writeVarint(tt(1,Te));for(var Xe=X===3?fe.length-1:fe.length,Je=0;Je<Xe;Je++){Je===1&&X!==1&&F.writeVarint(tt(2,Xe-1));var Ke=fe[Je].x-ae,Gt=fe[Je].y-de;F.writeVarint(et(Ke)),F.writeVarint(et(Gt)),ae+=Ke,de+=Gt}X===3&&F.writeVarint(tt(7,1))}}function $e(ne,F){var $=typeof ne;$==="string"?F.writeStringField(1,ne):$==="boolean"?F.writeBooleanField(7,ne):$==="number"&&(ne%1!=0?F.writeDoubleField(3,ne):ne<0?F.writeSVarintField(6,ne):F.writeVarintField(5,ne))}ye.exports=xe,ye.exports.fromVectorTileJs=xe,ye.exports.fromGeojsonVt=function(ne,F){F=F||{};var $={};for(var X in ne)$[X]=new he(ne[X].features,F),$[X].name=X,$[X].version=F.version,$[X].extent=F.extent;return xe({layers:$})},ye.exports.GeoJSONWrapper=he;var He=l.getDefaultExportFromCjs(ye.exports);const kt={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:ne=>ne},Ct=Math.fround||(rt=new Float32Array(1),ne=>(rt[0]=+ne,rt[0]));var rt;const It=3,Vt=5,Lt=6;class qe{constructor(F){this.options=Object.assign(Object.create(kt),F),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(F){const{log:$,minZoom:X,maxZoom:ae}=this.options;$&&console.time("total time");const de=`prepare ${F.length} points`;$&&console.time(de),this.points=F;const be=[];for(let fe=0;fe<F.length;fe++){const Te=F[fe];if(!Te.geometry)continue;const[Xe,Je]=Te.geometry.coordinates,Ke=Ct(Oe(Xe)),Gt=Ct(je(Je));be.push(Ke,Gt,1/0,fe,-1,1),this.options.reduce&&be.push(0)}let me=this.trees[ae+1]=this._createTree(be);$&&console.timeEnd(de);for(let fe=ae;fe>=X;fe--){const Te=+Date.now();me=this.trees[fe]=this._createTree(this._cluster(me,fe)),$&&console.log("z%d: %d clusters in %dms",fe,me.numItems,+Date.now()-Te)}return $&&console.timeEnd("total time"),this}getClusters(F,$){let X=((F[0]+180)%360+360)%360-180;const ae=Math.max(-90,Math.min(90,F[1]));let de=F[2]===180?180:((F[2]+180)%360+360)%360-180;const be=Math.max(-90,Math.min(90,F[3]));if(F[2]-F[0]>=360)X=-180,de=180;else if(X>de){const Je=this.getClusters([X,ae,180,be],$),Ke=this.getClusters([-180,ae,de,be],$);return Je.concat(Ke)}const me=this.trees[this._limitZoom($)],fe=me.range(Oe(X),je(be),Oe(de),je(ae)),Te=me.data,Xe=[];for(const Je of fe){const Ke=this.stride*Je;Xe.push(Te[Ke+Vt]>1?Se(Te,Ke,this.clusterProps):this.points[Te[Ke+It]])}return Xe}getChildren(F){const $=this._getOriginId(F),X=this._getOriginZoom(F),ae="No cluster with the specified id.",de=this.trees[X];if(!de)throw new Error(ae);const be=de.data;if($*this.stride>=be.length)throw new Error(ae);const me=this.options.radius/(this.options.extent*Math.pow(2,X-1)),fe=de.within(be[$*this.stride],be[$*this.stride+1],me),Te=[];for(const Xe of fe){const Je=Xe*this.stride;be[Je+4]===F&&Te.push(be[Je+Vt]>1?Se(be,Je,this.clusterProps):this.points[be[Je+It]])}if(Te.length===0)throw new Error(ae);return Te}getLeaves(F,$,X){const ae=[];return this._appendLeaves(ae,F,$=$||10,X=X||0,0),ae}getTile(F,$,X){const ae=this.trees[this._limitZoom(F)],de=Math.pow(2,F),{extent:be,radius:me}=this.options,fe=me/be,Te=(X-fe)/de,Xe=(X+1+fe)/de,Je={features:[]};return this._addTileFeatures(ae.range(($-fe)/de,Te,($+1+fe)/de,Xe),ae.data,$,X,de,Je),$===0&&this._addTileFeatures(ae.range(1-fe/de,Te,1,Xe),ae.data,de,X,de,Je),$===de-1&&this._addTileFeatures(ae.range(0,Te,fe/de,Xe),ae.data,-1,X,de,Je),Je.features.length?Je:null}getClusterExpansionZoom(F){let $=this._getOriginZoom(F)-1;for(;$<=this.options.maxZoom;){const X=this.getChildren(F);if($++,X.length!==1)break;F=X[0].properties.cluster_id}return $}_appendLeaves(F,$,X,ae,de){const be=this.getChildren($);for(const me of be){const fe=me.properties;if(fe&&fe.cluster?de+fe.point_count<=ae?de+=fe.point_count:de=this._appendLeaves(F,fe.cluster_id,X,ae,de):de<ae?de++:F.push(me),F.length===X)break}return de}_createTree(F){const $=new l.KDBush(F.length/this.stride|0,this.options.nodeSize,Float32Array);for(let X=0;X<F.length;X+=this.stride)$.add(F[X],F[X+1]);return $.finish(),$.data=F,$}_addTileFeatures(F,$,X,ae,de,be){for(const me of F){const fe=me*this.stride,Te=$[fe+Vt]>1;let Xe,Je,Ke;if(Te)Xe=Ye($,fe,this.clusterProps),Je=$[fe],Ke=$[fe+1];else{const Pt=this.points[$[fe+It]];Xe=Pt.properties;const[Nt,Xt]=Pt.geometry.coordinates;Je=Oe(Nt),Ke=je(Xt)}const Gt={type:1,geometry:[[Math.round(this.options.extent*(Je*de-X)),Math.round(this.options.extent*(Ke*de-ae))]],tags:Xe};let Jt;Jt=Te||this.options.generateId?$[fe+It]:this.points[$[fe+It]].id,Jt!==void 0&&(Gt.id=Jt),be.features.push(Gt)}}_limitZoom(F){return Math.max(this.options.minZoom,Math.min(Math.floor(+F),this.options.maxZoom+1))}_cluster(F,$){const{radius:X,extent:ae,reduce:de,minPoints:be}=this.options,me=X/(ae*Math.pow(2,$)),fe=F.data,Te=[],Xe=this.stride;for(let Je=0;Je<fe.length;Je+=Xe){if(fe[Je+2]<=$)continue;fe[Je+2]=$;const Ke=fe[Je],Gt=fe[Je+1],Jt=F.within(fe[Je],fe[Je+1],me),Pt=fe[Je+Vt];let Nt=Pt;for(const Xt of Jt){const hn=Xt*Xe;fe[hn+2]>$&&(Nt+=fe[hn+Vt])}if(Nt>Pt&&Nt>=be){let Xt,hn=Ke*Pt,rn=Gt*Pt,yn=-1;const Bn=((Je/Xe|0)<<5)+($+1)+this.points.length;for(const gi of Jt){const Yt=gi*Xe;if(fe[Yt+2]<=$)continue;fe[Yt+2]=$;const ii=fe[Yt+Vt];hn+=fe[Yt]*ii,rn+=fe[Yt+1]*ii,fe[Yt+4]=Bn,de&&(Xt||(Xt=this._map(fe,Je,!0),yn=this.clusterProps.length,this.clusterProps.push(Xt)),de(Xt,this._map(fe,Yt)))}fe[Je+4]=Bn,Te.push(hn/Nt,rn/Nt,1/0,Bn,-1,Nt),de&&Te.push(yn)}else{for(let Xt=0;Xt<Xe;Xt++)Te.push(fe[Je+Xt]);if(Nt>1)for(const Xt of Jt){const hn=Xt*Xe;if(!(fe[hn+2]<=$)){fe[hn+2]=$;for(let rn=0;rn<Xe;rn++)Te.push(fe[hn+rn])}}}}return Te}_getOriginId(F){return F-this.points.length>>5}_getOriginZoom(F){return(F-this.points.length)%32}_map(F,$,X){if(F[$+Vt]>1){const be=this.clusterProps[F[$+Lt]];return X?Object.assign({},be):be}const ae=this.points[F[$+It]].properties,de=this.options.map(ae);return X&&de===ae?Object.assign({},de):de}}function Se(ne,F,$){return{type:"Feature",id:ne[F+It],properties:Ye(ne,F,$),geometry:{type:"Point",coordinates:[(X=ne[F],360*(X-.5)),ft(ne[F+1])]}};var X}function Ye(ne,F,$){const X=ne[F+Vt],ae=X>=1e4?`${Math.round(X/1e3)}k`:X>=1e3?Math.round(X/100)/10+"k":X,de=ne[F+Lt],be=de===-1?{}:Object.assign({},$[de]);return Object.assign(be,{cluster:!0,cluster_id:ne[F+It],point_count:X,point_count_abbreviated:ae})}function Oe(ne){return ne/360+.5}function je(ne){const F=Math.sin(ne*Math.PI/180),$=.5-.25*Math.log((1+F)/(1-F))/Math.PI;return $<0?0:$>1?1:$}function ft(ne){const F=(180-360*ne)*Math.PI/180;return 360*Math.atan(Math.exp(F))/Math.PI-90}function Y(ne,F,$,X){for(var ae,de=X,be=$-F>>1,me=$-F,fe=ne[F],Te=ne[F+1],Xe=ne[$],Je=ne[$+1],Ke=F+3;Ke<$;Ke+=3){var Gt=ie(ne[Ke],ne[Ke+1],fe,Te,Xe,Je);if(Gt>de)ae=Ke,de=Gt;else if(Gt===de){var Jt=Math.abs(Ke-be);Jt<me&&(ae=Ke,me=Jt)}}de>X&&(ae-F>3&&Y(ne,F,ae,X),ne[ae+2]=de,$-ae>3&&Y(ne,ae,$,X))}function ie(ne,F,$,X,ae,de){var be=ae-$,me=de-X;if(be!==0||me!==0){var fe=((ne-$)*be+(F-X)*me)/(be*be+me*me);fe>1?($=ae,X=de):fe>0&&($+=be*fe,X+=me*fe)}return(be=ne-$)*be+(me=F-X)*me}function W(ne,F,$,X){var ae={id:ne===void 0?null:ne,type:F,geometry:$,tags:X,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(de){var be=de.geometry,me=de.type;if(me==="Point"||me==="MultiPoint"||me==="LineString")De(de,be);else if(me==="Polygon"||me==="MultiLineString")for(var fe=0;fe<be.length;fe++)De(de,be[fe]);else if(me==="MultiPolygon")for(fe=0;fe<be.length;fe++)for(var Te=0;Te<be[fe].length;Te++)De(de,be[fe][Te])}(ae),ae}function De(ne,F){for(var $=0;$<F.length;$+=3)ne.minX=Math.min(ne.minX,F[$]),ne.minY=Math.min(ne.minY,F[$+1]),ne.maxX=Math.max(ne.maxX,F[$]),ne.maxY=Math.max(ne.maxY,F[$+1])}function Ue(ne,F,$,X){if(F.geometry){var ae=F.geometry.coordinates,de=F.geometry.type,be=Math.pow($.tolerance/((1<<$.maxZoom)*$.extent),2),me=[],fe=F.id;if($.promoteId?fe=F.properties[$.promoteId]:$.generateId&&(fe=X||0),de==="Point")Ne(ae,me);else if(de==="MultiPoint")for(var Te=0;Te<ae.length;Te++)Ne(ae[Te],me);else if(de==="LineString")Ze(ae,me,be,!1);else if(de==="MultiLineString"){if($.lineMetrics){for(Te=0;Te<ae.length;Te++)Ze(ae[Te],me=[],be,!1),ne.push(W(fe,"LineString",me,F.properties));return}ct(ae,me,be,!1)}else if(de==="Polygon")ct(ae,me,be,!0);else{if(de!=="MultiPolygon"){if(de==="GeometryCollection"){for(Te=0;Te<F.geometry.geometries.length;Te++)Ue(ne,{id:fe,geometry:F.geometry.geometries[Te],properties:F.properties},$,X);return}throw new Error("Input data is not a valid GeoJSON object.")}for(Te=0;Te<ae.length;Te++){var Xe=[];ct(ae[Te],Xe,be,!0),me.push(Xe)}}ne.push(W(fe,de,me,F.properties))}}function Ne(ne,F){F.push(dt(ne[0])),F.push(nt(ne[1])),F.push(0)}function Ze(ne,F,$,X){for(var ae,de,be=0,me=0;me<ne.length;me++){var fe=dt(ne[me][0]),Te=nt(ne[me][1]);F.push(fe),F.push(Te),F.push(0),me>0&&(be+=X?(ae*Te-fe*de)/2:Math.sqrt(Math.pow(fe-ae,2)+Math.pow(Te-de,2))),ae=fe,de=Te}var Xe=F.length-3;F[2]=1,Y(F,0,Xe,$),F[Xe+2]=1,F.size=Math.abs(be),F.start=0,F.end=F.size}function ct(ne,F,$,X){for(var ae=0;ae<ne.length;ae++){var de=[];Ze(ne[ae],de,$,X),F.push(de)}}function dt(ne){return ne/360+.5}function nt(ne){var F=Math.sin(ne*Math.PI/180),$=.5-.25*Math.log((1+F)/(1-F))/Math.PI;return $<0?0:$>1?1:$}function ut(ne,F,$,X,ae,de,be,me){if(X/=F,de>=($/=F)&&be<X)return ne;if(be<$||de>=X)return null;for(var fe=[],Te=0;Te<ne.length;Te++){var Xe=ne[Te],Je=Xe.geometry,Ke=Xe.type,Gt=ae===0?Xe.minX:Xe.minY,Jt=ae===0?Xe.maxX:Xe.maxY;if(Gt>=$&&Jt<X)fe.push(Xe);else if(!(Jt<$||Gt>=X)){var Pt=[];if(Ke==="Point"||Ke==="MultiPoint")mt(Je,Pt,$,X,ae);else if(Ke==="LineString")Mt(Je,Pt,$,X,ae,!1,me.lineMetrics);else if(Ke==="MultiLineString")Ge(Je,Pt,$,X,ae,!1);else if(Ke==="Polygon")Ge(Je,Pt,$,X,ae,!0);else if(Ke==="MultiPolygon")for(var Nt=0;Nt<Je.length;Nt++){var Xt=[];Ge(Je[Nt],Xt,$,X,ae,!0),Xt.length&&Pt.push(Xt)}if(Pt.length){if(me.lineMetrics&&Ke==="LineString"){for(Nt=0;Nt<Pt.length;Nt++)fe.push(W(Xe.id,Ke,Pt[Nt],Xe.tags));continue}Ke!=="LineString"&&Ke!=="MultiLineString"||(Pt.length===1?(Ke="LineString",Pt=Pt[0]):Ke="MultiLineString"),Ke!=="Point"&&Ke!=="MultiPoint"||(Ke=Pt.length===3?"Point":"MultiPoint"),fe.push(W(Xe.id,Ke,Pt,Xe.tags))}}}return fe.length?fe:null}function mt(ne,F,$,X,ae){for(var de=0;de<ne.length;de+=3){var be=ne[de+ae];be>=$&&be<=X&&(F.push(ne[de]),F.push(ne[de+1]),F.push(ne[de+2]))}}function Mt(ne,F,$,X,ae,de,be){for(var me,fe,Te=wt(ne),Xe=ae===0?Zt:dn,Je=ne.start,Ke=0;Ke<ne.length-3;Ke+=3){var Gt=ne[Ke],Jt=ne[Ke+1],Pt=ne[Ke+2],Nt=ne[Ke+3],Xt=ne[Ke+4],hn=ae===0?Gt:Jt,rn=ae===0?Nt:Xt,yn=!1;be&&(me=Math.sqrt(Math.pow(Gt-Nt,2)+Math.pow(Jt-Xt,2))),hn<$?rn>$&&(fe=Xe(Te,Gt,Jt,Nt,Xt,$),be&&(Te.start=Je+me*fe)):hn>X?rn<X&&(fe=Xe(Te,Gt,Jt,Nt,Xt,X),be&&(Te.start=Je+me*fe)):tn(Te,Gt,Jt,Pt),rn<$&&hn>=$&&(fe=Xe(Te,Gt,Jt,Nt,Xt,$),yn=!0),rn>X&&hn<=X&&(fe=Xe(Te,Gt,Jt,Nt,Xt,X),yn=!0),!de&&yn&&(be&&(Te.end=Je+me*fe),F.push(Te),Te=wt(ne)),be&&(Je+=me)}var Bn=ne.length-3;Gt=ne[Bn],Jt=ne[Bn+1],Pt=ne[Bn+2],(hn=ae===0?Gt:Jt)>=$&&hn<=X&&tn(Te,Gt,Jt,Pt),Bn=Te.length-3,de&&Bn>=3&&(Te[Bn]!==Te[0]||Te[Bn+1]!==Te[1])&&tn(Te,Te[0],Te[1],Te[2]),Te.length&&F.push(Te)}function wt(ne){var F=[];return F.size=ne.size,F.start=ne.start,F.end=ne.end,F}function Ge(ne,F,$,X,ae,de){for(var be=0;be<ne.length;be++)Mt(ne[be],F,$,X,ae,de,!1)}function tn(ne,F,$,X){ne.push(F),ne.push($),ne.push(X)}function Zt(ne,F,$,X,ae,de){var be=(de-F)/(X-F);return ne.push(de),ne.push($+(ae-$)*be),ne.push(1),be}function dn(ne,F,$,X,ae,de){var be=(de-$)/(ae-$);return ne.push(F+(X-F)*be),ne.push(de),ne.push(1),be}function zn(ne,F){for(var $=[],X=0;X<ne.length;X++){var ae,de=ne[X],be=de.type;if(be==="Point"||be==="MultiPoint"||be==="LineString")ae=at(de.geometry,F);else if(be==="MultiLineString"||be==="Polygon"){ae=[];for(var me=0;me<de.geometry.length;me++)ae.push(at(de.geometry[me],F))}else if(be==="MultiPolygon")for(ae=[],me=0;me<de.geometry.length;me++){for(var fe=[],Te=0;Te<de.geometry[me].length;Te++)fe.push(at(de.geometry[me][Te],F));ae.push(fe)}$.push(W(de.id,be,ae,de.tags))}return $}function at(ne,F){var $=[];$.size=ne.size,ne.start!==void 0&&($.start=ne.start,$.end=ne.end);for(var X=0;X<ne.length;X+=3)$.push(ne[X]+F,ne[X+1],ne[X+2]);return $}function jt(ne,F){if(ne.transformed)return ne;var $,X,ae,de=1<<ne.z,be=ne.x,me=ne.y;for($=0;$<ne.features.length;$++){var fe=ne.features[$],Te=fe.geometry,Xe=fe.type;if(fe.geometry=[],Xe===1)for(X=0;X<Te.length;X+=2)fe.geometry.push(qt(Te[X],Te[X+1],F,de,be,me));else for(X=0;X<Te.length;X++){var Je=[];for(ae=0;ae<Te[X].length;ae+=2)Je.push(qt(Te[X][ae],Te[X][ae+1],F,de,be,me));fe.geometry.push(Je)}}return ne.transformed=!0,ne}function qt(ne,F,$,X,ae,de){return[Math.round($*(ne*X-ae)),Math.round($*(F*X-de))]}function Dn(ne,F,$,X,ae){for(var de=F===ae.maxZoom?0:ae.tolerance/((1<<F)*ae.extent),be={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:$,y:X,z:F,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},me=0;me<ne.length;me++){be.numFeatures++,fn(be,ne[me],de,ae);var fe=ne[me].minX,Te=ne[me].minY,Xe=ne[me].maxX,Je=ne[me].maxY;fe<be.minX&&(be.minX=fe),Te<be.minY&&(be.minY=Te),Xe>be.maxX&&(be.maxX=Xe),Je>be.maxY&&(be.maxY=Je)}return be}function fn(ne,F,$,X){var ae=F.geometry,de=F.type,be=[];if(de==="Point"||de==="MultiPoint")for(var me=0;me<ae.length;me+=3)be.push(ae[me]),be.push(ae[me+1]),ne.numPoints++,ne.numSimplified++;else if(de==="LineString")Ot(be,ae,ne,$,!1,!1);else if(de==="MultiLineString"||de==="Polygon")for(me=0;me<ae.length;me++)Ot(be,ae[me],ne,$,de==="Polygon",me===0);else if(de==="MultiPolygon")for(var fe=0;fe<ae.length;fe++){var Te=ae[fe];for(me=0;me<Te.length;me++)Ot(be,Te[me],ne,$,!0,me===0)}if(be.length){var Xe=F.tags||null;if(de==="LineString"&&X.lineMetrics){for(var Je in Xe={},F.tags)Xe[Je]=F.tags[Je];Xe.mapbox_clip_start=ae.start/ae.size,Xe.mapbox_clip_end=ae.end/ae.size}var Ke={geometry:be,type:de==="Polygon"||de==="MultiPolygon"?3:de==="LineString"||de==="MultiLineString"?2:1,tags:Xe};F.id!==null&&(Ke.id=F.id),ne.features.push(Ke)}}function Ot(ne,F,$,X,ae,de){var be=X*X;if(X>0&&F.size<(ae?be:X))$.numPoints+=F.length/3;else{for(var me=[],fe=0;fe<F.length;fe+=3)(X===0||F[fe+2]>be)&&($.numSimplified++,me.push(F[fe]),me.push(F[fe+1])),$.numPoints++;ae&&function(Te,Xe){for(var Je=0,Ke=0,Gt=Te.length,Jt=Gt-2;Ke<Gt;Jt=Ke,Ke+=2)Je+=(Te[Ke]-Te[Jt])*(Te[Ke+1]+Te[Jt+1]);if(Je>0===Xe)for(Ke=0,Gt=Te.length;Ke<Gt/2;Ke+=2){var Pt=Te[Ke],Nt=Te[Ke+1];Te[Ke]=Te[Gt-2-Ke],Te[Ke+1]=Te[Gt-1-Ke],Te[Gt-2-Ke]=Pt,Te[Gt-1-Ke]=Nt}}(me,de),ne.push(me)}}function Fr(ne,F){var $=(F=this.options=function(ae,de){for(var be in de)ae[be]=de[be];return ae}(Object.create(this.options),F)).debug;if($&&console.time("preprocess data"),F.maxZoom<0||F.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(F.promoteId&&F.generateId)throw new Error("promoteId and generateId cannot be used together.");var X=function(ae,de){var be=[];if(ae.type==="FeatureCollection")for(var me=0;me<ae.features.length;me++)Ue(be,ae.features[me],de,me);else Ue(be,ae.type==="Feature"?ae:{geometry:ae},de);return be}(ne,F);this.tiles={},this.tileCoords=[],$&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",F.indexMaxZoom,F.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),X=function(ae,de){var be=de.buffer/de.extent,me=ae,fe=ut(ae,1,-1-be,be,0,-1,2,de),Te=ut(ae,1,1-be,2+be,0,-1,2,de);return(fe||Te)&&(me=ut(ae,1,-be,1+be,0,-1,2,de)||[],fe&&(me=zn(fe,1).concat(me)),Te&&(me=me.concat(zn(Te,-1)))),me}(X,F),X.length&&this.splitTile(X,0,0,0),$&&(X.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function ks(ne,F,$){return 32*((1<<ne)*$+F)+ne}function Kr(ne,F){return F?ne.properties[F]:ne.id}function As(ne,F){if(ne==null)return!0;if(ne.type==="Feature")return Kr(ne,F)!=null;if(ne.type==="FeatureCollection"){const $=new Set;for(const X of ne.features){const ae=Kr(X,F);if(ae==null||$.has(ae))return!1;$.add(ae)}return!0}return!1}function Oi(ne,F){const $=new Map;if(ne!=null)if(ne.type==="Feature")$.set(Kr(ne,F),ne);else for(const X of ne.features)$.set(Kr(X,F),X);return $}function Un(ne,F){const $=ne.tileID.canonical;if(!this._geoJSONIndex)return F(null,null);const X=this._geoJSONIndex.getTile($.z,$.x,$.y);if(!X)return F(null,null);const ae=new class{constructor(be){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=l.EXTENT,this.length=be.length,this._features=be}feature(be){return new class{constructor(me){this._feature=me,this.extent=l.EXTENT,this.type=me.type,this.properties=me.tags,"id"in me&&!isNaN(me.id)&&(this.id=parseInt(me.id,10))}loadGeometry(){if(this._feature.type===1){const me=[];for(const fe of this._feature.geometry)me.push([new l.Point(fe[0],fe[1])]);return me}{const me=[];for(const fe of this._feature.geometry){const Te=[];for(const Xe of fe)Te.push(new l.Point(Xe[0],Xe[1]));me.push(Te)}return me}}toGeoJSON(me,fe,Te){return ve.call(this,me,fe,Te)}}(this._features[be])}}(X.features);let de=He(ae);de.byteOffset===0&&de.byteLength===de.buffer.byteLength||(de=new Uint8Array(de)),F(null,{vectorTile:ae,rawData:de.buffer})}Fr.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},Fr.prototype.splitTile=function(ne,F,$,X,ae,de,be){for(var me=[ne,F,$,X],fe=this.options,Te=fe.debug;me.length;){X=me.pop(),$=me.pop(),F=me.pop(),ne=me.pop();var Xe=1<<F,Je=ks(F,$,X),Ke=this.tiles[Je];if(!Ke&&(Te>1&&console.time("creation"),Ke=this.tiles[Je]=Dn(ne,F,$,X,fe),this.tileCoords.push({z:F,x:$,y:X}),Te)){Te>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",F,$,X,Ke.numFeatures,Ke.numPoints,Ke.numSimplified),console.timeEnd("creation"));var Gt="z"+F;this.stats[Gt]=(this.stats[Gt]||0)+1,this.total++}if(Ke.source=ne,ae){if(F===fe.maxZoom||F===ae)continue;var Jt=1<<ae-F;if($!==Math.floor(de/Jt)||X!==Math.floor(be/Jt))continue}else if(F===fe.indexMaxZoom||Ke.numPoints<=fe.indexMaxPoints)continue;if(Ke.source=null,ne.length!==0){Te>1&&console.time("clipping");var Pt,Nt,Xt,hn,rn,yn,Bn=.5*fe.buffer/fe.extent,gi=.5-Bn,Yt=.5+Bn,ii=1+Bn;Pt=Nt=Xt=hn=null,rn=ut(ne,Xe,$-Bn,$+Yt,0,Ke.minX,Ke.maxX,fe),yn=ut(ne,Xe,$+gi,$+ii,0,Ke.minX,Ke.maxX,fe),ne=null,rn&&(Pt=ut(rn,Xe,X-Bn,X+Yt,1,Ke.minY,Ke.maxY,fe),Nt=ut(rn,Xe,X+gi,X+ii,1,Ke.minY,Ke.maxY,fe),rn=null),yn&&(Xt=ut(yn,Xe,X-Bn,X+Yt,1,Ke.minY,Ke.maxY,fe),hn=ut(yn,Xe,X+gi,X+ii,1,Ke.minY,Ke.maxY,fe),yn=null),Te>1&&console.timeEnd("clipping"),me.push(Pt||[],F+1,2*$,2*X),me.push(Nt||[],F+1,2*$,2*X+1),me.push(Xt||[],F+1,2*$+1,2*X),me.push(hn||[],F+1,2*$+1,2*X+1)}}},Fr.prototype.getTile=function(ne,F,$){var X=this.options,ae=X.extent,de=X.debug;if(ne<0||ne>24)return null;var be=1<<ne,me=ks(ne,F=(F%be+be)%be,$);if(this.tiles[me])return jt(this.tiles[me],ae);de>1&&console.log("drilling down to z%d-%d-%d",ne,F,$);for(var fe,Te=ne,Xe=F,Je=$;!fe&&Te>0;)Te--,Xe=Math.floor(Xe/2),Je=Math.floor(Je/2),fe=this.tiles[ks(Te,Xe,Je)];return fe&&fe.source?(de>1&&console.log("found parent tile z%d-%d-%d",Te,Xe,Je),de>1&&console.time("drilling down"),this.splitTile(fe.source,Te,Xe,Je,ne,F,$),de>1&&console.timeEnd("drilling down"),this.tiles[me]?jt(this.tiles[me],ae):null):null};class Lo extends O{constructor(F,$,X,ae){super(F,$,X,Un),this._dataUpdateable=new Map,this.loadGeoJSON=(de,be)=>{const{promoteId:me}=de;if(de.request)return l.getJSON(de.request,(fe,Te,Xe,Je)=>{this._dataUpdateable=As(Te,me)?Oi(Te,me):void 0,be(fe,Te,Xe,Je)});if(typeof de.data=="string")try{const fe=JSON.parse(de.data);this._dataUpdateable=As(fe,me)?Oi(fe,me):void 0,be(null,fe)}catch{be(new Error(`Input data given to '${de.source}' is not a valid GeoJSON object.`))}else de.dataDiff?this._dataUpdateable?(function(fe,Te,Xe){var Je,Ke,Gt,Jt;if(Te.removeAll&&fe.clear(),Te.remove)for(const Pt of Te.remove)fe.delete(Pt);if(Te.add)for(const Pt of Te.add){const Nt=Kr(Pt,Xe);Nt!=null&&fe.set(Nt,Pt)}if(Te.update)for(const Pt of Te.update){let Nt=fe.get(Pt.id);if(Nt==null)continue;const Xt=!Pt.removeAllProperties&&(((Je=Pt.removeProperties)===null||Je===void 0?void 0:Je.length)>0||((Ke=Pt.addOrUpdateProperties)===null||Ke===void 0?void 0:Ke.length)>0);if((Pt.newGeometry||Pt.removeAllProperties||Xt)&&(Nt={...Nt},fe.set(Pt.id,Nt),Xt&&(Nt.properties={...Nt.properties})),Pt.newGeometry&&(Nt.geometry=Pt.newGeometry),Pt.removeAllProperties)Nt.properties={};else if(((Gt=Pt.removeProperties)===null||Gt===void 0?void 0:Gt.length)>0)for(const hn of Pt.removeProperties)Object.prototype.hasOwnProperty.call(Nt.properties,hn)&&delete Nt.properties[hn];if(((Jt=Pt.addOrUpdateProperties)===null||Jt===void 0?void 0:Jt.length)>0)for(const{key:hn,value:rn}of Pt.addOrUpdateProperties)Nt.properties[hn]=rn}}(this._dataUpdateable,de.dataDiff,me),be(null,{type:"FeatureCollection",features:Array.from(this._dataUpdateable.values())})):be(new Error(`Cannot update existing geojson data in ${de.source}`)):be(new Error(`Input data given to '${de.source}' is not a valid GeoJSON object.`));return{cancel:()=>{}}},ae&&(this.loadGeoJSON=ae)}loadData(F,$){var X;(X=this._pendingRequest)===null||X===void 0||X.cancel(),this._pendingCallback&&this._pendingCallback(null,{abandoned:!0});const ae=!!(F&&F.request&&F.request.collectResourceTiming)&&new l.RequestPerformance(F.request);this._pendingCallback=$,this._pendingRequest=this.loadGeoJSON(F,(de,be)=>{if(delete this._pendingCallback,delete this._pendingRequest,de||!be)return $(de);if(typeof be!="object")return $(new Error(`Input data given to '${F.source}' is not a valid GeoJSON object.`));{ce(be,!0);try{if(F.filter){const fe=l.createExpression(F.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(fe.result==="error")throw new Error(fe.value.map(Xe=>`${Xe.key}: ${Xe.message}`).join(", "));be={type:"FeatureCollection",features:be.features.filter(Xe=>fe.value.evaluate({zoom:0},Xe))}}this._geoJSONIndex=F.cluster?new qe(function({superclusterOptions:fe,clusterProperties:Te}){if(!Te||!fe)return fe;const Xe={},Je={},Ke={accumulated:null,zoom:0},Gt={properties:null},Jt=Object.keys(Te);for(const Pt of Jt){const[Nt,Xt]=Te[Pt],hn=l.createExpression(Xt),rn=l.createExpression(typeof Nt=="string"?[Nt,["accumulated"],["get",Pt]]:Nt);Xe[Pt]=hn.value,Je[Pt]=rn.value}return fe.map=Pt=>{Gt.properties=Pt;const Nt={};for(const Xt of Jt)Nt[Xt]=Xe[Xt].evaluate(Ke,Gt);return Nt},fe.reduce=(Pt,Nt)=>{Gt.properties=Nt;for(const Xt of Jt)Ke.accumulated=Pt[Xt],Pt[Xt]=Je[Xt].evaluate(Ke,Gt)},fe}(F)).load(be.features):function(fe,Te){return new Fr(fe,Te)}(be,F.geojsonVtOptions)}catch(fe){return $(fe)}this.loaded={};const me={};if(ae){const fe=ae.finish();fe&&(me.resourceTiming={},me.resourceTiming[F.source]=JSON.parse(JSON.stringify(fe)))}$(null,me)}})}reloadTile(F,$){const X=this.loaded;return X&&X[F.uid]?super.reloadTile(F,$):this.loadTile(F,$)}removeSource(F,$){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),$()}getClusterExpansionZoom(F,$){try{$(null,this._geoJSONIndex.getClusterExpansionZoom(F.clusterId))}catch(X){$(X)}}getClusterChildren(F,$){try{$(null,this._geoJSONIndex.getChildren(F.clusterId))}catch(X){$(X)}}getClusterLeaves(F,$){try{$(null,this._geoJSONIndex.getLeaves(F.clusterId,F.limit,F.offset))}catch(X){$(X)}}}class ds{constructor(F){this.self=F,this.actor=new l.Actor(F,this),this.layerIndexes={},this.availableImages={},this.workerSourceTypes={vector:O,geojson:Lo},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=($,X)=>{if(this.workerSourceTypes[$])throw new Error(`Worker source with name "${$}" already registered.`);this.workerSourceTypes[$]=X},this.self.registerRTLTextPlugin=$=>{if(l.plugin.isParsed())throw new Error("RTL text plugin already registered.");l.plugin.applyArabicShaping=$.applyArabicShaping,l.plugin.processBidirectionalText=$.processBidirectionalText,l.plugin.processStyledBidirectionalText=$.processStyledBidirectionalText}}setReferrer(F,$){this.referrer=$}setImages(F,$,X){this.availableImages[F]=$;for(const ae in this.workerSources[F]){const de=this.workerSources[F][ae];for(const be in de)de[be].availableImages=$}X()}setLayers(F,$,X){this.getLayerIndex(F).replace($),X()}updateLayers(F,$,X){this.getLayerIndex(F).update($.layers,$.removedIds),X()}loadTile(F,$,X){this.getWorkerSource(F,$.type,$.source).loadTile($,X)}loadDEMTile(F,$,X){this.getDEMWorkerSource(F,$.source).loadTile($,X)}reloadTile(F,$,X){this.getWorkerSource(F,$.type,$.source).reloadTile($,X)}abortTile(F,$,X){this.getWorkerSource(F,$.type,$.source).abortTile($,X)}removeTile(F,$,X){this.getWorkerSource(F,$.type,$.source).removeTile($,X)}removeDEMTile(F,$){this.getDEMWorkerSource(F,$.source).removeTile($)}removeSource(F,$,X){if(!this.workerSources[F]||!this.workerSources[F][$.type]||!this.workerSources[F][$.type][$.source])return;const ae=this.workerSources[F][$.type][$.source];delete this.workerSources[F][$.type][$.source],ae.removeSource!==void 0?ae.removeSource($,X):X()}loadWorkerSource(F,$,X){try{this.self.importScripts($.url),X()}catch(ae){X(ae.toString())}}syncRTLPluginState(F,$,X){try{l.plugin.setState($);const ae=l.plugin.getPluginURL();if(l.plugin.isLoaded()&&!l.plugin.isParsed()&&ae!=null){this.self.importScripts(ae);const de=l.plugin.isParsed();X(de?void 0:new Error(`RTL Text Plugin failed to import scripts from ${ae}`),de)}}catch(ae){X(ae.toString())}}getAvailableImages(F){let $=this.availableImages[F];return $||($=[]),$}getLayerIndex(F){let $=this.layerIndexes[F];return $||($=this.layerIndexes[F]=new b),$}getWorkerSource(F,$,X){if(this.workerSources[F]||(this.workerSources[F]={}),this.workerSources[F][$]||(this.workerSources[F][$]={}),!this.workerSources[F][$][X]){const ae={send:(de,be,me)=>{this.actor.send(de,be,me,F)}};this.workerSources[F][$][X]=new this.workerSourceTypes[$](ae,this.getLayerIndex(F),this.getAvailableImages(F))}return this.workerSources[F][$][X]}getDEMWorkerSource(F,$){return this.demWorkerSources[F]||(this.demWorkerSources[F]={}),this.demWorkerSources[F][$]||(this.demWorkerSources[F][$]=new j),this.demWorkerSources[F][$]}}return l.isWorker()&&(self.worker=new ds(self)),ds}),d(["./shared"],function(l){var b="3.1.0";class w{static testProp(r){if(!w.docStyle)return r[0];for(let c=0;c<r.length;c++)if(r[c]in w.docStyle)return r[c];return r[0]}static create(r,c,f){const _=window.document.createElement(r);return c!==void 0&&(_.className=c),f&&f.appendChild(_),_}static createNS(r,c){return window.document.createElementNS(r,c)}static disableDrag(){w.docStyle&&w.selectProp&&(w.userSelect=w.docStyle[w.selectProp],w.docStyle[w.selectProp]="none")}static enableDrag(){w.docStyle&&w.selectProp&&(w.docStyle[w.selectProp]=w.userSelect)}static setTransform(r,c){r.style[w.transformProp]=c}static addEventListener(r,c,f,_={}){r.addEventListener(c,f,"passive"in _?_:_.capture)}static removeEventListener(r,c,f,_={}){r.removeEventListener(c,f,"passive"in _?_:_.capture)}static suppressClickInternal(r){r.preventDefault(),r.stopPropagation(),window.removeEventListener("click",w.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",w.suppressClickInternal,!0),window.setTimeout(()=>{window.removeEventListener("click",w.suppressClickInternal,!0)},0)}static mousePos(r,c){const f=r.getBoundingClientRect();return new l.Point(c.clientX-f.left-r.clientLeft,c.clientY-f.top-r.clientTop)}static touchPos(r,c){const f=r.getBoundingClientRect(),_=[];for(let x=0;x<c.length;x++)_.push(new l.Point(c[x].clientX-f.left-r.clientLeft,c[x].clientY-f.top-r.clientTop));return _}static mouseButton(r){return r.button}static remove(r){r.parentNode&&r.parentNode.removeChild(r)}}w.docStyle=typeof window<"u"&&window.document&&window.document.documentElement.style,w.selectProp=w.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),w.transformProp=w.testProp(["transform","WebkitTransform"]);const C={supported:!1,testSupport:function(m){!O&&M&&(j?Z(m):I=m)}};let I,M,O=!1,j=!1;function Z(m){const r=m.createTexture();m.bindTexture(m.TEXTURE_2D,r);try{if(m.texImage2D(m.TEXTURE_2D,0,m.RGBA,m.RGBA,m.UNSIGNED_BYTE,M),m.isContextLost())return;C.supported=!0}catch{}m.deleteTexture(r),O=!0}var ue;typeof document<"u"&&(M=document.createElement("img"),M.onload=function(){I&&Z(I),I=null,j=!0},M.onerror=function(){O=!0,I=null},M.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA="),function(m){let r,c,f,_;m.resetRequestQueue=()=>{r=[],c=0,f=0,_={}},m.addThrottleControl=P=>{const z=f++;return _[z]=P,z},m.removeThrottleControl=P=>{delete _[P],A()},m.getImage=(P,z,L=!0)=>{C.supported&&(P.headers||(P.headers={}),P.headers.accept="image/webp,*/*");const G={requestParameters:P,supportImageRefresh:L,callback:z,cancelled:!1,completed:!1,cancel:()=>{G.completed||G.cancelled||(G.cancelled=!0,G.innerRequest&&(G.innerRequest.cancel(),c--),A())}};return r.push(G),A(),G};const x=P=>{const{requestParameters:z,supportImageRefresh:L,callback:G}=P;return l.extend(z,{type:"image"}),(L!==!1||l.isWorker()||l.getProtocolAction(z.url)||z.headers&&!Object.keys(z.headers).reduce((ee,K)=>ee&&K==="accept",!0)?l.makeRequest:k)(z,(ee,K,J,se)=>{E(P,G,ee,K,J,se)})},E=(P,z,L,G,ee,K)=>{L?z(L):G instanceof HTMLImageElement||G instanceof ImageBitmap?z(null,G):G&&((J,se)=>{typeof createImageBitmap=="function"?l.arrayBufferToImageBitmap(J,se):l.arrayBufferToImage(J,se)})(G,(J,se)=>{J!=null?z(J):se!=null&&z(null,se,{cacheControl:ee,expires:K})}),P.cancelled||(P.completed=!0,c--,A())},A=()=>{const P=(()=>{const z=Object.keys(_);let L=!1;if(z.length>0){for(const G of z)if(L=_[G](),L)break}return L})()?l.config.MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:l.config.MAX_PARALLEL_IMAGE_REQUESTS;for(let z=c;z<P&&r.length>0;z++){const L=r.shift();if(L.cancelled){z--;continue}const G=x(L);c++,L.innerRequest=G}},k=(P,z)=>{const L=new Image,G=P.url;let ee=!1;const K=P.credentials;return K&&K==="include"?L.crossOrigin="use-credentials":(K&&K==="same-origin"||!l.sameOrigin(G))&&(L.crossOrigin="anonymous"),L.fetchPriority="high",L.onload=()=>{z(null,L),L.onerror=L.onload=null},L.onerror=()=>{ee||z(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.")),L.onerror=L.onload=null},L.src=G,{cancel:()=>{ee=!0,L.src=""}}}}(ue||(ue={})),ue.resetRequestQueue();var ce,ve=ue;(function(m){m.Glyphs="Glyphs",m.Image="Image",m.Source="Source",m.SpriteImage="SpriteImage",m.SpriteJSON="SpriteJSON",m.Style="Style",m.Tile="Tile",m.Unknown="Unknown"})(ce||(ce={}));class ye{constructor(r){this._transformRequestFn=r}transformRequest(r,c){return this._transformRequestFn&&this._transformRequestFn(r,c)||{url:r}}normalizeSpriteURL(r,c,f){const _=function(x){const E=x.match(Ae);if(!E)throw new Error(`Unable to parse URL "${x}"`);return{protocol:E[1],authority:E[2],path:E[3]||"/",params:E[4]?E[4].split("&"):[]}}(r);return _.path+=`${c}${f}`,function(x){const E=x.params.length?`?${x.params.join("&")}`:"";return`${x.protocol}://${x.authority}${x.path}${E}`}(_)}setTransformRequest(r){this._transformRequestFn=r}}const Ae=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function Be(m){var r=new l.ARRAY_TYPE(3);return r[0]=m[0],r[1]=m[1],r[2]=m[2],r}var Le,Ie=function(m,r,c){return m[0]=r[0]-c[0],m[1]=r[1]-c[1],m[2]=r[2]-c[2],m};Le=new l.ARRAY_TYPE(3),l.ARRAY_TYPE!=Float32Array&&(Le[0]=0,Le[1]=0,Le[2]=0);var U=function(m){var r=m[0],c=m[1];return r*r+c*c};function H(m){const r=[];if(typeof m=="string")r.push({id:"default",url:m});else if(m&&m.length>0){const c=[];for(const{id:f,url:_}of m){const x=`${f}${_}`;c.indexOf(x)===-1&&(c.push(x),r.push({id:f,url:_}))}}return r}function he(m,r,c,f,_){if(f)return void m(f);if(_!==Object.values(r).length||_!==Object.values(c).length)return;const x={};for(const E in r){x[E]={};const A=l.exported.getImageCanvasContext(c[E]),k=r[E];for(const P in k){const{width:z,height:L,x:G,y:ee,sdf:K,pixelRatio:J,stretchX:se,stretchY:ge,content:Me}=k[P];x[E][P]={data:null,pixelRatio:J,sdf:K,stretchX:se,stretchY:ge,content:Me,spriteData:{width:z,height:L,x:G,y:ee,context:A}}}}m(null,x)}(function(){var m=new l.ARRAY_TYPE(2);l.ARRAY_TYPE!=Float32Array&&(m[0]=0,m[1]=0)})();class xe{constructor(r,c,f,_){this.context=r,this.format=f,this.texture=r.gl.createTexture(),this.update(c,_)}update(r,c,f){const{width:_,height:x}=r,E=!(this.size&&this.size[0]===_&&this.size[1]===x||f),{context:A}=this,{gl:k}=A;if(this.useMipmap=!!(c&&c.useMipmap),k.bindTexture(k.TEXTURE_2D,this.texture),A.pixelStoreUnpackFlipY.set(!1),A.pixelStoreUnpack.set(1),A.pixelStoreUnpackPremultiplyAlpha.set(this.format===k.RGBA&&(!c||c.premultiply!==!1)),E)this.size=[_,x],r instanceof HTMLImageElement||r instanceof HTMLCanvasElement||r instanceof HTMLVideoElement||r instanceof ImageData||l.isImageBitmap(r)?k.texImage2D(k.TEXTURE_2D,0,this.format,this.format,k.UNSIGNED_BYTE,r):k.texImage2D(k.TEXTURE_2D,0,this.format,_,x,0,this.format,k.UNSIGNED_BYTE,r.data);else{const{x:P,y:z}=f||{x:0,y:0};r instanceof HTMLImageElement||r instanceof HTMLCanvasElement||r instanceof HTMLVideoElement||r instanceof ImageData||l.isImageBitmap(r)?k.texSubImage2D(k.TEXTURE_2D,0,P,z,k.RGBA,k.UNSIGNED_BYTE,r):k.texSubImage2D(k.TEXTURE_2D,0,P,z,_,x,k.RGBA,k.UNSIGNED_BYTE,r.data)}this.useMipmap&&this.isSizePowerOfTwo()&&k.generateMipmap(k.TEXTURE_2D)}bind(r,c,f){const{context:_}=this,{gl:x}=_;x.bindTexture(x.TEXTURE_2D,this.texture),f!==x.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(f=x.LINEAR),r!==this.filter&&(x.texParameteri(x.TEXTURE_2D,x.TEXTURE_MAG_FILTER,r),x.texParameteri(x.TEXTURE_2D,x.TEXTURE_MIN_FILTER,f||r),this.filter=r),c!==this.wrap&&(x.texParameteri(x.TEXTURE_2D,x.TEXTURE_WRAP_S,c),x.texParameteri(x.TEXTURE_2D,x.TEXTURE_WRAP_T,c),this.wrap=c)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:r}=this.context;r.deleteTexture(this.texture),this.texture=null}}function we(m){const{userImage:r}=m;return!!(r&&r.render&&r.render())&&(m.data.replace(new Uint8Array(r.data.buffer)),!0)}class oe extends l.Evented{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new l.RGBAImage({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(r){if(this.loaded!==r&&(this.loaded=r,r)){for(const{ids:c,callback:f}of this.requestors)this._notify(c,f);this.requestors=[]}}getImage(r){const c=this.images[r];if(c&&!c.data&&c.spriteData){const f=c.spriteData;c.data=new l.RGBAImage({width:f.width,height:f.height},f.context.getImageData(f.x,f.y,f.width,f.height).data),c.spriteData=null}return c}addImage(r,c){if(this.images[r])throw new Error(`Image id ${r} already exist, use updateImage instead`);this._validate(r,c)&&(this.images[r]=c)}_validate(r,c){let f=!0;const _=c.data||c.spriteData;return this._validateStretch(c.stretchX,_&&_.width)||(this.fire(new l.ErrorEvent(new Error(`Image "${r}" has invalid "stretchX" value`))),f=!1),this._validateStretch(c.stretchY,_&&_.height)||(this.fire(new l.ErrorEvent(new Error(`Image "${r}" has invalid "stretchY" value`))),f=!1),this._validateContent(c.content,c)||(this.fire(new l.ErrorEvent(new Error(`Image "${r}" has invalid "content" value`))),f=!1),f}_validateStretch(r,c){if(!r)return!0;let f=0;for(const _ of r){if(_[0]<f||_[1]<_[0]||c<_[1])return!1;f=_[1]}return!0}_validateContent(r,c){if(!r)return!0;if(r.length!==4)return!1;const f=c.spriteData,_=f&&f.width||c.data.width,x=f&&f.height||c.data.height;return!(r[0]<0||_<r[0]||r[1]<0||x<r[1]||r[2]<0||_<r[2]||r[3]<0||x<r[3]||r[2]<r[0]||r[3]<r[1])}updateImage(r,c,f=!0){const _=this.getImage(r);if(f&&(_.data.width!==c.data.width||_.data.height!==c.data.height))throw new Error(`size mismatch between old image (${_.data.width}x${_.data.height}) and new image (${c.data.width}x${c.data.height}).`);c.version=_.version+1,this.images[r]=c,this.updatedImages[r]=!0}removeImage(r){const c=this.images[r];delete this.images[r],delete this.patterns[r],c.userImage&&c.userImage.onRemove&&c.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(r,c){let f=!0;if(!this.isLoaded())for(const _ of r)this.images[_]||(f=!1);this.isLoaded()||f?this._notify(r,c):this.requestors.push({ids:r,callback:c})}_notify(r,c){const f={};for(const _ of r){let x=this.getImage(_);x||(this.fire(new l.Event("styleimagemissing",{id:_})),x=this.getImage(_)),x?f[_]={data:x.data.clone(),pixelRatio:x.pixelRatio,sdf:x.sdf,version:x.version,stretchX:x.stretchX,stretchY:x.stretchY,content:x.content,hasRenderCallback:!!(x.userImage&&x.userImage.render)}:l.warnOnce(`Image "${_}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}c(null,f)}getPixelSize(){const{width:r,height:c}=this.atlasImage;return{width:r,height:c}}getPattern(r){const c=this.patterns[r],f=this.getImage(r);if(!f)return null;if(c&&c.position.version===f.version)return c.position;if(c)c.position.version=f.version;else{const _={w:f.data.width+2,h:f.data.height+2,x:0,y:0},x=new l.ImagePosition(_,f);this.patterns[r]={bin:_,position:x}}return this._updatePatternAtlas(),this.patterns[r].position}bind(r){const c=r.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new xe(r,this.atlasImage,c.RGBA),this.atlasTexture.bind(c.LINEAR,c.CLAMP_TO_EDGE)}_updatePatternAtlas(){const r=[];for(const x in this.patterns)r.push(this.patterns[x].bin);const{w:c,h:f}=l.potpack(r),_=this.atlasImage;_.resize({width:c||1,height:f||1});for(const x in this.patterns){const{bin:E}=this.patterns[x],A=E.x+1,k=E.y+1,P=this.getImage(x).data,z=P.width,L=P.height;l.RGBAImage.copy(P,_,{x:0,y:0},{x:A,y:k},{width:z,height:L}),l.RGBAImage.copy(P,_,{x:0,y:L-1},{x:A,y:k-1},{width:z,height:1}),l.RGBAImage.copy(P,_,{x:0,y:0},{x:A,y:k+L},{width:z,height:1}),l.RGBAImage.copy(P,_,{x:z-1,y:0},{x:A-1,y:k},{width:1,height:L}),l.RGBAImage.copy(P,_,{x:0,y:0},{x:A+z,y:k},{width:1,height:L})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(r){for(const c of r){if(this.callbackDispatchedThisFrame[c])continue;this.callbackDispatchedThisFrame[c]=!0;const f=this.getImage(c);f||l.warnOnce(`Image with ID: "${c}" was not found`),we(f)&&this.updateImage(c,f)}}}const ke=1e20;function tt(m,r,c,f,_,x,E,A,k){for(let P=r;P<r+f;P++)et(m,c*x+P,x,_,E,A,k);for(let P=c;P<c+_;P++)et(m,P*x+r,1,f,E,A,k)}function et(m,r,c,f,_,x,E){x[0]=0,E[0]=-ke,E[1]=ke,_[0]=m[r];for(let A=1,k=0,P=0;A<f;A++){_[A]=m[r+A*c];const z=A*A;do{const L=x[k];P=(_[A]-_[L]+z-L*L)/(A-L)/2}while(P<=E[k]&&--k>-1);k++,x[k]=A,E[k]=P,E[k+1]=ke}for(let A=0,k=0;A<f;A++){for(;E[k+1]<A;)k++;const P=x[k],z=A-P;m[r+A*c]=_[P]+z*z}}class Ve{constructor(r,c){this.requestManager=r,this.localIdeographFontFamily=c,this.entries={}}setURL(r){this.url=r}getGlyphs(r,c){const f=[];for(const _ in r)for(const x of r[_])f.push({stack:_,id:x});l.asyncAll(f,({stack:_,id:x},E)=>{let A=this.entries[_];A||(A=this.entries[_]={glyphs:{},requests:{},ranges:{}});let k=A.glyphs[x];if(k!==void 0)return void E(null,{stack:_,id:x,glyph:k});if(k=this._tinySDF(A,_,x),k)return A.glyphs[x]=k,void E(null,{stack:_,id:x,glyph:k});const P=Math.floor(x/256);if(256*P>65535)return void E(new Error("glyphs > 65535 not supported"));if(A.ranges[P])return void E(null,{stack:_,id:x,glyph:k});if(!this.url)return void E(new Error("glyphsUrl is not set"));let z=A.requests[P];z||(z=A.requests[P]=[],Ve.loadGlyphRange(_,P,this.url,this.requestManager,(L,G)=>{if(G){for(const ee in G)this._doesCharSupportLocalGlyph(+ee)||(A.glyphs[+ee]=G[+ee]);A.ranges[P]=!0}for(const ee of z)ee(L,G);delete A.requests[P]})),z.push((L,G)=>{L?E(L):G&&E(null,{stack:_,id:x,glyph:G[x]||null})})},(_,x)=>{if(_)c(_);else if(x){const E={};for(const{stack:A,id:k,glyph:P}of x)(E[A]||(E[A]={}))[k]=P&&{id:P.id,bitmap:P.bitmap.clone(),metrics:P.metrics};c(null,E)}})}_doesCharSupportLocalGlyph(r){return!!this.localIdeographFontFamily&&(l.unicodeBlockLookup["CJK Unified Ideographs"](r)||l.unicodeBlockLookup["Hangul Syllables"](r)||l.unicodeBlockLookup.Hiragana(r)||l.unicodeBlockLookup.Katakana(r))}_tinySDF(r,c,f){const _=this.localIdeographFontFamily;if(!_||!this._doesCharSupportLocalGlyph(f))return;let x=r.tinySDF;if(!x){let A="400";/bold/i.test(c)?A="900":/medium/i.test(c)?A="500":/light/i.test(c)&&(A="200"),x=r.tinySDF=new Ve.TinySDF({fontSize:24,buffer:3,radius:8,cutoff:.25,fontFamily:_,fontWeight:A})}const E=x.draw(String.fromCharCode(f));return{id:f,bitmap:new l.AlphaImage({width:E.width||30,height:E.height||30},E.data),metrics:{width:E.glyphWidth||24,height:E.glyphHeight||24,left:E.glyphLeft||0,top:E.glyphTop-27||-8,advance:E.glyphAdvance||24}}}}Ve.loadGlyphRange=function(m,r,c,f,_){const x=256*r,E=x+255,A=f.transformRequest(c.replace("{fontstack}",m).replace("{range}",`${x}-${E}`),ce.Glyphs);l.getArrayBuffer(A,(k,P)=>{if(k)_(k);else if(P){const z={};for(const L of l.parseGlyphPbf(P))z[L.id]=L;_(null,z)}})},Ve.TinySDF=class{constructor({fontSize:m=24,buffer:r=3,radius:c=8,cutoff:f=.25,fontFamily:_="sans-serif",fontWeight:x="normal",fontStyle:E="normal"}={}){this.buffer=r,this.cutoff=f,this.radius=c;const A=this.size=m+4*r,k=this._createCanvas(A),P=this.ctx=k.getContext("2d",{willReadFrequently:!0});P.font=`${E} ${x} ${m}px ${_}`,P.textBaseline="alphabetic",P.textAlign="left",P.fillStyle="black",this.gridOuter=new Float64Array(A*A),this.gridInner=new Float64Array(A*A),this.f=new Float64Array(A),this.z=new Float64Array(A+1),this.v=new Uint16Array(A)}_createCanvas(m){const r=document.createElement("canvas");return r.width=r.height=m,r}draw(m){const{width:r,actualBoundingBoxAscent:c,actualBoundingBoxDescent:f,actualBoundingBoxLeft:_,actualBoundingBoxRight:x}=this.ctx.measureText(m),E=Math.ceil(c),A=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(x-_))),k=Math.min(this.size-this.buffer,E+Math.ceil(f)),P=A+2*this.buffer,z=k+2*this.buffer,L=Math.max(P*z,0),G=new Uint8ClampedArray(L),ee={data:G,width:P,height:z,glyphWidth:A,glyphHeight:k,glyphTop:E,glyphLeft:0,glyphAdvance:r};if(A===0||k===0)return ee;const{ctx:K,buffer:J,gridInner:se,gridOuter:ge}=this;K.clearRect(J,J,A,k),K.fillText(m,J,J+E);const Me=K.getImageData(J,J,A,k);ge.fill(ke,0,L),se.fill(0,0,L);for(let re=0;re<k;re++)for(let Pe=0;Pe<A;Pe++){const Fe=Me.data[4*(re*A+Pe)+3]/255;if(Fe===0)continue;const Qe=(re+J)*P+Pe+J;if(Fe===1)ge[Qe]=0,se[Qe]=ke;else{const ot=.5-Fe;ge[Qe]=ot>0?ot*ot:0,se[Qe]=ot<0?ot*ot:0}}tt(ge,0,0,P,z,P,this.f,this.v,this.z),tt(se,J,J,A,k,P,this.f,this.v,this.z);for(let re=0;re<L;re++){const Pe=Math.sqrt(ge[re])-Math.sqrt(se[re]);G[re]=Math.round(255-255*(Pe/this.radius+this.cutoff))}return ee}};class $e{constructor(){this.specification=l.v8Spec.light.position}possiblyEvaluate(r,c){return l.sphericalToCartesian(r.expression.evaluate(c))}interpolate(r,c,f){return{x:l.interpolate.number(r.x,c.x,f),y:l.interpolate.number(r.y,c.y,f),z:l.interpolate.number(r.z,c.z,f)}}}let He,kt;class Ct extends l.Evented{constructor(r){super(),He=He||new l.Properties({anchor:new l.DataConstantProperty(l.v8Spec.light.anchor),position:new $e,color:new l.DataConstantProperty(l.v8Spec.light.color),intensity:new l.DataConstantProperty(l.v8Spec.light.intensity)}),this._transitionable=new l.Transitionable(He),this.setLight(r),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(r,c={}){if(!this._validate(l.validateLight,r,c))for(const f in r){const _=r[f];f.endsWith("-transition")?this._transitionable.setTransition(f.slice(0,-11),_):this._transitionable.setValue(f,_)}}updateTransitions(r){this._transitioning=this._transitionable.transitioned(r,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(r){this.properties=this._transitioning.possiblyEvaluate(r)}_validate(r,c,f){return(!f||f.validate!==!1)&&l.emitValidationErrors(this,r.call(l.validateStyle,l.extend({value:c,style:{glyphs:!0,sprite:!0},styleSpec:l.v8Spec})))}}class rt{constructor(r,c){this.width=r,this.height=c,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(r,c){const f=r.join(",")+String(c);return this.dashEntry[f]||(this.dashEntry[f]=this.addDash(r,c)),this.dashEntry[f]}getDashRanges(r,c,f){const _=[];let x=r.length%2==1?-r[r.length-1]*f:0,E=r[0]*f,A=!0;_.push({left:x,right:E,isDash:A,zeroLength:r[0]===0});let k=r[0];for(let P=1;P<r.length;P++){A=!A;const z=r[P];x=k*f,k+=z,E=k*f,_.push({left:x,right:E,isDash:A,zeroLength:z===0})}return _}addRoundDash(r,c,f){const _=c/2;for(let x=-f;x<=f;x++){const E=this.width*(this.nextRow+f+x);let A=0,k=r[A];for(let P=0;P<this.width;P++){P/k.right>1&&(k=r[++A]);const z=Math.abs(P-k.left),L=Math.abs(P-k.right),G=Math.min(z,L);let ee;const K=x/f*(_+1);if(k.isDash){const J=_-Math.abs(K);ee=Math.sqrt(G*G+J*J)}else ee=_-Math.sqrt(G*G+K*K);this.data[E+P]=Math.max(0,Math.min(255,ee+128))}}}addRegularDash(r){for(let A=r.length-1;A>=0;--A){const k=r[A],P=r[A+1];k.zeroLength?r.splice(A,1):P&&P.isDash===k.isDash&&(P.left=k.left,r.splice(A,1))}const c=r[0],f=r[r.length-1];c.isDash===f.isDash&&(c.left=f.left-this.width,f.right=c.right+this.width);const _=this.width*this.nextRow;let x=0,E=r[x];for(let A=0;A<this.width;A++){A/E.right>1&&(E=r[++x]);const k=Math.abs(A-E.left),P=Math.abs(A-E.right),z=Math.min(k,P);this.data[_+A]=Math.max(0,Math.min(255,(E.isDash?z:-z)+128))}}addDash(r,c){const f=c?7:0,_=2*f+1;if(this.nextRow+_>this.height)return l.warnOnce("LineAtlas out of space"),null;let x=0;for(let A=0;A<r.length;A++)x+=r[A];if(x!==0){const A=this.width/x,k=this.getDashRanges(r,this.width,A);c?this.addRoundDash(k,A,f):this.addRegularDash(k)}const E={y:(this.nextRow+f+.5)/this.height,height:2*f/this.height,width:x};return this.nextRow+=_,this.dirty=!0,E}bind(r){const c=r.gl;this.texture?(c.bindTexture(c.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,c.texSubImage2D(c.TEXTURE_2D,0,0,0,this.width,this.height,c.ALPHA,c.UNSIGNED_BYTE,this.data))):(this.texture=c.createTexture(),c.bindTexture(c.TEXTURE_2D,this.texture),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_S,c.REPEAT),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_T,c.REPEAT),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MIN_FILTER,c.LINEAR),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MAG_FILTER,c.LINEAR),c.texImage2D(c.TEXTURE_2D,0,c.ALPHA,this.width,this.height,0,c.ALPHA,c.UNSIGNED_BYTE,this.data))}}class It{constructor(r,c,f){this.workerPool=r,this.actors=[],this.currentActor=0,this.id=f;const _=this.workerPool.acquire(f);for(let x=0;x<_.length;x++){const E=new It.Actor(_[x],c,f);E.name=`Worker ${x}`,this.actors.push(E)}if(!this.actors.length)throw new Error("No actors found")}broadcast(r,c,f){l.asyncAll(this.actors,(_,x)=>{_.send(r,c,x)},f=f||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(r=!0){this.actors.forEach(c=>{c.remove()}),this.actors=[],r&&this.workerPool.release(this.id)}}function Vt(m,r,c){const f=function(_,x){if(_)return c(_);if(x){const E=l.pick(l.extend(x,m),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);x.vector_layers&&(E.vectorLayers=x.vector_layers,E.vectorLayerIds=E.vectorLayers.map(A=>A.id)),c(null,E)}};return m.url?l.getJSON(r.transformRequest(m.url,ce.Source),f):l.exported.frame(()=>f(null,m))}It.Actor=l.Actor;class Lt{constructor(r,c){r&&(c?this.setSouthWest(r).setNorthEast(c):Array.isArray(r)&&(r.length===4?this.setSouthWest([r[0],r[1]]).setNorthEast([r[2],r[3]]):this.setSouthWest(r[0]).setNorthEast(r[1])))}setNorthEast(r){return this._ne=r instanceof l.LngLat?new l.LngLat(r.lng,r.lat):l.LngLat.convert(r),this}setSouthWest(r){return this._sw=r instanceof l.LngLat?new l.LngLat(r.lng,r.lat):l.LngLat.convert(r),this}extend(r){const c=this._sw,f=this._ne;let _,x;if(r instanceof l.LngLat)_=r,x=r;else{if(!(r instanceof Lt))return Array.isArray(r)?r.length===4||r.every(Array.isArray)?this.extend(Lt.convert(r)):this.extend(l.LngLat.convert(r)):r&&("lng"in r||"lon"in r)&&"lat"in r?this.extend(l.LngLat.convert(r)):this;if(_=r._sw,x=r._ne,!_||!x)return this}return c||f?(c.lng=Math.min(_.lng,c.lng),c.lat=Math.min(_.lat,c.lat),f.lng=Math.max(x.lng,f.lng),f.lat=Math.max(x.lat,f.lat)):(this._sw=new l.LngLat(_.lng,_.lat),this._ne=new l.LngLat(x.lng,x.lat)),this}getCenter(){return new l.LngLat((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new l.LngLat(this.getWest(),this.getNorth())}getSouthEast(){return new l.LngLat(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(r){const{lng:c,lat:f}=l.LngLat.convert(r);let _=this._sw.lng<=c&&c<=this._ne.lng;return this._sw.lng>this._ne.lng&&(_=this._sw.lng>=c&&c>=this._ne.lng),this._sw.lat<=f&&f<=this._ne.lat&&_}static convert(r){return r instanceof Lt?r:r&&new Lt(r)}static fromLngLat(r,c=0){const f=360*c/40075017,_=f/Math.cos(Math.PI/180*r.lat);return new Lt(new l.LngLat(r.lng-_,r.lat-f),new l.LngLat(r.lng+_,r.lat+f))}}class qe{constructor(r,c,f){this.bounds=Lt.convert(this.validateBounds(r)),this.minzoom=c||0,this.maxzoom=f||24}validateBounds(r){return Array.isArray(r)&&r.length===4?[Math.max(-180,r[0]),Math.max(-90,r[1]),Math.min(180,r[2]),Math.min(90,r[3])]:[-180,-90,180,90]}contains(r){const c=Math.pow(2,r.z),f=Math.floor(l.mercatorXfromLng(this.bounds.getWest())*c),_=Math.floor(l.mercatorYfromLat(this.bounds.getNorth())*c),x=Math.ceil(l.mercatorXfromLng(this.bounds.getEast())*c),E=Math.ceil(l.mercatorYfromLat(this.bounds.getSouth())*c);return r.x>=f&&r.x<x&&r.y>=_&&r.y<E}}class Se extends l.Evented{constructor(r,c,f,_){if(super(),this.id=r,this.dispatcher=f,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,l.extend(this,l.pick(c,["url","scheme","tileSize","promoteId"])),this._options=l.extend({type:"vector"},c),this._collectResourceTiming=c.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(_)}load(){this._loaded=!1,this.fire(new l.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=Vt(this._options,this.map._requestManager,(r,c)=>{this._tileJSONRequest=null,this._loaded=!0,this.map.style.sourceCaches[this.id].clearTiles(),r?this.fire(new l.ErrorEvent(r)):c&&(l.extend(this,c),c.bounds&&(this.tileBounds=new qe(c.bounds,this.minzoom,this.maxzoom)),this.fire(new l.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new l.Event("data",{dataType:"source",sourceDataType:"content"})))})}loaded(){return this._loaded}hasTile(r){return!this.tileBounds||this.tileBounds.contains(r.canonical)}onAdd(r){this.map=r,this.load()}setSourceProperty(r){this._tileJSONRequest&&this._tileJSONRequest.cancel(),r(),this.load()}setTiles(r){return this.setSourceProperty(()=>{this._options.tiles=r}),this}setUrl(r){return this.setSourceProperty(()=>{this.url=r,this._options.url=r}),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}serialize(){return l.extend({},this._options)}loadTile(r,c){const f=r.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),_={request:this.map._requestManager.transformRequest(f,ce.Tile),uid:r.uid,tileID:r.tileID,zoom:r.tileID.overscaledZ,tileSize:this.tileSize*r.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};function x(E,A){return delete r.request,r.aborted?c(null):E&&E.status!==404?c(E):(A&&A.resourceTiming&&(r.resourceTiming=A.resourceTiming),this.map._refreshExpiredTiles&&A&&r.setExpiryData(A),r.loadVectorData(A,this.map.painter),c(null),void(r.reloadCallback&&(this.loadTile(r,r.reloadCallback),r.reloadCallback=null)))}_.request.collectResourceTiming=this._collectResourceTiming,r.actor&&r.state!=="expired"?r.state==="loading"?r.reloadCallback=c:r.request=r.actor.send("reloadTile",_,x.bind(this)):(r.actor=this.dispatcher.getActor(),r.request=r.actor.send("loadTile",_,x.bind(this)))}abortTile(r){r.request&&(r.request.cancel(),delete r.request),r.actor&&r.actor.send("abortTile",{uid:r.uid,type:this.type,source:this.id},void 0)}unloadTile(r){r.unloadVectorData(),r.actor&&r.actor.send("removeTile",{uid:r.uid,type:this.type,source:this.id},void 0)}hasTransition(){return!1}}class Ye extends l.Evented{constructor(r,c,f,_){super(),this.id=r,this.dispatcher=f,this.setEventedParent(_),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=l.extend({type:"raster"},c),l.extend(this,l.pick(c,["url","scheme","tileSize"]))}load(){this._loaded=!1,this.fire(new l.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=Vt(this._options,this.map._requestManager,(r,c)=>{this._tileJSONRequest=null,this._loaded=!0,r?this.fire(new l.ErrorEvent(r)):c&&(l.extend(this,c),c.bounds&&(this.tileBounds=new qe(c.bounds,this.minzoom,this.maxzoom)),this.fire(new l.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new l.Event("data",{dataType:"source",sourceDataType:"content"})))})}loaded(){return this._loaded}onAdd(r){this.map=r,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}serialize(){return l.extend({},this._options)}hasTile(r){return!this.tileBounds||this.tileBounds.contains(r.canonical)}loadTile(r,c){const f=r.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);r.request=ve.getImage(this.map._requestManager.transformRequest(f,ce.Tile),(_,x,E)=>{if(delete r.request,r.aborted)r.state="unloaded",c(null);else if(_)r.state="errored",c(_);else if(x){this.map._refreshExpiredTiles&&E&&r.setExpiryData(E);const A=this.map.painter.context,k=A.gl;r.texture=this.map.painter.getTileTexture(x.width),r.texture?r.texture.update(x,{useMipmap:!0}):(r.texture=new xe(A,x,k.RGBA,{useMipmap:!0}),r.texture.bind(k.LINEAR,k.CLAMP_TO_EDGE,k.LINEAR_MIPMAP_NEAREST),A.extTextureFilterAnisotropic&&k.texParameterf(k.TEXTURE_2D,A.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,A.extTextureFilterAnisotropicMax)),r.state="loaded",c(null)}},this.map._refreshExpiredTiles)}abortTile(r,c){r.request&&(r.request.cancel(),delete r.request),c()}unloadTile(r,c){r.texture&&this.map.painter.saveTileTexture(r.texture),c()}hasTransition(){return!1}}class Oe extends Ye{constructor(r,c,f,_){super(r,c,f,_),this.type="raster-dem",this.maxzoom=22,this._options=l.extend({type:"raster-dem"},c),this.encoding=c.encoding||"mapbox"}serialize(){return{type:"raster-dem",url:this.url,tileSize:this.tileSize,tiles:this.tiles,bounds:this.bounds,encoding:this.encoding}}loadTile(r,c){const f=r.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);function _(x,E){x&&(r.state="errored",c(x)),E&&(r.dem=E,r.needsHillshadePrepare=!0,r.needsTerrainPrepare=!0,r.state="loaded",c(null))}r.request=ve.getImage(this.map._requestManager.transformRequest(f,ce.Tile),function(x,E){if(delete r.request,r.aborted)r.state="unloaded",c(null);else if(x)r.state="errored",c(x);else if(E){this.map._refreshExpiredTiles&&r.setExpiryData(E),delete E.cacheControl,delete E.expires;const A=l.isImageBitmap(E)&&(kt==null&&(kt=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&typeof createImageBitmap=="function"),kt)?E:l.exported.getImageData(E,1),k={uid:r.uid,coord:r.tileID,source:this.id,rawImageData:A,encoding:this.encoding};r.actor&&r.state!=="expired"||(r.actor=this.dispatcher.getActor(),r.actor.send("loadDEMTile",k,_.bind(this)))}}.bind(this),this.map._refreshExpiredTiles),r.neighboringTiles=this._getNeighboringTiles(r.tileID)}_getNeighboringTiles(r){const c=r.canonical,f=Math.pow(2,c.z),_=(c.x-1+f)%f,x=c.x===0?r.wrap-1:r.wrap,E=(c.x+1+f)%f,A=c.x+1===f?r.wrap+1:r.wrap,k={};return k[new l.OverscaledTileID(r.overscaledZ,x,c.z,_,c.y).key]={backfilled:!1},k[new l.OverscaledTileID(r.overscaledZ,A,c.z,E,c.y).key]={backfilled:!1},c.y>0&&(k[new l.OverscaledTileID(r.overscaledZ,x,c.z,_,c.y-1).key]={backfilled:!1},k[new l.OverscaledTileID(r.overscaledZ,r.wrap,c.z,c.x,c.y-1).key]={backfilled:!1},k[new l.OverscaledTileID(r.overscaledZ,A,c.z,E,c.y-1).key]={backfilled:!1}),c.y+1<f&&(k[new l.OverscaledTileID(r.overscaledZ,x,c.z,_,c.y+1).key]={backfilled:!1},k[new l.OverscaledTileID(r.overscaledZ,r.wrap,c.z,c.x,c.y+1).key]={backfilled:!1},k[new l.OverscaledTileID(r.overscaledZ,A,c.z,E,c.y+1).key]={backfilled:!1}),k}unloadTile(r){r.demTexture&&this.map.painter.saveTileTexture(r.demTexture),r.fbo&&(r.fbo.destroy(),delete r.fbo),r.dem&&delete r.dem,delete r.neighboringTiles,r.state="unloaded",r.actor&&r.actor.send("removeDEMTile",{uid:r.uid,source:this.id})}}class je extends l.Evented{constructor(r,c,f,_){super(),this.id=r,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._pendingLoads=0,this.actor=f.getActor(),this.setEventedParent(_),this._data=c.data,this._options=l.extend({},c),this._collectResourceTiming=c.collectResourceTiming,c.maxzoom!==void 0&&(this.maxzoom=c.maxzoom),c.type&&(this.type=c.type),c.attribution&&(this.attribution=c.attribution),this.promoteId=c.promoteId;const x=l.EXTENT/this.tileSize;this.workerOptions=l.extend({source:this.id,cluster:c.cluster||!1,geojsonVtOptions:{buffer:(c.buffer!==void 0?c.buffer:128)*x,tolerance:(c.tolerance!==void 0?c.tolerance:.375)*x,extent:l.EXTENT,maxZoom:this.maxzoom,lineMetrics:c.lineMetrics||!1,generateId:c.generateId||!1},superclusterOptions:{maxZoom:c.clusterMaxZoom!==void 0?c.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,c.clusterMinPoints||2),extent:l.EXTENT,radius:(c.clusterRadius||50)*x,log:!1,generateId:c.generateId||!1},clusterProperties:c.clusterProperties,filter:c.filter},c.workerOptions),typeof this.promoteId=="string"&&(this.workerOptions.promoteId=this.promoteId)}load(){this._updateWorkerData()}onAdd(r){this.map=r,this.load()}setData(r){return this._data=r,this._updateWorkerData(),this}updateData(r){return this._updateWorkerData(r),this}setClusterOptions(r){return this.workerOptions.cluster=r.cluster,r&&(r.clusterRadius!==void 0&&(this.workerOptions.superclusterOptions.radius=r.clusterRadius),r.clusterMaxZoom!==void 0&&(this.workerOptions.superclusterOptions.maxZoom=r.clusterMaxZoom)),this._updateWorkerData(),this}getClusterExpansionZoom(r,c){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:r,source:this.id},c),this}getClusterChildren(r,c){return this.actor.send("geojson.getClusterChildren",{clusterId:r,source:this.id},c),this}getClusterLeaves(r,c,f,_){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:r,limit:c,offset:f},_),this}_updateWorkerData(r){const c=l.extend({},this.workerOptions);r?c.dataDiff=r:typeof this._data=="string"?(c.request=this.map._requestManager.transformRequest(l.exported.resolveURL(this._data),ce.Source),c.request.collectResourceTiming=this._collectResourceTiming):c.data=JSON.stringify(this._data),this._pendingLoads++,this.fire(new l.Event("dataloading",{dataType:"source"})),this.actor.send(`${this.type}.loadData`,c,(f,_)=>{if(this._pendingLoads--,this._removed||_&&_.abandoned)return void this.fire(new l.Event("dataabort",{dataType:"source"}));let x=null;if(_&&_.resourceTiming&&_.resourceTiming[this.id]&&(x=_.resourceTiming[this.id].slice(0)),f)return void this.fire(new l.ErrorEvent(f));const E={dataType:"source"};this._collectResourceTiming&&x&&x.length>0&&l.extend(E,{resourceTiming:x}),this.fire(new l.Event("data",{...E,sourceDataType:"metadata"})),this.fire(new l.Event("data",{...E,sourceDataType:"content"}))})}loaded(){return this._pendingLoads===0}loadTile(r,c){const f=r.actor?"reloadTile":"loadTile";r.actor=this.actor;const _={type:this.type,uid:r.uid,tileID:r.tileID,zoom:r.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};r.request=this.actor.send(f,_,(x,E)=>(delete r.request,r.unloadVectorData(),r.aborted?c(null):x?c(x):(r.loadVectorData(E,this.map.painter,f==="reloadTile"),c(null))))}abortTile(r){r.request&&(r.request.cancel(),delete r.request),r.aborted=!0}unloadTile(r){r.unloadVectorData(),this.actor.send("removeTile",{uid:r.uid,type:this.type,source:this.id})}onRemove(){this._removed=!0,this.actor.send("removeSource",{type:this.type,source:this.id})}serialize(){return l.extend({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}}var ft=l.createLayout([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class Y extends l.Evented{constructor(r,c,f,_){super(),this.id=r,this.dispatcher=f,this.coordinates=c.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(_),this.options=c}load(r,c){this._loaded=!1,this.fire(new l.Event("dataloading",{dataType:"source"})),this.url=this.options.url,this._request=ve.getImage(this.map._requestManager.transformRequest(this.url,ce.Image),(f,_)=>{this._request=null,this._loaded=!0,f?this.fire(new l.ErrorEvent(f)):_&&(this.image=_,r&&(this.coordinates=r),c&&c(),this._finishLoading())})}loaded(){return this._loaded}updateImage(r){return r.url?(this._request&&(this._request.cancel(),this._request=null),this.options.url=r.url,this.load(r.coordinates,()=>{this.texture=null}),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new l.Event("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(r){this.map=r,this.load()}onRemove(){this._request&&(this._request.cancel(),this._request=null)}setCoordinates(r){this.coordinates=r;const c=r.map(l.MercatorCoordinate.fromLngLat);this.tileID=function(_){let x=1/0,E=1/0,A=-1/0,k=-1/0;for(const G of _)x=Math.min(x,G.x),E=Math.min(E,G.y),A=Math.max(A,G.x),k=Math.max(k,G.y);const P=Math.max(A-x,k-E),z=Math.max(0,Math.floor(-Math.log(P)/Math.LN2)),L=Math.pow(2,z);return new l.CanonicalTileID(z,Math.floor((x+A)/2*L),Math.floor((E+k)/2*L))}(c),this.minzoom=this.maxzoom=this.tileID.z;const f=c.map(_=>this.tileID.getTilePoint(_)._round());return this._boundsArray=new l.RasterBoundsArray,this._boundsArray.emplaceBack(f[0].x,f[0].y,0,0),this._boundsArray.emplaceBack(f[1].x,f[1].y,l.EXTENT,0),this._boundsArray.emplaceBack(f[3].x,f[3].y,0,l.EXTENT),this._boundsArray.emplaceBack(f[2].x,f[2].y,l.EXTENT,l.EXTENT),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new l.Event("data",{dataType:"source",sourceDataType:"content"})),this}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const r=this.map.painter.context,c=r.gl;this.boundsBuffer||(this.boundsBuffer=r.createVertexBuffer(this._boundsArray,ft.members)),this.boundsSegments||(this.boundsSegments=l.SegmentVector.simpleSegment(0,0,4,2)),this.texture||(this.texture=new xe(r,this.image,c.RGBA),this.texture.bind(c.LINEAR,c.CLAMP_TO_EDGE));let f=!1;for(const _ in this.tiles){const x=this.tiles[_];x.state!=="loaded"&&(x.state="loaded",x.texture=this.texture,f=!0)}f&&this.fire(new l.Event("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}loadTile(r,c){this.tileID&&this.tileID.equals(r.tileID.canonical)?(this.tiles[String(r.tileID.wrap)]=r,r.buckets={},c(null)):(r.state="errored",c(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}class ie extends Y{constructor(r,c,f,_){super(r,c,f,_),this.roundZoom=!0,this.type="video",this.options=c}load(){this._loaded=!1;const r=this.options;this.urls=[];for(const c of r.urls)this.urls.push(this.map._requestManager.transformRequest(c,ce.Source).url);l.getVideo(this.urls,(c,f)=>{this._loaded=!0,c?this.fire(new l.ErrorEvent(c)):f&&(this.video=f,this.video.loop=!0,this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(r){if(this.video){const c=this.video.seekable;r<c.start(0)||r>c.end(0)?this.fire(new l.ErrorEvent(new l.ValidationError(`sources.${this.id}`,null,`Playback for this video can be set only between the ${c.start(0)} and ${c.end(0)}-second mark.`))):this.video.currentTime=r}}getVideo(){return this.video}onAdd(r){this.map||(this.map=r,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const r=this.map.painter.context,c=r.gl;this.boundsBuffer||(this.boundsBuffer=r.createVertexBuffer(this._boundsArray,ft.members)),this.boundsSegments||(this.boundsSegments=l.SegmentVector.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(c.LINEAR,c.CLAMP_TO_EDGE),c.texSubImage2D(c.TEXTURE_2D,0,0,0,c.RGBA,c.UNSIGNED_BYTE,this.video)):(this.texture=new xe(r,this.video,c.RGBA),this.texture.bind(c.LINEAR,c.CLAMP_TO_EDGE));let f=!1;for(const _ in this.tiles){const x=this.tiles[_];x.state!=="loaded"&&(x.state="loaded",x.texture=this.texture,f=!0)}f&&this.fire(new l.Event("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}}class W extends Y{constructor(r,c,f,_){super(r,c,f,_),c.coordinates?Array.isArray(c.coordinates)&&c.coordinates.length===4&&!c.coordinates.some(x=>!Array.isArray(x)||x.length!==2||x.some(E=>typeof E!="number"))||this.fire(new l.ErrorEvent(new l.ValidationError(`sources.${r}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new l.ErrorEvent(new l.ValidationError(`sources.${r}`,null,'missing required property "coordinates"'))),c.animate&&typeof c.animate!="boolean"&&this.fire(new l.ErrorEvent(new l.ValidationError(`sources.${r}`,null,'optional "animate" property must be a boolean value'))),c.canvas?typeof c.canvas=="string"||c.canvas instanceof HTMLCanvasElement||this.fire(new l.ErrorEvent(new l.ValidationError(`sources.${r}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new l.ErrorEvent(new l.ValidationError(`sources.${r}`,null,'missing required property "canvas"'))),this.options=c,this.animate=c.animate===void 0||c.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new l.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(r){this.map=r,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let r=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,r=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,r=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const c=this.map.painter.context,f=c.gl;this.boundsBuffer||(this.boundsBuffer=c.createVertexBuffer(this._boundsArray,ft.members)),this.boundsSegments||(this.boundsSegments=l.SegmentVector.simpleSegment(0,0,4,2)),this.texture?(r||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new xe(c,this.canvas,f.RGBA,{premultiply:!0});let _=!1;for(const x in this.tiles){const E=this.tiles[x];E.state!=="loaded"&&(E.state="loaded",E.texture=this.texture,_=!0)}_&&this.fire(new l.Event("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const r of[this.canvas.width,this.canvas.height])if(isNaN(r)||r<=0)return!0;return!1}}const De={vector:Se,raster:Ye,"raster-dem":Oe,geojson:je,video:ie,image:Y,canvas:W};function Ue(m,r){const c=l.create();return l.translate(c,c,[1,1,0]),l.scale(c,c,[.5*m.width,.5*m.height,1]),l.multiply(c,c,m.calculatePosMatrix(r.toUnwrapped()))}function Ne(m,r,c,f,_,x){const E=function(L,G,ee){if(L)for(const K of L){const J=G[K];if(J&&J.source===ee&&J.type==="fill-extrusion")return!0}else for(const K in G){const J=G[K];if(J.source===ee&&J.type==="fill-extrusion")return!0}return!1}(_&&_.layers,r,m.id),A=x.maxPitchScaleFactor(),k=m.tilesIn(f,A,E);k.sort(Ze);const P=[];for(const L of k)P.push({wrappedTileID:L.tileID.wrapped().key,queryResults:L.tile.queryRenderedFeatures(r,c,m._state,L.queryGeometry,L.cameraQueryGeometry,L.scale,_,x,A,Ue(m.transform,L.tileID))});const z=function(L){const G={},ee={};for(const K of L){const J=K.queryResults,se=K.wrappedTileID,ge=ee[se]=ee[se]||{};for(const Me in J){const re=J[Me],Pe=ge[Me]=ge[Me]||{},Fe=G[Me]=G[Me]||[];for(const Qe of re)Pe[Qe.featureIndex]||(Pe[Qe.featureIndex]=!0,Fe.push(Qe))}}return G}(P);for(const L in z)z[L].forEach(G=>{const ee=G.feature,K=m.getFeatureState(ee.layer["source-layer"],ee.id);ee.source=ee.layer.source,ee.layer["source-layer"]&&(ee.sourceLayer=ee.layer["source-layer"]),ee.state=K});return z}function Ze(m,r){const c=m.tileID,f=r.tileID;return c.overscaledZ-f.overscaledZ||c.canonical.y-f.canonical.y||c.wrap-f.wrap||c.canonical.x-f.canonical.x}class ct{constructor(r,c){this.timeAdded=0,this.fadeEndTime=0,this.tileID=r,this.uid=l.uniqueId(),this.uses=0,this.tileSize=c,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.rtt=[],this.rttCoords={},this.expiredRequestCount=0,this.state="loading"}registerFadeDuration(r){const c=r+this.timeAdded;c<this.fadeEndTime||(this.fadeEndTime=c)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}clearTextures(r){this.demTexture&&r.saveTileTexture(this.demTexture),this.demTexture=null}loadVectorData(r,c,f){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",r){r.featureIndex&&(this.latestFeatureIndex=r.featureIndex,r.rawTileData?(this.latestRawTileData=r.rawTileData,this.latestFeatureIndex.rawTileData=r.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=r.collisionBoxArray,this.buckets=function(_,x){const E={};if(!x)return E;for(const A of _){const k=A.layerIds.map(P=>x.getLayer(P)).filter(Boolean);if(k.length!==0){A.layers=k,A.stateDependentLayerIds&&(A.stateDependentLayers=A.stateDependentLayerIds.map(P=>k.filter(z=>z.id===P)[0]));for(const P of k)E[P.id]=A}}return E}(r.buckets,c.style),this.hasSymbolBuckets=!1;for(const _ in this.buckets){const x=this.buckets[_];if(x instanceof l.SymbolBucket){if(this.hasSymbolBuckets=!0,!f)break;x.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const _ in this.buckets){const x=this.buckets[_];if(x instanceof l.SymbolBucket&&x.hasRTLText){this.hasRTLText=!0,l.lazyLoadRTLTextPlugin();break}}this.queryPadding=0;for(const _ in this.buckets){const x=this.buckets[_];this.queryPadding=Math.max(this.queryPadding,c.style.getLayer(_).queryRadius(x))}r.imageAtlas&&(this.imageAtlas=r.imageAtlas),r.glyphAtlasImage&&(this.glyphAtlasImage=r.glyphAtlasImage)}else this.collisionBoxArray=new l.CollisionBoxArray}unloadVectorData(){for(const r in this.buckets)this.buckets[r].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(r){return this.buckets[r.id]}upload(r){for(const f in this.buckets){const _=this.buckets[f];_.uploadPending()&&_.upload(r)}const c=r.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new xe(r,this.imageAtlas.image,c.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new xe(r,this.glyphAtlasImage,c.ALPHA),this.glyphAtlasImage=null)}prepare(r){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(r,this.imageAtlasTexture)}queryRenderedFeatures(r,c,f,_,x,E,A,k,P,z){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:_,cameraQueryGeometry:x,scale:E,tileSize:this.tileSize,pixelPosMatrix:z,transform:k,params:A,queryPadding:this.queryPadding*P},r,c,f):{}}querySourceFeatures(r,c){const f=this.latestFeatureIndex;if(!f||!f.rawTileData)return;const _=f.loadVTLayers(),x=c&&c.sourceLayer?c.sourceLayer:"",E=_._geojsonTileLayer||_[x];if(!E)return;const A=l.createFilter(c&&c.filter),{z:k,x:P,y:z}=this.tileID.canonical,L={z:k,x:P,y:z};for(let G=0;G<E.length;G++){const ee=E.feature(G);if(A.needGeometry){const se=l.toEvaluationFeature(ee,!0);if(!A.filter(new l.EvaluationParameters(this.tileID.overscaledZ),se,this.tileID.canonical))continue}else if(!A.filter(new l.EvaluationParameters(this.tileID.overscaledZ),ee))continue;const K=f.getId(ee,x),J=new l.GeoJSONFeature(ee,k,P,z,K);J.tile=L,r.push(J)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(r){const c=this.expirationTime;if(r.cacheControl){const f=l.parseCacheControl(r.cacheControl);f["max-age"]&&(this.expirationTime=Date.now()+1e3*f["max-age"])}else r.expires&&(this.expirationTime=new Date(r.expires).getTime());if(this.expirationTime){const f=Date.now();let _=!1;if(this.expirationTime>f)_=!1;else if(c)if(this.expirationTime<c)_=!0;else{const x=this.expirationTime-c;x?this.expirationTime=f+Math.max(x,3e4):_=!0}else _=!0;_?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(r,c){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(r).length===0)return;const f=this.latestFeatureIndex.loadVTLayers();for(const _ in this.buckets){if(!c.style.hasLayer(_))continue;const x=this.buckets[_],E=x.layers[0].sourceLayer||"_geojsonTileLayer",A=f[E],k=r[E];if(!A||!k||Object.keys(k).length===0)continue;x.update(k,A,this.imageAtlas&&this.imageAtlas.patternPositions||{});const P=c&&c.style&&c.style.getLayer(_);P&&(this.queryPadding=Math.max(this.queryPadding,P.queryRadius(x)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<l.exported.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(r){this.symbolFadeHoldUntil=l.exported.now()+r}setDependencies(r,c){const f={};for(const _ of c)f[_]=!0;this.dependencies[r]=f}hasDependency(r,c){for(const f of r){const _=this.dependencies[f];if(_){for(const x of c)if(_[x])return!0}}return!1}}class dt{constructor(r,c){this.max=r,this.onRemove=c,this.reset()}reset(){for(const r in this.data)for(const c of this.data[r])c.timeout&&clearTimeout(c.timeout),this.onRemove(c.value);return this.data={},this.order=[],this}add(r,c,f){const _=r.wrapped().key;this.data[_]===void 0&&(this.data[_]=[]);const x={value:c,timeout:void 0};if(f!==void 0&&(x.timeout=setTimeout(()=>{this.remove(r,x)},f)),this.data[_].push(x),this.order.push(_),this.order.length>this.max){const E=this._getAndRemoveByKey(this.order[0]);E&&this.onRemove(E)}return this}has(r){return r.wrapped().key in this.data}getAndRemove(r){return this.has(r)?this._getAndRemoveByKey(r.wrapped().key):null}_getAndRemoveByKey(r){const c=this.data[r].shift();return c.timeout&&clearTimeout(c.timeout),this.data[r].length===0&&delete this.data[r],this.order.splice(this.order.indexOf(r),1),c.value}getByKey(r){const c=this.data[r];return c?c[0].value:null}get(r){return this.has(r)?this.data[r.wrapped().key][0].value:null}remove(r,c){if(!this.has(r))return this;const f=r.wrapped().key,_=c===void 0?0:this.data[f].indexOf(c),x=this.data[f][_];return this.data[f].splice(_,1),x.timeout&&clearTimeout(x.timeout),this.data[f].length===0&&delete this.data[f],this.onRemove(x.value),this.order.splice(this.order.indexOf(f),1),this}setMaxSize(r){for(this.max=r;this.order.length>this.max;){const c=this._getAndRemoveByKey(this.order[0]);c&&this.onRemove(c)}return this}filter(r){const c=[];for(const f in this.data)for(const _ of this.data[f])r(_.value)||c.push(_);for(const f of c)this.remove(f.value.tileID,f)}}class nt{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(r,c,f){const _=String(c);if(this.stateChanges[r]=this.stateChanges[r]||{},this.stateChanges[r][_]=this.stateChanges[r][_]||{},l.extend(this.stateChanges[r][_],f),this.deletedStates[r]===null){this.deletedStates[r]={};for(const x in this.state[r])x!==_&&(this.deletedStates[r][x]=null)}else if(this.deletedStates[r]&&this.deletedStates[r][_]===null){this.deletedStates[r][_]={};for(const x in this.state[r][_])f[x]||(this.deletedStates[r][_][x]=null)}else for(const x in f)this.deletedStates[r]&&this.deletedStates[r][_]&&this.deletedStates[r][_][x]===null&&delete this.deletedStates[r][_][x]}removeFeatureState(r,c,f){if(this.deletedStates[r]===null)return;const _=String(c);if(this.deletedStates[r]=this.deletedStates[r]||{},f&&c!==void 0)this.deletedStates[r][_]!==null&&(this.deletedStates[r][_]=this.deletedStates[r][_]||{},this.deletedStates[r][_][f]=null);else if(c!==void 0)if(this.stateChanges[r]&&this.stateChanges[r][_])for(f in this.deletedStates[r][_]={},this.stateChanges[r][_])this.deletedStates[r][_][f]=null;else this.deletedStates[r][_]=null;else this.deletedStates[r]=null}getState(r,c){const f=String(c),_=l.extend({},(this.state[r]||{})[f],(this.stateChanges[r]||{})[f]);if(this.deletedStates[r]===null)return{};if(this.deletedStates[r]){const x=this.deletedStates[r][c];if(x===null)return{};for(const E in x)delete _[E]}return _}initializeTileState(r,c){r.setFeatureState(this.state,c)}coalesceChanges(r,c){const f={};for(const _ in this.stateChanges){this.state[_]=this.state[_]||{};const x={};for(const E in this.stateChanges[_])this.state[_][E]||(this.state[_][E]={}),l.extend(this.state[_][E],this.stateChanges[_][E]),x[E]=this.state[_][E];f[_]=x}for(const _ in this.deletedStates){this.state[_]=this.state[_]||{};const x={};if(this.deletedStates[_]===null)for(const E in this.state[_])x[E]={},this.state[_][E]={};else for(const E in this.deletedStates[_]){if(this.deletedStates[_][E]===null)this.state[_][E]={};else for(const A of Object.keys(this.deletedStates[_][E]))delete this.state[_][E][A];x[E]=this.state[_][E]}f[_]=f[_]||{},l.extend(f[_],x)}if(this.stateChanges={},this.deletedStates={},Object.keys(f).length!==0)for(const _ in r)r[_].setFeatureState(f,c)}}class ut extends l.Evented{constructor(r,c,f){super(),this.id=r,this.dispatcher=f,this.on("data",_=>{_.dataType==="source"&&_.sourceDataType==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&_.dataType==="source"&&_.sourceDataType==="content"&&(this.reload(),this.transform&&this.update(this.transform,this.terrain),this._didEmitContent=!0)}),this.on("dataloading",()=>{this._sourceErrored=!1}),this.on("error",()=>{this._sourceErrored=this._source.loaded()}),this._source=function(_,x,E,A){const k=new De[x.type](_,x,E,A);if(k.id!==_)throw new Error(`Expected Source id to be ${_} instead of ${k.id}`);return l.bindAll(["load","abort","unload","serialize","prepare"],k),k}(r,c,f,this),this._tiles={},this._cache=new dt(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._maxTileCacheZoomLevels=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new nt,this._didEmitContent=!1,this._updated=!1}onAdd(r){this.map=r,this._maxTileCacheSize=r?r._maxTileCacheSize:null,this._maxTileCacheZoomLevels=r?r._maxTileCacheZoomLevels:null,this._source&&this._source.onAdd&&this._source.onAdd(r)}onRemove(r){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(r)}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;if(!(this.used===void 0&&this.usedForTerrain===void 0||this.used||this.usedForTerrain))return!0;if(!this._updated)return!1;for(const r in this._tiles){const c=this._tiles[r];if(c.state!=="loaded"&&c.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const r=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,r&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(r,c){return this._source.loadTile(r,c)}_unloadTile(r){if(this._source.unloadTile)return this._source.unloadTile(r,()=>{})}_abortTile(r){this._source.abortTile&&this._source.abortTile(r,()=>{}),this._source.fire(new l.Event("dataabort",{tile:r,coord:r.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(r){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const c in this._tiles){const f=this._tiles[c];f.upload(r),f.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map(r=>r.tileID).sort(mt).map(r=>r.key)}getRenderableIds(r){const c=[];for(const f in this._tiles)this._isIdRenderable(f,r)&&c.push(this._tiles[f]);return r?c.sort((f,_)=>{const x=f.tileID,E=_.tileID,A=new l.Point(x.canonical.x,x.canonical.y)._rotate(this.transform.angle),k=new l.Point(E.canonical.x,E.canonical.y)._rotate(this.transform.angle);return x.overscaledZ-E.overscaledZ||k.y-A.y||k.x-A.x}).map(f=>f.tileID.key):c.map(f=>f.tileID).sort(mt).map(f=>f.key)}hasRenderableParent(r){const c=this.findLoadedParent(r,0);return!!c&&this._isIdRenderable(c.tileID.key)}_isIdRenderable(r,c){return this._tiles[r]&&this._tiles[r].hasData()&&!this._coveredTiles[r]&&(c||!this._tiles[r].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const r in this._tiles)this._tiles[r].state!=="errored"&&this._reloadTile(r,"reloading")}}_reloadTile(r,c){const f=this._tiles[r];f&&(f.state!=="loading"&&(f.state=c),this._loadTile(f,this._tileLoaded.bind(this,f,r,c)))}_tileLoaded(r,c,f,_){if(_)return r.state="errored",void(_.status!==404?this._source.fire(new l.ErrorEvent(_,{tile:r})):this.update(this.transform,this.terrain));r.timeAdded=l.exported.now(),f==="expired"&&(r.refreshedUponExpiration=!0),this._setTileReloadTimer(c,r),this.getSource().type==="raster-dem"&&r.dem&&this._backfillDEM(r),this._state.initializeTileState(r,this.map?this.map.painter:null),r.aborted||this._source.fire(new l.Event("data",{dataType:"source",tile:r,coord:r.tileID}))}_backfillDEM(r){const c=this.getRenderableIds();for(let _=0;_<c.length;_++){const x=c[_];if(r.neighboringTiles&&r.neighboringTiles[x]){const E=this.getTileByID(x);f(r,E),f(E,r)}}function f(_,x){_.needsHillshadePrepare=!0,_.needsTerrainPrepare=!0;let E=x.tileID.canonical.x-_.tileID.canonical.x;const A=x.tileID.canonical.y-_.tileID.canonical.y,k=Math.pow(2,_.tileID.canonical.z),P=x.tileID.key;E===0&&A===0||Math.abs(A)>1||(Math.abs(E)>1&&(Math.abs(E+k)===1?E+=k:Math.abs(E-k)===1&&(E-=k)),x.dem&&_.dem&&(_.dem.backfillBorder(x.dem,E,A),_.neighboringTiles&&_.neighboringTiles[P]&&(_.neighboringTiles[P].backfilled=!0)))}}getTile(r){return this.getTileByID(r.key)}getTileByID(r){return this._tiles[r]}_retainLoadedChildren(r,c,f,_){for(const x in this._tiles){let E=this._tiles[x];if(_[x]||!E.hasData()||E.tileID.overscaledZ<=c||E.tileID.overscaledZ>f)continue;let A=E.tileID;for(;E&&E.tileID.overscaledZ>c+1;){const P=E.tileID.scaledTo(E.tileID.overscaledZ-1);E=this._tiles[P.key],E&&E.hasData()&&(A=P)}let k=A;for(;k.overscaledZ>c;)if(k=k.scaledTo(k.overscaledZ-1),r[k.key]){_[A.key]=A;break}}}findLoadedParent(r,c){if(r.key in this._loadedParentTiles){const f=this._loadedParentTiles[r.key];return f&&f.tileID.overscaledZ>=c?f:null}for(let f=r.overscaledZ-1;f>=c;f--){const _=r.scaledTo(f),x=this._getLoadedTile(_);if(x)return x}}_getLoadedTile(r){const c=this._tiles[r.key];return c&&c.hasData()?c:this._cache.getByKey(r.wrapped().key)}updateCacheSize(r){const c=Math.ceil(r.width/this._source.tileSize)+1,f=Math.ceil(r.height/this._source.tileSize)+1,_=Math.floor(c*f*(this._maxTileCacheZoomLevels===null?l.config.MAX_TILE_CACHE_ZOOM_LEVELS:this._maxTileCacheZoomLevels)),x=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,_):_;this._cache.setMaxSize(x)}handleWrapJump(r){const c=Math.round((r-(this._prevLng===void 0?r:this._prevLng))/360);if(this._prevLng=r,c){const f={};for(const _ in this._tiles){const x=this._tiles[_];x.tileID=x.tileID.unwrapTo(x.tileID.wrap+c),f[x.tileID.key]=x}this._tiles=f;for(const _ in this._timers)clearTimeout(this._timers[_]),delete this._timers[_];for(const _ in this._tiles)this._setTileReloadTimer(_,this._tiles[_])}}update(r,c){if(this.transform=r,this.terrain=c,!this._sourceLoaded||this._paused)return;let f;this.updateCacheSize(r),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?f=r.getVisibleUnwrappedCoordinates(this._source.tileID).map(z=>new l.OverscaledTileID(z.canonical.z,z.wrap,z.canonical.z,z.canonical.x,z.canonical.y)):(f=r.coveringTiles({tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:c}),this._source.hasTile&&(f=f.filter(z=>this._source.hasTile(z)))):f=[];const _=r.coveringZoomLevel(this._source),x=Math.max(_-ut.maxOverzooming,this._source.minzoom),E=Math.max(_+ut.maxUnderzooming,this._source.minzoom);if(this.usedForTerrain){const z={};for(const L of f)if(L.canonical.z>this._source.minzoom){const G=L.scaledTo(L.canonical.z-1);z[G.key]=G;const ee=L.scaledTo(Math.max(this._source.minzoom,Math.min(L.canonical.z,5)));z[ee.key]=ee}f=f.concat(Object.values(z))}const A=f.length===0&&!this._updated&&this._didEmitContent;this._updated=!0,A&&this.fire(new l.Event("data",{sourceDataType:"idle",dataType:"source",sourceId:this.id}));const k=this._updateRetainedTiles(f,_);if(Mt(this._source.type)){const z={},L={},G=Object.keys(k),ee=l.exported.now();for(const K of G){const J=k[K],se=this._tiles[K];if(!se||se.fadeEndTime!==0&&se.fadeEndTime<=ee)continue;const ge=this.findLoadedParent(J,x);ge&&(this._addTile(ge.tileID),z[ge.tileID.key]=ge.tileID),L[K]=J}this._retainLoadedChildren(L,_,E,k);for(const K in z)k[K]||(this._coveredTiles[K]=!0,k[K]=z[K]);if(c){const K={},J={};for(const se of f)this._tiles[se.key].hasData()?K[se.key]=se:J[se.key]=se;for(const se in J){const ge=J[se].children(this._source.maxzoom);this._tiles[ge[0].key]&&this._tiles[ge[1].key]&&this._tiles[ge[2].key]&&this._tiles[ge[3].key]&&(K[ge[0].key]=k[ge[0].key]=ge[0],K[ge[1].key]=k[ge[1].key]=ge[1],K[ge[2].key]=k[ge[2].key]=ge[2],K[ge[3].key]=k[ge[3].key]=ge[3],delete J[se])}for(const se in J){const ge=this.findLoadedParent(J[se],this._source.minzoom);if(ge){K[ge.tileID.key]=k[ge.tileID.key]=ge.tileID;for(const Me in K)K[Me].isChildOf(ge.tileID)&&delete K[Me]}}for(const se in this._tiles)K[se]||(this._coveredTiles[se]=!0)}}for(const z in k)this._tiles[z].clearFadeHold();const P=l.keysDifference(this._tiles,k);for(const z of P){const L=this._tiles[z];L.hasSymbolBuckets&&!L.holdingForFade()?L.setHoldDuration(this.map._fadeDuration):L.hasSymbolBuckets&&!L.symbolFadeFinished()||this._removeTile(z)}this._updateLoadedParentTileCache()}releaseSymbolFadeTiles(){for(const r in this._tiles)this._tiles[r].holdingForFade()&&this._removeTile(r)}_updateRetainedTiles(r,c){const f={},_={},x=Math.max(c-ut.maxOverzooming,this._source.minzoom),E=Math.max(c+ut.maxUnderzooming,this._source.minzoom),A={};for(const k of r){const P=this._addTile(k);f[k.key]=k,P.hasData()||c<this._source.maxzoom&&(A[k.key]=k)}this._retainLoadedChildren(A,c,E,f);for(const k of r){let P=this._tiles[k.key];if(P.hasData())continue;if(c+1>this._source.maxzoom){const L=k.children(this._source.maxzoom)[0],G=this.getTile(L);if(G&&G.hasData()){f[L.key]=L;continue}}else{const L=k.children(this._source.maxzoom);if(f[L[0].key]&&f[L[1].key]&&f[L[2].key]&&f[L[3].key])continue}let z=P.wasRequested();for(let L=k.overscaledZ-1;L>=x;--L){const G=k.scaledTo(L);if(_[G.key])break;if(_[G.key]=!0,P=this.getTile(G),!P&&z&&(P=this._addTile(G)),P){const ee=P.hasData();if((z||ee)&&(f[G.key]=G),z=P.wasRequested(),ee)break}}}return f}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const r in this._tiles){const c=[];let f,_=this._tiles[r].tileID;for(;_.overscaledZ>0;){if(_.key in this._loadedParentTiles){f=this._loadedParentTiles[_.key];break}c.push(_.key);const x=_.scaledTo(_.overscaledZ-1);if(f=this._getLoadedTile(x),f)break;_=x}for(const x of c)this._loadedParentTiles[x]=f}}_addTile(r){let c=this._tiles[r.key];if(c)return c;c=this._cache.getAndRemove(r),c&&(this._setTileReloadTimer(r.key,c),c.tileID=r,this._state.initializeTileState(c,this.map?this.map.painter:null),this._cacheTimers[r.key]&&(clearTimeout(this._cacheTimers[r.key]),delete this._cacheTimers[r.key],this._setTileReloadTimer(r.key,c)));const f=c;return c||(c=new ct(r,this._source.tileSize*r.overscaleFactor()),this._loadTile(c,this._tileLoaded.bind(this,c,r.key,c.state))),c.uses++,this._tiles[r.key]=c,f||this._source.fire(new l.Event("dataloading",{tile:c,coord:c.tileID,dataType:"source"})),c}_setTileReloadTimer(r,c){r in this._timers&&(clearTimeout(this._timers[r]),delete this._timers[r]);const f=c.getExpiryTimeout();f&&(this._timers[r]=setTimeout(()=>{this._reloadTile(r,"expired"),delete this._timers[r]},f))}_removeTile(r){const c=this._tiles[r];c&&(c.uses--,delete this._tiles[r],this._timers[r]&&(clearTimeout(this._timers[r]),delete this._timers[r]),c.uses>0||(c.hasData()&&c.state!=="reloading"?this._cache.add(c.tileID,c,c.getExpiryTimeout()):(c.aborted=!0,this._abortTile(c),this._unloadTile(c))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const r in this._tiles)this._removeTile(r);this._cache.reset()}tilesIn(r,c,f){const _=[],x=this.transform;if(!x)return _;const E=f?x.getCameraQueryGeometry(r):r,A=r.map(K=>x.pointCoordinate(K,this.terrain)),k=E.map(K=>x.pointCoordinate(K,this.terrain)),P=this.getIds();let z=1/0,L=1/0,G=-1/0,ee=-1/0;for(const K of k)z=Math.min(z,K.x),L=Math.min(L,K.y),G=Math.max(G,K.x),ee=Math.max(ee,K.y);for(let K=0;K<P.length;K++){const J=this._tiles[P[K]];if(J.holdingForFade())continue;const se=J.tileID,ge=Math.pow(2,x.zoom-J.tileID.overscaledZ),Me=c*J.queryPadding*l.EXTENT/J.tileSize/ge,re=[se.getTilePoint(new l.MercatorCoordinate(z,L)),se.getTilePoint(new l.MercatorCoordinate(G,ee))];if(re[0].x-Me<l.EXTENT&&re[0].y-Me<l.EXTENT&&re[1].x+Me>=0&&re[1].y+Me>=0){const Pe=A.map(Qe=>se.getTilePoint(Qe)),Fe=k.map(Qe=>se.getTilePoint(Qe));_.push({tile:J,tileID:se,queryGeometry:Pe,cameraQueryGeometry:Fe,scale:ge})}}return _}getVisibleCoordinates(r){const c=this.getRenderableIds(r).map(f=>this._tiles[f].tileID);for(const f of c)f.posMatrix=this.transform.calculatePosMatrix(f.toUnwrapped());return c}hasTransition(){if(this._source.hasTransition())return!0;if(Mt(this._source.type)){const r=l.exported.now();for(const c in this._tiles)if(this._tiles[c].fadeEndTime>=r)return!0}return!1}setFeatureState(r,c,f){this._state.updateState(r=r||"_geojsonTileLayer",c,f)}removeFeatureState(r,c,f){this._state.removeFeatureState(r=r||"_geojsonTileLayer",c,f)}getFeatureState(r,c){return this._state.getState(r=r||"_geojsonTileLayer",c)}setDependencies(r,c,f){const _=this._tiles[r];_&&_.setDependencies(c,f)}reloadTilesForDependencies(r,c){for(const f in this._tiles)this._tiles[f].hasDependency(r,c)&&this._reloadTile(f,"reloading");this._cache.filter(f=>!f.hasDependency(r,c))}}function mt(m,r){const c=Math.abs(2*m.wrap)-+(m.wrap<0),f=Math.abs(2*r.wrap)-+(r.wrap<0);return m.overscaledZ-r.overscaledZ||f-c||r.canonical.y-m.canonical.y||r.canonical.x-m.canonical.x}function Mt(m){return m==="raster"||m==="image"||m==="video"}ut.maxOverzooming=10,ut.maxUnderzooming=3;const wt="mapboxgl_preloaded_worker_pool";class Ge{constructor(){this.active={}}acquire(r){if(!this.workers)for(this.workers=[];this.workers.length<Ge.workerCount;)this.workers.push(new Worker(l.config.WORKER_URL));return this.active[r]=!0,this.workers.slice()}release(r){delete this.active[r],this.numActive()===0&&(this.workers.forEach(c=>{c.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[wt]}numActive(){return Object.keys(this.active).length}}const tn=Math.floor(l.exported.hardwareConcurrency/2);let Zt;function dn(){return Zt||(Zt=new Ge),Zt}Ge.workerCount=l.isSafari(globalThis)?Math.max(Math.min(tn,3),1):1;class zn{constructor(r,c){this.reset(r,c)}reset(r,c){this.points=r||[],this._distances=[0];for(let f=1;f<this.points.length;f++)this._distances[f]=this._distances[f-1]+this.points[f].dist(this.points[f-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(c||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(r){if(this.points.length===1)return this.points[0];r=l.clamp(r,0,1);let c=1,f=this._distances[c];const _=r*this.paddedLength+this.padding;for(;f<_&&c<this._distances.length;)f=this._distances[++c];const x=c-1,E=this._distances[x],A=f-E,k=A>0?(_-E)/A:0;return this.points[x].mult(1-k).add(this.points[c].mult(k))}}function at(m,r){let c=!0;return m==="always"||m!=="never"&&r!=="never"||(c=!1),c}class jt{constructor(r,c,f){const _=this.boxCells=[],x=this.circleCells=[];this.xCellCount=Math.ceil(r/f),this.yCellCount=Math.ceil(c/f);for(let E=0;E<this.xCellCount*this.yCellCount;E++)_.push([]),x.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=r,this.height=c,this.xScale=this.xCellCount/r,this.yScale=this.yCellCount/c,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(r,c,f,_,x){this._forEachCell(c,f,_,x,this._insertBoxCell,this.boxUid++),this.boxKeys.push(r),this.bboxes.push(c),this.bboxes.push(f),this.bboxes.push(_),this.bboxes.push(x)}insertCircle(r,c,f,_){this._forEachCell(c-_,f-_,c+_,f+_,this._insertCircleCell,this.circleUid++),this.circleKeys.push(r),this.circles.push(c),this.circles.push(f),this.circles.push(_)}_insertBoxCell(r,c,f,_,x,E){this.boxCells[x].push(E)}_insertCircleCell(r,c,f,_,x,E){this.circleCells[x].push(E)}_query(r,c,f,_,x,E,A){if(f<0||r>this.width||_<0||c>this.height)return[];const k=[];if(r<=0&&c<=0&&this.width<=f&&this.height<=_){if(x)return[{key:null,x1:r,y1:c,x2:f,y2:_}];for(let P=0;P<this.boxKeys.length;P++)k.push({key:this.boxKeys[P],x1:this.bboxes[4*P],y1:this.bboxes[4*P+1],x2:this.bboxes[4*P+2],y2:this.bboxes[4*P+3]});for(let P=0;P<this.circleKeys.length;P++){const z=this.circles[3*P],L=this.circles[3*P+1],G=this.circles[3*P+2];k.push({key:this.circleKeys[P],x1:z-G,y1:L-G,x2:z+G,y2:L+G})}}else this._forEachCell(r,c,f,_,this._queryCell,k,{hitTest:x,overlapMode:E,seenUids:{box:{},circle:{}}},A);return k}query(r,c,f,_){return this._query(r,c,f,_,!1,null)}hitTest(r,c,f,_,x,E){return this._query(r,c,f,_,!0,x,E).length>0}hitTestCircle(r,c,f,_,x){const E=r-f,A=r+f,k=c-f,P=c+f;if(A<0||E>this.width||P<0||k>this.height)return!1;const z=[];return this._forEachCell(E,k,A,P,this._queryCellCircle,z,{hitTest:!0,overlapMode:_,circle:{x:r,y:c,radius:f},seenUids:{box:{},circle:{}}},x),z.length>0}_queryCell(r,c,f,_,x,E,A,k){const{seenUids:P,hitTest:z,overlapMode:L}=A,G=this.boxCells[x];if(G!==null){const K=this.bboxes;for(const J of G)if(!P.box[J]){P.box[J]=!0;const se=4*J,ge=this.boxKeys[J];if(r<=K[se+2]&&c<=K[se+3]&&f>=K[se+0]&&_>=K[se+1]&&(!k||k(ge))&&(!z||!at(L,ge.overlapMode))&&(E.push({key:ge,x1:K[se],y1:K[se+1],x2:K[se+2],y2:K[se+3]}),z))return!0}}const ee=this.circleCells[x];if(ee!==null){const K=this.circles;for(const J of ee)if(!P.circle[J]){P.circle[J]=!0;const se=3*J,ge=this.circleKeys[J];if(this._circleAndRectCollide(K[se],K[se+1],K[se+2],r,c,f,_)&&(!k||k(ge))&&(!z||!at(L,ge.overlapMode))){const Me=K[se],re=K[se+1],Pe=K[se+2];if(E.push({key:ge,x1:Me-Pe,y1:re-Pe,x2:Me+Pe,y2:re+Pe}),z)return!0}}}return!1}_queryCellCircle(r,c,f,_,x,E,A,k){const{circle:P,seenUids:z,overlapMode:L}=A,G=this.boxCells[x];if(G!==null){const K=this.bboxes;for(const J of G)if(!z.box[J]){z.box[J]=!0;const se=4*J,ge=this.boxKeys[J];if(this._circleAndRectCollide(P.x,P.y,P.radius,K[se+0],K[se+1],K[se+2],K[se+3])&&(!k||k(ge))&&!at(L,ge.overlapMode))return E.push(!0),!0}}const ee=this.circleCells[x];if(ee!==null){const K=this.circles;for(const J of ee)if(!z.circle[J]){z.circle[J]=!0;const se=3*J,ge=this.circleKeys[J];if(this._circlesCollide(K[se],K[se+1],K[se+2],P.x,P.y,P.radius)&&(!k||k(ge))&&!at(L,ge.overlapMode))return E.push(!0),!0}}}_forEachCell(r,c,f,_,x,E,A,k){const P=this._convertToXCellCoord(r),z=this._convertToYCellCoord(c),L=this._convertToXCellCoord(f),G=this._convertToYCellCoord(_);for(let ee=P;ee<=L;ee++)for(let K=z;K<=G;K++)if(x.call(this,r,c,f,_,this.xCellCount*K+ee,E,A,k))return}_convertToXCellCoord(r){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(r*this.xScale)))}_convertToYCellCoord(r){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(r*this.yScale)))}_circlesCollide(r,c,f,_,x,E){const A=_-r,k=x-c,P=f+E;return P*P>A*A+k*k}_circleAndRectCollide(r,c,f,_,x,E,A){const k=(E-_)/2,P=Math.abs(r-(_+k));if(P>k+f)return!1;const z=(A-x)/2,L=Math.abs(c-(x+z));if(L>z+f)return!1;if(P<=k||L<=z)return!0;const G=P-k,ee=L-z;return G*G+ee*ee<=f*f}}function qt(m,r,c,f,_){const x=l.create();return r?(l.scale(x,x,[1/_,1/_,1]),c||l.rotateZ(x,x,f.angle)):l.multiply(x,f.labelPlaneMatrix,m),x}function Dn(m,r,c,f,_){if(r){const x=l.clone(m);return l.scale(x,x,[_,_,1]),c||l.rotateZ(x,x,-f.angle),x}return f.glCoordMatrix}function fn(m,r,c){let f;c?(f=[m.x,m.y,c(m.x,m.y),1],l.transformMat4(f,f,r)):(f=[m.x,m.y,0,1],ae(f,f,r));const _=f[3];return{point:new l.Point(f[0]/_,f[1]/_),signedDistanceFromCamera:_}}function Ot(m,r){return .5+m/r*.5}function Fr(m,r){const c=m[0]/m[3],f=m[1]/m[3];return c>=-r[0]&&c<=r[0]&&f>=-r[1]&&f<=r[1]}function ks(m,r,c,f,_,x,E,A,k,P){const z=f?m.textSizeData:m.iconSizeData,L=l.evaluateSizeForZoom(z,c.transform.zoom),G=[256/c.width*2+1,256/c.height*2+1],ee=f?m.text.dynamicLayoutVertexArray:m.icon.dynamicLayoutVertexArray;ee.clear();const K=m.lineVertexArray,J=f?m.text.placedSymbolArray:m.icon.placedSymbolArray,se=c.transform.width/c.transform.height;let ge=!1;for(let Me=0;Me<J.length;Me++){const re=J.get(Me);if(re.hidden||re.writingMode===l.WritingMode.vertical&&!ge){X(re.numGlyphs,ee);continue}let Pe;if(ge=!1,P?(Pe=[re.anchorX,re.anchorY,P(re.anchorX,re.anchorY),1],l.transformMat4(Pe,Pe,r)):(Pe=[re.anchorX,re.anchorY,0,1],ae(Pe,Pe,r)),!Fr(Pe,G)){X(re.numGlyphs,ee);continue}const Fe=Ot(c.transform.cameraToCenterDistance,Pe[3]),Qe=l.evaluateSizeForFeature(z,L,re),ot=E?Qe/Fe:Qe*Fe,ht=new l.Point(re.anchorX,re.anchorY),it=fn(ht,_,P).point,St={projections:{},offsets:{}},Ut=Oi(re,ot,!1,A,r,_,x,m.glyphOffsetArray,K,ee,it,ht,St,se,k,P);ge=Ut.useVertical,(Ut.notEnoughRoom||ge||Ut.needsFlipping&&Oi(re,ot,!0,A,r,_,x,m.glyphOffsetArray,K,ee,it,ht,St,se,k,P).notEnoughRoom)&&X(re.numGlyphs,ee)}f?m.text.dynamicLayoutVertexBuffer.updateData(ee):m.icon.dynamicLayoutVertexBuffer.updateData(ee)}function Kr(m,r,c,f,_,x,E,A,k,P,z,L,G){const ee=A.glyphStartIndex+A.numGlyphs,K=A.lineStartIndex,J=A.lineStartIndex+A.lineLength,se=r.getoffsetX(A.glyphStartIndex),ge=r.getoffsetX(ee-1),Me=F(m*se,c,f,_,x,E,A.segment,K,J,k,P,z,L,G);if(!Me)return null;const re=F(m*ge,c,f,_,x,E,A.segment,K,J,k,P,z,L,G);return re?{first:Me,last:re}:null}function As(m,r,c,f){return m===l.WritingMode.horizontal&&Math.abs(c.y-r.y)>Math.abs(c.x-r.x)*f?{useVertical:!0}:(m===l.WritingMode.vertical?r.y<c.y:r.x>c.x)?{needsFlipping:!0}:null}function Oi(m,r,c,f,_,x,E,A,k,P,z,L,G,ee,K,J){const se=r/24,ge=m.lineOffsetX*se,Me=m.lineOffsetY*se;let re;if(m.numGlyphs>1){const Pe=m.glyphStartIndex+m.numGlyphs,Fe=m.lineStartIndex,Qe=m.lineStartIndex+m.lineLength,ot=Kr(se,A,ge,Me,c,z,L,m,k,x,G,K,J);if(!ot)return{notEnoughRoom:!0};const ht=fn(ot.first.point,E,J).point,it=fn(ot.last.point,E,J).point;if(f&&!c){const St=As(m.writingMode,ht,it,ee);if(St)return St}re=[ot.first];for(let St=m.glyphStartIndex+1;St<Pe-1;St++)re.push(F(se*A.getoffsetX(St),ge,Me,c,z,L,m.segment,Fe,Qe,k,x,G,K,J));re.push(ot.last)}else{if(f&&!c){const Fe=fn(L,_,J).point,Qe=m.lineStartIndex+m.segment+1,ot=new l.Point(k.getx(Qe),k.gety(Qe)),ht=fn(ot,_,J),it=ht.signedDistanceFromCamera>0?ht.point:Un(L,ot,Fe,1,_,J),St=As(m.writingMode,Fe,it,ee);if(St)return St}const Pe=F(se*A.getoffsetX(m.glyphStartIndex),ge,Me,c,z,L,m.segment,m.lineStartIndex,m.lineStartIndex+m.lineLength,k,x,G,K,J);if(!Pe)return{notEnoughRoom:!0};re=[Pe]}for(const Pe of re)l.addDynamicAttributes(P,Pe.point,Pe.angle);return{}}function Un(m,r,c,f,_,x){const E=fn(m.add(m.sub(r)._unit()),_,x).point,A=c.sub(E);return c.add(A._mult(f/A.mag()))}function Lo(m,r){const{projectionCache:c,lineVertexArray:f,labelPlaneMatrix:_,tileAnchorPoint:x,distanceFromAnchor:E,getElevation:A,previousVertex:k,direction:P,absOffsetX:z}=r;if(c.projections[m])return c.projections[m];const L=new l.Point(f.getx(m),f.gety(m)),G=fn(L,_,A);if(G.signedDistanceFromCamera>0)return c.projections[m]=G.point,G.point;const ee=m-P;return Un(E===0?x:new l.Point(f.getx(ee),f.gety(ee)),L,k,z-E+1,_,A)}function ds(m,r,c){return m._unit()._perp()._mult(r*c)}function ne(m,r,c,f,_,x,E,A){const{projectionCache:k,direction:P}=A;if(k.offsets[m])return k.offsets[m];const z=c.add(r);if(m+P<f||m+P>=_)return k.offsets[m]=z,z;const L=Lo(m+P,A),G=ds(L.sub(c),E,P),ee=c.add(G),K=L.add(G);return k.offsets[m]=l.findLineIntersection(x,z,ee,K)||z,k.offsets[m]}function F(m,r,c,f,_,x,E,A,k,P,z,L,G,ee){const K=f?m-r:m+r;let J=K>0?1:-1,se=0;f&&(J*=-1,se=Math.PI),J<0&&(se+=Math.PI);let ge,Me,re=J>0?A+E:A+E+1,Pe=_,Fe=_,Qe=0,ot=0;const ht=Math.abs(K),it=[];let St;for(;Qe+ot<=ht;){if(re+=J,re<A||re>=k)return null;Qe+=ot,Fe=Pe,Me=ge;const gt={projectionCache:L,lineVertexArray:P,labelPlaneMatrix:z,tileAnchorPoint:x,distanceFromAnchor:Qe,getElevation:ee,previousVertex:Fe,direction:J,absOffsetX:ht};if(Pe=Lo(re,gt),c===0)it.push(Fe),St=Pe.sub(Fe);else{let Wt;const Et=Pe.sub(Fe);Wt=Et.mag()===0?ds(Lo(re+J,gt).sub(Pe),c,J):ds(Et,c,J),Me||(Me=Fe.add(Wt)),ge=ne(re,Wt,Pe,A,k,Me,c,gt),it.push(Me),St=ge.sub(Me)}ot=St.mag()}const Ut=St._mult((ht-Qe)/ot)._add(Me||Fe),Qt=se+Math.atan2(Pe.y-Fe.y,Pe.x-Fe.x);return it.push(Ut),{point:Ut,angle:G?Qt:0,path:it}}const $=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function X(m,r){for(let c=0;c<m;c++){const f=r.length;r.resize(f+4),r.float32.set($,3*f)}}function ae(m,r,c){const f=r[0],_=r[1];return m[0]=c[0]*f+c[4]*_+c[12],m[1]=c[1]*f+c[5]*_+c[13],m[3]=c[3]*f+c[7]*_+c[15],m}const de=100;class be{constructor(r,c=new jt(r.width+200,r.height+200,25),f=new jt(r.width+200,r.height+200,25)){this.transform=r,this.grid=c,this.ignoredGrid=f,this.pitchfactor=Math.cos(r._pitch)*r.cameraToCenterDistance,this.screenRightBoundary=r.width+de,this.screenBottomBoundary=r.height+de,this.gridRightBoundary=r.width+200,this.gridBottomBoundary=r.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(r,c,f,_,x,E){const A=this.projectAndGetPerspectiveRatio(_,r.anchorPointX,r.anchorPointY,E),k=f*A.perspectiveRatio,P=r.x1*k+A.point.x,z=r.y1*k+A.point.y,L=r.x2*k+A.point.x,G=r.y2*k+A.point.y;return!this.isInsideGrid(P,z,L,G)||c!=="always"&&this.grid.hitTest(P,z,L,G,c,x)||A.perspectiveRatio<this.perspectiveRatioCutoff?{box:[],offscreen:!1}:{box:[P,z,L,G],offscreen:this.isOffscreen(P,z,L,G)}}placeCollisionCircles(r,c,f,_,x,E,A,k,P,z,L,G,ee,K){const J=[],se=new l.Point(c.anchorX,c.anchorY),ge=fn(se,E,K),Me=Ot(this.transform.cameraToCenterDistance,ge.signedDistanceFromCamera),re=(z?x/Me:x*Me)/l.ONE_EM,Pe=fn(se,A,K).point,Fe=Kr(re,_,c.lineOffsetX*re,c.lineOffsetY*re,!1,Pe,se,c,f,A,{projections:{},offsets:{}},!1,K);let Qe=!1,ot=!1,ht=!0;if(Fe){const it=.5*G*Me+ee,St=new l.Point(-100,-100),Ut=new l.Point(this.screenRightBoundary,this.screenBottomBoundary),Qt=new zn,gt=Fe.first,Wt=Fe.last;let Et=[];for(let bn=gt.path.length-1;bn>=1;bn--)Et.push(gt.path[bn]);for(let bn=1;bn<Wt.path.length;bn++)Et.push(Wt.path[bn]);const xn=2.5*it;if(k){const bn=Et.map(nn=>fn(nn,k,K));Et=bn.some(nn=>nn.signedDistanceFromCamera<=0)?[]:bn.map(nn=>nn.point)}let di=[];if(Et.length>0){const bn=Et[0].clone(),nn=Et[0].clone();for(let ai=1;ai<Et.length;ai++)bn.x=Math.min(bn.x,Et[ai].x),bn.y=Math.min(bn.y,Et[ai].y),nn.x=Math.max(nn.x,Et[ai].x),nn.y=Math.max(nn.y,Et[ai].y);di=bn.x>=St.x&&nn.x<=Ut.x&&bn.y>=St.y&&nn.y<=Ut.y?[Et]:nn.x<St.x||bn.x>Ut.x||nn.y<St.y||bn.y>Ut.y?[]:l.clipLine([Et],St.x,St.y,Ut.x,Ut.y)}for(const bn of di){Qt.reset(bn,.25*it);let nn=0;nn=Qt.length<=.5*it?1:Math.ceil(Qt.paddedLength/xn)+1;for(let ai=0;ai<nn;ai++){const er=ai/Math.max(nn-1,1),fi=Qt.lerp(er),Pi=fi.x+de,wr=fi.y+de;J.push(Pi,wr,it,0);const Qr=Pi-it,es=wr-it,tr=Pi+it,vs=wr+it;if(ht=ht&&this.isOffscreen(Qr,es,tr,vs),ot=ot||this.isInsideGrid(Qr,es,tr,vs),r!=="always"&&this.grid.hitTestCircle(Pi,wr,it,r,L)&&(Qe=!0,!P))return{circles:[],offscreen:!1,collisionDetected:Qe}}}}return{circles:!P&&Qe||!ot||Me<this.perspectiveRatioCutoff?[]:J,offscreen:ht,collisionDetected:Qe}}queryRenderedSymbols(r){if(r.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const c=[];let f=1/0,_=1/0,x=-1/0,E=-1/0;for(const z of r){const L=new l.Point(z.x+de,z.y+de);f=Math.min(f,L.x),_=Math.min(_,L.y),x=Math.max(x,L.x),E=Math.max(E,L.y),c.push(L)}const A=this.grid.query(f,_,x,E).concat(this.ignoredGrid.query(f,_,x,E)),k={},P={};for(const z of A){const L=z.key;if(k[L.bucketInstanceId]===void 0&&(k[L.bucketInstanceId]={}),k[L.bucketInstanceId][L.featureIndex])continue;const G=[new l.Point(z.x1,z.y1),new l.Point(z.x2,z.y1),new l.Point(z.x2,z.y2),new l.Point(z.x1,z.y2)];l.polygonIntersectsPolygon(c,G)&&(k[L.bucketInstanceId][L.featureIndex]=!0,P[L.bucketInstanceId]===void 0&&(P[L.bucketInstanceId]=[]),P[L.bucketInstanceId].push(L.featureIndex))}return P}insertCollisionBox(r,c,f,_,x,E){(f?this.ignoredGrid:this.grid).insert({bucketInstanceId:_,featureIndex:x,collisionGroupID:E,overlapMode:c},r[0],r[1],r[2],r[3])}insertCollisionCircles(r,c,f,_,x,E){const A=f?this.ignoredGrid:this.grid,k={bucketInstanceId:_,featureIndex:x,collisionGroupID:E,overlapMode:c};for(let P=0;P<r.length;P+=4)A.insertCircle(k,r[P],r[P+1],r[P+2])}projectAndGetPerspectiveRatio(r,c,f,_){let x;return _?(x=[c,f,_(c,f),1],l.transformMat4(x,x,r)):(x=[c,f,0,1],ae(x,x,r)),{point:new l.Point((x[0]/x[3]+1)/2*this.transform.width+de,(-x[1]/x[3]+1)/2*this.transform.height+de),perspectiveRatio:.5+this.transform.cameraToCenterDistance/x[3]*.5}}isOffscreen(r,c,f,_){return f<de||r>=this.screenRightBoundary||_<de||c>this.screenBottomBoundary}isInsideGrid(r,c,f,_){return f>=0&&r<this.gridRightBoundary&&_>=0&&c<this.gridBottomBoundary}getViewportMatrix(){const r=l.identity([]);return l.translate(r,r,[-100,-100,0]),r}}function me(m,r,c){return r*(l.EXTENT/(m.tileSize*Math.pow(2,c-m.tileID.overscaledZ)))}class fe{constructor(r,c,f,_){this.opacity=r?Math.max(0,Math.min(1,r.opacity+(r.placed?c:-c))):_&&f?1:0,this.placed=f}isHidden(){return this.opacity===0&&!this.placed}}class Te{constructor(r,c,f,_,x){this.text=new fe(r?r.text:null,c,f,x),this.icon=new fe(r?r.icon:null,c,_,x)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class Xe{constructor(r,c,f){this.text=r,this.icon=c,this.skipFade=f}}class Je{constructor(){this.invProjMatrix=l.create(),this.viewportMatrix=l.create(),this.circles=[]}}class Ke{constructor(r,c,f,_,x){this.bucketInstanceId=r,this.featureIndex=c,this.sourceLayerIndex=f,this.bucketIndex=_,this.tileID=x}}class Gt{constructor(r){this.crossSourceCollisions=r,this.maxGroupID=0,this.collisionGroups={}}get(r){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[r]){const c=++this.maxGroupID;this.collisionGroups[r]={ID:c,predicate:f=>f.collisionGroupID===c}}return this.collisionGroups[r]}}function Jt(m,r,c,f,_){const{horizontalAlign:x,verticalAlign:E}=l.getAnchorAlignment(m),A=-(x-.5)*r,k=-(E-.5)*c,P=l.evaluateVariableOffset(m,f);return new l.Point(A+P[0]*_,k+P[1]*_)}function Pt(m,r,c,f,_,x){const{x1:E,x2:A,y1:k,y2:P,anchorPointX:z,anchorPointY:L}=m,G=new l.Point(r,c);return f&&G._rotate(_?x:-x),{x1:E+G.x,y1:k+G.y,x2:A+G.x,y2:P+G.y,anchorPointX:z,anchorPointY:L}}class Nt{constructor(r,c,f,_,x){this.transform=r.clone(),this.terrain=c,this.collisionIndex=new be(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=f,this.retainedQueryData={},this.collisionGroups=new Gt(_),this.collisionCircleArrays={},this.prevPlacement=x,x&&(x.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(r,c,f,_){const x=f.getBucket(c),E=f.latestFeatureIndex;if(!x||!E||c.id!==x.layerIds[0])return;const A=f.collisionBoxArray,k=x.layers[0].layout,P=Math.pow(2,this.transform.zoom-f.tileID.overscaledZ),z=f.tileSize/l.EXTENT,L=this.transform.calculatePosMatrix(f.tileID.toUnwrapped()),G=k.get("text-pitch-alignment")==="map",ee=k.get("text-rotation-alignment")==="map",K=me(f,1,this.transform.zoom),J=qt(L,G,ee,this.transform,K);let se=null;if(G){const Me=Dn(L,G,ee,this.transform,K);se=l.multiply([],this.transform.labelPlaneMatrix,Me)}this.retainedQueryData[x.bucketInstanceId]=new Ke(x.bucketInstanceId,E,x.sourceLayerIndex,x.index,f.tileID);const ge={bucket:x,layout:k,posMatrix:L,textLabelPlaneMatrix:J,labelToScreenMatrix:se,scale:P,textPixelRatio:z,holdingForFade:f.holdingForFade(),collisionBoxArray:A,partiallyEvaluatedTextSize:l.evaluateSizeForZoom(x.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(x.sourceID)};if(_)for(const Me of x.sortKeyRanges){const{sortKey:re,symbolInstanceStart:Pe,symbolInstanceEnd:Fe}=Me;r.push({sortKey:re,symbolInstanceStart:Pe,symbolInstanceEnd:Fe,parameters:ge})}else r.push({symbolInstanceStart:0,symbolInstanceEnd:x.symbolInstances.length,parameters:ge})}attemptAnchorPlacement(r,c,f,_,x,E,A,k,P,z,L,G,ee,K,J,se){const ge=[G.textOffset0,G.textOffset1],Me=Jt(r,f,_,ge,x),re=this.collisionIndex.placeCollisionBox(Pt(c,Me.x,Me.y,E,A,this.transform.angle),L,k,P,z.predicate,se);if((!J||this.collisionIndex.placeCollisionBox(Pt(J,Me.x,Me.y,E,A,this.transform.angle),L,k,P,z.predicate,se).box.length!==0)&&re.box.length>0){let Pe;if(this.prevPlacement&&this.prevPlacement.variableOffsets[G.crossTileID]&&this.prevPlacement.placements[G.crossTileID]&&this.prevPlacement.placements[G.crossTileID].text&&(Pe=this.prevPlacement.variableOffsets[G.crossTileID].anchor),G.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[G.crossTileID]={textOffset:ge,width:f,height:_,anchor:r,textBoxScale:x,prevAnchor:Pe},this.markUsedJustification(ee,r,G,K),ee.allowVerticalPlacement&&(this.markUsedOrientation(ee,K,G),this.placedOrientations[G.crossTileID]=K),{shift:Me,placedGlyphBoxes:re}}}placeLayerBucketPart(r,c,f){const{bucket:_,layout:x,posMatrix:E,textLabelPlaneMatrix:A,labelToScreenMatrix:k,textPixelRatio:P,holdingForFade:z,collisionBoxArray:L,partiallyEvaluatedTextSize:G,collisionGroup:ee}=r.parameters,K=x.get("text-optional"),J=x.get("icon-optional"),se=l.getOverlapMode(x,"text-overlap","text-allow-overlap"),ge=se==="always",Me=l.getOverlapMode(x,"icon-overlap","icon-allow-overlap"),re=Me==="always",Pe=x.get("text-rotation-alignment")==="map",Fe=x.get("text-pitch-alignment")==="map",Qe=x.get("icon-text-fit")!=="none",ot=x.get("symbol-z-order")==="viewport-y",ht=ge&&(re||!_.hasIconData()||J),it=re&&(ge||!_.hasTextData()||K);!_.collisionArrays&&L&&_.deserializeCollisionBoxes(L);const St=this.retainedQueryData[_.bucketInstanceId].tileID,Ut=this.terrain?(gt,Wt)=>this.terrain.getElevation(St,gt,Wt):null,Qt=(gt,Wt)=>{if(c[gt.crossTileID])return;if(z)return void(this.placements[gt.crossTileID]=new Xe(!1,!1,!1));let Et=!1,xn=!1,di=!0,bn=null,nn={box:null,offscreen:null},ai={box:null,offscreen:null},er=null,fi=null,Pi=null,wr=0,Qr=0,es=0;Wt.textFeatureIndex?wr=Wt.textFeatureIndex:gt.useRuntimeCollisionCircles&&(wr=gt.featureIndex),Wt.verticalTextFeatureIndex&&(Qr=Wt.verticalTextFeatureIndex);const tr=Wt.textBox;if(tr){const Gi=Cn=>{let Ti=l.WritingMode.horizontal;if(_.allowVerticalPlacement&&!Cn&&this.prevPlacement){const Mi=this.prevPlacement.placedOrientations[gt.crossTileID];Mi&&(this.placedOrientations[gt.crossTileID]=Mi,Ti=Mi,this.markUsedOrientation(_,Ti,gt))}return Ti},Ri=(Cn,Ti)=>{if(_.allowVerticalPlacement&&gt.numVerticalGlyphVertices>0&&Wt.verticalTextBox){for(const Mi of _.writingModes)if(Mi===l.WritingMode.vertical?(nn=Ti(),ai=nn):nn=Cn(),nn&&nn.box&&nn.box.length)break}else nn=Cn()};if(x.get("text-variable-anchor")){let Cn=x.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[gt.crossTileID]){const kn=this.prevPlacement.variableOffsets[gt.crossTileID];Cn.indexOf(kn.anchor)>0&&(Cn=Cn.filter(Ci=>Ci!==kn.anchor),Cn.unshift(kn.anchor))}const Ti=(kn,Ci,Sr)=>{const cc=kn.x2-kn.x1,Ds=kn.y2-kn.y1,Qm=gt.textBoxScale,uf=Qe&&Me==="never"?Ci:null;let Gn={box:[],offscreen:!1};const Ku=se!=="never"?2*Cn.length:Cn.length;for(let Qo=0;Qo<Ku;++Qo){const Ls=this.attemptAnchorPlacement(Cn[Qo%Cn.length],kn,cc,Ds,Qm,Pe,Fe,P,E,ee,Qo>=Cn.length?se:"never",gt,_,Sr,uf,Ut);if(Ls&&(Gn=Ls.placedGlyphBoxes,Gn&&Gn.box&&Gn.box.length)){Et=!0,bn=Ls.shift;break}}return Gn};Ri(()=>Ti(tr,Wt.iconBox,l.WritingMode.horizontal),()=>{const kn=Wt.verticalTextBox;return _.allowVerticalPlacement&&!(nn&&nn.box&&nn.box.length)&&gt.numVerticalGlyphVertices>0&&kn?Ti(kn,Wt.verticalIconBox,l.WritingMode.vertical):{box:null,offscreen:null}}),nn&&(Et=nn.box,di=nn.offscreen);const Mi=Gi(nn&&nn.box);if(!Et&&this.prevPlacement){const kn=this.prevPlacement.variableOffsets[gt.crossTileID];kn&&(this.variableOffsets[gt.crossTileID]=kn,this.markUsedJustification(_,kn.anchor,gt,Mi))}}else{const Cn=(Ti,Mi)=>{const kn=this.collisionIndex.placeCollisionBox(Ti,se,P,E,ee.predicate,Ut);return kn&&kn.box&&kn.box.length&&(this.markUsedOrientation(_,Mi,gt),this.placedOrientations[gt.crossTileID]=Mi),kn};Ri(()=>Cn(tr,l.WritingMode.horizontal),()=>{const Ti=Wt.verticalTextBox;return _.allowVerticalPlacement&&gt.numVerticalGlyphVertices>0&&Ti?Cn(Ti,l.WritingMode.vertical):{box:null,offscreen:null}}),Gi(nn&&nn.box&&nn.box.length)}}if(er=nn,Et=er&&er.box&&er.box.length>0,di=er&&er.offscreen,gt.useRuntimeCollisionCircles){const Gi=_.text.placedSymbolArray.get(gt.centerJustifiedTextSymbolIndex),Ri=l.evaluateSizeForFeature(_.textSizeData,G,Gi),Cn=x.get("text-padding");fi=this.collisionIndex.placeCollisionCircles(se,Gi,_.lineVertexArray,_.glyphOffsetArray,Ri,E,A,k,f,Fe,ee.predicate,gt.collisionCircleDiameter,Cn,Ut),fi.circles.length&&fi.collisionDetected&&!f&&l.warnOnce("Collisions detected, but collision boxes are not shown"),Et=ge||fi.circles.length>0&&!fi.collisionDetected,di=di&&fi.offscreen}if(Wt.iconFeatureIndex&&(es=Wt.iconFeatureIndex),Wt.iconBox){const Gi=Ri=>{const Cn=Qe&&bn?Pt(Ri,bn.x,bn.y,Pe,Fe,this.transform.angle):Ri;return this.collisionIndex.placeCollisionBox(Cn,Me,P,E,ee.predicate,Ut)};ai&&ai.box&&ai.box.length&&Wt.verticalIconBox?(Pi=Gi(Wt.verticalIconBox),xn=Pi.box.length>0):(Pi=Gi(Wt.iconBox),xn=Pi.box.length>0),di=di&&Pi.offscreen}const vs=K||gt.numHorizontalGlyphVertices===0&&gt.numVerticalGlyphVertices===0,Jo=J||gt.numIconVertices===0;if(vs||Jo?Jo?vs||(xn=xn&&Et):Et=xn&&Et:xn=Et=xn&&Et,Et&&er&&er.box&&this.collisionIndex.insertCollisionBox(er.box,se,x.get("text-ignore-placement"),_.bucketInstanceId,ai&&ai.box&&Qr?Qr:wr,ee.ID),xn&&Pi&&this.collisionIndex.insertCollisionBox(Pi.box,Me,x.get("icon-ignore-placement"),_.bucketInstanceId,es,ee.ID),fi&&(Et&&this.collisionIndex.insertCollisionCircles(fi.circles,se,x.get("text-ignore-placement"),_.bucketInstanceId,wr,ee.ID),f)){const Gi=_.bucketInstanceId;let Ri=this.collisionCircleArrays[Gi];Ri===void 0&&(Ri=this.collisionCircleArrays[Gi]=new Je);for(let Cn=0;Cn<fi.circles.length;Cn+=4)Ri.circles.push(fi.circles[Cn+0]),Ri.circles.push(fi.circles[Cn+1]),Ri.circles.push(fi.circles[Cn+2]),Ri.circles.push(fi.collisionDetected?1:0)}if(gt.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");if(_.bucketInstanceId===0)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[gt.crossTileID]=new Xe(Et||ht,xn||it,di||_.justReloaded),c[gt.crossTileID]=!0};if(ot){if(r.symbolInstanceStart!==0)throw new Error("bucket.bucketInstanceId should be 0");const gt=_.getSortedSymbolIndexes(this.transform.angle);for(let Wt=gt.length-1;Wt>=0;--Wt){const Et=gt[Wt];Qt(_.symbolInstances.get(Et),_.collisionArrays[Et])}}else for(let gt=r.symbolInstanceStart;gt<r.symbolInstanceEnd;gt++)Qt(_.symbolInstances.get(gt),_.collisionArrays[gt]);if(f&&_.bucketInstanceId in this.collisionCircleArrays){const gt=this.collisionCircleArrays[_.bucketInstanceId];l.invert(gt.invProjMatrix,E),gt.viewportMatrix=this.collisionIndex.getViewportMatrix()}_.justReloaded=!1}markUsedJustification(r,c,f,_){let x;x=_===l.WritingMode.vertical?f.verticalPlacedTextSymbolIndex:{left:f.leftJustifiedTextSymbolIndex,center:f.centerJustifiedTextSymbolIndex,right:f.rightJustifiedTextSymbolIndex}[l.getAnchorJustification(c)];const E=[f.leftJustifiedTextSymbolIndex,f.centerJustifiedTextSymbolIndex,f.rightJustifiedTextSymbolIndex,f.verticalPlacedTextSymbolIndex];for(const A of E)A>=0&&(r.text.placedSymbolArray.get(A).crossTileID=x>=0&&A!==x?0:f.crossTileID)}markUsedOrientation(r,c,f){const _=c===l.WritingMode.horizontal||c===l.WritingMode.horizontalOnly?c:0,x=c===l.WritingMode.vertical?c:0,E=[f.leftJustifiedTextSymbolIndex,f.centerJustifiedTextSymbolIndex,f.rightJustifiedTextSymbolIndex];for(const A of E)r.text.placedSymbolArray.get(A).placedOrientation=_;f.verticalPlacedTextSymbolIndex&&(r.text.placedSymbolArray.get(f.verticalPlacedTextSymbolIndex).placedOrientation=x)}commit(r){this.commitTime=r,this.zoomAtLastRecencyCheck=this.transform.zoom;const c=this.prevPlacement;let f=!1;this.prevZoomAdjustment=c?c.zoomAdjustment(this.transform.zoom):0;const _=c?c.symbolFadeChange(r):1,x=c?c.opacities:{},E=c?c.variableOffsets:{},A=c?c.placedOrientations:{};for(const k in this.placements){const P=this.placements[k],z=x[k];z?(this.opacities[k]=new Te(z,_,P.text,P.icon),f=f||P.text!==z.text.placed||P.icon!==z.icon.placed):(this.opacities[k]=new Te(null,_,P.text,P.icon,P.skipFade),f=f||P.text||P.icon)}for(const k in x){const P=x[k];if(!this.opacities[k]){const z=new Te(P,_,!1,!1);z.isHidden()||(this.opacities[k]=z,f=f||P.text.placed||P.icon.placed)}}for(const k in E)this.variableOffsets[k]||!this.opacities[k]||this.opacities[k].isHidden()||(this.variableOffsets[k]=E[k]);for(const k in A)this.placedOrientations[k]||!this.opacities[k]||this.opacities[k].isHidden()||(this.placedOrientations[k]=A[k]);if(c&&c.lastPlacementChangeTime===void 0)throw new Error("Last placement time for previous placement is not defined");f?this.lastPlacementChangeTime=r:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=c?c.lastPlacementChangeTime:r)}updateLayerOpacities(r,c){const f={};for(const _ of c){const x=_.getBucket(r);x&&_.latestFeatureIndex&&r.id===x.layerIds[0]&&this.updateBucketOpacities(x,f,_.collisionBoxArray)}}updateBucketOpacities(r,c,f){r.hasTextData()&&(r.text.opacityVertexArray.clear(),r.text.hasVisibleVertices=!1),r.hasIconData()&&(r.icon.opacityVertexArray.clear(),r.icon.hasVisibleVertices=!1),r.hasIconCollisionBoxData()&&r.iconCollisionBox.collisionVertexArray.clear(),r.hasTextCollisionBoxData()&&r.textCollisionBox.collisionVertexArray.clear();const _=r.layers[0].layout,x=new Te(null,0,!1,!1,!0),E=_.get("text-allow-overlap"),A=_.get("icon-allow-overlap"),k=_.get("text-variable-anchor"),P=_.get("text-rotation-alignment")==="map",z=_.get("text-pitch-alignment")==="map",L=_.get("icon-text-fit")!=="none",G=new Te(null,0,E&&(A||!r.hasIconData()||_.get("icon-optional")),A&&(E||!r.hasTextData()||_.get("text-optional")),!0);!r.collisionArrays&&f&&(r.hasIconCollisionBoxData()||r.hasTextCollisionBoxData())&&r.deserializeCollisionBoxes(f);const ee=(K,J,se)=>{for(let ge=0;ge<J/4;ge++)K.opacityVertexArray.emplaceBack(se);K.hasVisibleVertices=K.hasVisibleVertices||se!==Bi};for(let K=0;K<r.symbolInstances.length;K++){const J=r.symbolInstances.get(K),{numHorizontalGlyphVertices:se,numVerticalGlyphVertices:ge,crossTileID:Me}=J;let re=this.opacities[Me];c[Me]?re=x:re||(re=G,this.opacities[Me]=re),c[Me]=!0;const Pe=J.numIconVertices>0,Fe=this.placedOrientations[J.crossTileID],Qe=Fe===l.WritingMode.vertical,ot=Fe===l.WritingMode.horizontal||Fe===l.WritingMode.horizontalOnly;if(se>0||ge>0){const ht=Zs(re.text);ee(r.text,se,Qe?Bi:ht),ee(r.text,ge,ot?Bi:ht);const it=re.text.isHidden();[J.rightJustifiedTextSymbolIndex,J.centerJustifiedTextSymbolIndex,J.leftJustifiedTextSymbolIndex].forEach(Qt=>{Qt>=0&&(r.text.placedSymbolArray.get(Qt).hidden=it||Qe?1:0)}),J.verticalPlacedTextSymbolIndex>=0&&(r.text.placedSymbolArray.get(J.verticalPlacedTextSymbolIndex).hidden=it||ot?1:0);const St=this.variableOffsets[J.crossTileID];St&&this.markUsedJustification(r,St.anchor,J,Fe);const Ut=this.placedOrientations[J.crossTileID];Ut&&(this.markUsedJustification(r,"left",J,Ut),this.markUsedOrientation(r,Ut,J))}if(Pe){const ht=Zs(re.icon),it=!(L&&J.verticalPlacedIconSymbolIndex&&Qe);J.placedIconSymbolIndex>=0&&(ee(r.icon,J.numIconVertices,it?ht:Bi),r.icon.placedSymbolArray.get(J.placedIconSymbolIndex).hidden=re.icon.isHidden()),J.verticalPlacedIconSymbolIndex>=0&&(ee(r.icon,J.numVerticalIconVertices,it?Bi:ht),r.icon.placedSymbolArray.get(J.verticalPlacedIconSymbolIndex).hidden=re.icon.isHidden())}if(r.hasIconCollisionBoxData()||r.hasTextCollisionBoxData()){const ht=r.collisionArrays[K];if(ht){let it=new l.Point(0,0);if(ht.textBox||ht.verticalTextBox){let Ut=!0;if(k){const Qt=this.variableOffsets[Me];Qt?(it=Jt(Qt.anchor,Qt.width,Qt.height,Qt.textOffset,Qt.textBoxScale),P&&it._rotate(z?this.transform.angle:-this.transform.angle)):Ut=!1}ht.textBox&&Xt(r.textCollisionBox.collisionVertexArray,re.text.placed,!Ut||Qe,it.x,it.y),ht.verticalTextBox&&Xt(r.textCollisionBox.collisionVertexArray,re.text.placed,!Ut||ot,it.x,it.y)}const St=!!(!ot&&ht.verticalIconBox);ht.iconBox&&Xt(r.iconCollisionBox.collisionVertexArray,re.icon.placed,St,L?it.x:0,L?it.y:0),ht.verticalIconBox&&Xt(r.iconCollisionBox.collisionVertexArray,re.icon.placed,!St,L?it.x:0,L?it.y:0)}}}if(r.sortFeatures(this.transform.angle),this.retainedQueryData[r.bucketInstanceId]&&(this.retainedQueryData[r.bucketInstanceId].featureSortOrder=r.featureSortOrder),r.hasTextData()&&r.text.opacityVertexBuffer&&r.text.opacityVertexBuffer.updateData(r.text.opacityVertexArray),r.hasIconData()&&r.icon.opacityVertexBuffer&&r.icon.opacityVertexBuffer.updateData(r.icon.opacityVertexArray),r.hasIconCollisionBoxData()&&r.iconCollisionBox.collisionVertexBuffer&&r.iconCollisionBox.collisionVertexBuffer.updateData(r.iconCollisionBox.collisionVertexArray),r.hasTextCollisionBoxData()&&r.textCollisionBox.collisionVertexBuffer&&r.textCollisionBox.collisionVertexBuffer.updateData(r.textCollisionBox.collisionVertexArray),r.text.opacityVertexArray.length!==r.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${r.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${r.text.layoutVertexArray.length}) / 4`);if(r.icon.opacityVertexArray.length!==r.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${r.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${r.icon.layoutVertexArray.length}) / 4`);if(r.bucketInstanceId in this.collisionCircleArrays){const K=this.collisionCircleArrays[r.bucketInstanceId];r.placementInvProjMatrix=K.invProjMatrix,r.placementViewportMatrix=K.viewportMatrix,r.collisionCircleArray=K.circles,delete this.collisionCircleArrays[r.bucketInstanceId]}}symbolFadeChange(r){return this.fadeDuration===0?1:(r-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(r){return Math.max(0,(this.transform.zoom-r)/1.5)}hasTransitions(r){return this.stale||r-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(r,c){const f=this.zoomAtLastRecencyCheck===c?1-this.zoomAdjustment(c):1;return this.zoomAtLastRecencyCheck=c,this.commitTime+this.fadeDuration*f>r}setStale(){this.stale=!0}}function Xt(m,r,c,f,_){m.emplaceBack(r?1:0,c?1:0,f||0,_||0),m.emplaceBack(r?1:0,c?1:0,f||0,_||0),m.emplaceBack(r?1:0,c?1:0,f||0,_||0),m.emplaceBack(r?1:0,c?1:0,f||0,_||0)}const hn=Math.pow(2,25),rn=Math.pow(2,24),yn=Math.pow(2,17),Bn=Math.pow(2,16),gi=Math.pow(2,9),Yt=Math.pow(2,8),ii=Math.pow(2,1);function Zs(m){if(m.opacity===0&&!m.placed)return 0;if(m.opacity===1&&m.placed)return 4294967295;const r=m.placed?1:0,c=Math.floor(127*m.opacity);return c*hn+r*rn+c*yn+r*Bn+c*gi+r*Yt+c*ii+r}const Bi=0;class vr{constructor(r){this._sortAcrossTiles=r.layout.get("symbol-z-order")!=="viewport-y"&&!r.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(r,c,f,_,x){const E=this._bucketParts;for(;this._currentTileIndex<r.length;)if(c.getBucketParts(E,_,r[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,x())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,E.sort((A,k)=>A.sortKey-k.sortKey));this._currentPartIndex<E.length;)if(c.placeLayerBucketPart(E[this._currentPartIndex],this._seenCrossTileIDs,f),this._currentPartIndex++,x())return!0;return!1}}class Nr{constructor(r,c,f,_,x,E,A,k){this.placement=new Nt(r,c,E,A,k),this._currentPlacementIndex=f.length-1,this._forceFullPlacement=_,this._showCollisionBoxes=x,this._done=!1}isDone(){return this._done}continuePlacement(r,c,f){const _=l.exported.now(),x=()=>!this._forceFullPlacement&&l.exported.now()-_>2;for(;this._currentPlacementIndex>=0;){const E=c[r[this._currentPlacementIndex]],A=this.placement.collisionIndex.transform.zoom;if(E.type==="symbol"&&(!E.minzoom||E.minzoom<=A)&&(!E.maxzoom||E.maxzoom>A)){if(this._inProgressLayer||(this._inProgressLayer=new vr(E)),this._inProgressLayer.continuePlacement(f[E.source],this.placement,this._showCollisionBoxes,E,x))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(r){return this.placement.commit(r),this.placement}}const ja=512/l.EXTENT/2;class Tl{constructor(r,c,f){this.tileID=r,this.bucketInstanceId=f,this._symbolsByKey={};const _=new Map;for(let x=0;x<c.length;x++){const E=c.get(x),A=E.key,k=_.get(A);k?k.push(E):_.set(A,[E])}for(const[x,E]of _){const A={positions:E.map(k=>({x:Math.floor(k.anchorX*ja),y:Math.floor(k.anchorY*ja)})),crossTileIDs:E.map(k=>k.crossTileID)};if(A.positions.length>128){const k=new l.KDBush(A.positions.length,16,Uint16Array);for(const{x:P,y:z}of A.positions)k.add(P,z);k.finish(),delete A.positions,A.index=k}this._symbolsByKey[x]=A}}getScaledCoordinates(r,c){const{x:f,y:_,z:x}=this.tileID.canonical,{x:E,y:A,z:k}=c.canonical,P=ja/Math.pow(2,k-x),z=(A*l.EXTENT+r.anchorY)*P,L=_*l.EXTENT*ja;return{x:Math.floor((E*l.EXTENT+r.anchorX)*P-f*l.EXTENT*ja),y:Math.floor(z-L)}}findMatches(r,c,f){const _=this.tileID.canonical.z<c.canonical.z?1:Math.pow(2,this.tileID.canonical.z-c.canonical.z);for(let x=0;x<r.length;x++){const E=r.get(x);if(E.crossTileID)continue;const A=this._symbolsByKey[E.key];if(!A)continue;const k=this.getScaledCoordinates(E,c);if(A.index){const P=A.index.range(k.x-_,k.y-_,k.x+_,k.y+_).sort();for(const z of P){const L=A.crossTileIDs[z];if(!f[L]){f[L]=!0,E.crossTileID=L;break}}}else if(A.positions)for(let P=0;P<A.positions.length;P++){const z=A.positions[P],L=A.crossTileIDs[P];if(Math.abs(z.x-k.x)<=_&&Math.abs(z.y-k.y)<=_&&!f[L]){f[L]=!0,E.crossTileID=L;break}}}}getCrossTileIDsLists(){return Object.values(this._symbolsByKey).map(({crossTileIDs:r})=>r)}}class _i{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class zo{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(r){const c=Math.round((r-this.lng)/360);if(c!==0)for(const f in this.indexes){const _=this.indexes[f],x={};for(const E in _){const A=_[E];A.tileID=A.tileID.unwrapTo(A.tileID.wrap+c),x[A.tileID.key]=A}this.indexes[f]=x}this.lng=r}addBucket(r,c,f){if(this.indexes[r.overscaledZ]&&this.indexes[r.overscaledZ][r.key]){if(this.indexes[r.overscaledZ][r.key].bucketInstanceId===c.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(r.overscaledZ,this.indexes[r.overscaledZ][r.key])}for(let x=0;x<c.symbolInstances.length;x++)c.symbolInstances.get(x).crossTileID=0;this.usedCrossTileIDs[r.overscaledZ]||(this.usedCrossTileIDs[r.overscaledZ]={});const _=this.usedCrossTileIDs[r.overscaledZ];for(const x in this.indexes){const E=this.indexes[x];if(Number(x)>r.overscaledZ)for(const A in E){const k=E[A];k.tileID.isChildOf(r)&&k.findMatches(c.symbolInstances,r,_)}else{const A=E[r.scaledTo(Number(x)).key];A&&A.findMatches(c.symbolInstances,r,_)}}for(let x=0;x<c.symbolInstances.length;x++){const E=c.symbolInstances.get(x);E.crossTileID||(E.crossTileID=f.generate(),_[E.crossTileID]=!0)}return this.indexes[r.overscaledZ]===void 0&&(this.indexes[r.overscaledZ]={}),this.indexes[r.overscaledZ][r.key]=new Tl(r,c.symbolInstances,c.bucketInstanceId),!0}removeBucketCrossTileIDs(r,c){for(const f of c.getCrossTileIDsLists())for(const _ of f)delete this.usedCrossTileIDs[r][_]}removeStaleBuckets(r){let c=!1;for(const f in this.indexes){const _=this.indexes[f];for(const x in _)r[_[x].bucketInstanceId]||(this.removeBucketCrossTileIDs(f,_[x]),delete _[x],c=!0)}return c}}class Ys{constructor(){this.layerIndexes={},this.crossTileIDs=new _i,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(r,c,f){let _=this.layerIndexes[r.id];_===void 0&&(_=this.layerIndexes[r.id]=new zo);let x=!1;const E={};_.handleWrapJump(f);for(const A of c){const k=A.getBucket(r);k&&r.id===k.layerIds[0]&&(k.bucketInstanceId||(k.bucketInstanceId=++this.maxBucketInstanceId),_.addBucket(A.tileID,k,this.crossTileIDs)&&(x=!0),E[k.bucketInstanceId]=!0)}return _.removeStaleBuckets(E)&&(x=!0),x}pruneUnusedLayers(r){const c={};r.forEach(f=>{c[f]=!0});for(const f in this.layerIndexes)c[f]||delete this.layerIndexes[f]}}const ui=(m,r)=>l.emitValidationErrors(m,r&&r.filter(c=>c.identifier!=="source.canvas")),Cl=l.pick(l.operations,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setGlyphs","setSprite"]),Jr=l.pick(l.operations,["setCenter","setZoom","setBearing","setPitch"]),Id=l.emptyStyle();class Fi extends l.Evented{constructor(r,c={}){super(),this.map=r,this.dispatcher=new It(dn(),this,r._getMapId()),this.imageManager=new oe,this.imageManager.setEventedParent(this),this.glyphManager=new Ve(r._requestManager,c.localIdeographFontFamily),this.lineAtlas=new rt(256,512),this.crossTileSymbolIndex=new Ys,this._spritesImagesIds={},this._layers={},this._order=[],this.sourceCaches={},this.zoomHistory=new l.ZoomHistory,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("setReferrer",l.getReferrer());const f=this;this._rtlTextPluginCallback=Fi.registerForPluginStateChange(_=>{f.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:_.pluginStatus,pluginURL:_.pluginURL},(x,E)=>{if(l.triggerPluginCompletionEvent(x),E&&E.every(A=>A))for(const A in f.sourceCaches){const k=f.sourceCaches[A].getSource().type;k!=="vector"&&k!=="geojson"||f.sourceCaches[A].reload()}})}),this.on("data",_=>{if(_.dataType!=="source"||_.sourceDataType!=="metadata")return;const x=this.sourceCaches[_.sourceId];if(!x)return;const E=x.getSource();if(E&&E.vectorLayerIds)for(const A in this._layers){const k=this._layers[A];k.source===E.id&&this._validateLayer(k)}})}loadURL(r,c={},f){this.fire(new l.Event("dataloading",{dataType:"style"})),c.validate=typeof c.validate!="boolean"||c.validate;const _=this.map._requestManager.transformRequest(r,ce.Style);this._request=l.getJSON(_,(x,E)=>{this._request=null,x?this.fire(new l.ErrorEvent(x)):E&&this._load(E,c,f)})}loadJSON(r,c={},f){this.fire(new l.Event("dataloading",{dataType:"style"})),this._request=l.exported.frame(()=>{this._request=null,c.validate=c.validate!==!1,this._load(r,c,f)})}loadEmpty(){this.fire(new l.Event("dataloading",{dataType:"style"})),this._load(Id,{validate:!1})}_load(r,c,f){const _=c.transformStyle?c.transformStyle(f,r):r;if(!c.validate||!ui(this,l.validateStyle(_))){this._loaded=!0,this.stylesheet=_;for(const x in _.sources)this.addSource(x,_.sources[x],{validate:!1});_.sprite?this._loadSprite(_.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(_.glyphs),this._createLayers(),this.light=new Ct(this.stylesheet.light),this.map.setTerrain(this.stylesheet.terrain),this.fire(new l.Event("data",{dataType:"style"})),this.fire(new l.Event("style.load"))}}_createLayers(){const r=l.derefLayers(this.stylesheet.layers);this.dispatcher.broadcast("setLayers",r),this._order=r.map(c=>c.id),this._layers={},this._serializedLayers=null;for(const c of r){const f=l.createStyleLayer(c);f.setEventedParent(this,{layer:{id:c.id}}),this._layers[c.id]=f}}_loadSprite(r,c=!1,f=void 0){this.imageManager.setLoaded(!1),this._spriteRequest=function(_,x,E,A){const k=H(_),P=k.length,z=E>1?"@2x":"",L={},G={},ee={};for(const{id:K,url:J}of k){const se=x.transformRequest(x.normalizeSpriteURL(J,z,".json"),ce.SpriteJSON),ge=`${K}_${se.url}`;L[ge]=l.getJSON(se,(Pe,Fe)=>{delete L[ge],G[K]=Fe,he(A,G,ee,Pe,P)});const Me=x.transformRequest(x.normalizeSpriteURL(J,z,".png"),ce.SpriteImage),re=`${K}_${Me.url}`;L[re]=ve.getImage(Me,(Pe,Fe)=>{delete L[re],ee[K]=Fe,he(A,G,ee,Pe,P)})}return{cancel(){for(const K of Object.values(L))K.cancel()}}}(r,this.map._requestManager,this.map.getPixelRatio(),(_,x)=>{if(this._spriteRequest=null,_)this.fire(new l.ErrorEvent(_));else if(x)for(const E in x){this._spritesImagesIds[E]=[];const A=this._spritesImagesIds[E]?this._spritesImagesIds[E].filter(k=>!(k in x)):[];for(const k of A)this.imageManager.removeImage(k),this._changedImages[k]=!0;for(const k in x[E]){const P=E==="default"?k:`${E}:${k}`;this._spritesImagesIds[E].push(P),P in this.imageManager.images?this.imageManager.updateImage(P,x[E][k],!1):this.imageManager.addImage(P,x[E][k]),c&&(this._changedImages[P]=!0)}}this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),c&&(this._changed=!0),this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new l.Event("data",{dataType:"style"})),f&&f(_)})}_unloadSprite(){for(const r of Object.values(this._spritesImagesIds).flat())this.imageManager.removeImage(r),this._changedImages[r]=!0;this._spritesImagesIds={},this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new l.Event("data",{dataType:"style"}))}_validateLayer(r){const c=this.sourceCaches[r.source];if(!c)return;const f=r.sourceLayer;if(!f)return;const _=c.getSource();(_.type==="geojson"||_.vectorLayerIds&&_.vectorLayerIds.indexOf(f)===-1)&&this.fire(new l.ErrorEvent(new Error(`Source layer "${f}" does not exist on source "${_.id}" as specified by style layer "${r.id}".`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const r in this.sourceCaches)if(!this.sourceCaches[r].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeByIds(r){const c=this._serializedAllLayers();if(!r||r.length===0)return Object.values(c);const f=[];for(const _ of r)c[_]&&f.push(c[_]);return f}_serializedAllLayers(){let r=this._serializedLayers;if(r)return r;r=this._serializedLayers={};const c=Object.keys(this._layers);for(const f of c){const _=this._layers[f];_.type!=="custom"&&(r[f]=_.serialize())}return r}hasTransitions(){if(this.light&&this.light.hasTransition())return!0;for(const r in this.sourceCaches)if(this.sourceCaches[r].hasTransition())return!0;for(const r in this._layers)if(this._layers[r].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(r){if(!this._loaded)return;const c=this._changed;if(this._changed){const _=Object.keys(this._updatedLayers),x=Object.keys(this._removedLayers);(_.length||x.length)&&this._updateWorkerLayers(_,x);for(const E in this._updatedSources){const A=this._updatedSources[E];if(A==="reload")this._reloadSource(E);else{if(A!=="clear")throw new Error(`Invalid action ${A}`);this._clearSource(E)}}this._updateTilesForChangedImages(),this._updateTilesForChangedGlyphs();for(const E in this._updatedPaintProps)this._layers[E].updateTransitions(r);this.light.updateTransitions(r),this._resetUpdates()}const f={};for(const _ in this.sourceCaches){const x=this.sourceCaches[_];f[_]=x.used,x.used=!1}for(const _ of this._order){const x=this._layers[_];x.recalculate(r,this._availableImages),!x.isHidden(r.zoom)&&x.source&&(this.sourceCaches[x.source].used=!0)}for(const _ in f){const x=this.sourceCaches[_];f[_]!==x.used&&x.fire(new l.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:_}))}this.light.recalculate(r),this.z=r.zoom,c&&this.fire(new l.Event("data",{dataType:"style"}))}_updateTilesForChangedImages(){const r=Object.keys(this._changedImages);if(r.length){for(const c in this.sourceCaches)this.sourceCaches[c].reloadTilesForDependencies(["icons","patterns"],r);this._changedImages={}}}_updateTilesForChangedGlyphs(){if(this._glyphsDidChange){for(const r in this.sourceCaches)this.sourceCaches[r].reloadTilesForDependencies(["glyphs"],[""]);this._glyphsDidChange=!1}}_updateWorkerLayers(r,c){this.dispatcher.broadcast("updateLayers",{layers:this._serializeByIds(r),removedIds:c})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={},this._glyphsDidChange=!1}setState(r,c={}){this._checkLoaded();const f=this.serialize();if(r=c.transformStyle?c.transformStyle(f,r):r,ui(this,l.validateStyle(r)))return!1;(r=l.clone$1(r)).layers=l.derefLayers(r.layers);const _=l.diffStyles(f,r).filter(E=>!(E.command in Jr));if(_.length===0)return!1;const x=_.filter(E=>!(E.command in Cl));if(x.length>0)throw new Error(`Unimplemented: ${x.map(E=>E.command).join(", ")}.`);for(const E of _)E.command!=="setTransition"&&this[E.command].apply(this,E.args);return this.stylesheet=r,!0}addImage(r,c){if(this.getImage(r))return this.fire(new l.ErrorEvent(new Error(`An image named "${r}" already exists.`)));this.imageManager.addImage(r,c),this._afterImageUpdated(r)}updateImage(r,c){this.imageManager.updateImage(r,c)}getImage(r){return this.imageManager.getImage(r)}removeImage(r){if(!this.getImage(r))return this.fire(new l.ErrorEvent(new Error(`An image named "${r}" does not exist.`)));this.imageManager.removeImage(r),this._afterImageUpdated(r)}_afterImageUpdated(r){this._availableImages=this.imageManager.listImages(),this._changedImages[r]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new l.Event("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(r,c,f={}){if(this._checkLoaded(),this.sourceCaches[r]!==void 0)throw new Error(`Source "${r}" already exists.`);if(!c.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(c).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(c.type)>=0&&this._validate(l.validateStyle.source,`sources.${r}`,c,null,f))return;this.map&&this.map._collectResourceTiming&&(c.collectResourceTiming=!0);const _=this.sourceCaches[r]=new ut(r,c,this.dispatcher);_.style=this,_.setEventedParent(this,()=>({isSourceLoaded:_.loaded(),source:_.serialize(),sourceId:r})),_.onAdd(this.map),this._changed=!0}removeSource(r){if(this._checkLoaded(),this.sourceCaches[r]===void 0)throw new Error("There is no source with this ID");for(const f in this._layers)if(this._layers[f].source===r)return this.fire(new l.ErrorEvent(new Error(`Source "${r}" cannot be removed while layer "${f}" is using it.`)));const c=this.sourceCaches[r];delete this.sourceCaches[r],delete this._updatedSources[r],c.fire(new l.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:r})),c.setEventedParent(null),c.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(r,c){if(this._checkLoaded(),this.sourceCaches[r]===void 0)throw new Error(`There is no source with this ID=${r}`);const f=this.sourceCaches[r].getSource();if(f.type!=="geojson")throw new Error(`geojsonSource.type is ${f.type}, which is !== 'geojson`);f.setData(c),this._changed=!0}getSource(r){return this.sourceCaches[r]&&this.sourceCaches[r].getSource()}addLayer(r,c,f={}){this._checkLoaded();const _=r.id;if(this.getLayer(_))return void this.fire(new l.ErrorEvent(new Error(`Layer "${_}" already exists on this map.`)));let x;if(r.type==="custom"){if(ui(this,l.validateCustomStyleLayer(r)))return;x=l.createStyleLayer(r)}else{if(typeof r.source=="object"&&(this.addSource(_,r.source),r=l.clone$1(r),r=l.extend(r,{source:_})),this._validate(l.validateStyle.layer,`layers.${_}`,r,{arrayIndex:-1},f))return;x=l.createStyleLayer(r),this._validateLayer(x),x.setEventedParent(this,{layer:{id:_}})}const E=c?this._order.indexOf(c):this._order.length;if(c&&E===-1)this.fire(new l.ErrorEvent(new Error(`Cannot add layer "${_}" before non-existing layer "${c}".`)));else{if(this._order.splice(E,0,_),this._layerOrderChanged=!0,this._layers[_]=x,this._removedLayers[_]&&x.source&&x.type!=="custom"){const A=this._removedLayers[_];delete this._removedLayers[_],A.type!==x.type?this._updatedSources[x.source]="clear":(this._updatedSources[x.source]="reload",this.sourceCaches[x.source].pause())}this._updateLayer(x),x.onAdd&&x.onAdd(this.map)}}moveLayer(r,c){if(this._checkLoaded(),this._changed=!0,!this._layers[r])return void this.fire(new l.ErrorEvent(new Error(`The layer '${r}' does not exist in the map's style and cannot be moved.`)));if(r===c)return;const f=this._order.indexOf(r);this._order.splice(f,1);const _=c?this._order.indexOf(c):this._order.length;c&&_===-1?this.fire(new l.ErrorEvent(new Error(`Cannot move layer "${r}" before non-existing layer "${c}".`))):(this._order.splice(_,0,r),this._layerOrderChanged=!0)}removeLayer(r){this._checkLoaded();const c=this._layers[r];if(!c)return void this.fire(new l.ErrorEvent(new Error(`Cannot remove non-existing layer "${r}".`)));c.setEventedParent(null);const f=this._order.indexOf(r);this._order.splice(f,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[r]=c,delete this._layers[r],this._serializedLayers&&delete this._serializedLayers[r],delete this._updatedLayers[r],delete this._updatedPaintProps[r],c.onRemove&&c.onRemove(this.map)}getLayer(r){return this._layers[r]}hasLayer(r){return r in this._layers}setLayerZoomRange(r,c,f){this._checkLoaded();const _=this.getLayer(r);_?_.minzoom===c&&_.maxzoom===f||(c!=null&&(_.minzoom=c),f!=null&&(_.maxzoom=f),this._updateLayer(_)):this.fire(new l.ErrorEvent(new Error(`Cannot set the zoom range of non-existing layer "${r}".`)))}setFilter(r,c,f={}){this._checkLoaded();const _=this.getLayer(r);if(_){if(!l.deepEqual(_.filter,c))return c==null?(_.filter=void 0,void this._updateLayer(_)):void(this._validate(l.validateStyle.filter,`layers.${_.id}.filter`,c,null,f)||(_.filter=l.clone$1(c),this._updateLayer(_)))}else this.fire(new l.ErrorEvent(new Error(`Cannot filter non-existing layer "${r}".`)))}getFilter(r){return l.clone$1(this.getLayer(r).filter)}setLayoutProperty(r,c,f,_={}){this._checkLoaded();const x=this.getLayer(r);x?l.deepEqual(x.getLayoutProperty(c),f)||(x.setLayoutProperty(c,f,_),this._updateLayer(x)):this.fire(new l.ErrorEvent(new Error(`Cannot style non-existing layer "${r}".`)))}getLayoutProperty(r,c){const f=this.getLayer(r);if(f)return f.getLayoutProperty(c);this.fire(new l.ErrorEvent(new Error(`Cannot get style of non-existing layer "${r}".`)))}setPaintProperty(r,c,f,_={}){this._checkLoaded();const x=this.getLayer(r);x?l.deepEqual(x.getPaintProperty(c),f)||(x.setPaintProperty(c,f,_)&&this._updateLayer(x),this._changed=!0,this._updatedPaintProps[r]=!0):this.fire(new l.ErrorEvent(new Error(`Cannot style non-existing layer "${r}".`)))}getPaintProperty(r,c){return this.getLayer(r).getPaintProperty(c)}setFeatureState(r,c){this._checkLoaded();const f=r.source,_=r.sourceLayer,x=this.sourceCaches[f];if(x===void 0)return void this.fire(new l.ErrorEvent(new Error(`The source '${f}' does not exist in the map's style.`)));const E=x.getSource().type;E==="geojson"&&_?this.fire(new l.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):E!=="vector"||_?(r.id===void 0&&this.fire(new l.ErrorEvent(new Error("The feature id parameter must be provided."))),x.setFeatureState(_,r.id,c)):this.fire(new l.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(r,c){this._checkLoaded();const f=r.source,_=this.sourceCaches[f];if(_===void 0)return void this.fire(new l.ErrorEvent(new Error(`The source '${f}' does not exist in the map's style.`)));const x=_.getSource().type,E=x==="vector"?r.sourceLayer:void 0;x!=="vector"||E?c&&typeof r.id!="string"&&typeof r.id!="number"?this.fire(new l.ErrorEvent(new Error("A feature id is required to remove its specific state property."))):_.removeFeatureState(E,r.id,c):this.fire(new l.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(r){this._checkLoaded();const c=r.source,f=r.sourceLayer,_=this.sourceCaches[c];if(_!==void 0)return _.getSource().type!=="vector"||f?(r.id===void 0&&this.fire(new l.ErrorEvent(new Error("The feature id parameter must be provided."))),_.getFeatureState(f,r.id)):void this.fire(new l.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new l.ErrorEvent(new Error(`The source '${c}' does not exist in the map's style.`)))}getTransition(){return l.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){const r=l.mapObject(this.sourceCaches,_=>_.serialize()),c=this._serializeByIds(this._order),f=this.stylesheet;return l.filterObject({version:f.version,name:f.name,metadata:f.metadata,light:f.light,center:f.center,zoom:f.zoom,bearing:f.bearing,pitch:f.pitch,sprite:f.sprite,glyphs:f.glyphs,transition:f.transition,sources:r,layers:c},_=>_!==void 0)}_updateLayer(r){this._updatedLayers[r.id]=!0,r.source&&!this._updatedSources[r.source]&&this.sourceCaches[r.source].getSource().type!=="raster"&&(this._updatedSources[r.source]="reload",this.sourceCaches[r.source].pause()),this._serializedLayers=null,this._changed=!0}_flattenAndSortRenderedFeatures(r){const c=E=>this._layers[E].type==="fill-extrusion",f={},_=[];for(let E=this._order.length-1;E>=0;E--){const A=this._order[E];if(c(A)){f[A]=E;for(const k of r){const P=k[A];if(P)for(const z of P)_.push(z)}}}_.sort((E,A)=>A.intersectionZ-E.intersectionZ);const x=[];for(let E=this._order.length-1;E>=0;E--){const A=this._order[E];if(c(A))for(let k=_.length-1;k>=0;k--){const P=_[k].feature;if(f[P.layer.id]<E)break;x.push(P),_.pop()}else for(const k of r){const P=k[A];if(P)for(const z of P)x.push(z.feature)}}return x}queryRenderedFeatures(r,c,f){c&&c.filter&&this._validate(l.validateStyle.filter,"queryRenderedFeatures.filter",c.filter,null,c);const _={};if(c&&c.layers){if(!Array.isArray(c.layers))return this.fire(new l.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(const A of c.layers){const k=this._layers[A];if(!k)return this.fire(new l.ErrorEvent(new Error(`The layer '${A}' does not exist in the map's style and cannot be queried for features.`))),[];_[k.source]=!0}}const x=[];c.availableImages=this._availableImages;const E=this._serializedAllLayers();for(const A in this.sourceCaches)c.layers&&!_[A]||x.push(Ne(this.sourceCaches[A],this._layers,E,r,c,f));return this.placement&&x.push(function(A,k,P,z,L,G,ee){const K={},J=G.queryRenderedSymbols(z),se=[];for(const ge of Object.keys(J).map(Number))se.push(ee[ge]);se.sort(Ze);for(const ge of se){const Me=ge.featureIndex.lookupSymbolFeatures(J[ge.bucketInstanceId],k,ge.bucketIndex,ge.sourceLayerIndex,L.filter,L.layers,L.availableImages,A);for(const re in Me){const Pe=K[re]=K[re]||[],Fe=Me[re];Fe.sort((Qe,ot)=>{const ht=ge.featureSortOrder;if(ht){const it=ht.indexOf(Qe.featureIndex);return ht.indexOf(ot.featureIndex)-it}return ot.featureIndex-Qe.featureIndex});for(const Qe of Fe)Pe.push(Qe)}}for(const ge in K)K[ge].forEach(Me=>{const re=Me.feature,Pe=P[A[ge].source].getFeatureState(re.layer["source-layer"],re.id);re.source=re.layer.source,re.layer["source-layer"]&&(re.sourceLayer=re.layer["source-layer"]),re.state=Pe});return K}(this._layers,E,this.sourceCaches,r,c,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(x)}querySourceFeatures(r,c){c&&c.filter&&this._validate(l.validateStyle.filter,"querySourceFeatures.filter",c.filter,null,c);const f=this.sourceCaches[r];return f?function(_,x){const E=_.getRenderableIds().map(P=>_.getTileByID(P)),A=[],k={};for(let P=0;P<E.length;P++){const z=E[P],L=z.tileID.canonical.key;k[L]||(k[L]=!0,z.querySourceFeatures(A,x))}return A}(f,c):[]}addSourceType(r,c,f){return Fi.getSourceType(r)?f(new Error(`A source type called "${r}" already exists.`)):(Fi.setSourceType(r,c),c.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:r,url:c.workerSourceURL},f):f(null,null))}getLight(){return this.light.getLight()}setLight(r,c={}){this._checkLoaded();const f=this.light.getLight();let _=!1;for(const E in r)if(!l.deepEqual(r[E],f[E])){_=!0;break}if(!_)return;const x={now:l.exported.now(),transition:l.extend({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(r,c),this.light.updateTransitions(x)}_validate(r,c,f,_,x={}){return(!x||x.validate!==!1)&&ui(this,r.call(l.validateStyle,l.extend({key:c,style:this.serialize(),value:f,styleSpec:l.v8Spec},_)))}_remove(r=!0){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),l.evented.off("pluginStateChange",this._rtlTextPluginCallback);for(const c in this._layers)this._layers[c].setEventedParent(null);for(const c in this.sourceCaches){const f=this.sourceCaches[c];f.setEventedParent(null),f.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove(r)}_clearSource(r){this.sourceCaches[r].clearTiles()}_reloadSource(r){this.sourceCaches[r].resume(),this.sourceCaches[r].reload()}_updateSources(r){for(const c in this.sourceCaches)this.sourceCaches[c].update(r,this.map.terrain)}_generateCollisionBoxes(){for(const r in this.sourceCaches)this._reloadSource(r)}_updatePlacement(r,c,f,_,x=!1){let E=!1,A=!1;const k={};for(const P of this._order){const z=this._layers[P];if(z.type!=="symbol")continue;if(!k[z.source]){const G=this.sourceCaches[z.source];k[z.source]=G.getRenderableIds(!0).map(ee=>G.getTileByID(ee)).sort((ee,K)=>K.tileID.overscaledZ-ee.tileID.overscaledZ||(ee.tileID.isLessThan(K.tileID)?-1:1))}const L=this.crossTileSymbolIndex.addLayer(z,k[z.source],r.center.lng);E=E||L}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((x=x||this._layerOrderChanged||f===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(l.exported.now(),r.zoom))&&(this.pauseablePlacement=new Nr(r,this.map.terrain,this._order,x,c,f,_,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,k),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(l.exported.now()),A=!0),E&&this.pauseablePlacement.placement.setStale()),A||E)for(const P of this._order){const z=this._layers[P];z.type==="symbol"&&this.placement.updateLayerOpacities(z,k[z.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(l.exported.now())}_releaseSymbolFadeTiles(){for(const r in this.sourceCaches)this.sourceCaches[r].releaseSymbolFadeTiles()}getImages(r,c,f){this.imageManager.getImages(c.icons,f),this._updateTilesForChangedImages();const _=this.sourceCaches[c.source];_&&_.setDependencies(c.tileID.key,c.type,c.icons)}getGlyphs(r,c,f){this.glyphManager.getGlyphs(c.stacks,f);const _=this.sourceCaches[c.source];_&&_.setDependencies(c.tileID.key,c.type,[""])}getResource(r,c,f){return l.makeRequest(c,f)}getGlyphsUrl(){return this.stylesheet.glyphs||null}setGlyphs(r,c={}){this._checkLoaded(),r&&this._validate(l.validateStyle.glyphs,"glyphs",r,null,c)||(this._glyphsDidChange=!0,this.stylesheet.glyphs=r,this.glyphManager.entries={},this.glyphManager.setURL(r))}addSprite(r,c,f={},_){this._checkLoaded();const x=[{id:r,url:c}],E=[...H(this.stylesheet.sprite),...x];this._validate(l.validateStyle.sprite,"sprite",E,null,f)||(this.stylesheet.sprite=E,this._loadSprite(x,!0,_))}removeSprite(r){this._checkLoaded();const c=H(this.stylesheet.sprite);if(c.find(f=>f.id===r)){if(this._spritesImagesIds[r])for(const f of this._spritesImagesIds[r])this.imageManager.removeImage(f),this._changedImages[f]=!0;c.splice(c.findIndex(f=>f.id===r),1),this.stylesheet.sprite=c.length>0?c:void 0,delete this._spritesImagesIds[r],this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new l.Event("data",{dataType:"style"}))}else this.fire(new l.ErrorEvent(new Error(`Sprite "${r}" doesn't exists on this map.`)))}getSprite(){return H(this.stylesheet.sprite)}setSprite(r,c={},f){this._checkLoaded(),r&&this._validate(l.validateStyle.sprite,"sprite",r,null,c)||(this.stylesheet.sprite=r,r?this._loadSprite(r,!0,f):(this._unloadSprite(),f&&f(null)))}}Fi.getSourceType=function(m){return De[m]},Fi.setSourceType=function(m,r){De[m]=r},Fi.registerForPluginStateChange=l.registerForPluginStateChange;var mu=l.createLayout([{name:"a_pos",type:"Int16",components:2}]),Il="attribute vec3 a_pos3d;uniform mat4 u_matrix;uniform float u_ele_delta;varying vec2 v_texture_pos;varying float v_depth;void main() {float extent=8192.0;float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/extent;gl_Position=u_matrix*vec4(a_pos3d.xy,get_elevation(a_pos3d.xy)-ele_delta,1.0);v_depth=gl_Position.z/gl_Position.w;}";const Xs={prelude:In(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}
#ifdef TERRAIN3D
uniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;
#endif
const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {
#ifdef TERRAIN3D
highp float d=unpack(texture2D(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));
#else
return 1.0;
#endif
}float calculate_visibility(vec4 pos) {
#ifdef TERRAIN3D
vec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;
#else
return 1.0;
#endif
}float ele(vec2 pos) {
#ifdef TERRAIN3D
vec4 rgb=(texture2D(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;
#else
return 0.0;
#endif
}float get_elevation(vec2 pos) {
#ifdef TERRAIN3D
vec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return elevation*u_terrain_exaggeration;
#else
return 0.0;
#endif
}`),background:In(`uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),backgroundPattern:In(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:In(`varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);float ele=get_elevation(circle_center);v_visibility=calculate_visibility(u_matrix*vec4(circle_center,ele,1.0));if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,ele,1);} else {gl_Position=u_matrix*vec4(circle_center,ele,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),clippingMask:In("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:In(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}`),heatmapTexture:In(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:In("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,get_elevation(a_pos),1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:In("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:In("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,get_elevation(a_pos),1);}"),fill:In(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_FragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);}`),fillOutline:In(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillOutlinePattern:In(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillPattern:In(`#ifdef GL_ES
precision highp float;
#endif
uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),fillExtrusion:In(`varying vec4 v_color;void main() {gl_FragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),fillExtrusionPattern:In(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),hillshadePrepare:In(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:In(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;
#define PI 3.141592653589793
void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),line:In(`uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),lineGradient:In(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),linePattern:In(`#ifdef GL_ES
precision highp float;
#endif
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),lineSDF:In(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),raster:In(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),symbolIcon:In(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0),z,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}`),symbolSDF:In(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset),z,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),symbolTextAndIcon:In(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),z,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`),terrain:In("uniform sampler2D u_texture;varying vec2 v_texture_pos;void main() {gl_FragColor=texture2D(u_texture,v_texture_pos);}",Il),terrainDepth:In("varying float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {gl_FragColor=pack(v_depth);}",Il),terrainCoords:In("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;varying vec2 v_texture_pos;void main() {vec4 rgba=texture2D(u_texture,v_texture_pos);gl_FragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}",Il)};function In(m,r){const c=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,f=r.match(/attribute ([\w]+) ([\w]+)/g),_=m.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),x=r.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),E=x?x.concat(_):_,A={};return{fragmentSource:m=m.replace(c,(k,P,z,L,G)=>(A[G]=!0,P==="define"?`
#ifndef HAS_UNIFORM_u_${G}
varying ${z} ${L} ${G};
#else
uniform ${z} ${L} u_${G};
#endif
`:`
#ifdef HAS_UNIFORM_u_${G}
    ${z} ${L} ${G} = u_${G};
#endif
`)),vertexSource:r=r.replace(c,(k,P,z,L,G)=>{const ee=L==="float"?"vec2":"vec4",K=G.match(/color/)?"color":ee;return A[G]?P==="define"?`
#ifndef HAS_UNIFORM_u_${G}
uniform lowp float u_${G}_t;
attribute ${z} ${ee} a_${G};
varying ${z} ${L} ${G};
#else
uniform ${z} ${L} u_${G};
#endif
`:K==="vec4"?`
#ifndef HAS_UNIFORM_u_${G}
    ${G} = a_${G};
#else
    ${z} ${L} ${G} = u_${G};
#endif
`:`
#ifndef HAS_UNIFORM_u_${G}
    ${G} = unpack_mix_${K}(a_${G}, u_${G}_t);
#else
    ${z} ${L} ${G} = u_${G};
#endif
`:P==="define"?`
#ifndef HAS_UNIFORM_u_${G}
uniform lowp float u_${G}_t;
attribute ${z} ${ee} a_${G};
#else
uniform ${z} ${L} u_${G};
#endif
`:K==="vec4"?`
#ifndef HAS_UNIFORM_u_${G}
    ${z} ${L} ${G} = a_${G};
#else
    ${z} ${L} ${G} = u_${G};
#endif
`:`
#ifndef HAS_UNIFORM_u_${G}
    ${z} ${L} ${G} = unpack_mix_${K}(a_${G}, u_${G}_t);
#else
    ${z} ${L} ${G} = u_${G};
#endif
`}),staticAttributes:f,staticUniforms:E}}class Ks{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(r,c,f,_,x,E,A,k,P){this.context=r;let z=this.boundPaintVertexBuffers.length!==_.length;for(let L=0;!z&&L<_.length;L++)this.boundPaintVertexBuffers[L]!==_[L]&&(z=!0);!this.vao||this.boundProgram!==c||this.boundLayoutVertexBuffer!==f||z||this.boundIndexBuffer!==x||this.boundVertexOffset!==E||this.boundDynamicVertexBuffer!==A||this.boundDynamicVertexBuffer2!==k||this.boundDynamicVertexBuffer3!==P?this.freshBind(c,f,_,x,E,A,k,P):(r.bindVertexArray.set(this.vao),A&&A.bind(),x&&x.dynamicDraw&&x.bind(),k&&k.bind(),P&&P.bind())}freshBind(r,c,f,_,x,E,A,k){const P=r.numAttributes,z=this.context,L=z.gl;this.vao&&this.destroy(),this.vao=z.createVertexArray(),z.bindVertexArray.set(this.vao),this.boundProgram=r,this.boundLayoutVertexBuffer=c,this.boundPaintVertexBuffers=f,this.boundIndexBuffer=_,this.boundVertexOffset=x,this.boundDynamicVertexBuffer=E,this.boundDynamicVertexBuffer2=A,this.boundDynamicVertexBuffer3=k,c.enableAttributes(L,r);for(const G of f)G.enableAttributes(L,r);E&&E.enableAttributes(L,r),A&&A.enableAttributes(L,r),k&&k.enableAttributes(L,r),c.bind(),c.setVertexAttribPointers(L,r,x);for(const G of f)G.bind(),G.setVertexAttribPointers(L,r,x);E&&(E.bind(),E.setVertexAttribPointers(L,r,x)),_&&_.bind(),A&&(A.bind(),A.setVertexAttribPointers(L,r,x)),k&&(k.bind(),k.setVertexAttribPointers(L,r,x)),z.currentNumAttributes=P}destroy(){this.vao&&(this.context.deleteVertexArray(this.vao),this.vao=null)}}function Oo(m){const r=[];for(let c=0;c<m.length;c++){if(m[c]===null)continue;const f=m[c].split(" ");r.push(f.pop())}return r}class kl{constructor(r,c,f,_,x,E,A){const k=r.gl;this.program=k.createProgram();const P=Oo(f.staticAttributes),z=_?_.getBinderAttributes():[],L=P.concat(z),G=Xs.prelude.staticUniforms?Oo(Xs.prelude.staticUniforms):[],ee=f.staticUniforms?Oo(f.staticUniforms):[],K=_?_.getBinderUniforms():[],J=G.concat(ee).concat(K),se=[];for(const ot of J)se.indexOf(ot)<0&&se.push(ot);const ge=_?_.defines():[];E&&ge.push("#define OVERDRAW_INSPECTOR;"),A&&ge.push("#define TERRAIN3D;");const Me=ge.concat(Xs.prelude.fragmentSource,f.fragmentSource).join(`
`),re=ge.concat(Xs.prelude.vertexSource,f.vertexSource).join(`
`),Pe=k.createShader(k.FRAGMENT_SHADER);if(k.isContextLost())return void(this.failedToCreate=!0);k.shaderSource(Pe,Me),k.compileShader(Pe),k.attachShader(this.program,Pe);const Fe=k.createShader(k.VERTEX_SHADER);if(k.isContextLost())return void(this.failedToCreate=!0);k.shaderSource(Fe,re),k.compileShader(Fe),k.attachShader(this.program,Fe),this.attributes={};const Qe={};this.numAttributes=L.length;for(let ot=0;ot<this.numAttributes;ot++)L[ot]&&(k.bindAttribLocation(this.program,ot,L[ot]),this.attributes[L[ot]]=ot);k.linkProgram(this.program),k.deleteShader(Fe),k.deleteShader(Pe);for(let ot=0;ot<se.length;ot++){const ht=se[ot];if(ht&&!Qe[ht]){const it=k.getUniformLocation(this.program,ht);it&&(Qe[ht]=it)}}this.fixedUniforms=x(r,Qe),this.terrainUniforms=((ot,ht)=>({u_depth:new l.Uniform1i(ot,ht.u_depth),u_terrain:new l.Uniform1i(ot,ht.u_terrain),u_terrain_dim:new l.Uniform1f(ot,ht.u_terrain_dim),u_terrain_matrix:new l.UniformMatrix4f(ot,ht.u_terrain_matrix),u_terrain_unpack:new l.Uniform4f(ot,ht.u_terrain_unpack),u_terrain_exaggeration:new l.Uniform1f(ot,ht.u_terrain_exaggeration)}))(r,Qe),this.binderUniforms=_?_.getUniforms(r,Qe):[]}draw(r,c,f,_,x,E,A,k,P,z,L,G,ee,K,J,se,ge,Me){const re=r.gl;if(this.failedToCreate)return;if(r.program.set(this.program),r.setDepthMode(f),r.setStencilMode(_),r.setColorMode(x),r.setCullFace(E),k){r.activeTexture.set(re.TEXTURE2),re.bindTexture(re.TEXTURE_2D,k.depthTexture),r.activeTexture.set(re.TEXTURE3),re.bindTexture(re.TEXTURE_2D,k.texture);for(const Fe in this.terrainUniforms)this.terrainUniforms[Fe].set(k[Fe])}for(const Fe in this.fixedUniforms)this.fixedUniforms[Fe].set(A[Fe]);J&&J.setUniforms(r,this.binderUniforms,ee,{zoom:K});let Pe=0;switch(c){case re.LINES:Pe=2;break;case re.TRIANGLES:Pe=3;break;case re.LINE_STRIP:Pe=1}for(const Fe of G.get()){const Qe=Fe.vaos||(Fe.vaos={});(Qe[P]||(Qe[P]=new Ks)).bind(r,this,z,J?J.getPaintVertexBuffers():[],L,Fe.vertexOffset,se,ge,Me),re.drawElements(c,Fe.primitiveLength*Pe,re.UNSIGNED_SHORT,Fe.primitiveOffset*Pe*2)}}}function kd(m,r,c){const f=1/me(c,1,r.transform.tileZoom),_=Math.pow(2,c.tileID.overscaledZ),x=c.tileSize*Math.pow(2,r.transform.tileZoom)/_,E=x*(c.tileID.canonical.x+c.tileID.wrap*_),A=x*c.tileID.canonical.y;return{u_image:0,u_texsize:c.imageAtlasTexture.size,u_scale:[f,m.fromScale,m.toScale],u_fade:m.t,u_pixel_coord_upper:[E>>16,A>>16],u_pixel_coord_lower:[65535&E,65535&A]}}const Ad=(m,r,c,f)=>{const _=r.style.light,x=_.properties.get("position"),E=[x.x,x.y,x.z],A=function(){var P=new l.ARRAY_TYPE(9);return l.ARRAY_TYPE!=Float32Array&&(P[1]=0,P[2]=0,P[3]=0,P[5]=0,P[6]=0,P[7]=0),P[0]=1,P[4]=1,P[8]=1,P}();_.properties.get("anchor")==="viewport"&&function(P,z){var L=Math.sin(z),G=Math.cos(z);P[0]=G,P[1]=L,P[2]=0,P[3]=-L,P[4]=G,P[5]=0,P[6]=0,P[7]=0,P[8]=1}(A,-r.transform.angle),function(P,z,L){var G=z[0],ee=z[1],K=z[2];P[0]=G*L[0]+ee*L[3]+K*L[6],P[1]=G*L[1]+ee*L[4]+K*L[7],P[2]=G*L[2]+ee*L[5]+K*L[8]}(E,E,A);const k=_.properties.get("color");return{u_matrix:m,u_lightpos:E,u_lightintensity:_.properties.get("intensity"),u_lightcolor:[k.r,k.g,k.b],u_vertical_gradient:+c,u_opacity:f}},gu=(m,r,c,f,_,x,E)=>l.extend(Ad(m,r,c,f),kd(x,r,E),{u_height_factor:-Math.pow(2,_.overscaledZ)/E.tileSize/8}),Pd=m=>({u_matrix:m}),_u=(m,r,c,f)=>l.extend(Pd(m),kd(c,r,f)),Om=(m,r)=>({u_matrix:m,u_world:r}),Rd=(m,r,c,f,_)=>l.extend(_u(m,r,c,f),{u_world:_}),Bm=(m,r,c,f)=>{const _=m.transform;let x,E;if(f.paint.get("circle-pitch-alignment")==="map"){const A=me(c,1,_.zoom);x=!0,E=[A,A]}else x=!1,E=_.pixelsToGLUnits;return{u_camera_to_center_distance:_.cameraToCenterDistance,u_scale_with_map:+(f.paint.get("circle-pitch-scale")==="map"),u_matrix:m.translatePosMatrix(r.posMatrix,c,f.paint.get("circle-translate"),f.paint.get("circle-translate-anchor")),u_pitch_with_map:+x,u_device_pixel_ratio:m.pixelRatio,u_extrude_scale:E}},yu=(m,r,c)=>{const f=me(c,1,r.zoom),_=Math.pow(2,r.zoom-c.tileID.overscaledZ),x=c.tileID.overscaleFactor();return{u_matrix:m,u_camera_to_center_distance:r.cameraToCenterDistance,u_pixels_to_tile_units:f,u_extrude_scale:[r.pixelsToGLUnits[0]/(f*_),r.pixelsToGLUnits[1]/(f*_)],u_overscale_factor:x}},vu=(m,r,c=1)=>({u_matrix:m,u_color:r,u_overlay:0,u_overlay_scale:c}),xu=m=>({u_matrix:m}),Md=(m,r,c,f)=>({u_matrix:m,u_extrude_scale:me(r,1,c),u_intensity:f});function Dd(m,r){const c=Math.pow(2,r.canonical.z),f=r.canonical.y;return[new l.MercatorCoordinate(0,f/c).toLngLat().lat,new l.MercatorCoordinate(0,(f+1)/c).toLngLat().lat]}const Ps=(m,r,c,f)=>{const _=m.transform;return{u_matrix:Ga(m,r,c,f),u_ratio:1/me(r,1,_.zoom),u_device_pixel_ratio:m.pixelRatio,u_units_to_pixels:[1/_.pixelsToGLUnits[0],1/_.pixelsToGLUnits[1]]}},Al=(m,r,c,f,_)=>l.extend(Ps(m,r,c,_),{u_image:0,u_image_height:f}),Ur=(m,r,c,f,_)=>{const x=m.transform,E=Bo(r,x);return{u_matrix:Ga(m,r,c,_),u_texsize:r.imageAtlasTexture.size,u_ratio:1/me(r,1,x.zoom),u_device_pixel_ratio:m.pixelRatio,u_image:0,u_scale:[E,f.fromScale,f.toScale],u_fade:f.t,u_units_to_pixels:[1/x.pixelsToGLUnits[0],1/x.pixelsToGLUnits[1]]}},Pl=(m,r,c,f,_,x)=>{const E=m.lineAtlas,A=Bo(r,m.transform),k=c.layout.get("line-cap")==="round",P=E.getDash(f.from,k),z=E.getDash(f.to,k),L=P.width*_.fromScale,G=z.width*_.toScale;return l.extend(Ps(m,r,c,x),{u_patternscale_a:[A/L,-P.height/2],u_patternscale_b:[A/G,-z.height/2],u_sdfgamma:E.width/(256*Math.min(L,G)*m.pixelRatio)/2,u_image:0,u_tex_y_a:P.y,u_tex_y_b:z.y,u_mix:_.t})};function Bo(m,r){return 1/me(m,1,r.tileZoom)}function Ga(m,r,c,f){return m.translatePosMatrix(f?f.posMatrix:r.tileID.posMatrix,r,c.paint.get("line-translate"),c.paint.get("line-translate-anchor"))}const Rl=(m,r,c,f,_)=>{return{u_matrix:m,u_tl_parent:r,u_scale_parent:c,u_buffer_scale:1,u_fade_t:f.mix,u_opacity:f.opacity*_.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:_.paint.get("raster-brightness-min"),u_brightness_high:_.paint.get("raster-brightness-max"),u_saturation_factor:(E=_.paint.get("raster-saturation"),E>0?1-1/(1.001-E):-E),u_contrast_factor:(x=_.paint.get("raster-contrast"),x>0?1/(1-x):1+x),u_spin_weights:Ml(_.paint.get("raster-hue-rotate"))};var x,E};function Ml(m){m*=Math.PI/180;const r=Math.sin(m),c=Math.cos(m);return[(2*c+1)/3,(-Math.sqrt(3)*r-c+1)/3,(Math.sqrt(3)*r-c+1)/3]}const qa=(m,r,c,f,_,x,E,A,k,P)=>{const z=_.transform;return{u_is_size_zoom_constant:+(m==="constant"||m==="source"),u_is_size_feature_constant:+(m==="constant"||m==="camera"),u_size_t:r?r.uSizeT:0,u_size:r?r.uSize:0,u_camera_to_center_distance:z.cameraToCenterDistance,u_pitch:z.pitch/360*2*Math.PI,u_rotate_symbol:+c,u_aspect_ratio:z.width/z.height,u_fade_change:_.options.fadeDuration?_.symbolFadeChange:1,u_matrix:x,u_label_plane_matrix:E,u_coord_matrix:A,u_is_text:+k,u_pitch_with_map:+f,u_texsize:P,u_texture:0}},Ha=(m,r,c,f,_,x,E,A,k,P,z)=>{const L=_.transform;return l.extend(qa(m,r,c,f,_,x,E,A,k,P),{u_gamma_scale:f?Math.cos(L._pitch)*L.cameraToCenterDistance:1,u_device_pixel_ratio:_.pixelRatio,u_is_halo:+z})},Dl=(m,r,c,f,_,x,E,A,k,P)=>l.extend(Ha(m,r,c,f,_,x,E,A,!0,k,!0),{u_texsize_icon:P,u_texture_icon:1}),xr=(m,r,c)=>({u_matrix:m,u_opacity:r,u_color:c}),br=(m,r,c,f,_,x)=>l.extend(function(E,A,k,P){const z=k.imageManager.getPattern(E.from.toString()),L=k.imageManager.getPattern(E.to.toString()),{width:G,height:ee}=k.imageManager.getPixelSize(),K=Math.pow(2,P.tileID.overscaledZ),J=P.tileSize*Math.pow(2,k.transform.tileZoom)/K,se=J*(P.tileID.canonical.x+P.tileID.wrap*K),ge=J*P.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:z.tl,u_pattern_br_a:z.br,u_pattern_tl_b:L.tl,u_pattern_br_b:L.br,u_texsize:[G,ee],u_mix:A.t,u_pattern_size_a:z.displaySize,u_pattern_size_b:L.displaySize,u_scale_a:A.fromScale,u_scale_b:A.toScale,u_tile_units_to_pixels:1/me(P,1,k.transform.tileZoom),u_pixel_coord_upper:[se>>16,ge>>16],u_pixel_coord_lower:[65535&se,65535&ge]}}(f,x,c,_),{u_matrix:m,u_opacity:r}),bu={fillExtrusion:(m,r)=>({u_matrix:new l.UniformMatrix4f(m,r.u_matrix),u_lightpos:new l.Uniform3f(m,r.u_lightpos),u_lightintensity:new l.Uniform1f(m,r.u_lightintensity),u_lightcolor:new l.Uniform3f(m,r.u_lightcolor),u_vertical_gradient:new l.Uniform1f(m,r.u_vertical_gradient),u_opacity:new l.Uniform1f(m,r.u_opacity)}),fillExtrusionPattern:(m,r)=>({u_matrix:new l.UniformMatrix4f(m,r.u_matrix),u_lightpos:new l.Uniform3f(m,r.u_lightpos),u_lightintensity:new l.Uniform1f(m,r.u_lightintensity),u_lightcolor:new l.Uniform3f(m,r.u_lightcolor),u_vertical_gradient:new l.Uniform1f(m,r.u_vertical_gradient),u_height_factor:new l.Uniform1f(m,r.u_height_factor),u_image:new l.Uniform1i(m,r.u_image),u_texsize:new l.Uniform2f(m,r.u_texsize),u_pixel_coord_upper:new l.Uniform2f(m,r.u_pixel_coord_upper),u_pixel_coord_lower:new l.Uniform2f(m,r.u_pixel_coord_lower),u_scale:new l.Uniform3f(m,r.u_scale),u_fade:new l.Uniform1f(m,r.u_fade),u_opacity:new l.Uniform1f(m,r.u_opacity)}),fill:(m,r)=>({u_matrix:new l.UniformMatrix4f(m,r.u_matrix)}),fillPattern:(m,r)=>({u_matrix:new l.UniformMatrix4f(m,r.u_matrix),u_image:new l.Uniform1i(m,r.u_image),u_texsize:new l.Uniform2f(m,r.u_texsize),u_pixel_coord_upper:new l.Uniform2f(m,r.u_pixel_coord_upper),u_pixel_coord_lower:new l.Uniform2f(m,r.u_pixel_coord_lower),u_scale:new l.Uniform3f(m,r.u_scale),u_fade:new l.Uniform1f(m,r.u_fade)}),fillOutline:(m,r)=>({u_matrix:new l.UniformMatrix4f(m,r.u_matrix),u_world:new l.Uniform2f(m,r.u_world)}),fillOutlinePattern:(m,r)=>({u_matrix:new l.UniformMatrix4f(m,r.u_matrix),u_world:new l.Uniform2f(m,r.u_world),u_image:new l.Uniform1i(m,r.u_image),u_texsize:new l.Uniform2f(m,r.u_texsize),u_pixel_coord_upper:new l.Uniform2f(m,r.u_pixel_coord_upper),u_pixel_coord_lower:new l.Uniform2f(m,r.u_pixel_coord_lower),u_scale:new l.Uniform3f(m,r.u_scale),u_fade:new l.Uniform1f(m,r.u_fade)}),circle:(m,r)=>({u_camera_to_center_distance:new l.Uniform1f(m,r.u_camera_to_center_distance),u_scale_with_map:new l.Uniform1i(m,r.u_scale_with_map),u_pitch_with_map:new l.Uniform1i(m,r.u_pitch_with_map),u_extrude_scale:new l.Uniform2f(m,r.u_extrude_scale),u_device_pixel_ratio:new l.Uniform1f(m,r.u_device_pixel_ratio),u_matrix:new l.UniformMatrix4f(m,r.u_matrix)}),collisionBox:(m,r)=>({u_matrix:new l.UniformMatrix4f(m,r.u_matrix),u_camera_to_center_distance:new l.Uniform1f(m,r.u_camera_to_center_distance),u_pixels_to_tile_units:new l.Uniform1f(m,r.u_pixels_to_tile_units),u_extrude_scale:new l.Uniform2f(m,r.u_extrude_scale),u_overscale_factor:new l.Uniform1f(m,r.u_overscale_factor)}),collisionCircle:(m,r)=>({u_matrix:new l.UniformMatrix4f(m,r.u_matrix),u_inv_matrix:new l.UniformMatrix4f(m,r.u_inv_matrix),u_camera_to_center_distance:new l.Uniform1f(m,r.u_camera_to_center_distance),u_viewport_size:new l.Uniform2f(m,r.u_viewport_size)}),debug:(m,r)=>({u_color:new l.UniformColor(m,r.u_color),u_matrix:new l.UniformMatrix4f(m,r.u_matrix),u_overlay:new l.Uniform1i(m,r.u_overlay),u_overlay_scale:new l.Uniform1f(m,r.u_overlay_scale)}),clippingMask:(m,r)=>({u_matrix:new l.UniformMatrix4f(m,r.u_matrix)}),heatmap:(m,r)=>({u_extrude_scale:new l.Uniform1f(m,r.u_extrude_scale),u_intensity:new l.Uniform1f(m,r.u_intensity),u_matrix:new l.UniformMatrix4f(m,r.u_matrix)}),heatmapTexture:(m,r)=>({u_matrix:new l.UniformMatrix4f(m,r.u_matrix),u_world:new l.Uniform2f(m,r.u_world),u_image:new l.Uniform1i(m,r.u_image),u_color_ramp:new l.Uniform1i(m,r.u_color_ramp),u_opacity:new l.Uniform1f(m,r.u_opacity)}),hillshade:(m,r)=>({u_matrix:new l.UniformMatrix4f(m,r.u_matrix),u_image:new l.Uniform1i(m,r.u_image),u_latrange:new l.Uniform2f(m,r.u_latrange),u_light:new l.Uniform2f(m,r.u_light),u_shadow:new l.UniformColor(m,r.u_shadow),u_highlight:new l.UniformColor(m,r.u_highlight),u_accent:new l.UniformColor(m,r.u_accent)}),hillshadePrepare:(m,r)=>({u_matrix:new l.UniformMatrix4f(m,r.u_matrix),u_image:new l.Uniform1i(m,r.u_image),u_dimension:new l.Uniform2f(m,r.u_dimension),u_zoom:new l.Uniform1f(m,r.u_zoom),u_unpack:new l.Uniform4f(m,r.u_unpack)}),line:(m,r)=>({u_matrix:new l.UniformMatrix4f(m,r.u_matrix),u_ratio:new l.Uniform1f(m,r.u_ratio),u_device_pixel_ratio:new l.Uniform1f(m,r.u_device_pixel_ratio),u_units_to_pixels:new l.Uniform2f(m,r.u_units_to_pixels)}),lineGradient:(m,r)=>({u_matrix:new l.UniformMatrix4f(m,r.u_matrix),u_ratio:new l.Uniform1f(m,r.u_ratio),u_device_pixel_ratio:new l.Uniform1f(m,r.u_device_pixel_ratio),u_units_to_pixels:new l.Uniform2f(m,r.u_units_to_pixels),u_image:new l.Uniform1i(m,r.u_image),u_image_height:new l.Uniform1f(m,r.u_image_height)}),linePattern:(m,r)=>({u_matrix:new l.UniformMatrix4f(m,r.u_matrix),u_texsize:new l.Uniform2f(m,r.u_texsize),u_ratio:new l.Uniform1f(m,r.u_ratio),u_device_pixel_ratio:new l.Uniform1f(m,r.u_device_pixel_ratio),u_image:new l.Uniform1i(m,r.u_image),u_units_to_pixels:new l.Uniform2f(m,r.u_units_to_pixels),u_scale:new l.Uniform3f(m,r.u_scale),u_fade:new l.Uniform1f(m,r.u_fade)}),lineSDF:(m,r)=>({u_matrix:new l.UniformMatrix4f(m,r.u_matrix),u_ratio:new l.Uniform1f(m,r.u_ratio),u_device_pixel_ratio:new l.Uniform1f(m,r.u_device_pixel_ratio),u_units_to_pixels:new l.Uniform2f(m,r.u_units_to_pixels),u_patternscale_a:new l.Uniform2f(m,r.u_patternscale_a),u_patternscale_b:new l.Uniform2f(m,r.u_patternscale_b),u_sdfgamma:new l.Uniform1f(m,r.u_sdfgamma),u_image:new l.Uniform1i(m,r.u_image),u_tex_y_a:new l.Uniform1f(m,r.u_tex_y_a),u_tex_y_b:new l.Uniform1f(m,r.u_tex_y_b),u_mix:new l.Uniform1f(m,r.u_mix)}),raster:(m,r)=>({u_matrix:new l.UniformMatrix4f(m,r.u_matrix),u_tl_parent:new l.Uniform2f(m,r.u_tl_parent),u_scale_parent:new l.Uniform1f(m,r.u_scale_parent),u_buffer_scale:new l.Uniform1f(m,r.u_buffer_scale),u_fade_t:new l.Uniform1f(m,r.u_fade_t),u_opacity:new l.Uniform1f(m,r.u_opacity),u_image0:new l.Uniform1i(m,r.u_image0),u_image1:new l.Uniform1i(m,r.u_image1),u_brightness_low:new l.Uniform1f(m,r.u_brightness_low),u_brightness_high:new l.Uniform1f(m,r.u_brightness_high),u_saturation_factor:new l.Uniform1f(m,r.u_saturation_factor),u_contrast_factor:new l.Uniform1f(m,r.u_contrast_factor),u_spin_weights:new l.Uniform3f(m,r.u_spin_weights)}),symbolIcon:(m,r)=>({u_is_size_zoom_constant:new l.Uniform1i(m,r.u_is_size_zoom_constant),u_is_size_feature_constant:new l.Uniform1i(m,r.u_is_size_feature_constant),u_size_t:new l.Uniform1f(m,r.u_size_t),u_size:new l.Uniform1f(m,r.u_size),u_camera_to_center_distance:new l.Uniform1f(m,r.u_camera_to_center_distance),u_pitch:new l.Uniform1f(m,r.u_pitch),u_rotate_symbol:new l.Uniform1i(m,r.u_rotate_symbol),u_aspect_ratio:new l.Uniform1f(m,r.u_aspect_ratio),u_fade_change:new l.Uniform1f(m,r.u_fade_change),u_matrix:new l.UniformMatrix4f(m,r.u_matrix),u_label_plane_matrix:new l.UniformMatrix4f(m,r.u_label_plane_matrix),u_coord_matrix:new l.UniformMatrix4f(m,r.u_coord_matrix),u_is_text:new l.Uniform1i(m,r.u_is_text),u_pitch_with_map:new l.Uniform1i(m,r.u_pitch_with_map),u_texsize:new l.Uniform2f(m,r.u_texsize),u_texture:new l.Uniform1i(m,r.u_texture)}),symbolSDF:(m,r)=>({u_is_size_zoom_constant:new l.Uniform1i(m,r.u_is_size_zoom_constant),u_is_size_feature_constant:new l.Uniform1i(m,r.u_is_size_feature_constant),u_size_t:new l.Uniform1f(m,r.u_size_t),u_size:new l.Uniform1f(m,r.u_size),u_camera_to_center_distance:new l.Uniform1f(m,r.u_camera_to_center_distance),u_pitch:new l.Uniform1f(m,r.u_pitch),u_rotate_symbol:new l.Uniform1i(m,r.u_rotate_symbol),u_aspect_ratio:new l.Uniform1f(m,r.u_aspect_ratio),u_fade_change:new l.Uniform1f(m,r.u_fade_change),u_matrix:new l.UniformMatrix4f(m,r.u_matrix),u_label_plane_matrix:new l.UniformMatrix4f(m,r.u_label_plane_matrix),u_coord_matrix:new l.UniformMatrix4f(m,r.u_coord_matrix),u_is_text:new l.Uniform1i(m,r.u_is_text),u_pitch_with_map:new l.Uniform1i(m,r.u_pitch_with_map),u_texsize:new l.Uniform2f(m,r.u_texsize),u_texture:new l.Uniform1i(m,r.u_texture),u_gamma_scale:new l.Uniform1f(m,r.u_gamma_scale),u_device_pixel_ratio:new l.Uniform1f(m,r.u_device_pixel_ratio),u_is_halo:new l.Uniform1i(m,r.u_is_halo)}),symbolTextAndIcon:(m,r)=>({u_is_size_zoom_constant:new l.Uniform1i(m,r.u_is_size_zoom_constant),u_is_size_feature_constant:new l.Uniform1i(m,r.u_is_size_feature_constant),u_size_t:new l.Uniform1f(m,r.u_size_t),u_size:new l.Uniform1f(m,r.u_size),u_camera_to_center_distance:new l.Uniform1f(m,r.u_camera_to_center_distance),u_pitch:new l.Uniform1f(m,r.u_pitch),u_rotate_symbol:new l.Uniform1i(m,r.u_rotate_symbol),u_aspect_ratio:new l.Uniform1f(m,r.u_aspect_ratio),u_fade_change:new l.Uniform1f(m,r.u_fade_change),u_matrix:new l.UniformMatrix4f(m,r.u_matrix),u_label_plane_matrix:new l.UniformMatrix4f(m,r.u_label_plane_matrix),u_coord_matrix:new l.UniformMatrix4f(m,r.u_coord_matrix),u_is_text:new l.Uniform1i(m,r.u_is_text),u_pitch_with_map:new l.Uniform1i(m,r.u_pitch_with_map),u_texsize:new l.Uniform2f(m,r.u_texsize),u_texsize_icon:new l.Uniform2f(m,r.u_texsize_icon),u_texture:new l.Uniform1i(m,r.u_texture),u_texture_icon:new l.Uniform1i(m,r.u_texture_icon),u_gamma_scale:new l.Uniform1f(m,r.u_gamma_scale),u_device_pixel_ratio:new l.Uniform1f(m,r.u_device_pixel_ratio),u_is_halo:new l.Uniform1i(m,r.u_is_halo)}),background:(m,r)=>({u_matrix:new l.UniformMatrix4f(m,r.u_matrix),u_opacity:new l.Uniform1f(m,r.u_opacity),u_color:new l.UniformColor(m,r.u_color)}),backgroundPattern:(m,r)=>({u_matrix:new l.UniformMatrix4f(m,r.u_matrix),u_opacity:new l.Uniform1f(m,r.u_opacity),u_image:new l.Uniform1i(m,r.u_image),u_pattern_tl_a:new l.Uniform2f(m,r.u_pattern_tl_a),u_pattern_br_a:new l.Uniform2f(m,r.u_pattern_br_a),u_pattern_tl_b:new l.Uniform2f(m,r.u_pattern_tl_b),u_pattern_br_b:new l.Uniform2f(m,r.u_pattern_br_b),u_texsize:new l.Uniform2f(m,r.u_texsize),u_mix:new l.Uniform1f(m,r.u_mix),u_pattern_size_a:new l.Uniform2f(m,r.u_pattern_size_a),u_pattern_size_b:new l.Uniform2f(m,r.u_pattern_size_b),u_scale_a:new l.Uniform1f(m,r.u_scale_a),u_scale_b:new l.Uniform1f(m,r.u_scale_b),u_pixel_coord_upper:new l.Uniform2f(m,r.u_pixel_coord_upper),u_pixel_coord_lower:new l.Uniform2f(m,r.u_pixel_coord_lower),u_tile_units_to_pixels:new l.Uniform1f(m,r.u_tile_units_to_pixels)}),terrain:(m,r)=>({u_matrix:new l.UniformMatrix4f(m,r.u_matrix),u_texture:new l.Uniform1i(m,r.u_texture),u_ele_delta:new l.Uniform1f(m,r.u_ele_delta)}),terrainDepth:(m,r)=>({u_matrix:new l.UniformMatrix4f(m,r.u_matrix),u_ele_delta:new l.Uniform1f(m,r.u_ele_delta)}),terrainCoords:(m,r)=>({u_matrix:new l.UniformMatrix4f(m,r.u_matrix),u_texture:new l.Uniform1i(m,r.u_texture),u_terrain_coords_id:new l.Uniform1f(m,r.u_terrain_coords_id),u_ele_delta:new l.Uniform1f(m,r.u_ele_delta)})};class Ll{constructor(r,c,f){this.context=r;const _=r.gl;this.buffer=_.createBuffer(),this.dynamicDraw=!!f,this.context.unbindVAO(),r.bindElementBuffer.set(this.buffer),_.bufferData(_.ELEMENT_ARRAY_BUFFER,c.arrayBuffer,this.dynamicDraw?_.DYNAMIC_DRAW:_.STATIC_DRAW),this.dynamicDraw||delete c.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(r){const c=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),c.bufferSubData(c.ELEMENT_ARRAY_BUFFER,0,r.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const zl={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class wu{constructor(r,c,f,_){this.length=c.length,this.attributes=f,this.itemSize=c.bytesPerElement,this.dynamicDraw=_,this.context=r;const x=r.gl;this.buffer=x.createBuffer(),r.bindVertexBuffer.set(this.buffer),x.bufferData(x.ARRAY_BUFFER,c.arrayBuffer,this.dynamicDraw?x.DYNAMIC_DRAW:x.STATIC_DRAW),this.dynamicDraw||delete c.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(r){if(r.length!==this.length)throw new Error(`Length of new data is ${r.length}, which doesn't match current length of ${this.length}`);const c=this.context.gl;this.bind(),c.bufferSubData(c.ARRAY_BUFFER,0,r.arrayBuffer)}enableAttributes(r,c){for(let f=0;f<this.attributes.length;f++){const _=c.attributes[this.attributes[f].name];_!==void 0&&r.enableVertexAttribArray(_)}}setVertexAttribPointers(r,c,f){for(let _=0;_<this.attributes.length;_++){const x=this.attributes[_],E=c.attributes[x.name];E!==void 0&&r.vertexAttribPointer(E,x.components,r[zl[x.type]],!1,this.itemSize,x.offset+this.itemSize*(f||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const Fo=new WeakMap;function ga(m){if(Fo.has(m))return Fo.get(m);{const r=m.getParameter(m.VERSION).startsWith("WebGL 2.0");return Fo.set(m,r),r}}class vn{constructor(r){this.gl=r.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(r){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class Su extends vn{getDefault(){return l.Color.transparent}set(r){const c=this.current;(r.r!==c.r||r.g!==c.g||r.b!==c.b||r.a!==c.a||this.dirty)&&(this.gl.clearColor(r.r,r.g,r.b,r.a),this.current=r,this.dirty=!1)}}class Ol extends vn{getDefault(){return 1}set(r){(r!==this.current||this.dirty)&&(this.gl.clearDepth(r),this.current=r,this.dirty=!1)}}class Ld extends vn{getDefault(){return 0}set(r){(r!==this.current||this.dirty)&&(this.gl.clearStencil(r),this.current=r,this.dirty=!1)}}class zd extends vn{getDefault(){return[!0,!0,!0,!0]}set(r){const c=this.current;(r[0]!==c[0]||r[1]!==c[1]||r[2]!==c[2]||r[3]!==c[3]||this.dirty)&&(this.gl.colorMask(r[0],r[1],r[2],r[3]),this.current=r,this.dirty=!1)}}class Wa extends vn{getDefault(){return!0}set(r){(r!==this.current||this.dirty)&&(this.gl.depthMask(r),this.current=r,this.dirty=!1)}}class Fm extends vn{getDefault(){return 255}set(r){(r!==this.current||this.dirty)&&(this.gl.stencilMask(r),this.current=r,this.dirty=!1)}}class Nm extends vn{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(r){const c=this.current;(r.func!==c.func||r.ref!==c.ref||r.mask!==c.mask||this.dirty)&&(this.gl.stencilFunc(r.func,r.ref,r.mask),this.current=r,this.dirty=!1)}}class Um extends vn{getDefault(){const r=this.gl;return[r.KEEP,r.KEEP,r.KEEP]}set(r){const c=this.current;(r[0]!==c[0]||r[1]!==c[1]||r[2]!==c[2]||this.dirty)&&(this.gl.stencilOp(r[0],r[1],r[2]),this.current=r,this.dirty=!1)}}class $m extends vn{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const c=this.gl;r?c.enable(c.STENCIL_TEST):c.disable(c.STENCIL_TEST),this.current=r,this.dirty=!1}}class Vm extends vn{getDefault(){return[0,1]}set(r){const c=this.current;(r[0]!==c[0]||r[1]!==c[1]||this.dirty)&&(this.gl.depthRange(r[0],r[1]),this.current=r,this.dirty=!1)}}class jm extends vn{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const c=this.gl;r?c.enable(c.DEPTH_TEST):c.disable(c.DEPTH_TEST),this.current=r,this.dirty=!1}}class Eu extends vn{getDefault(){return this.gl.LESS}set(r){(r!==this.current||this.dirty)&&(this.gl.depthFunc(r),this.current=r,this.dirty=!1)}}class Bl extends vn{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const c=this.gl;r?c.enable(c.BLEND):c.disable(c.BLEND),this.current=r,this.dirty=!1}}class Tu extends vn{getDefault(){const r=this.gl;return[r.ONE,r.ZERO]}set(r){const c=this.current;(r[0]!==c[0]||r[1]!==c[1]||this.dirty)&&(this.gl.blendFunc(r[0],r[1]),this.current=r,this.dirty=!1)}}class Cu extends vn{getDefault(){return l.Color.transparent}set(r){const c=this.current;(r.r!==c.r||r.g!==c.g||r.b!==c.b||r.a!==c.a||this.dirty)&&(this.gl.blendColor(r.r,r.g,r.b,r.a),this.current=r,this.dirty=!1)}}class Za extends vn{getDefault(){return this.gl.FUNC_ADD}set(r){(r!==this.current||this.dirty)&&(this.gl.blendEquation(r),this.current=r,this.dirty=!1)}}class Od extends vn{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const c=this.gl;r?c.enable(c.CULL_FACE):c.disable(c.CULL_FACE),this.current=r,this.dirty=!1}}class Bd extends vn{getDefault(){return this.gl.BACK}set(r){(r!==this.current||this.dirty)&&(this.gl.cullFace(r),this.current=r,this.dirty=!1)}}class Iu extends vn{getDefault(){return this.gl.CCW}set(r){(r!==this.current||this.dirty)&&(this.gl.frontFace(r),this.current=r,this.dirty=!1)}}class _a extends vn{getDefault(){return null}set(r){(r!==this.current||this.dirty)&&(this.gl.useProgram(r),this.current=r,this.dirty=!1)}}class Fd extends vn{getDefault(){return this.gl.TEXTURE0}set(r){(r!==this.current||this.dirty)&&(this.gl.activeTexture(r),this.current=r,this.dirty=!1)}}class Ya extends vn{getDefault(){const r=this.gl;return[0,0,r.drawingBufferWidth,r.drawingBufferHeight]}set(r){const c=this.current;(r[0]!==c[0]||r[1]!==c[1]||r[2]!==c[2]||r[3]!==c[3]||this.dirty)&&(this.gl.viewport(r[0],r[1],r[2],r[3]),this.current=r,this.dirty=!1)}}class Xa extends vn{getDefault(){return null}set(r){if(r===this.current&&!this.dirty)return;const c=this.gl;c.bindFramebuffer(c.FRAMEBUFFER,r),this.current=r,this.dirty=!1}}class Nd extends vn{getDefault(){return null}set(r){if(r===this.current&&!this.dirty)return;const c=this.gl;c.bindRenderbuffer(c.RENDERBUFFER,r),this.current=r,this.dirty=!1}}class ku extends vn{getDefault(){return null}set(r){if(r===this.current&&!this.dirty)return;const c=this.gl;c.bindTexture(c.TEXTURE_2D,r),this.current=r,this.dirty=!1}}class Rn extends vn{getDefault(){return null}set(r){if(r===this.current&&!this.dirty)return;const c=this.gl;c.bindBuffer(c.ARRAY_BUFFER,r),this.current=r,this.dirty=!1}}class Fl extends vn{getDefault(){return null}set(r){const c=this.gl;c.bindBuffer(c.ELEMENT_ARRAY_BUFFER,r),this.current=r,this.dirty=!1}}class Gm extends vn{getDefault(){return null}set(r){var c;if(r===this.current&&!this.dirty)return;const f=this.gl;ga(f)?f.bindVertexArray(r):(c=f.getExtension("OES_vertex_array_object"))===null||c===void 0||c.bindVertexArrayOES(r),this.current=r,this.dirty=!1}}class Ud extends vn{getDefault(){return 4}set(r){if(r===this.current&&!this.dirty)return;const c=this.gl;c.pixelStorei(c.UNPACK_ALIGNMENT,r),this.current=r,this.dirty=!1}}class No extends vn{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const c=this.gl;c.pixelStorei(c.UNPACK_PREMULTIPLY_ALPHA_WEBGL,r),this.current=r,this.dirty=!1}}class qm extends vn{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const c=this.gl;c.pixelStorei(c.UNPACK_FLIP_Y_WEBGL,r),this.current=r,this.dirty=!1}}class Au extends vn{constructor(r,c){super(r),this.context=r,this.parent=c}getDefault(){return null}}class $d extends Au{setDirty(){this.dirty=!0}set(r){if(r===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const c=this.gl;c.framebufferTexture2D(c.FRAMEBUFFER,c.COLOR_ATTACHMENT0,c.TEXTURE_2D,r,0),this.current=r,this.dirty=!1}}class Hm extends Au{set(r){if(r===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const c=this.gl;c.framebufferRenderbuffer(c.FRAMEBUFFER,c.DEPTH_ATTACHMENT,c.RENDERBUFFER,r),this.current=r,this.dirty=!1}}class Pu extends Au{set(r){if(r===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const c=this.gl;c.framebufferRenderbuffer(c.FRAMEBUFFER,c.DEPTH_STENCIL_ATTACHMENT,c.RENDERBUFFER,r),this.current=r,this.dirty=!1}}class Nl{constructor(r,c,f,_,x){this.context=r,this.width=c,this.height=f;const E=r.gl,A=this.framebuffer=E.createFramebuffer();if(this.colorAttachment=new $d(r,A),_)this.depthAttachment=x?new Pu(r,A):new Hm(r,A);else if(x)throw new Error("Stencil cannot be setted without depth");if(E.checkFramebufferStatus(E.FRAMEBUFFER)!==E.FRAMEBUFFER_COMPLETE)throw new Error("Framebuffer is not complete")}destroy(){const r=this.context.gl,c=this.colorAttachment.get();if(c&&r.deleteTexture(c),this.depthAttachment){const f=this.depthAttachment.get();f&&r.deleteRenderbuffer(f)}r.deleteFramebuffer(this.framebuffer)}}class Qn{constructor(r,c,f){this.blendFunction=r,this.blendColor=c,this.mask=f}}Qn.Replace=[1,0],Qn.disabled=new Qn(Qn.Replace,l.Color.transparent,[!1,!1,!1,!1]),Qn.unblended=new Qn(Qn.Replace,l.Color.transparent,[!0,!0,!0,!0]),Qn.alphaBlended=new Qn([1,771],l.Color.transparent,[!0,!0,!0,!0]);class Ru{constructor(r){var c,f;if(this.gl=r,this.clearColor=new Su(this),this.clearDepth=new Ol(this),this.clearStencil=new Ld(this),this.colorMask=new zd(this),this.depthMask=new Wa(this),this.stencilMask=new Fm(this),this.stencilFunc=new Nm(this),this.stencilOp=new Um(this),this.stencilTest=new $m(this),this.depthRange=new Vm(this),this.depthTest=new jm(this),this.depthFunc=new Eu(this),this.blend=new Bl(this),this.blendFunc=new Tu(this),this.blendColor=new Cu(this),this.blendEquation=new Za(this),this.cullFace=new Od(this),this.cullFaceSide=new Bd(this),this.frontFace=new Iu(this),this.program=new _a(this),this.activeTexture=new Fd(this),this.viewport=new Ya(this),this.bindFramebuffer=new Xa(this),this.bindRenderbuffer=new Nd(this),this.bindTexture=new ku(this),this.bindVertexBuffer=new Rn(this),this.bindElementBuffer=new Fl(this),this.bindVertexArray=new Gm(this),this.pixelStoreUnpack=new Ud(this),this.pixelStoreUnpackPremultiplyAlpha=new No(this),this.pixelStoreUnpackFlipY=new qm(this),this.extTextureFilterAnisotropic=r.getExtension("EXT_texture_filter_anisotropic")||r.getExtension("MOZ_EXT_texture_filter_anisotropic")||r.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=r.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.maxTextureSize=r.getParameter(r.MAX_TEXTURE_SIZE),ga(r)){this.HALF_FLOAT=r.HALF_FLOAT;const _=r.getExtension("EXT_color_buffer_half_float");this.RGBA16F=(c=r.RGBA16F)!==null&&c!==void 0?c:_==null?void 0:_.RGBA16F_EXT,this.RGB16F=(f=r.RGB16F)!==null&&f!==void 0?f:_==null?void 0:_.RGB16F_EXT,r.getExtension("EXT_color_buffer_float")}else{r.getExtension("EXT_color_buffer_half_float"),r.getExtension("OES_texture_half_float_linear");const _=r.getExtension("OES_texture_half_float");this.HALF_FLOAT=_==null?void 0:_.HALF_FLOAT_OES}}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArray.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(r,c){return new Ll(this,r,c)}createVertexBuffer(r,c,f){return new wu(this,r,c,f)}createRenderbuffer(r,c,f){const _=this.gl,x=_.createRenderbuffer();return this.bindRenderbuffer.set(x),_.renderbufferStorage(_.RENDERBUFFER,r,c,f),this.bindRenderbuffer.set(null),x}createFramebuffer(r,c,f,_){return new Nl(this,r,c,f,_)}clear({color:r,depth:c,stencil:f}){const _=this.gl;let x=0;r&&(x|=_.COLOR_BUFFER_BIT,this.clearColor.set(r),this.colorMask.set([!0,!0,!0,!0])),c!==void 0&&(x|=_.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(c),this.depthMask.set(!0)),f!==void 0&&(x|=_.STENCIL_BUFFER_BIT,this.clearStencil.set(f),this.stencilMask.set(255)),_.clear(x)}setCullFace(r){r.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(r.mode),this.frontFace.set(r.frontFace))}setDepthMode(r){r.func!==this.gl.ALWAYS||r.mask?(this.depthTest.set(!0),this.depthFunc.set(r.func),this.depthMask.set(r.mask),this.depthRange.set(r.range)):this.depthTest.set(!1)}setStencilMode(r){r.test.func!==this.gl.ALWAYS||r.mask?(this.stencilTest.set(!0),this.stencilMask.set(r.mask),this.stencilOp.set([r.fail,r.depthFail,r.pass]),this.stencilFunc.set({func:r.test.func,ref:r.ref,mask:r.test.mask})):this.stencilTest.set(!1)}setColorMode(r){l.deepEqual(r.blendFunction,Qn.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(r.blendFunction),this.blendColor.set(r.blendColor)),this.colorMask.set(r.mask)}createVertexArray(){var r;return ga(this.gl)?this.gl.createVertexArray():(r=this.gl.getExtension("OES_vertex_array_object"))===null||r===void 0?void 0:r.createVertexArrayOES()}deleteVertexArray(r){var c;return ga(this.gl)?this.gl.deleteVertexArray(r):(c=this.gl.getExtension("OES_vertex_array_object"))===null||c===void 0?void 0:c.deleteVertexArrayOES(r)}unbindVAO(){this.bindVertexArray.set(null)}}class un{constructor(r,c,f){this.func=r,this.mask=c,this.range=f}}un.ReadOnly=!1,un.ReadWrite=!0,un.disabled=new un(519,un.ReadOnly,[0,1]);const Ul=7680;class $n{constructor(r,c,f,_,x,E){this.test=r,this.ref=c,this.mask=f,this.fail=_,this.depthFail=x,this.pass=E}}$n.disabled=new $n({func:519,mask:0},0,0,Ul,Ul,Ul);class Fn{constructor(r,c,f){this.enable=r,this.mode=c,this.frontFace=f}}let Ka;function Vd(m,r,c,f,_,x,E){const A=m.context,k=A.gl,P=m.useProgram("collisionBox"),z=[];let L=0,G=0;for(let re=0;re<f.length;re++){const Pe=f[re],Fe=r.getTile(Pe),Qe=Fe.getBucket(c);if(!Qe)continue;let ot=Pe.posMatrix;_[0]===0&&_[1]===0||(ot=m.translatePosMatrix(Pe.posMatrix,Fe,_,x));const ht=E?Qe.textCollisionBox:Qe.iconCollisionBox,it=Qe.collisionCircleArray;if(it.length>0){const St=l.create(),Ut=ot;l.mul(St,Qe.placementInvProjMatrix,m.transform.glCoordMatrix),l.mul(St,St,Qe.placementViewportMatrix),z.push({circleArray:it,circleOffset:G,transform:Ut,invTransform:St,coord:Pe}),L+=it.length/4,G=L}ht&&P.draw(A,k.LINES,un.disabled,$n.disabled,m.colorModeForRenderPass(),Fn.disabled,yu(ot,m.transform,Fe),m.style.map.terrain&&m.style.map.terrain.getTerrainData(Pe),c.id,ht.layoutVertexBuffer,ht.indexBuffer,ht.segments,null,m.transform.zoom,null,null,ht.collisionVertexBuffer)}if(!E||!z.length)return;const ee=m.useProgram("collisionCircle"),K=new l.CollisionCircleLayoutArray;K.resize(4*L),K._trim();let J=0;for(const re of z)for(let Pe=0;Pe<re.circleArray.length/4;Pe++){const Fe=4*Pe,Qe=re.circleArray[Fe+0],ot=re.circleArray[Fe+1],ht=re.circleArray[Fe+2],it=re.circleArray[Fe+3];K.emplace(J++,Qe,ot,ht,it,0),K.emplace(J++,Qe,ot,ht,it,1),K.emplace(J++,Qe,ot,ht,it,2),K.emplace(J++,Qe,ot,ht,it,3)}(!Ka||Ka.length<2*L)&&(Ka=function(re){const Pe=2*re,Fe=new l.QuadTriangleArray;Fe.resize(Pe),Fe._trim();for(let Qe=0;Qe<Pe;Qe++){const ot=6*Qe;Fe.uint16[ot+0]=4*Qe+0,Fe.uint16[ot+1]=4*Qe+1,Fe.uint16[ot+2]=4*Qe+2,Fe.uint16[ot+3]=4*Qe+2,Fe.uint16[ot+4]=4*Qe+3,Fe.uint16[ot+5]=4*Qe+0}return Fe}(L));const se=A.createIndexBuffer(Ka,!0),ge=A.createVertexBuffer(K,l.collisionCircleLayout.members,!0);for(const re of z){const Pe={u_matrix:re.transform,u_inv_matrix:re.invTransform,u_camera_to_center_distance:(Me=m.transform).cameraToCenterDistance,u_viewport_size:[Me.width,Me.height]};ee.draw(A,k.TRIANGLES,un.disabled,$n.disabled,m.colorModeForRenderPass(),Fn.disabled,Pe,m.style.map.terrain&&m.style.map.terrain.getTerrainData(re.coord),c.id,ge,se,l.SegmentVector.simpleSegment(0,2*re.circleOffset,re.circleArray.length,re.circleArray.length/2),null,m.transform.zoom,null,null,null)}var Me;ge.destroy(),se.destroy()}Fn.disabled=new Fn(!1,1029,2305),Fn.backCCW=new Fn(!0,1029,2305);const Mu=l.identity(new Float32Array(16));function Wm(m,r,c,f,_,x){const{horizontalAlign:E,verticalAlign:A}=l.getAnchorAlignment(m),k=-(E-.5)*r,P=-(A-.5)*c,z=l.evaluateVariableOffset(m,f);return new l.Point((k/_+z[0])*x,(P/_+z[1])*x)}function jd(m,r,c,f,_,x,E,A,k,P,z){const L=m.text.placedSymbolArray,G=m.text.dynamicLayoutVertexArray,ee=m.icon.dynamicLayoutVertexArray,K={};G.clear();for(let J=0;J<L.length;J++){const se=L.get(J),ge=se.hidden||!se.crossTileID||m.allowVerticalPlacement&&!se.placedOrientation?null:f[se.crossTileID];if(ge){const Me=new l.Point(se.anchorX,se.anchorY),re=fn(Me,c?E:x,z),Pe=Ot(_.cameraToCenterDistance,re.signedDistanceFromCamera);let Fe=l.evaluateSizeForFeature(m.textSizeData,k,se)*Pe/l.ONE_EM;c&&(Fe*=m.tilePixelRatio/A);const{width:Qe,height:ot,anchor:ht,textOffset:it,textBoxScale:St}=ge,Ut=Wm(ht,Qe,ot,it,St,Fe),Qt=c?fn(Me.add(Ut),x,z).point:re.point.add(r?Ut.rotate(-_.angle):Ut),gt=m.allowVerticalPlacement&&se.placedOrientation===l.WritingMode.vertical?Math.PI/2:0;for(let Wt=0;Wt<se.numGlyphs;Wt++)l.addDynamicAttributes(G,Qt,gt);P&&se.associatedIconIndex>=0&&(K[se.associatedIconIndex]={shiftedAnchor:Qt,angle:gt})}else X(se.numGlyphs,G)}if(P){ee.clear();const J=m.icon.placedSymbolArray;for(let se=0;se<J.length;se++){const ge=J.get(se);if(ge.hidden)X(ge.numGlyphs,ee);else{const Me=K[se];if(Me)for(let re=0;re<ge.numGlyphs;re++)l.addDynamicAttributes(ee,Me.shiftedAnchor,Me.angle);else X(ge.numGlyphs,ee)}}m.icon.dynamicLayoutVertexBuffer.updateData(ee)}m.text.dynamicLayoutVertexBuffer.updateData(G)}function $l(m,r,c){return c.iconsInText&&r?"symbolTextAndIcon":m?"symbolSDF":"symbolIcon"}function Vl(m,r,c,f,_,x,E,A,k,P,z,L){const G=m.context,ee=G.gl,K=m.transform,J=A==="map",se=k==="map",ge=A!=="viewport"&&c.layout.get("symbol-placement")!=="point",Me=J&&!se&&!ge,re=!c.layout.get("symbol-sort-key").isConstant();let Pe=!1;const Fe=m.depthModeForSublayer(0,un.ReadOnly),Qe=c.layout.get("text-variable-anchor"),ot=[];for(const ht of f){const it=r.getTile(ht),St=it.getBucket(c);if(!St)continue;const Ut=_?St.text:St.icon;if(!Ut||!Ut.segments.get().length||!Ut.hasVisibleVertices)continue;const Qt=Ut.programConfigurations.get(c.id),gt=_||St.sdfIcons,Wt=_?St.textSizeData:St.iconSizeData,Et=se||K.pitch!==0,xn=m.useProgram($l(gt,_,St),Qt),di=l.evaluateSizeForZoom(Wt,K.zoom),bn=m.style.map.terrain&&m.style.map.terrain.getTerrainData(ht);let nn,ai,er,fi,Pi=[0,0],wr=null;if(_)ai=it.glyphAtlasTexture,er=ee.LINEAR,nn=it.glyphAtlasTexture.size,St.iconsInText&&(Pi=it.imageAtlasTexture.size,wr=it.imageAtlasTexture,fi=Et||m.options.rotating||m.options.zooming||Wt.kind==="composite"||Wt.kind==="camera"?ee.LINEAR:ee.NEAREST);else{const Ci=c.layout.get("icon-size").constantOr(0)!==1||St.iconsNeedLinear;ai=it.imageAtlasTexture,er=gt||m.options.rotating||m.options.zooming||Ci||Et?ee.LINEAR:ee.NEAREST,nn=it.imageAtlasTexture.size}const Qr=me(it,1,m.transform.zoom),es=qt(ht.posMatrix,se,J,m.transform,Qr),tr=Dn(ht.posMatrix,se,J,m.transform,Qr),vs=Qe&&St.hasTextData(),Jo=c.layout.get("icon-text-fit")!=="none"&&vs&&St.hasIconData();if(ge){const Ci=m.style.map.terrain?(cc,Ds)=>m.style.map.terrain.getElevation(ht,cc,Ds):null,Sr=c.layout.get("text-rotation-alignment")==="map";ks(St,ht.posMatrix,m,_,es,tr,se,P,Sr,Ci)}const Gi=m.translatePosMatrix(ht.posMatrix,it,x,E),Ri=ge||_&&Qe||Jo?Mu:es,Cn=m.translatePosMatrix(tr,it,x,E,!0),Ti=gt&&c.paint.get(_?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let Mi;Mi=gt?St.iconsInText?Dl(Wt.kind,di,Me,se,m,Gi,Ri,Cn,nn,Pi):Ha(Wt.kind,di,Me,se,m,Gi,Ri,Cn,_,nn,!0):qa(Wt.kind,di,Me,se,m,Gi,Ri,Cn,_,nn);const kn={program:xn,buffers:Ut,uniformValues:Mi,atlasTexture:ai,atlasTextureIcon:wr,atlasInterpolation:er,atlasInterpolationIcon:fi,isSDF:gt,hasHalo:Ti};if(re&&St.canOverlap){Pe=!0;const Ci=Ut.segments.get();for(const Sr of Ci)ot.push({segments:new l.SegmentVector([Sr]),sortKey:Sr.sortKey,state:kn,terrainData:bn})}else ot.push({segments:Ut.segments,sortKey:0,state:kn,terrainData:bn})}Pe&&ot.sort((ht,it)=>ht.sortKey-it.sortKey);for(const ht of ot){const it=ht.state;if(G.activeTexture.set(ee.TEXTURE0),it.atlasTexture.bind(it.atlasInterpolation,ee.CLAMP_TO_EDGE),it.atlasTextureIcon&&(G.activeTexture.set(ee.TEXTURE1),it.atlasTextureIcon&&it.atlasTextureIcon.bind(it.atlasInterpolationIcon,ee.CLAMP_TO_EDGE)),it.isSDF){const St=it.uniformValues;it.hasHalo&&(St.u_is_halo=1,Du(it.buffers,ht.segments,c,m,it.program,Fe,z,L,St,ht.terrainData)),St.u_is_halo=0}Du(it.buffers,ht.segments,c,m,it.program,Fe,z,L,it.uniformValues,ht.terrainData)}}function Du(m,r,c,f,_,x,E,A,k,P){const z=f.context;_.draw(z,z.gl.TRIANGLES,x,E,A,Fn.disabled,k,P,c.id,m.layoutVertexBuffer,m.indexBuffer,r,c.paint,f.transform.zoom,m.programConfigurations.get(c.id),m.dynamicLayoutVertexBuffer,m.opacityVertexBuffer)}function Lu(m,r,c,f,_){if(!c||!f||!f.imageAtlas)return;const x=f.imageAtlas.patternPositions;let E=x[c.to.toString()],A=x[c.from.toString()];if(!E||!A){const k=_.getPaintProperty(r);E=x[k],A=x[k]}E&&A&&m.setConstantPatternPositions(E,A)}function Uo(m,r,c,f,_,x,E){const A=m.context.gl,k="fill-pattern",P=c.paint.get(k),z=P&&P.constantOr(1),L=c.getCrossfadeParameters();let G,ee,K,J,se;E?(ee=z&&!c.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",G=A.LINES):(ee=z?"fillPattern":"fill",G=A.TRIANGLES);const ge=P.constantOr(null);for(const Me of f){const re=r.getTile(Me);if(z&&!re.patternsLoaded())continue;const Pe=re.getBucket(c);if(!Pe)continue;const Fe=Pe.programConfigurations.get(c.id),Qe=m.useProgram(ee,Fe),ot=m.style.map.terrain&&m.style.map.terrain.getTerrainData(Me);z&&(m.context.activeTexture.set(A.TEXTURE0),re.imageAtlasTexture.bind(A.LINEAR,A.CLAMP_TO_EDGE),Fe.updatePaintBuffers(L)),Lu(Fe,k,ge,re,c);const ht=ot?Me:null,it=m.translatePosMatrix(ht?ht.posMatrix:Me.posMatrix,re,c.paint.get("fill-translate"),c.paint.get("fill-translate-anchor"));if(E){J=Pe.indexBuffer2,se=Pe.segments2;const St=[A.drawingBufferWidth,A.drawingBufferHeight];K=ee==="fillOutlinePattern"&&z?Rd(it,m,L,re,St):Om(it,St)}else J=Pe.indexBuffer,se=Pe.segments,K=z?_u(it,m,L,re):Pd(it);Qe.draw(m.context,G,_,m.stencilModeForClipping(Me),x,Fn.disabled,K,ot,c.id,Pe.layoutVertexBuffer,J,se,c.paint,m.transform.zoom,Fe)}}function $o(m,r,c,f,_,x,E){const A=m.context,k=A.gl,P="fill-extrusion-pattern",z=c.paint.get(P),L=z.constantOr(1),G=c.getCrossfadeParameters(),ee=c.paint.get("fill-extrusion-opacity"),K=z.constantOr(null);for(const J of f){const se=r.getTile(J),ge=se.getBucket(c);if(!ge)continue;const Me=m.style.map.terrain&&m.style.map.terrain.getTerrainData(J),re=ge.programConfigurations.get(c.id),Pe=m.useProgram(L?"fillExtrusionPattern":"fillExtrusion",re);L&&(m.context.activeTexture.set(k.TEXTURE0),se.imageAtlasTexture.bind(k.LINEAR,k.CLAMP_TO_EDGE),re.updatePaintBuffers(G)),Lu(re,P,K,se,c);const Fe=m.translatePosMatrix(J.posMatrix,se,c.paint.get("fill-extrusion-translate"),c.paint.get("fill-extrusion-translate-anchor")),Qe=c.paint.get("fill-extrusion-vertical-gradient"),ot=L?gu(Fe,m,Qe,ee,J,G,se):Ad(Fe,m,Qe,ee);Pe.draw(A,A.gl.TRIANGLES,_,x,E,Fn.backCCW,ot,Me,c.id,ge.layoutVertexBuffer,ge.indexBuffer,ge.segments,c.paint,m.transform.zoom,re,m.style.map.terrain&&ge.centroidVertexBuffer)}}function Zm(m,r,c,f,_,x,E){const A=m.context,k=A.gl,P=c.fbo;if(!P)return;const z=m.useProgram("hillshade"),L=m.style.map.terrain&&m.style.map.terrain.getTerrainData(r);A.activeTexture.set(k.TEXTURE0),k.bindTexture(k.TEXTURE_2D,P.colorAttachment.get()),z.draw(A,k.TRIANGLES,_,x,E,Fn.disabled,((G,ee,K,J)=>{const se=K.paint.get("hillshade-shadow-color"),ge=K.paint.get("hillshade-highlight-color"),Me=K.paint.get("hillshade-accent-color");let re=K.paint.get("hillshade-illumination-direction")*(Math.PI/180);K.paint.get("hillshade-illumination-anchor")==="viewport"&&(re-=G.transform.angle);const Pe=!G.options.moving;return{u_matrix:J?J.posMatrix:G.transform.calculatePosMatrix(ee.tileID.toUnwrapped(),Pe),u_image:0,u_latrange:Dd(0,ee.tileID),u_light:[K.paint.get("hillshade-exaggeration"),re],u_shadow:se,u_highlight:ge,u_accent:Me}})(m,c,f,L?r:null),L,f.id,m.rasterBoundsBuffer,m.quadTriangleIndexBuffer,m.rasterBoundsSegments)}function Gd(m,r,c,f,_,x){const E=m.context,A=E.gl,k=r.dem;if(k&&k.data){const P=k.dim,z=k.stride,L=k.getPixels();if(E.activeTexture.set(A.TEXTURE1),E.pixelStoreUnpackPremultiplyAlpha.set(!1),r.demTexture=r.demTexture||m.getTileTexture(z),r.demTexture){const ee=r.demTexture;ee.update(L,{premultiply:!1}),ee.bind(A.NEAREST,A.CLAMP_TO_EDGE)}else r.demTexture=new xe(E,L,A.RGBA,{premultiply:!1}),r.demTexture.bind(A.NEAREST,A.CLAMP_TO_EDGE);E.activeTexture.set(A.TEXTURE0);let G=r.fbo;if(!G){const ee=new xe(E,{width:P,height:P,data:null},A.RGBA);ee.bind(A.LINEAR,A.CLAMP_TO_EDGE),G=r.fbo=E.createFramebuffer(P,P,!0,!1),G.colorAttachment.set(ee.texture)}E.bindFramebuffer.set(G.framebuffer),E.viewport.set([0,0,P,P]),m.useProgram("hillshadePrepare").draw(E,A.TRIANGLES,f,_,x,Fn.disabled,((ee,K)=>{const J=K.stride,se=l.create();return l.ortho(se,0,l.EXTENT,-l.EXTENT,0,0,1),l.translate(se,se,[0,-l.EXTENT,0]),{u_matrix:se,u_image:1,u_dimension:[J,J],u_zoom:ee.overscaledZ,u_unpack:K.getUnpackVector()}})(r.tileID,k),null,c.id,m.rasterBoundsBuffer,m.quadTriangleIndexBuffer,m.rasterBoundsSegments),r.needsHillshadePrepare=!1}}function hi(m,r,c,f,_,x){const E=f.paint.get("raster-fade-duration");if(!x&&E>0){const A=l.exported.now(),k=(A-m.timeAdded)/E,P=r?(A-r.timeAdded)/E:-1,z=c.getSource(),L=_.coveringZoomLevel({tileSize:z.tileSize,roundZoom:z.roundZoom}),G=!r||Math.abs(r.tileID.overscaledZ-L)>Math.abs(m.tileID.overscaledZ-L),ee=G&&m.refreshedUponExpiration?1:l.clamp(G?k:1-P,0,1);return m.refreshedUponExpiration&&k>=1&&(m.refreshedUponExpiration=!1),r?{opacity:1,mix:1-ee}:{opacity:ee,mix:0}}return{opacity:1,mix:0}}const ya=new l.Color(1,0,0,1),$r=new l.Color(0,1,0,1),qd=new l.Color(0,0,1,1),zu=new l.Color(1,0,1,1),Hd=new l.Color(0,1,1,1);function va(m,r,c,f){Ja(m,0,r+c/2,m.transform.width,c,f)}function Vo(m,r,c,f){Ja(m,r-c/2,0,c,m.transform.height,f)}function Ja(m,r,c,f,_,x){const E=m.context,A=E.gl;A.enable(A.SCISSOR_TEST),A.scissor(r*m.pixelRatio,c*m.pixelRatio,f*m.pixelRatio,_*m.pixelRatio),E.clear({color:x}),A.disable(A.SCISSOR_TEST)}function Wd(m,r,c){const f=m.context,_=f.gl,x=c.posMatrix,E=m.useProgram("debug"),A=un.disabled,k=$n.disabled,P=m.colorModeForRenderPass(),z="$debug",L=m.style.map.terrain&&m.style.map.terrain.getTerrainData(c);f.activeTexture.set(_.TEXTURE0);const G=r.getTileByID(c.key).latestRawTileData,ee=Math.floor((G&&G.byteLength||0)/1024),K=r.getTile(c).tileSize,J=512/Math.min(K,512)*(c.overscaledZ/m.transform.zoom)*.5;let se=c.canonical.toString();c.overscaledZ!==c.canonical.z&&(se+=` => ${c.overscaledZ}`),function(ge,Me){ge.initDebugOverlayCanvas();const re=ge.debugOverlayCanvas,Pe=ge.context.gl,Fe=ge.debugOverlayCanvas.getContext("2d");Fe.clearRect(0,0,re.width,re.height),Fe.shadowColor="white",Fe.shadowBlur=2,Fe.lineWidth=1.5,Fe.strokeStyle="white",Fe.textBaseline="top",Fe.font="bold 36px Open Sans, sans-serif",Fe.fillText(Me,5,5),Fe.strokeText(Me,5,5),ge.debugOverlayTexture.update(re),ge.debugOverlayTexture.bind(Pe.LINEAR,Pe.CLAMP_TO_EDGE)}(m,`${se} ${ee}kB`),E.draw(f,_.TRIANGLES,A,k,Qn.alphaBlended,Fn.disabled,vu(x,l.Color.transparent,J),null,z,m.debugBuffer,m.quadTriangleIndexBuffer,m.debugSegments),E.draw(f,_.LINE_STRIP,A,k,P,Fn.disabled,vu(x,l.Color.red),L,z,m.debugBuffer,m.tileBorderIndexBuffer,m.debugSegments)}function Ou(m,r,c){const f=m.context,_=f.gl,x=m.colorModeForRenderPass(),E=new un(_.LEQUAL,un.ReadWrite,m.depthRangeFor3D),A=m.useProgram("terrain"),k=r.getTerrainMesh();f.bindFramebuffer.set(null),f.viewport.set([0,0,m.width,m.height]);for(const P of c){const z=m.renderToTexture.getTexture(P),L=r.getTerrainData(P.tileID);f.activeTexture.set(_.TEXTURE0),_.bindTexture(_.TEXTURE_2D,z.texture);const G={u_matrix:m.transform.calculatePosMatrix(P.tileID.toUnwrapped()),u_texture:0,u_ele_delta:r.getMeshFrameDelta(m.transform.zoom)};A.draw(f,_.TRIANGLES,E,$n.disabled,x,Fn.backCCW,G,L,"terrain",k.vertexBuffer,k.indexBuffer,k.segments)}}const Bu={symbol:function(m,r,c,f,_){if(m.renderPass!=="translucent")return;const x=$n.disabled,E=m.colorModeForRenderPass();c.layout.get("text-variable-anchor")&&function(A,k,P,z,L,G,ee){const K=k.transform,J=L==="map",se=G==="map";for(const ge of A){const Me=z.getTile(ge),re=Me.getBucket(P);if(!re||!re.text||!re.text.segments.get().length)continue;const Pe=l.evaluateSizeForZoom(re.textSizeData,K.zoom),Fe=me(Me,1,k.transform.zoom),Qe=qt(ge.posMatrix,se,J,k.transform,Fe),ot=P.layout.get("icon-text-fit")!=="none"&&re.hasIconData();if(Pe){const ht=Math.pow(2,K.zoom-Me.tileID.overscaledZ);jd(re,J,se,ee,K,Qe,ge.posMatrix,ht,Pe,ot,k.style.map.terrain?(it,St)=>k.style.map.terrain.getElevation(ge,it,St):null)}}}(f,m,c,r,c.layout.get("text-rotation-alignment"),c.layout.get("text-pitch-alignment"),_),c.paint.get("icon-opacity").constantOr(1)!==0&&Vl(m,r,c,f,!1,c.paint.get("icon-translate"),c.paint.get("icon-translate-anchor"),c.layout.get("icon-rotation-alignment"),c.layout.get("icon-pitch-alignment"),c.layout.get("icon-keep-upright"),x,E),c.paint.get("text-opacity").constantOr(1)!==0&&Vl(m,r,c,f,!0,c.paint.get("text-translate"),c.paint.get("text-translate-anchor"),c.layout.get("text-rotation-alignment"),c.layout.get("text-pitch-alignment"),c.layout.get("text-keep-upright"),x,E),r.map.showCollisionBoxes&&(Vd(m,r,c,f,c.paint.get("text-translate"),c.paint.get("text-translate-anchor"),!0),Vd(m,r,c,f,c.paint.get("icon-translate"),c.paint.get("icon-translate-anchor"),!1))},circle:function(m,r,c,f){if(m.renderPass!=="translucent")return;const _=c.paint.get("circle-opacity"),x=c.paint.get("circle-stroke-width"),E=c.paint.get("circle-stroke-opacity"),A=!c.layout.get("circle-sort-key").isConstant();if(_.constantOr(1)===0&&(x.constantOr(1)===0||E.constantOr(1)===0))return;const k=m.context,P=k.gl,z=m.depthModeForSublayer(0,un.ReadOnly),L=$n.disabled,G=m.colorModeForRenderPass(),ee=[];for(let K=0;K<f.length;K++){const J=f[K],se=r.getTile(J),ge=se.getBucket(c);if(!ge)continue;const Me=ge.programConfigurations.get(c.id),re=m.useProgram("circle",Me),Pe=ge.layoutVertexBuffer,Fe=ge.indexBuffer,Qe=m.style.map.terrain&&m.style.map.terrain.getTerrainData(J),ot={programConfiguration:Me,program:re,layoutVertexBuffer:Pe,indexBuffer:Fe,uniformValues:Bm(m,J,se,c),terrainData:Qe};if(A){const ht=ge.segments.get();for(const it of ht)ee.push({segments:new l.SegmentVector([it]),sortKey:it.sortKey,state:ot})}else ee.push({segments:ge.segments,sortKey:0,state:ot})}A&&ee.sort((K,J)=>K.sortKey-J.sortKey);for(const K of ee){const{programConfiguration:J,program:se,layoutVertexBuffer:ge,indexBuffer:Me,uniformValues:re,terrainData:Pe}=K.state;se.draw(k,P.TRIANGLES,z,L,G,Fn.disabled,re,Pe,c.id,ge,Me,K.segments,c.paint,m.transform.zoom,J)}},heatmap:function(m,r,c,f){if(c.paint.get("heatmap-opacity")!==0)if(m.renderPass==="offscreen"){const _=m.context,x=_.gl,E=$n.disabled,A=new Qn([x.ONE,x.ONE],l.Color.transparent,[!0,!0,!0,!0]);(function(k,P,z){const L=k.gl;k.activeTexture.set(L.TEXTURE1),k.viewport.set([0,0,P.width/4,P.height/4]);let G=z.heatmapFbo;if(G)L.bindTexture(L.TEXTURE_2D,G.colorAttachment.get()),k.bindFramebuffer.set(G.framebuffer);else{const ee=L.createTexture();L.bindTexture(L.TEXTURE_2D,ee),L.texParameteri(L.TEXTURE_2D,L.TEXTURE_WRAP_S,L.CLAMP_TO_EDGE),L.texParameteri(L.TEXTURE_2D,L.TEXTURE_WRAP_T,L.CLAMP_TO_EDGE),L.texParameteri(L.TEXTURE_2D,L.TEXTURE_MIN_FILTER,L.LINEAR),L.texParameteri(L.TEXTURE_2D,L.TEXTURE_MAG_FILTER,L.LINEAR),G=z.heatmapFbo=k.createFramebuffer(P.width/4,P.height/4,!1,!1),function(K,J,se,ge){var Me,re;const Pe=K.gl,Fe=(Me=K.HALF_FLOAT)!==null&&Me!==void 0?Me:Pe.UNSIGNED_BYTE,Qe=(re=K.RGBA16F)!==null&&re!==void 0?re:Pe.RGBA;Pe.texImage2D(Pe.TEXTURE_2D,0,Qe,J.width/4,J.height/4,0,Pe.RGBA,Fe,null),ge.colorAttachment.set(se)}(k,P,ee,G)}})(_,m,c),_.clear({color:l.Color.transparent});for(let k=0;k<f.length;k++){const P=f[k];if(r.hasRenderableParent(P))continue;const z=r.getTile(P),L=z.getBucket(c);if(!L)continue;const G=L.programConfigurations.get(c.id),ee=m.useProgram("heatmap",G),{zoom:K}=m.transform;ee.draw(_,x.TRIANGLES,un.disabled,E,A,Fn.disabled,Md(P.posMatrix,z,K,c.paint.get("heatmap-intensity")),null,c.id,L.layoutVertexBuffer,L.indexBuffer,L.segments,c.paint,m.transform.zoom,G)}_.viewport.set([0,0,m.width,m.height])}else m.renderPass==="translucent"&&(m.context.setColorMode(m.colorModeForRenderPass()),function(_,x){const E=_.context,A=E.gl,k=x.heatmapFbo;if(!k)return;E.activeTexture.set(A.TEXTURE0),A.bindTexture(A.TEXTURE_2D,k.colorAttachment.get()),E.activeTexture.set(A.TEXTURE1);let P=x.colorRampTexture;P||(P=x.colorRampTexture=new xe(E,x.colorRamp,A.RGBA)),P.bind(A.LINEAR,A.CLAMP_TO_EDGE),_.useProgram("heatmapTexture").draw(E,A.TRIANGLES,un.disabled,$n.disabled,_.colorModeForRenderPass(),Fn.disabled,((z,L,G,ee)=>{const K=l.create();l.ortho(K,0,z.width,z.height,0,0,1);const J=z.context.gl;return{u_matrix:K,u_world:[J.drawingBufferWidth,J.drawingBufferHeight],u_image:0,u_color_ramp:1,u_opacity:L.paint.get("heatmap-opacity")}})(_,x),null,x.id,_.viewportBuffer,_.quadTriangleIndexBuffer,_.viewportSegments,x.paint,_.transform.zoom)}(m,c))},line:function(m,r,c,f){if(m.renderPass!=="translucent")return;const _=c.paint.get("line-opacity"),x=c.paint.get("line-width");if(_.constantOr(1)===0||x.constantOr(1)===0)return;const E=m.depthModeForSublayer(0,un.ReadOnly),A=m.colorModeForRenderPass(),k=c.paint.get("line-dasharray"),P=c.paint.get("line-pattern"),z=P.constantOr(1),L=c.paint.get("line-gradient"),G=c.getCrossfadeParameters(),ee=z?"linePattern":k?"lineSDF":L?"lineGradient":"line",K=m.context,J=K.gl;let se=!0;for(const ge of f){const Me=r.getTile(ge);if(z&&!Me.patternsLoaded())continue;const re=Me.getBucket(c);if(!re)continue;const Pe=re.programConfigurations.get(c.id),Fe=m.context.program.get(),Qe=m.useProgram(ee,Pe),ot=se||Qe.program!==Fe,ht=m.style.map.terrain&&m.style.map.terrain.getTerrainData(ge),it=P.constantOr(null);if(it&&Me.imageAtlas){const Qt=Me.imageAtlas,gt=Qt.patternPositions[it.to.toString()],Wt=Qt.patternPositions[it.from.toString()];gt&&Wt&&Pe.setConstantPatternPositions(gt,Wt)}const St=ht?ge:null,Ut=z?Ur(m,Me,c,G,St):k?Pl(m,Me,c,k,G,St):L?Al(m,Me,c,re.lineClipsArray.length,St):Ps(m,Me,c,St);if(z)K.activeTexture.set(J.TEXTURE0),Me.imageAtlasTexture.bind(J.LINEAR,J.CLAMP_TO_EDGE),Pe.updatePaintBuffers(G);else if(k&&(ot||m.lineAtlas.dirty))K.activeTexture.set(J.TEXTURE0),m.lineAtlas.bind(K);else if(L){const Qt=re.gradients[c.id];let gt=Qt.texture;if(c.gradientVersion!==Qt.version){let Wt=256;if(c.stepInterpolant){const Et=r.getSource().maxzoom,xn=ge.canonical.z===Et?Math.ceil(1<<m.transform.maxZoom-ge.canonical.z):1;Wt=l.clamp(l.nextPowerOfTwo(re.maxLineLength/l.EXTENT*1024*xn),256,K.maxTextureSize)}Qt.gradient=l.renderColorRamp({expression:c.gradientExpression(),evaluationKey:"lineProgress",resolution:Wt,image:Qt.gradient||void 0,clips:re.lineClipsArray}),Qt.texture?Qt.texture.update(Qt.gradient):Qt.texture=new xe(K,Qt.gradient,J.RGBA),Qt.version=c.gradientVersion,gt=Qt.texture}K.activeTexture.set(J.TEXTURE0),gt.bind(c.stepInterpolant?J.NEAREST:J.LINEAR,J.CLAMP_TO_EDGE)}Qe.draw(K,J.TRIANGLES,E,m.stencilModeForClipping(ge),A,Fn.disabled,Ut,ht,c.id,re.layoutVertexBuffer,re.indexBuffer,re.segments,c.paint,m.transform.zoom,Pe,re.layoutVertexBuffer2),se=!1}},fill:function(m,r,c,f){const _=c.paint.get("fill-color"),x=c.paint.get("fill-opacity");if(x.constantOr(1)===0)return;const E=m.colorModeForRenderPass(),A=c.paint.get("fill-pattern"),k=m.opaquePassEnabledForLayer()&&!A.constantOr(1)&&_.constantOr(l.Color.transparent).a===1&&x.constantOr(0)===1?"opaque":"translucent";if(m.renderPass===k){const P=m.depthModeForSublayer(1,m.renderPass==="opaque"?un.ReadWrite:un.ReadOnly);Uo(m,r,c,f,P,E,!1)}if(m.renderPass==="translucent"&&c.paint.get("fill-antialias")){const P=m.depthModeForSublayer(c.getPaintProperty("fill-outline-color")?2:0,un.ReadOnly);Uo(m,r,c,f,P,E,!0)}},"fill-extrusion":function(m,r,c,f){const _=c.paint.get("fill-extrusion-opacity");if(_!==0&&m.renderPass==="translucent"){const x=new un(m.context.gl.LEQUAL,un.ReadWrite,m.depthRangeFor3D);if(_!==1||c.paint.get("fill-extrusion-pattern").constantOr(1))$o(m,r,c,f,x,$n.disabled,Qn.disabled),$o(m,r,c,f,x,m.stencilModeFor3D(),m.colorModeForRenderPass());else{const E=m.colorModeForRenderPass();$o(m,r,c,f,x,$n.disabled,E)}}},hillshade:function(m,r,c,f){if(m.renderPass!=="offscreen"&&m.renderPass!=="translucent")return;const _=m.context,x=m.depthModeForSublayer(0,un.ReadOnly),E=m.colorModeForRenderPass(),[A,k]=m.renderPass==="translucent"?m.stencilConfigForOverlap(f):[{},f];for(const P of k){const z=r.getTile(P);z.needsHillshadePrepare!==void 0&&z.needsHillshadePrepare&&m.renderPass==="offscreen"?Gd(m,z,c,x,$n.disabled,E):m.renderPass==="translucent"&&Zm(m,P,z,c,x,A[P.overscaledZ],E)}_.viewport.set([0,0,m.width,m.height])},raster:function(m,r,c,f){if(m.renderPass!=="translucent"||c.paint.get("raster-opacity")===0||!f.length)return;const _=m.context,x=_.gl,E=r.getSource(),A=m.useProgram("raster"),k=m.colorModeForRenderPass(),[P,z]=E instanceof Y?[{},f]:m.stencilConfigForOverlap(f),L=z[z.length-1].overscaledZ,G=!m.options.moving;for(const ee of z){const K=m.depthModeForSublayer(ee.overscaledZ-L,c.paint.get("raster-opacity")===1?un.ReadWrite:un.ReadOnly,x.LESS),J=r.getTile(ee);J.registerFadeDuration(c.paint.get("raster-fade-duration"));const se=r.findLoadedParent(ee,0),ge=hi(J,se,r,c,m.transform,m.style.map.terrain);let Me,re;const Pe=c.paint.get("raster-resampling")==="nearest"?x.NEAREST:x.LINEAR;_.activeTexture.set(x.TEXTURE0),J.texture.bind(Pe,x.CLAMP_TO_EDGE,x.LINEAR_MIPMAP_NEAREST),_.activeTexture.set(x.TEXTURE1),se?(se.texture.bind(Pe,x.CLAMP_TO_EDGE,x.LINEAR_MIPMAP_NEAREST),Me=Math.pow(2,se.tileID.overscaledZ-J.tileID.overscaledZ),re=[J.tileID.canonical.x*Me%1,J.tileID.canonical.y*Me%1]):J.texture.bind(Pe,x.CLAMP_TO_EDGE,x.LINEAR_MIPMAP_NEAREST);const Fe=m.style.map.terrain&&m.style.map.terrain.getTerrainData(ee),Qe=Fe?ee:null,ot=Qe?Qe.posMatrix:m.transform.calculatePosMatrix(ee.toUnwrapped(),G),ht=Rl(ot,re||[0,0],Me||1,ge,c);E instanceof Y?A.draw(_,x.TRIANGLES,K,$n.disabled,k,Fn.disabled,ht,Fe,c.id,E.boundsBuffer,m.quadTriangleIndexBuffer,E.boundsSegments):A.draw(_,x.TRIANGLES,K,P[ee.overscaledZ],k,Fn.disabled,ht,Fe,c.id,m.rasterBoundsBuffer,m.quadTriangleIndexBuffer,m.rasterBoundsSegments)}},background:function(m,r,c,f){const _=c.paint.get("background-color"),x=c.paint.get("background-opacity");if(x===0)return;const E=m.context,A=E.gl,k=m.transform,P=k.tileSize,z=c.paint.get("background-pattern");if(m.isPatternMissing(z))return;const L=!z&&_.a===1&&x===1&&m.opaquePassEnabledForLayer()?"opaque":"translucent";if(m.renderPass!==L)return;const G=$n.disabled,ee=m.depthModeForSublayer(0,L==="opaque"?un.ReadWrite:un.ReadOnly),K=m.colorModeForRenderPass(),J=m.useProgram(z?"backgroundPattern":"background"),se=f||k.coveringTiles({tileSize:P,terrain:m.style.map.terrain});z&&(E.activeTexture.set(A.TEXTURE0),m.imageManager.bind(m.context));const ge=c.getCrossfadeParameters();for(const Me of se){const re=f?Me.posMatrix:m.transform.calculatePosMatrix(Me.toUnwrapped()),Pe=z?br(re,x,m,z,{tileID:Me,tileSize:P},ge):xr(re,x,_),Fe=m.style.map.terrain&&m.style.map.terrain.getTerrainData(Me);J.draw(E,A.TRIANGLES,ee,G,K,Fn.disabled,Pe,Fe,c.id,m.tileExtentBuffer,m.quadTriangleIndexBuffer,m.tileExtentSegments)}},debug:function(m,r,c){for(let f=0;f<c.length;f++)Wd(m,r,c[f])},custom:function(m,r,c){const f=m.context,_=c.implementation;if(m.renderPass==="offscreen"){const x=_.prerender;x&&(m.setCustomLayerDefaults(),f.setColorMode(m.colorModeForRenderPass()),x.call(_,f.gl,m.transform.customLayerMatrix()),f.setDirty(),m.setBaseState())}else if(m.renderPass==="translucent"){m.setCustomLayerDefaults(),f.setColorMode(m.colorModeForRenderPass()),f.setStencilMode($n.disabled);const x=_.renderingMode==="3d"?new un(m.context.gl.LEQUAL,un.ReadWrite,m.depthRangeFor3D):m.depthModeForSublayer(0,un.ReadOnly);f.setDepthMode(x),_.render(f.gl,m.transform.customLayerMatrix()),f.setDirty(),m.setBaseState(),f.bindFramebuffer.set(null)}}};class Zd{constructor(r,c){this.context=new Ru(r),this.transform=c,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:l.create(),renderTime:0},this.setup(),this.numSublayers=ut.maxUnderzooming+ut.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new Ys}resize(r,c,f){if(this.width=r*f,this.height=c*f,this.pixelRatio=f,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const _ of this.style._order)this.style._layers[_].resize()}setup(){const r=this.context,c=new l.PosArray;c.emplaceBack(0,0),c.emplaceBack(l.EXTENT,0),c.emplaceBack(0,l.EXTENT),c.emplaceBack(l.EXTENT,l.EXTENT),this.tileExtentBuffer=r.createVertexBuffer(c,mu.members),this.tileExtentSegments=l.SegmentVector.simpleSegment(0,0,4,2);const f=new l.PosArray;f.emplaceBack(0,0),f.emplaceBack(l.EXTENT,0),f.emplaceBack(0,l.EXTENT),f.emplaceBack(l.EXTENT,l.EXTENT),this.debugBuffer=r.createVertexBuffer(f,mu.members),this.debugSegments=l.SegmentVector.simpleSegment(0,0,4,5);const _=new l.RasterBoundsArray;_.emplaceBack(0,0,0,0),_.emplaceBack(l.EXTENT,0,l.EXTENT,0),_.emplaceBack(0,l.EXTENT,0,l.EXTENT),_.emplaceBack(l.EXTENT,l.EXTENT,l.EXTENT,l.EXTENT),this.rasterBoundsBuffer=r.createVertexBuffer(_,ft.members),this.rasterBoundsSegments=l.SegmentVector.simpleSegment(0,0,4,2);const x=new l.PosArray;x.emplaceBack(0,0),x.emplaceBack(1,0),x.emplaceBack(0,1),x.emplaceBack(1,1),this.viewportBuffer=r.createVertexBuffer(x,mu.members),this.viewportSegments=l.SegmentVector.simpleSegment(0,0,4,2);const E=new l.LineStripIndexArray;E.emplaceBack(0),E.emplaceBack(1),E.emplaceBack(3),E.emplaceBack(2),E.emplaceBack(0),this.tileBorderIndexBuffer=r.createIndexBuffer(E);const A=new l.TriangleIndexArray;A.emplaceBack(0,1,2),A.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=r.createIndexBuffer(A);const k=this.context.gl;this.stencilClearMode=new $n({func:k.ALWAYS,mask:0},0,255,k.ZERO,k.ZERO,k.ZERO)}clearStencil(){const r=this.context,c=r.gl;this.nextStencilID=1,this.currentStencilSource=void 0;const f=l.create();l.ortho(f,0,this.width,this.height,0,0,1),l.scale(f,f,[c.drawingBufferWidth,c.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(r,c.TRIANGLES,un.disabled,this.stencilClearMode,Qn.disabled,Fn.disabled,xu(f),null,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(r,c){if(this.currentStencilSource===r.source||!r.isTileClipped()||!c||!c.length)return;this.currentStencilSource=r.source;const f=this.context,_=f.gl;this.nextStencilID+c.length>256&&this.clearStencil(),f.setColorMode(Qn.disabled),f.setDepthMode(un.disabled);const x=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const E of c){const A=this._tileClippingMaskIDs[E.key]=this.nextStencilID++,k=this.style.map.terrain&&this.style.map.terrain.getTerrainData(E);x.draw(f,_.TRIANGLES,un.disabled,new $n({func:_.ALWAYS,mask:0},A,255,_.KEEP,_.KEEP,_.REPLACE),Qn.disabled,Fn.disabled,xu(E.posMatrix),k,"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const r=this.nextStencilID++,c=this.context.gl;return new $n({func:c.NOTEQUAL,mask:255},r,255,c.KEEP,c.KEEP,c.REPLACE)}stencilModeForClipping(r){const c=this.context.gl;return new $n({func:c.EQUAL,mask:255},this._tileClippingMaskIDs[r.key],0,c.KEEP,c.KEEP,c.REPLACE)}stencilConfigForOverlap(r){const c=this.context.gl,f=r.sort((E,A)=>A.overscaledZ-E.overscaledZ),_=f[f.length-1].overscaledZ,x=f[0].overscaledZ-_+1;if(x>1){this.currentStencilSource=void 0,this.nextStencilID+x>256&&this.clearStencil();const E={};for(let A=0;A<x;A++)E[A+_]=new $n({func:c.GEQUAL,mask:255},A+this.nextStencilID,255,c.KEEP,c.KEEP,c.REPLACE);return this.nextStencilID+=x,[E,f]}return[{[_]:$n.disabled},f]}colorModeForRenderPass(){const r=this.context.gl;return this._showOverdrawInspector?new Qn([r.CONSTANT_COLOR,r.ONE],new l.Color(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?Qn.unblended:Qn.alphaBlended}depthModeForSublayer(r,c,f){if(!this.opaquePassEnabledForLayer())return un.disabled;const _=1-((1+this.currentLayer)*this.numSublayers+r)*this.depthEpsilon;return new un(f||this.context.gl.LEQUAL,c,[_,_])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(r,c){this.style=r,this.options=c,this.lineAtlas=r.lineAtlas,this.imageManager=r.imageManager,this.glyphManager=r.glyphManager,this.symbolFadeChange=r.placement.symbolFadeChange(l.exported.now()),this.imageManager.beginFrame();const f=this.style._order,_=this.style.sourceCaches,x={},E={},A={};for(const k in _){const P=_[k];P.used&&P.prepare(this.context),x[k]=P.getVisibleCoordinates(),E[k]=x[k].slice().reverse(),A[k]=P.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let k=0;k<f.length;k++)if(this.style._layers[f[k]].is3D()){this.opaquePassCutoff=k;break}if(this.renderToTexture){this.renderToTexture.prepareForRender(this.style,this.transform.zoom),this.opaquePassCutoff=0;const k=this.style.map.terrain.sourceCache.tilesAfterTime(this.terrainFacilitator.renderTime);(this.terrainFacilitator.dirty||!l.equals(this.terrainFacilitator.matrix,this.transform.projMatrix)||k.length)&&(l.copy(this.terrainFacilitator.matrix,this.transform.projMatrix),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,function(P,z){const L=P.context,G=L.gl,ee=Qn.unblended,K=new un(G.LEQUAL,un.ReadWrite,[0,1]),J=z.getTerrainMesh(),se=z.sourceCache.getRenderableTiles(),ge=P.useProgram("terrainDepth");L.bindFramebuffer.set(z.getFramebuffer("depth").framebuffer),L.viewport.set([0,0,P.width/devicePixelRatio,P.height/devicePixelRatio]),L.clear({color:l.Color.transparent,depth:1});for(const Me of se){const re=z.getTerrainData(Me.tileID),Pe={u_matrix:P.transform.calculatePosMatrix(Me.tileID.toUnwrapped()),u_ele_delta:z.getMeshFrameDelta(P.transform.zoom)};ge.draw(L,G.TRIANGLES,K,$n.disabled,ee,Fn.backCCW,Pe,re,"terrain",J.vertexBuffer,J.indexBuffer,J.segments)}L.bindFramebuffer.set(null),L.viewport.set([0,0,P.width,P.height])}(this,this.style.map.terrain),function(P,z){const L=P.context,G=L.gl,ee=Qn.unblended,K=new un(G.LEQUAL,un.ReadWrite,[0,1]),J=z.getTerrainMesh(),se=z.getCoordsTexture(),ge=z.sourceCache.getRenderableTiles(),Me=P.useProgram("terrainCoords");L.bindFramebuffer.set(z.getFramebuffer("coords").framebuffer),L.viewport.set([0,0,P.width/devicePixelRatio,P.height/devicePixelRatio]),L.clear({color:l.Color.transparent,depth:1}),z.coordsIndex=[];for(const re of ge){const Pe=z.getTerrainData(re.tileID);L.activeTexture.set(G.TEXTURE0),G.bindTexture(G.TEXTURE_2D,se.texture);const Fe={u_matrix:P.transform.calculatePosMatrix(re.tileID.toUnwrapped()),u_terrain_coords_id:(255-z.coordsIndex.length)/255,u_texture:0,u_ele_delta:z.getMeshFrameDelta(P.transform.zoom)};Me.draw(L,G.TRIANGLES,K,$n.disabled,ee,Fn.backCCW,Fe,Pe,"terrain",J.vertexBuffer,J.indexBuffer,J.segments),z.coordsIndex.push(re.tileID.key)}L.bindFramebuffer.set(null),L.viewport.set([0,0,P.width,P.height])}(this,this.style.map.terrain))}this.renderPass="offscreen";for(const k of f){const P=this.style._layers[k];if(!P.hasOffscreenPass()||P.isHidden(this.transform.zoom))continue;const z=E[P.source];(P.type==="custom"||z.length)&&this.renderLayer(this,_[P.source],P,z)}if(this.context.bindFramebuffer.set(null),this.context.clear({color:c.showOverdrawInspector?l.Color.black:l.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=c.showOverdrawInspector,this.depthRangeFor3D=[0,1-(r._order.length+2)*this.numSublayers*this.depthEpsilon],!this.renderToTexture)for(this.renderPass="opaque",this.currentLayer=f.length-1;this.currentLayer>=0;this.currentLayer--){const k=this.style._layers[f[this.currentLayer]],P=_[k.source],z=x[k.source];this._renderTileClippingMasks(k,z),this.renderLayer(this,P,k,z)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<f.length;this.currentLayer++){const k=this.style._layers[f[this.currentLayer]],P=_[k.source];if(this.renderToTexture&&this.renderToTexture.renderLayer(k))continue;const z=(k.type==="symbol"?A:E)[k.source];this._renderTileClippingMasks(k,x[k.source]),this.renderLayer(this,P,k,z)}if(this.options.showTileBoundaries){const k=function(P,z){let L=null;const G=Object.values(P._layers).flatMap(se=>se.source&&!se.isHidden(z)?[P.sourceCaches[se.source]]:[]),ee=G.filter(se=>se.getSource().type==="vector"),K=G.filter(se=>se.getSource().type!=="vector"),J=se=>{(!L||L.getSource().maxzoom<se.getSource().maxzoom)&&(L=se)};return ee.forEach(se=>J(se)),L||K.forEach(se=>J(se)),L}(this.style,this.transform.zoom);k&&Bu.debug(this,k,k.getVisibleCoordinates())}this.options.showPadding&&function(k){const P=k.transform.padding;va(k,k.transform.height-(P.top||0),3,ya),va(k,P.bottom||0,3,$r),Vo(k,P.left||0,3,qd),Vo(k,k.transform.width-(P.right||0),3,zu);const z=k.transform.centerPoint;(function(L,G,ee,K){Ja(L,G-1,ee-10,2,20,K),Ja(L,G-10,ee-1,20,2,K)})(k,z.x,k.transform.height-z.y,Hd)}(this),this.context.setDefault()}renderLayer(r,c,f,_){f.isHidden(this.transform.zoom)||(f.type==="background"||f.type==="custom"||(_||[]).length)&&(this.id=f.id,Bu[f.type](r,c,f,_,this.style.placement.variableOffsets))}translatePosMatrix(r,c,f,_,x){if(!f[0]&&!f[1])return r;const E=x?_==="map"?this.transform.angle:0:_==="viewport"?-this.transform.angle:0;if(E){const P=Math.sin(E),z=Math.cos(E);f=[f[0]*z-f[1]*P,f[0]*P+f[1]*z]}const A=[x?f[0]:me(c,f[0],this.transform.zoom),x?f[1]:me(c,f[1],this.transform.zoom),0],k=new Float32Array(16);return l.translate(k,r,A),k}saveTileTexture(r){const c=this._tileTextures[r.size[0]];c?c.push(r):this._tileTextures[r.size[0]]=[r]}getTileTexture(r){const c=this._tileTextures[r];return c&&c.length>0?c.pop():null}isPatternMissing(r){if(!r)return!1;if(!r.from||!r.to)return!0;const c=this.imageManager.getPattern(r.from.toString()),f=this.imageManager.getPattern(r.to.toString());return!c||!f}useProgram(r,c){this.cache=this.cache||{};const f=r+(c?c.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"")+(this.style.map.terrain?"/terrain":"");return this.cache[f]||(this.cache[f]=new kl(this.context,r,Xs[r],c,bu[r],this._showOverdrawInspector,this.style.map.terrain)),this.cache[f]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const r=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(r.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new xe(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}}class jl{constructor(r,c){this.points=r,this.planes=c}static fromInvProjectionMatrix(r,c,f){const _=Math.pow(2,f),x=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(A=>{const k=1/(A=l.transformMat4([],A,r))[3]/c*_;return l.mul$1(A,A,[k,k,1/A[3],k])}),E=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(A=>{const k=function(G,ee){var K=ee[0],J=ee[1],se=ee[2],ge=K*K+J*J+se*se;return ge>0&&(ge=1/Math.sqrt(ge)),G[0]=ee[0]*ge,G[1]=ee[1]*ge,G[2]=ee[2]*ge,G}([],function(G,ee,K){var J=ee[0],se=ee[1],ge=ee[2],Me=K[0],re=K[1],Pe=K[2];return G[0]=se*Pe-ge*re,G[1]=ge*Me-J*Pe,G[2]=J*re-se*Me,G}([],Ie([],x[A[0]],x[A[1]]),Ie([],x[A[2]],x[A[1]]))),P=-((z=k)[0]*(L=x[A[1]])[0]+z[1]*L[1]+z[2]*L[2]);var z,L;return k.concat(P)});return new jl(x,E)}}class fs{constructor(r,c){this.min=r,this.max=c,this.center=function(f,_,x){return f[0]=.5*_[0],f[1]=.5*_[1],f[2]=.5*_[2],f}([],function(f,_,x){return f[0]=_[0]+x[0],f[1]=_[1]+x[1],f[2]=_[2]+x[2],f}([],this.min,this.max))}quadrant(r){const c=[r%2==0,r<2],f=Be(this.min),_=Be(this.max);for(let x=0;x<c.length;x++)f[x]=c[x]?this.min[x]:this.center[x],_[x]=c[x]?this.center[x]:this.max[x];return _[2]=this.max[2],new fs(f,_)}distanceX(r){return Math.max(Math.min(this.max[0],r[0]),this.min[0])-r[0]}distanceY(r){return Math.max(Math.min(this.max[1],r[1]),this.min[1])-r[1]}intersects(r){const c=[[this.min[0],this.min[1],this.min[2],1],[this.max[0],this.min[1],this.min[2],1],[this.max[0],this.max[1],this.min[2],1],[this.min[0],this.max[1],this.min[2],1],[this.min[0],this.min[1],this.max[2],1],[this.max[0],this.min[1],this.max[2],1],[this.max[0],this.max[1],this.max[2],1],[this.min[0],this.max[1],this.max[2],1]];let f=!0;for(let _=0;_<r.planes.length;_++){const x=r.planes[_];let E=0;for(let A=0;A<c.length;A++)l.dot(x,c[A])>=0&&E++;if(E===0)return 0;E!==c.length&&(f=!1)}if(f)return 2;for(let _=0;_<3;_++){let x=Number.MAX_VALUE,E=-Number.MAX_VALUE;for(let A=0;A<r.points.length;A++){const k=r.points[A][_]-this.min[_];x=Math.min(x,k),E=Math.max(E,k)}if(E<0||x>this.max[_]-this.min[_])return 0}return 1}}class Gl{constructor(r=0,c=0,f=0,_=0){if(isNaN(r)||r<0||isNaN(c)||c<0||isNaN(f)||f<0||isNaN(_)||_<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=r,this.bottom=c,this.left=f,this.right=_}interpolate(r,c,f){return c.top!=null&&r.top!=null&&(this.top=l.interpolate.number(r.top,c.top,f)),c.bottom!=null&&r.bottom!=null&&(this.bottom=l.interpolate.number(r.bottom,c.bottom,f)),c.left!=null&&r.left!=null&&(this.left=l.interpolate.number(r.left,c.left,f)),c.right!=null&&r.right!=null&&(this.right=l.interpolate.number(r.right,c.right,f)),this}getCenter(r,c){const f=l.clamp((this.left+r-this.right)/2,0,r),_=l.clamp((this.top+c-this.bottom)/2,0,c);return new l.Point(f,_)}equals(r){return this.top===r.top&&this.bottom===r.bottom&&this.left===r.left&&this.right===r.right}clone(){return new Gl(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}class ql{constructor(r,c,f,_,x){this.tileSize=512,this.maxValidLatitude=85.051129,this.freezeElevation=!1,this._renderWorldCopies=x===void 0||!!x,this._minZoom=r||0,this._maxZoom=c||22,this._minPitch=f??0,this._maxPitch=_??60,this.setMaxBounds(),this.width=0,this.height=0,this._center=new l.LngLat(0,0),this._elevation=0,this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new Gl,this._posMatrixCache={},this._alignedPosMatrixCache={}}clone(){const r=new ql(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return r.apply(this),r}apply(r){this.tileSize=r.tileSize,this.latRange=r.latRange,this.width=r.width,this.height=r.height,this._center=r._center,this._elevation=r._elevation,this.zoom=r.zoom,this.angle=r.angle,this._fov=r._fov,this._pitch=r._pitch,this._unmodified=r._unmodified,this._edgeInsets=r._edgeInsets.clone(),this._calcMatrices()}get minZoom(){return this._minZoom}set minZoom(r){this._minZoom!==r&&(this._minZoom=r,this.zoom=Math.max(this.zoom,r))}get maxZoom(){return this._maxZoom}set maxZoom(r){this._maxZoom!==r&&(this._maxZoom=r,this.zoom=Math.min(this.zoom,r))}get minPitch(){return this._minPitch}set minPitch(r){this._minPitch!==r&&(this._minPitch=r,this.pitch=Math.max(this.pitch,r))}get maxPitch(){return this._maxPitch}set maxPitch(r){this._maxPitch!==r&&(this._maxPitch=r,this.pitch=Math.min(this.pitch,r))}get renderWorldCopies(){return this._renderWorldCopies}set renderWorldCopies(r){r===void 0?r=!0:r===null&&(r=!1),this._renderWorldCopies=r}get worldSize(){return this.tileSize*this.scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new l.Point(this.width,this.height)}get bearing(){return-this.angle/Math.PI*180}set bearing(r){const c=-l.wrap(r,-180,180)*Math.PI/180;this.angle!==c&&(this._unmodified=!1,this.angle=c,this._calcMatrices(),this.rotationMatrix=function(){var f=new l.ARRAY_TYPE(4);return l.ARRAY_TYPE!=Float32Array&&(f[1]=0,f[2]=0),f[0]=1,f[3]=1,f}(),function(f,_,x){var E=_[0],A=_[1],k=_[2],P=_[3],z=Math.sin(x),L=Math.cos(x);f[0]=E*L+k*z,f[1]=A*L+P*z,f[2]=E*-z+k*L,f[3]=A*-z+P*L}(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(r){const c=l.clamp(r,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==c&&(this._unmodified=!1,this._pitch=c,this._calcMatrices())}get fov(){return this._fov/Math.PI*180}set fov(r){r=Math.max(.01,Math.min(60,r)),this._fov!==r&&(this._unmodified=!1,this._fov=r/180*Math.PI,this._calcMatrices())}get zoom(){return this._zoom}set zoom(r){const c=Math.min(Math.max(r,this.minZoom),this.maxZoom);this._zoom!==c&&(this._unmodified=!1,this._zoom=c,this.tileZoom=Math.max(0,Math.floor(c)),this.scale=this.zoomScale(c),this._constrain(),this._calcMatrices())}get center(){return this._center}set center(r){r.lat===this._center.lat&&r.lng===this._center.lng||(this._unmodified=!1,this._center=r,this._constrain(),this._calcMatrices())}get elevation(){return this._elevation}set elevation(r){r!==this._elevation&&(this._elevation=r,this._constrain(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}set padding(r){this._edgeInsets.equals(r)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,r,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}isPaddingEqual(r){return this._edgeInsets.equals(r)}interpolatePadding(r,c,f){this._unmodified=!1,this._edgeInsets.interpolate(r,c,f),this._constrain(),this._calcMatrices()}coveringZoomLevel(r){const c=(r.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/r.tileSize));return Math.max(0,c)}getVisibleUnwrappedCoordinates(r){const c=[new l.UnwrappedTileID(0,r)];if(this._renderWorldCopies){const f=this.pointCoordinate(new l.Point(0,0)),_=this.pointCoordinate(new l.Point(this.width,0)),x=this.pointCoordinate(new l.Point(this.width,this.height)),E=this.pointCoordinate(new l.Point(0,this.height)),A=Math.floor(Math.min(f.x,_.x,x.x,E.x)),k=Math.floor(Math.max(f.x,_.x,x.x,E.x)),P=1;for(let z=A-P;z<=k+P;z++)z!==0&&c.push(new l.UnwrappedTileID(z,r))}return c}coveringTiles(r){var c,f;let _=this.coveringZoomLevel(r);const x=_;if(r.minzoom!==void 0&&_<r.minzoom)return[];r.maxzoom!==void 0&&_>r.maxzoom&&(_=r.maxzoom);const E=this.pointCoordinate(this.getCameraPoint()),A=l.MercatorCoordinate.fromLngLat(this.center),k=Math.pow(2,_),P=[k*E.x,k*E.y,0],z=[k*A.x,k*A.y,0],L=jl.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,_);let G=r.minzoom||0;!r.terrain&&this.pitch<=60&&this._edgeInsets.top<.1&&(G=_);const ee=r.terrain?2/Math.min(this.tileSize,r.tileSize)*this.tileSize:3,K=re=>({aabb:new fs([re*k,0,0],[(re+1)*k,k,0]),zoom:0,x:0,y:0,wrap:re,fullyVisible:!1}),J=[],se=[],ge=_,Me=r.reparseOverscaled?x:_;if(this._renderWorldCopies)for(let re=1;re<=3;re++)J.push(K(-re)),J.push(K(re));for(J.push(K(0));J.length>0;){const re=J.pop(),Pe=re.x,Fe=re.y;let Qe=re.fullyVisible;if(!Qe){const Ut=re.aabb.intersects(L);if(Ut===0)continue;Qe=Ut===2}const ot=r.terrain?P:z,ht=re.aabb.distanceX(ot),it=re.aabb.distanceY(ot),St=Math.max(Math.abs(ht),Math.abs(it));if(re.zoom===ge||St>ee+(1<<ge-re.zoom)-2&&re.zoom>=G){const Ut=ge-re.zoom,Qt=P[0]-.5-(Pe<<Ut),gt=P[1]-.5-(Fe<<Ut);se.push({tileID:new l.OverscaledTileID(re.zoom===ge?Me:re.zoom,re.wrap,re.zoom,Pe,Fe),distanceSq:U([z[0]-.5-Pe,z[1]-.5-Fe]),tileDistanceToCamera:Math.sqrt(Qt*Qt+gt*gt)})}else for(let Ut=0;Ut<4;Ut++){const Qt=(Pe<<1)+Ut%2,gt=(Fe<<1)+(Ut>>1),Wt=re.zoom+1;let Et=re.aabb.quadrant(Ut);if(r.terrain){const xn=new l.OverscaledTileID(Wt,re.wrap,Wt,Qt,gt),di=r.terrain.getMinMaxElevation(xn),bn=(c=di.minElevation)!==null&&c!==void 0?c:this.elevation,nn=(f=di.maxElevation)!==null&&f!==void 0?f:this.elevation;Et=new fs([Et.min[0],Et.min[1],bn],[Et.max[0],Et.max[1],nn])}J.push({aabb:Et,zoom:Wt,x:Qt,y:gt,wrap:re.wrap,fullyVisible:Qe})}}return se.sort((re,Pe)=>re.distanceSq-Pe.distanceSq).map(re=>re.tileID)}resize(r,c){this.width=r,this.height=c,this.pixelsToGLUnits=[2/r,-2/c],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(r){return Math.pow(2,r)}scaleZoom(r){return Math.log(r)/Math.LN2}project(r){const c=l.clamp(r.lat,-this.maxValidLatitude,this.maxValidLatitude);return new l.Point(l.mercatorXfromLng(r.lng)*this.worldSize,l.mercatorYfromLat(c)*this.worldSize)}unproject(r){return new l.MercatorCoordinate(r.x/this.worldSize,r.y/this.worldSize).toLngLat()}get point(){return this.project(this.center)}updateElevation(r){this.freezeElevation||(this.elevation=r?this.getElevation(this._center,r):0)}getElevation(r,c){const f=l.MercatorCoordinate.fromLngLat(r.wrap()),_=(1<<this.tileZoom)*l.EXTENT,x=f.x*_,E=f.y*_,A=Math.floor(x/l.EXTENT),k=Math.floor(E/l.EXTENT),P=new l.OverscaledTileID(this.tileZoom,0,this.tileZoom,A,k);return c.getElevation(P,x%l.EXTENT,E%l.EXTENT,l.EXTENT)}getCameraPosition(){return{lngLat:this.pointLocation(this.getCameraPoint()),altitude:Math.cos(this._pitch)*this.cameraToCenterDistance/this._pixelPerMeter+this.elevation}}recalculateZoom(r){const c=this.pointLocation(this.centerPoint,r),f=this.getElevation(c,r);if(!(this.elevation-f))return;const _=this.getCameraPosition(),x=l.MercatorCoordinate.fromLngLat(_.lngLat,_.altitude),E=l.MercatorCoordinate.fromLngLat(c,f),A=x.x-E.x,k=x.y-E.y,P=x.z-E.z,z=Math.sqrt(A*A+k*k+P*P),L=this.scaleZoom(this.cameraToCenterDistance/z/this.tileSize);this._elevation=f,this._center=c,this.zoom=L}setLocationAtPoint(r,c){const f=this.pointCoordinate(c),_=this.pointCoordinate(this.centerPoint),x=this.locationCoordinate(r),E=new l.MercatorCoordinate(x.x-(f.x-_.x),x.y-(f.y-_.y));this.center=this.coordinateLocation(E),this._renderWorldCopies&&(this.center=this.center.wrap())}locationPoint(r,c){return c?this.coordinatePoint(this.locationCoordinate(r),this.getElevation(r,c),this.pixelMatrix3D):this.coordinatePoint(this.locationCoordinate(r))}pointLocation(r,c){return this.coordinateLocation(this.pointCoordinate(r,c))}locationCoordinate(r){return l.MercatorCoordinate.fromLngLat(r)}coordinateLocation(r){return r&&r.toLngLat()}pointCoordinate(r,c){if(c){const G=c.pointCoordinate(r);if(G!=null)return G}const f=[r.x,r.y,0,1],_=[r.x,r.y,1,1];l.transformMat4(f,f,this.pixelMatrixInverse),l.transformMat4(_,_,this.pixelMatrixInverse);const x=f[3],E=_[3],A=f[1]/x,k=_[1]/E,P=f[2]/x,z=_[2]/E,L=P===z?0:(0-P)/(z-P);return new l.MercatorCoordinate(l.interpolate.number(f[0]/x,_[0]/E,L)/this.worldSize,l.interpolate.number(A,k,L)/this.worldSize)}coordinatePoint(r,c=0,f=this.pixelMatrix){const _=[r.x*this.worldSize,r.y*this.worldSize,c,1];return l.transformMat4(_,_,f),new l.Point(_[0]/_[3],_[1]/_[3])}getBounds(){const r=Math.max(0,this.height/2-this.getHorizon());return new Lt().extend(this.pointLocation(new l.Point(0,r))).extend(this.pointLocation(new l.Point(this.width,r))).extend(this.pointLocation(new l.Point(this.width,this.height))).extend(this.pointLocation(new l.Point(0,this.height)))}getMaxBounds(){return this.latRange&&this.latRange.length===2&&this.lngRange&&this.lngRange.length===2?new Lt([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null}getHorizon(){return Math.tan(Math.PI/2-this._pitch)*this.cameraToCenterDistance*.85}setMaxBounds(r){r?(this.lngRange=[r.getWest(),r.getEast()],this.latRange=[r.getSouth(),r.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])}calculatePosMatrix(r,c=!1){const f=r.key,_=c?this._alignedPosMatrixCache:this._posMatrixCache;if(_[f])return _[f];const x=r.canonical,E=this.worldSize/this.zoomScale(x.z),A=x.x+Math.pow(2,x.z)*r.wrap,k=l.identity(new Float64Array(16));return l.translate(k,k,[A*E,x.y*E,0]),l.scale(k,k,[E/l.EXTENT,E/l.EXTENT,1]),l.multiply(k,c?this.alignedProjMatrix:this.projMatrix,k),_[f]=new Float32Array(k),_[f]}customLayerMatrix(){return this.mercatorMatrix.slice()}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;let r,c,f,_,x=-90,E=90,A=-180,k=180;const P=this.size,z=this._unmodified;if(this.latRange){const ee=this.latRange;x=l.mercatorYfromLat(ee[1])*this.worldSize,E=l.mercatorYfromLat(ee[0])*this.worldSize,r=E-x<P.y?P.y/(E-x):0}if(this.lngRange){const ee=this.lngRange;A=l.wrap(l.mercatorXfromLng(ee[0])*this.worldSize,0,this.worldSize),k=l.wrap(l.mercatorXfromLng(ee[1])*this.worldSize,0,this.worldSize),k<A&&(k+=this.worldSize),c=k-A<P.x?P.x/(k-A):0}const L=this.point,G=Math.max(c||0,r||0);if(G)return this.center=this.unproject(new l.Point(c?(k+A)/2:L.x,r?(E+x)/2:L.y)),this.zoom+=this.scaleZoom(G),this._unmodified=z,void(this._constraining=!1);if(this.latRange){const ee=L.y,K=P.y/2;ee-K<x&&(_=x+K),ee+K>E&&(_=E-K)}if(this.lngRange){const ee=(A+k)/2,K=l.wrap(L.x,ee-this.worldSize/2,ee+this.worldSize/2),J=P.x/2;K-J<A&&(f=A+J),K+J>k&&(f=k-J)}f===void 0&&_===void 0||(this.center=this.unproject(new l.Point(f!==void 0?f:L.x,_!==void 0?_:L.y)).wrap()),this._unmodified=z,this._constraining=!1}_calcMatrices(){if(!this.height)return;const r=this.centerOffset,c=this.point.x,f=this.point.y;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height,this._pixelPerMeter=l.mercatorZfromAltitude(1,this.center.lat)*this.worldSize;let _=l.identity(new Float64Array(16));l.scale(_,_,[this.width/2,-this.height/2,1]),l.translate(_,_,[1,-1,0]),this.labelPlaneMatrix=_,_=l.identity(new Float64Array(16)),l.scale(_,_,[1,-1,1]),l.translate(_,_,[-1,-1,0]),l.scale(_,_,[2/this.width,2/this.height,1]),this.glCoordMatrix=_,this.cameraToSeaLevelDistance=this.cameraToCenterDistance+this._elevation*this._pixelPerMeter/Math.cos(this._pitch);const x=this._elevation<0?this.cameraToCenterDistance:this.cameraToSeaLevelDistance,E=Math.PI/2+this._pitch,A=this._fov*(.5+r.y/this.height),k=Math.sin(A)*x/Math.sin(l.clamp(Math.PI-E-A,.01,Math.PI-.01)),P=this.getHorizon(),z=2*Math.atan(P/this.cameraToCenterDistance)*(.5+r.y/(2*P)),L=Math.sin(z)*x/Math.sin(l.clamp(Math.PI-E-z,.01,Math.PI-.01)),G=Math.min(k,L),ee=1.01*(Math.cos(Math.PI/2-this._pitch)*G+x),K=this.height/50;_=new Float64Array(16),l.perspective(_,this._fov,this.width/this.height,K,ee),_[8]=2*-r.x/this.width,_[9]=2*r.y/this.height,l.scale(_,_,[1,-1,1]),l.translate(_,_,[0,0,-this.cameraToCenterDistance]),l.rotateX(_,_,this._pitch),l.rotateZ(_,_,this.angle),l.translate(_,_,[-c,-f,0]),this.mercatorMatrix=l.scale([],_,[this.worldSize,this.worldSize,this.worldSize]),l.scale(_,_,[1,1,this._pixelPerMeter]),this.pixelMatrix=l.multiply(new Float64Array(16),this.labelPlaneMatrix,_),l.translate(_,_,[0,0,-this.elevation]),this.projMatrix=_,this.invProjMatrix=l.invert([],_),this.pixelMatrix3D=l.multiply(new Float64Array(16),this.labelPlaneMatrix,_);const J=this.width%2/2,se=this.height%2/2,ge=Math.cos(this.angle),Me=Math.sin(this.angle),re=c-Math.round(c)+ge*J+Me*se,Pe=f-Math.round(f)+ge*se+Me*J,Fe=new Float64Array(_);if(l.translate(Fe,Fe,[re>.5?re-1:re,Pe>.5?Pe-1:Pe,0]),this.alignedProjMatrix=Fe,_=l.invert(new Float64Array(16),this.pixelMatrix),!_)throw new Error("failed to invert matrix");this.pixelMatrixInverse=_,this._posMatrixCache={},this._alignedPosMatrixCache={}}maxPitchScaleFactor(){if(!this.pixelMatrixInverse)return 1;const r=this.pointCoordinate(new l.Point(0,0)),c=[r.x*this.worldSize,r.y*this.worldSize,0,1];return l.transformMat4(c,c,this.pixelMatrix)[3]/this.cameraToCenterDistance}getCameraPoint(){const r=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new l.Point(0,r))}getCameraQueryGeometry(r){const c=this.getCameraPoint();if(r.length===1)return[r[0],c];{let f=c.x,_=c.y,x=c.x,E=c.y;for(const A of r)f=Math.min(f,A.x),_=Math.min(_,A.y),x=Math.max(x,A.x),E=Math.max(E,A.y);return[new l.Point(f,_),new l.Point(x,_),new l.Point(x,E),new l.Point(f,E),new l.Point(f,_)]}}}class Yd{constructor(r){this._hashName=r&&encodeURIComponent(r),l.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=function(c,f){let _=!1,x=null;const E=()=>{x=null,_&&(c(),x=setTimeout(E,300),_=!1)};return()=>(_=!0,x||E(),x)}(this._updateHashUnthrottled.bind(this))}addTo(r){return this._map=r,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this}getHashString(r){const c=this._map.getCenter(),f=Math.round(100*this._map.getZoom())/100,_=Math.ceil((f*Math.LN2+Math.log(512/360/.5))/Math.LN10),x=Math.pow(10,_),E=Math.round(c.lng*x)/x,A=Math.round(c.lat*x)/x,k=this._map.getBearing(),P=this._map.getPitch();let z="";if(z+=r?`/${E}/${A}/${f}`:`${f}/${A}/${E}`,(k||P)&&(z+="/"+Math.round(10*k)/10),P&&(z+=`/${Math.round(P)}`),this._hashName){const L=this._hashName;let G=!1;const ee=window.location.hash.slice(1).split("&").map(K=>{const J=K.split("=")[0];return J===L?(G=!0,`${J}=${z}`):K}).filter(K=>K);return G||ee.push(`${L}=${z}`),`#${ee.join("&")}`}return`#${z}`}_getCurrentHash(){const r=window.location.hash.replace("#","");if(this._hashName){let c;return r.split("&").map(f=>f.split("=")).forEach(f=>{f[0]===this._hashName&&(c=f)}),(c&&c[1]||"").split("/")}return r.split("/")}_onHashChange(){const r=this._getCurrentHash();if(r.length>=3&&!r.some(c=>isNaN(c))){const c=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(r[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+r[2],+r[1]],zoom:+r[0],bearing:c,pitch:+(r[4]||0)}),!0}return!1}_updateHashUnthrottled(){const r=window.location.href.replace(/(#.+)?$/,this.getHashString());try{window.history.replaceState(window.history.state,null,r)}catch{}}}const jo={linearity:.3,easing:l.bezier(0,0,.3,1)},Xd=l.extend({deceleration:2500,maxSpeed:1400},jo),Kd=l.extend({deceleration:20,maxSpeed:1400},jo),Go=l.extend({deceleration:1e3,maxSpeed:360},jo),Jd=l.extend({deceleration:1e3,maxSpeed:90},jo);class ps{constructor(r){this._map=r,this.clear()}clear(){this._inertiaBuffer=[]}record(r){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:l.exported.now(),settings:r})}_drainInertiaBuffer(){const r=this._inertiaBuffer,c=l.exported.now();for(;r.length>0&&c-r[0].time>160;)r.shift()}_onMoveEnd(r){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const c={zoom:0,bearing:0,pitch:0,pan:new l.Point(0,0),pinchAround:void 0,around:void 0};for(const{settings:x}of this._inertiaBuffer)c.zoom+=x.zoomDelta||0,c.bearing+=x.bearingDelta||0,c.pitch+=x.pitchDelta||0,x.panDelta&&c.pan._add(x.panDelta),x.around&&(c.around=x.around),x.pinchAround&&(c.pinchAround=x.pinchAround);const f=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,_={};if(c.pan.mag()){const x=qo(c.pan.mag(),f,l.extend({},Xd,r||{}));_.offset=c.pan.mult(x.amount/c.pan.mag()),_.center=this._map.transform.center,Vr(_,x)}if(c.zoom){const x=qo(c.zoom,f,Kd);_.zoom=this._map.transform.zoom+x.amount,Vr(_,x)}if(c.bearing){const x=qo(c.bearing,f,Go);_.bearing=this._map.transform.bearing+l.clamp(x.amount,-179,179),Vr(_,x)}if(c.pitch){const x=qo(c.pitch,f,Jd);_.pitch=this._map.transform.pitch+x.amount,Vr(_,x)}if(_.zoom||_.bearing){const x=c.pinchAround===void 0?c.around:c.pinchAround;_.around=x?this._map.unproject(x):this._map.getCenter()}return this.clear(),l.extend(_,{noMoveStart:!0})}}function Vr(m,r){(!m.duration||m.duration<r.duration)&&(m.duration=r.duration,m.easing=r.easing)}function qo(m,r,c){const{maxSpeed:f,linearity:_,deceleration:x}=c,E=l.clamp(m*_/(r/1e3),-f,f),A=Math.abs(E)/(x*_);return{easing:c.easing,duration:1e3*A,amount:E*(A/2)}}class yi extends l.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(r,c,f,_={}){const x=w.mousePos(c.getCanvasContainer(),f),E=c.unproject(x);super(r,l.extend({point:x,lngLat:E,originalEvent:f},_)),this._defaultPrevented=!1,this.target=c}}class Js extends l.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(r,c,f){const _=r==="touchend"?f.changedTouches:f.touches,x=w.touchPos(c.getCanvasContainer(),_),E=x.map(k=>c.unproject(k)),A=x.reduce((k,P,z,L)=>k.add(P.div(L.length)),new l.Point(0,0));super(r,{points:x,point:A,lngLats:E,lngLat:c.unproject(A),originalEvent:f}),this._defaultPrevented=!1}}class Ym extends l.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(r,c,f){super(r,{originalEvent:f}),this._defaultPrevented=!1}}class Xm{constructor(r,c){this._map=r,this._clickTolerance=c.clickTolerance}reset(){delete this._mousedownPos}wheel(r){return this._firePreventable(new Ym(r.type,this._map,r))}mousedown(r,c){return this._mousedownPos=c,this._firePreventable(new yi(r.type,this._map,r))}mouseup(r){this._map.fire(new yi(r.type,this._map,r))}click(r,c){this._mousedownPos&&this._mousedownPos.dist(c)>=this._clickTolerance||this._map.fire(new yi(r.type,this._map,r))}dblclick(r){return this._firePreventable(new yi(r.type,this._map,r))}mouseover(r){this._map.fire(new yi(r.type,this._map,r))}mouseout(r){this._map.fire(new yi(r.type,this._map,r))}touchstart(r){return this._firePreventable(new Js(r.type,this._map,r))}touchmove(r){this._map.fire(new Js(r.type,this._map,r))}touchend(r){this._map.fire(new Js(r.type,this._map,r))}touchcancel(r){this._map.fire(new Js(r.type,this._map,r))}_firePreventable(r){if(this._map.fire(r),r.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Km{constructor(r){this._map=r}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(r){this._map.fire(new yi(r.type,this._map,r))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new yi("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(r){this._delayContextMenu?this._contextMenuEvent=r:this._ignoreContextMenu||this._map.fire(new yi(r.type,this._map,r)),this._map.listens("contextmenu")&&r.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Qa{constructor(r){this._map=r}get transform(){return this._map._requestedCameraState||this._map.transform}get center(){return{lng:this.transform.center.lng,lat:this.transform.center.lat}}get zoom(){return this.transform.zoom}get pitch(){return this.transform.pitch}get bearing(){return this.transform.bearing}unproject(r){return this.transform.pointLocation(l.Point.convert(r),this._map.terrain)}}class Ho{constructor(r,c){this._map=r,this._tr=new Qa(r),this._el=r.getCanvasContainer(),this._container=r.getContainer(),this._clickTolerance=c.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(r,c){this.isEnabled()&&r.shiftKey&&r.button===0&&(w.disableDrag(),this._startPos=this._lastPos=c,this._active=!0)}mousemoveWindow(r,c){if(!this._active)return;const f=c;if(this._lastPos.equals(f)||!this._box&&f.dist(this._startPos)<this._clickTolerance)return;const _=this._startPos;this._lastPos=f,this._box||(this._box=w.create("div","maplibregl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair"),this._fireEvent("boxzoomstart",r));const x=Math.min(_.x,f.x),E=Math.max(_.x,f.x),A=Math.min(_.y,f.y),k=Math.max(_.y,f.y);w.setTransform(this._box,`translate(${x}px,${A}px)`),this._box.style.width=E-x+"px",this._box.style.height=k-A+"px"}mouseupWindow(r,c){if(!this._active||r.button!==0)return;const f=this._startPos,_=c;if(this.reset(),w.suppressClick(),f.x!==_.x||f.y!==_.y)return this._map.fire(new l.Event("boxzoomend",{originalEvent:r})),{cameraAnimation:x=>x.fitScreenCoordinates(f,_,this._tr.bearing,{linear:!0})};this._fireEvent("boxzoomcancel",r)}keydown(r){this._active&&r.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",r))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair"),this._box&&(w.remove(this._box),this._box=null),w.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(r,c){return this._map.fire(new l.Event(r,{originalEvent:c}))}}function ms(m,r){if(m.length!==r.length)throw new Error(`The number of touches and points are not equal - touches ${m.length}, points ${r.length}`);const c={};for(let f=0;f<m.length;f++)c[m[f].identifier]=r[f];return c}class At{constructor(r){this.reset(),this.numTouches=r.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(r,c,f){(this.centroid||f.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=r.timeStamp),f.length===this.numTouches&&(this.centroid=function(_){const x=new l.Point(0,0);for(const E of _)x._add(E);return x.div(_.length)}(c),this.touches=ms(f,c)))}touchmove(r,c,f){if(this.aborted||!this.centroid)return;const _=ms(f,c);for(const x in this.touches){const E=_[x];(!E||E.dist(this.touches[x])>30)&&(this.aborted=!0)}}touchend(r,c,f){if((!this.centroid||r.timeStamp-this.startTime>500)&&(this.aborted=!0),f.length===0){const _=!this.aborted&&this.centroid;if(this.reset(),_)return _}}}class Hl{constructor(r){this.singleTap=new At(r),this.numTaps=r.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(r,c,f){this.singleTap.touchstart(r,c,f)}touchmove(r,c,f){this.singleTap.touchmove(r,c,f)}touchend(r,c,f){const _=this.singleTap.touchend(r,c,f);if(_){const x=r.timeStamp-this.lastTime<500,E=!this.lastTap||this.lastTap.dist(_)<30;if(x&&E||this.reset(),this.count++,this.lastTime=r.timeStamp,this.lastTap=_,this.count===this.numTaps)return this.reset(),_}}}class Wo{constructor(r){this._tr=new Qa(r),this._zoomIn=new Hl({numTouches:1,numTaps:2}),this._zoomOut=new Hl({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(r,c,f){this._zoomIn.touchstart(r,c,f),this._zoomOut.touchstart(r,c,f)}touchmove(r,c,f){this._zoomIn.touchmove(r,c,f),this._zoomOut.touchmove(r,c,f)}touchend(r,c,f){const _=this._zoomIn.touchend(r,c,f),x=this._zoomOut.touchend(r,c,f),E=this._tr;return _?(this._active=!0,r.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:A=>A.easeTo({duration:300,zoom:E.zoom+1,around:E.unproject(_)},{originalEvent:r})}):x?(this._active=!0,r.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:A=>A.easeTo({duration:300,zoom:E.zoom-1,around:E.unproject(x)},{originalEvent:r})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Rs{constructor(r){this._enabled=!!r.enable,this._moveStateManager=r.moveStateManager,this._clickTolerance=r.clickTolerance||1,this._moveFunction=r.move,this._activateOnStart=!!r.activateOnStart,r.assignEvents(this),this.reset()}reset(r){this._active=!1,this._moved=!1,delete this._lastPoint,this._moveStateManager.endMove(r)}_move(...r){const c=this._moveFunction(...r);if(c.bearingDelta||c.pitchDelta||c.around||c.panDelta)return this._active=!0,c}dragStart(r,c){this.isEnabled()&&!this._lastPoint&&this._moveStateManager.isValidStartEvent(r)&&(this._moveStateManager.startMove(r),this._lastPoint=c.length?c[0]:c,this._activateOnStart&&this._lastPoint&&(this._active=!0))}dragMove(r,c){if(!this.isEnabled())return;const f=this._lastPoint;if(!f)return;if(r.preventDefault(),!this._moveStateManager.isValidMoveEvent(r))return void this.reset(r);const _=c.length?c[0]:c;return!this._moved&&_.dist(f)<this._clickTolerance?void 0:(this._moved=!0,this._lastPoint=_,this._move(f,_))}dragEnd(r){this.isEnabled()&&this._lastPoint&&this._moveStateManager.isValidEndEvent(r)&&(this._moved&&w.suppressClick(),this.reset(r))}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}getClickTolerance(){return this._clickTolerance}}const Qd={0:1,2:2};class vt{constructor(r){this._correctEvent=r.checkCorrectEvent}startMove(r){const c=w.mouseButton(r);this._eventButton=c}endMove(r){delete this._eventButton}isValidStartEvent(r){return this._correctEvent(r)}isValidMoveEvent(r){return!function(c,f){const _=Qd[f];return c.buttons===void 0||(c.buttons&_)!==_}(r,this._eventButton)}isValidEndEvent(r){return w.mouseButton(r)===this._eventButton}}class Wl{constructor(){this._firstTouch=void 0}_isOneFingerTouch(r){return r.targetTouches.length===1}_isSameTouchEvent(r){return r.targetTouches[0].identifier===this._firstTouch}startMove(r){this._firstTouch=r.targetTouches[0].identifier}endMove(r){delete this._firstTouch}isValidStartEvent(r){return this._isOneFingerTouch(r)}isValidMoveEvent(r){return this._isOneFingerTouch(r)&&this._isSameTouchEvent(r)}isValidEndEvent(r){return this._isOneFingerTouch(r)&&this._isSameTouchEvent(r)}}const Fu=m=>{m.mousedown=m.dragStart,m.mousemoveWindow=m.dragMove,m.mouseup=m.dragEnd,m.contextmenu=function(r){r.preventDefault()}},ef=({enable:m,clickTolerance:r,bearingDegreesPerPixelMoved:c=.8})=>{const f=new vt({checkCorrectEvent:_=>w.mouseButton(_)===0&&_.ctrlKey||w.mouseButton(_)===2});return new Rs({clickTolerance:r,move:(_,x)=>({bearingDelta:(x.x-_.x)*c}),moveStateManager:f,enable:m,assignEvents:Fu})},Zl=({enable:m,clickTolerance:r,pitchDegreesPerPixelMoved:c=-.5})=>{const f=new vt({checkCorrectEvent:_=>w.mouseButton(_)===0&&_.ctrlKey||w.mouseButton(_)===2});return new Rs({clickTolerance:r,move:(_,x)=>({pitchDelta:(x.y-_.y)*c}),moveStateManager:f,enable:m,assignEvents:Fu})};class tf{constructor(r,c){this._minTouches=r.cooperativeGestures?2:1,this._clickTolerance=r.clickTolerance||1,this._map=c,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new l.Point(0,0),setTimeout(()=>{this._cancelCooperativeMessage=!1},200)}touchstart(r,c,f){return this._calculateTransform(r,c,f)}touchmove(r,c,f){if(this._map._cooperativeGestures&&(this._minTouches===2&&f.length<2&&!this._cancelCooperativeMessage?this._map._onCooperativeGesture(r,!1,f.length):this._cancelCooperativeMessage||(this._cancelCooperativeMessage=!0)),this._active&&!(f.length<this._minTouches))return r.preventDefault(),this._calculateTransform(r,c,f)}touchend(r,c,f){this._calculateTransform(r,c,f),this._active&&f.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(r,c,f){f.length>0&&(this._active=!0);const _=ms(f,c),x=new l.Point(0,0),E=new l.Point(0,0);let A=0;for(const P in _){const z=_[P],L=this._touches[P];L&&(x._add(z),E._add(z.sub(L)),A++,_[P]=z)}if(this._touches=_,A<this._minTouches||!E.mag())return;const k=E.div(A);return this._sum._add(k),this._sum.mag()<this._clickTolerance?void 0:{around:x.div(A),panDelta:k}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Yl{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}_start(r){}_move(r,c,f){return{}}touchstart(r,c,f){this._firstTwoTouches||f.length<2||(this._firstTwoTouches=[f[0].identifier,f[1].identifier],this._start([c[0],c[1]]))}touchmove(r,c,f){if(!this._firstTwoTouches)return;r.preventDefault();const[_,x]=this._firstTwoTouches,E=Xl(f,c,_),A=Xl(f,c,x);if(!E||!A)return;const k=this._aroundCenter?null:E.add(A).div(2);return this._move([E,A],k,r)}touchend(r,c,f){if(!this._firstTwoTouches)return;const[_,x]=this._firstTwoTouches,E=Xl(f,c,_),A=Xl(f,c,x);E&&A||(this._active&&w.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(r){this._enabled=!0,this._aroundCenter=!!r&&r.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function Xl(m,r,c){for(let f=0;f<m.length;f++)if(m[f].identifier===c)return r[f]}function nf(m,r){return Math.log(m/r)/Math.LN2}class Nu extends Yl{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(r){this._startDistance=this._distance=r[0].dist(r[1])}_move(r,c){const f=this._distance;if(this._distance=r[0].dist(r[1]),this._active||!(Math.abs(nf(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:nf(this._distance,f),pinchAround:c}}}function Kl(m,r){return 180*m.angleWith(r)/Math.PI}class Uu extends Yl{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(r){this._startVector=this._vector=r[0].sub(r[1]),this._minDiameter=r[0].dist(r[1])}_move(r,c){const f=this._vector;if(this._vector=r[0].sub(r[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:Kl(this._vector,f),pinchAround:c}}_isBelowThreshold(r){this._minDiameter=Math.min(this._minDiameter,r.mag());const c=25/(Math.PI*this._minDiameter)*360,f=Kl(r,this._startVector);return Math.abs(f)<c}}function Zo(m){return Math.abs(m.y)>Math.abs(m.x)}class hr extends Yl{constructor(r){super(),this._map=r}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(r,c,f){super.touchstart(r,c,f),this._currentTouchCount=f.length}_start(r){this._lastPoints=r,Zo(r[0].sub(r[1]))&&(this._valid=!1)}_move(r,c,f){if(this._map._cooperativeGestures&&this._currentTouchCount<3)return;const _=r[0].sub(this._lastPoints[0]),x=r[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(_,x,f.timeStamp),this._valid?(this._lastPoints=r,this._active=!0,{pitchDelta:(_.y+x.y)/2*-.5}):void 0}gestureBeginsVertically(r,c,f){if(this._valid!==void 0)return this._valid;const _=r.mag()>=2,x=c.mag()>=2;if(!_&&!x)return;if(!_||!x)return this._firstMove===void 0&&(this._firstMove=f),f-this._firstMove<100&&void 0;const E=r.y>0==c.y>0;return Zo(r)&&Zo(c)&&E}}const Qs={panStep:100,bearingStep:15,pitchStep:10};class rf{constructor(r){this._tr=new Qa(r);const c=Qs;this._panStep=c.panStep,this._bearingStep=c.bearingStep,this._pitchStep=c.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(r){if(r.altKey||r.ctrlKey||r.metaKey)return;let c=0,f=0,_=0,x=0,E=0;switch(r.keyCode){case 61:case 107:case 171:case 187:c=1;break;case 189:case 109:case 173:c=-1;break;case 37:r.shiftKey?f=-1:(r.preventDefault(),x=-1);break;case 39:r.shiftKey?f=1:(r.preventDefault(),x=1);break;case 38:r.shiftKey?_=1:(r.preventDefault(),E=-1);break;case 40:r.shiftKey?_=-1:(r.preventDefault(),E=1);break;default:return}return this._rotationDisabled&&(f=0,_=0),{cameraAnimation:A=>{const k=this._tr;A.easeTo({duration:300,easeId:"keyboardHandler",easing:$u,zoom:c?Math.round(k.zoom)+c*(r.shiftKey?2:1):k.zoom,bearing:k.bearing+f*this._bearingStep,pitch:k.pitch+_*this._pitchStep,offset:[-x*this._panStep,-E*this._panStep],center:k.center},{originalEvent:r})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function $u(m){return m*(2-m)}const Jl=4.000244140625;class Vu{constructor(r,c){this._map=r,this._tr=new Qa(r),this._el=r.getCanvasContainer(),this._handler=c,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222,l.bindAll(["_onTimeout"],this)}setZoomRate(r){this._defaultZoomRate=r}setWheelZoomRate(r){this._wheelZoomRate=r}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(r){this.isEnabled()||(this._enabled=!0,this._aroundCenter=r&&r.around==="center")}disable(){this.isEnabled()&&(this._enabled=!1)}wheel(r){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!r[this._map._metaKey])return;r.preventDefault()}let c=r.deltaMode===WheelEvent.DOM_DELTA_LINE?40*r.deltaY:r.deltaY;const f=l.exported.now(),_=f-(this._lastWheelEventTime||0);this._lastWheelEventTime=f,c!==0&&c%Jl==0?this._type="wheel":c!==0&&Math.abs(c)<4?this._type="trackpad":_>400?(this._type=null,this._lastValue=c,this._timeout=setTimeout(this._onTimeout,40,r)):this._type||(this._type=Math.abs(_*c)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,c+=this._lastValue)),r.shiftKey&&c&&(c/=4),this._type&&(this._lastWheelEvent=r,this._delta-=c,this._active||this._start(r)),r.preventDefault()}_onTimeout(r){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(r)}_start(r){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const c=w.mousePos(this._el,r),f=this._tr;this._around=l.LngLat.convert(this._aroundCenter?f.center:f.unproject(c)),this._aroundPoint=f.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const r=this._tr.transform;if(this._delta!==0){const A=this._type==="wheel"&&Math.abs(this._delta)>Jl?this._wheelZoomRate:this._defaultZoomRate;let k=2/(1+Math.exp(-Math.abs(this._delta*A)));this._delta<0&&k!==0&&(k=1/k);const P=typeof this._targetZoom=="number"?r.zoomScale(this._targetZoom):r.scale;this._targetZoom=Math.min(r.maxZoom,Math.max(r.minZoom,r.scaleZoom(P*k))),this._type==="wheel"&&(this._startZoom=r.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}const c=typeof this._targetZoom=="number"?this._targetZoom:r.zoom,f=this._startZoom,_=this._easing;let x,E=!1;if(this._type==="wheel"&&f&&_){const A=Math.min((l.exported.now()-this._lastWheelEventTime)/200,1),k=_(A);x=l.interpolate.number(f,c,k),A<1?this._frameId||(this._frameId=!0):E=!0}else x=c,E=!0;return this._active=!0,E&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!E,zoomDelta:x-r.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(r){let c=l.ease;if(this._prevEase){const f=this._prevEase,_=(l.exported.now()-f.start)/f.duration,x=f.easing(_+.01)-f.easing(_),E=.27/Math.sqrt(x*x+1e-4)*.01,A=Math.sqrt(.0729-E*E);c=l.bezier(E,A,.25,1)}return this._prevEase={start:l.exported.now(),duration:r,easing:c},c}reset(){this._active=!1}}class sf{constructor(r,c){this._clickZoom=r,this._tapZoom=c}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class jr{constructor(r){this._tr=new Qa(r),this.reset()}reset(){this._active=!1}dblclick(r,c){return r.preventDefault(),{cameraAnimation:f=>{f.easeTo({duration:300,zoom:this._tr.zoom+(r.shiftKey?-1:1),around:this._tr.unproject(c)},{originalEvent:r})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Wn{constructor(){this._tap=new Hl({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,this._tap.reset()}touchstart(r,c,f){this._swipePoint||(this._tapTime&&r.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?f.length>0&&(this._swipePoint=c[0],this._swipeTouch=f[0].identifier):this._tap.touchstart(r,c,f))}touchmove(r,c,f){if(this._tapTime){if(this._swipePoint){if(f[0].identifier!==this._swipeTouch)return;const _=c[0],x=_.y-this._swipePoint.y;return this._swipePoint=_,r.preventDefault(),this._active=!0,{zoomDelta:x/128}}}else this._tap.touchmove(r,c,f)}touchend(r,c,f){this._tapTime?this._swipePoint&&f.length===0&&this.reset():this._tap.touchend(r,c,f)&&(this._tapTime=r.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Ql{constructor(r,c,f){this._el=r,this._mousePan=c,this._touchPan=f}enable(r){this._inertiaOptions=r||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class ju{constructor(r,c,f){this._pitchWithRotate=r.pitchWithRotate,this._mouseRotate=c,this._mousePitch=f}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class af{constructor(r,c,f,_){this._el=r,this._touchZoom=c,this._touchRotate=f,this._tapDragZoom=_,this._rotationDisabled=!1,this._enabled=!0}enable(r){this._touchZoom.enable(r),this._rotationDisabled||this._touchRotate.enable(r),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const Yo=m=>m.zoom||m.drag||m.pitch||m.rotate;class of extends l.Event{}function Gu(m){return m.panDelta&&m.panDelta.mag()||m.zoomDelta||m.bearingDelta||m.pitchDelta}class gs{constructor(r,c){this._map=r,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new ps(r),this._bearingSnap=c.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(c),l.bindAll(["handleEvent","handleWindowEvent"],this);const f=this._el;this._listeners=[[f,"touchstart",{passive:!0}],[f,"touchmove",{passive:!1}],[f,"touchend",void 0],[f,"touchcancel",void 0],[f,"mousedown",void 0],[f,"mousemove",void 0],[f,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[f,"mouseover",void 0],[f,"mouseout",void 0],[f,"dblclick",void 0],[f,"click",void 0],[f,"keydown",{capture:!1}],[f,"keyup",void 0],[f,"wheel",{passive:!1}],[f,"contextmenu",void 0],[window,"blur",void 0]];for(const[_,x,E]of this._listeners)w.addEventListener(_,x,_===document?this.handleWindowEvent:this.handleEvent,E)}destroy(){for(const[r,c,f]of this._listeners)w.removeEventListener(r,c,r===document?this.handleWindowEvent:this.handleEvent,f)}_addDefaultHandlers(r){const c=this._map,f=c.getCanvasContainer();this._add("mapEvent",new Xm(c,r));const _=c.boxZoom=new Ho(c,r);this._add("boxZoom",_);const x=new Wo(c),E=new jr(c);c.doubleClickZoom=new sf(E,x),this._add("tapZoom",x),this._add("clickZoom",E);const A=new Wn;this._add("tapDragZoom",A);const k=c.touchPitch=new hr(c);this._add("touchPitch",k);const P=ef(r),z=Zl(r);c.dragRotate=new ju(r,P,z),this._add("mouseRotate",P,["mousePitch"]),this._add("mousePitch",z,["mouseRotate"]);const L=(({enable:ge,clickTolerance:Me})=>{const re=new vt({checkCorrectEvent:Pe=>w.mouseButton(Pe)===0&&!Pe.ctrlKey});return new Rs({clickTolerance:Me,move:(Pe,Fe)=>({around:Fe,panDelta:Fe.sub(Pe)}),activateOnStart:!0,moveStateManager:re,enable:ge,assignEvents:Fu})})(r),G=new tf(r,c);c.dragPan=new Ql(f,L,G),this._add("mousePan",L),this._add("touchPan",G,["touchZoom","touchRotate"]);const ee=new Uu,K=new Nu;c.touchZoomRotate=new af(f,K,ee,A),this._add("touchRotate",ee,["touchPan","touchZoom"]),this._add("touchZoom",K,["touchPan","touchRotate"]);const J=c.scrollZoom=new Vu(c,this);this._add("scrollZoom",J,["mousePan"]);const se=c.keyboard=new rf(c);this._add("keyboard",se),this._add("blockableMapEvent",new Km(c));for(const ge of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])r.interactive&&r[ge]&&c[ge].enable(r[ge])}_add(r,c,f){this._handlers.push({handlerName:r,handler:c,allowed:f}),this._handlersById[r]=c}stop(r){if(!this._updatingCamera){for(const{handler:c}of this._handlers)c.reset();this._inertia.clear(),this._fireEvents({},{},r),this._changes=[]}}isActive(){for(const{handler:r}of this._handlers)if(r.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!Yo(this._eventsInProgress)||this.isZooming()}_blockedByActive(r,c,f){for(const _ in r)if(_!==f&&(!c||c.indexOf(_)<0))return!0;return!1}handleWindowEvent(r){this.handleEvent(r,`${r.type}Window`)}_getMapTouches(r){const c=[];for(const f of r)this._el.contains(f.target)&&c.push(f);return c}handleEvent(r,c){if(r.type==="blur")return void this.stop(!0);this._updatingCamera=!0;const f=r.type==="renderFrame"?void 0:r,_={needsRenderFrame:!1},x={},E={},A=r.touches,k=A?this._getMapTouches(A):void 0,P=k?w.touchPos(this._el,k):w.mousePos(this._el,r);for(const{handlerName:G,handler:ee,allowed:K}of this._handlers){if(!ee.isEnabled())continue;let J;this._blockedByActive(E,K,G)?ee.reset():ee[c||r.type]&&(J=ee[c||r.type](r,P,k),this.mergeHandlerResult(_,x,J,G,f),J&&J.needsRenderFrame&&this._triggerRenderFrame()),(J||ee.isActive())&&(E[G]=ee)}const z={};for(const G in this._previousActiveHandlers)E[G]||(z[G]=f);this._previousActiveHandlers=E,(Object.keys(z).length||Gu(_))&&(this._changes.push([_,x,z]),this._triggerRenderFrame()),(Object.keys(E).length||Gu(_))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:L}=_;L&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],L(this._map))}mergeHandlerResult(r,c,f,_,x){if(!f)return;l.extend(r,f);const E={handlerName:_,originalEvent:f.originalEvent||x};f.zoomDelta!==void 0&&(c.zoom=E),f.panDelta!==void 0&&(c.drag=E),f.pitchDelta!==void 0&&(c.pitch=E),f.bearingDelta!==void 0&&(c.rotate=E)}_applyChanges(){const r={},c={},f={};for(const[_,x,E]of this._changes)_.panDelta&&(r.panDelta=(r.panDelta||new l.Point(0,0))._add(_.panDelta)),_.zoomDelta&&(r.zoomDelta=(r.zoomDelta||0)+_.zoomDelta),_.bearingDelta&&(r.bearingDelta=(r.bearingDelta||0)+_.bearingDelta),_.pitchDelta&&(r.pitchDelta=(r.pitchDelta||0)+_.pitchDelta),_.around!==void 0&&(r.around=_.around),_.pinchAround!==void 0&&(r.pinchAround=_.pinchAround),_.noInertia&&(r.noInertia=_.noInertia),l.extend(c,x),l.extend(f,E);this._updateMapTransform(r,c,f),this._changes=[]}_updateMapTransform(r,c,f){const _=this._map,x=_._getTransformForUpdate(),E=_.terrain;if(!(Gu(r)||E&&this._terrainMovement))return this._fireEvents(c,f,!0);let{panDelta:A,zoomDelta:k,bearingDelta:P,pitchDelta:z,around:L,pinchAround:G}=r;G!==void 0&&(L=G),_._stop(!0),L=L||_.transform.centerPoint;const ee=x.pointLocation(A?L.sub(A):L);P&&(x.bearing+=P),z&&(x.pitch+=z),k&&(x.zoom+=k),E?this._terrainMovement||!c.drag&&!c.zoom?c.drag&&this._terrainMovement?x.center=x.pointLocation(x.centerPoint.sub(A)):x.setLocationAtPoint(ee,L):(this._terrainMovement=!0,x.freezeElevation=!0,x.setLocationAtPoint(ee,L),this._map.once("moveend",()=>{x.freezeElevation=!1,this._terrainMovement=!1,x.recalculateZoom(_.terrain)})):x.setLocationAtPoint(ee,L),_._applyUpdatedTransform(x),this._map._update(),r.noInertia||this._inertia.record(r),this._fireEvents(c,f,!0)}_fireEvents(r,c,f){const _=Yo(this._eventsInProgress),x=Yo(r),E={};for(const z in r){const{originalEvent:L}=r[z];this._eventsInProgress[z]||(E[`${z}start`]=L),this._eventsInProgress[z]=r[z]}!_&&x&&this._fireEvent("movestart",x.originalEvent);for(const z in E)this._fireEvent(z,E[z]);x&&this._fireEvent("move",x.originalEvent);for(const z in r){const{originalEvent:L}=r[z];this._fireEvent(z,L)}const A={};let k;for(const z in this._eventsInProgress){const{handlerName:L,originalEvent:G}=this._eventsInProgress[z];this._handlersById[L].isActive()||(delete this._eventsInProgress[z],k=c[L]||G,A[`${z}end`]=k)}for(const z in A)this._fireEvent(z,A[z]);const P=Yo(this._eventsInProgress);if(f&&(_||x)&&!P){this._updatingCamera=!0;const z=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),L=G=>G!==0&&-this._bearingSnap<G&&G<this._bearingSnap;z?(L(z.bearing||this._map.getBearing())&&(z.bearing=0),z.freezeElevation=!0,this._map.easeTo(z,{originalEvent:k})):(this._map.fire(new l.Event("moveend",{originalEvent:k})),L(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(r,c){this._map.fire(new l.Event(r,c?{originalEvent:c}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(r=>{delete this._frameId,this.handleEvent(new of("renderFrame",{timeStamp:r})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}const ec={extend:(m,...r)=>l.extend(m,...r),run(m){m()},logToElement(m,r=!1,c="log"){const f=window.document.getElementById(c);f&&(r&&(f.innerHTML=""),f.innerHTML+=`<br>${m}`)}};class zt extends l.Evented{constructor(r,c){super(),this._moving=!1,this._zooming=!1,this.transform=r,this._bearingSnap=c.bearingSnap,l.bindAll(["_renderFrameCallback"],this),this.on("moveend",()=>{delete this._requestedCameraState})}getCenter(){return new l.LngLat(this.transform.center.lng,this.transform.center.lat)}setCenter(r,c){return this.jumpTo({center:r},c)}panBy(r,c,f){return r=l.Point.convert(r).mult(-1),this.panTo(this.transform.center,l.extend({offset:r},c),f)}panTo(r,c,f){return this.easeTo(l.extend({center:r},c),f)}getZoom(){return this.transform.zoom}setZoom(r,c){return this.jumpTo({zoom:r},c),this}zoomTo(r,c,f){return this.easeTo(l.extend({zoom:r},c),f)}zoomIn(r,c){return this.zoomTo(this.getZoom()+1,r,c),this}zoomOut(r,c){return this.zoomTo(this.getZoom()-1,r,c),this}getBearing(){return this.transform.bearing}setBearing(r,c){return this.jumpTo({bearing:r},c),this}getPadding(){return this.transform.padding}setPadding(r,c){return this.jumpTo({padding:r},c),this}rotateTo(r,c,f){return this.easeTo(l.extend({bearing:r},c),f)}resetNorth(r,c){return this.rotateTo(0,l.extend({duration:1e3},r),c),this}resetNorthPitch(r,c){return this.easeTo(l.extend({bearing:0,pitch:0,duration:1e3},r),c),this}snapToNorth(r,c){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(r,c):this}getPitch(){return this.transform.pitch}setPitch(r,c){return this.jumpTo({pitch:r},c),this}cameraForBounds(r,c){r=Lt.convert(r);const f=c&&c.bearing||0;return this._cameraForBoxAndBearing(r.getNorthWest(),r.getSouthEast(),f,c)}_cameraForBoxAndBearing(r,c,f,_){const x={top:0,bottom:0,right:0,left:0};if(typeof(_=l.extend({padding:x,offset:[0,0],maxZoom:this.transform.maxZoom},_)).padding=="number"){const Fe=_.padding;_.padding={top:Fe,bottom:Fe,right:Fe,left:Fe}}_.padding=l.extend(x,_.padding);const E=this.transform,A=E.padding,k=E.project(l.LngLat.convert(r)),P=E.project(l.LngLat.convert(c)),z=k.rotate(-f*Math.PI/180),L=P.rotate(-f*Math.PI/180),G=new l.Point(Math.max(z.x,L.x),Math.max(z.y,L.y)),ee=new l.Point(Math.min(z.x,L.x),Math.min(z.y,L.y)),K=G.sub(ee),J=(E.width-(A.left+A.right+_.padding.left+_.padding.right))/K.x,se=(E.height-(A.top+A.bottom+_.padding.top+_.padding.bottom))/K.y;if(se<0||J<0)return void l.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.");const ge=Math.min(E.scaleZoom(E.scale*Math.min(J,se)),_.maxZoom),Me=l.Point.convert(_.offset),re=new l.Point((_.padding.left-_.padding.right)/2,(_.padding.top-_.padding.bottom)/2).rotate(f*Math.PI/180),Pe=Me.add(re).mult(E.scale/E.zoomScale(ge));return{center:E.unproject(k.add(P).div(2).sub(Pe)),zoom:ge,bearing:f}}fitBounds(r,c,f){return this._fitInternal(this.cameraForBounds(r,c),c,f)}fitScreenCoordinates(r,c,f,_,x){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(l.Point.convert(r)),this.transform.pointLocation(l.Point.convert(c)),f,_),_,x)}_fitInternal(r,c,f){return r?(delete(c=l.extend(r,c)).padding,c.linear?this.easeTo(c,f):this.flyTo(c,f)):this}jumpTo(r,c){this.stop();const f=this._getTransformForUpdate();let _=!1,x=!1,E=!1;return"zoom"in r&&f.zoom!==+r.zoom&&(_=!0,f.zoom=+r.zoom),r.center!==void 0&&(f.center=l.LngLat.convert(r.center)),"bearing"in r&&f.bearing!==+r.bearing&&(x=!0,f.bearing=+r.bearing),"pitch"in r&&f.pitch!==+r.pitch&&(E=!0,f.pitch=+r.pitch),r.padding==null||f.isPaddingEqual(r.padding)||(f.padding=r.padding),this._applyUpdatedTransform(f),this.fire(new l.Event("movestart",c)).fire(new l.Event("move",c)),_&&this.fire(new l.Event("zoomstart",c)).fire(new l.Event("zoom",c)).fire(new l.Event("zoomend",c)),x&&this.fire(new l.Event("rotatestart",c)).fire(new l.Event("rotate",c)).fire(new l.Event("rotateend",c)),E&&this.fire(new l.Event("pitchstart",c)).fire(new l.Event("pitch",c)).fire(new l.Event("pitchend",c)),this.fire(new l.Event("moveend",c))}calculateCameraOptionsFromTo(r,c,f,_=0){const x=l.MercatorCoordinate.fromLngLat(r,c),E=l.MercatorCoordinate.fromLngLat(f,_),A=E.x-x.x,k=E.y-x.y,P=E.z-x.z,z=Math.hypot(A,k,P);if(z===0)throw new Error("Can't calculate camera options with same From and To");const L=Math.hypot(A,k),G=this.transform.scaleZoom(this.transform.cameraToCenterDistance/z/this.transform.tileSize),ee=180*Math.atan2(A,-k)/Math.PI;let K=180*Math.acos(L/z)/Math.PI;return K=P<0?90-K:90+K,{center:E.toLngLat(),zoom:G,pitch:K,bearing:ee}}easeTo(r,c){this._stop(!1,r.easeId),((r=l.extend({offset:[0,0],duration:500,easing:l.ease},r)).animate===!1||!r.essential&&l.exported.prefersReducedMotion)&&(r.duration=0);const f=this._getTransformForUpdate(),_=this.getZoom(),x=this.getBearing(),E=this.getPitch(),A=this.getPadding(),k="zoom"in r?+r.zoom:_,P="bearing"in r?this._normalizeBearing(r.bearing,x):x,z="pitch"in r?+r.pitch:E,L="padding"in r?r.padding:f.padding,G=l.Point.convert(r.offset);let ee=f.centerPoint.add(G);const K=f.pointLocation(ee),J=l.LngLat.convert(r.center||K);this._normalizeCenter(J);const se=f.project(K),ge=f.project(J).sub(se),Me=f.zoomScale(k-_);let re,Pe;r.around&&(re=l.LngLat.convert(r.around),Pe=f.locationPoint(re));const Fe={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||k!==_,this._rotating=this._rotating||x!==P,this._pitching=this._pitching||z!==E,this._padding=!f.isPaddingEqual(L),this._easeId=r.easeId,this._prepareEase(c,r.noMoveStart,Fe),this.terrain&&this._prepareElevation(J),this._ease(Qe=>{if(this._zooming&&(f.zoom=l.interpolate.number(_,k,Qe)),this._rotating&&(f.bearing=l.interpolate.number(x,P,Qe)),this._pitching&&(f.pitch=l.interpolate.number(E,z,Qe)),this._padding&&(f.interpolatePadding(A,L,Qe),ee=f.centerPoint.add(G)),this.terrain&&!r.freezeElevation&&this._updateElevation(Qe),re)f.setLocationAtPoint(re,Pe);else{const ot=f.zoomScale(f.zoom-_),ht=k>_?Math.min(2,Me):Math.max(.5,Me),it=Math.pow(ht,1-Qe),St=f.unproject(se.add(ge.mult(Qe*it)).mult(ot));f.setLocationAtPoint(f.renderWorldCopies?St.wrap():St,ee)}this._applyUpdatedTransform(f),this._fireMoveEvents(c)},Qe=>{this.terrain&&this._finalizeElevation(),this._afterEase(c,Qe)},r),this}_prepareEase(r,c,f={}){this._moving=!0,c||f.moving||this.fire(new l.Event("movestart",r)),this._zooming&&!f.zooming&&this.fire(new l.Event("zoomstart",r)),this._rotating&&!f.rotating&&this.fire(new l.Event("rotatestart",r)),this._pitching&&!f.pitching&&this.fire(new l.Event("pitchstart",r))}_prepareElevation(r){this._elevationCenter=r,this._elevationStart=this.transform.elevation,this._elevationTarget=this.transform.getElevation(r,this.terrain),this.transform.freezeElevation=!0}_updateElevation(r){const c=this.transform.getElevation(this._elevationCenter,this.terrain);if(r<1&&c!==this._elevationTarget){const f=this._elevationTarget-this._elevationStart;this._elevationStart+=r*(f-(c-(f*r+this._elevationStart))/(1-r)),this._elevationTarget=c}this.transform.elevation=l.interpolate.number(this._elevationStart,this._elevationTarget,r)}_finalizeElevation(){this.transform.freezeElevation=!1,this.transform.recalculateZoom(this.terrain)}_getTransformForUpdate(){return this.transformCameraUpdate?(this._requestedCameraState||(this._requestedCameraState=this.transform.clone()),this._requestedCameraState):this.transform}_applyUpdatedTransform(r){if(!this.transformCameraUpdate)return;const c=r.clone(),{center:f,zoom:_,pitch:x,bearing:E,elevation:A}=this.transformCameraUpdate(c);f&&(c.center=f),_!==void 0&&(c.zoom=_),x!==void 0&&(c.pitch=x),E!==void 0&&(c.bearing=E),A!==void 0&&(c.elevation=A),this.transform.apply(c)}_fireMoveEvents(r){this.fire(new l.Event("move",r)),this._zooming&&this.fire(new l.Event("zoom",r)),this._rotating&&this.fire(new l.Event("rotate",r)),this._pitching&&this.fire(new l.Event("pitch",r))}_afterEase(r,c){if(this._easeId&&c&&this._easeId===c)return;delete this._easeId;const f=this._zooming,_=this._rotating,x=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,f&&this.fire(new l.Event("zoomend",r)),_&&this.fire(new l.Event("rotateend",r)),x&&this.fire(new l.Event("pitchend",r)),this.fire(new l.Event("moveend",r))}flyTo(r,c){if(!r.essential&&l.exported.prefersReducedMotion){const Et=l.pick(r,["center","zoom","bearing","pitch","around"]);return this.jumpTo(Et,c)}this.stop(),r=l.extend({offset:[0,0],speed:1.2,curve:1.42,easing:l.ease},r);const f=this._getTransformForUpdate(),_=this.getZoom(),x=this.getBearing(),E=this.getPitch(),A=this.getPadding(),k="zoom"in r?l.clamp(+r.zoom,f.minZoom,f.maxZoom):_,P="bearing"in r?this._normalizeBearing(r.bearing,x):x,z="pitch"in r?+r.pitch:E,L="padding"in r?r.padding:f.padding,G=f.zoomScale(k-_),ee=l.Point.convert(r.offset);let K=f.centerPoint.add(ee);const J=f.pointLocation(K),se=l.LngLat.convert(r.center||J);this._normalizeCenter(se);const ge=f.project(J),Me=f.project(se).sub(ge);let re=r.curve;const Pe=Math.max(f.width,f.height),Fe=Pe/G,Qe=Me.mag();if("minZoom"in r){const Et=l.clamp(Math.min(r.minZoom,_,k),f.minZoom,f.maxZoom),xn=Pe/f.zoomScale(Et-_);re=Math.sqrt(xn/Qe*2)}const ot=re*re;function ht(Et){const xn=(Fe*Fe-Pe*Pe+(Et?-1:1)*ot*ot*Qe*Qe)/(2*(Et?Fe:Pe)*ot*Qe);return Math.log(Math.sqrt(xn*xn+1)-xn)}function it(Et){return(Math.exp(Et)-Math.exp(-Et))/2}function St(Et){return(Math.exp(Et)+Math.exp(-Et))/2}const Ut=ht(0);let Qt=function(Et){return St(Ut)/St(Ut+re*Et)},gt=function(Et){return Pe*((St(Ut)*(it(xn=Ut+re*Et)/St(xn))-it(Ut))/ot)/Qe;var xn},Wt=(ht(1)-Ut)/re;if(Math.abs(Qe)<1e-6||!isFinite(Wt)){if(Math.abs(Pe-Fe)<1e-6)return this.easeTo(r,c);const Et=Fe<Pe?-1:1;Wt=Math.abs(Math.log(Fe/Pe))/re,gt=function(){return 0},Qt=function(xn){return Math.exp(Et*re*xn)}}return r.duration="duration"in r?+r.duration:1e3*Wt/("screenSpeed"in r?+r.screenSpeed/re:+r.speed),r.maxDuration&&r.duration>r.maxDuration&&(r.duration=0),this._zooming=!0,this._rotating=x!==P,this._pitching=z!==E,this._padding=!f.isPaddingEqual(L),this._prepareEase(c,!1),this.terrain&&this._prepareElevation(se),this._ease(Et=>{const xn=Et*Wt,di=1/Qt(xn);f.zoom=Et===1?k:_+f.scaleZoom(di),this._rotating&&(f.bearing=l.interpolate.number(x,P,Et)),this._pitching&&(f.pitch=l.interpolate.number(E,z,Et)),this._padding&&(f.interpolatePadding(A,L,Et),K=f.centerPoint.add(ee)),this.terrain&&!r.freezeElevation&&this._updateElevation(Et);const bn=Et===1?se:f.unproject(ge.add(Me.mult(gt(xn))).mult(di));f.setLocationAtPoint(f.renderWorldCopies?bn.wrap():bn,K),this._applyUpdatedTransform(f),this._fireMoveEvents(c)},()=>{this.terrain&&this._finalizeElevation(),this._afterEase(c)},r),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(r,c){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const f=this._onEaseEnd;delete this._onEaseEnd,f.call(this,c)}if(!r){const f=this.handlers;f&&f.stop(!1)}return this}_ease(r,c,f){f.animate===!1||f.duration===0?(r(1),c()):(this._easeStart=l.exported.now(),this._easeOptions=f,this._onEaseFrame=r,this._onEaseEnd=c,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const r=Math.min((l.exported.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(r)),r<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(r,c){r=l.wrap(r,-180,180);const f=Math.abs(r-c);return Math.abs(r-360-c)<f&&(r-=360),Math.abs(r+360-c)<f&&(r+=360),r}_normalizeCenter(r){const c=this.transform;if(!c.renderWorldCopies||c.lngRange)return;const f=r.lng-c.center.lng;r.lng+=f>180?-360:f<-180?360:0}queryTerrainElevation(r){return this.terrain?this.transform.getElevation(l.LngLat.convert(r),this.terrain)-this.transform.elevation:null}}class Ht{constructor(r={}){this.options=r,l.bindAll(["_toggleAttribution","_updateData","_updateCompact","_updateCompactMinimize"],this)}getDefaultPosition(){return"bottom-right"}onAdd(r){return this._map=r,this._compact=this.options&&this.options.compact,this._container=w.create("details","maplibregl-ctrl maplibregl-ctrl-attrib"),this._compactButton=w.create("summary","maplibregl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=w.create("div","maplibregl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){w.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(r,c){const f=this._map._getUIString(`AttributionControl.${c}`);r.title=f,r.setAttribute("aria-label",f)}_toggleAttribution(){this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show")):(this._container.classList.add("maplibregl-compact-show"),this._container.removeAttribute("open")))}_updateData(r){!r||r.sourceDataType!=="metadata"&&r.sourceDataType!=="visibility"&&r.dataType!=="style"&&r.type!=="terrain"||this._updateAttributions()}_updateAttributions(){if(!this._map.style)return;let r=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?r=r.concat(this.options.customAttribution.map(_=>typeof _!="string"?"":_)):typeof this.options.customAttribution=="string"&&r.push(this.options.customAttribution)),this._map.style.stylesheet){const _=this._map.style.stylesheet;this.styleOwner=_.owner,this.styleId=_.id}const c=this._map.style.sourceCaches;for(const _ in c){const x=c[_];if(x.used||x.usedForTerrain){const E=x.getSource();E.attribution&&r.indexOf(E.attribution)<0&&r.push(E.attribution)}}r=r.filter(_=>String(_).trim()),r.sort((_,x)=>_.length-x.length),r=r.filter((_,x)=>{for(let E=x+1;E<r.length;E++)if(r[E].indexOf(_)>=0)return!1;return!0});const f=r.join(" | ");f!==this._attribHTML&&(this._attribHTML=f,r.length?(this._innerContainer.innerHTML=f,this._container.classList.remove("maplibregl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty"),this._updateCompact(),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact===!1?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","maplibregl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show"))}_updateCompactMinimize(){this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show")}}class Xo{constructor(r={}){this.options=r,l.bindAll(["_updateCompact"],this)}getDefaultPosition(){return"bottom-left"}onAdd(r){this._map=r,this._compact=this.options&&this.options.compact,this._container=w.create("div","maplibregl-ctrl");const c=w.create("a","maplibregl-ctrl-logo");return c.target="_blank",c.rel="noopener nofollow",c.href="https://maplibre.org/",c.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),c.setAttribute("rel","noopener nofollow"),this._container.appendChild(c),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){w.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}_updateCompact(){const r=this._container.children;if(r.length){const c=r[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact!==!1&&c.classList.add("maplibregl-compact"):c.classList.remove("maplibregl-compact")}}}class qu{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(r){const c=++this._id;return this._queue.push({callback:r,id:c,cancelled:!1}),c}remove(r){const c=this._currentlyRunning,f=c?this._queue.concat(c):this._queue;for(const _ of f)if(_.id===r)return void(_.cancelled=!0)}run(r=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");const c=this._currentlyRunning=this._queue;this._queue=[];for(const f of c)if(!f.cancelled&&(f.callback(r),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}const Hu={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","TerrainControl.enableTerrain":"Enable terrain","TerrainControl.disableTerrain":"Disable terrain"};var dr=l.createLayout([{name:"a_pos3d",type:"Int16",components:3}]);class lf extends l.Evented{constructor(r){super(),this.sourceCache=r,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.deltaZoom=1,r.usedForTerrain=!0,r.tileSize=this.tileSize*2**this.deltaZoom}destruct(){this.sourceCache.usedForTerrain=!1,this.sourceCache.tileSize=null}update(r,c){this.sourceCache.update(r,c),this._renderableTilesKeys=[];const f={};for(const _ of r.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:c}))f[_.key]=!0,this._renderableTilesKeys.push(_.key),this._tiles[_.key]||(_.posMatrix=new Float64Array(16),l.ortho(_.posMatrix,0,l.EXTENT,0,l.EXTENT,0,1),this._tiles[_.key]=new ct(_,this.tileSize));for(const _ in this._tiles)f[_]||delete this._tiles[_]}freeRtt(r){for(const c in this._tiles){const f=this._tiles[c];(!r||f.tileID.equals(r)||f.tileID.isChildOf(r)||r.isChildOf(f.tileID))&&(f.rtt=[])}}getRenderableTiles(){return this._renderableTilesKeys.map(r=>this.getTileByID(r))}getTileByID(r){return this._tiles[r]}getTerrainCoords(r){const c={};for(const f of this._renderableTilesKeys){const _=this._tiles[f].tileID;if(_.canonical.equals(r.canonical)){const x=r.clone();x.posMatrix=new Float64Array(16),l.ortho(x.posMatrix,0,l.EXTENT,0,l.EXTENT,0,1),c[f]=x}else if(_.canonical.isChildOf(r.canonical)){const x=r.clone();x.posMatrix=new Float64Array(16);const E=_.canonical.z-r.canonical.z,A=_.canonical.x-(_.canonical.x>>E<<E),k=_.canonical.y-(_.canonical.y>>E<<E),P=l.EXTENT>>E;l.ortho(x.posMatrix,0,P,0,P,0,1),l.translate(x.posMatrix,x.posMatrix,[-A*P,-k*P,0]),c[f]=x}else if(r.canonical.isChildOf(_.canonical)){const x=r.clone();x.posMatrix=new Float64Array(16);const E=r.canonical.z-_.canonical.z,A=r.canonical.x-(r.canonical.x>>E<<E),k=r.canonical.y-(r.canonical.y>>E<<E),P=l.EXTENT>>E;l.ortho(x.posMatrix,0,l.EXTENT,0,l.EXTENT,0,1),l.translate(x.posMatrix,x.posMatrix,[A*P,k*P,0]),l.scale(x.posMatrix,x.posMatrix,[1/2**E,1/2**E,0]),c[f]=x}}return c}getSourceTile(r,c){const f=this.sourceCache._source;let _=r.overscaledZ-this.deltaZoom;if(_>f.maxzoom&&(_=f.maxzoom),_<f.minzoom)return null;this._sourceTileCache[r.key]||(this._sourceTileCache[r.key]=r.scaledTo(_).key);let x=this.sourceCache.getTileByID(this._sourceTileCache[r.key]);if((!x||!x.dem)&&c)for(;_>=f.minzoom&&(!x||!x.dem);)x=this.sourceCache.getTileByID(r.scaledTo(_--).key);return x}tilesAfterTime(r=Date.now()){return Object.values(this._tiles).filter(c=>c.timeAdded>=r)}}class _s{constructor(r,c,f){this.painter=r,this.sourceCache=new lf(c),this.options=f,this.exaggeration=typeof f.exaggeration=="number"?f.exaggeration:1,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024}getDEMElevation(r,c,f,_=l.EXTENT){if(!(c>=0&&c<_&&f>=0&&f<_))return 0;let x=0;const E=this.getTerrainData(r);if(E.tile&&E.tile.dem){const A=function(K,J,se){var ge=J[0],Me=J[1];return K[0]=se[0]*ge+se[4]*Me+se[12],K[1]=se[1]*ge+se[5]*Me+se[13],K}([],[c/_*l.EXTENT,f/_*l.EXTENT],E.u_terrain_matrix),k=[A[0]*E.tile.dem.dim,A[1]*E.tile.dem.dim],P=[Math.floor(k[0]),Math.floor(k[1])],z=E.tile.dem.get(P[0],P[1]),L=E.tile.dem.get(P[0],P[1]+1),G=E.tile.dem.get(P[0]+1,P[1]),ee=E.tile.dem.get(P[0]+1,P[1]+1);x=l.interpolate.number(l.interpolate.number(z,L,k[0]-P[0]),l.interpolate.number(G,ee,k[0]-P[0]),k[1]-P[1])}return x}getElevation(r,c,f,_=l.EXTENT){return this.getDEMElevation(r,c,f,_)*this.exaggeration}getTerrainData(r){if(!this._emptyDemTexture){const _=this.painter.context,x=new l.RGBAImage({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new xe(_,x,_.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new xe(_,new l.RGBAImage({width:1,height:1}),_.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(_.gl.NEAREST,_.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=l.identity([])}const c=this.sourceCache.getSourceTile(r,!0);if(c&&c.dem&&(!c.demTexture||c.needsTerrainPrepare)){const _=this.painter.context;c.demTexture=this.painter.getTileTexture(c.dem.stride),c.demTexture?c.demTexture.update(c.dem.getPixels(),{premultiply:!1}):c.demTexture=new xe(_,c.dem.getPixels(),_.gl.RGBA,{premultiply:!1}),c.demTexture.bind(_.gl.NEAREST,_.gl.CLAMP_TO_EDGE),c.needsTerrainPrepare=!1}const f=c&&c+c.tileID.key+r.key;if(f&&!this._demMatrixCache[f]){const _=this.sourceCache.sourceCache._source.maxzoom;let x=r.canonical.z-c.tileID.canonical.z;r.overscaledZ>r.canonical.z&&(r.canonical.z>=_?x=r.canonical.z-_:l.warnOnce("cannot calculate elevation if elevation maxzoom > source.maxzoom"));const E=r.canonical.x-(r.canonical.x>>x<<x),A=r.canonical.y-(r.canonical.y>>x<<x),k=l.fromScaling(new Float64Array(16),[1/(l.EXTENT<<x),1/(l.EXTENT<<x),0]);l.translate(k,k,[E*l.EXTENT,A*l.EXTENT,0]),this._demMatrixCache[r.key]={matrix:k,coord:r}}return{u_depth:2,u_terrain:3,u_terrain_dim:c&&c.dem&&c.dem.dim||1,u_terrain_matrix:f?this._demMatrixCache[r.key].matrix:this._emptyDemMatrix,u_terrain_unpack:c&&c.dem&&c.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_exaggeration:this.exaggeration,texture:(c&&c.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:c}}getFramebuffer(r){const c=this.painter,f=c.width/devicePixelRatio,_=c.height/devicePixelRatio;return!this._fbo||this._fbo.width===f&&this._fbo.height===_||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new xe(c.context,{width:f,height:_,data:null},c.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(c.context.gl.NEAREST,c.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new xe(c.context,{width:f,height:_,data:null},c.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(c.context.gl.NEAREST,c.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=c.context.createFramebuffer(f,_,!0,!1),this._fbo.depthAttachment.set(c.context.createRenderbuffer(c.context.gl.DEPTH_COMPONENT16,f,_))),this._fbo.colorAttachment.set(r==="coords"?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){const r=this.painter.context;if(this._coordsTexture)return this._coordsTexture;const c=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let x=0,E=0;x<this._coordsTextureSize;x++)for(let A=0;A<this._coordsTextureSize;A++,E+=4)c[E+0]=255&A,c[E+1]=255&x,c[E+2]=A>>8<<4|x>>8,c[E+3]=0;const f=new l.RGBAImage({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(c.buffer)),_=new xe(r,f,r.gl.RGBA,{premultiply:!1});return _.bind(r.gl.NEAREST,r.gl.CLAMP_TO_EDGE),this._coordsTexture=_,_}pointCoordinate(r){const c=new Uint8Array(4),f=this.painter.context,_=f.gl;f.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),_.readPixels(r.x,this.painter.height/devicePixelRatio-r.y-1,1,1,_.RGBA,_.UNSIGNED_BYTE,c),f.bindFramebuffer.set(null);const x=c[0]+(c[2]>>4<<8),E=c[1]+((15&c[2])<<8),A=this.coordsIndex[255-c[3]],k=A&&this.sourceCache.getTileByID(A);if(!k)return null;const P=this._coordsTextureSize,z=(1<<k.tileID.canonical.z)*P;return new l.MercatorCoordinate((k.tileID.canonical.x*P+x)/z,(k.tileID.canonical.y*P+E)/z,this.getElevation(k.tileID,x,E,P))}getTerrainMesh(){if(this._mesh)return this._mesh;const r=this.painter.context,c=new l.Pos3dArray,f=new l.TriangleIndexArray,_=this.meshSize,x=l.EXTENT/_,E=_*_;for(let L=0;L<=_;L++)for(let G=0;G<=_;G++)c.emplaceBack(G*x,L*x,0);for(let L=0;L<E;L+=_+1)for(let G=0;G<_;G++)f.emplaceBack(G+L,_+G+L+1,_+G+L+2),f.emplaceBack(G+L,_+G+L+2,G+L+1);const A=c.length,k=A+2*(_+1);for(const L of[0,1])for(let G=0;G<=_;G++)for(const ee of[0,1])c.emplaceBack(G*x,L*l.EXTENT,ee);for(let L=0;L<2*_;L+=2)f.emplaceBack(k+L,k+L+1,k+L+3),f.emplaceBack(k+L,k+L+3,k+L+2),f.emplaceBack(A+L,A+L+3,A+L+1),f.emplaceBack(A+L,A+L+2,A+L+3);const P=c.length,z=P+2*(_+1);for(const L of[0,1])for(let G=0;G<=_;G++)for(const ee of[0,1])c.emplaceBack(L*l.EXTENT,G*x,ee);for(let L=0;L<2*_;L+=2)f.emplaceBack(P+L,P+L+1,P+L+3),f.emplaceBack(P+L,P+L+3,P+L+2),f.emplaceBack(z+L,z+L+3,z+L+1),f.emplaceBack(z+L,z+L+2,z+L+3);return this._mesh={indexBuffer:r.createIndexBuffer(f),vertexBuffer:r.createVertexBuffer(c,dr.members),segments:l.SegmentVector.simpleSegment(0,0,c.length,f.length)},this._mesh}getMeshFrameDelta(r){return 2*Math.PI*l.earthRadius/Math.pow(2,r)/5}getMinMaxElevation(r){const c=this.getTerrainData(r).tile,f={minElevation:null,maxElevation:null};return c&&c.dem&&(f.minElevation=c.dem.min*this.exaggeration,f.maxElevation=c.dem.max*this.exaggeration),f}}class Jm{constructor(r,c,f){this._context=r,this._size=c,this._tileSize=f,this._objects=[],this._recentlyUsed=[],this._stamp=0}destruct(){for(const r of this._objects)r.texture.destroy(),r.fbo.destroy()}_createObject(r){const c=this._context.createFramebuffer(this._tileSize,this._tileSize,!0,!0),f=new xe(this._context,{width:this._tileSize,height:this._tileSize,data:null},this._context.gl.RGBA);return f.bind(this._context.gl.LINEAR,this._context.gl.CLAMP_TO_EDGE),c.depthAttachment.set(this._context.createRenderbuffer(this._context.gl.DEPTH_STENCIL,this._tileSize,this._tileSize)),c.colorAttachment.set(f.texture),{id:r,fbo:c,texture:f,stamp:-1,inUse:!1}}getObjectForId(r){return this._objects[r]}useObject(r){r.inUse=!0,this._recentlyUsed=this._recentlyUsed.filter(c=>r.id!==c),this._recentlyUsed.push(r.id)}stampObject(r){r.stamp=++this._stamp}getOrCreateFreeObject(){for(const c of this._recentlyUsed)if(!this._objects[c].inUse)return this._objects[c];if(this._objects.length>=this._size)throw new Error("No free RenderPool available, call freeAllObjects() required!");const r=this._createObject(this._objects.length);return this._objects.push(r),r}freeObject(r){r.inUse=!1}freeAllObjects(){for(const r of this._objects)this.freeObject(r)}isFull(){return!(this._objects.length<this._size)&&this._objects.some(r=>!r.inUse)===!1}}const Ms={background:!0,fill:!0,line:!0,raster:!0,hillshade:!0};class si{constructor(r,c){this.painter=r,this.terrain=c,this.pool=new Jm(r.context,30,c.sourceCache.tileSize*c.qualityFactor)}destruct(){this.pool.destruct()}getTexture(r){return this.pool.getObjectForId(r.rtt[this._stacks.length-1].id).texture}prepareForRender(r,c){this._stacks=[],this._prevType=null,this._rttTiles=[],this._renderableTiles=this.terrain.sourceCache.getRenderableTiles(),this._renderableLayerIds=r._order.filter(f=>!r._layers[f].isHidden(c)),this._coordsDescendingInv={};for(const f in r.sourceCaches){this._coordsDescendingInv[f]={};const _=r.sourceCaches[f].getVisibleCoordinates();for(const x of _){const E=this.terrain.sourceCache.getTerrainCoords(x);for(const A in E)this._coordsDescendingInv[f][A]||(this._coordsDescendingInv[f][A]=[]),this._coordsDescendingInv[f][A].push(E[A])}}this._coordsDescendingInvStr={};for(const f of r._order){const _=r._layers[f],x=_.source;if(Ms[_.type]&&!this._coordsDescendingInvStr[x]){this._coordsDescendingInvStr[x]={};for(const E in this._coordsDescendingInv[x])this._coordsDescendingInvStr[x][E]=this._coordsDescendingInv[x][E].map(A=>A.key).sort().join()}}for(const f of this._renderableTiles)for(const _ in this._coordsDescendingInvStr){const x=this._coordsDescendingInvStr[_][f.tileID.key];x&&x!==f.rttCoords[_]&&(f.rtt=[])}}renderLayer(r){if(r.isHidden(this.painter.transform.zoom))return!1;const c=r.type,f=this.painter,_=this._renderableLayerIds[this._renderableLayerIds.length-1]===r.id;if(Ms[c]&&(this._prevType&&Ms[this._prevType]||this._stacks.push([]),this._prevType=c,this._stacks[this._stacks.length-1].push(r.id),!_))return!0;if(Ms[this._prevType]||Ms[c]&&_){this._prevType=c;const x=this._stacks.length-1,E=this._stacks[x]||[];for(const A of this._renderableTiles){if(this.pool.isFull()&&(Ou(this.painter,this.terrain,this._rttTiles),this._rttTiles=[],this.pool.freeAllObjects()),this._rttTiles.push(A),A.rtt[x]){const P=this.pool.getObjectForId(A.rtt[x].id);if(P.stamp===A.rtt[x].stamp){this.pool.useObject(P);continue}}const k=this.pool.getOrCreateFreeObject();this.pool.useObject(k),this.pool.stampObject(k),A.rtt[x]={id:k.id,stamp:k.stamp},f.context.bindFramebuffer.set(k.fbo.framebuffer),f.context.clear({color:l.Color.transparent,stencil:0}),f.currentStencilSource=void 0;for(let P=0;P<E.length;P++){const z=f.style._layers[E[P]],L=z.source?this._coordsDescendingInv[z.source][A.tileID.key]:[A.tileID];f.context.viewport.set([0,0,k.fbo.width,k.fbo.height]),f._renderTileClippingMasks(z,L),f.renderLayer(f,f.style.sourceCaches[z.source],z,L),z.source&&(A.rttCoords[z.source]=this._coordsDescendingInvStr[z.source][A.tileID.key])}}return Ou(this.painter,this.terrain,this._rttTiles),this._rttTiles=[],this.pool.freeAllObjects(),Ms[c]}return!1}}const vi=b,cf={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:void 0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,maplibreLogo:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,maxTileCacheZoomLevels:l.config.MAX_TILE_CACHE_ZOOM_LEVELS,localIdeographFontFamily:"sans-serif",transformRequest:null,transformCameraUpdate:null,fadeDuration:300,crossSourceCollisions:!0,validateStyle:!0},eo=m=>{m.touchstart=m.dragStart,m.touchmoveWindow=m.dragMove,m.touchend=m.dragEnd},tc={showCompass:!0,showZoom:!0,visualizePitch:!1};class Wu{constructor(r,c,f=!1){this._clickTolerance=10;const _=r.dragRotate._mouseRotate.getClickTolerance(),x=r.dragRotate._mousePitch.getClickTolerance();this.element=c,this.mouseRotate=ef({clickTolerance:_,enable:!0}),this.touchRotate=(({enable:E,clickTolerance:A,bearingDegreesPerPixelMoved:k=.8})=>{const P=new Wl;return new Rs({clickTolerance:A,move:(z,L)=>({bearingDelta:(L.x-z.x)*k}),moveStateManager:P,enable:E,assignEvents:eo})})({clickTolerance:_,enable:!0}),this.map=r,f&&(this.mousePitch=Zl({clickTolerance:x,enable:!0}),this.touchPitch=(({enable:E,clickTolerance:A,pitchDegreesPerPixelMoved:k=-.5})=>{const P=new Wl;return new Rs({clickTolerance:A,move:(z,L)=>({pitchDelta:(L.y-z.y)*k}),moveStateManager:P,enable:E,assignEvents:eo})})({clickTolerance:x,enable:!0})),l.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),w.addEventListener(c,"mousedown",this.mousedown),w.addEventListener(c,"touchstart",this.touchstart,{passive:!1}),w.addEventListener(c,"touchcancel",this.reset)}startMouse(r,c){this.mouseRotate.dragStart(r,c),this.mousePitch&&this.mousePitch.dragStart(r,c),w.disableDrag()}startTouch(r,c){this.touchRotate.dragStart(r,c),this.touchPitch&&this.touchPitch.dragStart(r,c),w.disableDrag()}moveMouse(r,c){const f=this.map,{bearingDelta:_}=this.mouseRotate.dragMove(r,c)||{};if(_&&f.setBearing(f.getBearing()+_),this.mousePitch){const{pitchDelta:x}=this.mousePitch.dragMove(r,c)||{};x&&f.setPitch(f.getPitch()+x)}}moveTouch(r,c){const f=this.map,{bearingDelta:_}=this.touchRotate.dragMove(r,c)||{};if(_&&f.setBearing(f.getBearing()+_),this.touchPitch){const{pitchDelta:x}=this.touchPitch.dragMove(r,c)||{};x&&f.setPitch(f.getPitch()+x)}}off(){const r=this.element;w.removeEventListener(r,"mousedown",this.mousedown),w.removeEventListener(r,"touchstart",this.touchstart,{passive:!1}),w.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),w.removeEventListener(window,"touchend",this.touchend),w.removeEventListener(r,"touchcancel",this.reset),this.offTemp()}offTemp(){w.enableDrag(),w.removeEventListener(window,"mousemove",this.mousemove),w.removeEventListener(window,"mouseup",this.mouseup),w.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),w.removeEventListener(window,"touchend",this.touchend)}mousedown(r){this.startMouse(l.extend({},r,{ctrlKey:!0,preventDefault:()=>r.preventDefault()}),w.mousePos(this.element,r)),w.addEventListener(window,"mousemove",this.mousemove),w.addEventListener(window,"mouseup",this.mouseup)}mousemove(r){this.moveMouse(r,w.mousePos(this.element,r))}mouseup(r){this.mouseRotate.dragEnd(r),this.mousePitch&&this.mousePitch.dragEnd(r),this.offTemp()}touchstart(r){r.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=w.touchPos(this.element,r.targetTouches)[0],this.startTouch(r,this._startPos),w.addEventListener(window,"touchmove",this.touchmove,{passive:!1}),w.addEventListener(window,"touchend",this.touchend))}touchmove(r){r.targetTouches.length!==1?this.reset():(this._lastPos=w.touchPos(this.element,r.targetTouches)[0],this.moveTouch(r,this._lastPos))}touchend(r){r.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),delete this._startPos,delete this._lastPos,this.offTemp()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),this.touchRotate.reset(),this.touchPitch&&this.touchPitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}let ys;function nc(m,r,c){if(m=new l.LngLat(m.lng,m.lat),r){const f=new l.LngLat(m.lng-360,m.lat),_=new l.LngLat(m.lng+360,m.lat),x=c.locationPoint(m).distSqr(r);c.locationPoint(f).distSqr(r)<x?m=f:c.locationPoint(_).distSqr(r)<x&&(m=_)}for(;Math.abs(m.lng-c.center.lng)>180;){const f=c.locationPoint(m);if(f.x>=0&&f.y>=0&&f.x<=c.width&&f.y<=c.height)break;m.lng>c.center.lng?m.lng-=360:m.lng+=360}return m}const xa={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function ic(m,r,c){const f=m.classList;for(const _ in xa)f.remove(`maplibregl-${c}-anchor-${_}`);f.add(`maplibregl-${c}-anchor-${r}`)}class Ko extends l.Evented{constructor(r,c){if(super(),(r instanceof HTMLElement||c)&&(r=l.extend({element:r},c)),l.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress"],this),this._anchor=r&&r.anchor||"center",this._color=r&&r.color||"#3FB1CE",this._scale=r&&r.scale||1,this._draggable=r&&r.draggable||!1,this._clickTolerance=r&&r.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=r&&r.rotation||0,this._rotationAlignment=r&&r.rotationAlignment||"auto",this._pitchAlignment=r&&r.pitchAlignment&&r.pitchAlignment!=="auto"?r.pitchAlignment:this._rotationAlignment,r&&r.element)this._element=r.element,this._offset=l.Point.convert(r&&r.offset||[0,0]);else{this._defaultMarker=!0,this._element=w.create("div"),this._element.setAttribute("aria-label","Map marker");const f=w.createNS("http://www.w3.org/2000/svg","svg"),_=41,x=27;f.setAttributeNS(null,"display","block"),f.setAttributeNS(null,"height",`${_}px`),f.setAttributeNS(null,"width",`${x}px`),f.setAttributeNS(null,"viewBox",`0 0 ${x} ${_}`);const E=w.createNS("http://www.w3.org/2000/svg","g");E.setAttributeNS(null,"stroke","none"),E.setAttributeNS(null,"stroke-width","1"),E.setAttributeNS(null,"fill","none"),E.setAttributeNS(null,"fill-rule","evenodd");const A=w.createNS("http://www.w3.org/2000/svg","g");A.setAttributeNS(null,"fill-rule","nonzero");const k=w.createNS("http://www.w3.org/2000/svg","g");k.setAttributeNS(null,"transform","translate(3.0, 29.0)"),k.setAttributeNS(null,"fill","#000000");const P=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const Me of P){const re=w.createNS("http://www.w3.org/2000/svg","ellipse");re.setAttributeNS(null,"opacity","0.04"),re.setAttributeNS(null,"cx","10.5"),re.setAttributeNS(null,"cy","5.80029008"),re.setAttributeNS(null,"rx",Me.rx),re.setAttributeNS(null,"ry",Me.ry),k.appendChild(re)}const z=w.createNS("http://www.w3.org/2000/svg","g");z.setAttributeNS(null,"fill",this._color);const L=w.createNS("http://www.w3.org/2000/svg","path");L.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),z.appendChild(L);const G=w.createNS("http://www.w3.org/2000/svg","g");G.setAttributeNS(null,"opacity","0.25"),G.setAttributeNS(null,"fill","#000000");const ee=w.createNS("http://www.w3.org/2000/svg","path");ee.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),G.appendChild(ee);const K=w.createNS("http://www.w3.org/2000/svg","g");K.setAttributeNS(null,"transform","translate(6.0, 7.0)"),K.setAttributeNS(null,"fill","#FFFFFF");const J=w.createNS("http://www.w3.org/2000/svg","g");J.setAttributeNS(null,"transform","translate(8.0, 8.0)");const se=w.createNS("http://www.w3.org/2000/svg","circle");se.setAttributeNS(null,"fill","#000000"),se.setAttributeNS(null,"opacity","0.25"),se.setAttributeNS(null,"cx","5.5"),se.setAttributeNS(null,"cy","5.5"),se.setAttributeNS(null,"r","5.4999962");const ge=w.createNS("http://www.w3.org/2000/svg","circle");ge.setAttributeNS(null,"fill","#FFFFFF"),ge.setAttributeNS(null,"cx","5.5"),ge.setAttributeNS(null,"cy","5.5"),ge.setAttributeNS(null,"r","5.4999962"),J.appendChild(se),J.appendChild(ge),A.appendChild(k),A.appendChild(z),A.appendChild(G),A.appendChild(K),A.appendChild(J),f.appendChild(A),f.setAttributeNS(null,"height",_*this._scale+"px"),f.setAttributeNS(null,"width",x*this._scale+"px"),this._element.appendChild(f),this._offset=l.Point.convert(r&&r.offset||[0,-14])}this._element.classList.add("maplibregl-marker"),this._element.addEventListener("dragstart",f=>{f.preventDefault()}),this._element.addEventListener("mousedown",f=>{f.preventDefault()}),ic(this._element,this._anchor,"marker"),this._popup=null}addTo(r){return this.remove(),this._map=r,r.getCanvasContainer().appendChild(this._element),r.on("move",this._update),r.on("moveend",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),w.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(r){return this._lngLat=l.LngLat.convert(r),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(r){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),r){if(!("offset"in r.options)){const _=Math.sqrt(Math.pow(13.5,2)/2);r.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[_,-1*(38.1-13.5+_)],"bottom-right":[-_,-1*(38.1-13.5+_)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=r,this._lngLat&&this._popup.setLngLat(this._lngLat),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}_onKeyPress(r){const c=r.code,f=r.charCode||r.keyCode;c!=="Space"&&c!=="Enter"&&f!==32&&f!==13||this.togglePopup()}_onMapClick(r){const c=r.originalEvent.target,f=this._element;this._popup&&(c===f||f.contains(c))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const r=this._popup;return r?(r.isOpen()?r.remove():r.addTo(this._map),this):this}_update(r){if(!this._map)return;this._map.transform.renderWorldCopies&&(this._lngLat=nc(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._offset);let c="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?c=`rotateZ(${this._rotation}deg)`:this._rotationAlignment==="map"&&(c=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let f="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?f="rotateX(0deg)":this._pitchAlignment==="map"&&(f=`rotateX(${this._map.getPitch()}deg)`),r&&r.type!=="moveend"||(this._pos=this._pos.round()),w.setTransform(this._element,`${xa[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${f} ${c}`),this._map.terrain&&!this._opacityTimeout&&(this._opacityTimeout=setTimeout(()=>{const _=this._map.unproject(this._pos),x=40075016686e-3*Math.abs(Math.cos(this._lngLat.lat*Math.PI/180))/Math.pow(2,this._map.transform.tileZoom+8);this._element.style.opacity=_.distanceTo(this._lngLat)>20*x?"0.2":"1.0",this._opacityTimeout=null},100))}getOffset(){return this._offset}setOffset(r){return this._offset=l.Point.convert(r),this._update(),this}_onMove(r){if(!this._isDragging){const c=this._clickTolerance||this._map._clickTolerance;this._isDragging=r.point.dist(this._pointerdownPos)>=c}this._isDragging&&(this._pos=r.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new l.Event("dragstart"))),this.fire(new l.Event("drag")))}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new l.Event("dragend")),this._state="inactive"}_addDragHandler(r){this._element.contains(r.originalEvent.target)&&(r.preventDefault(),this._positionDelta=r.point.sub(this._pos).add(this._offset),this._pointerdownPos=r.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))}setDraggable(r){return this._draggable=!!r,this._map&&(r?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(r){return this._rotation=r||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(r){return this._rotationAlignment=r||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(r){return this._pitchAlignment=r&&r!=="auto"?r:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}}const Zu={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let to=0,ba=!1;const Yu={maxWidth:100,unit:"metric"};function rc(m,r,c){const f=c&&c.maxWidth||100,_=m._container.clientHeight/2,x=m.unproject([0,_]),E=m.unproject([f,_]),A=x.distanceTo(E);if(c&&c.unit==="imperial"){const k=3.2808*A;k>5280?wa(r,f,k/5280,m._getUIString("ScaleControl.Miles")):wa(r,f,k,m._getUIString("ScaleControl.Feet"))}else c&&c.unit==="nautical"?wa(r,f,A/1852,m._getUIString("ScaleControl.NauticalMiles")):A>=1e3?wa(r,f,A/1e3,m._getUIString("ScaleControl.Kilometers")):wa(r,f,A,m._getUIString("ScaleControl.Meters"))}function wa(m,r,c,f){const _=function(x){const E=Math.pow(10,`${Math.floor(x)}`.length-1);let A=x/E;return A=A>=10?10:A>=5?5:A>=3?3:A>=2?2:A>=1?1:function(k){const P=Math.pow(10,Math.ceil(-Math.log(k)/Math.LN10));return Math.round(k*P)/P}(A),E*A}(c);m.style.width=r*(_/c)+"px",m.innerHTML=`${_}&nbsp;${f}`}const sc={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},Xu=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function ac(m){if(m){if(typeof m=="number"){const r=Math.round(Math.sqrt(.5*Math.pow(m,2)));return{center:new l.Point(0,0),top:new l.Point(0,m),"top-left":new l.Point(r,r),"top-right":new l.Point(-r,r),bottom:new l.Point(0,-m),"bottom-left":new l.Point(r,-r),"bottom-right":new l.Point(-r,-r),left:new l.Point(m,0),right:new l.Point(-m,0)}}if(m instanceof l.Point||Array.isArray(m)){const r=l.Point.convert(m);return{center:r,top:r,"top-left":r,"top-right":r,bottom:r,"bottom-left":r,"bottom-right":r,left:r,right:r}}return{center:l.Point.convert(m.center||[0,0]),top:l.Point.convert(m.top||[0,0]),"top-left":l.Point.convert(m["top-left"]||[0,0]),"top-right":l.Point.convert(m["top-right"]||[0,0]),bottom:l.Point.convert(m.bottom||[0,0]),"bottom-left":l.Point.convert(m["bottom-left"]||[0,0]),"bottom-right":l.Point.convert(m["bottom-right"]||[0,0]),left:l.Point.convert(m.left||[0,0]),right:l.Point.convert(m.right||[0,0])}}return ac(new l.Point(0,0))}const oc=b,lc={setRTLTextPlugin:l.setRTLTextPlugin,getRTLTextPluginStatus:l.getRTLTextPluginStatus,Map:class extends zt{constructor(m){var r;if(l.PerformanceUtils.mark(l.PerformanceMarkers.create),(m=l.extend({},cf,m)).minZoom!=null&&m.maxZoom!=null&&m.minZoom>m.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(m.minPitch!=null&&m.maxPitch!=null&&m.minPitch>m.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(m.minPitch!=null&&m.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(m.maxPitch!=null&&m.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(super(new ql(m.minZoom,m.maxZoom,m.minPitch,m.maxPitch,m.renderWorldCopies),{bearingSnap:m.bearingSnap}),this._interactive=m.interactive,this._cooperativeGestures=m.cooperativeGestures,this._metaKey=navigator.platform.indexOf("Mac")===0?"metaKey":"ctrlKey",this._maxTileCacheSize=m.maxTileCacheSize,this._maxTileCacheZoomLevels=m.maxTileCacheZoomLevels,this._failIfMajorPerformanceCaveat=m.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=m.preserveDrawingBuffer,this._antialias=m.antialias,this._trackResize=m.trackResize,this._bearingSnap=m.bearingSnap,this._refreshExpiredTiles=m.refreshExpiredTiles,this._fadeDuration=m.fadeDuration,this._crossSourceCollisions=m.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=m.collectResourceTiming,this._renderTaskQueue=new qu,this._controls=[],this._mapId=l.uniqueId(),this._locale=l.extend({},Hu,m.locale),this._clickTolerance=m.clickTolerance,this._pixelRatio=(r=m.pixelRatio)!==null&&r!==void 0?r:devicePixelRatio,this.transformCameraUpdate=m.transformCameraUpdate,this._imageQueueHandle=ve.addThrottleControl(()=>this.isMoving()),this._requestManager=new ye(m.transformRequest),typeof m.container=="string"){if(this._container=document.getElementById(m.container),!this._container)throw new Error(`Container '${m.container}' not found.`)}else{if(!(m.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=m.container}if(m.maxBounds&&this.setMaxBounds(m.maxBounds),l.bindAll(["_onWindowOnline","_onMapScroll","_cooperativeGesturesOnWheel","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),this.on("terrain",()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)}),this.once("idle",()=>{this._idleTriggered=!0}),typeof window<"u"){addEventListener("online",this._onWindowOnline,!1);let c=!1;this._resizeObserver=new ResizeObserver(f=>{c?this._trackResize&&this.resize(f)._update():c=!0}),this._resizeObserver.observe(this._container)}this.handlers=new gs(this,m),this._cooperativeGestures&&this._setupCooperativeGestures(),this._hash=m.hash&&new Yd(typeof m.hash=="string"&&m.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:m.center,zoom:m.zoom,bearing:m.bearing,pitch:m.pitch}),m.bounds&&(this.resize(),this.fitBounds(m.bounds,l.extend({},m.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=m.localIdeographFontFamily,this._validateStyle=m.validateStyle,m.style&&this.setStyle(m.style,{localIdeographFontFamily:m.localIdeographFontFamily}),m.attributionControl&&this.addControl(new Ht({customAttribution:m.customAttribution})),m.maplibreLogo&&this.addControl(new Xo,m.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",c=>{this._update(c.dataType==="style"),this.fire(new l.Event(`${c.dataType}data`,c))}),this.on("dataloading",c=>{this.fire(new l.Event(`${c.dataType}dataloading`,c))}),this.on("dataabort",c=>{this.fire(new l.Event("sourcedataabort",c))})}_getMapId(){return this._mapId}addControl(m,r){if(r===void 0&&(r=m.getDefaultPosition?m.getDefaultPosition():"top-right"),!m||!m.onAdd)return this.fire(new l.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const c=m.onAdd(this);this._controls.push(m);const f=this._controlPositions[r];return r.indexOf("bottom")!==-1?f.insertBefore(c,f.firstChild):f.appendChild(c),this}removeControl(m){if(!m||!m.onRemove)return this.fire(new l.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const r=this._controls.indexOf(m);return r>-1&&this._controls.splice(r,1),m.onRemove(this),this}hasControl(m){return this._controls.indexOf(m)>-1}calculateCameraOptionsFromTo(m,r,c,f){return f==null&&this.terrain&&(f=this.transform.getElevation(c,this.terrain)),super.calculateCameraOptionsFromTo(m,r,c,f)}resize(m){var r;const c=this._containerDimensions(),f=c[0],_=c[1];this._resizeCanvas(f,_,this.getPixelRatio()),this.transform.resize(f,_),(r=this._requestedCameraState)===null||r===void 0||r.resize(f,_),this.painter.resize(f,_,this.getPixelRatio());const x=!this._moving;return x&&(this.stop(),this.fire(new l.Event("movestart",m)).fire(new l.Event("move",m))),this.fire(new l.Event("resize",m)),x&&this.fire(new l.Event("moveend",m)),this}getPixelRatio(){return this._pixelRatio}setPixelRatio(m){const[r,c]=this._containerDimensions();this._pixelRatio=m,this._resizeCanvas(r,c,m),this.painter.resize(r,c,m)}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(m){return this.transform.setMaxBounds(Lt.convert(m)),this._update()}setMinZoom(m){if((m=m??-2)>=-2&&m<=this.transform.maxZoom)return this.transform.minZoom=m,this._update(),this.getZoom()<m&&this.setZoom(m),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(m){if((m=m??22)>=this.transform.minZoom)return this.transform.maxZoom=m,this._update(),this.getZoom()>m&&this.setZoom(m),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(m){if((m=m??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(m>=0&&m<=this.transform.maxPitch)return this.transform.minPitch=m,this._update(),this.getPitch()<m&&this.setPitch(m),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(m){if((m=m??60)>85)throw new Error("maxPitch must be less than or equal to 85");if(m>=this.transform.minPitch)return this.transform.maxPitch=m,this._update(),this.getPitch()>m&&this.setPitch(m),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(m){return this.transform.renderWorldCopies=m,this._update()}getCooperativeGestures(){return this._cooperativeGestures}setCooperativeGestures(m){return this._cooperativeGestures=m,this._cooperativeGestures?this._setupCooperativeGestures():this._destroyCooperativeGestures(),this}project(m){return this.transform.locationPoint(l.LngLat.convert(m),this.style&&this.terrain)}unproject(m){return this.transform.pointLocation(l.Point.convert(m),this.terrain)}isMoving(){var m;return this._moving||((m=this.handlers)===null||m===void 0?void 0:m.isMoving())}isZooming(){var m;return this._zooming||((m=this.handlers)===null||m===void 0?void 0:m.isZooming())}isRotating(){var m;return this._rotating||((m=this.handlers)===null||m===void 0?void 0:m.isRotating())}_createDelegatedListener(m,r,c){if(m==="mouseenter"||m==="mouseover"){let f=!1;return{layer:r,listener:c,delegates:{mousemove:x=>{const E=this.getLayer(r)?this.queryRenderedFeatures(x.point,{layers:[r]}):[];E.length?f||(f=!0,c.call(this,new yi(m,this,x.originalEvent,{features:E}))):f=!1},mouseout:()=>{f=!1}}}}if(m==="mouseleave"||m==="mouseout"){let f=!1;return{layer:r,listener:c,delegates:{mousemove:E=>{(this.getLayer(r)?this.queryRenderedFeatures(E.point,{layers:[r]}):[]).length?f=!0:f&&(f=!1,c.call(this,new yi(m,this,E.originalEvent)))},mouseout:E=>{f&&(f=!1,c.call(this,new yi(m,this,E.originalEvent)))}}}}{const f=_=>{const x=this.getLayer(r)?this.queryRenderedFeatures(_.point,{layers:[r]}):[];x.length&&(_.features=x,c.call(this,_),delete _.features)};return{layer:r,listener:c,delegates:{[m]:f}}}}on(m,r,c){if(c===void 0)return super.on(m,r);const f=this._createDelegatedListener(m,r,c);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[m]=this._delegatedListeners[m]||[],this._delegatedListeners[m].push(f);for(const _ in f.delegates)this.on(_,f.delegates[_]);return this}once(m,r,c){if(c===void 0)return super.once(m,r);const f=this._createDelegatedListener(m,r,c);for(const _ in f.delegates)this.once(_,f.delegates[_]);return this}off(m,r,c){return c===void 0?super.off(m,r):(this._delegatedListeners&&this._delegatedListeners[m]&&(f=>{const _=this._delegatedListeners[m];for(let x=0;x<_.length;x++){const E=_[x];if(E.layer===r&&E.listener===c){for(const A in E.delegates)this.off(A,E.delegates[A]);return _.splice(x,1),this}}})(),this)}queryRenderedFeatures(m,r){if(!this.style)return[];let c;const f=m instanceof l.Point||Array.isArray(m),_=f?m:[[0,0],[this.transform.width,this.transform.height]];if(r=r||(f?{}:m)||{},_ instanceof l.Point||typeof _[0]=="number")c=[l.Point.convert(_)];else{const x=l.Point.convert(_[0]),E=l.Point.convert(_[1]);c=[x,new l.Point(E.x,x.y),E,new l.Point(x.x,E.y),x]}return this.style.queryRenderedFeatures(c,r,this.transform)}querySourceFeatures(m,r){return this.style.querySourceFeatures(m,r)}setStyle(m,r){return(r=l.extend({},{localIdeographFontFamily:this._localIdeographFontFamily,validate:this._validateStyle},r)).diff!==!1&&r.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&m?(this._diffStyle(m,r),this):(this._localIdeographFontFamily=r.localIdeographFontFamily,this._updateStyle(m,r))}setTransformRequest(m){return this._requestManager.setTransformRequest(m),this}_getUIString(m){const r=this._locale[m];if(r==null)throw new Error(`Missing UI string '${m}'`);return r}_updateStyle(m,r){if(r.transformStyle&&this.style&&!this.style._loaded)return void this.style.once("style.load",()=>this._updateStyle(m,r));const c=this.style&&r.transformStyle?this.style.serialize():void 0;return this.style&&(this.style.setEventedParent(null),this.style._remove(!m)),m?(this.style=new Fi(this,r||{}),this.style.setEventedParent(this,{style:this.style}),typeof m=="string"?this.style.loadURL(m,r,c):this.style.loadJSON(m,r,c),this):(delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new Fi(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(m,r){if(typeof m=="string"){const c=this._requestManager.transformRequest(m,ce.Style);l.getJSON(c,(f,_)=>{f?this.fire(new l.ErrorEvent(f)):_&&this._updateDiff(_,r)})}else typeof m=="object"&&this._updateDiff(m,r)}_updateDiff(m,r){try{this.style.setState(m,r)&&this._update(!0)}catch(c){l.warnOnce(`Unable to perform style diff: ${c.message||c.error||c}.  Rebuilding the style from scratch.`),this._updateStyle(m,r)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():l.warnOnce("There is no style added to the map.")}addSource(m,r){return this._lazyInitEmptyStyle(),this.style.addSource(m,r),this._update(!0)}isSourceLoaded(m){const r=this.style&&this.style.sourceCaches[m];if(r!==void 0)return r.loaded();this.fire(new l.ErrorEvent(new Error(`There is no source with ID '${m}'`)))}setTerrain(m){if(this.style._checkLoaded(),this._terrainDataCallback&&this.style.off("data",this._terrainDataCallback),m){const r=this.style.sourceCaches[m.source];if(!r)throw new Error(`cannot load terrain, because there exists no source with ID: ${m.source}`);for(const c in this.style._layers){const f=this.style._layers[c];f.type==="hillshade"&&f.source===m.source&&l.warnOnce("You are using the same source for a hillshade layer and for 3D terrain. Please consider using two separate sources to improve rendering quality.")}this.terrain=new _s(this.painter,r,m),this.painter.renderToTexture=new si(this.painter,this.terrain),this.transform.updateElevation(this.terrain),this._terrainDataCallback=c=>{c.dataType==="style"?this.terrain.sourceCache.freeRtt():c.dataType==="source"&&c.tile&&(c.sourceId===m.source&&this.transform.updateElevation(this.terrain),this.terrain.sourceCache.freeRtt(c.tile.tileID))},this.style.on("data",this._terrainDataCallback)}else this.terrain&&this.terrain.sourceCache.destruct(),this.terrain=null,this.painter.renderToTexture&&this.painter.renderToTexture.destruct(),this.painter.renderToTexture=null,this.transform.updateElevation(this.terrain);return this.fire(new l.Event("terrain",{terrain:m})),this}getTerrain(){return this.terrain&&this.terrain.options}areTilesLoaded(){const m=this.style&&this.style.sourceCaches;for(const r in m){const c=m[r]._tiles;for(const f in c){const _=c[f];if(_.state!=="loaded"&&_.state!=="errored")return!1}}return!0}addSourceType(m,r,c){return this._lazyInitEmptyStyle(),this.style.addSourceType(m,r,c)}removeSource(m){return this.style.removeSource(m),this._update(!0)}getSource(m){return this.style.getSource(m)}addImage(m,r,{pixelRatio:c=1,sdf:f=!1,stretchX:_,stretchY:x,content:E}={}){if(this._lazyInitEmptyStyle(),r instanceof HTMLImageElement||l.isImageBitmap(r)){const{width:A,height:k,data:P}=l.exported.getImageData(r);this.style.addImage(m,{data:new l.RGBAImage({width:A,height:k},P),pixelRatio:c,stretchX:_,stretchY:x,content:E,sdf:f,version:0})}else{if(r.width===void 0||r.height===void 0)return this.fire(new l.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:A,height:k,data:P}=r,z=r;this.style.addImage(m,{data:new l.RGBAImage({width:A,height:k},new Uint8Array(P)),pixelRatio:c,stretchX:_,stretchY:x,content:E,sdf:f,version:0,userImage:z}),z.onAdd&&z.onAdd(this,m)}}}updateImage(m,r){const c=this.style.getImage(m);if(!c)return this.fire(new l.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const f=r instanceof HTMLImageElement||l.isImageBitmap(r)?l.exported.getImageData(r):r,{width:_,height:x,data:E}=f;if(_===void 0||x===void 0)return this.fire(new l.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(_!==c.data.width||x!==c.data.height)return this.fire(new l.ErrorEvent(new Error("The width and height of the updated image must be that same as the previous version of the image")));const A=!(r instanceof HTMLImageElement||l.isImageBitmap(r));c.data.replace(E,A),this.style.updateImage(m,c)}getImage(m){return this.style.getImage(m)}hasImage(m){return m?!!this.style.getImage(m):(this.fire(new l.ErrorEvent(new Error("Missing required image id"))),!1)}removeImage(m){this.style.removeImage(m)}loadImage(m,r){ve.getImage(this._requestManager.transformRequest(m,ce.Image),r)}listImages(){return this.style.listImages()}addLayer(m,r){return this._lazyInitEmptyStyle(),this.style.addLayer(m,r),this._update(!0)}moveLayer(m,r){return this.style.moveLayer(m,r),this._update(!0)}removeLayer(m){return this.style.removeLayer(m),this._update(!0)}getLayer(m){return this.style.getLayer(m)}setLayerZoomRange(m,r,c){return this.style.setLayerZoomRange(m,r,c),this._update(!0)}setFilter(m,r,c={}){return this.style.setFilter(m,r,c),this._update(!0)}getFilter(m){return this.style.getFilter(m)}setPaintProperty(m,r,c,f={}){return this.style.setPaintProperty(m,r,c,f),this._update(!0)}getPaintProperty(m,r){return this.style.getPaintProperty(m,r)}setLayoutProperty(m,r,c,f={}){return this.style.setLayoutProperty(m,r,c,f),this._update(!0)}getLayoutProperty(m,r){return this.style.getLayoutProperty(m,r)}setGlyphs(m,r={}){return this._lazyInitEmptyStyle(),this.style.setGlyphs(m,r),this._update(!0)}getGlyphs(){return this.style.getGlyphsUrl()}addSprite(m,r,c={}){return this._lazyInitEmptyStyle(),this.style.addSprite(m,r,c,f=>{f||this._update(!0)}),this}removeSprite(m){return this._lazyInitEmptyStyle(),this.style.removeSprite(m),this._update(!0)}getSprite(){return this.style.getSprite()}setSprite(m,r={}){return this._lazyInitEmptyStyle(),this.style.setSprite(m,r,c=>{c||this._update(!0)}),this}setLight(m,r={}){return this._lazyInitEmptyStyle(),this.style.setLight(m,r),this._update(!0)}getLight(){return this.style.getLight()}setFeatureState(m,r){return this.style.setFeatureState(m,r),this._update()}removeFeatureState(m,r){return this.style.removeFeatureState(m,r),this._update()}getFeatureState(m){return this.style.getFeatureState(m)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let m=0,r=0;return this._container&&(m=this._container.clientWidth||400,r=this._container.clientHeight||300),[m,r]}_setupContainer(){const m=this._container;m.classList.add("maplibregl-map");const r=this._canvasContainer=w.create("div","maplibregl-canvas-container",m);this._interactive&&r.classList.add("maplibregl-interactive"),this._canvas=w.create("canvas","maplibregl-canvas",r),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map"),this._canvas.setAttribute("role","region");const c=this._containerDimensions();this._resizeCanvas(c[0],c[1],this.getPixelRatio());const f=this._controlContainer=w.create("div","maplibregl-control-container",m),_=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(x=>{_[x]=w.create("div",`maplibregl-ctrl-${x} `,f)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_cooperativeGesturesOnWheel(m){this._onCooperativeGesture(m,m[this._metaKey],1)}_setupCooperativeGestures(){this._cooperativeGesturesScreen=w.create("div","maplibregl-cooperative-gesture-screen",this._container);let m=typeof this._cooperativeGestures!="boolean"&&this._cooperativeGestures.windowsHelpText?this._cooperativeGestures.windowsHelpText:"Use Ctrl + scroll to zoom the map";navigator.platform.indexOf("Mac")===0&&(m=typeof this._cooperativeGestures!="boolean"&&this._cooperativeGestures.macHelpText?this._cooperativeGestures.macHelpText:"Use  + scroll to zoom the map"),this._cooperativeGesturesScreen.innerHTML=`
            <div class="maplibregl-desktop-message">${m}</div>
            <div class="maplibregl-mobile-message">${typeof this._cooperativeGestures!="boolean"&&this._cooperativeGestures.mobileHelpText?this._cooperativeGestures.mobileHelpText:"Use two fingers to move the map"}</div>
        `,this._canvasContainer.addEventListener("wheel",this._cooperativeGesturesOnWheel,!1),this._canvasContainer.classList.add("maplibregl-cooperative-gestures")}_destroyCooperativeGestures(){w.remove(this._cooperativeGesturesScreen),this._canvasContainer.removeEventListener("wheel",this._cooperativeGesturesOnWheel,!1),this._canvasContainer.classList.remove("maplibregl-cooperative-gestures")}_resizeCanvas(m,r,c){this._canvas.width=c*m,this._canvas.height=c*r,this._canvas.style.width=`${m}px`,this._canvas.style.height=`${r}px`}_setupPainter(){const m={alpha:!0,stencil:!0,depth:!0,failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1};let r=null;this._canvas.addEventListener("webglcontextcreationerror",f=>{r={requestedAttributes:m},f&&(r.statusMessage=f.statusMessage,r.type=f.type)},{once:!0});const c=this._canvas.getContext("webgl2",m)||this._canvas.getContext("webgl",m);if(!c){const f="Failed to initialize WebGL";throw r?(r.message=f,new Error(JSON.stringify(r))):new Error(f)}this.painter=new Zd(c,this.transform),C.testSupport(c)}_contextLost(m){m.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new l.Event("webglcontextlost",{originalEvent:m}))}_contextRestored(m){this._setupPainter(),this.resize(),this._update(),this.fire(new l.Event("webglcontextrestored",{originalEvent:m}))}_onMapScroll(m){if(m.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}_onCooperativeGesture(m,r,c){return!r&&c<2&&(this._cooperativeGesturesScreen.classList.add("maplibregl-show"),setTimeout(()=>{this._cooperativeGesturesScreen.classList.remove("maplibregl-show")},100)),!1}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(m){return this.style&&this.style._loaded?(this._styleDirty=this._styleDirty||m,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(m){return this._update(),this._renderTaskQueue.add(m)}_cancelRenderFrame(m){this._renderTaskQueue.remove(m)}_render(m){const r=this._idleTriggered?this._fadeDuration:0;if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(m),this._removed)return;let c=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;const _=this.transform.zoom,x=l.exported.now();this.style.zoomHistory.update(_,x);const E=new l.EvaluationParameters(_,{now:x,fadeDuration:r,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),A=E.crossFadingFactor();A===1&&A===this._crossFadingFactor||(c=!0,this._crossFadingFactor=A),this.style.update(E)}this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.terrain&&this.terrain.sourceCache.update(this.transform,this.terrain),this.transform.updateElevation(this.terrain),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,r,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:r,showPadding:this.showPadding}),this.fire(new l.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,l.PerformanceUtils.mark(l.PerformanceMarkers.load),this.fire(new l.Event("load"))),this.style&&(this.style.hasTransitions()||c)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles();const f=this._sourcesDirty||this._styleDirty||this._placementDirty;return f||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new l.Event("idle")),!this._loaded||this._fullyLoaded||f||(this._fullyLoaded=!0,l.PerformanceUtils.mark(l.PerformanceMarkers.fullLoad)),this}redraw(){return this.style&&(this._frame&&(this._frame.cancel(),this._frame=null),this._render(0)),this}remove(){var m;this._hash&&this._hash.remove();for(const c of this._controls)c.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof window<"u"&&removeEventListener("online",this._onWindowOnline,!1),ve.removeThrottleControl(this._imageQueueHandle),(m=this._resizeObserver)===null||m===void 0||m.disconnect();const r=this.painter.context.gl.getExtension("WEBGL_lose_context");r&&r.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),w.remove(this._canvasContainer),w.remove(this._controlContainer),this._cooperativeGestures&&this._destroyCooperativeGestures(),this._container.classList.remove("maplibregl-map"),l.PerformanceUtils.clearMetrics(),this._removed=!0,this.fire(new l.Event("remove"))}triggerRepaint(){this.style&&!this._frame&&(this._frame=l.exported.frame(m=>{l.PerformanceUtils.frame(m),this._frame=null,this._render(m)}))}_onWindowOnline(){this._update()}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(m){this._showTileBoundaries!==m&&(this._showTileBoundaries=m,this._update())}get showPadding(){return!!this._showPadding}set showPadding(m){this._showPadding!==m&&(this._showPadding=m,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(m){this._showCollisionBoxes!==m&&(this._showCollisionBoxes=m,m?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(m){this._showOverdrawInspector!==m&&(this._showOverdrawInspector=m,this._update())}get repaint(){return!!this._repaint}set repaint(m){this._repaint!==m&&(this._repaint=m,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(m){this._vertices=m,this._update()}get version(){return vi}getCameraTargetElevation(){return this.transform.elevation}},NavigationControl:class{constructor(m){this.options=l.extend({},tc,m),this._container=w.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._container.addEventListener("contextmenu",r=>r.preventDefault()),this.options.showZoom&&(l.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in",r=>this._map.zoomIn({},{originalEvent:r})),w.create("span","maplibregl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out",r=>this._map.zoomOut({},{originalEvent:r})),w.create("span","maplibregl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(l.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("maplibregl-ctrl-compass",r=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:r}):this._map.resetNorth({},{originalEvent:r})}),this._compassIcon=w.create("span","maplibregl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){const m=this._map.getZoom(),r=m===this._map.getMaxZoom(),c=m===this._map.getMinZoom();this._zoomInButton.disabled=r,this._zoomOutButton.disabled=c,this._zoomInButton.setAttribute("aria-disabled",r.toString()),this._zoomOutButton.setAttribute("aria-disabled",c.toString())}_rotateCompassArrow(){const m=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${this._map.transform.angle*(180/Math.PI)}deg)`:`rotate(${this._map.transform.angle*(180/Math.PI)}deg)`;this._compassIcon.style.transform=m}onAdd(m){return this._map=m,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Wu(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){w.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(m,r){const c=w.create("button",m,this._container);return c.type="button",c.addEventListener("click",r),c}_setButtonTitle(m,r){const c=this._map._getUIString(`NavigationControl.${r}`);m.title=c,m.setAttribute("aria-label",c)}},GeolocateControl:class extends l.Evented{constructor(m){super(),this.options=l.extend({},Zu,m),l.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker"],this)}onAdd(m){return this._map=m,this._container=w.create("div","maplibregl-ctrl maplibregl-ctrl-group"),function(r,c=!1){ys===void 0||c?window.navigator.permissions!==void 0?window.navigator.permissions.query({name:"geolocation"}).then(f=>{ys=f.state!=="denied",r(ys)}).catch(()=>{ys=!!window.navigator.geolocation,r(ys)}):(ys=!!window.navigator.geolocation,r(ys)):r(ys)}(this._setupUI),this._container}onRemove(){this._geolocationWatchID!==void 0&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),w.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,to=0,ba=!1}_isOutOfMapMaxBounds(m){const r=this._map.getMaxBounds(),c=m.coords;return r&&(c.longitude<r.getWest()||c.longitude>r.getEast()||c.latitude<r.getSouth()||c.latitude>r.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_onSuccess(m){if(this._map){if(this._isOutOfMapMaxBounds(m))return this._setErrorState(),this.fire(new l.Event("outofmaxbounds",m)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=m,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(m),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(m),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale"),this.fire(new l.Event("geolocate",m)),this._finish()}}_updateCamera(m){const r=new l.LngLat(m.coords.longitude,m.coords.latitude),c=m.coords.accuracy,f=this._map.getBearing(),_=l.extend({bearing:f},this.options.fitBoundsOptions),x=Lt.fromLngLat(r,c);this._map.fitBounds(x,_,{geolocateSource:!0})}_updateMarker(m){if(m){const r=new l.LngLat(m.coords.longitude,m.coords.latitude);this._accuracyCircleMarker.setLngLat(r).addTo(this._map),this._userLocationDotMarker.setLngLat(r).addTo(this._map),this._accuracy=m.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const m=this._map.getBounds(),r=m.getSouthEast(),c=m.getNorthEast(),f=r.distanceTo(c),_=Math.ceil(this._accuracy/(f/this._map._container.clientHeight)*2);this._circleElement.style.width=`${_}px`,this._circleElement.style.height=`${_}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_onError(m){if(this._map){if(this.options.trackUserLocation)if(m.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const r=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=r,this._geolocateButton.setAttribute("aria-label",r),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(m.code===3&&ba)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale"),this.fire(new l.Event("error",m)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(m){if(this._map){if(this._container.addEventListener("contextmenu",r=>r.preventDefault()),this._geolocateButton=w.create("button","maplibregl-ctrl-geolocate",this._container),w.create("span","maplibregl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",m===!1){l.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");const r=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=r,this._geolocateButton.setAttribute("aria-label",r)}else{const r=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=r,this._geolocateButton.setAttribute("aria-label",r)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=w.create("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new Ko(this._dotElement),this._circleElement=w.create("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Ko({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",r=>{r.geolocateSource||this._watchState!=="ACTIVE_LOCK"||r.originalEvent&&r.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new l.Event("trackuserlocationend")))})}}trigger(){if(!this._setup)return l.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new l.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":to--,ba=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this.fire(new l.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new l.Event("trackuserlocationstart"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let m;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),to++,to>1?(m={maximumAge:6e5,timeout:0},ba=!0):(m=this.options.positionOptions,ba=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,m)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:Ht,LogoControl:Xo,ScaleControl:class{constructor(m){this.options=l.extend({},Yu,m),l.bindAll(["_onMove","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_onMove(){rc(this._map,this._container,this.options)}onAdd(m){return this._map=m,this._container=w.create("div","maplibregl-ctrl maplibregl-ctrl-scale",m.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){w.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}setUnit(m){this.options.unit=m,rc(this._map,this._container,this.options)}},FullscreenControl:class extends l.Evented{constructor(m={}){super(),this._onFullscreenChange=()=>{(window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement)===this._container!==this._fullscreen&&this._handleFullscreenChange()},this._onClickFullscreen=()=>{this._isFullscreen()?this._exitFullscreen():this._requestFullscreen()},this._fullscreen=!1,m&&m.container&&(m.container instanceof HTMLElement?this._container=m.container:l.warnOnce("Full screen control 'container' must be a DOM element.")),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(m){return this._map=m,this._container||(this._container=this._map.getContainer()),this._controlContainer=w.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),this._controlContainer}onRemove(){w.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._onFullscreenChange)}_setupUI(){const m=this._fullscreenButton=w.create("button","maplibregl-ctrl-fullscreen",this._controlContainer);w.create("span","maplibregl-ctrl-icon",m).setAttribute("aria-hidden","true"),m.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._onFullscreenChange)}_updateTitle(){const m=this._getTitle();this._fullscreenButton.setAttribute("aria-label",m),this._fullscreenButton.title=m}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_handleFullscreenChange(){this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._updateTitle(),this._fullscreen?(this.fire(new l.Event("fullscreenstart")),this._map._cooperativeGestures&&(this._prevCooperativeGestures=this._map._cooperativeGestures,this._map.setCooperativeGestures())):(this.fire(new l.Event("fullscreenend")),this._prevCooperativeGestures&&(this._map.setCooperativeGestures(this._prevCooperativeGestures),delete this._prevCooperativeGestures))}_exitFullscreen(){window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen?window.document.webkitCancelFullScreen():this._togglePseudoFullScreen()}_requestFullscreen(){this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen?this._container.webkitRequestFullscreen():this._togglePseudoFullScreen()}_togglePseudoFullScreen(){this._container.classList.toggle("maplibregl-pseudo-fullscreen"),this._handleFullscreenChange(),this._map.resize()}},TerrainControl:class{constructor(m){this.options=m,l.bindAll(["_toggleTerrain","_updateTerrainIcon"],this)}onAdd(m){return this._map=m,this._container=w.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=w.create("button","maplibregl-ctrl-terrain",this._container),w.create("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){w.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}_toggleTerrain(){this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()}_updateTerrainIcon(){this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.disableTerrain")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.enableTerrain"))}},Popup:class extends l.Evented{constructor(m){super(),this.options=l.extend(Object.create(sc),m),l.bindAll(["_update","_onClose","remove","_onMouseMove","_onMouseUp","_onDrag"],this)}addTo(m){return this._map&&this.remove(),this._map=m,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")):this._map.on("move",this._update),this.fire(new l.Event("open")),this}isOpen(){return!!this._map}remove(){return this._content&&w.remove(this._content),this._container&&(w.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),delete this._map),this.fire(new l.Event("close")),this}getLngLat(){return this._lngLat}setLngLat(m){return this._lngLat=l.LngLat.convert(m),this._pos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")),this}getElement(){return this._container}setText(m){return this.setDOMContent(document.createTextNode(m))}setHTML(m){const r=document.createDocumentFragment(),c=document.createElement("body");let f;for(c.innerHTML=m;f=c.firstChild,f;)r.appendChild(f);return this.setDOMContent(r)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(m){return this.options.maxWidth=m,this._update(),this}setDOMContent(m){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=w.create("div","maplibregl-popup-content",this._container);return this._content.appendChild(m),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(m){this._container&&this._container.classList.add(m)}removeClassName(m){this._container&&this._container.classList.remove(m)}setOffset(m){return this.options.offset=m,this._update(),this}toggleClassName(m){if(this._container)return this._container.classList.toggle(m)}_createCloseButton(){this.options.closeButton&&(this._closeButton=w.create("button","maplibregl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_onMouseUp(m){this._update(m.point)}_onMouseMove(m){this._update(m.point)}_onDrag(m){this._update(m.point)}_update(m){if(!this._map||!this._lngLat&&!this._trackPointer||!this._content||(this._container||(this._container=w.create("div","maplibregl-popup",this._map.getContainer()),this._tip=w.create("div","maplibregl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className&&this.options.className.split(" ").forEach(x=>this._container.classList.add(x)),this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer")),this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=nc(this._lngLat,this._pos,this._map.transform)),this._trackPointer&&!m))return;const r=this._pos=this._trackPointer&&m?m:this._map.project(this._lngLat);let c=this.options.anchor;const f=ac(this.options.offset);if(!c){const x=this._container.offsetWidth,E=this._container.offsetHeight;let A;A=r.y+f.bottom.y<E?["top"]:r.y>this._map.transform.height-E?["bottom"]:[],r.x<x/2?A.push("left"):r.x>this._map.transform.width-x/2&&A.push("right"),c=A.length===0?"bottom":A.join("-")}const _=r.add(f[c]).round();w.setTransform(this._container,`${xa[c]} translate(${_.x}px,${_.y}px)`),ic(this._container,c,"popup")}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const m=this._container.querySelector(Xu);m&&m.focus()}_onClose(){this.remove()}},Marker:Ko,Style:Fi,LngLat:l.LngLat,LngLatBounds:Lt,Point:l.Point,MercatorCoordinate:l.MercatorCoordinate,Evented:l.Evented,AJAXError:l.AJAXError,config:l.config,CanvasSource:W,GeoJSONSource:je,ImageSource:Y,RasterDEMTileSource:Oe,RasterTileSource:Ye,VectorTileSource:Se,VideoSource:ie,prewarm:function(){dn().acquire(wt)},clearPrewarmedResources:function(){const m=Zt;m&&(m.isPreloaded()&&m.numActive()===1?(m.release(wt),Zt=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get version(){return oc},get workerCount(){return Ge.workerCount},set workerCount(m){Ge.workerCount=m},get maxParallelImageRequests(){return l.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(m){l.config.MAX_PARALLEL_IMAGE_REQUESTS=m},get workerUrl(){return l.config.WORKER_URL},set workerUrl(m){l.config.WORKER_URL=m},addProtocol(m,r){l.config.REGISTERED_PROTOCOLS[m]=r},removeProtocol(m){delete l.config.REGISTERED_PROTOCOLS[m]}};return ec.extend(lc,{isSafari:l.isSafari,getPerformanceMetrics:l.PerformanceUtils.getPerformanceMetrics}),lc});var p=u;return p})})(bE);var MM=bE.exports;const Th=RM(MM);class o1{static getGeoJSON(){const t=[];return Array.prototype.forEach.call(zi().filteredAssociationsWithoutMapFilter,i=>{t.push({id:i.id,properties:{id:i.id,name:i.name,country:i.country},geometry:{type:"Point",coordinates:[i.coords.y,i.coords.x]}})}),{type:"FeatureCollection",features:t}}static getBounds(t){const i=t.map(a=>a.geometry.coordinates);return i.reduce((a,u)=>a.extend(u),new Th.LngLatBounds(i[0],i[0]))}}class DM{constructor(){ei(this,"_map");ei(this,"_container")}onAdd(t){this._map=t,this._container=document.createElement("div"),this._container.className="maplibregl-ctrl maplibregl-ctrl-group";const i=document.createElement("button");i.className="maplibregl-ctrl-zoom-extent";const a=document.createElement("span");return a.className="maplibregl-ctrl-icon",i.appendChild(a),this._container.appendChild(i),this._container.addEventListener("click",()=>{mi().triggerZoomReset=!mi().triggerZoomReset}),this._container}onRemove(){this._container.parentNode.removeChild(this._container),this._map=void 0}}var LM=Object.defineProperty,zM=Object.getOwnPropertyDescriptor,Do=(e,t,i,a)=>{for(var u=a>1?void 0:a?zM(t,i):t,d=e.length-1,p;d>=0;d--)(p=e[d])&&(u=(a?p(t,i,u):p(u))||u);return a&&u&&LM(t,i,u),u};let fa=class extends Or{constructor(){super(...arguments);ei(this,"map",null);ei(this,"geojsonData",null);ei(this,"defaultZoomExtent",null);ei(this,"layers",{ASSOC:"association",ASSOC_CLUSTER:"association-cluster",ASSOC_CLUSTER_COUNT:"association-cluster-count",ASSOC_CLUSTER_BG:"association-cluster-bg",UNCLUSTERED_POINT:"unclustered-point"})}async mounted(){this.map=new Th.Map({container:"map",style:"https://api.maptiler.com/maps/dataviz/style.json?key=0tupl15DKhXOvwp27x8c",center:[0,0],zoom:1}),this.setMapPadding(),this.map.dragRotate.disable(),this.map.touchZoomRotate.disableRotation();var i=new Th.NavigationControl({showCompass:!1});this.map.addControl(i,"top-right"),this.map.addControl(new DM);const a=document.querySelector("body");a!==null&&this.map.addControl(new Th.FullscreenControl({container:a})),this.initMapSyncFilter()}get filterPin(){return["case",["in",["get","id"],["literal",[this.hoveredAssociationId,this.activeAssociationId].filter(i=>i)]],"marker-active","marker"]}updatePins(){this.map.getLayer(this.layers.UNCLUSTERED_POINT)!==void 0&&this.map.setLayoutProperty(this.layers.UNCLUSTERED_POINT,"icon-image",this.filterPin)}activeAssociationIdWatcher(){this.activeAssociation!==null&&this.zoomToAssociation(this.activeAssociation),this.updatePins()}hoveredAssociationIdWatcher(){this.updatePins()}infoPanelWatcher(){this.setMapPadding()}associationsWatcher(){this.updateOscMap()}zoomResetWatcher(){this.fitBounds(!0)}filteredAssociationsWithoutMapFilterWatcher(i,a){i!==a&&(Yn().isMapSynced?this.setMapFilter():this.fitBounds())}filteredAssociationsWatcher(){this.addOscSource()}get isInfoPanelShown(){return mi().isInfoPanelShown}get associations(){return zi().associations}get filteredAssociations(){return zi().filteredAssociations}get filteredAssociationsWithoutMapFilter(){return zi().filteredAssociationsWithoutMapFilter}get filteredAssociationsId(){return this.filteredAssociations.map(i=>i.id)}get activeAssociationId(){return zi().activeAssociationId}get hoveredAssociationId(){return zi().hoveredAssociationId}get activeAssociation(){return zi().activeAssociation}get triggerZoomReset(){return mi().triggerZoomReset}get padding(){return{top:30,bottom:30,left:30,right:(this.isInfoPanelShown?360:0)+30}}get geojson(){return o1.getGeoJSON()}setMapPadding(){this.map.easeTo({padding:this.padding,duration:300})}async setMapFilter(){if(this.map.getLayer(this.layers.UNCLUSTERED_POINT)!==void 0){const i=this.map.queryRenderedFeatures({layers:[this.layers.UNCLUSTERED_POINT,this.layers.ASSOC_CLUSTER]}),a=this.map.getSource(this.layers.ASSOC);let u=[];await i.forEach(async d=>{const p=d.properties.cluster_id,l=d.properties.point_count;p!==void 0?await a.getClusterLeaves(p,l,0,(b,w)=>{if(w!==void 0){let C=w.map(I=>I.id);u.push(...C)}}):await u.push(d.id)}),setTimeout(()=>Yn().mapShownAssociations=u,200)}}initMapSyncFilter(){this.map.on("moveend",async()=>{await this.setMapFilter()})}initMap(){this.updateOscMap()}updateOscMap(){this.addOscSource(),this.addOscLayer(),this.addClusterClickEvent(),this.addTooltipOnHover(),this.updateAssociationOnClick(),this.fitBounds()}addOscSource(){let i=this.geojson;this.map.getSource(this.layers.ASSOC)?this.map.getSource(this.layers.ASSOC).setData(this.geojson):this.map.addSource(this.layers.ASSOC,{type:"geojson",data:i,cluster:!0,clusterMaxZoom:11,clusterRadius:50,attribution:'Developed by <b><a href="https://cartong.org" target="_blank">CartONG</a></b>'})}addOscLayer(){this.map.getLayer(this.layers.ASSOC)===void 0&&(this.map.addLayer({id:this.layers.ASSOC_CLUSTER_BG,type:"circle",source:this.layers.ASSOC,filter:["has","point_count"],paint:{"circle-color":"#558B2F","circle-radius":40,"circle-opacity":.15}}),this.map.addLayer({id:this.layers.ASSOC_CLUSTER,type:"circle",source:this.layers.ASSOC,filter:["has","point_count"],paint:{"circle-color":"#558B2F","circle-radius":20}}),this.map.addLayer({id:this.layers.ASSOC_CLUSTER_COUNT,type:"symbol",source:this.layers.ASSOC,filter:["has","point_count"],layout:{"text-field":"{point_count_abbreviated}","text-size":12,"text-font":["Open Sans Bold","Arial Unicode MS Bold"]},paint:{"text-color":"#fff"}}),this.map.loadImage("./img/pins/pin_active.png",(i,a)=>{if(i)throw i;this.map.addImage("marker-active",a)}),this.map.loadImage("./img/pins/pin_orange.png",(i,a)=>{if(i)throw i;this.map.addImage("marker",a),this.map.addLayer({id:this.layers.UNCLUSTERED_POINT,type:"symbol",source:this.layers.ASSOC,filter:["!",["has","point_count"]],layout:{"icon-image":this.filterPin,"icon-allow-overlap":!0}})}))}updateAssociationOnClick(){this.map.on("click",this.layers.UNCLUSTERED_POINT,i=>{zi().activeAssociationId=i.features[0].properties.id})}addClusterClickEvent(){this.map.on("click",this.layers.ASSOC_CLUSTER,i=>{const a=this.map.queryRenderedFeatures(i.point,{layers:[this.layers.ASSOC_CLUSTER]}),u=a[0].properties.cluster_id;this.map.getSource(this.layers.ASSOC).getClusterExpansionZoom(u,(d,p)=>{d||this.map.easeTo({center:a[0].geometry.coordinates,zoom:p})})}),this.map.on("mouseenter",this.layers.ASSOC_CLUSTER,i=>{this.map.getCanvas().style.cursor="pointer"}),this.map.on("mouseleave",this.layers.ASSOC_CLUSTER,()=>{this.map.getCanvas().style.cursor=""})}zoomToAssociation(i){const a=this.map.getZoom(),u=12;this.map.flyTo({center:[i.coords.y,i.coords.x],zoom:a<u?u:a,padding:this.padding,bearing:0,speed:3,curve:1,easing:function(d){return d},essential:!0})}addTooltipOnHover(){const i=new Th.Popup({closeButton:!1,closeOnClick:!1});this.map.on("mouseenter",this.layers.UNCLUSTERED_POINT,a=>{this.map.getCanvas().style.cursor="pointer";for(var u=a.features[0].geometry.coordinates.slice(),d=a.features[0].properties.name;Math.abs(a.lngLat.lng-u[0])>180;)u[0]+=a.lngLat.lng>u[0]?360:-360;const p=`<h3>${d}</h3><span>Cliquez pour plus d'informations</span>`;i.setLngLat(u).setHTML(p).addTo(this.map),i.addClassName("show"),zi().hoveredAssociationId=a.features[0].properties.id}),this.map.on("mouseleave",this.layers.UNCLUSTERED_POINT,()=>{this.map.getCanvas().style.cursor="",i.removeClassName("show"),zi().hoveredAssociationId=null})}fitBounds(i=!1){let a=this.geojson.features;if(a.length){const u=o1.getBounds(a);this.defaultZoomExtent===null&&(this.defaultZoomExtent=u),this.map.fitBounds(i?this.defaultZoomExtent:u,{padding:30})}}};Do([Ws("activeAssociationId")],fa.prototype,"activeAssociationIdWatcher",1);Do([Ws("hoveredAssociationId")],fa.prototype,"hoveredAssociationIdWatcher",1);Do([Ws("isInfoPanelShown")],fa.prototype,"infoPanelWatcher",1);Do([Ws("associations")],fa.prototype,"associationsWatcher",1);Do([Ws("triggerZoomReset")],fa.prototype,"zoomResetWatcher",1);Do([Ws("filteredAssociationsWithoutMapFilter")],fa.prototype,"filteredAssociationsWithoutMapFilterWatcher",1);Do([Ws("filteredAssociations",{deep:!0})],fa.prototype,"filteredAssociationsWatcher",1);fa=Do([zr({})],fa);const Br=(e,t)=>{const i=e.__vccOpts||e;for(const[a,u]of t)i[a]=u;return i},OM={id:"map"};function BM(e,t,i,a,u,d){return ln(),pn("div",OM)}const FM=Br(fa,[["render",BM]]);var NM=Object.defineProperty,UM=Object.getOwnPropertyDescriptor,Sl=(e,t,i,a)=>{for(var u=a>1?void 0:a?UM(t,i):t,d=e.length-1,p;d>=0;d--)(p=e[d])&&(u=(a?p(t,i,u):p(u))||u);return a&&u&&NM(t,i,u),u};let Oa=class extends Or{constructor(){super(...arguments);ei(this,"label");ei(this,"fill");ei(this,"toggled");ei(this,"uppercase");ei(this,"small");ei(this,"icon")}get iconUrl(){return"./img/icons/"+this.icon+".svg"}};Sl([Xr({default:"Button label"})],Oa.prototype,"label",2);Sl([Xr({default:!1})],Oa.prototype,"fill",2);Sl([Xr({default:null})],Oa.prototype,"toggled",2);Sl([Xr({default:!1})],Oa.prototype,"uppercase",2);Sl([Xr({default:!1})],Oa.prototype,"small",2);Sl([Xr({default:null})],Oa.prototype,"icon",2);Oa=Sl([zr({})],Oa);const $M=["uppercase","fill","small","toggled"],VM=["src","alt"];function jM(e,t,i,a,u,d){return ln(),pn("button",{class:"Button",uppercase:e.uppercase,fill:e.fill,small:e.small,toggled:e.toggled},[e.icon!==null?(ln(),pn("img",{key:0,src:e.iconUrl,alt:e.icon},null,8,VM)):ar("",!0),Bt("span",null,Ui(e.label),1)],8,$M)}const vd=Br(Oa,[["render",jM]]);var GM=Object.defineProperty,qM=Object.getOwnPropertyDescriptor,SE=(e,t,i,a)=>{for(var u=a>1?void 0:a?qM(t,i):t,d=e.length-1,p;d>=0;d--)(p=e[d])&&(u=(a?p(t,i,u):p(u))||u);return a&&u&&GM(t,i,u),u};let kp=class extends Or{constructor(){super(...arguments);ei(this,"label");ei(this,"copying",!1)}get iconUrl(){return"./img/icons/"+(this.copying?"done":"mdi-content-copy")+".svg"}copyToClipboard(){const i=this;function a(u){i.copying=!0,setTimeout(()=>i.copying=!1,1500),u.clipboardData.setData("text/html",i.label),u.clipboardData.setData("text/plain",i.label),u.preventDefault()}document.addEventListener("copy",a),document.execCommand("copy"),document.removeEventListener("copy",a)}};SE([Xr({default:""})],kp.prototype,"label",2);kp=SE([zr({})],kp);const HM={class:"CopyToClipboard"},WM=["src"];function ZM(e,t,i,a,u,d){return ln(),pn("div",HM,[Bt("span",null,Ui(e.label),1),Bt("img",{src:e.iconUrl,alt:"Copier",onClick:t[0]||(t[0]=(...p)=>e.copyToClipboard&&e.copyToClipboard(...p))},null,8,WM)])}const YM=Br(kp,[["render",ZM]]);var XM=Object.defineProperty,KM=Object.getOwnPropertyDescriptor,EE=(e,t,i,a)=>{for(var u=a>1?void 0:a?KM(t,i):t,d=e.length-1,p;d>=0;d--)(p=e[d])&&(u=(a?p(t,i,u):p(u))||u);return a&&u&&XM(t,i,u),u};let Ap=class extends Or{associationWatcher(){this.association!==null&&(mi().isInfoPanelShown=!0)}get isInfoPanelShown(){return mi().isInfoPanelShown}get association(){return zi().activeAssociation}getIconUrl(t){return"./img/icons/"+t+".svg"}getThematic(t){return Yn().getThematicName(t)}closeInfoPanel(){mi().isInfoPanelShown=!1,setTimeout(()=>zi().activeAssociationId=null,300)}};EE([Ws("association")],Ap.prototype,"associationWatcher",1);Ap=EE([zr({components:{CopyToClipboard:YM}})],Ap);const JM=["shown"],QM=["src"],eD={class:"InfoPanel__head"},tD=["href"],nD=["src"],iD={key:0,class:"InfoPanel__email"},rD={key:0,class:"InfoPanel__otherEmailCtn"},sD={class:"InfoPanel__otherEmail"},aD={class:"InfoPanel__scrollableCtn"},oD={class:"InfoPanel__statusCtn"},lD={key:0},cD={class:"InfoPanel__statusRow"},uD={key:0,class:"InfoPanel__creationDate"},hD={key:1,class:"InfoPanel__cost"},dD=["src"],fD=Bt("span",{class:"InfoPanel__costTooltip"},"Budget moyen (fonctionnement et activits) au cours des 10 dernires annes",-1),pD=Bt("div",{class:"InfoPanel__divider"},null,-1),mD={class:"InfoPanel__descCtn"},gD={key:0,class:"InfoPanel__descItem"},_D=Bt("h2",null,"Territoires dintervention",-1),yD={key:1,class:"InfoPanel__descItem"},vD=Bt("h2",null,"Liens et dialogue avec des institutions",-1),xD={key:2,class:"InfoPanel__descItem"},bD=Bt("h2",null,"Thmatiques dintervention",-1),wD=Bt("div",{class:"InfoPanel__divider"},null,-1),SD={key:0,class:"InfoPanel__location"},ED=["src"],TD={key:1,class:"InfoPanel__updatedAt"};function CD(e,t,i,a,u,d){const p=lr("CopyToClipboard");return e.association!=null?(ln(),pn("div",{key:0,class:"InfoPanel",shown:e.isInfoPanelShown&&e.association!=null},[Bt("img",{class:"InfoPanel__closeIcon",src:e.getIconUrl("mdi-window-close-white"),alt:"Fermer le panneau",onClick:t[0]||(t[0]=(...l)=>e.closeInfoPanel&&e.closeInfoPanel(...l))},null,8,QM),Bt("div",eD,[Bt("h1",null,Ui(e.association.name),1),e.association.websiteUrl?(ln(),pn("a",{key:0,href:e.association.websiteUrl,target:"_blank"},[To(Ui(e.association.websiteUrl)+" ",1),Bt("img",{src:e.getIconUrl("mdi-open-in-new"),alt:"Nouvel onglet"},null,8,nD)],8,tD)):ar("",!0)]),e.association.emails&&e.association.emails.length&&e.association.emails[0]!=""?(ln(),pn("div",iD,[le(p,{label:e.association.emails[0]},null,8,["label"]),e.association.emails.length>1?(ln(),pn("div",rD,[(ln(!0),pn(gn,null,zc(e.association.emails.slice(1),l=>(ln(),pn("span",sD,Ui(l),1))),256))])):ar("",!0)])):ar("",!0),Bt("div",aD,[Bt("div",oD,[e.association.status?(ln(),pn("h2",lD,Ui(e.association.status),1)):ar("",!0),Bt("div",cD,[e.association.year?(ln(),pn("span",uD,"Cre en "+Ui(e.association.year),1)):ar("",!0),e.association.budget?(ln(),pn("span",hD,[To(Ui(e.association.budget)+" ",1),Bt("img",{src:e.getIconUrl("mdi-information-variant-circle-outline-white"),alt:"Localisation icon"},null,8,dD),fD])):ar("",!0)])]),pD,Bt("div",mD,[e.association.intervention?(ln(),pn("div",gD,[_D,Bt("span",null,Ui(e.association.intervention),1)])):ar("",!0),e.association.dialog?(ln(),pn("div",yD,[vD,Bt("span",null,Ui(e.association.dialog),1)])):ar("",!0),e.association.thematics.length?(ln(),pn("div",xD,[bD,Bt("ul",null,[(ln(!0),pn(gn,null,zc(e.association.thematics,(l,b)=>(ln(),pn("li",{key:b},Ui(e.getThematic(l)),1))),128))])])):ar("",!0)]),wD,e.association.adress?(ln(),pn("div",SD,[Bt("img",{src:e.getIconUrl("map-marker"),alt:"Localisation icon"},null,8,ED),Bt("span",null,Ui(e.association.adress),1)])):ar("",!0),e.association.updatedAt?(ln(),pn("div",TD,"Mise  jour "+Ui(e.association.updatedAt),1)):ar("",!0)])],8,JM)):ar("",!0)}const ID=Br(Ap,[["render",CD]]);var kD=Object.defineProperty,AD=Object.getOwnPropertyDescriptor,PD=(e,t,i,a)=>{for(var u=a>1?void 0:a?AD(t,i):t,d=e.length-1,p;d>=0;d--)(p=e[d])&&(u=(a?p(t,i,u):p(u))||u);return a&&u&&kD(t,i,u),u};let G_=class extends Or{openInfoPanel(){mi().isInfoPanelShown=!0}openRedirectionModal(){mi().isRedirectionModalShown=!0}get isInfoPanelShown(){return mi().isInfoPanelShown}};G_=PD([zr({components:{Map:FM,Button:vd,InfoPanel:ID}})],G_);const RD=["info-panel-shown"];function MD(e,t,i,a,u,d){const p=lr("InfoPanel"),l=lr("Map"),b=lr("Button");return ln(),pn("div",{class:"OSCMap","info-panel-shown":e.isInfoPanelShown},[le(p),le(l),le(b,{label:"Renseigner une association",class:"OSCMap__newAssocBtn",uppercase:!0,icon:"mdi-add",fill:!0,onClick:e.openRedirectionModal},null,8,["onClick"])],8,RD)}const DD=Br(G_,[["render",MD]]);var LD=Object.defineProperty,zD=Object.getOwnPropertyDescriptor,wv=(e,t,i,a)=>{for(var u=a>1?void 0:a?zD(t,i):t,d=e.length-1,p;d>=0;d--)(p=e[d])&&(u=(a?p(t,i,u):p(u))||u);return a&&u&&LD(t,i,u),u};let Jh=class extends Or{constructor(){super(...arguments);ei(this,"index");ei(this,"association")}get activeAssociationId(){return zi().activeAssociationId}get isActive(){return this.activeAssociationId===this.association.id}updateActiveAssociation(i){i===this.activeAssociationId?(mi().isInfoPanelShown=!1,setTimeout(()=>zi().activeAssociationId=null,300)):zi().activeAssociationId=i}updateHoveredAssociation(i){zi().hoveredAssociationId=i}};wv([Xr({default:0})],Jh.prototype,"index",2);wv([Xr({default:{}})],Jh.prototype,"association",2);Jh=wv([zr({})],Jh);const OD=["active"];function BD(e,t,i,a,u,d){return e.association!==void 0?(ln(),pn("div",{key:0,class:"AssociationListItem",active:e.isActive,onClick:t[0]||(t[0]=p=>e.updateActiveAssociation(e.association.id)),onMouseover:t[1]||(t[1]=p=>e.updateHoveredAssociation(e.association.id)),onMouseleave:t[2]||(t[2]=p=>e.updateHoveredAssociation(null))},Ui(e.association.name),41,OD)):ar("",!0)}const FD=Br(Jh,[["render",BD]]);var ND=Object.defineProperty,UD=Object.getOwnPropertyDescriptor,Sv=(e,t,i,a)=>{for(var u=a>1?void 0:a?UD(t,i):t,d=e.length-1,p;d>=0;d--)(p=e[d])&&(u=(a?p(t,i,u):p(u))||u);return a&&u&&ND(t,i,u),u};let Qh=class extends Or{constructor(){super(...arguments);ei(this,"associationlist")}get associations(){return zi().filteredAssociations}associationsWatcher(){this.associationlist&&(this.associationlist.scrollTop=0)}};Sv([gM],Qh.prototype,"associationlist",2);Sv([Ws("associations")],Qh.prototype,"associationsWatcher",1);Qh=Sv([zr({components:{AssociationListItem:FD}})],Qh);const $D={class:"AssociationList",ref:"associationlist"};function VD(e,t,i,a,u,d){const p=lr("AssociationListItem");return ln(),pn("div",$D,[(ln(!0),pn(gn,null,zc(e.associations,(l,b)=>(ln(),om(p,{association:l,key:b,index:b},null,8,["association","index"]))),128))],512)}const jD=Br(Qh,[["render",VD]]);var GD=Object.defineProperty,qD=Object.getOwnPropertyDescriptor,TE=(e,t,i,a)=>{for(var u=a>1?void 0:a?qD(t,i):t,d=e.length-1,p;d>=0;d--)(p=e[d])&&(u=(a?p(t,i,u):p(u))||u);return a&&u&&GD(t,i,u),u};let Pp=class extends Or{constructor(){super(...arguments);ei(this,"placeholder")}get filterStore(){return Yn()}updateSearch(i){Yn().search=i.target.value}};TE([Xr({default:"Rechercher une association"})],Pp.prototype,"placeholder",2);Pp=TE([zr({})],Pp);const HD=["placeholder"];function WD(e,t,i,a,u,d){return us((ln(),pn("input",{class:"InputSearch",type:"search",placeholder:e.placeholder,onKeyup:t[0]||(t[0]=(...p)=>e.updateSearch&&e.updateSearch(...p)),"onUpdate:modelValue":t[1]||(t[1]=p=>e.filterStore.search=p)},null,40,HD)),[[SP,e.filterStore.search]])}const ZD=Br(Pp,[["render",WD]]);var YD=Object.defineProperty,XD=Object.getOwnPropertyDescriptor,KD=(e,t,i,a)=>{for(var u=a>1?void 0:a?XD(t,i):t,d=e.length-1,p;d>=0;d--)(p=e[d])&&(u=(a?p(t,i,u):p(u))||u);return a&&u&&YD(t,i,u),u};let q_=class extends Or{get associations(){return zi().associations}get filteredAssociations(){return zi().filteredAssociations}get associationsCount(){return this.associations.length}get filteredAssociationsCount(){return this.filteredAssociations.length}get associationsCountLabel(){return this.filteredAssociationsCount+" association"+(this.filteredAssociationsCount>1?"s":"")+" sur "+this.associationsCount}get logoPath(){return"./img/logo-crpm.svg"}get isFiltersBarShown(){return mi().isFiltersBarShown}get isMapSynced(){return Yn().isMapSynced}get filterStore(){return Yn()}get toggleFiltersLabel(){return this.isFiltersBarShown?"Masquer":"Filtrer"}get toggleFiltersIcon(){return this.isFiltersBarShown?"mdi-window-close":"mdi-filter-variant"}toggleFiltersBar(){mi().isFiltersBarShown=!this.isFiltersBarShown}openAboutModal(){mi().isAboutModalShown=!0}};q_=KD([zr({components:{AssociationList:jD,Button:vd,InputSearch:ZD}})],q_);function Ev(e){return hv(()=>{const t=[],i={};return e.value.background&&(Bb(e.value.background)?i.backgroundColor=e.value.background:t.push(`bg-${e.value.background}`)),e.value.text&&(Bb(e.value.text)?(i.color=e.value.text,i.caretColor=e.value.text):t.push(`text-${e.value.text}`)),{colorClasses:t,colorStyles:i}})}function pa(e,t){const i=Ce(()=>({text:Kn(e)?e.value:t?e[t]:null})),{colorClasses:a,colorStyles:u}=Ev(i);return{textColorClasses:a,textColorStyles:u}}function ed(e,t){const i=Ce(()=>({background:Kn(e)?e.value:t?e[t]:null})),{colorClasses:a,colorStyles:u}=Ev(i);return{backgroundColorClasses:a,backgroundColorStyles:u}}const JD=["x-small","small","default","large","x-large"],pm=Ft({size:{type:[String,Number],default:"default"}},"size");function mm(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Mo();return hv(()=>{let i,a;return bp(JD,e.size)?i=`${t}--size-${e.size}`:e.size&&(a={width:mn(e.size),height:mn(e.size)}),{sizeClasses:i,sizeStyles:a}})}const ma=Ft({tag:{type:String,default:"div"}},"tag"),QD=Ft({color:String,start:Boolean,end:Boolean,icon:ki,...ci(),...pm(),...ma({tag:"i"}),...Yr()},"VIcon"),ls=Tn()({name:"VIcon",props:QD(),setup(e,t){let{attrs:i,slots:a}=t;const u=Kt(),{themeClasses:d}=Is(e),{iconData:p}=vR(Ce(()=>u.value||e.icon)),{sizeClasses:l}=mm(e),{textColorClasses:b,textColorStyles:w}=pa(wn(e,"color"));return Hn(()=>{var I,M;const C=(I=a.default)==null?void 0:I.call(a);return C&&(u.value=(M=KS(C).filter(O=>O.type===gd&&O.children&&typeof O.children=="string")[0])==null?void 0:M.children),le(p.value.component,{tag:e.tag,icon:p.value.icon,class:["v-icon","notranslate",d.value,l.value,b.value,{"v-icon--clickable":!!i.onClick,"v-icon--start":e.start,"v-icon--end":e.end},e.class],style:[l.value?void 0:{fontSize:mn(e.size),height:mn(e.size),width:mn(e.size)},w.value,e.style],role:i.onClick?"button":void 0,"aria-hidden":!i.onClick},{default:()=>[C]})}),{}}});function CE(e){const{t}=dm();function i(a){let{name:u}=a;const d={prepend:"prependAction",prependInner:"prependAction",append:"appendAction",appendInner:"appendAction",clear:"clear"}[u],p=e[`onClick:${u}`],l=p&&d?t(`$vuetify.input.${d}`,e.label??""):void 0;return le(ls,{icon:e[`${u}Icon`],"aria-label":l,onClick:p},null)}return{InputIcon:i}}const eL=Ft({disabled:Boolean,group:Boolean,hideOnLeave:Boolean,leaveAbsolute:Boolean,mode:String,origin:String},"transition");function hs(e,t,i){return Tn()({name:e,props:eL({mode:i,origin:t}),setup(a,u){let{slots:d}=u;const p={onBeforeEnter(l){a.origin&&(l.style.transformOrigin=a.origin)},onLeave(l){if(a.leaveAbsolute){const{offsetTop:b,offsetLeft:w,offsetWidth:C,offsetHeight:I}=l;l._transitionInitialStyles={position:l.style.position,top:l.style.top,left:l.style.left,width:l.style.width,height:l.style.height},l.style.position="absolute",l.style.top=`${b}px`,l.style.left=`${w}px`,l.style.width=`${C}px`,l.style.height=`${I}px`}a.hideOnLeave&&l.style.setProperty("display","none","important")},onAfterLeave(l){if(a.leaveAbsolute&&(l!=null&&l._transitionInitialStyles)){const{position:b,top:w,left:C,width:I,height:M}=l._transitionInitialStyles;delete l._transitionInitialStyles,l.style.position=b||"",l.style.top=w||"",l.style.left=C||"",l.style.width=I||"",l.style.height=M||""}}};return()=>{const l=a.group?_P:za;return Ro(l,{name:a.disabled?"":e,css:!a.disabled,...a.group?void 0:{mode:a.mode},...a.disabled?{}:p},d.default)}}})}function IE(e,t){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"in-out";return Tn()({name:e,props:{mode:{type:String,default:i},disabled:Boolean},setup(a,u){let{slots:d}=u;return()=>Ro(za,{name:a.disabled?"":e,css:!a.disabled,...a.disabled?{}:t},d.default)}})}function kE(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";const i=(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1)?"width":"height",a=Cs(`offset-${i}`);return{onBeforeEnter(p){p._parent=p.parentNode,p._initialStyle={transition:p.style.transition,overflow:p.style.overflow,[i]:p.style[i]}},onEnter(p){const l=p._initialStyle;p.style.setProperty("transition","none","important"),p.style.overflow="hidden";const b=`${p[a]}px`;p.style[i]="0",p.offsetHeight,p.style.transition=l.transition,e&&p._parent&&p._parent.classList.add(e),requestAnimationFrame(()=>{p.style[i]=b})},onAfterEnter:d,onEnterCancelled:d,onLeave(p){p._initialStyle={transition:"",overflow:p.style.overflow,[i]:p.style[i]},p.style.overflow="hidden",p.style[i]=`${p[a]}px`,p.offsetHeight,requestAnimationFrame(()=>p.style[i]="0")},onAfterLeave:u,onLeaveCancelled:u};function u(p){e&&p._parent&&p._parent.classList.remove(e),d(p)}function d(p){const l=p._initialStyle[i];p.style.overflow=p._initialStyle.overflow,l!=null&&(p.style[i]=l),delete p._initialStyle}}const tL=Ft({target:Object},"v-dialog-transition"),AE=Tn()({name:"VDialogTransition",props:tL(),setup(e,t){let{slots:i}=t;const a={onBeforeEnter(u){u.style.pointerEvents="none",u.style.visibility="hidden"},async onEnter(u,d){var M;await new Promise(O=>requestAnimationFrame(O)),await new Promise(O=>requestAnimationFrame(O)),u.style.visibility="";const{x:p,y:l,sx:b,sy:w,speed:C}=c1(e.target,u),I=Ac(u,[{transform:`translate(${p}px, ${l}px) scale(${b}, ${w})`,opacity:0},{}],{duration:225*C,easing:iR});(M=l1(u))==null||M.forEach(O=>{Ac(O,[{opacity:0},{opacity:0,offset:.33},{}],{duration:225*2*C,easing:Ep})}),I.finished.then(()=>d())},onAfterEnter(u){u.style.removeProperty("pointer-events")},onBeforeLeave(u){u.style.pointerEvents="none"},async onLeave(u,d){var M;await new Promise(O=>requestAnimationFrame(O));const{x:p,y:l,sx:b,sy:w,speed:C}=c1(e.target,u);Ac(u,[{},{transform:`translate(${p}px, ${l}px) scale(${b}, ${w})`,opacity:0}],{duration:125*C,easing:rR}).finished.then(()=>d()),(M=l1(u))==null||M.forEach(O=>{Ac(O,[{},{opacity:0,offset:.2},{opacity:0}],{duration:125*2*C,easing:Ep})})},onAfterLeave(u){u.style.removeProperty("pointer-events")}};return()=>e.target?le(za,Pn({name:"dialog-transition"},a,{css:!1}),i):le(za,{name:"dialog-transition"},i)}});function l1(e){var i;const t=(i=e.querySelector(":scope > .v-card, :scope > .v-sheet, :scope > .v-list"))==null?void 0:i.children;return t&&[...t]}function c1(e,t){const i=e.getBoundingClientRect(),a=fv(t),[u,d]=getComputedStyle(t).transformOrigin.split(" ").map(ce=>parseFloat(ce)),[p,l]=getComputedStyle(t).getPropertyValue("--v-overlay-anchor-origin").split(" ");let b=i.left+i.width/2;p==="left"||l==="left"?b-=i.width/2:(p==="right"||l==="right")&&(b+=i.width/2);let w=i.top+i.height/2;p==="top"||l==="top"?w-=i.height/2:(p==="bottom"||l==="bottom")&&(w+=i.height/2);const C=i.width/a.width,I=i.height/a.height,M=Math.max(1,C,I),O=C/M||0,j=I/M||0,Z=a.width*a.height/(window.innerWidth*window.innerHeight),ue=Z>.12?Math.min(1.5,(Z-.12)*10+1):1;return{x:b-(u+a.left),y:w-(d+a.top),sx:O,sy:j,speed:ue}}hs("fab-transition","center center","out-in");hs("dialog-bottom-transition");hs("dialog-top-transition");hs("fade-transition");hs("scale-transition");hs("scroll-x-transition");hs("scroll-x-reverse-transition");hs("scroll-y-transition");hs("scroll-y-reverse-transition");hs("slide-x-transition");hs("slide-x-reverse-transition");const PE=hs("slide-y-transition");hs("slide-y-reverse-transition");const nL=IE("expand-transition",kE()),RE=IE("expand-x-transition",kE("",!0)),au=Ft({transition:{type:[Boolean,String,Object],default:"fade-transition",validator:e=>e!==!0}},"transition"),yo=(e,t)=>{let{slots:i}=t;const{transition:a,disabled:u,...d}=e,{component:p=za,...l}=typeof a=="object"?a:{};return Ro(p,Pn(typeof a=="string"?{name:u?"":a}:l,d,{disabled:u}),i)},iL=Ft({active:Boolean,color:String,messages:{type:[Array,String],default:()=>[]},...ci(),...au({transition:{component:PE,leaveAbsolute:!0,group:!0}})},"VMessages"),rL=Tn()({name:"VMessages",props:iL(),setup(e,t){let{slots:i}=t;const a=Ce(()=>ua(e.messages)),{textColorClasses:u,textColorStyles:d}=pa(Ce(()=>e.color));return Hn(()=>le(yo,{transition:e.transition,tag:"div",class:["v-messages",u.value,e.class],style:[d.value,e.style],role:"alert","aria-live":"polite"},{default:()=>[e.active&&a.value.map((p,l)=>le("div",{class:"v-messages__message",key:`${l}-${a.value}`},[i.message?i.message({message:p}):p]))]})),{}}}),sL=[null,"default","comfortable","compact"],ou=Ft({density:{type:String,default:"default",validator:e=>sL.includes(e)}},"density");function lu(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Mo();return{densityClasses:Ce(()=>`${t}--density-${e.density}`)}}const ME=Ft({focused:Boolean,"onUpdate:focused":ha()},"focus");function Tv(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Mo();const i=Si(e,"focused"),a=Ce(()=>({[`${t}--focused`]:i.value}));function u(){i.value=!0}function d(){i.value=!1}return{focusClasses:a,isFocused:i,focus:u,blur:d}}const aL=Symbol.for("vuetify:form");function Cv(){return Jn(aL,null)}const oL=Ft({disabled:{type:Boolean,default:null},error:Boolean,errorMessages:{type:[Array,String],default:()=>[]},maxErrors:{type:[Number,String],default:1},name:String,label:String,readonly:{type:Boolean,default:null},rules:{type:Array,default:()=>[]},modelValue:null,validateOn:String,validationValue:null,...ME()},"validation");function lL(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Mo(),i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Hs();const a=Si(e,"modelValue"),u=Ce(()=>e.validationValue===void 0?a.value:e.validationValue),d=Cv(),p=Kt([]),l=Sn(!0),b=Ce(()=>!!(ua(a.value===""?null:a.value).length||ua(u.value===""?null:u.value).length)),w=Ce(()=>!!(e.disabled??(d==null?void 0:d.isDisabled.value))),C=Ce(()=>!!(e.readonly??(d==null?void 0:d.isReadonly.value))),I=Ce(()=>e.errorMessages.length?ua(e.errorMessages).slice(0,Math.max(0,+e.maxErrors)):p.value),M=Ce(()=>{let Ae=(e.validateOn??(d==null?void 0:d.validateOn.value))||"input";Ae==="lazy"&&(Ae="input lazy");const Be=new Set((Ae==null?void 0:Ae.split(" "))??[]);return{blur:Be.has("blur")||Be.has("input"),input:Be.has("input"),submit:Be.has("submit"),lazy:Be.has("lazy")}}),O=Ce(()=>e.error||e.errorMessages.length?!1:e.rules.length?l.value?p.value.length||M.value.lazy?null:!0:!p.value.length:!0),j=Sn(!1),Z=Ce(()=>({[`${t}--error`]:O.value===!1,[`${t}--dirty`]:b.value,[`${t}--disabled`]:w.value,[`${t}--readonly`]:C.value})),ue=Ce(()=>e.name??ur(i));Qy(()=>{d==null||d.register({id:ue.value,validate:ye,reset:ce,resetValidation:ve})}),Va(()=>{d==null||d.unregister(ue.value)}),wl(async()=>{M.value.lazy||await ye(!0),d==null||d.update(ue.value,O.value,I.value)}),vl(()=>M.value.input,()=>{En(u,()=>{if(u.value!=null)ye();else if(e.focused){const Ae=En(()=>e.focused,Be=>{Be||ye(),Ae()})}})}),vl(()=>M.value.blur,()=>{En(()=>e.focused,Ae=>{Ae||ye()})}),En(O,()=>{d==null||d.update(ue.value,O.value,I.value)});function ce(){a.value=null,yr(ve)}function ve(){l.value=!0,M.value.lazy?p.value=[]:ye(!0)}async function ye(){let Ae=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const Be=[];j.value=!0;for(const Le of e.rules){if(Be.length>=+(e.maxErrors??1))break;const U=await(typeof Le=="function"?Le:()=>Le)(u.value);if(U!==!0){if(U!==!1&&typeof U!="string"){console.warn(`${U} is not a valid value. Rule functions must return boolean true or a string.`);continue}Be.push(U||"")}}return p.value=Be,j.value=!1,l.value=Ae,p.value}return{errorMessages:I,isDirty:b,isDisabled:w,isReadonly:C,isPristine:l,isValid:O,isValidating:j,reset:ce,resetValidation:ve,validate:ye,validationClasses:Z}}const Iv=Ft({id:String,appendIcon:ki,centerAffix:{type:Boolean,default:!0},prependIcon:ki,hideDetails:[Boolean,String],hint:String,persistentHint:Boolean,messages:{type:[Array,String],default:()=>[]},direction:{type:String,default:"horizontal",validator:e=>["horizontal","vertical"].includes(e)},"onClick:prepend":ha(),"onClick:append":ha(),...ci(),...ou(),...oL()},"VInput"),Rp=Tn()({name:"VInput",props:{...Iv()},emits:{"update:modelValue":e=>!0},setup(e,t){let{attrs:i,slots:a,emit:u}=t;const{densityClasses:d}=lu(e),{rtlClasses:p}=su(),{InputIcon:l}=CE(e),b=Hs(),w=Ce(()=>e.id||`input-${b}`),C=Ce(()=>`${w.value}-messages`),{errorMessages:I,isDirty:M,isDisabled:O,isReadonly:j,isPristine:Z,isValid:ue,isValidating:ce,reset:ve,resetValidation:ye,validate:Ae,validationClasses:Be}=lL(e,"v-input",w),Le=Ce(()=>({id:w,messagesId:C,isDirty:M,isDisabled:O,isReadonly:j,isPristine:Z,isValid:ue,isValidating:ce,reset:ve,resetValidation:ye,validate:Ae})),Ie=Ce(()=>{var U;return(U=e.errorMessages)!=null&&U.length||!Z.value&&I.value.length?I.value:e.hint&&(e.persistentHint||e.focused)?e.hint:e.messages});return Hn(()=>{var we,oe,ke,tt;const U=!!(a.prepend||e.prependIcon),H=!!(a.append||e.appendIcon),he=Ie.value.length>0,xe=!e.hideDetails||e.hideDetails==="auto"&&(he||!!a.details);return le("div",{class:["v-input",`v-input--${e.direction}`,{"v-input--center-affix":e.centerAffix},d.value,p.value,Be.value,e.class],style:e.style},[U&&le("div",{key:"prepend",class:"v-input__prepend"},[(we=a.prepend)==null?void 0:we.call(a,Le.value),e.prependIcon&&le(l,{key:"prepend-icon",name:"prepend"},null)]),a.default&&le("div",{class:"v-input__control"},[(oe=a.default)==null?void 0:oe.call(a,Le.value)]),H&&le("div",{key:"append",class:"v-input__append"},[e.appendIcon&&le(l,{key:"append-icon",name:"append"},null),(ke=a.append)==null?void 0:ke.call(a,Le.value)]),xe&&le("div",{class:"v-input__details"},[le(rL,{id:C.value,active:he,messages:Ie.value},{message:a.message}),(tt=a.details)==null?void 0:tt.call(a,Le.value)])])}),{reset:ve,resetValidation:ye,validate:Ae}}});function DE(e,t){const i=Kt(),a=Sn(!1);if(gv){const u=new IntersectionObserver(d=>{e==null||e(d,u),a.value=!!d.find(p=>p.isIntersecting)},t);Va(()=>{u.disconnect()}),En(i,(d,p)=>{p&&(u.unobserve(p),a.value=!1),d&&u.observe(d)},{flush:"post"})}return{intersectionRef:i,isIntersecting:a}}const cL=Ft({bgColor:String,color:String,indeterminate:[Boolean,String],modelValue:{type:[Number,String],default:0},rotate:{type:[Number,String],default:0},width:{type:[Number,String],default:4},...ci(),...pm(),...ma({tag:"div"}),...Yr()},"VProgressCircular"),uL=Tn()({name:"VProgressCircular",props:cL(),setup(e,t){let{slots:i}=t;const a=20,u=2*Math.PI*a,d=Kt(),{themeClasses:p}=Is(e),{sizeClasses:l,sizeStyles:b}=mm(e),{textColorClasses:w,textColorStyles:C}=pa(wn(e,"color")),{textColorClasses:I,textColorStyles:M}=pa(wn(e,"bgColor")),{intersectionRef:O,isIntersecting:j}=DE(),{resizeRef:Z,contentRect:ue}=pE(),ce=Ce(()=>Math.max(0,Math.min(100,parseFloat(e.modelValue)))),ve=Ce(()=>Number(e.width)),ye=Ce(()=>b.value?Number(e.size):ue.value?ue.value.width:Math.max(ve.value,32)),Ae=Ce(()=>a/(1-ve.value/ye.value)*2),Be=Ce(()=>ve.value/ye.value*Ae.value),Le=Ce(()=>mn((100-ce.value)/100*u));return Ua(()=>{O.value=d.value,Z.value=d.value}),Hn(()=>le(e.tag,{ref:d,class:["v-progress-circular",{"v-progress-circular--indeterminate":!!e.indeterminate,"v-progress-circular--visible":j.value,"v-progress-circular--disable-shrink":e.indeterminate==="disable-shrink"},p.value,l.value,w.value,e.class],style:[b.value,C.value,e.style],role:"progressbar","aria-valuemin":"0","aria-valuemax":"100","aria-valuenow":e.indeterminate?void 0:ce.value},{default:()=>[le("svg",{style:{transform:`rotate(calc(-90deg + ${Number(e.rotate)}deg))`},xmlns:"http://www.w3.org/2000/svg",viewBox:`0 0 ${Ae.value} ${Ae.value}`},[le("circle",{class:["v-progress-circular__underlay",I.value],style:M.value,fill:"transparent",cx:"50%",cy:"50%",r:a,"stroke-width":Be.value,"stroke-dasharray":u,"stroke-dashoffset":0},null),le("circle",{class:"v-progress-circular__overlay",fill:"transparent",cx:"50%",cy:"50%",r:a,"stroke-width":Be.value,"stroke-dasharray":u,"stroke-dashoffset":Le.value},null)]),i.default&&le("div",{class:"v-progress-circular__content"},[i.default({value:ce.value})])]})),{}}}),hL=Ft({text:String,clickable:Boolean,...ci(),...Yr()},"VLabel"),LE=Tn()({name:"VLabel",props:hL(),setup(e,t){let{slots:i}=t;return Hn(()=>{var a;return le("label",{class:["v-label",{"v-label--clickable":e.clickable},e.class],style:e.style},[e.text,(a=i.default)==null?void 0:a.call(i)])}),{}}}),zE=Symbol.for("vuetify:selection-control-group"),OE=Ft({color:String,disabled:Boolean,defaultsTarget:String,error:Boolean,id:String,inline:Boolean,falseIcon:ki,trueIcon:ki,ripple:{type:Boolean,default:!0},multiple:{type:Boolean,default:null},name:String,readonly:Boolean,modelValue:null,type:String,valueComparator:{type:Function,default:iu},...ci(),...ou(),...Yr()},"SelectionControlGroup"),dL=Ft({...OE({defaultsTarget:"VSelectionControl"})},"VSelectionControlGroup");Tn()({name:"VSelectionControlGroup",props:dL(),emits:{"update:modelValue":e=>!0},setup(e,t){let{slots:i}=t;const a=Si(e,"modelValue"),u=Hs(),d=Ce(()=>e.id||`v-selection-control-group-${u}`),p=Ce(()=>e.name||d.value),l=new Set;return _r(zE,{modelValue:a,forceUpdate:()=>{l.forEach(b=>b())},onForceUpdate:b=>{l.add(b),Wr(()=>{l.delete(b)})}}),yd({[e.defaultsTarget]:{color:wn(e,"color"),disabled:wn(e,"disabled"),density:wn(e,"density"),error:wn(e,"error"),inline:wn(e,"inline"),modelValue:a,multiple:Ce(()=>!!e.multiple||e.multiple==null&&Array.isArray(a.value)),name:p,falseIcon:wn(e,"falseIcon"),trueIcon:wn(e,"trueIcon"),readonly:wn(e,"readonly"),ripple:wn(e,"ripple"),type:wn(e,"type"),valueComparator:wn(e,"valueComparator")}}),Hn(()=>{var b;return le("div",{class:["v-selection-control-group",{"v-selection-control-group--inline":e.inline},e.class],style:e.style,role:e.type==="radio"?"radiogroup":void 0},[(b=i.default)==null?void 0:b.call(i)])}),{}}});const H_=Symbol("rippleStop"),fL=80;function u1(e,t){e.style.transform=t,e.style.webkitTransform=t}function W_(e){return e.constructor.name==="TouchEvent"}function BE(e){return e.constructor.name==="KeyboardEvent"}const pL=function(e,t){var I;let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},a=0,u=0;if(!BE(e)){const M=t.getBoundingClientRect(),O=W_(e)?e.touches[e.touches.length-1]:e;a=O.clientX-M.left,u=O.clientY-M.top}let d=0,p=.3;(I=t._ripple)!=null&&I.circle?(p=.15,d=t.clientWidth/2,d=i.center?d:d+Math.sqrt((a-d)**2+(u-d)**2)/4):d=Math.sqrt(t.clientWidth**2+t.clientHeight**2)/2;const l=`${(t.clientWidth-d*2)/2}px`,b=`${(t.clientHeight-d*2)/2}px`,w=i.center?l:`${a-d}px`,C=i.center?b:`${u-d}px`;return{radius:d,scale:p,x:w,y:C,centerX:l,centerY:b}},Mp={show(e,t){var O;let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(!((O=t==null?void 0:t._ripple)!=null&&O.enabled))return;const a=document.createElement("span"),u=document.createElement("span");a.appendChild(u),a.className="v-ripple__container",i.class&&(a.className+=` ${i.class}`);const{radius:d,scale:p,x:l,y:b,centerX:w,centerY:C}=pL(e,t,i),I=`${d*2}px`;u.className="v-ripple__animation",u.style.width=I,u.style.height=I,t.appendChild(a);const M=window.getComputedStyle(t);M&&M.position==="static"&&(t.style.position="relative",t.dataset.previousPosition="static"),u.classList.add("v-ripple__animation--enter"),u.classList.add("v-ripple__animation--visible"),u1(u,`translate(${l}, ${b}) scale3d(${p},${p},${p})`),u.dataset.activated=String(performance.now()),setTimeout(()=>{u.classList.remove("v-ripple__animation--enter"),u.classList.add("v-ripple__animation--in"),u1(u,`translate(${w}, ${C}) scale3d(1,1,1)`)},0)},hide(e){var d;if(!((d=e==null?void 0:e._ripple)!=null&&d.enabled))return;const t=e.getElementsByClassName("v-ripple__animation");if(t.length===0)return;const i=t[t.length-1];if(i.dataset.isHiding)return;i.dataset.isHiding="true";const a=performance.now()-Number(i.dataset.activated),u=Math.max(250-a,0);setTimeout(()=>{i.classList.remove("v-ripple__animation--in"),i.classList.add("v-ripple__animation--out"),setTimeout(()=>{var l;e.getElementsByClassName("v-ripple__animation").length===1&&e.dataset.previousPosition&&(e.style.position=e.dataset.previousPosition,delete e.dataset.previousPosition),((l=i.parentNode)==null?void 0:l.parentNode)===e&&e.removeChild(i.parentNode)},300)},u)}};function FE(e){return typeof e>"u"||!!e}function td(e){const t={},i=e.currentTarget;if(!(!(i!=null&&i._ripple)||i._ripple.touched||e[H_])){if(e[H_]=!0,W_(e))i._ripple.touched=!0,i._ripple.isTouch=!0;else if(i._ripple.isTouch)return;if(t.center=i._ripple.centered||BE(e),i._ripple.class&&(t.class=i._ripple.class),W_(e)){if(i._ripple.showTimerCommit)return;i._ripple.showTimerCommit=()=>{Mp.show(e,i,t)},i._ripple.showTimer=window.setTimeout(()=>{var a;(a=i==null?void 0:i._ripple)!=null&&a.showTimerCommit&&(i._ripple.showTimerCommit(),i._ripple.showTimerCommit=null)},fL)}else Mp.show(e,i,t)}}function h1(e){e[H_]=!0}function os(e){const t=e.currentTarget;if(t!=null&&t._ripple){if(window.clearTimeout(t._ripple.showTimer),e.type==="touchend"&&t._ripple.showTimerCommit){t._ripple.showTimerCommit(),t._ripple.showTimerCommit=null,t._ripple.showTimer=window.setTimeout(()=>{os(e)});return}window.setTimeout(()=>{t._ripple&&(t._ripple.touched=!1)}),Mp.hide(t)}}function NE(e){const t=e.currentTarget;t!=null&&t._ripple&&(t._ripple.showTimerCommit&&(t._ripple.showTimerCommit=null),window.clearTimeout(t._ripple.showTimer))}let nd=!1;function UE(e){!nd&&(e.keyCode===Pb.enter||e.keyCode===Pb.space)&&(nd=!0,td(e))}function $E(e){nd=!1,os(e)}function VE(e){nd&&(nd=!1,os(e))}function jE(e,t,i){const{value:a,modifiers:u}=t,d=FE(a);if(d||Mp.hide(e),e._ripple=e._ripple??{},e._ripple.enabled=d,e._ripple.centered=u.center,e._ripple.circle=u.circle,z_(a)&&a.class&&(e._ripple.class=a.class),d&&!i){if(u.stop){e.addEventListener("touchstart",h1,{passive:!0}),e.addEventListener("mousedown",h1);return}e.addEventListener("touchstart",td,{passive:!0}),e.addEventListener("touchend",os,{passive:!0}),e.addEventListener("touchmove",NE,{passive:!0}),e.addEventListener("touchcancel",os),e.addEventListener("mousedown",td),e.addEventListener("mouseup",os),e.addEventListener("mouseleave",os),e.addEventListener("keydown",UE),e.addEventListener("keyup",$E),e.addEventListener("blur",VE),e.addEventListener("dragstart",os,{passive:!0})}else!d&&i&&GE(e)}function GE(e){e.removeEventListener("mousedown",td),e.removeEventListener("touchstart",td),e.removeEventListener("touchend",os),e.removeEventListener("touchmove",NE),e.removeEventListener("touchcancel",os),e.removeEventListener("mouseup",os),e.removeEventListener("mouseleave",os),e.removeEventListener("keydown",UE),e.removeEventListener("keyup",$E),e.removeEventListener("dragstart",os),e.removeEventListener("blur",VE)}function mL(e,t){jE(e,t,!1)}function gL(e){delete e._ripple,GE(e)}function _L(e,t){if(t.value===t.oldValue)return;const i=FE(t.oldValue);jE(e,t,i)}const kv={mounted:mL,unmounted:gL,updated:_L},Av=Ft({label:String,trueValue:null,falseValue:null,value:null,...ci(),...OE()},"VSelectionControl");function yL(e){const t=Jn(zE,void 0),{densityClasses:i}=lu(e),a=Si(e,"modelValue"),u=Ce(()=>e.trueValue!==void 0?e.trueValue:e.value!==void 0?e.value:!0),d=Ce(()=>e.falseValue!==void 0?e.falseValue:!1),p=Ce(()=>!!e.multiple||e.multiple==null&&Array.isArray(a.value)),l=Ce({get(){const I=t?t.modelValue.value:a.value;return p.value?I.some(M=>e.valueComparator(M,u.value)):e.valueComparator(I,u.value)},set(I){if(e.readonly)return;const M=I?u.value:d.value;let O=M;p.value&&(O=I?[...ua(a.value),M]:ua(a.value).filter(j=>!e.valueComparator(j,u.value))),t?t.modelValue.value=O:a.value=O}}),{textColorClasses:b,textColorStyles:w}=pa(Ce(()=>l.value&&!e.error&&!e.disabled?e.color:void 0)),C=Ce(()=>l.value?e.trueIcon:e.falseIcon);return{group:t,densityClasses:i,trueValue:u,falseValue:d,model:l,textColorClasses:b,textColorStyles:w,icon:C}}const Z_=Tn()({name:"VSelectionControl",directives:{Ripple:kv},inheritAttrs:!1,props:Av(),emits:{"update:modelValue":e=>!0},setup(e,t){let{attrs:i,slots:a}=t;const{group:u,densityClasses:d,icon:p,model:l,textColorClasses:b,textColorStyles:w,trueValue:C}=yL(e),I=Hs(),M=Ce(()=>e.id||`input-${I}`),O=Sn(!1),j=Sn(!1),Z=Kt();u==null||u.onForceUpdate(()=>{Z.value&&(Z.value.checked=l.value)});function ue(ye){O.value=!0,(!N_||N_&&ye.target.matches(":focus-visible"))&&(j.value=!0)}function ce(){O.value=!1,j.value=!1}function ve(ye){e.readonly&&u&&yr(()=>u.forceUpdate()),l.value=ye.target.checked}return Hn(()=>{var Le,Ie;const ye=a.label?a.label({label:e.label,props:{for:M.value}}):e.label,[Ae,Be]=uv(i);return le("div",Pn({class:["v-selection-control",{"v-selection-control--dirty":l.value,"v-selection-control--disabled":e.disabled,"v-selection-control--error":e.error,"v-selection-control--focused":O.value,"v-selection-control--focus-visible":j.value,"v-selection-control--inline":e.inline},d.value,e.class]},Ae,{style:e.style}),[le("div",{class:["v-selection-control__wrapper",b.value],style:w.value},[(Le=a.default)==null?void 0:Le.call(a),us(le("div",{class:["v-selection-control__input"]},[p.value&&le(ls,{key:"icon",icon:p.value},null),le("input",Pn({ref:Z,checked:l.value,disabled:e.disabled,id:M.value,onBlur:ce,onFocus:ue,onInput:ve,"aria-disabled":e.readonly,type:e.type,value:C.value,name:e.name,"aria-checked":e.type==="checkbox"?l.value:void 0},Be),null),(Ie=a.input)==null?void 0:Ie.call(a,{model:l,textColorClasses:b,textColorStyles:w,props:{onFocus:ue,onBlur:ce,id:M.value}})]),[[yl("ripple"),e.ripple&&[!e.disabled&&!e.readonly,null,["center","circle"]]]])]),ye&&le(LE,{for:M.value,clickable:!0},{default:()=>[ye]})])}),{isFocused:O,input:Z}}}),d1={center:"center",top:"bottom",bottom:"top",left:"right",right:"left"},vL=Ft({location:String},"location");function xL(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=arguments.length>2?arguments[2]:void 0;const{isRtl:a}=su();return{locationStyles:Ce(()=>{if(!e.location)return{};const{side:d,align:p}=F_(e.location.split(" ").length>1?e.location:`${e.location} center`,a.value);function l(w){return i?i(w):0}const b={};return d!=="center"&&(t?b[d1[d]]=`calc(100% - ${l(d)}px)`:b[d]=0),p!=="center"?t?b[d1[p]]=`calc(100% - ${l(p)}px)`:b[p]=0:(d==="center"?b.top=b.left="50%":b[{top:"left",bottom:"left",left:"top",right:"top"}[d]]="50%",b.transform={top:"translateX(-50%)",bottom:"translateX(-50%)",left:"translateY(-50%)",right:"translateY(-50%)",center:"translate(-50%, -50%)"}[d]),b})}}const cu=Ft({rounded:{type:[Boolean,Number,String],default:void 0}},"rounded");function uu(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Mo();return{roundedClasses:Ce(()=>{const a=Kn(e)?e.value:e.rounded,u=[];if(a===!0||a==="")u.push(`${t}--rounded`);else if(typeof a=="string"||a===0)for(const d of String(a).split(" "))u.push(`rounded-${d}`);return u})}}const bL=Ft({absolute:Boolean,active:{type:Boolean,default:!0},bgColor:String,bgOpacity:[Number,String],bufferValue:{type:[Number,String],default:0},clickable:Boolean,color:String,height:{type:[Number,String],default:4},indeterminate:Boolean,max:{type:[Number,String],default:100},modelValue:{type:[Number,String],default:0},reverse:Boolean,stream:Boolean,striped:Boolean,roundedBar:Boolean,...ci(),...vL({location:"top"}),...cu(),...ma(),...Yr()},"VProgressLinear"),wL=Tn()({name:"VProgressLinear",props:bL(),emits:{"update:modelValue":e=>!0},setup(e,t){let{slots:i}=t;const a=Si(e,"modelValue"),{isRtl:u,rtlClasses:d}=su(),{themeClasses:p}=Is(e),{locationStyles:l}=xL(e),{textColorClasses:b,textColorStyles:w}=pa(e,"color"),{backgroundColorClasses:C,backgroundColorStyles:I}=ed(Ce(()=>e.bgColor||e.color)),{backgroundColorClasses:M,backgroundColorStyles:O}=ed(e,"color"),{roundedClasses:j}=uu(e),{intersectionRef:Z,isIntersecting:ue}=DE(),ce=Ce(()=>parseInt(e.max,10)),ve=Ce(()=>parseInt(e.height,10)),ye=Ce(()=>parseFloat(e.bufferValue)/ce.value*100),Ae=Ce(()=>parseFloat(a.value)/ce.value*100),Be=Ce(()=>u.value!==e.reverse),Le=Ce(()=>e.indeterminate?"fade-transition":"slide-x-transition"),Ie=Ce(()=>e.bgOpacity==null?e.bgOpacity:parseFloat(e.bgOpacity));function U(H){if(!Z.value)return;const{left:he,right:xe,width:we}=Z.value.getBoundingClientRect(),oe=Be.value?we-H.clientX+(xe-we):H.clientX-he;a.value=Math.round(oe/we*ce.value)}return Hn(()=>le(e.tag,{ref:Z,class:["v-progress-linear",{"v-progress-linear--absolute":e.absolute,"v-progress-linear--active":e.active&&ue.value,"v-progress-linear--reverse":Be.value,"v-progress-linear--rounded":e.rounded,"v-progress-linear--rounded-bar":e.roundedBar,"v-progress-linear--striped":e.striped},j.value,p.value,d.value,e.class],style:[{bottom:e.location==="bottom"?0:void 0,top:e.location==="top"?0:void 0,height:e.active?mn(ve.value):0,"--v-progress-linear-height":mn(ve.value),...l.value},e.style],role:"progressbar","aria-hidden":e.active?"false":"true","aria-valuemin":"0","aria-valuemax":e.max,"aria-valuenow":e.indeterminate?void 0:Ae.value,onClick:e.clickable&&U},{default:()=>[e.stream&&le("div",{key:"stream",class:["v-progress-linear__stream",b.value],style:{...w.value,[Be.value?"left":"right"]:mn(-ve.value),borderTop:`${mn(ve.value/2)} dotted`,opacity:Ie.value,top:`calc(50% - ${mn(ve.value/4)})`,width:mn(100-ye.value,"%"),"--v-progress-linear-stream-to":mn(ve.value*(Be.value?1:-1))}},null),le("div",{class:["v-progress-linear__background",C.value],style:[I.value,{opacity:Ie.value,width:mn(e.stream?ye.value:100,"%")}]},null),le(za,{name:Le.value},{default:()=>[e.indeterminate?le("div",{class:"v-progress-linear__indeterminate"},[["long","short"].map(H=>le("div",{key:H,class:["v-progress-linear__indeterminate",H,M.value],style:O.value},null))]):le("div",{class:["v-progress-linear__determinate",M.value],style:[O.value,{width:mn(Ae.value,"%")}]},null)]}),i.default&&le("div",{class:"v-progress-linear__content"},[i.default({value:Ae.value,buffer:ye.value})])]})),{}}}),SL=Ft({loading:[Boolean,String]},"loader");function qE(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Mo();return{loaderClasses:Ce(()=>({[`${t}--loading`]:e.loading}))}}function HE(e,t){var a;let{slots:i}=t;return le("div",{class:`${e.name}__loader`},[((a=i.default)==null?void 0:a.call(i,{color:e.color,isActive:e.active}))||le(wL,{active:e.active,color:e.color,height:"2",indeterminate:!0},null)])}const EL=Ft({indeterminate:Boolean,inset:Boolean,flat:Boolean,loading:{type:[Boolean,String],default:!1},...Iv(),...Av()},"VSwitch"),TL=Tn()({name:"VSwitch",inheritAttrs:!1,props:EL(),emits:{"update:focused":e=>!0,"update:modelValue":()=>!0,"update:indeterminate":e=>!0},setup(e,t){let{attrs:i,slots:a}=t;const u=Si(e,"indeterminate"),d=Si(e,"modelValue"),{loaderClasses:p}=qE(e),{isFocused:l,focus:b,blur:w}=Tv(e),C=Ce(()=>typeof e.loading=="string"&&e.loading!==""?e.loading:e.color),I=Hs(),M=Ce(()=>e.id||`switch-${I}`);function O(){u.value&&(u.value=!1)}return Hn(()=>{const[j,Z]=uv(i),[ue,ce]=Rp.filterProps(e),[ve,ye]=Z_.filterProps(e),Ae=Kt();function Be(Le){var Ie,U;Le.stopPropagation(),Le.preventDefault(),(U=(Ie=Ae.value)==null?void 0:Ie.input)==null||U.click()}return le(Rp,Pn({class:["v-switch",{"v-switch--inset":e.inset},{"v-switch--indeterminate":u.value},p.value,e.class],style:e.style},j,ue,{id:M.value,focused:l.value}),{...a,default:Le=>{let{id:Ie,messagesId:U,isDisabled:H,isReadonly:he,isValid:xe}=Le;return le(Z_,Pn({ref:Ae},ve,{modelValue:d.value,"onUpdate:modelValue":[we=>d.value=we,O],id:Ie.value,"aria-describedby":U.value,type:"checkbox","aria-checked":u.value?"mixed":void 0,disabled:H.value,readonly:he.value,onFocus:b,onBlur:w},Z),{...a,default:()=>le("div",{class:"v-switch__track",onClick:Be},null),input:we=>{let{textColorClasses:oe,textColorStyles:ke}=we;return le("div",{class:["v-switch__thumb",oe.value],style:ke.value},[e.loading&&le(HE,{name:"v-switch",active:!0,color:xe.value===!1?void 0:C.value},{default:tt=>a.loader?a.loader(tt):le(uL,{active:tt.isActive,color:tt.color,indeterminate:!0,size:"16",width:"2"},null)})])}})}})}),{}}}),CL={class:"AssociationBar"},IL={class:"AssociationBar__ctn AssociationBar__ctn--top"},kL={class:"AssociationBar__head"},AL={class:"AssociationBar__count"},PL={class:"AssociationBar__ctn AssociationBar__ctn--bottom"},RL=Bt("div",{class:"AssociationBar__divider"},null,-1),ML=["src"];function DL(e,t,i,a,u,d){const p=lr("Button"),l=lr("InputSearch"),b=lr("AssociationList");return ln(),pn("div",CL,[Bt("div",IL,[Bt("div",kL,[Bt("h3",AL,Ui(e.associationsCountLabel),1),le(p,{onClick:e.toggleFiltersBar,class:"AssociationBar__toggleFiltersBtn",label:e.toggleFiltersLabel,uppercase:!0,small:!0,toggled:e.isFiltersBarShown,icon:e.toggleFiltersIcon},null,8,["onClick","label","toggled","icon"])]),le(l),le(b),le(TL,{class:Jp("AssociationBar__switchMap"+(e.isMapSynced?" active":"")),label:"Synchroniser avec la carte",inset:"","hide-details":"auto",modelValue:e.filterStore.isMapSynced,"onUpdate:modelValue":t[0]||(t[0]=w=>e.filterStore.isMapSynced=w)},null,8,["class","modelValue"])]),Bt("div",PL,[RL,Bt("img",{src:e.logoPath,alt:"Logo CRPM",class:"AssociationBar__crpmLogo"},null,8,ML),le(p,{onClick:e.openAboutModal,class:"AssociationBar__aboutBtn",label:" propos du projet",uppercase:!0,icon:"mdi-information-variant-circle-outline"},null,8,["onClick"])])])}const LL=Br(q_,[["render",DL]]);var zL=Object.defineProperty,OL=Object.getOwnPropertyDescriptor,El=(e,t,i,a)=>{for(var u=a>1?void 0:a?OL(t,i):t,d=e.length-1,p;d>=0;d--)(p=e[d])&&(u=(a?p(t,i,u):p(u))||u);return a&&u&&zL(t,i,u),u};let Ba=class extends Or{constructor(){super(...arguments);ei(this,"selected",[]);ei(this,"label");ei(this,"data");ei(this,"reset")}selectedWatcher(){this.onSelected()}resetWatcher(){this.selected=[]}onSelected(){return this.selected}};El([Xr({default:"Button label"})],Ba.prototype,"label",2);El([Xr({default:[]})],Ba.prototype,"data",2);El([Xr({default:!1})],Ba.prototype,"reset",2);El([Ws("selected")],Ba.prototype,"selectedWatcher",1);El([Ws("reset")],Ba.prototype,"resetWatcher",1);El([wM()],Ba.prototype,"onSelected",1);Ba=El([zr({})],Ba);const BL=Ft({indeterminate:Boolean,indeterminateIcon:{type:ki,default:"$checkboxIndeterminate"},...Av({falseIcon:"$checkboxOff",trueIcon:"$checkboxOn"})},"VCheckboxBtn"),WE=Tn()({name:"VCheckboxBtn",props:BL(),emits:{"update:modelValue":e=>!0,"update:indeterminate":e=>!0},setup(e,t){let{slots:i}=t;const a=Si(e,"indeterminate"),u=Si(e,"modelValue");function d(b){a.value&&(a.value=!1)}const p=Ce(()=>a.value?e.indeterminateIcon:e.falseIcon),l=Ce(()=>a.value?e.indeterminateIcon:e.trueIcon);return Hn(()=>le(Z_,Pn(e,{modelValue:u.value,"onUpdate:modelValue":[b=>u.value=b,d],class:["v-checkbox-btn",e.class],style:e.style,type:"checkbox",falseIcon:p.value,trueIcon:l.value,"aria-checked":a.value?"mixed":void 0}),i)),{}}}),gm=Ft({height:[Number,String],maxHeight:[Number,String],maxWidth:[Number,String],minHeight:[Number,String],minWidth:[Number,String],width:[Number,String]},"dimension");function _m(e){return{dimensionStyles:Ce(()=>({height:mn(e.height),maxHeight:mn(e.maxHeight),maxWidth:mn(e.maxWidth),minHeight:mn(e.minHeight),minWidth:mn(e.minWidth),width:mn(e.width)}))}}function FL(e){return{aspectStyles:Ce(()=>{const t=Number(e.aspectRatio);return t?{paddingBottom:String(1/t*100)+"%"}:void 0})}}const ZE=Ft({aspectRatio:[String,Number],contentClass:String,inline:Boolean,...ci(),...gm()},"VResponsive"),f1=Tn()({name:"VResponsive",props:ZE(),setup(e,t){let{slots:i}=t;const{aspectStyles:a}=FL(e),{dimensionStyles:u}=_m(e);return Hn(()=>{var d;return le("div",{class:["v-responsive",{"v-responsive--inline":e.inline},e.class],style:[u.value,e.style]},[le("div",{class:"v-responsive__sizer",style:a.value},null),(d=i.additional)==null?void 0:d.call(i),i.default&&le("div",{class:["v-responsive__content",e.contentClass]},[i.default()])])}),{}}});function NL(e,t){if(!gv)return;const i=t.modifiers||{},a=t.value,{handler:u,options:d}=typeof a=="object"?a:{handler:a,options:{}},p=new IntersectionObserver(function(){var I;let l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],b=arguments.length>1?arguments[1]:void 0;const w=(I=e._observe)==null?void 0:I[t.instance.$.uid];if(!w)return;const C=l.some(M=>M.isIntersecting);u&&(!i.quiet||w.init)&&(!i.once||C||w.init)&&u(C,l,b),C&&i.once?YE(e,t):w.init=!0},d);e._observe=Object(e._observe),e._observe[t.instance.$.uid]={init:!1,observer:p},p.observe(e)}function YE(e,t){var a;const i=(a=e._observe)==null?void 0:a[t.instance.$.uid];i&&(i.observer.unobserve(e),delete e._observe[t.instance.$.uid])}const UL={mounted:NL,unmounted:YE},XE=UL,$L=Ft({alt:String,cover:Boolean,eager:Boolean,gradient:String,lazySrc:String,options:{type:Object,default:()=>({root:void 0,rootMargin:void 0,threshold:void 0})},sizes:String,src:{type:[String,Object],default:""},srcset:String,...ZE(),...ci(),...au()},"VImg"),VL=Tn()({name:"VImg",directives:{intersect:XE},props:$L(),emits:{loadstart:e=>!0,load:e=>!0,error:e=>!0},setup(e,t){let{emit:i,slots:a}=t;const u=Sn(""),d=Kt(),p=Sn(e.eager?"loading":"idle"),l=Sn(),b=Sn(),w=Ce(()=>e.src&&typeof e.src=="object"?{src:e.src.src,srcset:e.srcset||e.src.srcset,lazySrc:e.lazySrc||e.src.lazySrc,aspect:Number(e.aspectRatio||e.src.aspect||0)}:{src:e.src,srcset:e.srcset,lazySrc:e.lazySrc,aspect:Number(e.aspectRatio||0)}),C=Ce(()=>w.value.aspect||l.value/b.value||0);En(()=>e.src,()=>{I(p.value!=="idle")}),En(C,(U,H)=>{!U&&H&&d.value&&ue(d.value)}),Qy(()=>I());function I(U){if(!(e.eager&&U)&&!(gv&&!U&&!e.eager)){if(p.value="loading",w.value.lazySrc){const H=new Image;H.src=w.value.lazySrc,ue(H,null)}w.value.src&&yr(()=>{var H,he;if(i("loadstart",((H=d.value)==null?void 0:H.currentSrc)||w.value.src),(he=d.value)!=null&&he.complete){if(d.value.naturalWidth||O(),p.value==="error")return;C.value||ue(d.value,null),M()}else C.value||ue(d.value),j()})}}function M(){var U;j(),p.value="loaded",i("load",((U=d.value)==null?void 0:U.currentSrc)||w.value.src)}function O(){var U;p.value="error",i("error",((U=d.value)==null?void 0:U.currentSrc)||w.value.src)}function j(){const U=d.value;U&&(u.value=U.currentSrc||U.src)}let Z=-1;function ue(U){let H=arguments.length>1&&arguments[1]!==void 0?arguments[1]:100;const he=()=>{clearTimeout(Z);const{naturalHeight:xe,naturalWidth:we}=U;xe||we?(l.value=we,b.value=xe):!U.complete&&p.value==="loading"&&H!=null?Z=window.setTimeout(he,H):(U.currentSrc.endsWith(".svg")||U.currentSrc.startsWith("data:image/svg+xml"))&&(l.value=1,b.value=1)};he()}const ce=Ce(()=>({"v-img__img--cover":e.cover,"v-img__img--contain":!e.cover})),ve=()=>{var he;if(!w.value.src||p.value==="idle")return null;const U=le("img",{class:["v-img__img",ce.value],src:w.value.src,srcset:w.value.srcset,alt:e.alt,sizes:e.sizes,ref:d,onLoad:M,onError:O},null),H=(he=a.sources)==null?void 0:he.call(a);return le(yo,{transition:e.transition,appear:!0},{default:()=>[us(H?le("picture",{class:"v-img__picture"},[H,U]):U,[[nu,p.value==="loaded"]])]})},ye=()=>le(yo,{transition:e.transition},{default:()=>[w.value.lazySrc&&p.value!=="loaded"&&le("img",{class:["v-img__img","v-img__img--preload",ce.value],src:w.value.lazySrc,alt:e.alt},null)]}),Ae=()=>a.placeholder?le(yo,{transition:e.transition,appear:!0},{default:()=>[(p.value==="loading"||p.value==="error"&&!a.error)&&le("div",{class:"v-img__placeholder"},[a.placeholder()])]}):null,Be=()=>a.error?le(yo,{transition:e.transition,appear:!0},{default:()=>[p.value==="error"&&le("div",{class:"v-img__error"},[a.error()])]}):null,Le=()=>e.gradient?le("div",{class:"v-img__gradient",style:{backgroundImage:`linear-gradient(${e.gradient})`}},null):null,Ie=Sn(!1);{const U=En(C,H=>{H&&(requestAnimationFrame(()=>{requestAnimationFrame(()=>{Ie.value=!0})}),U())})}return Hn(()=>{const[U]=f1.filterProps(e);return us(le(f1,Pn({class:["v-img",{"v-img--booting":!Ie.value},e.class],style:e.style},U,{aspectRatio:C.value,"aria-label":e.alt,role:e.alt?"img":void 0}),{additional:()=>le(gn,null,[le(ve,null,null),le(ye,null,null),le(Le,null,null),le(Ae,null,null),le(Be,null,null)]),default:a.default}),[[yl("intersect"),{handler:I,options:e.options},null,{once:!0}]])}),{currentSrc:u,image:d,state:p,naturalWidth:l,naturalHeight:b}}}),jL=["elevated","flat","tonal","outlined","text","plain"];function Pv(e,t){return le(gn,null,[e&&le("span",{key:"overlay",class:`${t}__overlay`},null),le("span",{key:"underlay",class:`${t}__underlay`},null)])}const xd=Ft({color:String,variant:{type:String,default:"elevated",validator:e=>jL.includes(e)}},"variant");function Rv(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Mo();const i=Ce(()=>{const{variant:d}=ur(e);return`${t}--variant-${d}`}),{colorClasses:a,colorStyles:u}=Ev(Ce(()=>{const{variant:d,color:p}=ur(e);return{[["elevated","flat"].includes(d)?"background":"text"]:p}}));return{colorClasses:a,colorStyles:u,variantClasses:i}}const GL=Ft({start:Boolean,end:Boolean,icon:ki,image:String,...ci(),...ou(),...cu(),...pm(),...ma(),...Yr(),...xd({variant:"flat"})},"VAvatar"),Dp=Tn()({name:"VAvatar",props:GL(),setup(e,t){let{slots:i}=t;const{themeClasses:a}=Is(e),{colorClasses:u,colorStyles:d,variantClasses:p}=Rv(e),{densityClasses:l}=lu(e),{roundedClasses:b}=uu(e),{sizeClasses:w,sizeStyles:C}=mm(e);return Hn(()=>le(e.tag,{class:["v-avatar",{"v-avatar--start":e.start,"v-avatar--end":e.end},a.value,u.value,l.value,b.value,w.value,p.value,e.class],style:[d.value,C.value,e.style]},{default:()=>{var I;return[e.image?le(VL,{key:"image",src:e.image,alt:"",cover:!0},null):e.icon?le(ls,{key:"icon",icon:e.icon},null):(I=i.default)==null?void 0:I.call(i),Pv(!1,"v-avatar")]}})),{}}}),qL=Ft({modelValue:{type:null,default:void 0},multiple:Boolean,mandatory:[Boolean,String],max:Number,selectedClass:String,disabled:Boolean},"group"),HL=Ft({value:null,disabled:Boolean,selectedClass:String},"group-item");function WL(e,t){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const a=Lr("useGroupItem");if(!a)throw new Error("[Vuetify] useGroupItem composable must be used inside a component setup function");const u=Hs();_r(Symbol.for(`${t.description}:id`),u);const d=Jn(t,null);if(!d){if(!i)return d;throw new Error(`[Vuetify] Could not find useGroup injection with symbol ${t.description}`)}const p=wn(e,"value"),l=Ce(()=>d.disabled.value||e.disabled);d.register({id:u,value:p,disabled:l},a),Va(()=>{d.unregister(u)});const b=Ce(()=>d.isSelected(u)),w=Ce(()=>b.value&&[d.selectedClass.value,e.selectedClass]);return En(b,C=>{a.emit("group:selected",{value:C})}),{id:u,isSelected:b,toggle:()=>d.select(u,!b.value),select:C=>d.select(u,C),selectedClass:w,value:p,disabled:l,group:d}}function ZL(e,t){let i=!1;const a=Ki([]),u=Si(e,"modelValue",[],M=>M==null?[]:KE(a,ua(M)),M=>{const O=XL(a,M);return e.multiple?O:O[0]}),d=Lr("useGroup");function p(M,O){const j=M,Z=Symbol.for(`${t.description}:id`),ce=Mh(Z,d==null?void 0:d.vnode).indexOf(O);ce>-1?a.splice(ce,0,j):a.push(j)}function l(M){if(i)return;b();const O=a.findIndex(j=>j.id===M);a.splice(O,1)}function b(){const M=a.find(O=>!O.disabled);M&&e.mandatory==="force"&&!u.value.length&&(u.value=[M.id])}wl(()=>{b()}),Va(()=>{i=!0});function w(M,O){const j=a.find(Z=>Z.id===M);if(!(O&&(j!=null&&j.disabled)))if(e.multiple){const Z=u.value.slice(),ue=Z.findIndex(ve=>ve===M),ce=~ue;if(O=O??!ce,ce&&e.mandatory&&Z.length<=1||!ce&&e.max!=null&&Z.length+1>e.max)return;ue<0&&O?Z.push(M):ue>=0&&!O&&Z.splice(ue,1),u.value=Z}else{const Z=u.value.includes(M);if(e.mandatory&&Z)return;u.value=O??!Z?[M]:[]}}function C(M){if(e.multiple,u.value.length){const O=u.value[0],j=a.findIndex(ce=>ce.id===O);let Z=(j+M)%a.length,ue=a[Z];for(;ue.disabled&&Z!==j;)Z=(Z+M)%a.length,ue=a[Z];if(ue.disabled)return;u.value=[a[Z].id]}else{const O=a.find(j=>!j.disabled);O&&(u.value=[O.id])}}const I={register:p,unregister:l,selected:u,select:w,disabled:wn(e,"disabled"),prev:()=>C(a.length-1),next:()=>C(1),isSelected:M=>u.value.includes(M),selectedClass:Ce(()=>e.selectedClass),items:Ce(()=>a),getItemIndex:M=>YL(a,M)};return _r(t,I),I}function YL(e,t){const i=KE(e,[t]);return i.length?e.findIndex(a=>a.id===i[0]):-1}function KE(e,t){const i=[];return t.forEach(a=>{const u=e.find(p=>iu(a,p.value)),d=e[a];(u==null?void 0:u.value)!=null?i.push(u.id):d!=null&&i.push(d.id)}),i}function XL(e,t){const i=[];return t.forEach(a=>{const u=e.findIndex(d=>d.id===a);if(~u){const d=e[u];i.push(d.value!=null?d.value:u)}}),i}const JE=Symbol.for("vuetify:v-chip-group"),KL=Ft({column:Boolean,filter:Boolean,valueComparator:{type:Function,default:iu},...ci(),...qL({selectedClass:"v-chip--selected"}),...ma(),...Yr(),...xd({variant:"tonal"})},"VChipGroup");Tn()({name:"VChipGroup",props:KL(),emits:{"update:modelValue":e=>!0},setup(e,t){let{slots:i}=t;const{themeClasses:a}=Is(e),{isSelected:u,select:d,next:p,prev:l,selected:b}=ZL(e,JE);return yd({VChip:{color:wn(e,"color"),disabled:wn(e,"disabled"),filter:wn(e,"filter"),variant:wn(e,"variant")}}),Hn(()=>le(e.tag,{class:["v-chip-group",{"v-chip-group--column":e.column},a.value,e.class],style:e.style},{default:()=>{var w;return[(w=i.default)==null?void 0:w.call(i,{isSelected:u,select:d,next:p,prev:l,selected:b.value})]}})),{}}});const JL=Ft({defaults:Object,disabled:Boolean,reset:[Number,String],root:[Boolean,String],scoped:Boolean},"VDefaultsProvider"),ca=Tn(!1)({name:"VDefaultsProvider",props:JL(),setup(e,t){let{slots:i}=t;const{defaults:a,disabled:u,reset:d,root:p,scoped:l}=tm(e);return yd(a,{reset:d,root:p,scoped:l,disabled:u}),()=>{var b;return(b=i.default)==null?void 0:b.call(i)}}}),Mv=Ft({border:[Boolean,Number,String]},"border");function Dv(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Mo();return{borderClasses:Ce(()=>{const a=Kn(e)?e.value:e.border,u=[];if(a===!0||a==="")u.push(`${t}--border`);else if(typeof a=="string"||a===0)for(const d of String(a).split(" "))u.push(`border-${d}`);return u})}}const Lv=Ft({elevation:{type:[Number,String],validator(e){const t=parseInt(e);return!isNaN(t)&&t>=0&&t<=24}}},"elevation");function zv(e){return{elevationClasses:Ce(()=>{const i=Kn(e)?e.value:e.elevation,a=[];return i==null||a.push(`elevation-${i}`),a})}}function QL(){var e,t;return(t=(e=Lr("useRouter"))==null?void 0:e.proxy)==null?void 0:t.$router}function QE(e,t){const i=pA("RouterLink"),a=Ce(()=>!!(e.href||e.to)),u=Ce(()=>(a==null?void 0:a.value)||Mb(t,"click")||Mb(e,"click"));if(typeof i=="string")return{isLink:a,isClickable:u,href:wn(e,"href")};const d=e.to?i.useLink(e):void 0;return{isLink:a,isClickable:u,route:d==null?void 0:d.route,navigate:d==null?void 0:d.navigate,isActive:d&&Ce(()=>{var p,l;return e.exact?(p=d.isExactActive)==null?void 0:p.value:(l=d.isActive)==null?void 0:l.value}),href:Ce(()=>e.to?d==null?void 0:d.route.value.href:e.href)}}const eT=Ft({href:String,replace:Boolean,to:[String,Object],exact:Boolean},"router");let n_=!1;function ez(e,t){let i=!1,a,u;ji&&(yr(()=>{window.addEventListener("popstate",d),a=e==null?void 0:e.beforeEach((p,l,b)=>{n_?i?t(b):b():setTimeout(()=>i?t(b):b()),n_=!0}),u=e==null?void 0:e.afterEach(()=>{n_=!1})}),Wr(()=>{window.removeEventListener("popstate",d),a==null||a(),u==null||u()}));function d(p){var l;(l=p.state)!=null&&l.replaced||(i=!0,setTimeout(()=>i=!1))}}const tz=Ft({activeClass:String,appendAvatar:String,appendIcon:ki,closable:Boolean,closeIcon:{type:ki,default:"$delete"},closeLabel:{type:String,default:"$vuetify.close"},draggable:Boolean,filter:Boolean,filterIcon:{type:String,default:"$complete"},label:Boolean,link:{type:Boolean,default:void 0},pill:Boolean,prependAvatar:String,prependIcon:ki,ripple:{type:[Boolean,Object],default:!0},text:String,modelValue:{type:Boolean,default:!0},onClick:ha(),onClickOnce:ha(),...Mv(),...ci(),...ou(),...Lv(),...HL(),...cu(),...eT(),...pm(),...ma({tag:"span"}),...Yr(),...xd({variant:"tonal"})},"VChip"),tT=Tn()({name:"VChip",directives:{Ripple:kv},props:tz(),emits:{"click:close":e=>!0,"update:modelValue":e=>!0,"group:selected":e=>!0,click:e=>!0},setup(e,t){let{attrs:i,emit:a,slots:u}=t;const{t:d}=dm(),{borderClasses:p}=Dv(e),{colorClasses:l,colorStyles:b,variantClasses:w}=Rv(e),{densityClasses:C}=lu(e),{elevationClasses:I}=zv(e),{roundedClasses:M}=uu(e),{sizeClasses:O}=mm(e),{themeClasses:j}=Is(e),Z=Si(e,"modelValue"),ue=WL(e,JE,!1),ce=QE(e,i),ve=Ce(()=>e.link!==!1&&ce.isLink.value),ye=Ce(()=>!e.disabled&&e.link!==!1&&(!!ue||e.link||ce.isClickable.value)),Ae=Ce(()=>({"aria-label":d(e.closeLabel),onClick(Ie){Z.value=!1,a("click:close",Ie)}}));function Be(Ie){var U;a("click",Ie),ye.value&&((U=ce.navigate)==null||U.call(ce,Ie),ue==null||ue.toggle())}function Le(Ie){(Ie.key==="Enter"||Ie.key===" ")&&(Ie.preventDefault(),Be(Ie))}return()=>{const Ie=ce.isLink.value?"a":e.tag,U=!!(e.appendIcon||e.appendAvatar),H=!!(U||u.append),he=!!(u.close||e.closable),xe=!!(u.filter||e.filter)&&ue,we=!!(e.prependIcon||e.prependAvatar),oe=!!(we||u.prepend),ke=!ue||ue.isSelected.value;return Z.value&&us(le(Ie,{class:["v-chip",{"v-chip--disabled":e.disabled,"v-chip--label":e.label,"v-chip--link":ye.value,"v-chip--filter":xe,"v-chip--pill":e.pill},j.value,p.value,ke?l.value:void 0,C.value,I.value,M.value,O.value,w.value,ue==null?void 0:ue.selectedClass.value,e.class],style:[ke?b.value:void 0,e.style],disabled:e.disabled||void 0,draggable:e.draggable,href:ce.href.value,tabindex:ye.value?0:void 0,onClick:Be,onKeydown:ye.value&&!ve.value&&Le},{default:()=>{var tt;return[Pv(ye.value,"v-chip"),xe&&le(RE,{key:"filter"},{default:()=>[us(le("div",{class:"v-chip__filter"},[u.filter?us(le(ca,{key:"filter-defaults",disabled:!e.filterIcon,defaults:{VIcon:{icon:e.filterIcon}}},null),[[yl("slot"),u.filter,"default"]]):le(ls,{key:"filter-icon",icon:e.filterIcon},null)]),[[nu,ue.isSelected.value]])]}),oe&&le("div",{key:"prepend",class:"v-chip__prepend"},[u.prepend?le(ca,{key:"prepend-defaults",disabled:!we,defaults:{VAvatar:{image:e.prependAvatar,start:!0},VIcon:{icon:e.prependIcon,start:!0}}},u.prepend):le(gn,null,[e.prependIcon&&le(ls,{key:"prepend-icon",icon:e.prependIcon,start:!0},null),e.prependAvatar&&le(Dp,{key:"prepend-avatar",image:e.prependAvatar,start:!0},null)])]),le("div",{class:"v-chip__content"},[((tt=u.default)==null?void 0:tt.call(u,{isSelected:ue==null?void 0:ue.isSelected.value,selectedClass:ue==null?void 0:ue.selectedClass.value,select:ue==null?void 0:ue.select,toggle:ue==null?void 0:ue.toggle,value:ue==null?void 0:ue.value.value,disabled:e.disabled}))??e.text]),H&&le("div",{key:"append",class:"v-chip__append"},[u.append?le(ca,{key:"append-defaults",disabled:!U,defaults:{VAvatar:{end:!0,image:e.appendAvatar},VIcon:{end:!0,icon:e.appendIcon}}},u.append):le(gn,null,[e.appendIcon&&le(ls,{key:"append-icon",end:!0,icon:e.appendIcon},null),e.appendAvatar&&le(Dp,{key:"append-avatar",end:!0,image:e.appendAvatar},null)])]),he&&le("div",Pn({key:"close",class:"v-chip__close"},Ae.value),[u.close?le(ca,{key:"close-defaults",defaults:{VIcon:{icon:e.closeIcon,size:"x-small"}}},u.close):le(ls,{key:"close-icon",icon:e.closeIcon,size:"x-small"},null)])]}}),[[yl("ripple"),ye.value&&e.ripple,null]])}}}),Y_=Symbol.for("vuetify:list");function nT(){const e=Jn(Y_,{hasPrepend:Sn(!1),updateHasPrepend:()=>null}),t={hasPrepend:Sn(!1),updateHasPrepend:i=>{i&&(t.hasPrepend.value=i)}};return _r(Y_,t),e}function iT(){return Jn(Y_,null)}const nz={open:e=>{let{id:t,value:i,opened:a,parents:u}=e;if(i){const d=new Set;d.add(t);let p=u.get(t);for(;p!=null;)d.add(p),p=u.get(p);return d}else return a.delete(t),a},select:()=>null},rT={open:e=>{let{id:t,value:i,opened:a,parents:u}=e;if(i){let d=u.get(t);for(a.add(t);d!=null&&d!==t;)a.add(d),d=u.get(d);return a}else a.delete(t);return a},select:()=>null},iz={open:rT.open,select:e=>{let{id:t,value:i,opened:a,parents:u}=e;if(!i)return a;const d=[];let p=u.get(t);for(;p!=null;)d.push(p),p=u.get(p);return new Set(d)}},Ov=e=>{const t={select:i=>{let{id:a,value:u,selected:d}=i;if(a=sn(a),e&&!u){const p=Array.from(d.entries()).reduce((l,b)=>{let[w,C]=b;return C==="on"?[...l,w]:l},[]);if(p.length===1&&p[0]===a)return d}return d.set(a,u?"on":"off"),d},in:(i,a,u)=>{let d=new Map;for(const p of i||[])d=t.select({id:p,value:!0,selected:new Map(d),children:a,parents:u});return d},out:i=>{const a=[];for(const[u,d]of i.entries())d==="on"&&a.push(u);return a}};return t},sT=e=>{const t=Ov(e);return{select:a=>{let{selected:u,id:d,...p}=a;d=sn(d);const l=u.has(d)?new Map([[d,u.get(d)]]):new Map;return t.select({...p,id:d,selected:l})},in:(a,u,d)=>{let p=new Map;return a!=null&&a.length&&(p=t.in(a.slice(0,1),u,d)),p},out:(a,u,d)=>t.out(a,u,d)}},rz=e=>{const t=Ov(e);return{select:a=>{let{id:u,selected:d,children:p,...l}=a;return u=sn(u),p.has(u)?d:t.select({id:u,selected:d,children:p,...l})},in:t.in,out:t.out}},sz=e=>{const t=sT(e);return{select:a=>{let{id:u,selected:d,children:p,...l}=a;return u=sn(u),p.has(u)?d:t.select({id:u,selected:d,children:p,...l})},in:t.in,out:t.out}},az=e=>{const t={select:i=>{let{id:a,value:u,selected:d,children:p,parents:l}=i;a=sn(a);const b=new Map(d),w=[a];for(;w.length;){const I=w.shift();d.set(I,u?"on":"off"),p.has(I)&&w.push(...p.get(I))}let C=l.get(a);for(;C;){const I=p.get(C),M=I.every(j=>d.get(j)==="on"),O=I.every(j=>!d.has(j)||d.get(j)==="off");d.set(C,M?"on":O?"off":"indeterminate"),C=l.get(C)}return e&&!u&&Array.from(d.entries()).reduce((M,O)=>{let[j,Z]=O;return Z==="on"?[...M,j]:M},[]).length===0?b:d},in:(i,a,u)=>{let d=new Map;for(const p of i||[])d=t.select({id:p,value:!0,selected:new Map(d),children:a,parents:u});return d},out:(i,a)=>{const u=[];for(const[d,p]of i.entries())p==="on"&&!a.has(d)&&u.push(d);return u}};return t},id=Symbol.for("vuetify:nested"),aT={id:Sn(),root:{register:()=>null,unregister:()=>null,parents:Kt(new Map),children:Kt(new Map),open:()=>null,openOnSelect:()=>null,select:()=>null,opened:Kt(new Set),selected:Kt(new Map),selectedValues:Kt([])}},oz=Ft({selectStrategy:[String,Function],openStrategy:[String,Object],opened:Array,selected:Array,mandatory:Boolean},"nested"),lz=e=>{let t=!1;const i=Kt(new Map),a=Kt(new Map),u=Si(e,"opened",e.opened,I=>new Set(I),I=>[...I.values()]),d=Ce(()=>{if(typeof e.selectStrategy=="object")return e.selectStrategy;switch(e.selectStrategy){case"single-leaf":return sz(e.mandatory);case"leaf":return rz(e.mandatory);case"independent":return Ov(e.mandatory);case"single-independent":return sT(e.mandatory);case"classic":default:return az(e.mandatory)}}),p=Ce(()=>{if(typeof e.openStrategy=="object")return e.openStrategy;switch(e.openStrategy){case"list":return iz;case"single":return nz;case"multiple":default:return rT}}),l=Si(e,"selected",e.selected,I=>d.value.in(I,i.value,a.value),I=>d.value.out(I,i.value,a.value));Va(()=>{t=!0});function b(I){const M=[];let O=I;for(;O!=null;)M.unshift(O),O=a.value.get(O);return M}const w=Lr("nested"),C={id:Sn(),root:{opened:u,selected:l,selectedValues:Ce(()=>{const I=[];for(const[M,O]of l.value.entries())O==="on"&&I.push(M);return I}),register:(I,M,O)=>{M&&I!==M&&a.value.set(I,M),O&&i.value.set(I,[]),M!=null&&i.value.set(M,[...i.value.get(M)||[],I])},unregister:I=>{if(t)return;i.value.delete(I);const M=a.value.get(I);if(M){const O=i.value.get(M)??[];i.value.set(M,O.filter(j=>j!==I))}a.value.delete(I),u.value.delete(I)},open:(I,M,O)=>{w.emit("click:open",{id:I,value:M,path:b(I),event:O});const j=p.value.open({id:I,value:M,opened:new Set(u.value),children:i.value,parents:a.value,event:O});j&&(u.value=j)},openOnSelect:(I,M,O)=>{const j=p.value.select({id:I,value:M,selected:new Map(l.value),opened:new Set(u.value),children:i.value,parents:a.value,event:O});j&&(u.value=j)},select:(I,M,O)=>{w.emit("click:select",{id:I,value:M,path:b(I),event:O});const j=d.value.select({id:I,value:M,selected:new Map(l.value),children:i.value,parents:a.value,event:O});j&&(l.value=j),C.root.openOnSelect(I,M,O)},children:i,parents:a}};return _r(id,C),C.root},oT=(e,t)=>{const i=Jn(id,aT),a=Symbol(Hs()),u=Ce(()=>e.value!==void 0?e.value:a),d={...i,id:u,open:(p,l)=>i.root.open(u.value,p,l),openOnSelect:(p,l)=>i.root.openOnSelect(u.value,p,l),isOpen:Ce(()=>i.root.opened.value.has(u.value)),parent:Ce(()=>i.root.parents.value.get(u.value)),select:(p,l)=>i.root.select(u.value,p,l),isSelected:Ce(()=>i.root.selected.value.get(sn(u.value))==="on"),isIndeterminate:Ce(()=>i.root.selected.value.get(u.value)==="indeterminate"),isLeaf:Ce(()=>!i.root.children.value.get(u.value)),isGroupActivator:i.isGroupActivator};return!i.isGroupActivator&&i.root.register(u.value,i.id.value,t),Va(()=>{!i.isGroupActivator&&i.root.unregister(u.value)}),t&&_r(id,d),d},cz=()=>{const e=Jn(id,aT);_r(id,{...e,isGroupActivator:!0})};function uz(){const e=Sn(!1);return wl(()=>{window.requestAnimationFrame(()=>{e.value=!0})}),{ssrBootStyles:Ce(()=>e.value?void 0:{transition:"none !important"}),isBooted:md(e)}}const hz=ru({name:"VListGroupActivator",setup(e,t){let{slots:i}=t;return cz(),()=>{var a;return(a=i.default)==null?void 0:a.call(i)}}}),dz=Ft({activeColor:String,baseColor:String,color:String,collapseIcon:{type:ki,default:"$collapse"},expandIcon:{type:ki,default:"$expand"},prependIcon:ki,appendIcon:ki,fluid:Boolean,subgroup:Boolean,title:String,value:null,...ci(),...ma()},"VListGroup"),p1=Tn()({name:"VListGroup",props:dz(),setup(e,t){let{slots:i}=t;const{isOpen:a,open:u,id:d}=oT(wn(e,"value"),!0),p=Ce(()=>`v-list-group--id-${String(d.value)}`),l=iT(),{isBooted:b}=uz();function w(O){u(!a.value,O)}const C=Ce(()=>({onClick:w,class:"v-list-group__header",id:p.value})),I=Ce(()=>a.value?e.collapseIcon:e.expandIcon),M=Ce(()=>({VListItem:{active:a.value,activeColor:e.activeColor,baseColor:e.baseColor,color:e.color,prependIcon:e.prependIcon||e.subgroup&&I.value,appendIcon:e.appendIcon||!e.subgroup&&I.value,title:e.title,value:e.value}}));return Hn(()=>le(e.tag,{class:["v-list-group",{"v-list-group--prepend":l==null?void 0:l.hasPrepend.value,"v-list-group--fluid":e.fluid,"v-list-group--subgroup":e.subgroup,"v-list-group--open":a.value},e.class],style:e.style},{default:()=>[i.activator&&le(ca,{defaults:M.value},{default:()=>[le(hz,null,{default:()=>[i.activator({props:C.value,isOpen:a.value})]})]}),le(yo,{transition:{component:nL},disabled:!b.value},{default:()=>{var O;return[us(le("div",{class:"v-list-group__items",role:"group","aria-labelledby":p.value},[(O=i.default)==null?void 0:O.call(i)]),[[nu,a.value]])]}})]})),{}}}),fz=rE("v-list-item-subtitle"),pz=rE("v-list-item-title"),mz=Ft({active:{type:Boolean,default:void 0},activeClass:String,activeColor:String,appendAvatar:String,appendIcon:ki,baseColor:String,disabled:Boolean,lines:String,link:{type:Boolean,default:void 0},nav:Boolean,prependAvatar:String,prependIcon:ki,ripple:{type:[Boolean,Object],default:!0},subtitle:[String,Number,Boolean],title:[String,Number,Boolean],value:null,onClick:ha(),onClickOnce:ha(),...Mv(),...ci(),...ou(),...gm(),...Lv(),...cu(),...eT(),...ma(),...Yr(),...xd({variant:"text"})},"VListItem"),Uc=Tn()({name:"VListItem",directives:{Ripple:kv},props:mz(),emits:{click:e=>!0},setup(e,t){let{attrs:i,slots:a,emit:u}=t;const d=QE(e,i),p=Ce(()=>e.value===void 0?d.href.value:e.value),{select:l,isSelected:b,isIndeterminate:w,isGroupActivator:C,root:I,parent:M,openOnSelect:O}=oT(p,!1),j=iT(),Z=Ce(()=>{var $e;return e.active!==!1&&(e.active||(($e=d.isActive)==null?void 0:$e.value)||b.value)}),ue=Ce(()=>e.link!==!1&&d.isLink.value),ce=Ce(()=>!e.disabled&&e.link!==!1&&(e.link||d.isClickable.value||e.value!=null&&!!j)),ve=Ce(()=>e.rounded||e.nav),ye=Ce(()=>e.color??e.activeColor),Ae=Ce(()=>({color:Z.value?ye.value??e.baseColor:e.baseColor,variant:e.variant}));En(()=>{var $e;return($e=d.isActive)==null?void 0:$e.value},$e=>{$e&&M.value!=null&&I.open(M.value,!0),$e&&O($e)},{immediate:!0});const{themeClasses:Be}=Is(e),{borderClasses:Le}=Dv(e),{colorClasses:Ie,colorStyles:U,variantClasses:H}=Rv(Ae),{densityClasses:he}=lu(e),{dimensionStyles:xe}=_m(e),{elevationClasses:we}=zv(e),{roundedClasses:oe}=uu(ve),ke=Ce(()=>e.lines?`v-list-item--${e.lines}-line`:void 0),tt=Ce(()=>({isActive:Z.value,select:l,isSelected:b.value,isIndeterminate:w.value}));function et($e){var He;u("click",$e),!(C||!ce.value)&&((He=d.navigate)==null||He.call(d,$e),e.value!=null&&l(!b.value,$e))}function Ve($e){($e.key==="Enter"||$e.key===" ")&&($e.preventDefault(),et($e))}return Hn(()=>{const $e=ue.value?"a":e.tag,He=a.title||e.title,kt=a.subtitle||e.subtitle,Ct=!!(e.appendAvatar||e.appendIcon),rt=!!(Ct||a.append),It=!!(e.prependAvatar||e.prependIcon),Vt=!!(It||a.prepend);return j==null||j.updateHasPrepend(Vt),e.activeColor&&jP("active-color",["color","base-color"]),us(le($e,{class:["v-list-item",{"v-list-item--active":Z.value,"v-list-item--disabled":e.disabled,"v-list-item--link":ce.value,"v-list-item--nav":e.nav,"v-list-item--prepend":!Vt&&(j==null?void 0:j.hasPrepend.value),[`${e.activeClass}`]:e.activeClass&&Z.value},Be.value,Le.value,Ie.value,he.value,we.value,ke.value,oe.value,H.value,e.class],style:[U.value,xe.value,e.style],href:d.href.value,tabindex:ce.value?j?-2:0:void 0,onClick:et,onKeydown:ce.value&&!ue.value&&Ve},{default:()=>{var Lt;return[Pv(ce.value||Z.value,"v-list-item"),Vt&&le("div",{key:"prepend",class:"v-list-item__prepend"},[a.prepend?le(ca,{key:"prepend-defaults",disabled:!It,defaults:{VAvatar:{density:e.density,image:e.prependAvatar},VIcon:{density:e.density,icon:e.prependIcon},VListItemAction:{start:!0}}},{default:()=>{var qe;return[(qe=a.prepend)==null?void 0:qe.call(a,tt.value)]}}):le(gn,null,[e.prependAvatar&&le(Dp,{key:"prepend-avatar",density:e.density,image:e.prependAvatar},null),e.prependIcon&&le(ls,{key:"prepend-icon",density:e.density,icon:e.prependIcon},null)])]),le("div",{class:"v-list-item__content","data-no-activator":""},[He&&le(pz,{key:"title"},{default:()=>{var qe;return[((qe=a.title)==null?void 0:qe.call(a,{title:e.title}))??e.title]}}),kt&&le(fz,{key:"subtitle"},{default:()=>{var qe;return[((qe=a.subtitle)==null?void 0:qe.call(a,{subtitle:e.subtitle}))??e.subtitle]}}),(Lt=a.default)==null?void 0:Lt.call(a,tt.value)]),rt&&le("div",{key:"append",class:"v-list-item__append"},[a.append?le(ca,{key:"append-defaults",disabled:!Ct,defaults:{VAvatar:{density:e.density,image:e.appendAvatar},VIcon:{density:e.density,icon:e.appendIcon},VListItemAction:{end:!0}}},{default:()=>{var qe;return[(qe=a.append)==null?void 0:qe.call(a,tt.value)]}}):le(gn,null,[e.appendIcon&&le(ls,{key:"append-icon",density:e.density,icon:e.appendIcon},null),e.appendAvatar&&le(Dp,{key:"append-avatar",density:e.density,image:e.appendAvatar},null)])])]}}),[[yl("ripple"),ce.value&&e.ripple]])}),{}}}),gz=Ft({color:String,inset:Boolean,sticky:Boolean,title:String,...ci(),...ma()},"VListSubheader"),_z=Tn()({name:"VListSubheader",props:gz(),setup(e,t){let{slots:i}=t;const{textColorClasses:a,textColorStyles:u}=pa(wn(e,"color"));return Hn(()=>{const d=!!(i.default||e.title);return le(e.tag,{class:["v-list-subheader",{"v-list-subheader--inset":e.inset,"v-list-subheader--sticky":e.sticky},a.value,e.class],style:[{textColorStyles:u},e.style]},{default:()=>{var p;return[d&&le("div",{class:"v-list-subheader__text"},[((p=i.default)==null?void 0:p.call(i))??e.title])]}})}),{}}}),yz=Ft({color:String,inset:Boolean,length:[Number,String],thickness:[Number,String],vertical:Boolean,...ci(),...Yr()},"VDivider"),vz=Tn()({name:"VDivider",props:yz(),setup(e,t){let{attrs:i}=t;const{themeClasses:a}=Is(e),{textColorClasses:u,textColorStyles:d}=pa(wn(e,"color")),p=Ce(()=>{const l={};return e.length&&(l[e.vertical?"maxHeight":"maxWidth"]=mn(e.length)),e.thickness&&(l[e.vertical?"borderRightWidth":"borderTopWidth"]=mn(e.thickness)),l});return Hn(()=>le("hr",{class:[{"v-divider":!0,"v-divider--inset":e.inset,"v-divider--vertical":e.vertical},a.value,u.value,e.class],style:[p.value,d.value,e.style],"aria-orientation":!i.role||i.role==="separator"?e.vertical?"vertical":"horizontal":void 0,role:`${i.role||"separator"}`},null)),{}}}),xz=Ft({items:Array},"VListChildren"),lT=Tn()({name:"VListChildren",props:xz(),setup(e,t){let{slots:i}=t;return nT(),()=>{var a,u;return((a=i.default)==null?void 0:a.call(i))??((u=e.items)==null?void 0:u.map(d=>{var O,j;let{children:p,props:l,type:b,raw:w}=d;if(b==="divider")return((O=i.divider)==null?void 0:O.call(i,{props:l}))??le(vz,l,null);if(b==="subheader")return((j=i.subheader)==null?void 0:j.call(i,{props:l}))??le(_z,l,null);const C={subtitle:i.subtitle?Z=>{var ue;return(ue=i.subtitle)==null?void 0:ue.call(i,{...Z,item:w})}:void 0,prepend:i.prepend?Z=>{var ue;return(ue=i.prepend)==null?void 0:ue.call(i,{...Z,item:w})}:void 0,append:i.append?Z=>{var ue;return(ue=i.append)==null?void 0:ue.call(i,{...Z,item:w})}:void 0,title:i.title?Z=>{var ue;return(ue=i.title)==null?void 0:ue.call(i,{...Z,item:w})}:void 0},[I,M]=p1.filterProps(l);return p?le(p1,Pn({value:l==null?void 0:l.value},I),{activator:Z=>{let{props:ue}=Z;return i.header?i.header({props:{...l,...ue}}):le(Uc,Pn(l,ue),C)},default:()=>le(lT,{items:p},i)}):i.item?i.item({props:l}):le(Uc,l,C)}))}}}),cT=Ft({items:{type:Array,default:()=>[]},itemTitle:{type:[String,Array,Function],default:"title"},itemValue:{type:[String,Array,Function],default:"value"},itemChildren:{type:[Boolean,String,Array,Function],default:"children"},itemProps:{type:[Boolean,String,Array,Function],default:"props"},returnObject:Boolean},"list-items");function uT(e,t){const i=la(t,e.itemTitle,t),a=e.returnObject?t:la(t,e.itemValue,i),u=la(t,e.itemChildren),d=e.itemProps===!0?typeof t=="object"&&t!=null&&!Array.isArray(t)?"children"in t?_d(t,["children"])[1]:t:void 0:la(t,e.itemProps),p={title:i,value:a,...d};return{title:String(p.title??""),value:p.value,props:p,children:Array.isArray(u)?hT(e,u):void 0,raw:t}}function hT(e,t){const i=[];for(const a of t)i.push(uT(e,a));return i}function dT(e){const t=Ce(()=>hT(e,e.items));return bz(t,i=>uT(e,i))}function bz(e,t){function i(u){return u.filter(d=>d!==null||e.value.some(p=>p.value===null)).map(d=>e.value.find(l=>iu(d,l.value))??t(d))}function a(u){return u.map(d=>{let{value:p}=d;return p})}return{items:e,transformIn:i,transformOut:a}}function wz(e){return typeof e=="string"||typeof e=="number"||typeof e=="boolean"}function Sz(e,t){const i=la(t,e.itemType,"item"),a=wz(t)?t:la(t,e.itemTitle),u=la(t,e.itemValue,void 0),d=la(t,e.itemChildren),p=e.itemProps===!0?_d(t,["children"])[1]:la(t,e.itemProps),l={title:a,value:u,...p};return{type:i,title:l.title,value:l.value,props:l,children:i==="item"&&d?fT(e,d):void 0,raw:t}}function fT(e,t){const i=[];for(const a of t)i.push(Sz(e,a));return i}function Ez(e){return{items:Ce(()=>fT(e,e.items))}}const Tz=Ft({baseColor:String,activeColor:String,activeClass:String,bgColor:String,disabled:Boolean,lines:{type:[Boolean,String],default:"one"},nav:Boolean,...oz({selectStrategy:"single-leaf",openStrategy:"list"}),...Mv(),...ci(),...ou(),...gm(),...Lv(),itemType:{type:String,default:"type"},...cT(),...cu(),...ma(),...Yr(),...xd({variant:"text"})},"VList"),pT=Tn()({name:"VList",props:Tz(),emits:{"update:selected":e=>!0,"update:opened":e=>!0,"click:open":e=>!0,"click:select":e=>!0},setup(e,t){let{slots:i}=t;const{items:a}=Ez(e),{themeClasses:u}=Is(e),{backgroundColorClasses:d,backgroundColorStyles:p}=ed(wn(e,"bgColor")),{borderClasses:l}=Dv(e),{densityClasses:b}=lu(e),{dimensionStyles:w}=_m(e),{elevationClasses:C}=zv(e),{roundedClasses:I}=uu(e),{open:M,select:O}=lz(e),j=Ce(()=>e.lines?`v-list--${e.lines}-line`:void 0),Z=wn(e,"activeColor"),ue=wn(e,"baseColor"),ce=wn(e,"color");nT(),yd({VListGroup:{activeColor:Z,baseColor:ue,color:ce},VListItem:{activeClass:wn(e,"activeClass"),activeColor:Z,baseColor:ue,color:ce,density:wn(e,"density"),disabled:wn(e,"disabled"),lines:wn(e,"lines"),nav:wn(e,"nav"),variant:wn(e,"variant")}});const ve=Sn(!1),ye=Kt();function Ae(H){ve.value=!0}function Be(H){ve.value=!1}function Le(H){var he;!ve.value&&!(H.relatedTarget&&((he=ye.value)!=null&&he.contains(H.relatedTarget)))&&U()}function Ie(H){if(ye.value){if(H.key==="ArrowDown")U("next");else if(H.key==="ArrowUp")U("prev");else if(H.key==="Home")U("first");else if(H.key==="End")U("last");else return;H.preventDefault()}}function U(H){if(ye.value)return wp(ye.value,H)}return Hn(()=>le(e.tag,{ref:ye,class:["v-list",{"v-list--disabled":e.disabled,"v-list--nav":e.nav},u.value,d.value,l.value,b.value,C.value,j.value,I.value,e.class],style:[p.value,w.value,e.style],tabindex:e.disabled||ve.value?-1:0,role:"listbox","aria-activedescendant":void 0,onFocusin:Ae,onFocusout:Be,onFocus:Le,onKeydown:Ie},{default:()=>[le(lT,{items:a.value},i)]})),{open:M,select:O,focus:U}}});function i_(e,t){return{x:e.x+t.x,y:e.y+t.y}}function Cz(e,t){return{x:e.x-t.x,y:e.y-t.y}}function m1(e,t){if(e.side==="top"||e.side==="bottom"){const{side:i,align:a}=e,u=a==="left"?0:a==="center"?t.width/2:a==="right"?t.width:a,d=i==="top"?0:i==="bottom"?t.height:i;return i_({x:u,y:d},t)}else if(e.side==="left"||e.side==="right"){const{side:i,align:a}=e,u=i==="left"?0:i==="right"?t.width:i,d=a==="top"?0:a==="center"?t.height/2:a==="bottom"?t.height:a;return i_({x:u,y:d},t)}return i_({x:t.width/2,y:t.height/2},t)}const mT={static:Az,connected:Rz},Iz=Ft({locationStrategy:{type:[String,Function],default:"static",validator:e=>typeof e=="function"||e in mT},location:{type:String,default:"bottom"},origin:{type:String,default:"auto"},offset:[Number,String,Array]},"VOverlay-location-strategies");function kz(e,t){const i=Kt({}),a=Kt();ji&&(vl(()=>!!(t.isActive.value&&e.locationStrategy),d=>{var p,l;En(()=>e.locationStrategy,d),Wr(()=>{a.value=void 0}),typeof e.locationStrategy=="function"?a.value=(p=e.locationStrategy(t,e,i))==null?void 0:p.updateLocation:a.value=(l=mT[e.locationStrategy](t,e,i))==null?void 0:l.updateLocation}),window.addEventListener("resize",u,{passive:!0}),Wr(()=>{window.removeEventListener("resize",u),a.value=void 0}));function u(d){var p;(p=a.value)==null||p.call(a,d)}return{contentStyles:i,updateLocation:a}}function Az(){}function Pz(e,t){const i=fv(e);return t?i.x+=parseFloat(e.style.right||0):i.x-=parseFloat(e.style.left||0),i.y-=parseFloat(e.style.top||0),i}function Rz(e,t,i){lR(e.activatorEl.value)&&Object.assign(i.value,{position:"fixed",top:0,[e.isRtl.value?"right":"left"]:0});const{preferredAnchor:u,preferredOrigin:d}=hv(()=>{const j=F_(t.location,e.isRtl.value),Z=t.origin==="overlap"?j:t.origin==="auto"?Qg(j):F_(t.origin,e.isRtl.value);return j.side===Z.side&&j.align===e_(Z).align?{preferredAnchor:Lb(j),preferredOrigin:Lb(Z)}:{preferredAnchor:j,preferredOrigin:Z}}),[p,l,b,w]=["minWidth","minHeight","maxWidth","maxHeight"].map(j=>Ce(()=>{const Z=parseFloat(t[j]);return isNaN(Z)?1/0:Z})),C=Ce(()=>{if(Array.isArray(t.offset))return t.offset;if(typeof t.offset=="string"){const j=t.offset.split(" ").map(parseFloat);return j.length<2&&j.push(0),j}return typeof t.offset=="number"?[t.offset,0]:[0,0]});let I=!1;const M=new ResizeObserver(()=>{I&&O()});En([e.activatorEl,e.contentEl],(j,Z)=>{let[ue,ce]=j,[ve,ye]=Z;ve&&M.unobserve(ve),ue&&M.observe(ue),ye&&M.unobserve(ye),ce&&M.observe(ce)},{immediate:!0}),Wr(()=>{M.disconnect()});function O(){if(I=!1,requestAnimationFrame(()=>{requestAnimationFrame(()=>I=!0)}),!e.activatorEl.value||!e.contentEl.value)return;const j=e.activatorEl.value.getBoundingClientRect(),Z=Pz(e.contentEl.value,e.isRtl.value),ue=Tp(e.contentEl.value),ce=12;ue.length||(ue.push(document.documentElement),e.contentEl.value.style.top&&e.contentEl.value.style.left||(Z.x-=parseFloat(document.documentElement.style.getPropertyValue("--v-body-scroll-x")||0),Z.y-=parseFloat(document.documentElement.style.getPropertyValue("--v-body-scroll-y")||0)));const ve=ue.reduce((xe,we)=>{const oe=we.getBoundingClientRect(),ke=new Oc({x:we===document.documentElement?0:oe.x,y:we===document.documentElement?0:oe.y,width:we.clientWidth,height:we.clientHeight});return xe?new Oc({x:Math.max(xe.left,ke.left),y:Math.max(xe.top,ke.top),width:Math.min(xe.right,ke.right)-Math.max(xe.left,ke.left),height:Math.min(xe.bottom,ke.bottom)-Math.max(xe.top,ke.top)}):ke},void 0);ve.x+=ce,ve.y+=ce,ve.width-=ce*2,ve.height-=ce*2;let ye={anchor:u.value,origin:d.value};function Ae(xe){const we=new Oc(Z),oe=m1(xe.anchor,j),ke=m1(xe.origin,we);let{x:tt,y:et}=Cz(oe,ke);switch(xe.anchor.side){case"top":et-=C.value[0];break;case"bottom":et+=C.value[0];break;case"left":tt-=C.value[0];break;case"right":tt+=C.value[0];break}switch(xe.anchor.align){case"top":et-=C.value[1];break;case"bottom":et+=C.value[1];break;case"left":tt-=C.value[1];break;case"right":tt+=C.value[1];break}return we.x+=tt,we.y+=et,we.width=Math.min(we.width,b.value),we.height=Math.min(we.height,w.value),{overflows:Ob(we,ve),x:tt,y:et}}let Be=0,Le=0;const Ie={x:0,y:0},U={x:!1,y:!1};let H=-1;for(;!(H++>10);){const{x:xe,y:we,overflows:oe}=Ae(ye);Be+=xe,Le+=we,Z.x+=xe,Z.y+=we;{const ke=zb(ye.anchor),tt=oe.x.before||oe.x.after,et=oe.y.before||oe.y.after;let Ve=!1;if(["x","y"].forEach($e=>{if($e==="x"&&tt&&!U.x||$e==="y"&&et&&!U.y){const He={anchor:{...ye.anchor},origin:{...ye.origin}},kt=$e==="x"?ke==="y"?e_:Qg:ke==="y"?Qg:e_;He.anchor=kt(He.anchor),He.origin=kt(He.origin);const{overflows:Ct}=Ae(He);(Ct[$e].before<=oe[$e].before&&Ct[$e].after<=oe[$e].after||Ct[$e].before+Ct[$e].after<(oe[$e].before+oe[$e].after)/2)&&(ye=He,Ve=U[$e]=!0)}}),Ve)continue}oe.x.before&&(Be+=oe.x.before,Z.x+=oe.x.before),oe.x.after&&(Be-=oe.x.after,Z.x-=oe.x.after),oe.y.before&&(Le+=oe.y.before,Z.y+=oe.y.before),oe.y.after&&(Le-=oe.y.after,Z.y-=oe.y.after);{const ke=Ob(Z,ve);Ie.x=ve.width-ke.x.before-ke.x.after,Ie.y=ve.height-ke.y.before-ke.y.after,Be+=ke.x.before,Z.x+=ke.x.before,Le+=ke.y.before,Z.y+=ke.y.before}break}const he=zb(ye.anchor);return Object.assign(i.value,{"--v-overlay-anchor-origin":`${ye.anchor.side} ${ye.anchor.align}`,transformOrigin:`${ye.origin.side} ${ye.origin.align}`,top:mn(r_(Le)),left:e.isRtl.value?void 0:mn(r_(Be)),right:e.isRtl.value?mn(r_(-Be)):void 0,minWidth:mn(he==="y"?Math.min(p.value,j.width):p.value),maxWidth:mn(g1(B_(Ie.x,p.value===1/0?0:p.value,b.value))),maxHeight:mn(g1(B_(Ie.y,l.value===1/0?0:l.value,w.value)))}),{available:Ie,contentBox:Z}}return En(()=>[u.value,d.value,t.offset,t.minWidth,t.minHeight,t.maxWidth,t.maxHeight],()=>O()),yr(()=>{const j=O();if(!j)return;const{available:Z,contentBox:ue}=j;ue.height>Z.y&&requestAnimationFrame(()=>{O(),requestAnimationFrame(()=>{O()})})}),{updateLocation:O}}function r_(e){return Math.round(e*devicePixelRatio)/devicePixelRatio}function g1(e){return Math.ceil(e*devicePixelRatio)/devicePixelRatio}let X_=!0;const Lp=[];function Mz(e){!X_||Lp.length?(Lp.push(e),K_()):(X_=!1,e(),K_())}let _1=-1;function K_(){cancelAnimationFrame(_1),_1=requestAnimationFrame(()=>{const e=Lp.shift();e&&e(),Lp.length?K_():X_=!0})}const up={none:null,close:zz,block:Oz,reposition:Bz},Dz=Ft({scrollStrategy:{type:[String,Function],default:"block",validator:e=>typeof e=="function"||e in up}},"VOverlay-scroll-strategies");function Lz(e,t){if(!ji)return;let i;Ua(async()=>{i==null||i.stop(),t.isActive.value&&e.scrollStrategy&&(i=pd(),await yr(),i.active&&i.run(()=>{var a;typeof e.scrollStrategy=="function"?e.scrollStrategy(t,e,i):(a=up[e.scrollStrategy])==null||a.call(up,t,e,i)}))}),Wr(()=>{i==null||i.stop()})}function zz(e){function t(i){e.isActive.value=!1}gT(e.activatorEl.value??e.contentEl.value,t)}function Oz(e,t){var p;const i=(p=e.root.value)==null?void 0:p.offsetParent,a=[...new Set([...Tp(e.activatorEl.value,t.contained?i:void 0),...Tp(e.contentEl.value,t.contained?i:void 0)])].filter(l=>!l.classList.contains("v-overlay-scroll-blocked")),u=window.innerWidth-document.documentElement.offsetWidth,d=(l=>mv(l)&&l)(i||document.documentElement);d&&e.root.value.classList.add("v-overlay--scroll-blocked"),a.forEach((l,b)=>{l.style.setProperty("--v-body-scroll-x",mn(-l.scrollLeft)),l.style.setProperty("--v-body-scroll-y",mn(-l.scrollTop)),l.style.setProperty("--v-scrollbar-offset",mn(u)),l.classList.add("v-overlay-scroll-blocked")}),Wr(()=>{a.forEach((l,b)=>{const w=parseFloat(l.style.getPropertyValue("--v-body-scroll-x")),C=parseFloat(l.style.getPropertyValue("--v-body-scroll-y"));l.style.removeProperty("--v-body-scroll-x"),l.style.removeProperty("--v-body-scroll-y"),l.style.removeProperty("--v-scrollbar-offset"),l.classList.remove("v-overlay-scroll-blocked"),l.scrollLeft=-w,l.scrollTop=-C}),d&&e.root.value.classList.remove("v-overlay--scroll-blocked")})}function Bz(e,t,i){let a=!1,u=-1,d=-1;function p(l){Mz(()=>{var C,I;const b=performance.now();(I=(C=e.updateLocation).value)==null||I.call(C,l),a=(performance.now()-b)/(1e3/60)>2})}d=(typeof requestIdleCallback>"u"?l=>l():requestIdleCallback)(()=>{i.run(()=>{gT(e.activatorEl.value??e.contentEl.value,l=>{a?(cancelAnimationFrame(u),u=requestAnimationFrame(()=>{u=requestAnimationFrame(()=>{p(l)})})):p(l)})})}),Wr(()=>{typeof cancelIdleCallback<"u"&&cancelIdleCallback(d),cancelAnimationFrame(u)})}function gT(e,t){const i=[document,...Tp(e)];i.forEach(a=>{a.addEventListener("scroll",t,{passive:!0})}),Wr(()=>{i.forEach(a=>{a.removeEventListener("scroll",t)})})}const J_=Symbol.for("vuetify:v-menu"),Fz=Ft({closeDelay:[Number,String],openDelay:[Number,String]},"delay");function Nz(e,t){const i={},a=u=>()=>{if(!ji)return Promise.resolve(!0);const d=u==="openDelay";return i.closeDelay&&window.clearTimeout(i.closeDelay),delete i.closeDelay,i.openDelay&&window.clearTimeout(i.openDelay),delete i.openDelay,new Promise(p=>{const l=parseInt(e[u]??0,10);i[u]=window.setTimeout(()=>{t==null||t(d),p(d)},l)})};return{runCloseDelay:a("closeDelay"),runOpenDelay:a("openDelay")}}const Uz=Ft({activator:[String,Object],activatorProps:{type:Object,default:()=>({})},openOnClick:{type:Boolean,default:void 0},openOnHover:Boolean,openOnFocus:{type:Boolean,default:void 0},closeOnContentClick:Boolean,...Fz()},"VOverlay-activator");function $z(e,t){let{isActive:i,isTop:a}=t;const u=Kt();let d=!1,p=!1,l=!0;const b=Ce(()=>e.openOnFocus||e.openOnFocus==null&&e.openOnHover),w=Ce(()=>e.openOnClick||e.openOnClick==null&&!e.openOnHover&&!b.value),{runOpenDelay:C,runCloseDelay:I}=Nz(e,ye=>{ye===(e.openOnHover&&d||b.value&&p)&&!(e.openOnHover&&i.value&&!a.value)&&(i.value!==ye&&(l=!0),i.value=ye)}),M={onClick:ye=>{ye.stopPropagation(),u.value=ye.currentTarget||ye.target,i.value=!i.value},onMouseenter:ye=>{var Ae;(Ae=ye.sourceCapabilities)!=null&&Ae.firesTouchEvents||(d=!0,u.value=ye.currentTarget||ye.target,C())},onMouseleave:ye=>{d=!1,I()},onFocus:ye=>{N_&&!ye.target.matches(":focus-visible")||(p=!0,ye.stopPropagation(),u.value=ye.currentTarget||ye.target,C())},onBlur:ye=>{p=!1,ye.stopPropagation(),I()}},O=Ce(()=>{const ye={};return w.value&&(ye.onClick=M.onClick),e.openOnHover&&(ye.onMouseenter=M.onMouseenter,ye.onMouseleave=M.onMouseleave),b.value&&(ye.onFocus=M.onFocus,ye.onBlur=M.onBlur),ye}),j=Ce(()=>{const ye={};if(e.openOnHover&&(ye.onMouseenter=()=>{d=!0,C()},ye.onMouseleave=()=>{d=!1,I()}),b.value&&(ye.onFocusin=()=>{p=!0,C()},ye.onFocusout=()=>{p=!1,I()}),e.closeOnContentClick){const Ae=Jn(J_,null);ye.onClick=()=>{i.value=!1,Ae==null||Ae.closeParents()}}return ye}),Z=Ce(()=>{const ye={};return e.openOnHover&&(ye.onMouseenter=()=>{l&&(d=!0,l=!1,C())},ye.onMouseleave=()=>{d=!1,I()}),ye});En(a,ye=>{ye&&(e.openOnHover&&!d&&(!b.value||!p)||b.value&&!p&&(!e.openOnHover||!d))&&(i.value=!1)});const ue=Kt();Ua(()=>{ue.value&&yr(()=>{u.value=O_(ue.value)})});const ce=Lr("useActivator");let ve;return En(()=>!!e.activator,ye=>{ye&&ji?(ve=pd(),ve.run(()=>{Vz(e,ce,{activatorEl:u,activatorEvents:O})})):ve&&ve.stop()},{flush:"post",immediate:!0}),Wr(()=>{ve==null||ve.stop()}),{activatorEl:u,activatorRef:ue,activatorEvents:O,contentEvents:j,scrimEvents:Z}}function Vz(e,t,i){let{activatorEl:a,activatorEvents:u}=i;En(()=>e.activator,(b,w)=>{if(w&&b!==w){const C=l(w);C&&p(C)}b&&yr(()=>d())},{immediate:!0}),En(()=>e.activatorProps,()=>{d()}),Wr(()=>{p()});function d(){let b=arguments.length>0&&arguments[0]!==void 0?arguments[0]:l(),w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e.activatorProps;b&&$P(b,Pn(u.value,w))}function p(){let b=arguments.length>0&&arguments[0]!==void 0?arguments[0]:l(),w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e.activatorProps;b&&VP(b,Pn(u.value,w))}function l(){var C,I;let b=arguments.length>0&&arguments[0]!==void 0?arguments[0]:e.activator,w;if(b)if(b==="parent"){let M=(I=(C=t==null?void 0:t.proxy)==null?void 0:C.$el)==null?void 0:I.parentNode;for(;M.hasAttribute("data-no-activator");)M=M.parentNode;w=M}else typeof b=="string"?w=document.querySelector(b):"$el"in b?w=b.$el:w=b;return a.value=(w==null?void 0:w.nodeType)===Node.ELEMENT_NODE?w:null,a.value}}function jz(){if(!ji)return Sn(!1);const{ssr:e}=pR();if(e){const t=Sn(!1);return wl(()=>{t.value=!0}),t}else return Sn(!0)}const Gz=Ft({eager:Boolean},"lazy");function qz(e,t){const i=Sn(!1),a=Ce(()=>i.value||e.eager||t.value);En(t,()=>i.value=!0);function u(){e.eager||(i.value=!1)}return{isBooted:i,hasContent:a,onAfterLeave:u}}function _T(){const t=Lr("useScopeId").vnode.scopeId;return{scopeId:t?{[t]:""}:void 0}}const y1=Symbol.for("vuetify:stack"),xh=Ki([]);function Hz(e,t,i){const a=Lr("useStack"),u=!i,d=Jn(y1,void 0),p=Ki({activeChildren:new Set});_r(y1,p);const l=Sn(+t.value);vl(e,()=>{var I;const C=(I=xh.at(-1))==null?void 0:I[1];l.value=C?C+10:+t.value,u&&xh.push([a.uid,l.value]),d==null||d.activeChildren.add(a.uid),Wr(()=>{if(u){const M=sn(xh).findIndex(O=>O[0]===a.uid);xh.splice(M,1)}d==null||d.activeChildren.delete(a.uid)})});const b=Sn(!0);u&&Ua(()=>{var I;const C=((I=xh.at(-1))==null?void 0:I[0])===a.uid;setTimeout(()=>b.value=C)});const w=Ce(()=>!p.activeChildren.size);return{globalTop:md(b),localTop:w,stackStyles:Ce(()=>({zIndex:l.value}))}}function Wz(e){return{teleportTarget:Ce(()=>{const i=e.value;if(i===!0||!ji)return;const a=i===!1?document.body:typeof i=="string"?document.querySelector(i):i;if(a==null)return;let u=a.querySelector(":scope > .v-overlay-container");return u||(u=document.createElement("div"),u.className="v-overlay-container",a.appendChild(u)),u})}}function Zz(){return!0}function yT(e,t,i){if(!e||vT(e,i)===!1)return!1;const a=sE(t);if(typeof ShadowRoot<"u"&&a instanceof ShadowRoot&&a.host===e.target)return!1;const u=(typeof i.value=="object"&&i.value.include||(()=>[]))();return u.push(t),!u.some(d=>d==null?void 0:d.contains(e.target))}function vT(e,t){return(typeof t.value=="object"&&t.value.closeConditional||Zz)(e)}function Yz(e,t,i){const a=typeof i.value=="function"?i.value:i.value.handler;t._clickOutside.lastMousedownWasOutside&&yT(e,t,i)&&setTimeout(()=>{vT(e,i)&&a&&a(e)},0)}function v1(e,t){const i=sE(e);t(document),typeof ShadowRoot<"u"&&i instanceof ShadowRoot&&t(i)}const Xz={mounted(e,t){const i=u=>Yz(u,e,t),a=u=>{e._clickOutside.lastMousedownWasOutside=yT(u,e,t)};v1(e,u=>{u.addEventListener("click",i,!0),u.addEventListener("mousedown",a,!0)}),e._clickOutside||(e._clickOutside={lastMousedownWasOutside:!1}),e._clickOutside[t.instance.$.uid]={onClick:i,onMousedown:a}},unmounted(e,t){e._clickOutside&&(v1(e,i=>{var d;if(!i||!((d=e._clickOutside)!=null&&d[t.instance.$.uid]))return;const{onClick:a,onMousedown:u}=e._clickOutside[t.instance.$.uid];i.removeEventListener("click",a,!0),i.removeEventListener("mousedown",u,!0)}),delete e._clickOutside[t.instance.$.uid])}};function Kz(e){const{modelValue:t,color:i,...a}=e;return le(za,{name:"fade-transition",appear:!0},{default:()=>[e.modelValue&&le("div",Pn({class:["v-overlay__scrim",e.color.backgroundColorClasses.value],style:e.color.backgroundColorStyles.value},a),null)]})}const xT=Ft({absolute:Boolean,attach:[Boolean,String,Object],closeOnBack:{type:Boolean,default:!0},contained:Boolean,contentClass:null,contentProps:null,disabled:Boolean,noClickAnimation:Boolean,modelValue:Boolean,persistent:Boolean,scrim:{type:[Boolean,String],default:!0},zIndex:{type:[Number,String],default:2e3},...Uz(),...ci(),...gm(),...Gz(),...Iz(),...Dz(),...Yr(),...au()},"VOverlay"),x1=Tn()({name:"VOverlay",directives:{ClickOutside:Xz},inheritAttrs:!1,props:{_disableGlobalStack:Boolean,...xT()},emits:{"click:outside":e=>!0,"update:modelValue":e=>!0,afterLeave:()=>!0},setup(e,t){let{slots:i,attrs:a,emit:u}=t;const d=Si(e,"modelValue"),p=Ce({get:()=>d.value,set:He=>{He&&e.disabled||(d.value=He)}}),{teleportTarget:l}=Wz(Ce(()=>e.attach||e.contained)),{themeClasses:b}=Is(e),{rtlClasses:w,isRtl:C}=su(),{hasContent:I,onAfterLeave:M}=qz(e,p),O=ed(Ce(()=>typeof e.scrim=="string"?e.scrim:null)),{globalTop:j,localTop:Z,stackStyles:ue}=Hz(p,wn(e,"zIndex"),e._disableGlobalStack),{activatorEl:ce,activatorRef:ve,activatorEvents:ye,contentEvents:Ae,scrimEvents:Be}=$z(e,{isActive:p,isTop:Z}),{dimensionStyles:Le}=_m(e),Ie=jz(),{scopeId:U}=_T();En(()=>e.disabled,He=>{He&&(p.value=!1)});const H=Kt(),he=Kt(),{contentStyles:xe,updateLocation:we}=kz(e,{isRtl:C,contentEl:he,activatorEl:ce,isActive:p});Lz(e,{root:H,contentEl:he,activatorEl:ce,isActive:p,updateLocation:we});function oe(He){u("click:outside",He),e.persistent?$e():p.value=!1}function ke(){return p.value&&j.value}ji&&En(p,He=>{He?window.addEventListener("keydown",tt):window.removeEventListener("keydown",tt)},{immediate:!0});function tt(He){var kt,Ct;He.key==="Escape"&&j.value&&(e.persistent?$e():(p.value=!1,(kt=he.value)!=null&&kt.contains(document.activeElement)&&((Ct=ce.value)==null||Ct.focus())))}const et=QL();vl(()=>e.closeOnBack,()=>{ez(et,He=>{j.value&&p.value?(He(!1),e.persistent?$e():p.value=!1):He()})});const Ve=Kt();En(()=>p.value&&(e.absolute||e.contained)&&l.value==null,He=>{if(He){const kt=sR(H.value);kt&&kt!==document.scrollingElement&&(Ve.value=kt.scrollTop)}});function $e(){e.noClickAnimation||he.value&&Ac(he.value,[{transformOrigin:"center"},{transform:"scale(1.03)"},{transformOrigin:"center"}],{duration:150,easing:Ep})}return Hn(()=>{var He;return le(gn,null,[(He=i.activator)==null?void 0:He.call(i,{isActive:p.value,props:Pn({ref:ve},ye.value,e.activatorProps)}),Ie.value&&le(zA,{disabled:!l.value,to:l.value},{default:()=>[I.value&&le("div",Pn({class:["v-overlay",{"v-overlay--absolute":e.absolute||e.contained,"v-overlay--active":p.value,"v-overlay--contained":e.contained},b.value,w.value,e.class],style:[ue.value,{top:mn(Ve.value)},e.style],ref:H},U,a),[le(Kz,Pn({color:O,modelValue:p.value&&!!e.scrim},Be.value),null),le(yo,{appear:!0,persisted:!0,transition:e.transition,target:ce.value,onAfterLeave:()=>{M(),u("afterLeave")}},{default:()=>{var kt;return[us(le("div",Pn({ref:he,class:["v-overlay__content",e.contentClass],style:[Le.value,xe.value]},Ae.value,e.contentProps),[(kt=i.default)==null?void 0:kt.call(i,{isActive:p})]),[[nu,p.value],[yl("click-outside"),{handler:oe,closeConditional:ke,include:()=>[ce.value]}]])]}})])]})])}),{activatorEl:ce,animateClick:$e,contentEl:he,globalTop:j,localTop:Z,updateLocation:we}}}),s_=Symbol("Forwarded refs");function a_(e,t){let i=e;for(;i;){const a=Reflect.getOwnPropertyDescriptor(i,t);if(a)return a;i=Object.getPrototypeOf(i)}}function ym(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),a=1;a<t;a++)i[a-1]=arguments[a];return e[s_]=i,new Proxy(e,{get(u,d){if(Reflect.has(u,d))return Reflect.get(u,d);if(!(typeof d=="symbol"||d.startsWith("__"))){for(const p of i)if(p.value&&Reflect.has(p.value,d)){const l=Reflect.get(p.value,d);return typeof l=="function"?l.bind(p.value):l}}},has(u,d){if(Reflect.has(u,d))return!0;if(typeof d=="symbol"||d.startsWith("__"))return!1;for(const p of i)if(p.value&&Reflect.has(p.value,d))return!0;return!1},getOwnPropertyDescriptor(u,d){var l;const p=Reflect.getOwnPropertyDescriptor(u,d);if(p)return p;if(!(typeof d=="symbol"||d.startsWith("__"))){for(const b of i){if(!b.value)continue;const w=a_(b.value,d)??("_"in b.value?a_((l=b.value._)==null?void 0:l.setupState,d):void 0);if(w)return w}for(const b of i){const w=b.value&&b.value[s_];if(!w)continue;const C=w.slice();for(;C.length;){const I=C.shift(),M=a_(I.value,d);if(M)return M;const O=I.value&&I.value[s_];O&&C.push(...O)}}}}})}const Jz=Ft({id:String,...cv(xT({closeDelay:250,closeOnContentClick:!0,locationStrategy:"connected",openDelay:300,scrim:!1,scrollStrategy:"reposition",transition:{component:AE}}),["absolute"])},"VMenu"),bT=Tn()({name:"VMenu",props:Jz(),emits:{"update:modelValue":e=>!0},setup(e,t){let{slots:i}=t;const a=Si(e,"modelValue"),{scopeId:u}=_T(),d=Hs(),p=Ce(()=>e.id||`v-menu-${d}`),l=Kt(),b=Jn(J_,null),w=Sn(0);_r(J_,{register(){++w.value},unregister(){--w.value},closeParents(){setTimeout(()=>{w.value||(a.value=!1,b==null||b.closeParents())},40)}}),En(a,j=>{j?b==null||b.register():b==null||b.unregister()});function C(){b==null||b.closeParents()}function I(j){var Z,ue;e.disabled||j.key==="Tab"&&(a.value=!1,(ue=(Z=l.value)==null?void 0:Z.activatorEl)==null||ue.focus())}function M(j){var ue;if(e.disabled)return;const Z=(ue=l.value)==null?void 0:ue.contentEl;Z&&a.value?j.key==="ArrowDown"?(j.preventDefault(),wp(Z,"next")):j.key==="ArrowUp"&&(j.preventDefault(),wp(Z,"prev")):["ArrowDown","ArrowUp"].includes(j.key)&&(a.value=!0,j.preventDefault(),setTimeout(()=>setTimeout(()=>M(j))))}const O=Ce(()=>Pn({"aria-haspopup":"menu","aria-expanded":String(a.value),"aria-owns":p.value,onKeydown:M},e.activatorProps));return Hn(()=>{const[j]=x1.filterProps(e);return le(x1,Pn({ref:l,class:["v-menu",e.class],style:e.style},j,{modelValue:a.value,"onUpdate:modelValue":Z=>a.value=Z,absolute:!0,activatorProps:O.value,"onClick:outside":C,onKeydown:I},u),{activator:i.activator,default:function(){for(var Z=arguments.length,ue=new Array(Z),ce=0;ce<Z;ce++)ue[ce]=arguments[ce];return le(ca,{root:"VMenu"},{default:()=>{var ve;return[(ve=i.default)==null?void 0:ve.call(i,...ue)]}})}})}),ym({id:p,openChildren:w},l)}}),Qz=Ft({active:Boolean,max:[Number,String],value:{type:[Number,String],default:0},...ci(),...au({transition:{component:PE}})},"VCounter"),eO=Tn()({name:"VCounter",functional:!0,props:Qz(),setup(e,t){let{slots:i}=t;const a=Ce(()=>e.max?`${e.value} / ${e.max}`:String(e.value));return Hn(()=>le(yo,{transition:e.transition},{default:()=>[us(le("div",{class:["v-counter",e.class],style:e.style},[i.default?i.default({counter:a.value,max:e.max,value:e.value}):a.value]),[[nu,e.active]])]})),{}}}),tO=Ft({floating:Boolean,...ci()},"VFieldLabel"),Vf=Tn()({name:"VFieldLabel",props:tO(),setup(e,t){let{slots:i}=t;return Hn(()=>le(LE,{class:["v-field-label",{"v-field-label--floating":e.floating},e.class],style:e.style,"aria-hidden":e.floating||void 0},i)),{}}}),nO=["underlined","outlined","filled","solo","solo-inverted","solo-filled","plain"],wT=Ft({appendInnerIcon:ki,bgColor:String,clearable:Boolean,clearIcon:{type:ki,default:"$clear"},active:Boolean,centerAffix:{type:Boolean,default:void 0},color:String,baseColor:String,dirty:Boolean,disabled:{type:Boolean,default:null},error:Boolean,flat:Boolean,label:String,persistentClear:Boolean,prependInnerIcon:ki,reverse:Boolean,singleLine:Boolean,variant:{type:String,default:"filled",validator:e=>nO.includes(e)},"onClick:clear":ha(),"onClick:appendInner":ha(),"onClick:prependInner":ha(),...ci(),...SL(),...cu(),...Yr()},"VField"),ST=Tn()({name:"VField",inheritAttrs:!1,props:{id:String,...ME(),...wT()},emits:{"update:focused":e=>!0,"update:modelValue":e=>!0},setup(e,t){let{attrs:i,emit:a,slots:u}=t;const{themeClasses:d}=Is(e),{loaderClasses:p}=qE(e),{focusClasses:l,isFocused:b,focus:w,blur:C}=Tv(e),{InputIcon:I}=CE(e),{roundedClasses:M}=uu(e),{rtlClasses:O}=su(),j=Ce(()=>e.dirty||e.active),Z=Ce(()=>!e.singleLine&&!!(e.label||u.label)),ue=Hs(),ce=Ce(()=>e.id||`input-${ue}`),ve=Ce(()=>`${ce.value}-messages`),ye=Kt(),Ae=Kt(),Be=Kt(),Le=Ce(()=>["plain","underlined"].includes(e.variant)),{backgroundColorClasses:Ie,backgroundColorStyles:U}=ed(wn(e,"bgColor")),{textColorClasses:H,textColorStyles:he}=pa(Ce(()=>e.error||e.disabled?void 0:j.value&&b.value?e.color:e.baseColor));En(j,oe=>{if(Z.value){const ke=ye.value.$el,tt=Ae.value.$el;requestAnimationFrame(()=>{const et=fv(ke),Ve=tt.getBoundingClientRect(),$e=Ve.x-et.x,He=Ve.y-et.y-(et.height/2-Ve.height/2),kt=Ve.width/.75,Ct=Math.abs(kt-et.width)>1?{maxWidth:mn(kt)}:void 0,rt=getComputedStyle(ke),It=getComputedStyle(tt),Vt=parseFloat(rt.transitionDuration)*1e3||150,Lt=parseFloat(It.getPropertyValue("--v-field-label-scale")),qe=It.getPropertyValue("color");ke.style.visibility="visible",tt.style.visibility="hidden",Ac(ke,{transform:`translate(${$e}px, ${He}px) scale(${Lt})`,color:qe,...Ct},{duration:Vt,easing:Ep,direction:oe?"normal":"reverse"}).finished.then(()=>{ke.style.removeProperty("visibility"),tt.style.removeProperty("visibility")})})}},{flush:"post"});const xe=Ce(()=>({isActive:j,isFocused:b,controlRef:Be,blur:C,focus:w}));function we(oe){oe.target!==document.activeElement&&oe.preventDefault()}return Hn(()=>{var $e,He,kt;const oe=e.variant==="outlined",ke=u["prepend-inner"]||e.prependInnerIcon,tt=!!(e.clearable||u.clear),et=!!(u["append-inner"]||e.appendInnerIcon||tt),Ve=u.label?u.label({...xe.value,label:e.label,props:{for:ce.value}}):e.label;return le("div",Pn({class:["v-field",{"v-field--active":j.value,"v-field--appended":et,"v-field--center-affix":e.centerAffix??!Le.value,"v-field--disabled":e.disabled,"v-field--dirty":e.dirty,"v-field--error":e.error,"v-field--flat":e.flat,"v-field--has-background":!!e.bgColor,"v-field--persistent-clear":e.persistentClear,"v-field--prepended":ke,"v-field--reverse":e.reverse,"v-field--single-line":e.singleLine,"v-field--no-label":!Ve,[`v-field--variant-${e.variant}`]:!0},d.value,Ie.value,l.value,p.value,M.value,O.value,e.class],style:[U.value,he.value,e.style],onClick:we},i),[le("div",{class:"v-field__overlay"},null),le(HE,{name:"v-field",active:!!e.loading,color:e.error?"error":e.color},{default:u.loader}),ke&&le("div",{key:"prepend",class:"v-field__prepend-inner"},[e.prependInnerIcon&&le(I,{key:"prepend-icon",name:"prependInner"},null),($e=u["prepend-inner"])==null?void 0:$e.call(u,xe.value)]),le("div",{class:"v-field__field","data-no-activator":""},[["filled","solo","solo-inverted","solo-filled"].includes(e.variant)&&Z.value&&le(Vf,{key:"floating-label",ref:Ae,class:[H.value],floating:!0,for:ce.value},{default:()=>[Ve]}),le(Vf,{ref:ye,for:ce.value},{default:()=>[Ve]}),(He=u.default)==null?void 0:He.call(u,{...xe.value,props:{id:ce.value,class:"v-field__input","aria-describedby":ve.value},focus:w,blur:C})]),tt&&le(RE,{key:"clear"},{default:()=>[us(le("div",{class:"v-field__clearable",onMousedown:Ct=>{Ct.preventDefault(),Ct.stopPropagation()}},[u.clear?u.clear():le(I,{name:"clear"},null)]),[[nu,e.dirty]])]}),et&&le("div",{key:"append",class:"v-field__append-inner"},[(kt=u["append-inner"])==null?void 0:kt.call(u,xe.value),e.appendInnerIcon&&le(I,{key:"append-icon",name:"appendInner"},null)]),le("div",{class:["v-field__outline",H.value]},[oe&&le(gn,null,[le("div",{class:"v-field__outline__start"},null),Z.value&&le("div",{class:"v-field__outline__notch"},[le(Vf,{ref:Ae,floating:!0,for:ce.value},{default:()=>[Ve]})]),le("div",{class:"v-field__outline__end"},null)]),Le.value&&Z.value&&le(Vf,{ref:Ae,floating:!0,for:ce.value},{default:()=>[Ve]})])])}),{controlRef:Be}}});function iO(e){const t=Object.keys(ST.props).filter(i=>!dv(i)&&i!=="class"&&i!=="style");return _d(e,t)}const rO=["color","file","time","date","datetime-local","week","month"],Bv=Ft({autofocus:Boolean,counter:[Boolean,Number,String],counterValue:Function,prefix:String,placeholder:String,persistentPlaceholder:Boolean,persistentCounter:Boolean,suffix:String,type:{type:String,default:"text"},modelModifiers:Object,...Iv(),...wT()},"VTextField"),zp=Tn()({name:"VTextField",directives:{Intersect:XE},inheritAttrs:!1,props:Bv(),emits:{"click:control":e=>!0,"mousedown:control":e=>!0,"update:focused":e=>!0,"update:modelValue":e=>!0},setup(e,t){let{attrs:i,emit:a,slots:u}=t;const d=Si(e,"modelValue"),{isFocused:p,focus:l,blur:b}=Tv(e),w=Ce(()=>typeof e.counterValue=="function"?e.counterValue(d.value):(d.value??"").toString().length),C=Ce(()=>{if(i.maxlength)return i.maxlength;if(!(!e.counter||typeof e.counter!="number"&&typeof e.counter!="string"))return e.counter}),I=Ce(()=>["plain","underlined"].includes(e.variant));function M(Le,Ie){var U,H;!e.autofocus||!Le||(H=(U=Ie[0].target)==null?void 0:U.focus)==null||H.call(U)}const O=Kt(),j=Kt(),Z=Kt(),ue=Ce(()=>rO.includes(e.type)||e.persistentPlaceholder||p.value||e.active);function ce(){var Le;Z.value!==document.activeElement&&((Le=Z.value)==null||Le.focus()),p.value||l()}function ve(Le){a("mousedown:control",Le),Le.target!==Z.value&&(ce(),Le.preventDefault())}function ye(Le){ce(),a("click:control",Le)}function Ae(Le){Le.stopPropagation(),ce(),yr(()=>{d.value=null,BP(e["onClick:clear"],Le)})}function Be(Le){var U;const Ie=Le.target;if(d.value=Ie.value,(U=e.modelModifiers)!=null&&U.trim&&["text","search","password","tel","url"].includes(e.type)){const H=[Ie.selectionStart,Ie.selectionEnd];yr(()=>{Ie.selectionStart=H[0],Ie.selectionEnd=H[1]})}}return Hn(()=>{const Le=!!(u.counter||e.counter||e.counterValue),Ie=!!(Le||u.details),[U,H]=uv(i),[{modelValue:he,...xe}]=Rp.filterProps(e),[we]=iO(e);return le(Rp,Pn({ref:O,modelValue:d.value,"onUpdate:modelValue":oe=>d.value=oe,class:["v-text-field",{"v-text-field--prefixed":e.prefix,"v-text-field--suffixed":e.suffix,"v-text-field--plain-underlined":["plain","underlined"].includes(e.variant)},e.class],style:e.style},U,xe,{centerAffix:!I.value,focused:p.value}),{...u,default:oe=>{let{id:ke,isDisabled:tt,isDirty:et,isReadonly:Ve,isValid:$e}=oe;return le(ST,Pn({ref:j,onMousedown:ve,onClick:ye,"onClick:clear":Ae,"onClick:prependInner":e["onClick:prependInner"],"onClick:appendInner":e["onClick:appendInner"],role:"textbox"},we,{id:ke.value,active:ue.value||et.value,dirty:et.value||e.dirty,disabled:tt.value,focused:p.value,error:$e.value===!1}),{...u,default:He=>{let{props:{class:kt,...Ct}}=He;const rt=us(le("input",Pn({ref:Z,value:d.value,onInput:Be,autofocus:e.autofocus,readonly:Ve.value,disabled:tt.value,name:e.name,placeholder:e.placeholder,size:1,type:e.type,onFocus:ce,onBlur:b},Ct,H),null),[[yl("intersect"),{handler:M},null,{once:!0}]]);return le(gn,null,[e.prefix&&le("span",{class:"v-text-field__prefix"},[e.prefix]),le("div",{class:kt,"data-no-activator":""},[u.default?le(gn,null,[u.default(),rt]):La(rt)]),e.suffix&&le("span",{class:"v-text-field__suffix"},[e.suffix])])}})},details:Ie?oe=>{var ke;return le(gn,null,[(ke=u.details)==null?void 0:ke.call(u,oe),Le&&le(gn,null,[le("span",null,null),le(eO,{active:e.persistentCounter||p.value,value:w.value,max:C.value},u.counter)])])}:void 0})}),ym({},O,j,Z)}}),ET=Ft({chips:Boolean,closableChips:Boolean,eager:Boolean,hideNoData:Boolean,hideSelected:Boolean,menu:Boolean,menuIcon:{type:ki,default:"$dropdown"},menuProps:{type:Object},multiple:Boolean,noDataText:{type:String,default:"$vuetify.noDataText"},openOnClear:Boolean,valueComparator:{type:Function,default:iu},...cT({itemChildren:!1})},"Select"),sO=Ft({...ET(),...cv(Bv({modelValue:null}),["validationValue","dirty","appendInnerIcon"]),...au({transition:{component:AE}})},"VSelect");Tn()({name:"VSelect",props:sO(),emits:{"update:focused":e=>!0,"update:modelValue":e=>!0,"update:menu":e=>!0},setup(e,t){let{slots:i}=t;const{t:a}=dm(),u=Kt(),d=Kt(),p=Si(e,"menu"),l=Ce({get:()=>p.value,set:oe=>{var ke;p.value&&!oe&&((ke=d.value)!=null&&ke.openChildren)||(p.value=oe)}}),{items:b,transformIn:w,transformOut:C}=dT(e),I=Si(e,"modelValue",[],oe=>w(oe===null?[null]:ua(oe)),oe=>{const ke=C(oe);return e.multiple?ke:ke[0]??null}),M=Cv(),O=Ce(()=>I.value.map(oe=>b.value.find(ke=>e.valueComparator(ke.value,oe.value))||oe)),j=Ce(()=>O.value.map(oe=>oe.props.value)),Z=Sn(!1);let ue="",ce;const ve=Ce(()=>e.hideSelected?b.value.filter(oe=>!O.value.some(ke=>ke===oe)):b.value),ye=Ce(()=>e.hideNoData&&!b.value.length||e.readonly||(M==null?void 0:M.isReadonly.value)),Ae=Kt();function Be(oe){e.openOnClear&&(l.value=!0)}function Le(){ye.value||(l.value=!l.value)}function Ie(oe){var $e,He;if(e.readonly||M!=null&&M.isReadonly.value)return;["Enter"," ","ArrowDown","ArrowUp","Home","End"].includes(oe.key)&&oe.preventDefault(),["Enter","ArrowDown"," "].includes(oe.key)&&(l.value=!0),["Escape","Tab"].includes(oe.key)&&(l.value=!1),oe.key==="Home"?($e=Ae.value)==null||$e.focus("first"):oe.key==="End"&&((He=Ae.value)==null||He.focus("last"));const ke=1e3;function tt(kt){const Ct=kt.key.length===1,rt=!kt.ctrlKey&&!kt.metaKey&&!kt.altKey;return Ct&&rt}if(e.multiple||!tt(oe))return;const et=performance.now();et-ce>ke&&(ue=""),ue+=oe.key.toLowerCase(),ce=et;const Ve=b.value.find(kt=>kt.title.toLowerCase().startsWith(ue));Ve!==void 0&&(I.value=[Ve])}function U(oe){var ke;oe.key==="Tab"&&((ke=u.value)==null||ke.focus())}function H(oe){if(e.multiple){const ke=j.value.findIndex(tt=>e.valueComparator(tt,oe.value));if(ke===-1)I.value=[...I.value,oe];else{const tt=[...I.value];tt.splice(ke,1),I.value=tt}}else I.value=[oe],l.value=!1}function he(oe){var ke;(ke=Ae.value)!=null&&ke.$el.contains(oe.relatedTarget)||(l.value=!1)}function xe(){var oe;Z.value&&((oe=u.value)==null||oe.focus())}function we(oe){Z.value=!0}return Hn(()=>{const oe=!!(e.chips||i.chip),ke=!!(!e.hideNoData||ve.value.length||i["prepend-item"]||i["append-item"]||i["no-data"]),tt=I.value.length>0,[et]=zp.filterProps(e),Ve=tt||!Z.value&&e.label&&!e.persistentPlaceholder?void 0:e.placeholder;return le(zp,Pn({ref:u},et,{modelValue:I.value.map($e=>$e.props.value).join(", "),"onUpdate:modelValue":$e=>{$e==null&&(I.value=[])},focused:Z.value,"onUpdate:focused":$e=>Z.value=$e,validationValue:I.externalValue,dirty:tt,class:["v-select",{"v-select--active-menu":l.value,"v-select--chips":!!e.chips,[`v-select--${e.multiple?"multiple":"single"}`]:!0,"v-select--selected":I.value.length,"v-select--selection-slot":!!i.selection},e.class],style:e.style,readonly:!0,placeholder:Ve,"onClick:clear":Be,"onMousedown:control":Le,onBlur:he,onKeydown:Ie}),{...i,default:()=>le(gn,null,[le(bT,Pn({ref:d,modelValue:l.value,"onUpdate:modelValue":$e=>l.value=$e,activator:"parent",contentClass:"v-select__content",disabled:ye.value,eager:e.eager,maxHeight:310,openOnClick:!1,closeOnContentClick:!1,transition:e.transition,onAfterLeave:xe},e.menuProps),{default:()=>[ke&&le(pT,{ref:Ae,selected:j.value,selectStrategy:e.multiple?"independent":"single-independent",onMousedown:$e=>$e.preventDefault(),onKeydown:U,onFocusin:we,tabindex:"-1"},{default:()=>{var $e,He,kt;return[($e=i["prepend-item"])==null?void 0:$e.call(i),!ve.value.length&&!e.hideNoData&&(((He=i["no-data"])==null?void 0:He.call(i))??le(Uc,{title:a(e.noDataText)},null)),ve.value.map((Ct,rt)=>{var Vt;const It=Pn(Ct.props,{key:rt,onClick:()=>H(Ct)});return((Vt=i.item)==null?void 0:Vt.call(i,{item:Ct,index:rt,props:It}))??le(Uc,It,{prepend:Lt=>{let{isSelected:qe}=Lt;return le(gn,null,[e.multiple&&!e.hideSelected?le(WE,{key:Ct.value,modelValue:qe,ripple:!1,tabindex:"-1"},null):void 0,Ct.props.prependIcon&&le(ls,{icon:Ct.props.prependIcon},null)])}})}),(kt=i["append-item"])==null?void 0:kt.call(i)]}})]}),O.value.map(($e,He)=>{var rt;function kt(It){It.stopPropagation(),It.preventDefault(),H($e)}const Ct={"onClick:close":kt,onMousedown(It){It.preventDefault(),It.stopPropagation()},modelValue:!0,"onUpdate:modelValue":void 0};return le("div",{key:$e.value,class:"v-select__selection"},[oe?i.chip?le(ca,{key:"chip-defaults",defaults:{VChip:{closable:e.closableChips,size:"small",text:$e.title}}},{default:()=>{var It;return[(It=i.chip)==null?void 0:It.call(i,{item:$e,index:He,props:Ct})]}}):le(tT,Pn({key:"chip",closable:e.closableChips,size:"small",text:$e.title},Ct),null):((rt=i.selection)==null?void 0:rt.call(i,{item:$e,index:He}))??le("span",{class:"v-select__selection-text"},[$e.title,e.multiple&&He<O.value.length-1&&le("span",{class:"v-select__selection-comma"},[To(",")])])])})]),"append-inner":function(){var Ct;for(var $e=arguments.length,He=new Array($e),kt=0;kt<$e;kt++)He[kt]=arguments[kt];return le(gn,null,[(Ct=i["append-inner"])==null?void 0:Ct.call(i,...He),e.menuIcon?le(ls,{class:"v-select__menu-icon",icon:e.menuIcon},null):void 0])}})}),ym({isFocused:Z,menu:l,select:H},u)}});const aO=(e,t,i)=>e==null||t==null?-1:e.toString().toLocaleLowerCase().indexOf(t.toString().toLocaleLowerCase()),oO=Ft({customFilter:Function,customKeyFilter:Object,filterKeys:[Array,String],filterMode:{type:String,default:"intersection"},noFilter:Boolean},"filter");function lO(e,t,i){var l;const a=[],u=(i==null?void 0:i.default)??aO,d=i!=null&&i.filterKeys?ua(i.filterKeys):!1,p=Object.keys((i==null?void 0:i.customKeyFilter)??{}).length;if(!(e!=null&&e.length))return a;e:for(let b=0;b<e.length;b++){const w=e[b],C={},I={};let M=-1;if(t&&!(i!=null&&i.noFilter)){if(typeof w=="object"){const Z=d||Object.keys(w);for(const ue of Z){const ce=la(w,ue,w),ve=(l=i==null?void 0:i.customKeyFilter)==null?void 0:l[ue];if(M=ve?ve(ce,t,w):u(ce,t,w),M!==-1&&M!==!1)ve?C[ue]=M:I[ue]=M;else if((i==null?void 0:i.filterMode)==="every")continue e}}else M=u(w,t,w),M!==-1&&M!==!1&&(I.title=M);const O=Object.keys(I).length,j=Object.keys(C).length;if(!O&&!j||(i==null?void 0:i.filterMode)==="union"&&j!==p&&!O||(i==null?void 0:i.filterMode)==="intersection"&&(j!==p||!O))continue}a.push({index:b,matches:{...I,...C}})}return a}function cO(e,t,i,a){const u=Ce(()=>typeof(i==null?void 0:i.value)!="string"&&typeof(i==null?void 0:i.value)!="number"?"":String(i.value)),d=Kt([]),p=Kt(new Map),l=Ce(()=>a!=null&&a.transform?ur(t).map(a==null?void 0:a.transform):ur(t));Ua(()=>{d.value=[],p.value=new Map;const w=lO(l.value,u.value,{customKeyFilter:e.customKeyFilter,default:e.customFilter,filterKeys:e.filterKeys,filterMode:e.filterMode,noFilter:e.noFilter}),C=ur(t);w.forEach(I=>{let{index:M,matches:O}=I;const j=C[M];d.value.push(j),p.value.set(j.value,O)})});function b(w){return p.value.get(w.value)}return{filteredItems:d,filteredMatches:p,getMatches:b}}function uO(e,t,i){if(t==null)return e;if(Array.isArray(t))throw new Error("Multiple matches is not implemented");return typeof t=="number"&&~t?le(gn,null,[le("span",{class:"v-autocomplete__unmask"},[e.substr(0,t)]),le("span",{class:"v-autocomplete__mask"},[e.substr(t,i)]),le("span",{class:"v-autocomplete__unmask"},[e.substr(t+i)])]):e}const hO=Ft({autoSelectFirst:{type:[Boolean,String]},search:String,...oO({filterKeys:["title"]}),...ET(),...cv(Bv({modelValue:null}),["validationValue","dirty","appendInnerIcon"]),...au({transition:!1})},"VAutocomplete"),dO=Tn()({name:"VAutocomplete",props:hO(),emits:{"update:focused":e=>!0,"update:search":e=>!0,"update:modelValue":e=>!0,"update:menu":e=>!0},setup(e,t){let{slots:i}=t;const{t:a}=dm(),u=Kt(),d=Sn(!1),p=Sn(!0),l=Kt(!1),b=Kt(),w=Si(e,"menu"),C=Ce({get:()=>w.value,set:qe=>{var Se;w.value&&!qe&&((Se=b.value)!=null&&Se.openChildren)||(w.value=qe)}}),I=Sn(-1),M=Ce(()=>{var qe;return(qe=u.value)==null?void 0:qe.color}),{items:O,transformIn:j,transformOut:Z}=dT(e),{textColorClasses:ue,textColorStyles:ce}=pa(M),ve=Si(e,"search",""),ye=Si(e,"modelValue",[],qe=>j(qe===null?[null]:ua(qe)),qe=>{const Se=Z(qe);return e.multiple?Se:Se[0]??null}),Ae=Cv(),{filteredItems:Be,getMatches:Le}=cO(e,O,Ce(()=>p.value?void 0:ve.value)),Ie=Ce(()=>ye.value.map(qe=>O.value.find(Se=>e.valueComparator(Se.value,qe.value))||qe)),U=Ce(()=>e.hideSelected?Be.value.filter(qe=>!Ie.value.some(Se=>Se.value===qe.value)):Be.value),H=Ce(()=>Ie.value.map(qe=>qe.props.value)),he=Ce(()=>Ie.value[I.value]),xe=Ce(()=>{var Se;return(e.autoSelectFirst===!0||e.autoSelectFirst==="exact"&&ve.value===((Se=U.value[0])==null?void 0:Se.title))&&U.value.length>0&&!p.value&&!l.value}),we=Ce(()=>e.hideNoData&&!O.value.length||e.readonly||(Ae==null?void 0:Ae.isReadonly.value)),oe=Kt();function ke(qe){e.openOnClear&&(C.value=!0),ve.value=""}function tt(){we.value||(C.value=!0)}function et(qe){we.value||(d.value&&(qe.preventDefault(),qe.stopPropagation()),C.value=!C.value)}function Ve(qe){var Oe,je,ft;if(e.readonly||Ae!=null&&Ae.isReadonly.value)return;const Se=u.value.selectionStart,Ye=H.value.length;if((I.value>-1||["Enter","ArrowDown","ArrowUp"].includes(qe.key))&&qe.preventDefault(),["Enter","ArrowDown"].includes(qe.key)&&(C.value=!0),["Escape"].includes(qe.key)&&(C.value=!1),["Enter","Escape","Tab"].includes(qe.key)&&(xe.value&&["Enter","Tab"].includes(qe.key)&&Lt(Be.value[0]),p.value=!0),qe.key==="ArrowDown"&&xe.value&&((Oe=oe.value)==null||Oe.focus("next")),!!e.multiple){if(["Backspace","Delete"].includes(qe.key)){if(I.value<0){qe.key==="Backspace"&&!ve.value&&(I.value=Ye-1);return}const Y=I.value;he.value&&Lt(he.value),I.value=Y>=Ye-1?Ye-2:Y}if(qe.key==="ArrowLeft"){if(I.value<0&&Se>0)return;const Y=I.value>-1?I.value-1:Ye-1;Ie.value[Y]?I.value=Y:(I.value=-1,u.value.setSelectionRange((je=ve.value)==null?void 0:je.length,(ft=ve.value)==null?void 0:ft.length))}if(qe.key==="ArrowRight"){if(I.value<0)return;const Y=I.value+1;Ie.value[Y]?I.value=Y:(I.value=-1,u.value.setSelectionRange(0,0))}}}function $e(qe){var Se;qe.key==="Tab"&&((Se=u.value)==null||Se.focus())}function He(qe){ve.value=qe.target.value}function kt(){var qe;d.value&&(p.value=!0,(qe=u.value)==null||qe.focus())}function Ct(qe){d.value=!0,setTimeout(()=>{l.value=!0})}function rt(qe){l.value=!1}function It(qe){(qe==null||qe===""&&!e.multiple)&&(ye.value=[])}const Vt=Sn(!1);function Lt(qe){if(e.multiple){const Se=H.value.findIndex(Ye=>e.valueComparator(Ye,qe.value));if(Se===-1)ye.value=[...ye.value,qe];else{const Ye=[...ye.value];Ye.splice(Se,1),ye.value=Ye}}else ye.value=[qe],Vt.value=!0,ve.value=qe.title,C.value=!1,p.value=!0,yr(()=>Vt.value=!1)}return En(d,(qe,Se)=>{var Ye;qe!==Se&&(qe?(Vt.value=!0,ve.value=e.multiple?"":String(((Ye=Ie.value.at(-1))==null?void 0:Ye.props.title)??""),p.value=!0,yr(()=>Vt.value=!1)):(!e.multiple&&!ve.value?ye.value=[]:xe.value&&!l.value&&!Ie.value.some(Oe=>{let{value:je}=Oe;return je===U.value[0].value})&&Lt(U.value[0]),C.value=!1,ve.value="",I.value=-1))}),En(ve,qe=>{!d.value||Vt.value||(qe&&(C.value=!0),p.value=!qe)}),Hn(()=>{const qe=!!(e.chips||i.chip),Se=!!(!e.hideNoData||U.value.length||i["prepend-item"]||i["append-item"]||i["no-data"]),Ye=ye.value.length>0,[Oe]=zp.filterProps(e);return le(zp,Pn({ref:u},Oe,{modelValue:ve.value,"onUpdate:modelValue":It,focused:d.value,"onUpdate:focused":je=>d.value=je,validationValue:ye.externalValue,dirty:Ye,onInput:He,class:["v-autocomplete",`v-autocomplete--${e.multiple?"multiple":"single"}`,{"v-autocomplete--active-menu":C.value,"v-autocomplete--chips":!!e.chips,"v-autocomplete--selection-slot":!!i.selection,"v-autocomplete--selecting-index":I.value>-1},e.class],style:e.style,readonly:e.readonly,placeholder:Ye?void 0:e.placeholder,"onClick:clear":ke,"onMousedown:control":tt,onKeydown:Ve}),{...i,default:()=>le(gn,null,[le(bT,Pn({ref:b,modelValue:C.value,"onUpdate:modelValue":je=>C.value=je,activator:"parent",contentClass:"v-autocomplete__content",disabled:we.value,eager:e.eager,maxHeight:310,openOnClick:!1,closeOnContentClick:!1,transition:e.transition,onAfterLeave:kt},e.menuProps),{default:()=>[Se&&le(pT,{ref:oe,selected:H.value,selectStrategy:e.multiple?"independent":"single-independent",onMousedown:je=>je.preventDefault(),onKeydown:$e,onFocusin:Ct,onFocusout:rt,tabindex:"-1"},{default:()=>{var je,ft,Y;return[(je=i["prepend-item"])==null?void 0:je.call(i),!U.value.length&&!e.hideNoData&&(((ft=i["no-data"])==null?void 0:ft.call(i))??le(Uc,{title:a(e.noDataText)},null)),U.value.map((ie,W)=>{var Ue;const De=Pn(ie.props,{key:W,active:xe.value&&W===0?!0:void 0,onClick:()=>Lt(ie)});return((Ue=i.item)==null?void 0:Ue.call(i,{item:ie,index:W,props:De}))??le(Uc,De,{prepend:Ne=>{let{isSelected:Ze}=Ne;return le(gn,null,[e.multiple&&!e.hideSelected?le(WE,{key:ie.value,modelValue:Ze,ripple:!1,tabindex:"-1"},null):void 0,ie.props.prependIcon&&le(ls,{icon:ie.props.prependIcon},null)])},title:()=>{var Ne,Ze;return p.value?ie.title:uO(ie.title,(Ne=Le(ie))==null?void 0:Ne.title,((Ze=ve.value)==null?void 0:Ze.length)??0)}})}),(Y=i["append-item"])==null?void 0:Y.call(i)]}})]}),Ie.value.map((je,ft)=>{var W;function Y(De){De.stopPropagation(),De.preventDefault(),Lt(je)}const ie={"onClick:close":Y,onMousedown(De){De.preventDefault(),De.stopPropagation()},modelValue:!0,"onUpdate:modelValue":void 0};return le("div",{key:je.value,class:["v-autocomplete__selection",ft===I.value&&["v-autocomplete__selection--selected",ue.value]],style:ft===I.value?ce.value:{}},[qe?i.chip?le(ca,{key:"chip-defaults",defaults:{VChip:{closable:e.closableChips,size:"small",text:je.title}}},{default:()=>{var De;return[(De=i.chip)==null?void 0:De.call(i,{item:je,index:ft,props:ie})]}}):le(tT,Pn({key:"chip",closable:e.closableChips,size:"small",text:je.title},ie),null):((W=i.selection)==null?void 0:W.call(i,{item:je,index:ft}))??le("span",{class:"v-autocomplete__selection-text"},[je.title,e.multiple&&ft<Ie.value.length-1&&le("span",{class:"v-autocomplete__selection-comma"},[To(",")])])])})]),"append-inner":function(){var ie;for(var je=arguments.length,ft=new Array(je),Y=0;Y<je;Y++)ft[Y]=arguments[Y];return le(gn,null,[(ie=i["append-inner"])==null?void 0:ie.call(i,...ft),e.menuIcon?le(ls,{class:"v-autocomplete__menu-icon",icon:e.menuIcon,onMousedown:et,onClick:NP},null):void 0])}})}),ym({isFocused:d,isPristine:p,menu:C,search:ve,filteredItems:Be,select:Lt},u)}}),fO={class:"AutocompleteFilter"};function pO(e,t,i,a,u,d){return ln(),pn("div",fO,[Bt("label",null,Ui(e.label),1),le(dO,{modelValue:e.selected,"onUpdate:modelValue":t[0]||(t[0]=p=>e.selected=p),items:e.data,"item-value":"value","item-title":"label",id:"autocomplete",rounded:"xl",placeholder:"Slectionner...",variant:"outlined",multiple:"","return-object":""},null,8,["modelValue","items"])])}const mO=Br(Ba,[["render",pO]]);var gO=Object.defineProperty,_O=Object.getOwnPropertyDescriptor,yO=(e,t,i,a)=>{for(var u=a>1?void 0:a?_O(t,i):t,d=e.length-1,p;d>=0;d--)(p=e[d])&&(u=(a?p(t,i,u):p(u))||u);return a&&u&&gO(t,i,u),u};let Q_=class extends Or{get isShown(){return mi().isFiltersBarShown}get filterStore(){return Yn()}get countriesData(){return Yn().countries.map(t=>({label:t,value:t}))}get thematicsData(){return Yn().thematics.map(t=>({label:t.label,value:t.value}))}get resetTrigger(){return Yn().resetTrigger}resetFilters(){Yn().countriesFilter=[],Yn().thematicsFilter=[],Yn().resetTrigger=!this.resetTrigger,Yn().search=""}updateCountries(t){Yn().countriesFilter=t}updateThematics(t){Yn().thematicsFilter=t}};Q_=yO([zr({components:{AutocompleteFilter:mO,Button:vd}})],Q_);const vO=["shown"],xO={class:"FiltersBar__filtersCtn"};function bO(e,t,i,a,u,d){const p=lr("Button"),l=lr("AutocompleteFilter");return e.isShown?(ln(),pn("div",{key:0,class:"FiltersBar",shown:e.isShown},[le(p,{label:"Rinitialiser",uppercase:"true",small:"true",class:"FiltersBar__resetBtn",onClick:e.resetFilters},null,8,["onClick"]),Bt("div",xO,[le(l,{label:"Pays",reset:e.resetTrigger,data:e.countriesData,onOnSelected:t[0]||(t[0]=b=>e.updateCountries(b.map(w=>w.value)))},null,8,["reset","data"]),le(l,{label:"Thmatique",reset:e.resetTrigger,data:e.thematicsData,onOnSelected:t[1]||(t[1]=b=>e.updateThematics(b.map(w=>w.value)))},null,8,["reset","data"])])],8,vO)):ar("",!0)}const wO=Br(Q_,[["render",bO]]);var SO=Object.defineProperty,EO=Object.getOwnPropertyDescriptor,TT=(e,t,i,a)=>{for(var u=a>1?void 0:a?EO(t,i):t,d=e.length-1,p;d>=0;d--)(p=e[d])&&(u=(a?p(t,i,u):p(u))||u);return a&&u&&SO(t,i,u),u};let Op=class extends Or{constructor(){super(...arguments);ei(this,"downloadReport")}};TT([Xr({default:"Button label"})],Op.prototype,"downloadReport",2);Op=TT([zr({})],Op);const TO=["href"],CO={class:"DownloadReportItem__name"},IO=["src"];function kO(e,t,i,a,u,d){return ln(),pn("a",{class:"DownloadReportItem",href:"./reports/"+e.downloadReport.filename,download:""},[Bt("h3",CO,Ui(e.downloadReport.name),1),Bt("img",{src:"./img/icons/mdi-download-circle-outline-grey.svg",alt:"Download icon"},null,8,IO)],8,TO)}const AO=Br(Op,[["render",kO]]);var PO=Object.defineProperty,RO=Object.getOwnPropertyDescriptor,MO=(e,t,i,a)=>{for(var u=a>1?void 0:a?RO(t,i):t,d=e.length-1,p;d>=0;d--)(p=e[d])&&(u=(a?p(t,i,u):p(u))||u);return a&&u&&PO(t,i,u),u};let ey=class extends Or{constructor(){super(...arguments);ei(this,"actors",[{category:"Coordination du projet",partners:[{name:"FORIM",logo:"forim.png",link:"https://forim.net/"}]},{category:"Comit de pilotage du projet",partners:[{name:"GRDR",logo:"grdr.svg",link:"https://grdr.org/"},{name:"LOUJNA",logo:"loujna.png",link:"http://loujna-tounkaranke.org/"}]},{category:"Financ par",partners:[{name:"AFD",logo:"afd.svg",link:"https://www.afd.fr/"},{name:"Expertise France",logo:"expertise_france.svg",link:"https://www.expertisefrance.fr/"}]}])}get isAboutModalShown(){return mi().isAboutModalShown}get isDownloadShown(){return mi().isDownloadShown}get downloadReports(){return mi().downloadReports}close(){mi().isAboutModalShown=!1,setTimeout(()=>mi().isDownloadShown=!1,300)}toggleIsDownloadShown(){mi().isDownloadShown=!this.isDownloadShown}};ey=MO([zr({components:{Button:vd,DownloadReportItem:AO}})],ey);const DO=["open"],LO={class:"AboutModal__head"},zO={key:0,class:"AboutModal__content"},OO={class:"AboutModal__downloadsCtn"},BO={key:1,class:"AboutModal__content"},FO=Bt("div",{class:"AboutModal__ctn AboutModal__ctn--right"},[Bt("div",{class:"AboutModal__titles"},[Bt("h2",null,"Coopration rgionale des politiques migratoires"),Bt("h3",null,"Composante 2 : Socit civile : Amliorer le dialogue entre OSC et pouvoirs publics pour des politiques migratoires justes et pertinentes en Afrique ")]),Bt("div",{class:"AboutModal__contentDesc"},[Bt("p",null,"Financ par lAFD, Expertise France a lanc en juin 2020 le programme  Coopration Rgionale des Politiques Migratoires  qui vise  renforcer le dialogue entre 7 pays africains sur les politiques nationales en matire de migration (Tunisie, Maroc, Sngal, Mali, Cte dIvoire, Guine et Cameroun)."),Bt("p",null,"La Composante 1 du programme, entend dvelopper, via des points focaux dans les ministres en charge des enjeux migrations dans chaque pays, les capacits de suivi des autorits et llaboration de nouveaux indicateurs, ainsi que le partage de pratiques."),Bt("p",{class:"bold"},"La composante 2 du programme se concentre quant  elle sur les organisations de la socit civile et ambitionne de crer et prenniser des mcanismes de dialogue entre les OSC et les autorits nationales et rgionales sur les politiques migratoires.")])],-1),NO={class:"AboutModal__ctn AboutModal__ctn--left"},UO={class:"AboutModal__partnersCtn"},$O=["href"],VO=["src","alt"],jO={class:"AboutModal__footer"};function GO(e,t,i,a,u,d){const p=lr("Button"),l=lr("DownloadReportItem");return ln(),pn("dialog",{class:"AboutModal",open:e.isAboutModalShown},[Bt("div",LO,[Bt("h1",null,Ui(e.isDownloadShown?"Tlchargements":" propos du projet"),1),le(p,{label:e.isDownloadShown?" propos":"Tlchargements",uppercase:!0,icon:e.isDownloadShown?"mdi-information-variant-circle-outline":"mdi-download-circle-outline",onClick:t[0]||(t[0]=b=>e.toggleIsDownloadShown())},null,8,["label","icon"])]),e.isDownloadShown?(ln(),pn("div",zO,[Bt("div",OO,[(ln(!0),pn(gn,null,zc(e.downloadReports,(b,w)=>(ln(),om(l,{downloadReport:b,key:w},null,8,["downloadReport"]))),128))])])):ar("",!0),e.isDownloadShown?ar("",!0):(ln(),pn("div",BO,[FO,Bt("div",NO,[(ln(!0),pn(gn,null,zc(e.actors,(b,w)=>(ln(),pn("div",{class:"AboutModal__actorsCtn",key:w},[Bt("h3",null,Ui(b.category),1),Bt("div",UO,[(ln(!0),pn(gn,null,zc(b.partners,(C,I)=>(ln(),pn("a",{href:C.link,target:"_blank",rel:"noopener noreferrer",key:I},[Bt("img",{src:"./img/logos/"+C.logo,alt:C.name+" logo",loading:"lazy"},null,8,VO)],8,$O))),128))])]))),128))])])),Bt("div",jO,[Bt("button",{onClick:t[1]||(t[1]=b=>e.close())},"Fermer")])],8,DO)}const qO=Br(ey,[["render",GO]]);var HO=Object.defineProperty,WO=Object.getOwnPropertyDescriptor,ZO=(e,t,i,a)=>{for(var u=a>1?void 0:a?WO(t,i):t,d=e.length-1,p;d>=0;d--)(p=e[d])&&(u=(a?p(t,i,u):p(u))||u);return a&&u&&HO(t,i,u),u};let ty=class extends Or{get isRedirectionModalShown(){return mi().isRedirectionModalShown}close(){mi().isRedirectionModalShown=!1}};ty=ZO([zr({components:{Button:vd}})],ty);const YO=["open"],XO=Bt("div",{class:"Modal__head"},[Bt("h1",null,"Renseigner une association")],-1),KO=Bt("div",{class:"Modal__content"},[Bt("p",null,"Si vous souhaitez signaler une nouvelle association ou mettre  jour les informations affiches sur la carte, merci de remplir le questionnaire en ligne. Veillez  bien renseigner le numro de tlphone et ladresse lectronique : nous vous recontacterons avant la mise en ligne des informations.")],-1),JO={class:"Modal__footer"},QO=Bt("a",{href:"https://ee.kobotoolbox.org/x/1a1GtPyH",target:"_blank"},"Accder",-1);function eB(e,t,i,a,u,d){return ln(),pn("dialog",{class:"Modal",open:e.isRedirectionModalShown},[XO,KO,Bt("div",JO,[Bt("button",{onClick:t[0]||(t[0]=p=>e.close())},"Annuler"),QO])],8,YO)}const tB=Br(ty,[["render",eB]]);var CT={exports:{}};/* @license
Papa Parse
v5.4.1
https://github.com/mholt/PapaParse
License: MIT
*/(function(e,t){(function(i,a){e.exports=a()})(xE,function i(){var a=typeof self<"u"?self:typeof window<"u"?window:a!==void 0?a:{},u=!a.document&&!!a.postMessage,d=a.IS_PAPA_WORKER||!1,p={},l=0,b={parse:function(U,H){var he=(H=H||{}).dynamicTyping||!1;if(Ie(he)&&(H.dynamicTypingFunction=he,he={}),H.dynamicTyping=he,H.transform=!!Ie(H.transform)&&H.transform,H.worker&&b.WORKERS_SUPPORTED){var xe=function(){if(!b.WORKERS_SUPPORTED)return!1;var oe=(tt=a.URL||a.webkitURL||null,et=i.toString(),b.BLOB_URL||(b.BLOB_URL=tt.createObjectURL(new Blob(["var global = (function() { if (typeof self !== 'undefined') { return self; } if (typeof window !== 'undefined') { return window; } if (typeof global !== 'undefined') { return global; } return {}; })(); global.IS_PAPA_WORKER=true; ","(",et,")();"],{type:"text/javascript"})))),ke=new a.Worker(oe),tt,et;return ke.onmessage=ve,ke.id=l++,p[ke.id]=ke}();return xe.userStep=H.step,xe.userChunk=H.chunk,xe.userComplete=H.complete,xe.userError=H.error,H.step=Ie(H.step),H.chunk=Ie(H.chunk),H.complete=Ie(H.complete),H.error=Ie(H.error),delete H.worker,void xe.postMessage({input:U,config:H,workerId:xe.id})}var we=null;return b.NODE_STREAM_INPUT,typeof U=="string"?(U=function(oe){return oe.charCodeAt(0)===65279?oe.slice(1):oe}(U),we=H.download?new I(H):new O(H)):U.readable===!0&&Ie(U.read)&&Ie(U.on)?we=new j(H):(a.File&&U instanceof File||U instanceof Object)&&(we=new M(H)),we.stream(U)},unparse:function(U,H){var he=!1,xe=!0,we=",",oe=`\r
`,ke='"',tt=ke+ke,et=!1,Ve=null,$e=!1;(function(){if(typeof H=="object"){if(typeof H.delimiter!="string"||b.BAD_DELIMITERS.filter(function(rt){return H.delimiter.indexOf(rt)!==-1}).length||(we=H.delimiter),(typeof H.quotes=="boolean"||typeof H.quotes=="function"||Array.isArray(H.quotes))&&(he=H.quotes),typeof H.skipEmptyLines!="boolean"&&typeof H.skipEmptyLines!="string"||(et=H.skipEmptyLines),typeof H.newline=="string"&&(oe=H.newline),typeof H.quoteChar=="string"&&(ke=H.quoteChar),typeof H.header=="boolean"&&(xe=H.header),Array.isArray(H.columns)){if(H.columns.length===0)throw new Error("Option columns is empty");Ve=H.columns}H.escapeChar!==void 0&&(tt=H.escapeChar+ke),(typeof H.escapeFormulae=="boolean"||H.escapeFormulae instanceof RegExp)&&($e=H.escapeFormulae instanceof RegExp?H.escapeFormulae:/^[=+\-@\t\r].*$/)}})();var He=new RegExp(ue(ke),"g");if(typeof U=="string"&&(U=JSON.parse(U)),Array.isArray(U)){if(!U.length||Array.isArray(U[0]))return kt(null,U,et);if(typeof U[0]=="object")return kt(Ve||Object.keys(U[0]),U,et)}else if(typeof U=="object")return typeof U.data=="string"&&(U.data=JSON.parse(U.data)),Array.isArray(U.data)&&(U.fields||(U.fields=U.meta&&U.meta.fields||Ve),U.fields||(U.fields=Array.isArray(U.data[0])?U.fields:typeof U.data[0]=="object"?Object.keys(U.data[0]):[]),Array.isArray(U.data[0])||typeof U.data[0]=="object"||(U.data=[U.data])),kt(U.fields||[],U.data||[],et);throw new Error("Unable to serialize unrecognized input");function kt(rt,It,Vt){var Lt="";typeof rt=="string"&&(rt=JSON.parse(rt)),typeof It=="string"&&(It=JSON.parse(It));var qe=Array.isArray(rt)&&0<rt.length,Se=!Array.isArray(It[0]);if(qe&&xe){for(var Ye=0;Ye<rt.length;Ye++)0<Ye&&(Lt+=we),Lt+=Ct(rt[Ye],Ye);0<It.length&&(Lt+=oe)}for(var Oe=0;Oe<It.length;Oe++){var je=qe?rt.length:It[Oe].length,ft=!1,Y=qe?Object.keys(It[Oe]).length===0:It[Oe].length===0;if(Vt&&!qe&&(ft=Vt==="greedy"?It[Oe].join("").trim()==="":It[Oe].length===1&&It[Oe][0].length===0),Vt==="greedy"&&qe){for(var ie=[],W=0;W<je;W++){var De=Se?rt[W]:W;ie.push(It[Oe][De])}ft=ie.join("").trim()===""}if(!ft){for(var Ue=0;Ue<je;Ue++){0<Ue&&!Y&&(Lt+=we);var Ne=qe&&Se?rt[Ue]:Ue;Lt+=Ct(It[Oe][Ne],Ue)}Oe<It.length-1&&(!Vt||0<je&&!Y)&&(Lt+=oe)}}return Lt}function Ct(rt,It){if(rt==null)return"";if(rt.constructor===Date)return JSON.stringify(rt).slice(1,25);var Vt=!1;$e&&typeof rt=="string"&&$e.test(rt)&&(rt="'"+rt,Vt=!0);var Lt=rt.toString().replace(He,tt);return(Vt=Vt||he===!0||typeof he=="function"&&he(rt,It)||Array.isArray(he)&&he[It]||function(qe,Se){for(var Ye=0;Ye<Se.length;Ye++)if(-1<qe.indexOf(Se[Ye]))return!0;return!1}(Lt,b.BAD_DELIMITERS)||-1<Lt.indexOf(we)||Lt.charAt(0)===" "||Lt.charAt(Lt.length-1)===" ")?ke+Lt+ke:Lt}}};if(b.RECORD_SEP=String.fromCharCode(30),b.UNIT_SEP=String.fromCharCode(31),b.BYTE_ORDER_MARK="\uFEFF",b.BAD_DELIMITERS=["\r",`
`,'"',b.BYTE_ORDER_MARK],b.WORKERS_SUPPORTED=!u&&!!a.Worker,b.NODE_STREAM_INPUT=1,b.LocalChunkSize=10485760,b.RemoteChunkSize=5242880,b.DefaultDelimiter=",",b.Parser=ce,b.ParserHandle=Z,b.NetworkStreamer=I,b.FileStreamer=M,b.StringStreamer=O,b.ReadableStreamStreamer=j,a.jQuery){var w=a.jQuery;w.fn.parse=function(U){var H=U.config||{},he=[];return this.each(function(oe){if(!(w(this).prop("tagName").toUpperCase()==="INPUT"&&w(this).attr("type").toLowerCase()==="file"&&a.FileReader)||!this.files||this.files.length===0)return!0;for(var ke=0;ke<this.files.length;ke++)he.push({file:this.files[ke],inputElem:this,instanceConfig:w.extend({},H)})}),xe(),this;function xe(){if(he.length!==0){var oe,ke,tt,et,Ve=he[0];if(Ie(U.before)){var $e=U.before(Ve.file,Ve.inputElem);if(typeof $e=="object"){if($e.action==="abort")return oe="AbortError",ke=Ve.file,tt=Ve.inputElem,et=$e.reason,void(Ie(U.error)&&U.error({name:oe},ke,tt,et));if($e.action==="skip")return void we();typeof $e.config=="object"&&(Ve.instanceConfig=w.extend(Ve.instanceConfig,$e.config))}else if($e==="skip")return void we()}var He=Ve.instanceConfig.complete;Ve.instanceConfig.complete=function(kt){Ie(He)&&He(kt,Ve.file,Ve.inputElem),we()},b.parse(Ve.file,Ve.instanceConfig)}else Ie(U.complete)&&U.complete()}function we(){he.splice(0,1),xe()}}}function C(U){this._handle=null,this._finished=!1,this._completed=!1,this._halted=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},function(H){var he=Be(H);he.chunkSize=parseInt(he.chunkSize),H.step||H.chunk||(he.chunkSize=null),this._handle=new Z(he),(this._handle.streamer=this)._config=he}.call(this,U),this.parseChunk=function(H,he){if(this.isFirstChunk&&Ie(this._config.beforeFirstChunk)){var xe=this._config.beforeFirstChunk(H);xe!==void 0&&(H=xe)}this.isFirstChunk=!1,this._halted=!1;var we=this._partialLine+H;this._partialLine="";var oe=this._handle.parse(we,this._baseIndex,!this._finished);if(!this._handle.paused()&&!this._handle.aborted()){var ke=oe.meta.cursor;this._finished||(this._partialLine=we.substring(ke-this._baseIndex),this._baseIndex=ke),oe&&oe.data&&(this._rowCount+=oe.data.length);var tt=this._finished||this._config.preview&&this._rowCount>=this._config.preview;if(d)a.postMessage({results:oe,workerId:b.WORKER_ID,finished:tt});else if(Ie(this._config.chunk)&&!he){if(this._config.chunk(oe,this._handle),this._handle.paused()||this._handle.aborted())return void(this._halted=!0);oe=void 0,this._completeResults=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(oe.data),this._completeResults.errors=this._completeResults.errors.concat(oe.errors),this._completeResults.meta=oe.meta),this._completed||!tt||!Ie(this._config.complete)||oe&&oe.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),tt||oe&&oe.meta.paused||this._nextChunk(),oe}this._halted=!0},this._sendError=function(H){Ie(this._config.error)?this._config.error(H):d&&this._config.error&&a.postMessage({workerId:b.WORKER_ID,error:H,finished:!1})}}function I(U){var H;(U=U||{}).chunkSize||(U.chunkSize=b.RemoteChunkSize),C.call(this,U),this._nextChunk=u?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(he){this._input=he,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(H=new XMLHttpRequest,this._config.withCredentials&&(H.withCredentials=this._config.withCredentials),u||(H.onload=Le(this._chunkLoaded,this),H.onerror=Le(this._chunkError,this)),H.open(this._config.downloadRequestBody?"POST":"GET",this._input,!u),this._config.downloadRequestHeaders){var he=this._config.downloadRequestHeaders;for(var xe in he)H.setRequestHeader(xe,he[xe])}if(this._config.chunkSize){var we=this._start+this._config.chunkSize-1;H.setRequestHeader("Range","bytes="+this._start+"-"+we)}try{H.send(this._config.downloadRequestBody)}catch(oe){this._chunkError(oe.message)}u&&H.status===0&&this._chunkError()}},this._chunkLoaded=function(){H.readyState===4&&(H.status<200||400<=H.status?this._chunkError():(this._start+=this._config.chunkSize?this._config.chunkSize:H.responseText.length,this._finished=!this._config.chunkSize||this._start>=function(he){var xe=he.getResponseHeader("Content-Range");return xe===null?-1:parseInt(xe.substring(xe.lastIndexOf("/")+1))}(H),this.parseChunk(H.responseText)))},this._chunkError=function(he){var xe=H.statusText||he;this._sendError(new Error(xe))}}function M(U){var H,he;(U=U||{}).chunkSize||(U.chunkSize=b.LocalChunkSize),C.call(this,U);var xe=typeof FileReader<"u";this.stream=function(we){this._input=we,he=we.slice||we.webkitSlice||we.mozSlice,xe?((H=new FileReader).onload=Le(this._chunkLoaded,this),H.onerror=Le(this._chunkError,this)):H=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var we=this._input;if(this._config.chunkSize){var oe=Math.min(this._start+this._config.chunkSize,this._input.size);we=he.call(we,this._start,oe)}var ke=H.readAsText(we,this._config.encoding);xe||this._chunkLoaded({target:{result:ke}})},this._chunkLoaded=function(we){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(we.target.result)},this._chunkError=function(){this._sendError(H.error)}}function O(U){var H;C.call(this,U=U||{}),this.stream=function(he){return H=he,this._nextChunk()},this._nextChunk=function(){if(!this._finished){var he,xe=this._config.chunkSize;return xe?(he=H.substring(0,xe),H=H.substring(xe)):(he=H,H=""),this._finished=!H,this.parseChunk(he)}}}function j(U){C.call(this,U=U||{});var H=[],he=!0,xe=!1;this.pause=function(){C.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){C.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(we){this._input=we,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){xe&&H.length===1&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),H.length?this.parseChunk(H.shift()):he=!0},this._streamData=Le(function(we){try{H.push(typeof we=="string"?we:we.toString(this._config.encoding)),he&&(he=!1,this._checkIsFinished(),this.parseChunk(H.shift()))}catch(oe){this._streamError(oe)}},this),this._streamError=Le(function(we){this._streamCleanUp(),this._sendError(we)},this),this._streamEnd=Le(function(){this._streamCleanUp(),xe=!0,this._streamData("")},this),this._streamCleanUp=Le(function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)},this)}function Z(U){var H,he,xe,we=Math.pow(2,53),oe=-we,ke=/^\s*-?(\d+\.?|\.\d+|\d+\.\d+)([eE][-+]?\d+)?\s*$/,tt=/^((\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z)))$/,et=this,Ve=0,$e=0,He=!1,kt=!1,Ct=[],rt={data:[],errors:[],meta:{}};if(Ie(U.step)){var It=U.step;U.step=function(Oe){if(rt=Oe,qe())Lt();else{if(Lt(),rt.data.length===0)return;Ve+=Oe.data.length,U.preview&&Ve>U.preview?he.abort():(rt.data=rt.data[0],It(rt,et))}}}function Vt(Oe){return U.skipEmptyLines==="greedy"?Oe.join("").trim()==="":Oe.length===1&&Oe[0].length===0}function Lt(){return rt&&xe&&(Ye("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+b.DefaultDelimiter+"'"),xe=!1),U.skipEmptyLines&&(rt.data=rt.data.filter(function(Oe){return!Vt(Oe)})),qe()&&function(){if(!rt)return;function Oe(ft,Y){Ie(U.transformHeader)&&(ft=U.transformHeader(ft,Y)),Ct.push(ft)}if(Array.isArray(rt.data[0])){for(var je=0;qe()&&je<rt.data.length;je++)rt.data[je].forEach(Oe);rt.data.splice(0,1)}else rt.data.forEach(Oe)}(),function(){if(!rt||!U.header&&!U.dynamicTyping&&!U.transform)return rt;function Oe(ft,Y){var ie,W=U.header?{}:[];for(ie=0;ie<ft.length;ie++){var De=ie,Ue=ft[ie];U.header&&(De=ie>=Ct.length?"__parsed_extra":Ct[ie]),U.transform&&(Ue=U.transform(Ue,De)),Ue=Se(De,Ue),De==="__parsed_extra"?(W[De]=W[De]||[],W[De].push(Ue)):W[De]=Ue}return U.header&&(ie>Ct.length?Ye("FieldMismatch","TooManyFields","Too many fields: expected "+Ct.length+" fields but parsed "+ie,$e+Y):ie<Ct.length&&Ye("FieldMismatch","TooFewFields","Too few fields: expected "+Ct.length+" fields but parsed "+ie,$e+Y)),W}var je=1;return!rt.data.length||Array.isArray(rt.data[0])?(rt.data=rt.data.map(Oe),je=rt.data.length):rt.data=Oe(rt.data,0),U.header&&rt.meta&&(rt.meta.fields=Ct),$e+=je,rt}()}function qe(){return U.header&&Ct.length===0}function Se(Oe,je){return ft=Oe,U.dynamicTypingFunction&&U.dynamicTyping[ft]===void 0&&(U.dynamicTyping[ft]=U.dynamicTypingFunction(ft)),(U.dynamicTyping[ft]||U.dynamicTyping)===!0?je==="true"||je==="TRUE"||je!=="false"&&je!=="FALSE"&&(function(Y){if(ke.test(Y)){var ie=parseFloat(Y);if(oe<ie&&ie<we)return!0}return!1}(je)?parseFloat(je):tt.test(je)?new Date(je):je===""?null:je):je;var ft}function Ye(Oe,je,ft,Y){var ie={type:Oe,code:je,message:ft};Y!==void 0&&(ie.row=Y),rt.errors.push(ie)}this.parse=function(Oe,je,ft){var Y=U.quoteChar||'"';if(U.newline||(U.newline=function(De,Ue){De=De.substring(0,1048576);var Ne=new RegExp(ue(Ue)+"([^]*?)"+ue(Ue),"gm"),Ze=(De=De.replace(Ne,"")).split("\r"),ct=De.split(`
`),dt=1<ct.length&&ct[0].length<Ze[0].length;if(Ze.length===1||dt)return`
`;for(var nt=0,ut=0;ut<Ze.length;ut++)Ze[ut][0]===`
`&&nt++;return nt>=Ze.length/2?`\r
`:"\r"}(Oe,Y)),xe=!1,U.delimiter)Ie(U.delimiter)&&(U.delimiter=U.delimiter(Oe),rt.meta.delimiter=U.delimiter);else{var ie=function(De,Ue,Ne,Ze,ct){var dt,nt,ut,mt;ct=ct||[",","	","|",";",b.RECORD_SEP,b.UNIT_SEP];for(var Mt=0;Mt<ct.length;Mt++){var wt=ct[Mt],Ge=0,tn=0,Zt=0;ut=void 0;for(var dn=new ce({comments:Ze,delimiter:wt,newline:Ue,preview:10}).parse(De),zn=0;zn<dn.data.length;zn++)if(Ne&&Vt(dn.data[zn]))Zt++;else{var at=dn.data[zn].length;tn+=at,ut!==void 0?0<at&&(Ge+=Math.abs(at-ut),ut=at):ut=at}0<dn.data.length&&(tn/=dn.data.length-Zt),(nt===void 0||Ge<=nt)&&(mt===void 0||mt<tn)&&1.99<tn&&(nt=Ge,dt=wt,mt=tn)}return{successful:!!(U.delimiter=dt),bestDelimiter:dt}}(Oe,U.newline,U.skipEmptyLines,U.comments,U.delimitersToGuess);ie.successful?U.delimiter=ie.bestDelimiter:(xe=!0,U.delimiter=b.DefaultDelimiter),rt.meta.delimiter=U.delimiter}var W=Be(U);return U.preview&&U.header&&W.preview++,H=Oe,he=new ce(W),rt=he.parse(H,je,ft),Lt(),He?{meta:{paused:!0}}:rt||{meta:{paused:!1}}},this.paused=function(){return He},this.pause=function(){He=!0,he.abort(),H=Ie(U.chunk)?"":H.substring(he.getCharIndex())},this.resume=function(){et.streamer._halted?(He=!1,et.streamer.parseChunk(H,!0)):setTimeout(et.resume,3)},this.aborted=function(){return kt},this.abort=function(){kt=!0,he.abort(),rt.meta.aborted=!0,Ie(U.complete)&&U.complete(rt),H=""}}function ue(U){return U.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function ce(U){var H,he=(U=U||{}).delimiter,xe=U.newline,we=U.comments,oe=U.step,ke=U.preview,tt=U.fastMode,et=H=U.quoteChar===void 0||U.quoteChar===null?'"':U.quoteChar;if(U.escapeChar!==void 0&&(et=U.escapeChar),(typeof he!="string"||-1<b.BAD_DELIMITERS.indexOf(he))&&(he=","),we===he)throw new Error("Comment character same as delimiter");we===!0?we="#":(typeof we!="string"||-1<b.BAD_DELIMITERS.indexOf(we))&&(we=!1),xe!==`
`&&xe!=="\r"&&xe!==`\r
`&&(xe=`
`);var Ve=0,$e=!1;this.parse=function(He,kt,Ct){if(typeof He!="string")throw new Error("Input must be a string");var rt=He.length,It=he.length,Vt=xe.length,Lt=we.length,qe=Ie(oe),Se=[],Ye=[],Oe=[],je=Ve=0;if(!He)return jt();if(U.header&&!kt){var ft=He.split(xe)[0].split(he),Y=[],ie={},W=!1;for(var De in ft){var Ue=ft[De];Ie(U.transformHeader)&&(Ue=U.transformHeader(Ue,De));var Ne=Ue,Ze=ie[Ue]||0;for(0<Ze&&(W=!0,Ne=Ue+"_"+Ze),ie[Ue]=Ze+1;Y.includes(Ne);)Ne=Ne+"_"+Ze;Y.push(Ne)}if(W){var ct=He.split(xe);ct[0]=Y.join(he),He=ct.join(xe)}}if(tt||tt!==!1&&He.indexOf(H)===-1){for(var dt=He.split(xe),nt=0;nt<dt.length;nt++){if(Oe=dt[nt],Ve+=Oe.length,nt!==dt.length-1)Ve+=xe.length;else if(Ct)return jt();if(!we||Oe.substring(0,Lt)!==we){if(qe){if(Se=[],Zt(Oe.split(he)),qt(),$e)return jt()}else Zt(Oe.split(he));if(ke&&ke<=nt)return Se=Se.slice(0,ke),jt(!0)}}return jt()}for(var ut=He.indexOf(he,Ve),mt=He.indexOf(xe,Ve),Mt=new RegExp(ue(et)+ue(H),"g"),wt=He.indexOf(H,Ve);;)if(He[Ve]!==H)if(we&&Oe.length===0&&He.substring(Ve,Ve+Lt)===we){if(mt===-1)return jt();Ve=mt+Vt,mt=He.indexOf(xe,Ve),ut=He.indexOf(he,Ve)}else if(ut!==-1&&(ut<mt||mt===-1))Oe.push(He.substring(Ve,ut)),Ve=ut+It,ut=He.indexOf(he,Ve);else{if(mt===-1)break;if(Oe.push(He.substring(Ve,mt)),at(mt+Vt),qe&&(qt(),$e))return jt();if(ke&&Se.length>=ke)return jt(!0)}else for(wt=Ve,Ve++;;){if((wt=He.indexOf(H,wt+1))===-1)return Ct||Ye.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:Se.length,index:Ve}),zn();if(wt===rt-1)return zn(He.substring(Ve,wt).replace(Mt,H));if(H!==et||He[wt+1]!==et){if(H===et||wt===0||He[wt-1]!==et){ut!==-1&&ut<wt+1&&(ut=He.indexOf(he,wt+1)),mt!==-1&&mt<wt+1&&(mt=He.indexOf(xe,wt+1));var Ge=dn(mt===-1?ut:Math.min(ut,mt));if(He.substr(wt+1+Ge,It)===he){Oe.push(He.substring(Ve,wt).replace(Mt,H)),He[Ve=wt+1+Ge+It]!==H&&(wt=He.indexOf(H,Ve)),ut=He.indexOf(he,Ve),mt=He.indexOf(xe,Ve);break}var tn=dn(mt);if(He.substring(wt+1+tn,wt+1+tn+Vt)===xe){if(Oe.push(He.substring(Ve,wt).replace(Mt,H)),at(wt+1+tn+Vt),ut=He.indexOf(he,Ve),wt=He.indexOf(H,Ve),qe&&(qt(),$e))return jt();if(ke&&Se.length>=ke)return jt(!0);break}Ye.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:Se.length,index:Ve}),wt++}}else wt++}return zn();function Zt(Dn){Se.push(Dn),je=Ve}function dn(Dn){var fn=0;if(Dn!==-1){var Ot=He.substring(wt+1,Dn);Ot&&Ot.trim()===""&&(fn=Ot.length)}return fn}function zn(Dn){return Ct||(Dn===void 0&&(Dn=He.substring(Ve)),Oe.push(Dn),Ve=rt,Zt(Oe),qe&&qt()),jt()}function at(Dn){Ve=Dn,Zt(Oe),Oe=[],mt=He.indexOf(xe,Ve)}function jt(Dn){return{data:Se,errors:Ye,meta:{delimiter:he,linebreak:xe,aborted:$e,truncated:!!Dn,cursor:je+(kt||0)}}}function qt(){oe(jt()),Se=[],Ye=[]}},this.abort=function(){$e=!0},this.getCharIndex=function(){return Ve}}function ve(U){var H=U.data,he=p[H.workerId],xe=!1;if(H.error)he.userError(H.error,H.file);else if(H.results&&H.results.data){var we={abort:function(){xe=!0,ye(H.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:Ae,resume:Ae};if(Ie(he.userStep)){for(var oe=0;oe<H.results.data.length&&(he.userStep({data:H.results.data[oe],errors:H.results.errors,meta:H.results.meta},we),!xe);oe++);delete H.results}else Ie(he.userChunk)&&(he.userChunk(H.results,we,H.file),delete H.results)}H.finished&&!xe&&ye(H.workerId,H.results)}function ye(U,H){var he=p[U];Ie(he.userComplete)&&he.userComplete(H),he.terminate(),delete p[U]}function Ae(){throw new Error("Not implemented.")}function Be(U){if(typeof U!="object"||U===null)return U;var H=Array.isArray(U)?[]:{};for(var he in U)H[he]=Be(U[he]);return H}function Le(U,H){return function(){U.apply(H,arguments)}}function Ie(U){return typeof U=="function"}return d&&(a.onmessage=function(U){var H=U.data;if(b.WORKER_ID===void 0&&H&&(b.WORKER_ID=H.workerId),typeof H.input=="string")a.postMessage({workerId:b.WORKER_ID,results:b.parse(H.input,H.config),finished:!0});else if(a.File&&H.input instanceof File||H.input instanceof Object){var he=b.parse(H.input,H.config);he&&a.postMessage({workerId:b.WORKER_ID,results:he,finished:!0})}}),(I.prototype=Object.create(C.prototype)).constructor=I,(M.prototype=Object.create(C.prototype)).constructor=M,(O.prototype=Object.create(O.prototype)).constructor=O,(j.prototype=Object.create(C.prototype)).constructor=j,b})})(CT);var nB=CT.exports;class IT{static async parseFile(t){return new Promise((i,a)=>{nB.parse(t,{header:!0,delimiter:",",download:!0,skipEmptyLines:!0,complete(u){i(u.data)},error(u){a(u)}})})}static async readAssociationDb(){return(await this.parseFile(this.associationDbFileName)).map((i,a)=>{let u=Yn().thematics.map(d=>i[d.value]==="x"?d.value:null);return{id:a,updatedAt:i.maj??null,country:i.pays??null,coords:{x:parseFloat(i.coordo_x.replace(",","."))??null,y:parseFloat(i.coordo_y.replace(",","."))??null},name:i.nom??null,adress:i.adresse??null,indic:i.indic??null,tel:i.numero??null,telOther:i.autre_numero??null,emails:i.email.split(";").map(d=>d.trim())??[],websiteUrl:i.internet??null,status:i.statut??null,year:i.annee??null,budget:i.budget??null,dialog:i.dialogue??null,intervention:i.intervention??null,thematics:u.filter(d=>d!=null)}})}}ei(IT,"associationDbFileName","https://docs.google.com/spreadsheets/d/e/2PACX-1vSvwjGskDe6C81X_mESVjkXUHQCzDWcYE-dsUXADsmOf8xbS7zg_fZn-xoztj4-3g/pub?gid=766950911&single=true&output=csv");var iB=Object.defineProperty,rB=Object.getOwnPropertyDescriptor,sB=(e,t,i,a)=>{for(var u=a>1?void 0:a?rB(t,i):t,d=e.length-1,p;d>=0;d--)(p=e[d])&&(u=(a?p(t,i,u):p(u))||u);return a&&u&&iB(t,i,u),u};let ny=class extends Or{async mounted(){const t=await IT.readAssociationDb();zi().associations=t,Yn().countries=[...new Set(t.map(i=>i.country))].sort()}};ny=sB([zr({components:{OSCMap:DD,AssociationBar:LL,FiltersBar:wO,AboutModal:qO,RedirectionConfirmModal:tB}})],ny);const aB=Ft({...ci(),...tM({fullHeight:!0}),...Yr()},"VApp"),oB=Tn()({name:"VApp",props:aB(),setup(e,t){let{slots:i}=t;const a=Is(e),{layoutClasses:u,layoutStyles:d,getLayoutItem:p,items:l,layoutRef:b}=iM(e),{rtlClasses:w}=su();return Hn(()=>{var C;return le("div",{ref:b,class:["v-application",a.themeClasses.value,u.value,w.value,e.class],style:[d.value,e.style]},[le("div",{class:"v-application__wrap"},[(C=i.default)==null?void 0:C.call(i)])])}),{getLayoutItem:p,items:l,theme:a}}}),lB=Bt("h1",{class:"App__title"},[To("Cartographie des "),Bt("b",null,[Bt("span",{class:"hide-sm"},"Organisations de la Socit Civile ("),To("OSC"),Bt("span",{class:"hide-sm"},")"),To(" africaines actives sur les enjeux migratoires")])],-1),cB={class:"App__content"},uB={class:"App__ctn App__ctn--right"};function hB(e,t,i,a,u,d){const p=lr("AssociationBar"),l=lr("FiltersBar"),b=lr("OSCMap"),w=lr("AboutModal"),C=lr("RedirectionConfirmModal");return ln(),om(oB,{class:"App"},{default:_S(()=>[lB,Bt("div",cB,[le(p,{class:"App__ctn App__ctn--left"}),Bt("div",uB,[le(l),le(b)]),le(w),le(C)])]),_:1})}const dB=Br(ny,[["render",hB]]);/*!
  * vue-router v4.2.2
  * (c) 2023 Eduardo San Martin Morote
  * @license MIT
  */const Ic=typeof window<"u";function fB(e){return e.__esModule||e[Symbol.toStringTag]==="Module"}const jn=Object.assign;function o_(e,t){const i={};for(const a in t){const u=t[a];i[a]=Gs(u)?u.map(e):e(u)}return i}const Dh=()=>{},Gs=Array.isArray,pB=/\/$/,mB=e=>e.replace(pB,"");function l_(e,t,i="/"){let a,u={},d="",p="";const l=t.indexOf("#");let b=t.indexOf("?");return l<b&&l>=0&&(b=-1),b>-1&&(a=t.slice(0,b),d=t.slice(b+1,l>-1?l:t.length),u=e(d)),l>-1&&(a=a||t.slice(0,l),p=t.slice(l,t.length)),a=vB(a??t,i),{fullPath:a+(d&&"?")+d+p,path:a,query:u,hash:p}}function gB(e,t){const i=t.query?e(t.query):"";return t.path+(i&&"?")+i+(t.hash||"")}function b1(e,t){return!t||!e.toLowerCase().startsWith(t.toLowerCase())?e:e.slice(t.length)||"/"}function _B(e,t,i){const a=t.matched.length-1,u=i.matched.length-1;return a>-1&&a===u&&$c(t.matched[a],i.matched[u])&&kT(t.params,i.params)&&e(t.query)===e(i.query)&&t.hash===i.hash}function $c(e,t){return(e.aliasOf||e)===(t.aliasOf||t)}function kT(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const i in e)if(!yB(e[i],t[i]))return!1;return!0}function yB(e,t){return Gs(e)?w1(e,t):Gs(t)?w1(t,e):e===t}function w1(e,t){return Gs(t)?e.length===t.length&&e.every((i,a)=>i===t[a]):e.length===1&&e[0]===t}function vB(e,t){if(e.startsWith("/"))return e;if(!e)return t;const i=t.split("/"),a=e.split("/"),u=a[a.length-1];(u===".."||u===".")&&a.push("");let d=i.length-1,p,l;for(p=0;p<a.length;p++)if(l=a[p],l!==".")if(l==="..")d>1&&d--;else break;return i.slice(0,d).join("/")+"/"+a.slice(p-(p===a.length?1:0)).join("/")}var rd;(function(e){e.pop="pop",e.push="push"})(rd||(rd={}));var Lh;(function(e){e.back="back",e.forward="forward",e.unknown=""})(Lh||(Lh={}));function xB(e){if(!e)if(Ic){const t=document.querySelector("base");e=t&&t.getAttribute("href")||"/",e=e.replace(/^\w+:\/\/[^\/]+/,"")}else e="/";return e[0]!=="/"&&e[0]!=="#"&&(e="/"+e),mB(e)}const bB=/^[^#]+#/;function wB(e,t){return e.replace(bB,"#")+t}function SB(e,t){const i=document.documentElement.getBoundingClientRect(),a=e.getBoundingClientRect();return{behavior:t.behavior,left:a.left-i.left-(t.left||0),top:a.top-i.top-(t.top||0)}}const vm=()=>({left:window.pageXOffset,top:window.pageYOffset});function EB(e){let t;if("el"in e){const i=e.el,a=typeof i=="string"&&i.startsWith("#"),u=typeof i=="string"?a?document.getElementById(i.slice(1)):document.querySelector(i):i;if(!u)return;t=SB(u,e)}else t=e;"scrollBehavior"in document.documentElement.style?window.scrollTo(t):window.scrollTo(t.left!=null?t.left:window.pageXOffset,t.top!=null?t.top:window.pageYOffset)}function S1(e,t){return(history.state?history.state.position-t:-1)+e}const iy=new Map;function TB(e,t){iy.set(e,t)}function CB(e){const t=iy.get(e);return iy.delete(e),t}let IB=()=>location.protocol+"//"+location.host;function AT(e,t){const{pathname:i,search:a,hash:u}=t,d=e.indexOf("#");if(d>-1){let l=u.includes(e.slice(d))?e.slice(d).length:1,b=u.slice(l);return b[0]!=="/"&&(b="/"+b),b1(b,"")}return b1(i,e)+a+u}function kB(e,t,i,a){let u=[],d=[],p=null;const l=({state:M})=>{const O=AT(e,location),j=i.value,Z=t.value;let ue=0;if(M){if(i.value=O,t.value=M,p&&p===j){p=null;return}ue=Z?M.position-Z.position:0}else a(O);u.forEach(ce=>{ce(i.value,j,{delta:ue,type:rd.pop,direction:ue?ue>0?Lh.forward:Lh.back:Lh.unknown})})};function b(){p=i.value}function w(M){u.push(M);const O=()=>{const j=u.indexOf(M);j>-1&&u.splice(j,1)};return d.push(O),O}function C(){const{history:M}=window;M.state&&M.replaceState(jn({},M.state,{scroll:vm()}),"")}function I(){for(const M of d)M();d=[],window.removeEventListener("popstate",l),window.removeEventListener("beforeunload",C)}return window.addEventListener("popstate",l),window.addEventListener("beforeunload",C,{passive:!0}),{pauseListeners:b,listen:w,destroy:I}}function E1(e,t,i,a=!1,u=!1){return{back:e,current:t,forward:i,replaced:a,position:window.history.length,scroll:u?vm():null}}function AB(e){const{history:t,location:i}=window,a={value:AT(e,i)},u={value:t.state};u.value||d(a.value,{back:null,current:a.value,forward:null,position:t.length-1,replaced:!0,scroll:null},!0);function d(b,w,C){const I=e.indexOf("#"),M=I>-1?(i.host&&document.querySelector("base")?e:e.slice(I))+b:IB()+e+b;try{t[C?"replaceState":"pushState"](w,"",M),u.value=w}catch(O){console.error(O),i[C?"replace":"assign"](M)}}function p(b,w){const C=jn({},t.state,E1(u.value.back,b,u.value.forward,!0),w,{position:u.value.position});d(b,C,!0),a.value=b}function l(b,w){const C=jn({},u.value,t.state,{forward:b,scroll:vm()});d(C.current,C,!0);const I=jn({},E1(a.value,b,null),{position:C.position+1},w);d(b,I,!1),a.value=b}return{location:a,state:u,push:l,replace:p}}function PB(e){e=xB(e);const t=AB(e),i=kB(e,t.state,t.location,t.replace);function a(d,p=!0){p||i.pauseListeners(),history.go(d)}const u=jn({location:"",base:e,go:a,createHref:wB.bind(null,e)},t,i);return Object.defineProperty(u,"location",{enumerable:!0,get:()=>t.location.value}),Object.defineProperty(u,"state",{enumerable:!0,get:()=>t.state.value}),u}function RB(e){return typeof e=="string"||e&&typeof e=="object"}function PT(e){return typeof e=="string"||typeof e=="symbol"}const co={path:"/",name:void 0,params:{},query:{},hash:"",fullPath:"/",matched:[],meta:{},redirectedFrom:void 0},RT=Symbol("");var T1;(function(e){e[e.aborted=4]="aborted",e[e.cancelled=8]="cancelled",e[e.duplicated=16]="duplicated"})(T1||(T1={}));function Vc(e,t){return jn(new Error,{type:e,[RT]:!0},t)}function Ia(e,t){return e instanceof Error&&RT in e&&(t==null||!!(e.type&t))}const C1="[^/]+?",MB={sensitive:!1,strict:!1,start:!0,end:!0},DB=/[.+*?^${}()[\]/\\]/g;function LB(e,t){const i=jn({},MB,t),a=[];let u=i.start?"^":"";const d=[];for(const w of e){const C=w.length?[]:[90];i.strict&&!w.length&&(u+="/");for(let I=0;I<w.length;I++){const M=w[I];let O=40+(i.sensitive?.25:0);if(M.type===0)I||(u+="/"),u+=M.value.replace(DB,"\\$&"),O+=40;else if(M.type===1){const{value:j,repeatable:Z,optional:ue,regexp:ce}=M;d.push({name:j,repeatable:Z,optional:ue});const ve=ce||C1;if(ve!==C1){O+=10;try{new RegExp(`(${ve})`)}catch(Ae){throw new Error(`Invalid custom RegExp for param "${j}" (${ve}): `+Ae.message)}}let ye=Z?`((?:${ve})(?:/(?:${ve}))*)`:`(${ve})`;I||(ye=ue&&w.length<2?`(?:/${ye})`:"/"+ye),ue&&(ye+="?"),u+=ye,O+=20,ue&&(O+=-8),Z&&(O+=-20),ve===".*"&&(O+=-50)}C.push(O)}a.push(C)}if(i.strict&&i.end){const w=a.length-1;a[w][a[w].length-1]+=.7000000000000001}i.strict||(u+="/?"),i.end?u+="$":i.strict&&(u+="(?:/|$)");const p=new RegExp(u,i.sensitive?"":"i");function l(w){const C=w.match(p),I={};if(!C)return null;for(let M=1;M<C.length;M++){const O=C[M]||"",j=d[M-1];I[j.name]=O&&j.repeatable?O.split("/"):O}return I}function b(w){let C="",I=!1;for(const M of e){(!I||!C.endsWith("/"))&&(C+="/"),I=!1;for(const O of M)if(O.type===0)C+=O.value;else if(O.type===1){const{value:j,repeatable:Z,optional:ue}=O,ce=j in w?w[j]:"";if(Gs(ce)&&!Z)throw new Error(`Provided param "${j}" is an array but it is not repeatable (* or + modifiers)`);const ve=Gs(ce)?ce.join("/"):ce;if(!ve)if(ue)M.length<2&&(C.endsWith("/")?C=C.slice(0,-1):I=!0);else throw new Error(`Missing required param "${j}"`);C+=ve}}return C||"/"}return{re:p,score:a,keys:d,parse:l,stringify:b}}function zB(e,t){let i=0;for(;i<e.length&&i<t.length;){const a=t[i]-e[i];if(a)return a;i++}return e.length<t.length?e.length===1&&e[0]===40+40?-1:1:e.length>t.length?t.length===1&&t[0]===40+40?1:-1:0}function OB(e,t){let i=0;const a=e.score,u=t.score;for(;i<a.length&&i<u.length;){const d=zB(a[i],u[i]);if(d)return d;i++}if(Math.abs(u.length-a.length)===1){if(I1(a))return 1;if(I1(u))return-1}return u.length-a.length}function I1(e){const t=e[e.length-1];return e.length>0&&t[t.length-1]<0}const BB={type:0,value:""},FB=/[a-zA-Z0-9_]/;function NB(e){if(!e)return[[]];if(e==="/")return[[BB]];if(!e.startsWith("/"))throw new Error(`Invalid path "${e}"`);function t(O){throw new Error(`ERR (${i})/"${w}": ${O}`)}let i=0,a=i;const u=[];let d;function p(){d&&u.push(d),d=[]}let l=0,b,w="",C="";function I(){w&&(i===0?d.push({type:0,value:w}):i===1||i===2||i===3?(d.length>1&&(b==="*"||b==="+")&&t(`A repeatable param (${w}) must be alone in its segment. eg: '/:ids+.`),d.push({type:1,value:w,regexp:C,repeatable:b==="*"||b==="+",optional:b==="*"||b==="?"})):t("Invalid state to consume buffer"),w="")}function M(){w+=b}for(;l<e.length;){if(b=e[l++],b==="\\"&&i!==2){a=i,i=4;continue}switch(i){case 0:b==="/"?(w&&I(),p()):b===":"?(I(),i=1):M();break;case 4:M(),i=a;break;case 1:b==="("?i=2:FB.test(b)?M():(I(),i=0,b!=="*"&&b!=="?"&&b!=="+"&&l--);break;case 2:b===")"?C[C.length-1]=="\\"?C=C.slice(0,-1)+b:i=3:C+=b;break;case 3:I(),i=0,b!=="*"&&b!=="?"&&b!=="+"&&l--,C="";break;default:t("Unknown state");break}}return i===2&&t(`Unfinished custom RegExp for param "${w}"`),I(),p(),u}function UB(e,t,i){const a=LB(NB(e.path),i),u=jn(a,{record:e,parent:t,children:[],alias:[]});return t&&!u.record.aliasOf==!t.record.aliasOf&&t.children.push(u),u}function $B(e,t){const i=[],a=new Map;t=P1({strict:!1,end:!0,sensitive:!1},t);function u(C){return a.get(C)}function d(C,I,M){const O=!M,j=VB(C);j.aliasOf=M&&M.record;const Z=P1(t,C),ue=[j];if("alias"in C){const ye=typeof C.alias=="string"?[C.alias]:C.alias;for(const Ae of ye)ue.push(jn({},j,{components:M?M.record.components:j.components,path:Ae,aliasOf:M?M.record:j}))}let ce,ve;for(const ye of ue){const{path:Ae}=ye;if(I&&Ae[0]!=="/"){const Be=I.record.path,Le=Be[Be.length-1]==="/"?"":"/";ye.path=I.record.path+(Ae&&Le+Ae)}if(ce=UB(ye,I,Z),M?M.alias.push(ce):(ve=ve||ce,ve!==ce&&ve.alias.push(ce),O&&C.name&&!A1(ce)&&p(C.name)),j.children){const Be=j.children;for(let Le=0;Le<Be.length;Le++)d(Be[Le],ce,M&&M.children[Le])}M=M||ce,(ce.record.components&&Object.keys(ce.record.components).length||ce.record.name||ce.record.redirect)&&b(ce)}return ve?()=>{p(ve)}:Dh}function p(C){if(PT(C)){const I=a.get(C);I&&(a.delete(C),i.splice(i.indexOf(I),1),I.children.forEach(p),I.alias.forEach(p))}else{const I=i.indexOf(C);I>-1&&(i.splice(I,1),C.record.name&&a.delete(C.record.name),C.children.forEach(p),C.alias.forEach(p))}}function l(){return i}function b(C){let I=0;for(;I<i.length&&OB(C,i[I])>=0&&(C.record.path!==i[I].record.path||!MT(C,i[I]));)I++;i.splice(I,0,C),C.record.name&&!A1(C)&&a.set(C.record.name,C)}function w(C,I){let M,O={},j,Z;if("name"in C&&C.name){if(M=a.get(C.name),!M)throw Vc(1,{location:C});Z=M.record.name,O=jn(k1(I.params,M.keys.filter(ve=>!ve.optional).map(ve=>ve.name)),C.params&&k1(C.params,M.keys.map(ve=>ve.name))),j=M.stringify(O)}else if("path"in C)j=C.path,M=i.find(ve=>ve.re.test(j)),M&&(O=M.parse(j),Z=M.record.name);else{if(M=I.name?a.get(I.name):i.find(ve=>ve.re.test(I.path)),!M)throw Vc(1,{location:C,currentLocation:I});Z=M.record.name,O=jn({},I.params,C.params),j=M.stringify(O)}const ue=[];let ce=M;for(;ce;)ue.unshift(ce.record),ce=ce.parent;return{name:Z,path:j,params:O,matched:ue,meta:GB(ue)}}return e.forEach(C=>d(C)),{addRoute:d,resolve:w,removeRoute:p,getRoutes:l,getRecordMatcher:u}}function k1(e,t){const i={};for(const a of t)a in e&&(i[a]=e[a]);return i}function VB(e){return{path:e.path,redirect:e.redirect,name:e.name,meta:e.meta||{},aliasOf:void 0,beforeEnter:e.beforeEnter,props:jB(e),children:e.children||[],instances:{},leaveGuards:new Set,updateGuards:new Set,enterCallbacks:{},components:"components"in e?e.components||null:e.component&&{default:e.component}}}function jB(e){const t={},i=e.props||!1;if("component"in e)t.default=i;else for(const a in e.components)t[a]=typeof i=="boolean"?i:i[a];return t}function A1(e){for(;e;){if(e.record.aliasOf)return!0;e=e.parent}return!1}function GB(e){return e.reduce((t,i)=>jn(t,i.meta),{})}function P1(e,t){const i={};for(const a in e)i[a]=a in t?t[a]:e[a];return i}function MT(e,t){return t.children.some(i=>i===e||MT(e,i))}const DT=/#/g,qB=/&/g,HB=/\//g,WB=/=/g,ZB=/\?/g,LT=/\+/g,YB=/%5B/g,XB=/%5D/g,zT=/%5E/g,KB=/%60/g,OT=/%7B/g,JB=/%7C/g,BT=/%7D/g,QB=/%20/g;function Fv(e){return encodeURI(""+e).replace(JB,"|").replace(YB,"[").replace(XB,"]")}function eF(e){return Fv(e).replace(OT,"{").replace(BT,"}").replace(zT,"^")}function ry(e){return Fv(e).replace(LT,"%2B").replace(QB,"+").replace(DT,"%23").replace(qB,"%26").replace(KB,"`").replace(OT,"{").replace(BT,"}").replace(zT,"^")}function tF(e){return ry(e).replace(WB,"%3D")}function nF(e){return Fv(e).replace(DT,"%23").replace(ZB,"%3F")}function iF(e){return e==null?"":nF(e).replace(HB,"%2F")}function Bp(e){try{return decodeURIComponent(""+e)}catch{}return""+e}function rF(e){const t={};if(e===""||e==="?")return t;const a=(e[0]==="?"?e.slice(1):e).split("&");for(let u=0;u<a.length;++u){const d=a[u].replace(LT," "),p=d.indexOf("="),l=Bp(p<0?d:d.slice(0,p)),b=p<0?null:Bp(d.slice(p+1));if(l in t){let w=t[l];Gs(w)||(w=t[l]=[w]),w.push(b)}else t[l]=b}return t}function R1(e){let t="";for(let i in e){const a=e[i];if(i=tF(i),a==null){a!==void 0&&(t+=(t.length?"&":"")+i);continue}(Gs(a)?a.map(d=>d&&ry(d)):[a&&ry(a)]).forEach(d=>{d!==void 0&&(t+=(t.length?"&":"")+i,d!=null&&(t+="="+d))})}return t}function sF(e){const t={};for(const i in e){const a=e[i];a!==void 0&&(t[i]=Gs(a)?a.map(u=>u==null?null:""+u):a==null?a:""+a)}return t}const aF=Symbol(""),M1=Symbol(""),Nv=Symbol(""),FT=Symbol(""),sy=Symbol("");function bh(){let e=[];function t(a){return e.push(a),()=>{const u=e.indexOf(a);u>-1&&e.splice(u,1)}}function i(){e=[]}return{add:t,list:()=>e,reset:i}}function po(e,t,i,a,u){const d=a&&(a.enterCallbacks[u]=a.enterCallbacks[u]||[]);return()=>new Promise((p,l)=>{const b=I=>{I===!1?l(Vc(4,{from:i,to:t})):I instanceof Error?l(I):RB(I)?l(Vc(2,{from:t,to:I})):(d&&a.enterCallbacks[u]===d&&typeof I=="function"&&d.push(I),p())},w=e.call(a&&a.instances[u],t,i,b);let C=Promise.resolve(w);e.length<3&&(C=C.then(b)),C.catch(I=>l(I))})}function c_(e,t,i,a){const u=[];for(const d of e)for(const p in d.components){let l=d.components[p];if(!(t!=="beforeRouteEnter"&&!d.instances[p]))if(oF(l)){const w=(l.__vccOpts||l)[t];w&&u.push(po(w,i,a,d,p))}else{let b=l();u.push(()=>b.then(w=>{if(!w)return Promise.reject(new Error(`Couldn't resolve component "${p}" at "${d.path}"`));const C=fB(w)?w.default:w;d.components[p]=C;const M=(C.__vccOpts||C)[t];return M&&po(M,i,a,d,p)()}))}}return u}function oF(e){return typeof e=="object"||"displayName"in e||"props"in e||"__vccOpts"in e}function D1(e){const t=Jn(Nv),i=Jn(FT),a=Ce(()=>t.resolve(ur(e.to))),u=Ce(()=>{const{matched:b}=a.value,{length:w}=b,C=b[w-1],I=i.matched;if(!C||!I.length)return-1;const M=I.findIndex($c.bind(null,C));if(M>-1)return M;const O=L1(b[w-2]);return w>1&&L1(C)===O&&I[I.length-1].path!==O?I.findIndex($c.bind(null,b[w-2])):M}),d=Ce(()=>u.value>-1&&hF(i.params,a.value.params)),p=Ce(()=>u.value>-1&&u.value===i.matched.length-1&&kT(i.params,a.value.params));function l(b={}){return uF(b)?t[ur(e.replace)?"replace":"push"](ur(e.to)).catch(Dh):Promise.resolve()}return{route:a,href:Ce(()=>a.value.href),isActive:d,isExactActive:p,navigate:l}}const lF=rm({name:"RouterLink",compatConfig:{MODE:3},props:{to:{type:[String,Object],required:!0},replace:Boolean,activeClass:String,exactActiveClass:String,custom:Boolean,ariaCurrentValue:{type:String,default:"page"}},useLink:D1,setup(e,{slots:t}){const i=Ki(D1(e)),{options:a}=Jn(Nv),u=Ce(()=>({[z1(e.activeClass,a.linkActiveClass,"router-link-active")]:i.isActive,[z1(e.exactActiveClass,a.linkExactActiveClass,"router-link-exact-active")]:i.isExactActive}));return()=>{const d=t.default&&t.default(i);return e.custom?d:Ro("a",{"aria-current":i.isExactActive?e.ariaCurrentValue:null,href:i.href,onClick:i.navigate,class:u.value},d)}}}),cF=lF;function uF(e){if(!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)&&!e.defaultPrevented&&!(e.button!==void 0&&e.button!==0)){if(e.currentTarget&&e.currentTarget.getAttribute){const t=e.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(t))return}return e.preventDefault&&e.preventDefault(),!0}}function hF(e,t){for(const i in t){const a=t[i],u=e[i];if(typeof a=="string"){if(a!==u)return!1}else if(!Gs(u)||u.length!==a.length||a.some((d,p)=>d!==u[p]))return!1}return!0}function L1(e){return e?e.aliasOf?e.aliasOf.path:e.path:""}const z1=(e,t,i)=>e??t??i,dF=rm({name:"RouterView",inheritAttrs:!1,props:{name:{type:String,default:"default"},route:Object},compatConfig:{MODE:3},setup(e,{attrs:t,slots:i}){const a=Jn(sy),u=Ce(()=>e.route||a.value),d=Jn(M1,0),p=Ce(()=>{let w=ur(d);const{matched:C}=u.value;let I;for(;(I=C[w])&&!I.components;)w++;return w}),l=Ce(()=>u.value.matched[p.value]);_r(M1,Ce(()=>p.value+1)),_r(aF,l),_r(sy,u);const b=Kt();return En(()=>[b.value,l.value,e.name],([w,C,I],[M,O,j])=>{C&&(C.instances[I]=w,O&&O!==C&&w&&w===M&&(C.leaveGuards.size||(C.leaveGuards=O.leaveGuards),C.updateGuards.size||(C.updateGuards=O.updateGuards))),w&&C&&(!O||!$c(C,O)||!M)&&(C.enterCallbacks[I]||[]).forEach(Z=>Z(w))},{flush:"post"}),()=>{const w=u.value,C=e.name,I=l.value,M=I&&I.components[C];if(!M)return O1(i.default,{Component:M,route:w});const O=I.props[C],j=O?O===!0?w.params:typeof O=="function"?O(w):O:null,ue=Ro(M,jn({},j,t,{onVnodeUnmounted:ce=>{ce.component.isUnmounted&&(I.instances[C]=null)},ref:b}));return O1(i.default,{Component:ue,route:w})||ue}}});function O1(e,t){if(!e)return null;const i=e(t);return i.length===1?i[0]:i}const fF=dF;function pF(e){const t=$B(e.routes,e),i=e.parseQuery||rF,a=e.stringifyQuery||R1,u=e.history,d=bh(),p=bh(),l=bh(),b=Sn(co);let w=co;Ic&&e.scrollBehavior&&"scrollRestoration"in history&&(history.scrollRestoration="manual");const C=o_.bind(null,Se=>""+Se),I=o_.bind(null,iF),M=o_.bind(null,Bp);function O(Se,Ye){let Oe,je;return PT(Se)?(Oe=t.getRecordMatcher(Se),je=Ye):je=Se,t.addRoute(je,Oe)}function j(Se){const Ye=t.getRecordMatcher(Se);Ye&&t.removeRoute(Ye)}function Z(){return t.getRoutes().map(Se=>Se.record)}function ue(Se){return!!t.getRecordMatcher(Se)}function ce(Se,Ye){if(Ye=jn({},Ye||b.value),typeof Se=="string"){const W=l_(i,Se,Ye.path),De=t.resolve({path:W.path},Ye),Ue=u.createHref(W.fullPath);return jn(W,De,{params:M(De.params),hash:Bp(W.hash),redirectedFrom:void 0,href:Ue})}let Oe;if("path"in Se)Oe=jn({},Se,{path:l_(i,Se.path,Ye.path).path});else{const W=jn({},Se.params);for(const De in W)W[De]==null&&delete W[De];Oe=jn({},Se,{params:I(W)}),Ye.params=I(Ye.params)}const je=t.resolve(Oe,Ye),ft=Se.hash||"";je.params=C(M(je.params));const Y=gB(a,jn({},Se,{hash:eF(ft),path:je.path})),ie=u.createHref(Y);return jn({fullPath:Y,hash:ft,query:a===R1?sF(Se.query):Se.query||{}},je,{redirectedFrom:void 0,href:ie})}function ve(Se){return typeof Se=="string"?l_(i,Se,b.value.path):jn({},Se)}function ye(Se,Ye){if(w!==Se)return Vc(8,{from:Ye,to:Se})}function Ae(Se){return Ie(Se)}function Be(Se){return Ae(jn(ve(Se),{replace:!0}))}function Le(Se){const Ye=Se.matched[Se.matched.length-1];if(Ye&&Ye.redirect){const{redirect:Oe}=Ye;let je=typeof Oe=="function"?Oe(Se):Oe;return typeof je=="string"&&(je=je.includes("?")||je.includes("#")?je=ve(je):{path:je},je.params={}),jn({query:Se.query,hash:Se.hash,params:"path"in je?{}:Se.params},je)}}function Ie(Se,Ye){const Oe=w=ce(Se),je=b.value,ft=Se.state,Y=Se.force,ie=Se.replace===!0,W=Le(Oe);if(W)return Ie(jn(ve(W),{state:typeof W=="object"?jn({},ft,W.state):ft,force:Y,replace:ie}),Ye||Oe);const De=Oe;De.redirectedFrom=Ye;let Ue;return!Y&&_B(a,je,Oe)&&(Ue=Vc(16,{to:De,from:je}),Ct(je,je,!0,!1)),(Ue?Promise.resolve(Ue):he(De,je)).catch(Ne=>Ia(Ne)?Ia(Ne,2)?Ne:kt(Ne):$e(Ne,De,je)).then(Ne=>{if(Ne){if(Ia(Ne,2))return Ie(jn({replace:ie},ve(Ne.to),{state:typeof Ne.to=="object"?jn({},ft,Ne.to.state):ft,force:Y}),Ye||De)}else Ne=we(De,je,!0,ie,ft);return xe(De,je,Ne),Ne})}function U(Se,Ye){const Oe=ye(Se,Ye);return Oe?Promise.reject(Oe):Promise.resolve()}function H(Se){const Ye=Vt.values().next().value;return Ye&&typeof Ye.runWithContext=="function"?Ye.runWithContext(Se):Se()}function he(Se,Ye){let Oe;const[je,ft,Y]=mF(Se,Ye);Oe=c_(je.reverse(),"beforeRouteLeave",Se,Ye);for(const W of je)W.leaveGuards.forEach(De=>{Oe.push(po(De,Se,Ye))});const ie=U.bind(null,Se,Ye);return Oe.push(ie),qe(Oe).then(()=>{Oe=[];for(const W of d.list())Oe.push(po(W,Se,Ye));return Oe.push(ie),qe(Oe)}).then(()=>{Oe=c_(ft,"beforeRouteUpdate",Se,Ye);for(const W of ft)W.updateGuards.forEach(De=>{Oe.push(po(De,Se,Ye))});return Oe.push(ie),qe(Oe)}).then(()=>{Oe=[];for(const W of Se.matched)if(W.beforeEnter&&!Ye.matched.includes(W))if(Gs(W.beforeEnter))for(const De of W.beforeEnter)Oe.push(po(De,Se,Ye));else Oe.push(po(W.beforeEnter,Se,Ye));return Oe.push(ie),qe(Oe)}).then(()=>(Se.matched.forEach(W=>W.enterCallbacks={}),Oe=c_(Y,"beforeRouteEnter",Se,Ye),Oe.push(ie),qe(Oe))).then(()=>{Oe=[];for(const W of p.list())Oe.push(po(W,Se,Ye));return Oe.push(ie),qe(Oe)}).catch(W=>Ia(W,8)?W:Promise.reject(W))}function xe(Se,Ye,Oe){for(const je of l.list())H(()=>je(Se,Ye,Oe))}function we(Se,Ye,Oe,je,ft){const Y=ye(Se,Ye);if(Y)return Y;const ie=Ye===co,W=Ic?history.state:{};Oe&&(je||ie?u.replace(Se.fullPath,jn({scroll:ie&&W&&W.scroll},ft)):u.push(Se.fullPath,ft)),b.value=Se,Ct(Se,Ye,Oe,ie),kt()}let oe;function ke(){oe||(oe=u.listen((Se,Ye,Oe)=>{if(!Lt.listening)return;const je=ce(Se),ft=Le(je);if(ft){Ie(jn(ft,{replace:!0}),je).catch(Dh);return}w=je;const Y=b.value;Ic&&TB(S1(Y.fullPath,Oe.delta),vm()),he(je,Y).catch(ie=>Ia(ie,12)?ie:Ia(ie,2)?(Ie(ie.to,je).then(W=>{Ia(W,20)&&!Oe.delta&&Oe.type===rd.pop&&u.go(-1,!1)}).catch(Dh),Promise.reject()):(Oe.delta&&u.go(-Oe.delta,!1),$e(ie,je,Y))).then(ie=>{ie=ie||we(je,Y,!1),ie&&(Oe.delta&&!Ia(ie,8)?u.go(-Oe.delta,!1):Oe.type===rd.pop&&Ia(ie,20)&&u.go(-1,!1)),xe(je,Y,ie)}).catch(Dh)}))}let tt=bh(),et=bh(),Ve;function $e(Se,Ye,Oe){kt(Se);const je=et.list();return je.length?je.forEach(ft=>ft(Se,Ye,Oe)):console.error(Se),Promise.reject(Se)}function He(){return Ve&&b.value!==co?Promise.resolve():new Promise((Se,Ye)=>{tt.add([Se,Ye])})}function kt(Se){return Ve||(Ve=!Se,ke(),tt.list().forEach(([Ye,Oe])=>Se?Oe(Se):Ye()),tt.reset()),Se}function Ct(Se,Ye,Oe,je){const{scrollBehavior:ft}=e;if(!Ic||!ft)return Promise.resolve();const Y=!Oe&&CB(S1(Se.fullPath,0))||(je||!Oe)&&history.state&&history.state.scroll||null;return yr().then(()=>ft(Se,Ye,Y)).then(ie=>ie&&EB(ie)).catch(ie=>$e(ie,Se,Ye))}const rt=Se=>u.go(Se);let It;const Vt=new Set,Lt={currentRoute:b,listening:!0,addRoute:O,removeRoute:j,hasRoute:ue,getRoutes:Z,resolve:ce,options:e,push:Ae,replace:Be,go:rt,back:()=>rt(-1),forward:()=>rt(1),beforeEach:d.add,beforeResolve:p.add,afterEach:l.add,onError:et.add,isReady:He,install(Se){const Ye=this;Se.component("RouterLink",cF),Se.component("RouterView",fF),Se.config.globalProperties.$router=Ye,Object.defineProperty(Se.config.globalProperties,"$route",{enumerable:!0,get:()=>ur(b)}),Ic&&!It&&b.value===co&&(It=!0,Ae(u.location).catch(ft=>{}));const Oe={};for(const ft in co)Oe[ft]=Ce(()=>b.value[ft]);Se.provide(Nv,Ye),Se.provide(FT,Ki(Oe)),Se.provide(sy,b);const je=Se.unmount;Vt.add(Se),Se.unmount=function(){Vt.delete(Se),Vt.size<1&&(w=co,oe&&oe(),oe=null,b.value=co,It=!1,Ve=!1),je()}}};function qe(Se){return Se.reduce((Ye,Oe)=>Ye.then(()=>H(Oe)),Promise.resolve())}return Lt}function mF(e,t){const i=[],a=[],u=[],d=Math.max(t.matched.length,e.matched.length);for(let p=0;p<d;p++){const l=t.matched[p];l&&(e.matched.find(w=>$c(w,l))?a.push(l):i.push(l));const b=e.matched[p];b&&(t.matched.find(w=>$c(w,b))||u.push(b))}return[i,a,u]}const NT=pF({history:PB("./"),routes:[]}),UT=Object.prototype.toString;function $T(e){switch(UT.call(e)){case"[object Error]":case"[object Exception]":case"[object DOMException]":return!0;default:return Fa(e,Error)}}function hu(e,t){return UT.call(e)===`[object ${t}]`}function Uv(e){return hu(e,"ErrorEvent")}function B1(e){return hu(e,"DOMError")}function gF(e){return hu(e,"DOMException")}function Io(e){return hu(e,"String")}function VT(e){return e===null||typeof e!="object"&&typeof e!="function"}function jc(e){return hu(e,"Object")}function xm(e){return typeof Event<"u"&&Fa(e,Event)}function _F(e){return typeof Element<"u"&&Fa(e,Element)}function yF(e){return hu(e,"RegExp")}function $v(e){return!!(e&&e.then&&typeof e.then=="function")}function vF(e){return jc(e)&&"nativeEvent"in e&&"preventDefault"in e&&"stopPropagation"in e}function jT(e){return typeof e=="number"&&e!==e}function Fa(e,t){try{return e instanceof t}catch{return!1}}function Bc(e,t=0){return typeof e!="string"||t===0||e.length<=t?e:`${e.slice(0,t)}...`}function F1(e,t){if(!Array.isArray(e))return"";const i=[];for(let a=0;a<e.length;a++){const u=e[a];try{i.push(String(u))}catch{i.push("[value cannot be serialized]")}}return i.join(t)}function xF(e,t,i=!1){return Io(e)?yF(t)?t.test(e):Io(t)?i?e===t:e.includes(t):!1:!1}function du(e,t=[],i=!1){return t.some(a=>xF(e,a,i))}function bF(e,t,i=250,a,u,d,p){if(!d.exception||!d.exception.values||!p||!Fa(p.originalException,Error))return;const l=d.exception.values.length>0?d.exception.values[d.exception.values.length-1]:void 0;l&&(d.exception.values=wF(ay(e,t,u,p.originalException,a,d.exception.values,l,0),i))}function ay(e,t,i,a,u,d,p,l){if(d.length>=i+1)return d;let b=[...d];if(Fa(a[u],Error)){N1(p,l);const w=e(t,a[u]),C=b.length;U1(w,u,C,l),b=ay(e,t,i,a[u],u,[w,...b],w,C)}return Array.isArray(a.errors)&&a.errors.forEach((w,C)=>{if(Fa(w,Error)){N1(p,l);const I=e(t,w),M=b.length;U1(I,`errors[${C}]`,M,l),b=ay(e,t,i,w,u,[I,...b],I,M)}}),b}function N1(e,t){e.mechanism=e.mechanism||{type:"generic",handled:!0},e.mechanism={...e.mechanism,is_exception_group:!0,exception_id:t}}function U1(e,t,i,a){e.mechanism=e.mechanism||{type:"generic",handled:!0},e.mechanism={...e.mechanism,type:"chained",source:t,exception_id:i,parent_id:a}}function wF(e,t){return e.map(i=>(i.value&&(i.value=Bc(i.value,t)),i))}function jf(e){return e&&e.Math==Math?e:void 0}const Mr=typeof globalThis=="object"&&jf(globalThis)||typeof window=="object"&&jf(window)||typeof self=="object"&&jf(self)||typeof global=="object"&&jf(global)||function(){return this}()||{};function bd(){return Mr}function Vv(e,t,i){const a=i||Mr,u=a.__SENTRY__=a.__SENTRY__||{};return u[e]||(u[e]=t())}const hp=bd(),SF=80;function ko(e,t={}){try{let i=e;const a=5,u=[];let d=0,p=0;const l=" > ",b=l.length;let w;const C=Array.isArray(t)?t:t.keyAttrs,I=!Array.isArray(t)&&t.maxStringLength||SF;for(;i&&d++<a&&(w=EF(i,C),!(w==="html"||d>1&&p+u.length*b+w.length>=I));)u.push(w),p+=w.length,i=i.parentNode;return u.reverse().join(l)}catch{return"<unknown>"}}function EF(e,t){const i=e,a=[];let u,d,p,l,b;if(!i||!i.tagName)return"";a.push(i.tagName.toLowerCase());const w=t&&t.length?t.filter(I=>i.getAttribute(I)).map(I=>[I,i.getAttribute(I)]):null;if(w&&w.length)w.forEach(I=>{a.push(`[${I[0]}="${I[1]}"]`)});else if(i.id&&a.push(`#${i.id}`),u=i.className,u&&Io(u))for(d=u.split(/\s+/),b=0;b<d.length;b++)a.push(`.${d[b]}`);const C=["aria-label","type","name","title","alt"];for(b=0;b<C.length;b++)p=C[b],l=i.getAttribute(p),l&&a.push(`[${p}="${l}"]`);return a.join("")}function TF(){try{return hp.document.location.href}catch{return""}}function CF(e){return hp.document&&hp.document.querySelector?hp.document.querySelector(e):null}const IF="Sentry Logger ",Fp=["debug","info","warn","error","log","assert","trace"];function GT(e){if(!("console"in Mr))return e();const t=Mr.console,i={};Fp.forEach(a=>{const u=t[a]&&t[a].__sentry_original__;a in t&&u&&(i[a]=t[a],t[a]=u)});try{return e()}finally{Object.keys(i).forEach(a=>{t[a]=i[a]})}}function $1(){let e=!1;const t={enable:()=>{e=!0},disable:()=>{e=!1}};return typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__?Fp.forEach(i=>{t[i]=(...a)=>{e&&GT(()=>{Mr.console[i](`${IF}[${i}]:`,...a)})}}):Fp.forEach(i=>{t[i]=()=>{}}),t}let st;typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__?st=Vv("logger",$1):st=$1();const kF=/^(?:(\w+):)\/\/(?:(\w+)(?::(\w+)?)?@)([\w.-]+)(?::(\d+))?\/(.+)/;function AF(e){return e==="http"||e==="https"}function bm(e,t=!1){const{host:i,path:a,pass:u,port:d,projectId:p,protocol:l,publicKey:b}=e;return`${l}://${b}${t&&u?`:${u}`:""}@${i}${d?`:${d}`:""}/${a&&`${a}/`}${p}`}function PF(e){const t=kF.exec(e);if(!t){console.error(`Invalid Sentry Dsn: ${e}`);return}const[i,a,u="",d,p="",l]=t.slice(1);let b="",w=l;const C=w.split("/");if(C.length>1&&(b=C.slice(0,-1).join("/"),w=C.pop()),w){const I=w.match(/^\d+/);I&&(w=I[0])}return qT({host:d,pass:u,path:b,projectId:w,port:p,protocol:i,publicKey:a})}function qT(e){return{protocol:e.protocol,publicKey:e.publicKey||"",pass:e.pass||"",host:e.host,port:e.port||"",path:e.path||"",projectId:e.projectId}}function RF(e){if(!(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__))return!0;const{port:t,projectId:i,protocol:a}=e;return["protocol","publicKey","host","projectId"].find(p=>e[p]?!1:(st.error(`Invalid Sentry Dsn: ${p} missing`),!0))?!1:i.match(/^\d+$/)?AF(a)?t&&isNaN(parseInt(t,10))?(st.error(`Invalid Sentry Dsn: Invalid port ${t}`),!1):!0:(st.error(`Invalid Sentry Dsn: Invalid protocol ${a}`),!1):(st.error(`Invalid Sentry Dsn: Invalid projectId ${i}`),!1)}function MF(e){const t=typeof e=="string"?PF(e):qT(e);if(!(!t||!RF(t)))return t}class Fs extends Error{constructor(t,i="warn"){super(t),this.message=t,this.name=new.target.prototype.constructor.name,Object.setPrototypeOf(this,new.target.prototype),this.logLevel=i}}function Ji(e,t,i){if(!(t in e))return;const a=e[t],u=i(a);if(typeof u=="function")try{HT(u,a)}catch{}e[t]=u}function jv(e,t,i){Object.defineProperty(e,t,{value:i,writable:!0,configurable:!0})}function HT(e,t){const i=t.prototype||{};e.prototype=t.prototype=i,jv(e,"__sentry_original__",t)}function Gv(e){return e.__sentry_original__}function DF(e){return Object.keys(e).map(t=>`${encodeURIComponent(t)}=${encodeURIComponent(e[t])}`).join("&")}function WT(e){if($T(e))return{message:e.message,name:e.name,stack:e.stack,...j1(e)};if(xm(e)){const t={type:e.type,target:V1(e.target),currentTarget:V1(e.currentTarget),...j1(e)};return typeof CustomEvent<"u"&&Fa(e,CustomEvent)&&(t.detail=e.detail),t}else return e}function V1(e){try{return _F(e)?ko(e):Object.prototype.toString.call(e)}catch{return"<unknown>"}}function j1(e){if(typeof e=="object"&&e!==null){const t={};for(const i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}else return{}}function LF(e,t=40){const i=Object.keys(WT(e));if(i.sort(),!i.length)return"[object has no keys]";if(i[0].length>=t)return Bc(i[0],t);for(let a=i.length;a>0;a--){const u=i.slice(0,a).join(", ");if(!(u.length>t))return a===i.length?u:Bc(u,t)}return""}function da(e){return oy(e,new Map)}function oy(e,t){if(jc(e)){const i=t.get(e);if(i!==void 0)return i;const a={};t.set(e,a);for(const u of Object.keys(e))typeof e[u]<"u"&&(a[u]=oy(e[u],t));return a}if(Array.isArray(e)){const i=t.get(e);if(i!==void 0)return i;const a=[];return t.set(e,a),e.forEach(u=>{a.push(oy(u,t))}),a}return e}const ZT=50,G1=/\(error: (.*)\)/,q1=/captureMessage|captureException/;function YT(...e){const t=e.sort((i,a)=>i[0]-a[0]).map(i=>i[1]);return(i,a=0)=>{const u=[],d=i.split(`
`);for(let p=a;p<d.length;p++){const l=d[p];if(l.length>1024)continue;const b=G1.test(l)?l.replace(G1,"$1"):l;if(!b.match(/\S*Error: /)){for(const w of t){const C=w(b);if(C){u.push(C);break}}if(u.length>=ZT)break}}return OF(u)}}function zF(e){return Array.isArray(e)?YT(...e):e}function OF(e){if(!e.length)return[];const t=Array.from(e);return/sentryWrapped/.test(t[t.length-1].function||"")&&t.pop(),t.reverse(),q1.test(t[t.length-1].function||"")&&(t.pop(),q1.test(t[t.length-1].function||"")&&t.pop()),t.slice(0,ZT).map(i=>({...i,filename:i.filename||t[t.length-1].filename,function:i.function||"?"}))}const u_="<anonymous>";function Ao(e){try{return!e||typeof e!="function"?u_:e.name||u_}catch{return u_}}const ly=bd();function XT(){if(!("fetch"in ly))return!1;try{return new Headers,new Request("http://www.example.com"),new Response,!0}catch{return!1}}function cy(e){return e&&/^function fetch\(\)\s+\{\s+\[native code\]\s+\}$/.test(e.toString())}function BF(){if(!XT())return!1;if(cy(ly.fetch))return!0;let e=!1;const t=ly.document;if(t&&typeof t.createElement=="function")try{const i=t.createElement("iframe");i.hidden=!0,t.head.appendChild(i),i.contentWindow&&i.contentWindow.fetch&&(e=cy(i.contentWindow.fetch)),t.head.removeChild(i)}catch(i){(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&st.warn("Could not create sandbox iframe for pure fetch check, bailing to window.fetch: ",i)}return e}const Gf=bd();function FF(){const e=Gf.chrome,t=e&&e.app&&e.app.runtime,i="history"in Gf&&!!Gf.history.pushState&&!!Gf.history.replaceState;return!t&&i}const li=bd(),vo="__sentry_xhr_v2__",zh={},H1={};function NF(e){if(!H1[e])switch(H1[e]=!0,e){case"console":UF();break;case"dom":ZF();break;case"xhr":jF();break;case"fetch":$F();break;case"history":GF();break;case"error":YF();break;case"unhandledrejection":XF();break;default:(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&st.warn("unknown instrumentation type:",e);return}}function cr(e,t){zh[e]=zh[e]||[],zh[e].push(t),NF(e)}function js(e,t){if(!(!e||!zh[e]))for(const i of zh[e]||[])try{i(t)}catch(a){(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&st.error(`Error while triggering instrumentation handler.
Type: ${e}
Name: ${Ao(i)}
Error:`,a)}}function UF(){"console"in li&&Fp.forEach(function(e){e in li.console&&Ji(li.console,e,function(t){return function(...i){js("console",{args:i,level:e}),t&&t.apply(li.console,i)}})})}function $F(){BF()&&Ji(li,"fetch",function(e){return function(...t){const{method:i,url:a}=VF(t),u={args:t,fetchData:{method:i,url:a},startTimestamp:Date.now()};return js("fetch",{...u}),e.apply(li,t).then(d=>(js("fetch",{...u,endTimestamp:Date.now(),response:d}),d),d=>{throw js("fetch",{...u,endTimestamp:Date.now(),error:d}),d})}})}function uy(e,t){return!!e&&typeof e=="object"&&!!e[t]}function W1(e){return typeof e=="string"?e:e?uy(e,"url")?e.url:e.toString?e.toString():"":""}function VF(e){if(e.length===0)return{method:"GET",url:""};if(e.length===2){const[i,a]=e;return{url:W1(i),method:uy(a,"method")?String(a.method).toUpperCase():"GET"}}const t=e[0];return{url:W1(t),method:uy(t,"method")?String(t.method).toUpperCase():"GET"}}function jF(){if(!("XMLHttpRequest"in li))return;const e=XMLHttpRequest.prototype;Ji(e,"open",function(t){return function(...i){const a=i[1],u=this[vo]={method:Io(i[0])?i[0].toUpperCase():i[0],url:i[1],request_headers:{}};Io(a)&&u.method==="POST"&&a.match(/sentry_key/)&&(this.__sentry_own_request__=!0);const d=()=>{const p=this[vo];if(p&&this.readyState===4){try{p.status_code=this.status}catch{}js("xhr",{args:i,endTimestamp:Date.now(),startTimestamp:Date.now(),xhr:this})}};return"onreadystatechange"in this&&typeof this.onreadystatechange=="function"?Ji(this,"onreadystatechange",function(p){return function(...l){return d(),p.apply(this,l)}}):this.addEventListener("readystatechange",d),Ji(this,"setRequestHeader",function(p){return function(...l){const[b,w]=l,C=this[vo];return C&&(C.request_headers[b.toLowerCase()]=w),p.apply(this,l)}}),t.apply(this,i)}}),Ji(e,"send",function(t){return function(...i){const a=this[vo];return a&&i[0]!==void 0&&(a.body=i[0]),js("xhr",{args:i,startTimestamp:Date.now(),xhr:this}),t.apply(this,i)}})}let qf;function GF(){if(!FF())return;const e=li.onpopstate;li.onpopstate=function(...i){const a=li.location.href,u=qf;if(qf=a,js("history",{from:u,to:a}),e)try{return e.apply(this,i)}catch{}};function t(i){return function(...a){const u=a.length>2?a[2]:void 0;if(u){const d=qf,p=String(u);qf=p,js("history",{from:d,to:p})}return i.apply(this,a)}}Ji(li.history,"pushState",t),Ji(li.history,"replaceState",t)}const qF=1e3;let Hf,Wf;function HF(e,t){if(!e||e.type!==t.type)return!0;try{if(e.target!==t.target)return!0}catch{}return!1}function WF(e){if(e.type!=="keypress")return!1;try{const t=e.target;if(!t||!t.tagName)return!0;if(t.tagName==="INPUT"||t.tagName==="TEXTAREA"||t.isContentEditable)return!1}catch{}return!0}function Z1(e,t=!1){return i=>{if(!i||Wf===i||WF(i))return;const a=i.type==="keypress"?"input":i.type;Hf===void 0?(e({event:i,name:a,global:t}),Wf=i):HF(Wf,i)&&(e({event:i,name:a,global:t}),Wf=i),clearTimeout(Hf),Hf=li.setTimeout(()=>{Hf=void 0},qF)}}function ZF(){if(!("document"in li))return;const e=js.bind(null,"dom"),t=Z1(e,!0);li.document.addEventListener("click",t,!1),li.document.addEventListener("keypress",t,!1),["EventTarget","Node"].forEach(i=>{const a=li[i]&&li[i].prototype;!a||!a.hasOwnProperty||!a.hasOwnProperty("addEventListener")||(Ji(a,"addEventListener",function(u){return function(d,p,l){if(d==="click"||d=="keypress")try{const b=this,w=b.__sentry_instrumentation_handlers__=b.__sentry_instrumentation_handlers__||{},C=w[d]=w[d]||{refCount:0};if(!C.handler){const I=Z1(e);C.handler=I,u.call(this,d,I,l)}C.refCount++}catch{}return u.call(this,d,p,l)}}),Ji(a,"removeEventListener",function(u){return function(d,p,l){if(d==="click"||d=="keypress")try{const b=this,w=b.__sentry_instrumentation_handlers__||{},C=w[d];C&&(C.refCount--,C.refCount<=0&&(u.call(this,d,C.handler,l),C.handler=void 0,delete w[d]),Object.keys(w).length===0&&delete b.__sentry_instrumentation_handlers__)}catch{}return u.call(this,d,p,l)}}))})}let Zf=null;function YF(){Zf=li.onerror,li.onerror=function(e,t,i,a,u){return js("error",{column:a,error:u,line:i,msg:e,url:t}),Zf&&!Zf.__SENTRY_LOADER__?Zf.apply(this,arguments):!1},li.onerror.__SENTRY_INSTRUMENTED__=!0}let Yf=null;function XF(){Yf=li.onunhandledrejection,li.onunhandledrejection=function(e){return js("unhandledrejection",e),Yf&&!Yf.__SENTRY_LOADER__?Yf.apply(this,arguments):!0},li.onunhandledrejection.__SENTRY_INSTRUMENTED__=!0}function KF(){const e=typeof WeakSet=="function",t=e?new WeakSet:[];function i(u){if(e)return t.has(u)?!0:(t.add(u),!1);for(let d=0;d<t.length;d++)if(t[d]===u)return!0;return t.push(u),!1}function a(u){if(e)t.delete(u);else for(let d=0;d<t.length;d++)if(t[d]===u){t.splice(d,1);break}}return[i,a]}function Dr(){const e=Mr,t=e.crypto||e.msCrypto;if(t&&t.randomUUID)return t.randomUUID().replace(/-/g,"");const i=t&&t.getRandomValues?()=>t.getRandomValues(new Uint8Array(1))[0]:()=>Math.random()*16;return([1e7]+1e3+4e3+8e3+1e11).replace(/[018]/g,a=>(a^(i()&15)>>a/4).toString(16))}function KT(e){return e.exception&&e.exception.values?e.exception.values[0]:void 0}function _o(e){const{message:t,event_id:i}=e;if(t)return t;const a=KT(e);return a?a.type&&a.value?`${a.type}: ${a.value}`:a.type||a.value||i||"<unknown>":i||"<unknown>"}function hy(e,t,i){const a=e.exception=e.exception||{},u=a.values=a.values||[],d=u[0]=u[0]||{};d.value||(d.value=t||""),d.type||(d.type=i||"Error")}function sd(e,t){const i=KT(e);if(!i)return;const a={type:"generic",handled:!0},u=i.mechanism;if(i.mechanism={...a,...u,...t},t&&"data"in t){const d={...u&&u.data,...t.data};i.mechanism.data=d}}function Y1(e){if(e&&e.__sentry_captured__)return!0;try{jv(e,"__sentry_captured__",!0)}catch{}return!1}function qv(e){return Array.isArray(e)?e:[e]}function JF(){return typeof __SENTRY_BROWSER_BUNDLE__<"u"&&!!__SENTRY_BROWSER_BUNDLE__}function QF(){return"npm"}function JT(){return!JF()&&Object.prototype.toString.call(typeof process<"u"?process:0)==="[object process]"}function e5(e,t){return e.require(t)}function aa(e,t=100,i=1/0){try{return dy("",e,t,i)}catch(a){return{ERROR:`**non-serializable** (${a})`}}}function QT(e,t=3,i=100*1024){const a=aa(e,t);return r5(a)>i?QT(e,t-1,i):a}function dy(e,t,i=1/0,a=1/0,u=KF()){const[d,p]=u;if(t==null||["number","boolean","string"].includes(typeof t)&&!jT(t))return t;const l=t5(e,t);if(!l.startsWith("[object "))return l;if(t.__sentry_skip_normalization__)return t;const b=typeof t.__sentry_override_normalization_depth__=="number"?t.__sentry_override_normalization_depth__:i;if(b===0)return l.replace("object ","");if(d(t))return"[Circular ~]";const w=t;if(w&&typeof w.toJSON=="function")try{const O=w.toJSON();return dy("",O,b-1,a,u)}catch{}const C=Array.isArray(t)?[]:{};let I=0;const M=WT(t);for(const O in M){if(!Object.prototype.hasOwnProperty.call(M,O))continue;if(I>=a){C[O]="[MaxProperties ~]";break}const j=M[O];C[O]=dy(O,j,b-1,a,u),I++}return p(t),C}function t5(e,t){try{if(e==="domain"&&t&&typeof t=="object"&&t._events)return"[Domain]";if(e==="domainEmitter")return"[DomainEmitter]";if(typeof global<"u"&&t===global)return"[Global]";if(typeof window<"u"&&t===window)return"[Window]";if(typeof document<"u"&&t===document)return"[Document]";if(vF(t))return"[SyntheticEvent]";if(typeof t=="number"&&t!==t)return"[NaN]";if(typeof t=="function")return`[Function: ${Ao(t)}]`;if(typeof t=="symbol")return`[${String(t)}]`;if(typeof t=="bigint")return`[BigInt: ${String(t)}]`;const i=n5(t);return/^HTML(\w*)Element$/.test(i)?`[HTMLElement: ${i}]`:`[object ${i}]`}catch(i){return`**non-serializable** (${i})`}}function n5(e){const t=Object.getPrototypeOf(e);return t?t.constructor.name:"null prototype"}function i5(e){return~-encodeURI(e).split(/%..|./).length}function r5(e){return i5(JSON.stringify(e))}var Pa;(function(e){e[e.PENDING=0]="PENDING";const i=1;e[e.RESOLVED=i]="RESOLVED";const a=2;e[e.REJECTED=a]="REJECTED"})(Pa||(Pa={}));function xl(e){return new as(t=>{t(e)})}function Np(e){return new as((t,i)=>{i(e)})}class as{constructor(t){as.prototype.__init.call(this),as.prototype.__init2.call(this),as.prototype.__init3.call(this),as.prototype.__init4.call(this),this._state=Pa.PENDING,this._handlers=[];try{t(this._resolve,this._reject)}catch(i){this._reject(i)}}then(t,i){return new as((a,u)=>{this._handlers.push([!1,d=>{if(!t)a(d);else try{a(t(d))}catch(p){u(p)}},d=>{if(!i)u(d);else try{a(i(d))}catch(p){u(p)}}]),this._executeHandlers()})}catch(t){return this.then(i=>i,t)}finally(t){return new as((i,a)=>{let u,d;return this.then(p=>{d=!1,u=p,t&&t()},p=>{d=!0,u=p,t&&t()}).then(()=>{if(d){a(u);return}i(u)})})}__init(){this._resolve=t=>{this._setResult(Pa.RESOLVED,t)}}__init2(){this._reject=t=>{this._setResult(Pa.REJECTED,t)}}__init3(){this._setResult=(t,i)=>{if(this._state===Pa.PENDING){if($v(i)){i.then(this._resolve,this._reject);return}this._state=t,this._value=i,this._executeHandlers()}}}__init4(){this._executeHandlers=()=>{if(this._state===Pa.PENDING)return;const t=this._handlers.slice();this._handlers=[],t.forEach(i=>{i[0]||(this._state===Pa.RESOLVED&&i[1](this._value),this._state===Pa.REJECTED&&i[2](this._value),i[0]=!0)})}}}function s5(e){const t=[];function i(){return e===void 0||t.length<e}function a(p){return t.splice(t.indexOf(p),1)[0]}function u(p){if(!i())return Np(new Fs("Not adding Promise because buffer limit was reached."));const l=p();return t.indexOf(l)===-1&&t.push(l),l.then(()=>a(l)).then(null,()=>a(l).then(null,()=>{})),l}function d(p){return new as((l,b)=>{let w=t.length;if(!w)return l(!0);const C=setTimeout(()=>{p&&p>0&&l(!1)},p);t.forEach(I=>{xl(I).then(()=>{--w||(clearTimeout(C),l(!0))},b)})})}return{$:t,add:u,drain:d}}function h_(e){if(!e)return{};const t=e.match(/^(([^:/?#]+):)?(\/\/([^/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?$/);if(!t)return{};const i=t[6]||"",a=t[8]||"";return{host:t[4],path:t[5],protocol:t[2],search:i,hash:a,relative:t[5]+i+a}}const a5=["fatal","error","warning","log","info","debug"];function o5(e){return e==="warn"?"warning":a5.includes(e)?e:"log"}const e2=bd(),fy={nowSeconds:()=>Date.now()/1e3};function l5(){const{performance:e}=e2;if(!e||!e.now)return;const t=Date.now()-e.now();return{now:()=>e.now(),timeOrigin:t}}function c5(){try{return e5(cC,"perf_hooks").performance}catch{return}}const d_=JT()?c5():l5(),X1=d_===void 0?fy:{nowSeconds:()=>(d_.timeOrigin+d_.now())/1e3},wm=fy.nowSeconds.bind(fy),Po=X1.nowSeconds.bind(X1),qs=(()=>{const{performance:e}=e2;if(!e||!e.now)return;const t=3600*1e3,i=e.now(),a=Date.now(),u=e.timeOrigin?Math.abs(e.timeOrigin+i-a):t,d=u<t,p=e.timing&&e.timing.navigationStart,b=typeof p=="number"?Math.abs(p+i-a):t,w=b<t;return d||w?u<=b?e.timeOrigin:p:a})(),py="baggage",t2="sentry-",u5=/^sentry-/,h5=8192;function d5(e){if(!Io(e)&&!Array.isArray(e))return;let t={};if(Array.isArray(e))t=e.reduce((a,u)=>{const d=K1(u);return{...a,...d}},{});else{if(!e)return;t=K1(e)}const i=Object.entries(t).reduce((a,[u,d])=>{if(u.match(u5)){const p=u.slice(t2.length);a[p]=d}return a},{});if(Object.keys(i).length>0)return i}function my(e){if(!e)return;const t=Object.entries(e).reduce((i,[a,u])=>(u&&(i[`${t2}${a}`]=u),i),{});return f5(t)}function K1(e){return e.split(",").map(t=>t.split("=").map(i=>decodeURIComponent(i.trim()))).reduce((t,[i,a])=>(t[i]=a,t),{})}function f5(e){if(Object.keys(e).length!==0)return Object.entries(e).reduce((t,[i,a],u)=>{const d=`${encodeURIComponent(i)}=${encodeURIComponent(a)}`,p=u===0?d:`${t},${d}`;return p.length>h5?((typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&st.warn(`Not adding key: ${i} with val: ${a} to baggage header due to exceeding baggage size limits.`),t):p},"")}const p5=new RegExp("^[ \\t]*([0-9a-f]{32})?-?([0-9a-f]{16})?-?([01])?[ \\t]*$");function m5(e){if(!e)return;const t=e.match(p5);if(!t)return;let i;return t[3]==="1"?i=!0:t[3]==="0"&&(i=!1),{traceId:t[1],parentSampled:i,parentSpanId:t[2]}}function g5(e,t){const i=m5(e),a=d5(t),{traceId:u,parentSpanId:d,parentSampled:p}=i||{},l={traceId:u||Dr(),spanId:Dr().substring(16),sampled:p===void 0?!1:p};return d&&(l.parentSpanId=d),a&&(l.dsc=a),{traceparentData:i,dynamicSamplingContext:a,propagationContext:l}}function Hv(e=Dr(),t=Dr().substring(16),i){let a="";return i!==void 0&&(a=i?"-1":"-0"),`${e}-${t}${a}`}function fu(e,t=[]){return[e,t]}function _5(e,t){const[i,a]=e;return[i,[...a,t]]}function J1(e,t){const i=e[1];for(const a of i){const u=a[0].type;if(t(a,u))return!0}return!1}function gy(e,t){return(t||new TextEncoder).encode(e)}function y5(e,t){const[i,a]=e;let u=JSON.stringify(i);function d(p){typeof u=="string"?u=typeof p=="string"?u+p:[gy(u,t),p]:u.push(typeof p=="string"?gy(p,t):p)}for(const p of a){const[l,b]=p;if(d(`
${JSON.stringify(l)}
`),typeof b=="string"||b instanceof Uint8Array)d(b);else{let w;try{w=JSON.stringify(b)}catch{w=JSON.stringify(aa(b))}d(w)}}return typeof u=="string"?u:v5(u)}function v5(e){const t=e.reduce((u,d)=>u+d.length,0),i=new Uint8Array(t);let a=0;for(const u of e)i.set(u,a),a+=u.length;return i}function x5(e,t){const i=typeof e.data=="string"?gy(e.data,t):e.data;return[da({type:"attachment",length:i.length,filename:e.filename,content_type:e.contentType,attachment_type:e.attachmentType}),i]}const b5={session:"session",sessions:"session",attachment:"attachment",transaction:"transaction",event:"error",client_report:"internal",user_report:"default",profile:"profile",replay_event:"replay",replay_recording:"replay",check_in:"monitor"};function Q1(e){return b5[e]}function Wv(e){if(!e||!e.sdk)return;const{name:t,version:i}=e.sdk;return{name:t,version:i}}function n2(e,t,i,a){const u=e.sdkProcessingMetadata&&e.sdkProcessingMetadata.dynamicSamplingContext;return{event_id:e.event_id,sent_at:new Date().toISOString(),...t&&{sdk:t},...!!i&&{dsn:bm(a)},...u&&{trace:da({...u})}}}function w5(e,t,i){const a=[{type:"client_report"},{timestamp:i||wm(),discarded_events:e}];return fu(t?{dsn:t}:{},[a])}const S5=60*1e3;function E5(e,t=Date.now()){const i=parseInt(`${e}`,10);if(!isNaN(i))return i*1e3;const a=Date.parse(`${e}`);return isNaN(a)?S5:a-t}function T5(e,t){return e[t]||e.all||0}function C5(e,t,i=Date.now()){return T5(e,t)>i}function I5(e,{statusCode:t,headers:i},a=Date.now()){const u={...e},d=i&&i["x-sentry-rate-limits"],p=i&&i["retry-after"];if(d)for(const l of d.trim().split(",")){const[b,w]=l.split(":",2),C=parseInt(b,10),I=(isNaN(C)?60:C)*1e3;if(!w)u.all=a+I;else for(const M of w.split(";"))u[M]=a+I}else p?u.all=a+E5(p,a):t===429&&(u.all=a+60*1e3);return u}const Zv="production";function k5(e){const t=Po(),i={sid:Dr(),init:!0,timestamp:t,started:t,duration:0,status:"ok",errors:0,ignoreDuration:!1,toJSON:()=>P5(i)};return e&&Gc(i,e),i}function Gc(e,t={}){if(t.user&&(!e.ipAddress&&t.user.ip_address&&(e.ipAddress=t.user.ip_address),!e.did&&!t.did&&(e.did=t.user.id||t.user.email||t.user.username)),e.timestamp=t.timestamp||Po(),t.ignoreDuration&&(e.ignoreDuration=t.ignoreDuration),t.sid&&(e.sid=t.sid.length===32?t.sid:Dr()),t.init!==void 0&&(e.init=t.init),!e.did&&t.did&&(e.did=`${t.did}`),typeof t.started=="number"&&(e.started=t.started),e.ignoreDuration)e.duration=void 0;else if(typeof t.duration=="number")e.duration=t.duration;else{const i=e.timestamp-e.started;e.duration=i>=0?i:0}t.release&&(e.release=t.release),t.environment&&(e.environment=t.environment),!e.ipAddress&&t.ipAddress&&(e.ipAddress=t.ipAddress),!e.userAgent&&t.userAgent&&(e.userAgent=t.userAgent),typeof t.errors=="number"&&(e.errors=t.errors),t.status&&(e.status=t.status)}function A5(e,t){let i={};t?i={status:t}:e.status==="ok"&&(i={status:"exited"}),Gc(e,i)}function P5(e){return da({sid:`${e.sid}`,init:e.init,started:new Date(e.started*1e3).toISOString(),timestamp:new Date(e.timestamp*1e3).toISOString(),status:e.status,errors:e.errors,did:typeof e.did=="number"||typeof e.did=="string"?`${e.did}`:void 0,duration:e.duration,attrs:{release:e.release,environment:e.environment,ip_address:e.ipAddress,user_agent:e.userAgent}})}const R5=100;class gl{constructor(){this._notifyingListeners=!1,this._scopeListeners=[],this._eventProcessors=[],this._breadcrumbs=[],this._attachments=[],this._user={},this._tags={},this._extra={},this._contexts={},this._sdkProcessingMetadata={},this._propagationContext=ew()}static clone(t){const i=new gl;return t&&(i._breadcrumbs=[...t._breadcrumbs],i._tags={...t._tags},i._extra={...t._extra},i._contexts={...t._contexts},i._user=t._user,i._level=t._level,i._span=t._span,i._session=t._session,i._transactionName=t._transactionName,i._fingerprint=t._fingerprint,i._eventProcessors=[...t._eventProcessors],i._requestSession=t._requestSession,i._attachments=[...t._attachments],i._sdkProcessingMetadata={...t._sdkProcessingMetadata},i._propagationContext={...t._propagationContext}),i}addScopeListener(t){this._scopeListeners.push(t)}addEventProcessor(t){return this._eventProcessors.push(t),this}setUser(t){return this._user=t||{},this._session&&Gc(this._session,{user:t}),this._notifyScopeListeners(),this}getUser(){return this._user}getRequestSession(){return this._requestSession}setRequestSession(t){return this._requestSession=t,this}setTags(t){return this._tags={...this._tags,...t},this._notifyScopeListeners(),this}setTag(t,i){return this._tags={...this._tags,[t]:i},this._notifyScopeListeners(),this}setExtras(t){return this._extra={...this._extra,...t},this._notifyScopeListeners(),this}setExtra(t,i){return this._extra={...this._extra,[t]:i},this._notifyScopeListeners(),this}setFingerprint(t){return this._fingerprint=t,this._notifyScopeListeners(),this}setLevel(t){return this._level=t,this._notifyScopeListeners(),this}setTransactionName(t){return this._transactionName=t,this._notifyScopeListeners(),this}setContext(t,i){return i===null?delete this._contexts[t]:this._contexts[t]=i,this._notifyScopeListeners(),this}setSpan(t){return this._span=t,this._notifyScopeListeners(),this}getSpan(){return this._span}getTransaction(){const t=this.getSpan();return t&&t.transaction}setSession(t){return t?this._session=t:delete this._session,this._notifyScopeListeners(),this}getSession(){return this._session}update(t){if(!t)return this;if(typeof t=="function"){const i=t(this);return i instanceof gl?i:this}return t instanceof gl?(this._tags={...this._tags,...t._tags},this._extra={...this._extra,...t._extra},this._contexts={...this._contexts,...t._contexts},t._user&&Object.keys(t._user).length&&(this._user=t._user),t._level&&(this._level=t._level),t._fingerprint&&(this._fingerprint=t._fingerprint),t._requestSession&&(this._requestSession=t._requestSession),t._propagationContext&&(this._propagationContext=t._propagationContext)):jc(t)&&(t=t,this._tags={...this._tags,...t.tags},this._extra={...this._extra,...t.extra},this._contexts={...this._contexts,...t.contexts},t.user&&(this._user=t.user),t.level&&(this._level=t.level),t.fingerprint&&(this._fingerprint=t.fingerprint),t.requestSession&&(this._requestSession=t.requestSession),t.propagationContext&&(this._propagationContext=t.propagationContext)),this}clear(){return this._breadcrumbs=[],this._tags={},this._extra={},this._user={},this._contexts={},this._level=void 0,this._transactionName=void 0,this._fingerprint=void 0,this._requestSession=void 0,this._span=void 0,this._session=void 0,this._notifyScopeListeners(),this._attachments=[],this._propagationContext=ew(),this}addBreadcrumb(t,i){const a=typeof i=="number"?i:R5;if(a<=0)return this;const u={timestamp:wm(),...t};return this._breadcrumbs=[...this._breadcrumbs,u].slice(-a),this._notifyScopeListeners(),this}getLastBreadcrumb(){return this._breadcrumbs[this._breadcrumbs.length-1]}clearBreadcrumbs(){return this._breadcrumbs=[],this._notifyScopeListeners(),this}addAttachment(t){return this._attachments.push(t),this}getAttachments(){return this._attachments}clearAttachments(){return this._attachments=[],this}applyToEvent(t,i={}){if(this._extra&&Object.keys(this._extra).length&&(t.extra={...this._extra,...t.extra}),this._tags&&Object.keys(this._tags).length&&(t.tags={...this._tags,...t.tags}),this._user&&Object.keys(this._user).length&&(t.user={...this._user,...t.user}),this._contexts&&Object.keys(this._contexts).length&&(t.contexts={...this._contexts,...t.contexts}),this._level&&(t.level=this._level),this._transactionName&&(t.transaction=this._transactionName),this._span){t.contexts={trace:this._span.getTraceContext(),...t.contexts};const a=this._span.transaction;if(a){t.sdkProcessingMetadata={dynamicSamplingContext:a.getDynamicSamplingContext(),...t.sdkProcessingMetadata};const u=a.name;u&&(t.tags={transaction:u,...t.tags})}}return this._applyFingerprint(t),t.breadcrumbs=[...t.breadcrumbs||[],...this._breadcrumbs],t.breadcrumbs=t.breadcrumbs.length>0?t.breadcrumbs:void 0,t.sdkProcessingMetadata={...t.sdkProcessingMetadata,...this._sdkProcessingMetadata,propagationContext:this._propagationContext},this._notifyEventProcessors([...i2(),...this._eventProcessors],t,i)}setSDKProcessingMetadata(t){return this._sdkProcessingMetadata={...this._sdkProcessingMetadata,...t},this}setPropagationContext(t){return this._propagationContext=t,this}getPropagationContext(){return this._propagationContext}_notifyEventProcessors(t,i,a,u=0){return new as((d,p)=>{const l=t[u];if(i===null||typeof l!="function")d(i);else{const b=l({...i},a);(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&l.id&&b===null&&st.log(`Event processor "${l.id}" dropped event`),$v(b)?b.then(w=>this._notifyEventProcessors(t,w,a,u+1).then(d)).then(null,p):this._notifyEventProcessors(t,b,a,u+1).then(d).then(null,p)}})}_notifyScopeListeners(){this._notifyingListeners||(this._notifyingListeners=!0,this._scopeListeners.forEach(t=>{t(this)}),this._notifyingListeners=!1)}_applyFingerprint(t){t.fingerprint=t.fingerprint?qv(t.fingerprint):[],this._fingerprint&&(t.fingerprint=t.fingerprint.concat(this._fingerprint)),t.fingerprint&&!t.fingerprint.length&&delete t.fingerprint}}function i2(){return Vv("globalEventProcessors",()=>[])}function Yv(e){i2().push(e)}function ew(){return{traceId:Dr(),spanId:Dr().substring(16),sampled:!1}}const r2=4,M5=100;class s2{constructor(t,i=new gl,a=r2){this._version=a,this._stack=[{scope:i}],t&&this.bindClient(t)}isOlderThan(t){return this._version<t}bindClient(t){const i=this.getStackTop();i.client=t,t&&t.setupIntegrations&&t.setupIntegrations()}pushScope(){const t=gl.clone(this.getScope());return this.getStack().push({client:this.getClient(),scope:t}),t}popScope(){return this.getStack().length<=1?!1:!!this.getStack().pop()}withScope(t){const i=this.pushScope();try{t(i)}finally{this.popScope()}}getClient(){return this.getStackTop().client}getScope(){return this.getStackTop().scope}getStack(){return this._stack}getStackTop(){return this._stack[this._stack.length-1]}captureException(t,i){const a=this._lastEventId=i&&i.event_id?i.event_id:Dr(),u=new Error("Sentry syntheticException");return this._withClient((d,p)=>{d.captureException(t,{originalException:t,syntheticException:u,...i,event_id:a},p)}),a}captureMessage(t,i,a){const u=this._lastEventId=a&&a.event_id?a.event_id:Dr(),d=new Error(t);return this._withClient((p,l)=>{p.captureMessage(t,i,{originalException:t,syntheticException:d,...a,event_id:u},l)}),u}captureEvent(t,i){const a=i&&i.event_id?i.event_id:Dr();return t.type||(this._lastEventId=a),this._withClient((u,d)=>{u.captureEvent(t,{...i,event_id:a},d)}),a}lastEventId(){return this._lastEventId}addBreadcrumb(t,i){const{scope:a,client:u}=this.getStackTop();if(!u)return;const{beforeBreadcrumb:d=null,maxBreadcrumbs:p=M5}=u.getOptions&&u.getOptions()||{};if(p<=0)return;const b={timestamp:wm(),...t},w=d?GT(()=>d(b,i)):b;w!==null&&(u.emit&&u.emit("beforeAddBreadcrumb",w,i),a.addBreadcrumb(w,p))}setUser(t){this.getScope().setUser(t)}setTags(t){this.getScope().setTags(t)}setExtras(t){this.getScope().setExtras(t)}setTag(t,i){this.getScope().setTag(t,i)}setExtra(t,i){this.getScope().setExtra(t,i)}setContext(t,i){this.getScope().setContext(t,i)}configureScope(t){const{scope:i,client:a}=this.getStackTop();a&&t(i)}run(t){const i=tw(this);try{t(this)}finally{tw(i)}}getIntegration(t){const i=this.getClient();if(!i)return null;try{return i.getIntegration(t)}catch{return(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&st.warn(`Cannot retrieve integration ${t.id} from the current Hub`),null}}startTransaction(t,i){const a=this._callExtensionMethod("startTransaction",t,i);return(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&!a&&console.warn(`Tracing extension 'startTransaction' has not been added. Call 'addTracingExtensions' before calling 'init':
Sentry.addTracingExtensions();
Sentry.init({...});
`),a}traceHeaders(){return this._callExtensionMethod("traceHeaders")}captureSession(t=!1){if(t)return this.endSession();this._sendSessionUpdate()}endSession(){const i=this.getStackTop().scope,a=i.getSession();a&&A5(a),this._sendSessionUpdate(),i.setSession()}startSession(t){const{scope:i,client:a}=this.getStackTop(),{release:u,environment:d=Zv}=a&&a.getOptions()||{},{userAgent:p}=Mr.navigator||{},l=k5({release:u,environment:d,user:i.getUser(),...p&&{userAgent:p},...t}),b=i.getSession&&i.getSession();return b&&b.status==="ok"&&Gc(b,{status:"exited"}),this.endSession(),i.setSession(l),l}shouldSendDefaultPii(){const t=this.getClient(),i=t&&t.getOptions();return!!(i&&i.sendDefaultPii)}_sendSessionUpdate(){const{scope:t,client:i}=this.getStackTop(),a=t.getSession();a&&i&&i.captureSession&&i.captureSession(a)}_withClient(t){const{scope:i,client:a}=this.getStackTop();a&&t(a,i)}_callExtensionMethod(t,...i){const u=wd().__SENTRY__;if(u&&u.extensions&&typeof u.extensions[t]=="function")return u.extensions[t].apply(this,i);(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&st.warn(`Extension method ${t} couldn't be found, doing nothing.`)}}function wd(){return Mr.__SENTRY__=Mr.__SENTRY__||{extensions:{},hub:void 0},Mr}function tw(e){const t=wd(),i=_y(t);return a2(t,e),i}function _n(){const e=wd();if(e.__SENTRY__&&e.__SENTRY__.acs){const t=e.__SENTRY__.acs.getCurrentHub();if(t)return t}return D5(e)}function D5(e=wd()){return(!L5(e)||_y(e).isOlderThan(r2))&&a2(e,new s2),_y(e)}function L5(e){return!!(e&&e.__SENTRY__&&e.__SENTRY__.hub)}function _y(e){return Vv("hub",()=>new s2,e)}function a2(e,t){if(!e)return!1;const i=e.__SENTRY__=e.__SENTRY__||{};return i.hub=t,!0}function Sm(e){if(typeof __SENTRY_TRACING__=="boolean"&&!__SENTRY_TRACING__)return!1;const t=_n().getClient(),i=e||t&&t.getOptions();return!!i&&(i.enableTracing||"tracesSampleRate"in i||"tracesSampler"in i)}function Sd(e){return(e||_n()).getScope().getTransaction()}let nw=!1;function z5(){nw||(nw=!0,cr("error",yy),cr("unhandledrejection",yy))}function yy(){const e=Sd();if(e){const t="internal_error";(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&st.log(`[Tracing] Transaction: ${t} -> Global error occured`),e.setStatus(t)}}yy.tag="sentry_tracingErrorCallback";class o2{constructor(t=1e3){this._maxlen=t,this.spans=[]}add(t){this.spans.length>this._maxlen?t.spanRecorder=void 0:this.spans.push(t)}}class Xv{constructor(t){if(this.traceId=Dr(),this.spanId=Dr().substring(16),this.startTimestamp=Po(),this.tags={},this.data={},this.instrumenter="sentry",!t)return this;t.traceId&&(this.traceId=t.traceId),t.spanId&&(this.spanId=t.spanId),t.parentSpanId&&(this.parentSpanId=t.parentSpanId),"sampled"in t&&(this.sampled=t.sampled),t.op&&(this.op=t.op),t.description&&(this.description=t.description),t.name&&(this.description=t.name),t.data&&(this.data=t.data),t.tags&&(this.tags=t.tags),t.status&&(this.status=t.status),t.startTimestamp&&(this.startTimestamp=t.startTimestamp),t.endTimestamp&&(this.endTimestamp=t.endTimestamp),t.instrumenter&&(this.instrumenter=t.instrumenter)}startChild(t){const i=new Xv({...t,parentSpanId:this.spanId,sampled:this.sampled,traceId:this.traceId});if(i.spanRecorder=this.spanRecorder,i.spanRecorder&&i.spanRecorder.add(i),i.transaction=this.transaction,(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&i.transaction){const a=t&&t.op||"< unknown op >",u=i.transaction.name||"< unknown name >",d=i.transaction.spanId,p=`[Tracing] Starting '${a}' span on transaction '${u}' (${d}).`;i.transaction.metadata.spanMetadata[i.spanId]={logMessage:p},st.log(p)}return i}setTag(t,i){return this.tags={...this.tags,[t]:i},this}setData(t,i){return this.data={...this.data,[t]:i},this}setStatus(t){return this.status=t,this}setHttpStatus(t){this.setTag("http.status_code",String(t)),this.setData("http.response.status_code",t);const i=O5(t);return i!=="unknown_error"&&this.setStatus(i),this}setName(t){this.description=t}isSuccess(){return this.status==="ok"}finish(t){if((typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&this.transaction&&this.transaction.spanId!==this.spanId){const{logMessage:i}=this.transaction.metadata.spanMetadata[this.spanId];i&&st.log(i.replace("Starting","Finishing"))}this.endTimestamp=typeof t=="number"?t:Po()}toTraceparent(){return Hv(this.traceId,this.spanId,this.sampled)}toContext(){return da({data:this.data,description:this.description,endTimestamp:this.endTimestamp,op:this.op,parentSpanId:this.parentSpanId,sampled:this.sampled,spanId:this.spanId,startTimestamp:this.startTimestamp,status:this.status,tags:this.tags,traceId:this.traceId})}updateWithContext(t){return this.data=t.data||{},this.description=t.description,this.endTimestamp=t.endTimestamp,this.op=t.op,this.parentSpanId=t.parentSpanId,this.sampled=t.sampled,this.spanId=t.spanId||this.spanId,this.startTimestamp=t.startTimestamp||this.startTimestamp,this.status=t.status,this.tags=t.tags||{},this.traceId=t.traceId||this.traceId,this}getTraceContext(){return da({data:Object.keys(this.data).length>0?this.data:void 0,description:this.description,op:this.op,parent_span_id:this.parentSpanId,span_id:this.spanId,status:this.status,tags:Object.keys(this.tags).length>0?this.tags:void 0,trace_id:this.traceId})}toJSON(){return da({data:Object.keys(this.data).length>0?this.data:void 0,description:this.description,op:this.op,parent_span_id:this.parentSpanId,span_id:this.spanId,start_timestamp:this.startTimestamp,status:this.status,tags:Object.keys(this.tags).length>0?this.tags:void 0,timestamp:this.endTimestamp,trace_id:this.traceId})}}function O5(e){if(e<400&&e>=100)return"ok";if(e>=400&&e<500)switch(e){case 401:return"unauthenticated";case 403:return"permission_denied";case 404:return"not_found";case 409:return"already_exists";case 413:return"failed_precondition";case 429:return"resource_exhausted";default:return"invalid_argument"}if(e>=500&&e<600)switch(e){case 501:return"unimplemented";case 503:return"unavailable";case 504:return"deadline_exceeded";default:return"internal_error"}return"unknown_error"}function Em(e,t,i){const a=t.getOptions(),{publicKey:u}=t.getDsn()||{},{segment:d}=i&&i.getUser()||{},p=da({environment:a.environment||Zv,release:a.release,user_segment:d,public_key:u,trace_id:e});return t.emit&&t.emit("createDsc",p),p}class l2 extends Xv{constructor(t,i){super(t),delete this.description,this._measurements={},this._contexts={},this._hub=i||_n(),this._name=t.name||"",this.metadata={source:"custom",...t.metadata,spanMetadata:{}},this._trimEnd=t.trimEnd,this.transaction=this;const a=this.metadata.dynamicSamplingContext;a&&(this._frozenDynamicSamplingContext={...a})}get name(){return this._name}set name(t){this.setName(t)}setName(t,i="custom"){this._name=t,this.metadata.source=i}initSpanRecorder(t=1e3){this.spanRecorder||(this.spanRecorder=new o2(t)),this.spanRecorder.add(this)}setContext(t,i){i===null?delete this._contexts[t]:this._contexts[t]=i}setMeasurement(t,i,a=""){this._measurements[t]={value:i,unit:a}}setMetadata(t){this.metadata={...this.metadata,...t}}finish(t){if(this.endTimestamp!==void 0)return;this.name||((typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&st.warn("Transaction has no name, falling back to `<unlabeled transaction>`."),this.name="<unlabeled transaction>"),super.finish(t);const i=this._hub.getClient();if(i&&i.emit&&i.emit("finishTransaction",this),this.sampled!==!0){(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&st.log("[Tracing] Discarding transaction because its trace was not chosen to be sampled."),i&&i.recordDroppedEvent("sample_rate","transaction");return}const a=this.spanRecorder?this.spanRecorder.spans.filter(l=>l!==this&&l.endTimestamp):[];this._trimEnd&&a.length>0&&(this.endTimestamp=a.reduce((l,b)=>l.endTimestamp&&b.endTimestamp?l.endTimestamp>b.endTimestamp?l:b:l).endTimestamp);const u=this.metadata,d={contexts:{...this._contexts,trace:this.getTraceContext()},spans:a,start_timestamp:this.startTimestamp,tags:this.tags,timestamp:this.endTimestamp,transaction:this.name,type:"transaction",sdkProcessingMetadata:{...u,dynamicSamplingContext:this.getDynamicSamplingContext()},...u.source&&{transaction_info:{source:u.source}}};return Object.keys(this._measurements).length>0&&((typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&st.log("[Measurements] Adding measurements to transaction",JSON.stringify(this._measurements,void 0,2)),d.measurements=this._measurements),(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&st.log(`[Tracing] Finishing ${this.op} transaction: ${this.name}.`),this._hub.captureEvent(d)}toContext(){const t=super.toContext();return da({...t,name:this.name,trimEnd:this._trimEnd})}updateWithContext(t){return super.updateWithContext(t),this.name=t.name||"",this._trimEnd=t.trimEnd,this}getDynamicSamplingContext(){if(this._frozenDynamicSamplingContext)return this._frozenDynamicSamplingContext;const t=this._hub||_n(),i=t.getClient();if(!i)return{};const a=t.getScope(),u=Em(this.traceId,i,a),d=this.metadata.sampleRate;d!==void 0&&(u.sample_rate=`${d}`);const p=this.metadata.source;return p&&p!=="url"&&(u.transaction=this.name),this.sampled!==void 0&&(u.sampled=String(this.sampled)),u}setHub(t){this._hub=t}}const dp={idleTimeout:1e3,finalTimeout:3e4,heartbeatInterval:5e3},B5="finishReason",Ec=["heartbeatFailed","idleTimeout","documentHidden","finalTimeout","externalFinish","cancelled"];class F5 extends o2{constructor(t,i,a,u){super(u),this._pushActivity=t,this._popActivity=i,this.transactionSpanId=a}add(t){t.spanId!==this.transactionSpanId&&(t.finish=i=>{t.endTimestamp=typeof i=="number"?i:Po(),this._popActivity(t.spanId)},t.endTimestamp===void 0&&this._pushActivity(t.spanId)),super.add(t)}}class N5 extends l2{constructor(t,i,a=dp.idleTimeout,u=dp.finalTimeout,d=dp.heartbeatInterval,p=!1){super(t,i),this._idleHub=i,this._idleTimeout=a,this._finalTimeout=u,this._heartbeatInterval=d,this._onScope=p,this.activities={},this._heartbeatCounter=0,this._finished=!1,this._idleTimeoutCanceledPermanently=!1,this._beforeFinishCallbacks=[],this._finishReason=Ec[4],p&&((typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&st.log(`Setting idle transaction on scope. Span ID: ${this.spanId}`),i.configureScope(l=>l.setSpan(this))),this._restartIdleTimeout(),setTimeout(()=>{this._finished||(this.setStatus("deadline_exceeded"),this._finishReason=Ec[3],this.finish())},this._finalTimeout)}finish(t=Po()){if(this._finished=!0,this.activities={},this.op==="ui.action.click"&&this.setTag(B5,this._finishReason),this.spanRecorder){(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&st.log("[Tracing] finishing IdleTransaction",new Date(t*1e3).toISOString(),this.op);for(const i of this._beforeFinishCallbacks)i(this,t);this.spanRecorder.spans=this.spanRecorder.spans.filter(i=>{if(i.spanId===this.spanId)return!0;i.endTimestamp||(i.endTimestamp=t,i.setStatus("cancelled"),(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&st.log("[Tracing] cancelling span since transaction ended early",JSON.stringify(i,void 0,2)));const a=i.startTimestamp<t,u=(this._finalTimeout+this._idleTimeout)/1e3,d=i.endTimestamp-this.startTimestamp<u;if(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__){const p=JSON.stringify(i,void 0,2);a?d||st.log("[Tracing] discarding Span since it finished after Transaction final timeout",p):st.log("[Tracing] discarding Span since it happened after Transaction was finished",p)}return a&&d}),(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&st.log("[Tracing] flushing IdleTransaction")}else(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&st.log("[Tracing] No active IdleTransaction");if(this._onScope){const i=this._idleHub.getScope();i.getTransaction()===this&&i.setSpan(void 0)}return super.finish(t)}registerBeforeFinishCallback(t){this._beforeFinishCallbacks.push(t)}initSpanRecorder(t){if(!this.spanRecorder){const i=u=>{this._finished||this._pushActivity(u)},a=u=>{this._finished||this._popActivity(u)};this.spanRecorder=new F5(i,a,this.spanId,t),(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&st.log("Starting heartbeat"),this._pingHeartbeat()}this.spanRecorder.add(this)}cancelIdleTimeout(t,{restartOnChildSpanChange:i}={restartOnChildSpanChange:!0}){this._idleTimeoutCanceledPermanently=i===!1,this._idleTimeoutID&&(clearTimeout(this._idleTimeoutID),this._idleTimeoutID=void 0,Object.keys(this.activities).length===0&&this._idleTimeoutCanceledPermanently&&(this._finishReason=Ec[5],this.finish(t)))}setFinishReason(t){this._finishReason=t}_restartIdleTimeout(t){this.cancelIdleTimeout(),this._idleTimeoutID=setTimeout(()=>{!this._finished&&Object.keys(this.activities).length===0&&(this._finishReason=Ec[1],this.finish(t))},this._idleTimeout)}_pushActivity(t){this.cancelIdleTimeout(void 0,{restartOnChildSpanChange:!this._idleTimeoutCanceledPermanently}),(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&st.log(`[Tracing] pushActivity: ${t}`),this.activities[t]=!0,(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&st.log("[Tracing] new activities count",Object.keys(this.activities).length)}_popActivity(t){if(this.activities[t]&&((typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&st.log(`[Tracing] popActivity ${t}`),delete this.activities[t],(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&st.log("[Tracing] new activities count",Object.keys(this.activities).length)),Object.keys(this.activities).length===0){const i=Po();this._idleTimeoutCanceledPermanently?(this._finishReason=Ec[5],this.finish(i)):this._restartIdleTimeout(i+this._idleTimeout/1e3)}}_beat(){if(this._finished)return;const t=Object.keys(this.activities).join("");t===this._prevHeartbeatString?this._heartbeatCounter++:this._heartbeatCounter=1,this._prevHeartbeatString=t,this._heartbeatCounter>=3?((typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&st.log("[Tracing] Transaction finished because of no change for 3 heart beats"),this.setStatus("deadline_exceeded"),this._finishReason=Ec[0],this.finish()):this._pingHeartbeat()}_pingHeartbeat(){(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&st.log(`pinging Heartbeat -> current counter: ${this._heartbeatCounter}`),setTimeout(()=>{this._beat()},this._heartbeatInterval)}}function U5(){const t=this.getScope().getSpan();return t?{"sentry-trace":t.toTraceparent()}:{}}function c2(e,t,i){if(!Sm(t))return e.sampled=!1,e;if(e.sampled!==void 0)return e.setMetadata({sampleRate:Number(e.sampled)}),e;let a;return typeof t.tracesSampler=="function"?(a=t.tracesSampler(i),e.setMetadata({sampleRate:Number(a)})):i.parentSampled!==void 0?a=i.parentSampled:typeof t.tracesSampleRate<"u"?(a=t.tracesSampleRate,e.setMetadata({sampleRate:Number(a)})):(a=1,e.setMetadata({sampleRate:a})),$5(a)?a?(e.sampled=Math.random()<a,e.sampled?((typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&st.log(`[Tracing] starting ${e.op} transaction - ${e.name}`),e):((typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&st.log(`[Tracing] Discarding transaction because it's not included in the random sample (sampling rate = ${Number(a)})`),e)):((typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&st.log(`[Tracing] Discarding transaction because ${typeof t.tracesSampler=="function"?"tracesSampler returned 0 or false":"a negative sampling decision was inherited or tracesSampleRate is set to 0"}`),e.sampled=!1,e):((typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&st.warn("[Tracing] Discarding transaction because of invalid sample rate."),e.sampled=!1,e)}function $5(e){return jT(e)||!(typeof e=="number"||typeof e=="boolean")?((typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&st.warn(`[Tracing] Given sample rate is invalid. Sample rate must be a boolean or a number between 0 and 1. Got ${JSON.stringify(e)} of type ${JSON.stringify(typeof e)}.`),!1):e<0||e>1?((typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&st.warn(`[Tracing] Given sample rate is invalid. Sample rate must be between 0 and 1. Got ${e}.`),!1):!0}function V5(e,t){const i=this.getClient(),a=i&&i.getOptions()||{},u=a.instrumenter||"sentry",d=e.instrumenter||"sentry";u!==d&&((typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&st.error(`A transaction was started with instrumenter=\`${d}\`, but the SDK is configured with the \`${u}\` instrumenter.
The transaction will not be sampled. Please use the ${u} instrumentation to start transactions.`),e.sampled=!1);let p=new l2(e,this);return p=c2(p,a,{parentSampled:e.parentSampled,transactionContext:e,...t}),p.sampled&&p.initSpanRecorder(a._experiments&&a._experiments.maxSpans),i&&i.emit&&i.emit("startTransaction",p),p}function iw(e,t,i,a,u,d,p){const l=e.getClient(),b=l&&l.getOptions()||{};let w=new N5(t,e,i,a,p,u);return w=c2(w,b,{parentSampled:t.parentSampled,transactionContext:t,...d}),w.sampled&&w.initSpanRecorder(b._experiments&&b._experiments.maxSpans),l&&l.emit&&l.emit("startTransaction",w),w}function j5(){const e=wd();e.__SENTRY__&&(e.__SENTRY__.extensions=e.__SENTRY__.extensions||{},e.__SENTRY__.extensions.startTransaction||(e.__SENTRY__.extensions.startTransaction=V5),e.__SENTRY__.extensions.traceHeaders||(e.__SENTRY__.extensions.traceHeaders=U5),z5())}function Tm(e,t){return _n().captureException(e,{captureContext:t})}function G5(e,t){_n().setContext(e,t)}function q5(e){_n().withScope(e)}const H5="7";function W5(e){const t=e.protocol?`${e.protocol}:`:"",i=e.port?`:${e.port}`:"";return`${t}//${e.host}${i}${e.path?`/${e.path}`:""}/api/`}function Z5(e){return`${W5(e)}${e.projectId}/envelope/`}function Y5(e,t){return DF({sentry_key:e.publicKey,sentry_version:H5,...t&&{sentry_client:`${t.name}/${t.version}`}})}function X5(e,t={}){const i=typeof t=="string"?t:t.tunnel,a=typeof t=="string"||!t._metadata?void 0:t._metadata.sdk;return i||`${Z5(e)}?${Y5(e,a)}`}function K5(e,t){return t&&(e.sdk=e.sdk||{},e.sdk.name=e.sdk.name||t.name,e.sdk.version=e.sdk.version||t.version,e.sdk.integrations=[...e.sdk.integrations||[],...t.integrations||[]],e.sdk.packages=[...e.sdk.packages||[],...t.packages||[]]),e}function J5(e,t,i,a){const u=Wv(i),d={sent_at:new Date().toISOString(),...u&&{sdk:u},...!!a&&{dsn:bm(t)}},p="aggregates"in e?[{type:"sessions"},e]:[{type:"session"},e.toJSON()];return fu(d,[p])}function Q5(e,t,i,a){const u=Wv(i),d=e.type&&e.type!=="replay_event"?e.type:"event";K5(e,i&&i.sdk);const p=n2(e,u,a,t);return delete e.sdkProcessingMetadata,fu(p,[[{type:d},e]])}const rw=[];function eN(e){const t={};return e.forEach(i=>{const{name:a}=i,u=t[a];u&&!u.isDefaultInstance&&i.isDefaultInstance||(t[a]=i)}),Object.keys(t).map(i=>t[i])}function tN(e){const t=e.defaultIntegrations||[],i=e.integrations;t.forEach(p=>{p.isDefaultInstance=!0});let a;Array.isArray(i)?a=[...t,...i]:typeof i=="function"?a=qv(i(t)):a=t;const u=eN(a),d=iN(u,p=>p.name==="Debug");if(d!==-1){const[p]=u.splice(d,1);u.push(p)}return u}function nN(e){const t={};return e.forEach(i=>{i&&u2(i,t)}),t}function u2(e,t){t[e.name]=e,rw.indexOf(e.name)===-1&&(e.setupOnce(Yv,_n),rw.push(e.name),(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&st.log(`Integration installed: ${e.name}`))}function iN(e,t){for(let i=0;i<e.length;i++)if(t(e[i])===!0)return i;return-1}function h2(e,t,i,a){const{normalizeDepth:u=3,normalizeMaxBreadth:d=1e3}=e,p={...t,event_id:t.event_id||i.event_id||Dr(),timestamp:t.timestamp||wm()},l=i.integrations||e.integrations.map(C=>C.name);rN(p,e),oN(p,l),t.type===void 0&&sN(p,e.stackParser);let b=a;i.captureContext&&(b=gl.clone(b).update(i.captureContext));let w=xl(p);if(b){if(b.getAttachments){const C=[...i.attachments||[],...b.getAttachments()];C.length&&(i.attachments=C)}w=b.applyToEvent(p,i)}return w.then(C=>(C&&aN(C),typeof u=="number"&&u>0?lN(C,u,d):C))}function rN(e,t){const{environment:i,release:a,dist:u,maxValueLength:d=250}=t;"environment"in e||(e.environment="environment"in t?i:Zv),e.release===void 0&&a!==void 0&&(e.release=a),e.dist===void 0&&u!==void 0&&(e.dist=u),e.message&&(e.message=Bc(e.message,d));const p=e.exception&&e.exception.values&&e.exception.values[0];p&&p.value&&(p.value=Bc(p.value,d));const l=e.request;l&&l.url&&(l.url=Bc(l.url,d))}const sw=new WeakMap;function sN(e,t){const i=Mr._sentryDebugIds;if(!i)return;let a;const u=sw.get(t);u?a=u:(a=new Map,sw.set(t,a));const d=Object.keys(i).reduce((p,l)=>{let b;const w=a.get(l);w?b=w:(b=t(l),a.set(l,b));for(let C=b.length-1;C>=0;C--){const I=b[C];if(I.filename){p[I.filename]=i[l];break}}return p},{});try{e.exception.values.forEach(p=>{p.stacktrace.frames.forEach(l=>{l.filename&&(l.debug_id=d[l.filename])})})}catch{}}function aN(e){const t={};try{e.exception.values.forEach(a=>{a.stacktrace.frames.forEach(u=>{u.debug_id&&(u.abs_path?t[u.abs_path]=u.debug_id:u.filename&&(t[u.filename]=u.debug_id),delete u.debug_id)})})}catch{}if(Object.keys(t).length===0)return;e.debug_meta=e.debug_meta||{},e.debug_meta.images=e.debug_meta.images||[];const i=e.debug_meta.images;Object.keys(t).forEach(a=>{i.push({type:"sourcemap",code_file:a,debug_id:t[a]})})}function oN(e,t){t.length>0&&(e.sdk=e.sdk||{},e.sdk.integrations=[...e.sdk.integrations||[],...t])}function lN(e,t,i){if(!e)return null;const a={...e,...e.breadcrumbs&&{breadcrumbs:e.breadcrumbs.map(u=>({...u,...u.data&&{data:aa(u.data,t,i)}}))},...e.user&&{user:aa(e.user,t,i)},...e.contexts&&{contexts:aa(e.contexts,t,i)},...e.extra&&{extra:aa(e.extra,t,i)}};return e.contexts&&e.contexts.trace&&a.contexts&&(a.contexts.trace=e.contexts.trace,e.contexts.trace.data&&(a.contexts.trace.data=aa(e.contexts.trace.data,t,i))),e.spans&&(a.spans=e.spans.map(u=>(u.data&&(u.data=aa(u.data,t,i)),u))),a}const aw="Not capturing exception because it's already been captured.";class cN{constructor(t){if(this._options=t,this._integrations={},this._integrationsInitialized=!1,this._numProcessing=0,this._outcomes={},this._hooks={},t.dsn?this._dsn=MF(t.dsn):(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&st.warn("No DSN provided, client will not do anything."),this._dsn){const i=X5(this._dsn,t);this._transport=t.transport({recordDroppedEvent:this.recordDroppedEvent.bind(this),...t.transportOptions,url:i})}}captureException(t,i,a){if(Y1(t)){(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&st.log(aw);return}let u=i&&i.event_id;return this._process(this.eventFromException(t,i).then(d=>this._captureEvent(d,i,a)).then(d=>{u=d})),u}captureMessage(t,i,a,u){let d=a&&a.event_id;const p=VT(t)?this.eventFromMessage(String(t),i,a):this.eventFromException(t,a);return this._process(p.then(l=>this._captureEvent(l,a,u)).then(l=>{d=l})),d}captureEvent(t,i,a){if(i&&i.originalException&&Y1(i.originalException)){(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&st.log(aw);return}let u=i&&i.event_id;return this._process(this._captureEvent(t,i,a).then(d=>{u=d})),u}captureSession(t){if(!this._isEnabled()){(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&st.warn("SDK not enabled, will not capture session.");return}typeof t.release!="string"?(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&st.warn("Discarded session because of missing or non-string release"):(this.sendSession(t),Gc(t,{init:!1}))}getDsn(){return this._dsn}getOptions(){return this._options}getSdkMetadata(){return this._options._metadata}getTransport(){return this._transport}flush(t){const i=this._transport;return i?this._isClientDoneProcessing(t).then(a=>i.flush(t).then(u=>a&&u)):xl(!0)}close(t){return this.flush(t).then(i=>(this.getOptions().enabled=!1,i))}setupIntegrations(){this._isEnabled()&&!this._integrationsInitialized&&(this._integrations=nN(this._options.integrations),this._integrationsInitialized=!0)}getIntegrationById(t){return this._integrations[t]}getIntegration(t){try{return this._integrations[t.id]||null}catch{return(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&st.warn(`Cannot retrieve integration ${t.id} from the current Client`),null}}addIntegration(t){u2(t,this._integrations)}sendEvent(t,i={}){if(this._dsn){let a=Q5(t,this._dsn,this._options._metadata,this._options.tunnel);for(const d of i.attachments||[])a=_5(a,x5(d,this._options.transportOptions&&this._options.transportOptions.textEncoder));const u=this._sendEnvelope(a);u&&u.then(d=>this.emit("afterSendEvent",t,d),null)}}sendSession(t){if(this._dsn){const i=J5(t,this._dsn,this._options._metadata,this._options.tunnel);this._sendEnvelope(i)}}recordDroppedEvent(t,i,a){if(this._options.sendClientReports){const u=`${t}:${i}`;(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&st.log(`Adding outcome: "${u}"`),this._outcomes[u]=this._outcomes[u]+1||1}}on(t,i){this._hooks[t]||(this._hooks[t]=[]),this._hooks[t].push(i)}emit(t,...i){this._hooks[t]&&this._hooks[t].forEach(a=>a(...i))}_updateSessionFromEvent(t,i){let a=!1,u=!1;const d=i.exception&&i.exception.values;if(d){u=!0;for(const b of d){const w=b.mechanism;if(w&&w.handled===!1){a=!0;break}}}const p=t.status==="ok";(p&&t.errors===0||p&&a)&&(Gc(t,{...a&&{status:"crashed"},errors:t.errors||Number(u||a)}),this.captureSession(t))}_isClientDoneProcessing(t){return new as(i=>{let a=0;const u=1,d=setInterval(()=>{this._numProcessing==0?(clearInterval(d),i(!0)):(a+=u,t&&a>=t&&(clearInterval(d),i(!1)))},u)})}_isEnabled(){return this.getOptions().enabled!==!1&&this._dsn!==void 0}_prepareEvent(t,i,a){const u=this.getOptions(),d=Object.keys(this._integrations);return!i.integrations&&d.length>0&&(i.integrations=d),h2(u,t,i,a).then(p=>{if(p===null)return p;const{propagationContext:l}=p.sdkProcessingMetadata||{};if(!(p.contexts&&p.contexts.trace)&&l){const{traceId:w,spanId:C,parentSpanId:I,dsc:M}=l;p.contexts={trace:{trace_id:w,span_id:C,parent_span_id:I},...p.contexts};const O=M||Em(w,this,a);p.sdkProcessingMetadata={dynamicSamplingContext:O,...p.sdkProcessingMetadata}}return p})}_captureEvent(t,i={},a){return this._processEvent(t,i,a).then(u=>u.event_id,u=>{if(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__){const d=u;d.logLevel==="log"?st.log(d.message):st.warn(d)}})}_processEvent(t,i,a){const u=this.getOptions(),{sampleRate:d}=u;if(!this._isEnabled())return Np(new Fs("SDK not enabled, will not capture event.","log"));const p=f2(t),l=d2(t),b=t.type||"error",w=`before send for type \`${b}\``;if(l&&typeof d=="number"&&Math.random()>d)return this.recordDroppedEvent("sample_rate","error",t),Np(new Fs(`Discarding event because it's not included in the random sample (sampling rate = ${d})`,"log"));const C=b==="replay_event"?"replay":b;return this._prepareEvent(t,i,a).then(I=>{if(I===null)throw this.recordDroppedEvent("event_processor",C,t),new Fs("An event processor returned `null`, will not send event.","log");if(i.data&&i.data.__sentry__===!0)return I;const O=hN(u,I,i);return uN(O,w)}).then(I=>{if(I===null)throw this.recordDroppedEvent("before_send",C,t),new Fs(`${w} returned \`null\`, will not send event.`,"log");const M=a&&a.getSession();!p&&M&&this._updateSessionFromEvent(M,I);const O=I.transaction_info;if(p&&O&&I.transaction!==t.transaction){const j="custom";I.transaction_info={...O,source:j}}return this.sendEvent(I,i),I}).then(null,I=>{throw I instanceof Fs?I:(this.captureException(I,{data:{__sentry__:!0},originalException:I}),new Fs(`Event processing pipeline threw an error, original event will not be sent. Details have been sent as a new event.
Reason: ${I}`))})}_process(t){this._numProcessing++,t.then(i=>(this._numProcessing--,i),i=>(this._numProcessing--,i))}_sendEnvelope(t){if(this._transport&&this._dsn)return this.emit("beforeEnvelope",t),this._transport.send(t).then(null,i=>{(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&st.error("Error while sending event:",i)});(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&st.error("Transport disabled")}_clearOutcomes(){const t=this._outcomes;return this._outcomes={},Object.keys(t).map(i=>{const[a,u]=i.split(":");return{reason:a,category:u,quantity:t[i]}})}}function uN(e,t){const i=`${t} must return \`null\` or a valid event.`;if($v(e))return e.then(a=>{if(!jc(a)&&a!==null)throw new Fs(i);return a},a=>{throw new Fs(`${t} rejected with ${a}`)});if(!jc(e)&&e!==null)throw new Fs(i);return e}function hN(e,t,i){const{beforeSend:a,beforeSendTransaction:u}=e;return d2(t)&&a?a(t,i):f2(t)&&u?u(t,i):t}function d2(e){return e.type===void 0}function f2(e){return e.type==="transaction"}function dN(e,t){t.debug===!0&&(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__?st.enable():console.warn("[Sentry] Cannot initialize SDK with `debug` option using a non-debug bundle."));const i=_n();i.getScope().update(t.initialScope);const u=new e(t);i.bindClient(u)}const fN=30;function p2(e,t,i=s5(e.bufferSize||fN)){let a={};const u=p=>i.drain(p);function d(p){const l=[];if(J1(p,(I,M)=>{const O=Q1(M);if(C5(a,O)){const j=ow(I,M);e.recordDroppedEvent("ratelimit_backoff",O,j)}else l.push(I)}),l.length===0)return xl();const b=fu(p[0],l),w=I=>{J1(b,(M,O)=>{const j=ow(M,O);e.recordDroppedEvent(I,Q1(O),j)})},C=()=>t({body:y5(b,e.textEncoder)}).then(I=>(I.statusCode!==void 0&&(I.statusCode<200||I.statusCode>=300)&&(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&st.warn(`Sentry responded with status code ${I.statusCode} to sent event.`),a=I5(a,I),I),I=>{throw w("network_error"),I});return i.add(C).then(I=>I,I=>{if(I instanceof Fs)return(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&st.error("Skipped sending event because buffer is full."),w("queue_overflow"),xl();throw I})}return d.__sentry__baseTransport__=!0,{send:d,flush:u}}function ow(e,t){if(!(t!=="event"&&t!=="transaction"))return Array.isArray(e)?e[1]:void 0}const Up="7.64.0";let lw;class Cm{static __initStatic(){this.id="FunctionToString"}constructor(){this.name=Cm.id}setupOnce(){lw=Function.prototype.toString;try{Function.prototype.toString=function(...t){const i=Gv(this)||this;return lw.apply(i,t)}}catch{}}}Cm.__initStatic();const pN=[/^Script error\.?$/,/^Javascript error: Script error\.? on line 0$/],mN=[/^.*healthcheck.*$/,/^.*healthy.*$/,/^.*live.*$/,/^.*ready.*$/,/^.*heartbeat.*$/,/^.*\/health$/,/^.*\/healthz$/];class ad{static __initStatic(){this.id="InboundFilters"}constructor(t={}){this.name=ad.id,this._options=t}setupOnce(t,i){const a=u=>{const d=i();if(d){const p=d.getIntegration(ad);if(p){const l=d.getClient(),b=l?l.getOptions():{},w=gN(p._options,b);return _N(u,w)?null:u}}return u};a.id=this.name,t(a)}}ad.__initStatic();function gN(e={},t={}){return{allowUrls:[...e.allowUrls||[],...t.allowUrls||[]],denyUrls:[...e.denyUrls||[],...t.denyUrls||[]],ignoreErrors:[...e.ignoreErrors||[],...t.ignoreErrors||[],...e.disableErrorDefaults?[]:pN],ignoreTransactions:[...e.ignoreTransactions||[],...t.ignoreTransactions||[],...e.disableTransactionDefaults?[]:mN],ignoreInternal:e.ignoreInternal!==void 0?e.ignoreInternal:!0}}function _N(e,t){return t.ignoreInternal&&SN(e)?((typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&st.warn(`Event dropped due to being internal Sentry Error.
Event: ${_o(e)}`),!0):yN(e,t.ignoreErrors)?((typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&st.warn(`Event dropped due to being matched by \`ignoreErrors\` option.
Event: ${_o(e)}`),!0):vN(e,t.ignoreTransactions)?((typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&st.warn(`Event dropped due to being matched by \`ignoreTransactions\` option.
Event: ${_o(e)}`),!0):xN(e,t.denyUrls)?((typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&st.warn(`Event dropped due to being matched by \`denyUrls\` option.
Event: ${_o(e)}.
Url: ${$p(e)}`),!0):bN(e,t.allowUrls)?!1:((typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&st.warn(`Event dropped due to not being matched by \`allowUrls\` option.
Event: ${_o(e)}.
Url: ${$p(e)}`),!0)}function yN(e,t){return e.type||!t||!t.length?!1:wN(e).some(i=>du(i,t))}function vN(e,t){if(e.type!=="transaction"||!t||!t.length)return!1;const i=e.transaction;return i?du(i,t):!1}function xN(e,t){if(!t||!t.length)return!1;const i=$p(e);return i?du(i,t):!1}function bN(e,t){if(!t||!t.length)return!0;const i=$p(e);return i?du(i,t):!0}function wN(e){if(e.message)return[e.message];if(e.exception){const{values:t}=e.exception;try{const{type:i="",value:a=""}=t&&t[t.length-1]||{};return[`${a}`,`${i}: ${a}`]}catch{return(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&st.error(`Cannot extract message for event ${_o(e)}`),[]}}return[]}function SN(e){try{return e.exception.values[0].type==="SentryError"}catch{}return!1}function EN(e=[]){for(let t=e.length-1;t>=0;t--){const i=e[t];if(i&&i.filename!=="<anonymous>"&&i.filename!=="[native code]")return i.filename||null}return null}function $p(e){try{let t;try{t=e.exception.values[0].stacktrace.frames}catch{}return t?EN(t):null}catch{return(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&st.error(`Cannot extract url for event ${_o(e)}`),null}}const Nn=Mr;let vy=0;function m2(){return vy>0}function TN(){vy++,setTimeout(()=>{vy--})}function qc(e,t={},i){if(typeof e!="function")return e;try{const u=e.__sentry_wrapped__;if(u)return u;if(Gv(e))return e}catch{return e}const a=function(){const u=Array.prototype.slice.call(arguments);try{i&&typeof i=="function"&&i.apply(this,arguments);const d=u.map(p=>qc(p,t));return e.apply(this,d)}catch(d){throw TN(),q5(p=>{p.addEventProcessor(l=>(t.mechanism&&(hy(l,void 0,void 0),sd(l,t.mechanism)),l.extra={...l.extra,arguments:u},l)),Tm(d)}),d}};try{for(const u in e)Object.prototype.hasOwnProperty.call(e,u)&&(a[u]=e[u])}catch{}HT(a,e),jv(e,"__sentry_wrapped__",a);try{Object.getOwnPropertyDescriptor(a,"name").configurable&&Object.defineProperty(a,"name",{get(){return e.name}})}catch{}return a}function g2(e,t){const i=Kv(e,t),a={type:t&&t.name,value:AN(t)};return i.length&&(a.stacktrace={frames:i}),a.type===void 0&&a.value===""&&(a.value="Unrecoverable error caught"),a}function CN(e,t,i,a){const d=_n().getClient(),p=d&&d.getOptions().normalizeDepth,l={exception:{values:[{type:xm(t)?t.constructor.name:a?"UnhandledRejection":"Error",value:MN(t,{isUnhandledRejection:a})}]},extra:{__serialized__:QT(t,p)}};if(i){const b=Kv(e,i);b.length&&(l.exception.values[0].stacktrace={frames:b})}return l}function f_(e,t){return{exception:{values:[g2(e,t)]}}}function Kv(e,t){const i=t.stacktrace||t.stack||"",a=kN(t);try{return e(i,a)}catch{}return[]}const IN=/Minified React error #\d+;/i;function kN(e){if(e){if(typeof e.framesToPop=="number")return e.framesToPop;if(IN.test(e.message))return 1}return 0}function AN(e){const t=e&&e.message;return t?t.error&&typeof t.error.message=="string"?t.error.message:t:"No error message"}function PN(e,t,i,a){const u=i&&i.syntheticException||void 0,d=Jv(e,t,u,a);return sd(d),d.level="error",i&&i.event_id&&(d.event_id=i.event_id),xl(d)}function RN(e,t,i="info",a,u){const d=a&&a.syntheticException||void 0,p=xy(e,t,d,u);return p.level=i,a&&a.event_id&&(p.event_id=a.event_id),xl(p)}function Jv(e,t,i,a,u){let d;if(Uv(t)&&t.error)return f_(e,t.error);if(B1(t)||gF(t)){const p=t;if("stack"in t)d=f_(e,t);else{const l=p.name||(B1(p)?"DOMError":"DOMException"),b=p.message?`${l}: ${p.message}`:l;d=xy(e,b,i,a),hy(d,b)}return"code"in p&&(d.tags={...d.tags,"DOMException.code":`${p.code}`}),d}return $T(t)?f_(e,t):jc(t)||xm(t)?(d=CN(e,t,i,u),sd(d,{synthetic:!0}),d):(d=xy(e,t,i,a),hy(d,`${t}`,void 0),sd(d,{synthetic:!0}),d)}function xy(e,t,i,a){const u={message:t};if(a&&i){const d=Kv(e,i);d.length&&(u.exception={values:[{value:t,stacktrace:{frames:d}}]})}return u}function MN(e,{isUnhandledRejection:t}){const i=LF(e),a=t?"promise rejection":"exception";return Uv(e)?`Event \`ErrorEvent\` captured as ${a} with message \`${e.message}\``:xm(e)?`Event \`${DN(e)}\` (type=${e.type}) captured as ${a}`:`Object captured as ${a} with keys: ${i}`}function DN(e){try{const t=Object.getPrototypeOf(e);return t?t.constructor.name:void 0}catch{}}const Xf=1024,_2="Breadcrumbs";class Im{static __initStatic(){this.id=_2}constructor(t){this.name=Im.id,this.options={console:!0,dom:!0,fetch:!0,history:!0,sentry:!0,xhr:!0,...t}}setupOnce(){this.options.console&&cr("console",zN),this.options.dom&&cr("dom",LN(this.options.dom)),this.options.xhr&&cr("xhr",ON),this.options.fetch&&cr("fetch",BN),this.options.history&&cr("history",FN)}addSentryBreadcrumb(t){this.options.sentry&&_n().addBreadcrumb({category:`sentry.${t.type==="transaction"?"transaction":"event"}`,event_id:t.event_id,level:t.level,message:_o(t)},{event:t})}}Im.__initStatic();function LN(e){function t(i){let a,u=typeof e=="object"?e.serializeAttribute:void 0,d=typeof e=="object"&&typeof e.maxStringLength=="number"?e.maxStringLength:void 0;d&&d>Xf&&((typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&st.warn(`\`dom.maxStringLength\` cannot exceed ${Xf}, but a value of ${d} was configured. Sentry will use ${Xf} instead.`),d=Xf),typeof u=="string"&&(u=[u]);try{const p=i.event;a=NN(p)?ko(p.target,{keyAttrs:u,maxStringLength:d}):ko(p,{keyAttrs:u,maxStringLength:d})}catch{a="<unknown>"}a.length!==0&&_n().addBreadcrumb({category:`ui.${i.name}`,message:a},{event:i.event,name:i.name,global:i.global})}return t}function zN(e){for(let i=0;i<e.args.length;i++)if(e.args[i]==="ref=Ref<"){e.args[i+1]="viewRef";break}const t={category:"console",data:{arguments:e.args,logger:"console"},level:o5(e.level),message:F1(e.args," ")};if(e.level==="assert")if(e.args[0]===!1)t.message=`Assertion failed: ${F1(e.args.slice(1)," ")||"console.assert"}`,t.data.arguments=e.args.slice(1);else return;_n().addBreadcrumb(t,{input:e.args,level:e.level})}function ON(e){const{startTimestamp:t,endTimestamp:i}=e,a=e.xhr[vo];if(!t||!i||!a)return;const{method:u,url:d,status_code:p,body:l}=a,b={method:u,url:d,status_code:p},w={xhr:e.xhr,input:l,startTimestamp:t,endTimestamp:i};_n().addBreadcrumb({category:"xhr",data:b,type:"http"},w)}function BN(e){const{startTimestamp:t,endTimestamp:i}=e;if(i&&!(e.fetchData.url.match(/sentry_key/)&&e.fetchData.method==="POST"))if(e.error){const a=e.fetchData,u={data:e.error,input:e.args,startTimestamp:t,endTimestamp:i};_n().addBreadcrumb({category:"fetch",data:a,level:"error",type:"http"},u)}else{const a={...e.fetchData,status_code:e.response&&e.response.status},u={input:e.args,response:e.response,startTimestamp:t,endTimestamp:i};_n().addBreadcrumb({category:"fetch",data:a,type:"http"},u)}}function FN(e){let t=e.from,i=e.to;const a=h_(Nn.location.href);let u=h_(t);const d=h_(i);u.path||(u=a),a.protocol===d.protocol&&a.host===d.host&&(i=d.relative),a.protocol===u.protocol&&a.host===u.host&&(t=u.relative),_n().addBreadcrumb({category:"navigation",data:{from:t,to:i}})}function NN(e){return!!e&&!!e.target}function UN(e,{metadata:t,tunnel:i,dsn:a}){const u={event_id:e.event_id,sent_at:new Date().toISOString(),...t&&t.sdk&&{sdk:{name:t.sdk.name,version:t.sdk.version}},...!!i&&!!a&&{dsn:bm(a)}},d=$N(e);return fu(u,[d])}function $N(e){return[{type:"user_report"},e]}class VN extends cN{constructor(t){const i=Nn.SENTRY_SDK_SOURCE||QF();t._metadata=t._metadata||{},t._metadata.sdk=t._metadata.sdk||{name:"sentry.javascript.browser",packages:[{name:`${i}:@sentry/browser`,version:Up}],version:Up},super(t),t.sendClientReports&&Nn.document&&Nn.document.addEventListener("visibilitychange",()=>{Nn.document.visibilityState==="hidden"&&this._flushOutcomes()})}eventFromException(t,i){return PN(this._options.stackParser,t,i,this._options.attachStacktrace)}eventFromMessage(t,i="info",a){return RN(this._options.stackParser,t,i,a,this._options.attachStacktrace)}sendEvent(t,i){const a=this.getIntegrationById(_2);a&&a.addSentryBreadcrumb&&a.addSentryBreadcrumb(t),super.sendEvent(t,i)}captureUserFeedback(t){if(!this._isEnabled()){(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&st.warn("SDK not enabled, will not capture user feedback.");return}const i=UN(t,{metadata:this.getSdkMetadata(),dsn:this.getDsn(),tunnel:this.getOptions().tunnel});this._sendEnvelope(i)}_prepareEvent(t,i,a){return t.platform=t.platform||"javascript",super._prepareEvent(t,i,a)}_flushOutcomes(){const t=this._clearOutcomes();if(t.length===0){(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&st.log("No outcomes to send");return}if(!this._dsn){(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&st.log("No dsn provided, will not send outcomes");return}(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&st.log("Sending outcomes:",t);const i=w5(t,this._options.tunnel&&bm(this._dsn));this._sendEnvelope(i)}}let Ch;function jN(){if(Ch)return Ch;if(cy(Nn.fetch))return Ch=Nn.fetch.bind(Nn);const e=Nn.document;let t=Nn.fetch;if(e&&typeof e.createElement=="function")try{const i=e.createElement("iframe");i.hidden=!0,e.head.appendChild(i);const a=i.contentWindow;a&&a.fetch&&(t=a.fetch),e.head.removeChild(i)}catch(i){(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&st.warn("Could not create sandbox iframe for pure fetch check, bailing to window.fetch: ",i)}return Ch=t.bind(Nn)}function GN(){Ch=void 0}function qN(e,t=jN()){let i=0,a=0;function u(d){const p=d.body.length;i+=p,a++;const l={body:d.body,method:"POST",referrerPolicy:"origin",headers:e.headers,keepalive:i<=6e4&&a<15,...e.fetchOptions};try{return t(e.url,l).then(b=>(i-=p,a--,{statusCode:b.status,headers:{"x-sentry-rate-limits":b.headers.get("X-Sentry-Rate-Limits"),"retry-after":b.headers.get("Retry-After")}}))}catch(b){return GN(),i-=p,a--,Np(b)}}return p2(e,u)}const HN=4;function WN(e){function t(i){return new as((a,u)=>{const d=new XMLHttpRequest;d.onerror=u,d.onreadystatechange=()=>{d.readyState===HN&&a({statusCode:d.status,headers:{"x-sentry-rate-limits":d.getResponseHeader("X-Sentry-Rate-Limits"),"retry-after":d.getResponseHeader("Retry-After")}})},d.open("POST",e.url);for(const p in e.headers)Object.prototype.hasOwnProperty.call(e.headers,p)&&d.setRequestHeader(p,e.headers[p]);d.send(i.body)})}return p2(e,t)}const km="?",ZN=30,YN=40,XN=50;function Qv(e,t,i,a){const u={filename:e,function:t,in_app:!0};return i!==void 0&&(u.lineno=i),a!==void 0&&(u.colno=a),u}const KN=/^\s*at (?:(.+?\)(?: \[.+\])?|.*?) ?\((?:address at )?)?(?:async )?((?:<anonymous>|[-a-z]+:|.*bundle|\/)?.*?)(?::(\d+))?(?::(\d+))?\)?\s*$/i,JN=/\((\S*)(?::(\d+))(?::(\d+))\)/,QN=e=>{const t=KN.exec(e);if(t){if(t[2]&&t[2].indexOf("eval")===0){const d=JN.exec(t[2]);d&&(t[2]=d[1],t[3]=d[2],t[4]=d[3])}const[a,u]=y2(t[1]||km,t[2]);return Qv(u,a,t[3]?+t[3]:void 0,t[4]?+t[4]:void 0)}},e3=[ZN,QN],t3=/^\s*(.*?)(?:\((.*?)\))?(?:^|@)?((?:[-a-z]+)?:\/.*?|\[native code\]|[^@]*(?:bundle|\d+\.js)|\/[\w\-. /=]+)(?::(\d+))?(?::(\d+))?\s*$/i,n3=/(\S+) line (\d+)(?: > eval line \d+)* > eval/i,i3=e=>{const t=t3.exec(e);if(t){if(t[3]&&t[3].indexOf(" > eval")>-1){const d=n3.exec(t[3]);d&&(t[1]=t[1]||"eval",t[3]=d[1],t[4]=d[2],t[5]="")}let a=t[3],u=t[1]||km;return[u,a]=y2(u,a),Qv(a,u,t[4]?+t[4]:void 0,t[5]?+t[5]:void 0)}},r3=[XN,i3],s3=/^\s*at (?:((?:\[object object\])?.+) )?\(?((?:[-a-z]+):.*?):(\d+)(?::(\d+))?\)?\s*$/i,a3=e=>{const t=s3.exec(e);return t?Qv(t[2],t[1]||km,+t[3],t[4]?+t[4]:void 0):void 0},o3=[YN,a3],l3=[e3,r3,o3],c3=YT(...l3),y2=(e,t)=>{const i=e.indexOf("safari-extension")!==-1,a=e.indexOf("safari-web-extension")!==-1;return i||a?[e.indexOf("@")!==-1?e.split("@")[0]:km,i?`safari-extension:${t}`:`safari-web-extension:${t}`]:[e,t]};class pu{static __initStatic(){this.id="GlobalHandlers"}constructor(t){this.name=pu.id,this._options={onerror:!0,onunhandledrejection:!0,...t},this._installFunc={onerror:u3,onunhandledrejection:h3}}setupOnce(){Error.stackTraceLimit=50;const t=this._options;for(const i in t){const a=this._installFunc[i];a&&t[i]&&(p3(i),a(),this._installFunc[i]=void 0)}}}pu.__initStatic();function u3(){cr("error",e=>{const[t,i,a]=b2();if(!t.getIntegration(pu))return;const{msg:u,url:d,line:p,column:l,error:b}=e;if(m2()||b&&b.__sentry_own_request__)return;const w=b===void 0&&Io(u)?f3(u,d,p,l):v2(Jv(i,b||u,void 0,a,!1),d,p,l);w.level="error",x2(t,b,w,"onerror")})}function h3(){cr("unhandledrejection",e=>{const[t,i,a]=b2();if(!t.getIntegration(pu))return;let u=e;try{"reason"in e?u=e.reason:"detail"in e&&"reason"in e.detail&&(u=e.detail.reason)}catch{}if(m2()||u&&u.__sentry_own_request__)return!0;const d=VT(u)?d3(u):Jv(i,u,void 0,a,!0);d.level="error",x2(t,u,d,"onunhandledrejection")})}function d3(e){return{exception:{values:[{type:"UnhandledRejection",value:`Non-Error promise rejection captured with value: ${String(e)}`}]}}}function f3(e,t,i,a){const u=/^(?:[Uu]ncaught (?:exception: )?)?(?:((?:Eval|Internal|Range|Reference|Syntax|Type|URI|)Error): )?(.*)$/i;let d=Uv(e)?e.message:e,p="Error";const l=d.match(u);return l&&(p=l[1],d=l[2]),v2({exception:{values:[{type:p,value:d}]}},t,i,a)}function v2(e,t,i,a){const u=e.exception=e.exception||{},d=u.values=u.values||[],p=d[0]=d[0]||{},l=p.stacktrace=p.stacktrace||{},b=l.frames=l.frames||[],w=isNaN(parseInt(a,10))?void 0:a,C=isNaN(parseInt(i,10))?void 0:i,I=Io(t)&&t.length>0?t:TF();return b.length===0&&b.push({colno:w,filename:I,function:"?",in_app:!0,lineno:C}),e}function p3(e){(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&st.log(`Global Handler attached: ${e}`)}function x2(e,t,i,a){sd(i,{handled:!1,type:a}),e.captureEvent(i,{originalException:t})}function b2(){const e=_n(),t=e.getClient(),i=t&&t.getOptions()||{stackParser:()=>[],attachStacktrace:!1};return[e,i.stackParser,i.attachStacktrace]}const m3=["EventTarget","Window","Node","ApplicationCache","AudioTrackList","ChannelMergerNode","CryptoOperation","EventSource","FileReader","HTMLUnknownElement","IDBDatabase","IDBRequest","IDBTransaction","KeyOperation","MediaController","MessagePort","ModalWindow","Notification","SVGElementInstance","Screen","TextTrack","TextTrackCue","TextTrackList","WebSocket","WebSocketWorker","Worker","XMLHttpRequest","XMLHttpRequestEventTarget","XMLHttpRequestUpload"];class Am{static __initStatic(){this.id="TryCatch"}constructor(t){this.name=Am.id,this._options={XMLHttpRequest:!0,eventTarget:!0,requestAnimationFrame:!0,setInterval:!0,setTimeout:!0,...t}}setupOnce(){this._options.setTimeout&&Ji(Nn,"setTimeout",cw),this._options.setInterval&&Ji(Nn,"setInterval",cw),this._options.requestAnimationFrame&&Ji(Nn,"requestAnimationFrame",g3),this._options.XMLHttpRequest&&"XMLHttpRequest"in Nn&&Ji(XMLHttpRequest.prototype,"send",_3);const t=this._options.eventTarget;t&&(Array.isArray(t)?t:m3).forEach(y3)}}Am.__initStatic();function cw(e){return function(...t){const i=t[0];return t[0]=qc(i,{mechanism:{data:{function:Ao(e)},handled:!0,type:"instrument"}}),e.apply(this,t)}}function g3(e){return function(t){return e.apply(this,[qc(t,{mechanism:{data:{function:"requestAnimationFrame",handler:Ao(e)},handled:!0,type:"instrument"}})])}}function _3(e){return function(...t){const i=this;return["onload","onerror","onprogress","onreadystatechange"].forEach(u=>{u in i&&typeof i[u]=="function"&&Ji(i,u,function(d){const p={mechanism:{data:{function:u,handler:Ao(d)},handled:!0,type:"instrument"}},l=Gv(d);return l&&(p.mechanism.data.handler=Ao(l)),qc(d,p)})}),e.apply(this,t)}}function y3(e){const t=Nn,i=t[e]&&t[e].prototype;!i||!i.hasOwnProperty||!i.hasOwnProperty("addEventListener")||(Ji(i,"addEventListener",function(a){return function(u,d,p){try{typeof d.handleEvent=="function"&&(d.handleEvent=qc(d.handleEvent,{mechanism:{data:{function:"handleEvent",handler:Ao(d),target:e},handled:!0,type:"instrument"}}))}catch{}return a.apply(this,[u,qc(d,{mechanism:{data:{function:"addEventListener",handler:Ao(d),target:e},handled:!0,type:"instrument"}}),p])}}),Ji(i,"removeEventListener",function(a){return function(u,d,p){const l=d;try{const b=l&&l.__sentry_wrapped__;b&&a.call(this,u,b,p)}catch{}return a.call(this,u,l,p)}}))}const v3="cause",x3=5;class od{static __initStatic(){this.id="LinkedErrors"}constructor(t={}){this.name=od.id,this._key=t.key||v3,this._limit=t.limit||x3}setupOnce(t,i){t((a,u)=>{const d=i(),p=d.getClient(),l=d.getIntegration(od);if(!p||!l)return a;const b=p.getOptions();return bF(g2,b.stackParser,b.maxValueLength,l._key,l._limit,a,u),a})}}od.__initStatic();class ld{static __initStatic(){this.id="HttpContext"}constructor(){this.name=ld.id}setupOnce(){Yv(t=>{if(_n().getIntegration(ld)){if(!Nn.navigator&&!Nn.location&&!Nn.document)return t;const i=t.request&&t.request.url||Nn.location&&Nn.location.href,{referrer:a}=Nn.document||{},{userAgent:u}=Nn.navigator||{},d={...t.request&&t.request.headers,...a&&{Referer:a},...u&&{"User-Agent":u}},p={...t.request,...i&&{url:i},headers:d};return{...t,request:p}}return t})}}ld.__initStatic();class cd{static __initStatic(){this.id="Dedupe"}constructor(){this.name=cd.id}setupOnce(t,i){const a=u=>{if(u.type)return u;const d=i().getIntegration(cd);if(d){try{if(b3(u,d._previousEvent))return(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&st.warn("Event dropped due to being a duplicate of previously captured event."),null}catch{return d._previousEvent=u}return d._previousEvent=u}return u};a.id=this.name,t(a)}}cd.__initStatic();function b3(e,t){return t?!!(w3(e,t)||S3(e,t)):!1}function w3(e,t){const i=e.message,a=t.message;return!(!i&&!a||i&&!a||!i&&a||i!==a||!S2(e,t)||!w2(e,t))}function S3(e,t){const i=uw(t),a=uw(e);return!(!i||!a||i.type!==a.type||i.value!==a.value||!S2(e,t)||!w2(e,t))}function w2(e,t){let i=hw(e),a=hw(t);if(!i&&!a)return!0;if(i&&!a||!i&&a||(i=i,a=a,a.length!==i.length))return!1;for(let u=0;u<a.length;u++){const d=a[u],p=i[u];if(d.filename!==p.filename||d.lineno!==p.lineno||d.colno!==p.colno||d.function!==p.function)return!1}return!0}function S2(e,t){let i=e.fingerprint,a=t.fingerprint;if(!i&&!a)return!0;if(i&&!a||!i&&a)return!1;i=i,a=a;try{return i.join("")===a.join("")}catch{return!1}}function uw(e){return e.exception&&e.exception.values&&e.exception.values[0]}function hw(e){const t=e.exception;if(t)try{return t.values[0].stacktrace.frames}catch{return}}const E3=[new ad,new Cm,new Am,new Im,new pu,new od,new cd,new ld];function T3(e={}){e.defaultIntegrations===void 0&&(e.defaultIntegrations=E3),e.release===void 0&&(typeof __SENTRY_RELEASE__=="string"&&(e.release=__SENTRY_RELEASE__),Nn.SENTRY_RELEASE&&Nn.SENTRY_RELEASE.id&&(e.release=Nn.SENTRY_RELEASE.id)),e.autoSessionTracking===void 0&&(e.autoSessionTracking=!0),e.sendClientReports===void 0&&(e.sendClientReports=!0);const t={...e,stackParser:zF(e.stackParser||c3),integrations:tN(e),transport:e.transport||(XT()?qN:WN)};dN(VN,t),e.autoSessionTracking&&C3()}function dw(e){e.startSession({ignoreDuration:!0}),e.captureSession()}function C3(){if(typeof Nn.document>"u"){(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&st.warn("Session tracking in non-browser environment with @sentry/browser is not supported.");return}const e=_n();e.captureSession&&(dw(e),cr("history",({from:t,to:i})=>{t===void 0||t===i||dw(_n())}))}const An=Mr,e0="sentryReplaySession",I3="replay_event",t0="Unable to send Replay",k3=3e5,A3=9e5,P3=36e5,R3=5e3,M3=5500,D3=6e4,L3=5e3,z3=3,Kf=15e4,Jf=5e3,O3=3e3,B3=300,n0=2e7,F3=4999,N3=15e3;var Xi;(function(e){e[e.Document=0]="Document",e[e.DocumentType=1]="DocumentType",e[e.Element=2]="Element",e[e.Text=3]="Text",e[e.CDATA=4]="CDATA",e[e.Comment=5]="Comment"})(Xi||(Xi={}));function U3(e){return e.nodeType===e.ELEMENT_NODE}function Oh(e){const t=e==null?void 0:e.host;return!!(t&&t.shadowRoot&&t.shadowRoot===e)}function E2({maskInputOptions:e,tagName:t,type:i}){t.toLowerCase()==="option"&&(t="select");const a=typeof i=="string"?i.toLowerCase():void 0;return e[t.toLowerCase()]||a&&e[a]||a==="password"||t==="input"&&!i&&e.text}function $3({tagName:e,type:t,maskInputOptions:i,maskInputSelector:a}){return a||E2({maskInputOptions:i,tagName:e,type:t})}function ud({input:e,maskInputSelector:t,unmaskInputSelector:i,maskInputOptions:a,tagName:u,type:d,value:p,maskInputFn:l}){let b=p||"";return i&&e.matches(i)||(e.hasAttribute("data-rr-is-password")&&(d="password"),(E2({maskInputOptions:a,tagName:u,type:d})||t&&e.matches(t))&&(l?b=l(b):b="*".repeat(b.length))),b}const fw="__rrweb_original__";function V3(e){const t=e.getContext("2d");if(!t)return!0;const i=50;for(let a=0;a<e.width;a+=i)for(let u=0;u<e.height;u+=i){const d=t.getImageData,p=fw in d?d[fw]:d;if(new Uint32Array(p.call(t,a,u,Math.min(i,e.width-a),Math.min(i,e.height-u)).data.buffer).some(b=>b!==0))return!1}return!0}function T2(e){const t=e.type;return e.hasAttribute("data-rr-is-password")?"password":t?t.toLowerCase():null}function by(e,t,i){return typeof i=="string"&&i.toLowerCase(),t==="INPUT"&&(i==="radio"||i==="checkbox")?e.getAttribute("value")||"":e.value}let j3=1;const G3=new RegExp("[^a-z0-9-_:]"),hd=-2;function C2(e){return e?e.replace(/[\S]/g,"*"):""}function q3(){return j3++}function H3(e){if(e instanceof HTMLFormElement)return"form";const t=e.tagName.toLowerCase().trim();return G3.test(t)?"div":t}function wy(e){try{const t=e.rules||e.cssRules;return t?Array.from(t).map(W3).join(""):null}catch{return null}}function W3(e){let t=e.cssText;if(Z3(e))try{t=wy(e.styleSheet)||t}catch{}return I2(t)}function I2(e){if(e.indexOf(":")>-1){const t=/(\[(?:[\w-]+)[^\\])(:(?:[\w-]+)\])/gm;return e.replace(t,"$1\\$2")}return e}function Z3(e){return"styleSheet"in e}function Y3(e){return e.cssRules?Array.from(e.cssRules).map(t=>t.cssText?I2(t.cssText):"").join(""):""}function X3(e){let t="";return e.indexOf("//")>-1?t=e.split("/").slice(0,3).join("/"):t=e.split("/")[0],t=t.split("?")[0],t}let Tc,pw;const K3=/url\((?:(')([^']*)'|(")(.*?)"|([^)]*))\)/gm,J3=/^(?!www\.|(?:http|ftp)s?:\/\/|[A-Za-z]:\\|\/\/|#).*/,Q3=/^(data:)([^,]*),(.*)/i;function fp(e,t){return(e||"").replace(K3,(i,a,u,d,p,l)=>{const b=u||p||l,w=a||d||"";if(!b)return i;if(!J3.test(b))return`url(${w}${b}${w})`;if(Q3.test(b))return`url(${w}${b}${w})`;if(b[0]==="/")return`url(${w}${X3(t)+b}${w})`;const C=t.split("/"),I=b.split("/");C.pop();for(const M of I)M!=="."&&(M===".."?C.pop():C.push(M));return`url(${w}${C.join("/")}${w})`})}const eU=/^[^ \t\n\r\u000c]+/,tU=/^[, \t\n\r\u000c]+/;function nU(e,t){if(t.trim()==="")return t;let i=0;function a(d){let p,l=d.exec(t.substring(i));return l?(p=l[0],i+=p.length,p):""}let u=[];for(;a(tU),!(i>=t.length);){let d=a(eU);if(d.slice(-1)===",")d=Pc(e,d.substring(0,d.length-1)),u.push(d);else{let p="";d=Pc(e,d);let l=!1;for(;;){let b=t.charAt(i);if(b===""){u.push((d+p).trim());break}else if(l)b===")"&&(l=!1);else if(b===","){i+=1,u.push((d+p).trim());break}else b==="("&&(l=!0);p+=b,i+=1}}}return u.join(", ")}function Pc(e,t){if(!t||t.trim()==="")return t;const i=e.createElement("a");return i.href=t,i.href}function iU(e){return!!(e.tagName==="svg"||e.ownerSVGElement)}function Sy(){const e=document.createElement("a");return e.href="",e.href}function k2(e,t,i,a,u,d,p,l){if(!u)return u;const b=a.toLowerCase(),w=i.toLowerCase();return b==="src"||b==="href"||b==="xlink:href"&&u[0]!=="#"||b==="background"&&(w==="table"||w==="td"||w==="th")?Pc(e,u):b==="srcset"?nU(e,u):b==="style"?fp(u,Sy()):w==="object"&&b==="data"?Pc(e,u):d&&rU(t,b,w,p)?l?l(u):C2(u):u}function rU(e,t,i,a){return a&&e.matches(a)?!1:["placeholder","title","aria-label"].indexOf(t)>-1||i==="input"&&t==="value"&&e.hasAttribute("type")&&["submit","button"].indexOf(e.getAttribute("type").toLowerCase())>-1}function sU(e,t,i,a){if(a&&e.matches(a))return!1;if(typeof t=="string"){if(e.classList.contains(t))return!0}else for(let u=0;u<e.classList.length;u++){const d=e.classList[u];if(t.test(d))return!0}return i?e.matches(i):!1}function Vp(e,t,i,a,u){if(!e)return!1;if(e.nodeType!==e.ELEMENT_NODE)return Vp(e.parentNode,t,i,a,u);if(a&&(e.matches(a)||e.closest(a)))return!1;if(u)return!0;if(typeof t=="string"){if(e.classList.contains(t))return!0}else for(let d=0;d<e.classList.length;d++){const p=e.classList[d];if(t.test(p))return!0}return i&&e.matches(i)?!0:Vp(e.parentNode,t,i,a,u)}function aU(e,t,i){const a=e.contentWindow;if(!a)return;let u=!1,d;try{d=a.document.readyState}catch{return}if(d!=="complete"){const l=setTimeout(()=>{u||(t(),u=!0)},i);e.addEventListener("load",()=>{clearTimeout(l),u=!0,t()});return}const p="about:blank";if(a.location.href!==p||e.src===p||e.src===""){setTimeout(t,0);return}e.addEventListener("load",t)}function oU(e,t){var i;const{doc:a,blockClass:u,blockSelector:d,unblockSelector:p,maskTextClass:l,maskTextSelector:b,unmaskTextSelector:w,inlineStylesheet:C,maskInputSelector:I,unmaskInputSelector:M,maskAllText:O,maskInputOptions:j={},maskTextFn:Z,maskInputFn:ue,dataURLOptions:ce={},inlineImages:ve,recordCanvas:ye,keepIframeSrcFn:Ae}=t;let Be;if(a.__sn){const Le=a.__sn.id;Be=Le===1?void 0:Le}switch(e.nodeType){case e.DOCUMENT_NODE:return e.compatMode!=="CSS1Compat"?{type:Xi.Document,childNodes:[],compatMode:e.compatMode,rootId:Be}:{type:Xi.Document,childNodes:[],rootId:Be};case e.DOCUMENT_TYPE_NODE:return{type:Xi.DocumentType,name:e.name,publicId:e.publicId,systemId:e.systemId,rootId:Be};case e.ELEMENT_NODE:const Le=sU(e,u,d,p),Ie=H3(e);let U={};for(const{name:oe,value:ke}of Array.from(e.attributes))uU(Ie,oe)||(U[oe]=k2(a,e,Ie,oe,ke,O,w,Z));if(Ie==="link"&&C){const oe=Array.from(a.styleSheets).find(tt=>tt.href===e.href);let ke=null;oe&&(ke=wy(oe)),ke&&(delete U.rel,delete U.href,U._cssText=fp(ke,oe.href))}if(Ie==="style"&&e.sheet&&!(e.innerText||e.textContent||"").trim().length){const oe=wy(e.sheet);oe&&(U._cssText=fp(oe,Sy()))}if(Ie==="input"||Ie==="textarea"||Ie==="select"||Ie==="option"){const oe=e,ke=T2(oe),tt=by(oe,Ie.toUpperCase(),ke),et=e.checked;ke!=="submit"&&ke!=="button"&&tt&&(U.value=ud({input:oe,type:ke,tagName:Ie,value:tt,maskInputSelector:I,unmaskInputSelector:M,maskInputOptions:j,maskInputFn:ue})),et&&(U.checked=et)}if(Ie==="option"&&(e.selected&&!j.select?U.selected=!0:delete U.selected),Ie==="canvas"&&ye){if(e.__context==="2d")V3(e)||(U.rr_dataURL=e.toDataURL(ce.type,ce.quality));else if(!("__context"in e)){const oe=e.toDataURL(ce.type,ce.quality),ke=document.createElement("canvas");ke.width=e.width,ke.height=e.height;const tt=ke.toDataURL(ce.type,ce.quality);oe!==tt&&(U.rr_dataURL=oe)}}if(Ie==="img"&&ve){Tc||(Tc=a.createElement("canvas"),pw=Tc.getContext("2d"));const oe=e,ke=oe.crossOrigin;oe.crossOrigin="anonymous";const tt=()=>{try{Tc.width=oe.naturalWidth,Tc.height=oe.naturalHeight,pw.drawImage(oe,0,0),U.rr_dataURL=Tc.toDataURL(ce.type,ce.quality)}catch(et){console.warn(`Cannot inline img src=${oe.currentSrc}! Error: ${et}`)}ke?U.crossOrigin=ke:delete U.crossOrigin};oe.complete&&oe.naturalWidth!==0?tt():oe.onload=tt}if((Ie==="audio"||Ie==="video")&&(U.rr_mediaState=e.paused?"paused":"played",U.rr_mediaCurrentTime=e.currentTime),e.scrollLeft&&(U.rr_scrollLeft=e.scrollLeft),e.scrollTop&&(U.rr_scrollTop=e.scrollTop),Le){const{width:oe,height:ke}=e.getBoundingClientRect();U={class:U.class,rr_width:`${oe}px`,rr_height:`${ke}px`}}return Ie==="iframe"&&!Ae(U.src)&&(e.contentDocument||(U.rr_src=U.src),delete U.src),{type:Xi.Element,tagName:Ie,attributes:U,childNodes:[],isSVG:iU(e)||void 0,needBlock:Le,rootId:Be};case e.TEXT_NODE:const H=e.parentNode&&e.parentNode.tagName;let he=e.textContent;const xe=H==="STYLE"?!0:void 0,we=H==="SCRIPT"?!0:void 0;if(xe&&he){try{e.nextSibling||e.previousSibling||!((i=e.parentNode.sheet)===null||i===void 0)&&i.cssRules&&(he=Y3(e.parentNode.sheet))}catch(oe){console.warn(`Cannot get CSS styles from text's parentNode. Error: ${oe}`,e)}he=fp(he,Sy())}if(we&&(he="SCRIPT_PLACEHOLDER"),H==="TEXTAREA"&&he)he="";else if(H==="OPTION"&&he){const oe=e.parentNode;he=ud({input:oe,type:null,tagName:H,value:he,maskInputSelector:I,unmaskInputSelector:M,maskInputOptions:j,maskInputFn:ue})}else!xe&&!we&&Vp(e,l,b,w,O)&&he&&(he=Z?Z(he):C2(he));return{type:Xi.Text,textContent:he||"",isStyle:xe,rootId:Be};case e.CDATA_SECTION_NODE:return{type:Xi.CDATA,textContent:"",rootId:Be};case e.COMMENT_NODE:return{type:Xi.Comment,textContent:e.textContent||"",rootId:Be};default:return!1}}function ti(e){return e==null?"":e.toLowerCase()}function lU(e,t){if(t.comment&&e.type===Xi.Comment)return!0;if(e.type===Xi.Element){if(t.script&&(e.tagName==="script"||e.tagName==="link"&&(e.attributes.rel==="preload"||e.attributes.rel==="modulepreload")&&e.attributes.as==="script"||e.tagName==="link"&&e.attributes.rel==="prefetch"&&typeof e.attributes.href=="string"&&e.attributes.href.endsWith(".js")))return!0;if(t.headFavicon&&(e.tagName==="link"&&e.attributes.rel==="shortcut icon"||e.tagName==="meta"&&(ti(e.attributes.name).match(/^msapplication-tile(image|color)$/)||ti(e.attributes.name)==="application-name"||ti(e.attributes.rel)==="icon"||ti(e.attributes.rel)==="apple-touch-icon"||ti(e.attributes.rel)==="shortcut icon")))return!0;if(e.tagName==="meta"){if(t.headMetaDescKeywords&&ti(e.attributes.name).match(/^description|keywords$/))return!0;if(t.headMetaSocial&&(ti(e.attributes.property).match(/^(og|twitter|fb):/)||ti(e.attributes.name).match(/^(og|twitter):/)||ti(e.attributes.name)==="pinterest"))return!0;if(t.headMetaRobots&&(ti(e.attributes.name)==="robots"||ti(e.attributes.name)==="googlebot"||ti(e.attributes.name)==="bingbot"))return!0;if(t.headMetaHttpEquiv&&e.attributes["http-equiv"]!==void 0)return!0;if(t.headMetaAuthorship&&(ti(e.attributes.name)==="author"||ti(e.attributes.name)==="generator"||ti(e.attributes.name)==="framework"||ti(e.attributes.name)==="publisher"||ti(e.attributes.name)==="progid"||ti(e.attributes.property).match(/^article:/)||ti(e.attributes.property).match(/^product:/)))return!0;if(t.headMetaVerification&&(ti(e.attributes.name)==="google-site-verification"||ti(e.attributes.name)==="yandex-verification"||ti(e.attributes.name)==="csrf-token"||ti(e.attributes.name)==="p:domain_verify"||ti(e.attributes.name)==="verify-v1"||ti(e.attributes.name)==="verification"||ti(e.attributes.name)==="shopify-checkout-api-token"))return!0}}return!1}function Bh(e,t){const{doc:i,map:a,blockClass:u,blockSelector:d,unblockSelector:p,maskTextClass:l,maskTextSelector:b,unmaskTextSelector:w,skipChild:C=!1,inlineStylesheet:I=!0,maskInputSelector:M,unmaskInputSelector:O,maskAllText:j,maskInputOptions:Z={},maskTextFn:ue,maskInputFn:ce,slimDOMOptions:ve,dataURLOptions:ye={},inlineImages:Ae=!1,recordCanvas:Be=!1,onSerialize:Le,onIframeLoad:Ie,iframeLoadTimeout:U=5e3,keepIframeSrcFn:H=()=>!1}=t;let{preserveWhiteSpace:he=!0}=t;const xe=oU(e,{doc:i,blockClass:u,blockSelector:d,unblockSelector:p,maskTextClass:l,maskTextSelector:b,unmaskTextSelector:w,inlineStylesheet:I,maskInputSelector:M,unmaskInputSelector:O,maskAllText:j,maskInputOptions:Z,maskTextFn:ue,maskInputFn:ce,dataURLOptions:ye,inlineImages:Ae,recordCanvas:Be,keepIframeSrcFn:H});if(!xe)return console.warn(e,"not serialized"),null;let we;"__sn"in e?we=e.__sn.id:lU(xe,ve)||!he&&xe.type===Xi.Text&&!xe.isStyle&&!xe.textContent.replace(/^\s+|\s+$/gm,"").length?we=hd:we=q3();const oe=Object.assign(xe,{id:we});if(e.__sn=oe,we===hd)return null;a[we]=e,Le&&Le(e);let ke=!C;if(oe.type===Xi.Element&&(ke=ke&&!oe.needBlock,delete oe.needBlock,e.shadowRoot&&(oe.isShadowHost=!0)),(oe.type===Xi.Document||oe.type===Xi.Element)&&ke){ve.headWhitespace&&xe.type===Xi.Element&&xe.tagName==="head"&&(he=!1);const tt={doc:i,map:a,blockClass:u,blockSelector:d,unblockSelector:p,maskTextClass:l,maskTextSelector:b,unmaskTextSelector:w,skipChild:C,inlineStylesheet:I,maskInputSelector:M,unmaskInputSelector:O,maskAllText:j,maskInputOptions:Z,maskTextFn:ue,maskInputFn:ce,slimDOMOptions:ve,dataURLOptions:ye,inlineImages:Ae,recordCanvas:Be,preserveWhiteSpace:he,onSerialize:Le,onIframeLoad:Ie,iframeLoadTimeout:U,keepIframeSrcFn:H};for(const et of Array.from(e.childNodes)){const Ve=Bh(et,tt);Ve&&oe.childNodes.push(Ve)}if(U3(e)&&e.shadowRoot)for(const et of Array.from(e.shadowRoot.childNodes)){const Ve=Bh(et,tt);Ve&&(Ve.isShadow=!0,oe.childNodes.push(Ve))}}return e.parentNode&&Oh(e.parentNode)&&(oe.isShadow=!0),oe.type===Xi.Element&&oe.tagName==="iframe"&&aU(e,()=>{const tt=e.contentDocument;if(tt&&Ie){const et=Bh(tt,{doc:tt,map:a,blockClass:u,blockSelector:d,unblockSelector:p,maskTextClass:l,maskTextSelector:b,unmaskTextSelector:w,skipChild:!1,inlineStylesheet:I,maskInputSelector:M,unmaskInputSelector:O,maskAllText:j,maskInputOptions:Z,maskTextFn:ue,maskInputFn:ce,slimDOMOptions:ve,dataURLOptions:ye,inlineImages:Ae,recordCanvas:Be,preserveWhiteSpace:he,onSerialize:Le,onIframeLoad:Ie,iframeLoadTimeout:U,keepIframeSrcFn:H});et&&Ie(e,et)}},U),oe}function cU(e,t){const{blockClass:i="rr-block",blockSelector:a=null,unblockSelector:u=null,maskTextClass:d="rr-mask",maskTextSelector:p=null,unmaskTextSelector:l=null,inlineStylesheet:b=!0,inlineImages:w=!1,recordCanvas:C=!1,maskInputSelector:I=null,unmaskInputSelector:M=null,maskAllText:O=!1,maskAllInputs:j=!1,maskTextFn:Z,maskInputFn:ue,slimDOM:ce=!1,dataURLOptions:ve,preserveWhiteSpace:ye,onSerialize:Ae,onIframeLoad:Be,iframeLoadTimeout:Le,keepIframeSrcFn:Ie=()=>!1}=t||{},U={};return[Bh(e,{doc:e,map:U,blockClass:i,blockSelector:a,unblockSelector:u,maskTextClass:d,maskTextSelector:p,unmaskTextSelector:l,skipChild:!1,inlineStylesheet:b,maskInputSelector:I,unmaskInputSelector:M,maskAllText:O,maskInputOptions:j===!0?{color:!0,date:!0,"datetime-local":!0,email:!0,month:!0,number:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0,textarea:!0,select:!0}:j===!1?{}:j,maskTextFn:Z,maskInputFn:ue,slimDOMOptions:ce===!0||ce==="all"?{script:!0,comment:!0,headFavicon:!0,headWhitespace:!0,headMetaDescKeywords:ce==="all",headMetaSocial:!0,headMetaRobots:!0,headMetaHttpEquiv:!0,headMetaAuthorship:!0,headMetaVerification:!0}:ce===!1?{}:ce,dataURLOptions:ve,inlineImages:w,recordCanvas:C,preserveWhiteSpace:ye,onSerialize:Ae,onIframeLoad:Be,iframeLoadTimeout:Le,keepIframeSrcFn:Ie}),U]}function uU(e,t,i){return(e==="video"||e==="audio")&&t==="autoplay"}var Vn;(function(e){e[e.DomContentLoaded=0]="DomContentLoaded",e[e.Load=1]="Load",e[e.FullSnapshot=2]="FullSnapshot",e[e.IncrementalSnapshot=3]="IncrementalSnapshot",e[e.Meta=4]="Meta",e[e.Custom=5]="Custom",e[e.Plugin=6]="Plugin"})(Vn||(Vn={}));var or;(function(e){e[e.Mutation=0]="Mutation",e[e.MouseMove=1]="MouseMove",e[e.MouseInteraction=2]="MouseInteraction",e[e.Scroll=3]="Scroll",e[e.ViewportResize=4]="ViewportResize",e[e.Input=5]="Input",e[e.TouchMove=6]="TouchMove",e[e.MediaInteraction=7]="MediaInteraction",e[e.StyleSheetRule=8]="StyleSheetRule",e[e.CanvasMutation=9]="CanvasMutation",e[e.Font=10]="Font",e[e.Log=11]="Log",e[e.Drag=12]="Drag",e[e.StyleDeclaration=13]="StyleDeclaration"})(or||(or={}));var jp;(function(e){e[e.MouseUp=0]="MouseUp",e[e.MouseDown=1]="MouseDown",e[e.Click=2]="Click",e[e.ContextMenu=3]="ContextMenu",e[e.DblClick=4]="DblClick",e[e.Focus=5]="Focus",e[e.Blur=6]="Blur",e[e.TouchStart=7]="TouchStart",e[e.TouchMove_Departed=8]="TouchMove_Departed",e[e.TouchEnd=9]="TouchEnd",e[e.TouchCancel=10]="TouchCancel"})(jp||(jp={}));var Hc;(function(e){e[e["2D"]=0]="2D",e[e.WebGL=1]="WebGL",e[e.WebGL2=2]="WebGL2"})(Hc||(Hc={}));var mw;(function(e){e[e.Play=0]="Play",e[e.Pause=1]="Pause",e[e.Seeked=2]="Seeked",e[e.VolumeChange=3]="VolumeChange"})(mw||(mw={}));var gw;(function(e){e.Start="start",e.Pause="pause",e.Resume="resume",e.Resize="resize",e.Finish="finish",e.FullsnapshotRebuilded="fullsnapshot-rebuilded",e.LoadStylesheetStart="load-stylesheet-start",e.LoadStylesheetEnd="load-stylesheet-end",e.SkipStart="skip-start",e.SkipEnd="skip-end",e.MouseInteraction="mouse-interaction",e.EventCast="event-cast",e.CustomEvent="custom-event",e.Flush="flush",e.StateChange="state-change",e.PlayBack="play-back"})(gw||(gw={}));function cs(e,t,i=document){const a={capture:!0,passive:!0};return i.addEventListener(e,t,a),()=>i.removeEventListener(e,t,a)}function hU(){return{map:{},getId(e){return!e||!e.__sn?-1:e.__sn.id},getNode(e){return this.map[e]||null},removeNodeFromMap(e){const t=e.__sn&&e.__sn.id;delete this.map[t],e.childNodes&&e.childNodes.forEach(i=>this.removeNodeFromMap(i))},has(e){return this.map.hasOwnProperty(e)},reset(){this.map={}}}}const kc=`Please stop import mirror directly. Instead of that,\r
now you can use replayer.getMirror() to access the mirror instance of a replayer,\r
or you can use record.mirror to access the mirror instance during recording.`;let _w={map:{},getId(){return console.error(kc),-1},getNode(){return console.error(kc),null},removeNodeFromMap(){console.error(kc)},has(){return console.error(kc),!1},reset(){console.error(kc)}};typeof window<"u"&&window.Proxy&&window.Reflect&&(_w=new Proxy(_w,{get(e,t,i){return t==="map"&&console.error(kc),Reflect.get(e,t,i)}}));function dd(e,t,i={}){let a=null,u=0;return function(d){let p=Date.now();!u&&i.leading===!1&&(u=p);let l=t-(p-u),b=this,w=arguments;l<=0||l>t?(a&&(clearTimeout(a),a=null),u=p,e.apply(b,w)):!a&&i.trailing!==!1&&(a=setTimeout(()=>{u=i.leading===!1?0:Date.now(),a=null,e.apply(b,w)},l))}}function Pm(e,t,i,a,u=window){const d=u.Object.getOwnPropertyDescriptor(e,t);return u.Object.defineProperty(e,t,a?i:{set(p){setTimeout(()=>{i.set.call(this,p)},0),d&&d.set&&d.set.call(this,p)}}),()=>Pm(e,t,d||{},!0)}function Wc(e,t,i){try{if(!(t in e))return()=>{};const a=e[t],u=i(a);return typeof u=="function"&&(u.prototype=u.prototype||{},Object.defineProperties(u,{__rrweb_original__:{enumerable:!1,value:a}})),e[t]=u,()=>{e[t]=a}}catch{return()=>{}}}function A2(){return window.innerHeight||document.documentElement&&document.documentElement.clientHeight||document.body&&document.body.clientHeight}function P2(){return window.innerWidth||document.documentElement&&document.documentElement.clientWidth||document.body&&document.body.clientWidth}function Rr(e,t,i,a){if(!e)return!1;if(e.nodeType===e.ELEMENT_NODE){let u=!1;const d=a&&e.matches(a);return typeof t=="string"?e.closest!==void 0?u=!d&&e.closest("."+t)!==null:u=!d&&e.classList.contains(t):!d&&e.classList.forEach(p=>{t.test(p)&&(u=!0)}),!u&&i&&(u=e.matches(i)),!d&&u||Rr(e.parentNode,t,i,a)}return e.nodeType===e.TEXT_NODE,Rr(e.parentNode,t,i,a)}function p_(e){return"__sn"in e?e.__sn.id===hd:!1}function R2(e,t){if(Oh(e))return!1;const i=t.getId(e);return t.has(i)?e.parentNode&&e.parentNode.nodeType===e.DOCUMENT_NODE?!1:e.parentNode?R2(e.parentNode,t):!0:!0}function M2(e){return!!e.changedTouches}function dU(e=window){"NodeList"in e&&!e.NodeList.prototype.forEach&&(e.NodeList.prototype.forEach=Array.prototype.forEach),"DOMTokenList"in e&&!e.DOMTokenList.prototype.forEach&&(e.DOMTokenList.prototype.forEach=Array.prototype.forEach),Node.prototype.contains||(Node.prototype.contains=function(i){if(!(0 in arguments))throw new TypeError("1 argument is required");do if(this===i)return!0;while(i=i&&i.parentNode);return!1})}function D2(e){return"__sn"in e?e.__sn.type===Xi.Element&&e.__sn.tagName==="iframe":!1}function L2(e){return!!(e!=null&&e.shadowRoot)}function yw(e){return"__ln"in e}class fU{constructor(){this.length=0,this.head=null}get(t){if(t>=this.length)throw new Error("Position outside of list range");let i=this.head;for(let a=0;a<t;a++)i=(i==null?void 0:i.next)||null;return i}addNode(t){const i={value:t,previous:null,next:null};if(t.__ln=i,t.previousSibling&&yw(t.previousSibling)){const a=t.previousSibling.__ln.next;i.next=a,i.previous=t.previousSibling.__ln,t.previousSibling.__ln.next=i,a&&(a.previous=i)}else if(t.nextSibling&&yw(t.nextSibling)&&t.nextSibling.__ln.previous){const a=t.nextSibling.__ln.previous;i.previous=a,i.next=t.nextSibling.__ln,t.nextSibling.__ln.previous=i,a&&(a.next=i)}else this.head&&(this.head.previous=i),i.next=this.head,this.head=i;this.length++}removeNode(t){const i=t.__ln;this.head&&(i.previous?(i.previous.next=i.next,i.next&&(i.next.previous=i.previous)):(this.head=i.next,this.head&&(this.head.previous=null)),t.__ln&&delete t.__ln,this.length--)}}const vw=(e,t)=>`${e}@${t}`;function xw(e){return"__sn"in e}class pU{constructor(){this.frozen=!1,this.locked=!1,this.texts=[],this.attributes=[],this.removes=[],this.mapRemoves=[],this.movedMap={},this.addedSet=new Set,this.movedSet=new Set,this.droppedSet=new Set,this.processMutations=t=>{t.forEach(this.processMutation),this.emit()},this.emit=()=>{if(this.frozen||this.locked)return;const t=[],i=new fU,a=l=>{let b=l,w=hd;for(;w===hd;)b=b&&b.nextSibling,w=b&&this.mirror.getId(b);return w},u=l=>{var b,w,C,I,M;const O=l.getRootNode?(b=l.getRootNode())===null||b===void 0?void 0:b.host:null;let j=O;for(;!((C=(w=j==null?void 0:j.getRootNode)===null||w===void 0?void 0:w.call(j))===null||C===void 0)&&C.host;)j=((M=(I=j==null?void 0:j.getRootNode)===null||I===void 0?void 0:I.call(j))===null||M===void 0?void 0:M.host)||null;const Z=!this.doc.contains(l)&&(!j||!this.doc.contains(j));if(!l.parentNode||Z)return;const ue=Oh(l.parentNode)?this.mirror.getId(O):this.mirror.getId(l.parentNode),ce=a(l);if(ue===-1||ce===-1)return i.addNode(l);let ve=Bh(l,{doc:this.doc,map:this.mirror.map,blockClass:this.blockClass,blockSelector:this.blockSelector,unblockSelector:this.unblockSelector,maskTextClass:this.maskTextClass,maskTextSelector:this.maskTextSelector,unmaskTextSelector:this.unmaskTextSelector,maskInputSelector:this.maskInputSelector,unmaskInputSelector:this.unmaskInputSelector,skipChild:!0,inlineStylesheet:this.inlineStylesheet,maskAllText:this.maskAllText,maskInputOptions:this.maskInputOptions,maskTextFn:this.maskTextFn,maskInputFn:this.maskInputFn,slimDOMOptions:this.slimDOMOptions,recordCanvas:this.recordCanvas,inlineImages:this.inlineImages,onSerialize:ye=>{D2(ye)&&this.iframeManager.addIframe(ye),L2(l)&&this.shadowDomManager.addShadowRoot(l.shadowRoot,document)},onIframeLoad:(ye,Ae)=>{this.iframeManager.attachIframe(ye,Ae),this.shadowDomManager.observeAttachShadow(ye)}});ve&&t.push({parentId:ue,nextId:ce,node:ve})};for(;this.mapRemoves.length;)this.mirror.removeNodeFromMap(this.mapRemoves.shift());for(const l of this.movedSet)Ty(this.removes,l,this.mirror)&&!this.movedSet.has(l.parentNode)||u(l);for(const l of this.addedSet)!Cy(this.droppedSet,l)&&!Ty(this.removes,l,this.mirror)||Cy(this.movedSet,l)?u(l):this.droppedSet.add(l);let d=null;for(;i.length;){let l=null;if(d){const b=this.mirror.getId(d.value.parentNode),w=a(d.value);b!==-1&&w!==-1&&(l=d)}if(!l)for(let b=i.length-1;b>=0;b--){const w=i.get(b);if(w){const C=this.mirror.getId(w.value.parentNode),I=a(w.value);if(C!==-1&&I!==-1){l=w;break}}}if(!l){for(;i.head;)i.removeNode(i.head.value);break}d=l.previous,i.removeNode(l.value),u(l.value)}const p={texts:this.texts.map(l=>({id:this.mirror.getId(l.node),value:l.value})).filter(l=>this.mirror.has(l.id)),attributes:this.attributes.map(l=>({id:this.mirror.getId(l.node),attributes:l.attributes})).filter(l=>this.mirror.has(l.id)),removes:this.removes,adds:t};!p.texts.length&&!p.attributes.length&&!p.removes.length&&!p.adds.length||(this.texts=[],this.attributes=[],this.removes=[],this.addedSet=new Set,this.movedSet=new Set,this.droppedSet=new Set,this.movedMap={},this.mutationCb(p))},this.processMutation=t=>{if(!p_(t.target))switch(t.type){case"characterData":{const i=t.target.textContent;!Rr(t.target,this.blockClass,this.blockSelector,this.unblockSelector)&&i!==t.oldValue&&this.texts.push({value:Vp(t.target,this.maskTextClass,this.maskTextSelector,this.unmaskTextSelector,this.maskAllText)&&i?this.maskTextFn?this.maskTextFn(i):i.replace(/[\S]/g,"*"):i,node:t.target});break}case"attributes":{const i=t.target;let a=i.getAttribute(t.attributeName);if(t.attributeName==="value"&&(a=ud({input:i,maskInputSelector:this.maskInputSelector,unmaskInputSelector:this.unmaskInputSelector,maskInputOptions:this.maskInputOptions,tagName:i.tagName,type:i.getAttribute("type"),value:a,maskInputFn:this.maskInputFn})),Rr(t.target,this.blockClass,this.blockSelector,this.unblockSelector)||a===t.oldValue)return;let u=this.attributes.find(d=>d.node===t.target);if(u||(u={node:t.target,attributes:{}},this.attributes.push(u)),t.attributeName==="type"&&i.tagName==="INPUT"&&(t.oldValue||"").toLowerCase()==="password"&&i.setAttribute("data-rr-is-password","true"),t.attributeName==="style"){const d=this.doc.createElement("span");t.oldValue&&d.setAttribute("style",t.oldValue),(u.attributes.style===void 0||u.attributes.style===null)&&(u.attributes.style={});try{const p=u.attributes.style;for(const l of Array.from(i.style)){const b=i.style.getPropertyValue(l),w=i.style.getPropertyPriority(l);(b!==d.style.getPropertyValue(l)||w!==d.style.getPropertyPriority(l))&&(w===""?p[l]=b:p[l]=[b,w])}for(const l of Array.from(d.style))i.style.getPropertyValue(l)===""&&(p[l]=!1)}catch(p){console.warn("[rrweb] Error when parsing update to style attribute:",p)}}else{const d=t.target;u.attributes[t.attributeName]=k2(this.doc,d,d.tagName,t.attributeName,a,this.maskAllText,this.unmaskTextSelector,this.maskTextFn)}break}case"childList":{t.addedNodes.forEach(i=>this.genAdds(i,t.target)),t.removedNodes.forEach(i=>{const a=this.mirror.getId(i),u=Oh(t.target)?this.mirror.getId(t.target.host):this.mirror.getId(t.target);Rr(t.target,this.blockClass,this.blockSelector,this.unblockSelector)||p_(i)||(this.addedSet.has(i)?(Ey(this.addedSet,i),this.droppedSet.add(i)):this.addedSet.has(t.target)&&a===-1||R2(t.target,this.mirror)||(this.movedSet.has(i)&&this.movedMap[vw(a,u)]?Ey(this.movedSet,i):this.removes.push({parentId:u,id:a,isShadow:Oh(t.target)?!0:void 0})),this.mapRemoves.push(i))});break}}},this.genAdds=(t,i)=>{if(!(i&&Rr(i,this.blockClass,this.blockSelector,this.unblockSelector))){if(xw(t)){if(p_(t))return;this.movedSet.add(t);let a=null;i&&xw(i)&&(a=i.__sn.id),a&&(this.movedMap[vw(t.__sn.id,a)]=!0)}else this.addedSet.add(t),this.droppedSet.delete(t);Rr(t,this.blockClass,this.blockSelector,this.unblockSelector)||t.childNodes.forEach(a=>this.genAdds(a))}}}init(t){["mutationCb","blockClass","blockSelector","unblockSelector","maskTextClass","maskTextSelector","unmaskTextSelector","maskInputSelector","unmaskInputSelector","inlineStylesheet","maskAllText","maskInputOptions","maskTextFn","maskInputFn","recordCanvas","inlineImages","slimDOMOptions","doc","mirror","iframeManager","shadowDomManager","canvasManager"].forEach(i=>{this[i]=t[i]})}freeze(){this.frozen=!0,this.canvasManager.freeze()}unfreeze(){this.frozen=!1,this.canvasManager.unfreeze(),this.emit()}isFrozen(){return this.frozen}lock(){this.locked=!0,this.canvasManager.lock()}unlock(){this.locked=!1,this.canvasManager.unlock(),this.emit()}reset(){this.shadowDomManager.reset(),this.canvasManager.reset()}}function Ey(e,t){e.delete(t),t.childNodes.forEach(i=>Ey(e,i))}function Ty(e,t,i){const{parentNode:a}=t;if(!a)return!1;const u=i.getId(a);return e.some(d=>d.id===u)?!0:Ty(e,a,i)}function Cy(e,t){const{parentNode:i}=t;return i?e.has(i)?!0:Cy(e,i):!1}const Ln=e=>(...i)=>{try{return e(...i)}catch(a){try{a.__rrweb__=!0}catch{}throw a}},dl=[];function Ed(e){try{if("composedPath"in e){const t=e.composedPath();if(t.length)return t[0]}else if("path"in e&&e.path.length)return e.path[0]}catch{}return e&&e.target}function z2(e,t){var i,a;const u=new pU;dl.push(u),u.init(e);let d=window.MutationObserver||window.__rrMutationObserver;const p=(a=(i=window==null?void 0:window.Zone)===null||i===void 0?void 0:i.__symbol__)===null||a===void 0?void 0:a.call(i,"MutationObserver");p&&window[p]&&(d=window[p]);const l=new d(Ln(b=>{e.onMutation&&e.onMutation(b)===!1||u.processMutations(b)}));return l.observe(t,{attributes:!0,attributeOldValue:!0,characterData:!0,characterDataOldValue:!0,childList:!0,subtree:!0}),l}function mU({mousemoveCb:e,sampling:t,doc:i,mirror:a}){if(t.mousemove===!1)return()=>{};const u=typeof t.mousemove=="number"?t.mousemove:50,d=typeof t.mousemoveCallback=="number"?t.mousemoveCallback:500;let p=[],l;const b=dd(I=>{const M=Date.now()-l;Ln(e)(p.map(O=>(O.timeOffset-=M,O)),I),p=[],l=null},d),w=dd(I=>{const M=Ed(I),{clientX:O,clientY:j}=M2(I)?I.changedTouches[0]:I;l||(l=Date.now()),p.push({x:O,y:j,id:a.getId(M),timeOffset:Date.now()-l}),b(typeof DragEvent<"u"&&I instanceof DragEvent?or.Drag:I instanceof MouseEvent?or.MouseMove:or.TouchMove)},u,{trailing:!1}),C=[cs("mousemove",Ln(w),i),cs("touchmove",Ln(w),i),cs("drag",Ln(w),i)];return Ln(()=>{C.forEach(I=>I())})}function gU({mouseInteractionCb:e,doc:t,mirror:i,blockClass:a,blockSelector:u,unblockSelector:d,sampling:p}){if(p.mouseInteraction===!1)return()=>{};const l=p.mouseInteraction===!0||p.mouseInteraction===void 0?{}:p.mouseInteraction,b=[],w=C=>I=>{const M=Ed(I);if(Rr(M,a,u,d))return;const O=M2(I)?I.changedTouches[0]:I;if(!O)return;const j=i.getId(M),{clientX:Z,clientY:ue}=O;Ln(e)({type:jp[C],id:j,x:Z,y:ue})};return Object.keys(jp).filter(C=>Number.isNaN(Number(C))&&!C.endsWith("_Departed")&&l[C]!==!1).forEach(C=>{const I=C.toLowerCase(),M=Ln(w(C));b.push(cs(I,M,t))}),Ln(()=>{b.forEach(C=>C())})}function O2({scrollCb:e,doc:t,mirror:i,blockClass:a,blockSelector:u,unblockSelector:d,sampling:p}){const l=dd(b=>{const w=Ed(b);if(!w||Rr(w,a,u,d))return;const C=i.getId(w);if(w===t){const I=t.scrollingElement||t.documentElement;Ln(e)({id:C,x:I.scrollLeft,y:I.scrollTop})}else Ln(e)({id:C,x:w.scrollLeft,y:w.scrollTop})},p.scroll||100);return cs("scroll",Ln(l),t)}function _U({viewportResizeCb:e}){let t=-1,i=-1;const a=dd(()=>{const u=A2(),d=P2();(t!==u||i!==d)&&(Ln(e)({width:Number(d),height:Number(u)}),t=u,i=d)},200);return cs("resize",Ln(a),window)}function bw(e,t){const i=Object.assign({},e);return t||delete i.userTriggered,i}const yU=["INPUT","TEXTAREA","SELECT"],ww=new WeakMap;function vU({inputCb:e,doc:t,mirror:i,blockClass:a,blockSelector:u,unblockSelector:d,ignoreClass:p,ignoreSelector:l,maskInputSelector:b,unmaskInputSelector:w,maskInputOptions:C,maskInputFn:I,sampling:M,userTriggeredOnInput:O}){function j(Ae){let Be=Ed(Ae);const Le=Be&&Be.tagName,Ie=Ae.isTrusted;if(Le==="OPTION"&&(Be=Be.parentElement),!Be||!Le||yU.indexOf(Le)<0||Rr(Be,a,u,d))return;const U=Be,H=T2(U);if(U.classList.contains(p)||l&&U.matches(l))return;let he=by(U,Le,H),xe=!1;(H==="radio"||H==="checkbox")&&(xe=Be.checked),$3({maskInputOptions:C,maskInputSelector:b,tagName:Le,type:H})&&(he=ud({input:U,maskInputOptions:C,maskInputSelector:b,unmaskInputSelector:w,tagName:Le,type:H,value:he,maskInputFn:I})),Z(Be,Ln(bw)({text:he,isChecked:xe,userTriggered:Ie},O));const we=Be.name;H==="radio"&&we&&xe&&t.querySelectorAll(`input[type="radio"][name="${we}"]`).forEach(oe=>{if(oe!==Be){const ke=ud({input:oe,maskInputOptions:C,maskInputSelector:b,unmaskInputSelector:w,tagName:Le,type:H,value:by(oe,Le,H),maskInputFn:I});Z(oe,Ln(bw)({text:ke,isChecked:!xe,userTriggered:!1},O))}})}function Z(Ae,Be){const Le=ww.get(Ae);if(!Le||Le.text!==Be.text||Le.isChecked!==Be.isChecked){ww.set(Ae,Be);const Ie=i.getId(Ae);e(Object.assign(Object.assign({},Be),{id:Ie}))}}const ce=(M.input==="last"?["change"]:["input","change"]).map(Ae=>cs(Ae,Ln(j),t)),ve=Object.getOwnPropertyDescriptor(HTMLInputElement.prototype,"value"),ye=[[HTMLInputElement.prototype,"value"],[HTMLInputElement.prototype,"checked"],[HTMLSelectElement.prototype,"value"],[HTMLTextAreaElement.prototype,"value"],[HTMLSelectElement.prototype,"selectedIndex"],[HTMLOptionElement.prototype,"selected"]];return ve&&ve.set&&ce.push(...ye.map(Ae=>Pm(Ae[0],Ae[1],{set(){Ln(j)({target:this})}}))),Ln(()=>{ce.forEach(Ae=>Ae())})}function Gp(e){const t=[];function i(a,u){if(Qf("CSSGroupingRule")&&a.parentRule instanceof CSSGroupingRule||Qf("CSSMediaRule")&&a.parentRule instanceof CSSMediaRule||Qf("CSSSupportsRule")&&a.parentRule instanceof CSSSupportsRule||Qf("CSSConditionRule")&&a.parentRule instanceof CSSConditionRule){const p=Array.from(a.parentRule.cssRules).indexOf(a);u.unshift(p)}else{const p=Array.from(a.parentStyleSheet.cssRules).indexOf(a);u.unshift(p)}return u}return i(e,t)}function xU({styleSheetRuleCb:e,mirror:t},{win:i}){if(!i.CSSStyleSheet||!i.CSSStyleSheet.prototype)return()=>{};const a=i.CSSStyleSheet.prototype.insertRule;i.CSSStyleSheet.prototype.insertRule=new Proxy(a,{apply:Ln((l,b,w)=>{const[C,I]=w,M=t.getId(b.ownerNode);return M!==-1&&e({id:M,adds:[{rule:C,index:I}]}),l.apply(b,w)})});const u=i.CSSStyleSheet.prototype.deleteRule;i.CSSStyleSheet.prototype.deleteRule=new Proxy(u,{apply:Ln((l,b,w)=>{const[C]=w,I=t.getId(b.ownerNode);return I!==-1&&e({id:I,removes:[{index:C}]}),l.apply(b,w)})});const d={};ep("CSSGroupingRule")?d.CSSGroupingRule=i.CSSGroupingRule:(ep("CSSMediaRule")&&(d.CSSMediaRule=i.CSSMediaRule),ep("CSSConditionRule")&&(d.CSSConditionRule=i.CSSConditionRule),ep("CSSSupportsRule")&&(d.CSSSupportsRule=i.CSSSupportsRule));const p={};return Object.entries(d).forEach(([l,b])=>{p[l]={insertRule:b.prototype.insertRule,deleteRule:b.prototype.deleteRule},b.prototype.insertRule=new Proxy(p[l].insertRule,{apply:Ln((w,C,I)=>{const[M,O]=I,j=t.getId(C.parentStyleSheet.ownerNode);return j!==-1&&e({id:j,adds:[{rule:M,index:[...Gp(C),O||0]}]}),w.apply(C,I)})}),b.prototype.deleteRule=new Proxy(p[l].deleteRule,{apply:Ln((w,C,I)=>{const[M]=I,O=t.getId(C.parentStyleSheet.ownerNode);return O!==-1&&e({id:O,removes:[{index:[...Gp(C),M]}]}),w.apply(C,I)})})}),Ln(()=>{i.CSSStyleSheet.prototype.insertRule=a,i.CSSStyleSheet.prototype.deleteRule=u,Object.entries(d).forEach(([l,b])=>{b.prototype.insertRule=p[l].insertRule,b.prototype.deleteRule=p[l].deleteRule})})}function bU({styleDeclarationCb:e,mirror:t},{win:i}){const a=i.CSSStyleDeclaration.prototype.setProperty;i.CSSStyleDeclaration.prototype.setProperty=new Proxy(a,{apply:Ln((d,p,l)=>{var b,w;const[C,I,M]=l,O=t.getId((w=(b=p.parentRule)===null||b===void 0?void 0:b.parentStyleSheet)===null||w===void 0?void 0:w.ownerNode);return O!==-1&&e({id:O,set:{property:C,value:I,priority:M},index:Gp(p.parentRule)}),d.apply(p,l)})});const u=i.CSSStyleDeclaration.prototype.removeProperty;return i.CSSStyleDeclaration.prototype.removeProperty=new Proxy(u,{apply:Ln((d,p,l)=>{var b,w;const[C]=l,I=t.getId((w=(b=p.parentRule)===null||b===void 0?void 0:b.parentStyleSheet)===null||w===void 0?void 0:w.ownerNode);return I!==-1&&e({id:I,remove:{property:C},index:Gp(p.parentRule)}),d.apply(p,l)})}),Ln(()=>{i.CSSStyleDeclaration.prototype.setProperty=a,i.CSSStyleDeclaration.prototype.removeProperty=u})}function wU({mediaInteractionCb:e,blockClass:t,blockSelector:i,unblockSelector:a,mirror:u,sampling:d}){const p=b=>dd(Ln(w=>{const C=Ed(w);if(!C||Rr(C,t,i,a))return;const{currentTime:I,volume:M,muted:O}=C;e({type:b,id:u.getId(C),currentTime:I,volume:M,muted:O})}),d.media||500),l=[cs("play",p(0)),cs("pause",p(1)),cs("seeked",p(2)),cs("volumechange",p(3))];return Ln(()=>{l.forEach(b=>b())})}function SU({fontCb:e,doc:t}){const i=t.defaultView;if(!i)return()=>{};const a=[],u=new WeakMap,d=i.FontFace;i.FontFace=function(b,w,C){const I=new d(b,w,C);return u.set(I,{family:b,buffer:typeof w!="string",descriptors:C,fontSource:typeof w=="string"?w:JSON.stringify(Array.from(new Uint8Array(w)))}),I};const p=Wc(t.fonts,"add",function(l){return function(b){return setTimeout(()=>{const w=u.get(b);w&&(e(w),u.delete(b))},0),l.apply(this,[b])}});return a.push(()=>{i.FontFace=d}),a.push(p),Ln(()=>{a.forEach(l=>l())})}function EU(e,t){const{mutationCb:i,mousemoveCb:a,mouseInteractionCb:u,scrollCb:d,viewportResizeCb:p,inputCb:l,mediaInteractionCb:b,styleSheetRuleCb:w,styleDeclarationCb:C,canvasMutationCb:I,fontCb:M}=e;e.mutationCb=(...O)=>{t.mutation&&t.mutation(...O),i(...O)},e.mousemoveCb=(...O)=>{t.mousemove&&t.mousemove(...O),a(...O)},e.mouseInteractionCb=(...O)=>{t.mouseInteraction&&t.mouseInteraction(...O),u(...O)},e.scrollCb=(...O)=>{t.scroll&&t.scroll(...O),d(...O)},e.viewportResizeCb=(...O)=>{t.viewportResize&&t.viewportResize(...O),p(...O)},e.inputCb=(...O)=>{t.input&&t.input(...O),l(...O)},e.mediaInteractionCb=(...O)=>{t.mediaInteaction&&t.mediaInteaction(...O),b(...O)},e.styleSheetRuleCb=(...O)=>{t.styleSheetRule&&t.styleSheetRule(...O),w(...O)},e.styleDeclarationCb=(...O)=>{t.styleDeclaration&&t.styleDeclaration(...O),C(...O)},e.canvasMutationCb=(...O)=>{t.canvasMutation&&t.canvasMutation(...O),I(...O)},e.fontCb=(...O)=>{t.font&&t.font(...O),M(...O)}}function TU(e,t={}){const i=e.doc.defaultView;if(!i)return()=>{};EU(e,t);const a=z2(e,e.doc),u=mU(e),d=gU(e),p=O2(e),l=_U(e),b=vU(e),w=wU(e),C=xU(e,{win:i}),I=bU(e,{win:i}),M=e.collectFonts?SU(e):()=>{},O=[];for(const j of e.plugins)O.push(j.observer(j.callback,i,j.options));return Ln(()=>{dl.forEach(j=>j.reset()),a.disconnect(),u(),d(),p(),l(),b(),w();try{C(),I()}catch{}M(),O.forEach(j=>j())})}function Qf(e){return typeof window[e]<"u"}function ep(e){return!!(typeof window[e]<"u"&&window[e].prototype&&"insertRule"in window[e].prototype&&"deleteRule"in window[e].prototype)}class CU{constructor(t){this.iframes=new WeakMap,this.mutationCb=t.mutationCb}addIframe(t){this.iframes.set(t,!0)}addLoadListener(t){this.loadListener=t}attachIframe(t,i){var a;this.mutationCb({adds:[{parentId:t.__sn.id,nextId:null,node:i}],removes:[],texts:[],attributes:[],isAttachIframe:!0}),(a=this.loadListener)===null||a===void 0||a.call(this,t)}}class IU{constructor(t){this.restorePatches=[],this.mutationCb=t.mutationCb,this.scrollCb=t.scrollCb,this.bypassOptions=t.bypassOptions,this.mirror=t.mirror;const i=this;this.restorePatches.push(Wc(HTMLElement.prototype,"attachShadow",function(a){return function(){const u=a.apply(this,arguments);return this.shadowRoot&&i.addShadowRoot(this.shadowRoot,this.ownerDocument),u}}))}addShadowRoot(t,i){z2(Object.assign(Object.assign({},this.bypassOptions),{doc:i,mutationCb:this.mutationCb,mirror:this.mirror,shadowDomManager:this}),t),O2(Object.assign(Object.assign({},this.bypassOptions),{scrollCb:this.scrollCb,doc:t,mirror:this.mirror}))}observeAttachShadow(t){if(t.contentWindow){const i=this;this.restorePatches.push(Wc(t.contentWindow.HTMLElement.prototype,"attachShadow",function(a){return function(){const u=a.apply(this,arguments);return this.shadowRoot&&i.addShadowRoot(this.shadowRoot,t.contentDocument),u}}))}}reset(){this.restorePatches.forEach(t=>t())}}function kU(e,t){var i={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(i[a]=e[a]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var u=0,a=Object.getOwnPropertySymbols(e);u<a.length;u++)t.indexOf(a[u])<0&&Object.prototype.propertyIsEnumerable.call(e,a[u])&&(i[a[u]]=e[a[u]]);return i}function AU(e,t,i,a,u,d){const p=[],l=Object.getOwnPropertyNames(t.CanvasRenderingContext2D.prototype);for(const b of l)try{if(typeof t.CanvasRenderingContext2D.prototype[b]!="function")continue;const w=Wc(t.CanvasRenderingContext2D.prototype,b,function(C){return function(...I){return Rr(this.canvas,i,u,a)||setTimeout(()=>{const M=[...I];if(b==="drawImage"&&M[0]&&M[0]instanceof HTMLCanvasElement){const O=M[0],j=O.getContext("2d");let Z=j==null?void 0:j.getImageData(0,0,O.width,O.height),ue=Z==null?void 0:Z.data;M[0]=JSON.stringify(ue)}e(this.canvas,{type:Hc["2D"],property:b,args:M})},0),C.apply(this,I)}});p.push(w)}catch{const C=Pm(t.CanvasRenderingContext2D.prototype,b,{set(I){e(this.canvas,{type:Hc["2D"],property:b,args:[I],setter:!0})}});p.push(C)}return()=>{p.forEach(b=>b())}}function PU(e,t,i,a){const u=[];try{const d=Wc(e.HTMLCanvasElement.prototype,"getContext",function(p){return function(l,...b){return Rr(this,t,i,a)||"__context"in this||(this.__context=l),p.apply(this,[l,...b])}});u.push(d)}catch{console.error("failed to patch HTMLCanvasElement.prototype.getContext")}return()=>{u.forEach(d=>d())}}var Rc="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",RU=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var tp=0;tp<Rc.length;tp++)RU[Rc.charCodeAt(tp)]=tp;var MU=function(e){var t=new Uint8Array(e),i,a=t.length,u="";for(i=0;i<a;i+=3)u+=Rc[t[i]>>2],u+=Rc[(t[i]&3)<<4|t[i+1]>>4],u+=Rc[(t[i+1]&15)<<2|t[i+2]>>6],u+=Rc[t[i+2]&63];return a%3===2?u=u.substring(0,u.length-1)+"=":a%3===1&&(u=u.substring(0,u.length-2)+"=="),u};const Sw=new Map;function DU(e,t){let i=Sw.get(e);return i||(i=new Map,Sw.set(e,i)),i.has(t)||i.set(t,[]),i.get(t)}const B2=(e,t,i)=>{if(!e||!(F2(e,t)||typeof e=="object"))return;const a=e.constructor.name,u=DU(i,a);let d=u.indexOf(e);return d===-1&&(d=u.length,u.push(e)),d};function pp(e,t,i){if(e instanceof Array)return e.map(a=>pp(a,t,i));if(e===null)return e;if(e instanceof Float32Array||e instanceof Float64Array||e instanceof Int32Array||e instanceof Uint32Array||e instanceof Uint8Array||e instanceof Uint16Array||e instanceof Int16Array||e instanceof Int8Array||e instanceof Uint8ClampedArray)return{rr_type:e.constructor.name,args:[Object.values(e)]};if(e instanceof ArrayBuffer){const a=e.constructor.name,u=MU(e);return{rr_type:a,base64:u}}else{if(e instanceof DataView)return{rr_type:e.constructor.name,args:[pp(e.buffer,t,i),e.byteOffset,e.byteLength]};if(e instanceof HTMLImageElement){const a=e.constructor.name,{src:u}=e;return{rr_type:a,src:u}}else{if(e instanceof ImageData)return{rr_type:e.constructor.name,args:[pp(e.data,t,i),e.width,e.height]};if(F2(e,t)||typeof e=="object"){const a=e.constructor.name,u=B2(e,t,i);return{rr_type:a,index:u}}}}return e}const LU=(e,t,i)=>[...e].map(a=>pp(a,t,i)),F2=(e,t)=>!!["WebGLActiveInfo","WebGLBuffer","WebGLFramebuffer","WebGLProgram","WebGLRenderbuffer","WebGLShader","WebGLShaderPrecisionFormat","WebGLTexture","WebGLUniformLocation","WebGLVertexArrayObject","WebGLVertexArrayObjectOES"].filter(u=>typeof t[u]=="function").find(u=>e instanceof t[u]);function Ew(e,t,i,a,u,d,p,l){const b=[],w=Object.getOwnPropertyNames(e);for(const C of w)try{if(typeof e[C]!="function")continue;const I=Wc(e,C,function(M){return function(...O){const j=M.apply(this,O);if(B2(j,l,e),!Rr(this.canvas,a,d,u)){const Z=p.getId(this.canvas),ue=LU([...O],l,e),ce={type:t,property:C,args:ue};i(this.canvas,ce)}return j}});b.push(I)}catch{const M=Pm(e,C,{set(O){i(this.canvas,{type:t,property:C,args:[O],setter:!0})}});b.push(M)}return b}function zU(e,t,i,a,u,d){const p=[];return p.push(...Ew(t.WebGLRenderingContext.prototype,Hc.WebGL,e,i,a,u,d,t)),typeof t.WebGL2RenderingContext<"u"&&p.push(...Ew(t.WebGL2RenderingContext.prototype,Hc.WebGL2,e,i,a,u,d,t)),()=>{p.forEach(l=>l())}}class OU{reset(){this.pendingCanvasMutations.clear(),this.resetObservers&&this.resetObservers()}freeze(){this.frozen=!0}unfreeze(){this.frozen=!1}lock(){this.locked=!0}unlock(){this.locked=!1}constructor(t){this.pendingCanvasMutations=new Map,this.rafStamps={latestId:0,invokeId:null},this.frozen=!1,this.locked=!1,this.processMutation=function(i,a){(this.rafStamps.invokeId&&this.rafStamps.latestId!==this.rafStamps.invokeId||!this.rafStamps.invokeId)&&(this.rafStamps.invokeId=this.rafStamps.latestId),this.pendingCanvasMutations.has(i)||this.pendingCanvasMutations.set(i,[]),this.pendingCanvasMutations.get(i).push(a)},this.mutationCb=t.mutationCb,this.mirror=t.mirror,t.recordCanvas===!0&&this.initCanvasMutationObserver(t.win,t.blockClass,t.blockSelector,t.unblockSelector)}initCanvasMutationObserver(t,i,a,u){this.startRAFTimestamping(),this.startPendingCanvasMutationFlusher();const d=PU(t,i,u,a),p=AU(this.processMutation.bind(this),t,i,u,a,this.mirror),l=zU(this.processMutation.bind(this),t,i,u,a,this.mirror);this.resetObservers=()=>{d(),p(),l()}}startPendingCanvasMutationFlusher(){requestAnimationFrame(()=>this.flushPendingCanvasMutations())}startRAFTimestamping(){const t=i=>{this.rafStamps.latestId=i,requestAnimationFrame(t)};requestAnimationFrame(t)}flushPendingCanvasMutations(){this.pendingCanvasMutations.forEach((t,i)=>{const a=this.mirror.getId(i);this.flushPendingCanvasMutationFor(i,a)}),requestAnimationFrame(()=>this.flushPendingCanvasMutations())}flushPendingCanvasMutationFor(t,i){if(this.frozen||this.locked)return;const a=this.pendingCanvasMutations.get(t);if(!a||i===-1)return;const u=a.map(p=>kU(p,["type"])),{type:d}=a[0];this.mutationCb({id:i,type:d,commands:u}),this.pendingCanvasMutations.delete(t)}}function sr(e){return Object.assign(Object.assign({},e),{timestamp:Date.now()})}let Ni,Fh;const Ih=hU();function bl(e={}){const{emit:t,checkoutEveryNms:i,checkoutEveryNth:a,blockClass:u="rr-block",blockSelector:d=null,unblockSelector:p=null,ignoreClass:l="rr-ignore",ignoreSelector:b=null,maskTextClass:w="rr-mask",maskTextSelector:C=null,maskInputSelector:I=null,unmaskTextSelector:M=null,unmaskInputSelector:O=null,inlineStylesheet:j=!0,maskAllText:Z=!1,maskAllInputs:ue,maskInputOptions:ce,slimDOMOptions:ve,maskInputFn:ye,maskTextFn:Ae,hooks:Be,packFn:Le,sampling:Ie={},mousemoveWait:U,recordCanvas:H=!1,userTriggeredOnInput:he=!1,collectFonts:xe=!1,inlineImages:we=!1,plugins:oe,keepIframeSrcFn:ke=()=>!1,onMutation:tt}=e;if(!t)throw new Error("emit function is required");U!==void 0&&Ie.mousemove===void 0&&(Ie.mousemove=U);const et=ue===!0?{color:!0,date:!0,"datetime-local":!0,email:!0,month:!0,number:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0,textarea:!0,select:!0,radio:!0,checkbox:!0}:ce!==void 0?ce:{},Ve=ve===!0||ve==="all"?{script:!0,comment:!0,headFavicon:!0,headWhitespace:!0,headMetaSocial:!0,headMetaRobots:!0,headMetaHttpEquiv:!0,headMetaVerification:!0,headMetaAuthorship:ve==="all",headMetaDescKeywords:ve==="all"}:ve||{};dU();let $e,He=0;const kt=Se=>{for(const Ye of oe||[])Ye.eventProcessor&&(Se=Ye.eventProcessor(Se));return Le&&(Se=Le(Se)),Se};Ni=(Se,Ye)=>{var Oe;if(!((Oe=dl[0])===null||Oe===void 0)&&Oe.isFrozen()&&Se.type!==Vn.FullSnapshot&&!(Se.type===Vn.IncrementalSnapshot&&Se.data.source===or.Mutation)&&dl.forEach(je=>je.unfreeze()),t(kt(Se),Ye),Se.type===Vn.FullSnapshot)$e=Se,He=0;else if(Se.type===Vn.IncrementalSnapshot){if(Se.data.source===or.Mutation&&Se.data.isAttachIframe)return;He++;const je=a&&He>=a,ft=i&&Se.timestamp-$e.timestamp>i;(je||ft)&&Fh(!0)}};const Ct=Se=>{Ni(sr({type:Vn.IncrementalSnapshot,data:Object.assign({source:or.Mutation},Se)}))},rt=Se=>Ni(sr({type:Vn.IncrementalSnapshot,data:Object.assign({source:or.Scroll},Se)})),It=Se=>Ni(sr({type:Vn.IncrementalSnapshot,data:Object.assign({source:or.CanvasMutation},Se)})),Vt=new CU({mutationCb:Ct}),Lt=new OU({recordCanvas:H,mutationCb:It,win:window,blockClass:u,blockSelector:d,unblockSelector:p,mirror:Ih}),qe=new IU({mutationCb:Ct,scrollCb:rt,bypassOptions:{onMutation:tt,blockClass:u,blockSelector:d,unblockSelector:p,maskTextClass:w,maskTextSelector:C,unmaskTextSelector:M,maskInputSelector:I,unmaskInputSelector:O,inlineStylesheet:j,maskAllText:Z,maskInputOptions:et,maskTextFn:Ae,maskInputFn:ye,recordCanvas:H,inlineImages:we,sampling:Ie,slimDOMOptions:Ve,iframeManager:Vt,canvasManager:Lt},mirror:Ih});Fh=(Se=!1)=>{var Ye,Oe,je,ft;Ni(sr({type:Vn.Meta,data:{href:window.location.href,width:P2(),height:A2()}}),Se),dl.forEach(W=>W.lock());const[Y,ie]=cU(document,{blockClass:u,blockSelector:d,unblockSelector:p,maskTextClass:w,maskTextSelector:C,unmaskTextSelector:M,maskInputSelector:I,unmaskInputSelector:O,inlineStylesheet:j,maskAllText:Z,maskAllInputs:et,maskTextFn:Ae,slimDOM:Ve,recordCanvas:H,inlineImages:we,onSerialize:W=>{D2(W)&&Vt.addIframe(W),L2(W)&&qe.addShadowRoot(W.shadowRoot,document)},onIframeLoad:(W,De)=>{Vt.attachIframe(W,De),qe.observeAttachShadow(W)},keepIframeSrcFn:ke});if(!Y)return console.warn("Failed to snapshot the document");Ih.map=ie,Ni(sr({type:Vn.FullSnapshot,data:{node:Y,initialOffset:{left:window.pageXOffset!==void 0?window.pageXOffset:(document==null?void 0:document.documentElement.scrollLeft)||((Oe=(Ye=document==null?void 0:document.body)===null||Ye===void 0?void 0:Ye.parentElement)===null||Oe===void 0?void 0:Oe.scrollLeft)||(document==null?void 0:document.body.scrollLeft)||0,top:window.pageYOffset!==void 0?window.pageYOffset:(document==null?void 0:document.documentElement.scrollTop)||((ft=(je=document==null?void 0:document.body)===null||je===void 0?void 0:je.parentElement)===null||ft===void 0?void 0:ft.scrollTop)||(document==null?void 0:document.body.scrollTop)||0}}})),dl.forEach(W=>W.unlock())};try{const Se=[];Se.push(cs("DOMContentLoaded",()=>{Ni(sr({type:Vn.DomContentLoaded,data:{}}))}));const Ye=je=>{var ft;return Ln(TU)({onMutation:tt,mutationCb:Ct,mousemoveCb:(Y,ie)=>Ni(sr({type:Vn.IncrementalSnapshot,data:{source:ie,positions:Y}})),mouseInteractionCb:Y=>Ni(sr({type:Vn.IncrementalSnapshot,data:Object.assign({source:or.MouseInteraction},Y)})),scrollCb:rt,viewportResizeCb:Y=>Ni(sr({type:Vn.IncrementalSnapshot,data:Object.assign({source:or.ViewportResize},Y)})),inputCb:Y=>Ni(sr({type:Vn.IncrementalSnapshot,data:Object.assign({source:or.Input},Y)})),mediaInteractionCb:Y=>Ni(sr({type:Vn.IncrementalSnapshot,data:Object.assign({source:or.MediaInteraction},Y)})),styleSheetRuleCb:Y=>Ni(sr({type:Vn.IncrementalSnapshot,data:Object.assign({source:or.StyleSheetRule},Y)})),styleDeclarationCb:Y=>Ni(sr({type:Vn.IncrementalSnapshot,data:Object.assign({source:or.StyleDeclaration},Y)})),canvasMutationCb:It,fontCb:Y=>Ni(sr({type:Vn.IncrementalSnapshot,data:Object.assign({source:or.Font},Y)})),blockClass:u,ignoreClass:l,ignoreSelector:b,maskTextClass:w,maskTextSelector:C,unmaskTextSelector:M,maskInputSelector:I,unmaskInputSelector:O,maskInputOptions:et,inlineStylesheet:j,sampling:Ie,recordCanvas:H,inlineImages:we,userTriggeredOnInput:he,collectFonts:xe,doc:je,maskAllText:Z,maskInputFn:ye,maskTextFn:Ae,blockSelector:d,unblockSelector:p,slimDOMOptions:Ve,mirror:Ih,iframeManager:Vt,shadowDomManager:qe,canvasManager:Lt,plugins:((ft=oe==null?void 0:oe.filter(Y=>Y.observer))===null||ft===void 0?void 0:ft.map(Y=>({observer:Y.observer,options:Y.options,callback:ie=>Ni(sr({type:Vn.Plugin,data:{plugin:Y.name,payload:ie}}))})))||[]},Be)};Vt.addLoadListener(je=>{try{Se.push(Ye(je.contentDocument))}catch(ft){console.warn(ft)}});const Oe=()=>{Fh(),Se.push(Ye(document))};return document.readyState==="interactive"||document.readyState==="complete"?Oe():Se.push(cs("load",()=>{Ni(sr({type:Vn.Load,data:{}})),Oe()},window)),()=>{Se.forEach(je=>je())}}catch(Se){console.warn(Se)}}bl.addCustomEvent=(e,t)=>{if(!Ni)throw new Error("please add custom event after start recording");Ni(sr({type:Vn.Custom,data:{tag:e,payload:t}}))};bl.freezePage=()=>{dl.forEach(e=>e.freeze())};bl.takeFullSnapshot=e=>{if(!Fh)throw new Error("please take full snapshot after start recording");Fh(e)};bl.mirror=Ih;function i0(e){return e>9999999999?e:e*1e3}function BU(e){return e>9999999999?e/1e3:e}function Rm(e,t){t.category!=="sentry.transaction"&&(["ui.click","ui.input"].includes(t.category)?e.triggerUserActivity():e.checkAndHandleExpiredSession(),e.addUpdate(()=>(e.throttledAddEvent({type:Vn.Custom,timestamp:(t.timestamp||0)*1e3,data:{tag:"breadcrumb",payload:aa(t,10,1e3)}}),t.category==="console")))}const FU="button,a";function r0(e){const t=N2(e);return!t||!(t instanceof Element)?t:t.closest(FU)||t}function N2(e){return NU(e)?e.target:e}function NU(e){return typeof e=="object"&&!!e&&"target"in e}let mo;function UU(e){return mo||(mo=[],$U()),mo.push(e),()=>{const t=mo?mo.indexOf(e):-1;t>-1&&mo.splice(t,1)}}function $U(){Ji(An,"open",function(e){return function(...t){if(mo)try{mo.forEach(i=>i())}catch{}return e.apply(An,t)}})}function VU(e,t,i){e.handleClick(t,i)}class jU{constructor(t,i,a=Rm){this._lastMutation=0,this._lastScroll=0,this._clicks=[],this._timeout=i.timeout/1e3,this._threshold=i.threshold/1e3,this._scollTimeout=i.scrollTimeout/1e3,this._replay=t,this._ignoreSelector=i.ignoreSelector,this._addBreadcrumbEvent=a}addListeners(){const t=()=>{this._lastMutation=np()},i=()=>{this._lastScroll=np()},a=UU(()=>{this._lastMutation=np()}),u=p=>{if(!p.target)return;const l=r0(p);l&&this._handleMultiClick(l)},d=new MutationObserver(t);d.observe(An.document.documentElement,{attributes:!0,characterData:!0,childList:!0,subtree:!0}),An.addEventListener("scroll",i,{passive:!0}),An.addEventListener("click",u,{passive:!0}),this._teardown=()=>{An.removeEventListener("scroll",i),An.removeEventListener("click",u),a(),d.disconnect(),this._clicks=[],this._lastMutation=0,this._lastScroll=0}}removeListeners(){this._teardown&&this._teardown(),this._checkClickTimeout&&clearTimeout(this._checkClickTimeout)}handleClick(t,i){if(qU(i,this._ignoreSelector)||!HU(t))return;const a={timestamp:BU(t.timestamp),clickBreadcrumb:t,clickCount:0,node:i};this._clicks.some(u=>u.node===a.node&&Math.abs(u.timestamp-a.timestamp)<1)||(this._clicks.push(a),this._clicks.length===1&&this._scheduleCheckClicks())}_handleMultiClick(t){this._getClicks(t).forEach(i=>{i.clickCount++})}_getClicks(t){return this._clicks.filter(i=>i.node===t)}_checkClicks(){const t=[],i=np();this._clicks.forEach(a=>{!a.mutationAfter&&this._lastMutation&&(a.mutationAfter=a.timestamp<=this._lastMutation?this._lastMutation-a.timestamp:void 0),!a.scrollAfter&&this._lastScroll&&(a.scrollAfter=a.timestamp<=this._lastScroll?this._lastScroll-a.timestamp:void 0),a.timestamp+this._timeout<=i&&t.push(a)});for(const a of t){const u=this._clicks.indexOf(a);u>-1&&(this._generateBreadcrumbs(a),this._clicks.splice(u,1))}this._clicks.length&&this._scheduleCheckClicks()}_generateBreadcrumbs(t){const i=this._replay,a=t.scrollAfter&&t.scrollAfter<=this._scollTimeout,u=t.mutationAfter&&t.mutationAfter<=this._threshold,d=!a&&!u,{clickCount:p,clickBreadcrumb:l}=t;if(d){const b=Math.min(t.mutationAfter||this._timeout,this._timeout)*1e3,w=b<this._timeout*1e3?"mutation":"timeout",C={type:"default",message:l.message,timestamp:l.timestamp,category:"ui.slowClickDetected",data:{...l.data,url:An.location.href,route:i.getCurrentRoute(),timeAfterClickMs:b,endReason:w,clickCount:p||1}};this._addBreadcrumbEvent(i,C);return}if(p>1){const b={type:"default",message:l.message,timestamp:l.timestamp,category:"ui.multiClick",data:{...l.data,url:An.location.href,route:i.getCurrentRoute(),clickCount:p,metric:!0}};this._addBreadcrumbEvent(i,b)}}_scheduleCheckClicks(){this._checkClickTimeout&&clearTimeout(this._checkClickTimeout),this._checkClickTimeout=setTimeout(()=>this._checkClicks(),1e3)}}const GU=["A","BUTTON","INPUT"];function qU(e,t){return!!(!GU.includes(e.tagName)||e.tagName==="INPUT"&&!["submit","button"].includes(e.getAttribute("type")||"")||e.tagName==="A"&&(e.hasAttribute("download")||e.hasAttribute("target")&&e.getAttribute("target")!=="_self")||t&&e.matches(t))}function HU(e){return!!(e.data&&typeof e.data.nodeId=="number"&&e.timestamp)}function np(){return Date.now()/1e3}function Ma(e){return{timestamp:Date.now()/1e3,type:"default",...e}}var qp;(function(e){e[e.Document=0]="Document",e[e.DocumentType=1]="DocumentType",e[e.Element=2]="Element",e[e.Text=3]="Text",e[e.CDATA=4]="CDATA",e[e.Comment=5]="Comment"})(qp||(qp={}));const WU=new Set(["id","class","aria-label","role","name","alt","title","data-test-id","data-testid","disabled","aria-disabled"]);function ZU(e){const t={};for(const i in e)if(WU.has(i)){let a=i;(i==="data-testid"||i==="data-test-id")&&(a="testId"),t[a]=e[i]}return t}const YU=e=>t=>{if(!e.isEnabled())return;const i=XU(t);if(!i)return;const a=t.name==="click",u=a&&t.event;a&&e.clickDetector&&u&&!u.altKey&&!u.metaKey&&!u.ctrlKey&&!u.shiftKey&&VU(e.clickDetector,i,r0(t.event)),Rm(e,i)};function U2(e,t){const i=e&&JU(e)&&e.__sn.type===qp.Element?e.__sn:null;return{message:t,data:i?{nodeId:i.id,node:{id:i.id,tagName:i.tagName,textContent:e?Array.from(e.childNodes).map(a=>"__sn"in a&&a.__sn.type===qp.Text&&a.__sn.textContent).filter(Boolean).map(a=>a.trim()).join(""):"",attributes:ZU(i.attributes)}}:{}}}function XU(e){const{target:t,message:i}=KU(e);return Ma({category:`ui.${e.name}`,...U2(t,i)})}function KU(e){const t=e.name==="click";let i,a=null;try{a=t?r0(e.event):N2(e.event),i=ko(a,{maxStringLength:200})||"<unknown>"}catch{i="<unknown>"}return{target:a,message:i}}function JU(e){return"__sn"in e}function QU(e,t){if(!e.isEnabled())return;e.updateUserActivity();const i=e4(t);i&&Rm(e,i)}function e4(e){const{metaKey:t,shiftKey:i,ctrlKey:a,altKey:u,key:d,target:p}=e;if(!p||t4(p)||!d)return null;const l=t||a||u,b=d.length===1;if(!l&&b)return null;const w=ko(p,{maxStringLength:200})||"<unknown>",C=U2(p,w);return Ma({category:"ui.keyDown",message:w,data:{...C.data,metaKey:t,shiftKey:i,ctrlKey:a,altKey:u,key:d}})}function t4(e){return e.tagName==="INPUT"||e.tagName==="TEXTAREA"||e.isContentEditable}const n4=["name","type","startTime","transferSize","duration"];function Tw(e){return function(t){return n4.every(i=>e[i]===t[i])}}function i4(e,t){const[i,a,u]=e.reduce((b,w)=>(w.entryType==="navigation"?b[0].push(w):w.entryType==="largest-contentful-paint"?b[1].push(w):b[2].push(w),b),[[],[],[]]),d=[],p=[];let l=a.length?a[a.length-1]:void 0;return t.forEach(b=>{if(b.entryType==="largest-contentful-paint"){(!l||l.startTime<b.startTime)&&(l=b);return}if(b.entryType==="navigation"){const w=b;b.duration>0&&!i.find(Tw(w))&&!p.find(Tw(w))&&p.push(w);return}d.push(b)}),[...l?[l]:[],...i,...u,...d,...p].sort((b,w)=>b.startTime-w.startTime)}function r4(e){const t=a=>{const u=i4(e.performanceEvents,a.getEntries());e.performanceEvents=u},i=new PerformanceObserver(t);return["element","event","first-input","largest-contentful-paint","layout-shift","longtask","navigation","paint","resource"].forEach(a=>{try{i.observe({type:a,buffered:!0})}catch{}}),i}const s4=`/*! pako 2.1.0 https://github.com/nodeca/pako @license (MIT AND Zlib) */
function t(t){let e=t.length;for(;--e>=0;)t[e]=0}const e=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),a=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),i=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),n=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),s=new Array(576);t(s);const r=new Array(60);t(r);const o=new Array(512);t(o);const l=new Array(256);t(l);const h=new Array(29);t(h);const d=new Array(30);function _(t,e,a,i,n){this.static_tree=t,this.extra_bits=e,this.extra_base=a,this.elems=i,this.max_length=n,this.has_stree=t&&t.length}let f,c,u;function w(t,e){this.dyn_tree=t,this.max_code=0,this.stat_desc=e}t(d);const m=t=>t<256?o[t]:o[256+(t>>>7)],b=(t,e)=>{t.pending_buf[t.pending++]=255&e,t.pending_buf[t.pending++]=e>>>8&255},g=(t,e,a)=>{t.bi_valid>16-a?(t.bi_buf|=e<<t.bi_valid&65535,b(t,t.bi_buf),t.bi_buf=e>>16-t.bi_valid,t.bi_valid+=a-16):(t.bi_buf|=e<<t.bi_valid&65535,t.bi_valid+=a)},p=(t,e,a)=>{g(t,a[2*e],a[2*e+1])},k=(t,e)=>{let a=0;do{a|=1&t,t>>>=1,a<<=1}while(--e>0);return a>>>1},v=(t,e,a)=>{const i=new Array(16);let n,s,r=0;for(n=1;n<=15;n++)r=r+a[n-1]<<1,i[n]=r;for(s=0;s<=e;s++){let e=t[2*s+1];0!==e&&(t[2*s]=k(i[e]++,e))}},y=t=>{let e;for(e=0;e<286;e++)t.dyn_ltree[2*e]=0;for(e=0;e<30;e++)t.dyn_dtree[2*e]=0;for(e=0;e<19;e++)t.bl_tree[2*e]=0;t.dyn_ltree[512]=1,t.opt_len=t.static_len=0,t.sym_next=t.matches=0},x=t=>{t.bi_valid>8?b(t,t.bi_buf):t.bi_valid>0&&(t.pending_buf[t.pending++]=t.bi_buf),t.bi_buf=0,t.bi_valid=0},z=(t,e,a,i)=>{const n=2*e,s=2*a;return t[n]<t[s]||t[n]===t[s]&&i[e]<=i[a]},A=(t,e,a)=>{const i=t.heap[a];let n=a<<1;for(;n<=t.heap_len&&(n<t.heap_len&&z(e,t.heap[n+1],t.heap[n],t.depth)&&n++,!z(e,i,t.heap[n],t.depth));)t.heap[a]=t.heap[n],a=n,n<<=1;t.heap[a]=i},E=(t,i,n)=>{let s,r,o,_,f=0;if(0!==t.sym_next)do{s=255&t.pending_buf[t.sym_buf+f++],s+=(255&t.pending_buf[t.sym_buf+f++])<<8,r=t.pending_buf[t.sym_buf+f++],0===s?p(t,r,i):(o=l[r],p(t,o+256+1,i),_=e[o],0!==_&&(r-=h[o],g(t,r,_)),s--,o=m(s),p(t,o,n),_=a[o],0!==_&&(s-=d[o],g(t,s,_)))}while(f<t.sym_next);p(t,256,i)},R=(t,e)=>{const a=e.dyn_tree,i=e.stat_desc.static_tree,n=e.stat_desc.has_stree,s=e.stat_desc.elems;let r,o,l,h=-1;for(t.heap_len=0,t.heap_max=573,r=0;r<s;r++)0!==a[2*r]?(t.heap[++t.heap_len]=h=r,t.depth[r]=0):a[2*r+1]=0;for(;t.heap_len<2;)l=t.heap[++t.heap_len]=h<2?++h:0,a[2*l]=1,t.depth[l]=0,t.opt_len--,n&&(t.static_len-=i[2*l+1]);for(e.max_code=h,r=t.heap_len>>1;r>=1;r--)A(t,a,r);l=s;do{r=t.heap[1],t.heap[1]=t.heap[t.heap_len--],A(t,a,1),o=t.heap[1],t.heap[--t.heap_max]=r,t.heap[--t.heap_max]=o,a[2*l]=a[2*r]+a[2*o],t.depth[l]=(t.depth[r]>=t.depth[o]?t.depth[r]:t.depth[o])+1,a[2*r+1]=a[2*o+1]=l,t.heap[1]=l++,A(t,a,1)}while(t.heap_len>=2);t.heap[--t.heap_max]=t.heap[1],((t,e)=>{const a=e.dyn_tree,i=e.max_code,n=e.stat_desc.static_tree,s=e.stat_desc.has_stree,r=e.stat_desc.extra_bits,o=e.stat_desc.extra_base,l=e.stat_desc.max_length;let h,d,_,f,c,u,w=0;for(f=0;f<=15;f++)t.bl_count[f]=0;for(a[2*t.heap[t.heap_max]+1]=0,h=t.heap_max+1;h<573;h++)d=t.heap[h],f=a[2*a[2*d+1]+1]+1,f>l&&(f=l,w++),a[2*d+1]=f,d>i||(t.bl_count[f]++,c=0,d>=o&&(c=r[d-o]),u=a[2*d],t.opt_len+=u*(f+c),s&&(t.static_len+=u*(n[2*d+1]+c)));if(0!==w){do{for(f=l-1;0===t.bl_count[f];)f--;t.bl_count[f]--,t.bl_count[f+1]+=2,t.bl_count[l]--,w-=2}while(w>0);for(f=l;0!==f;f--)for(d=t.bl_count[f];0!==d;)_=t.heap[--h],_>i||(a[2*_+1]!==f&&(t.opt_len+=(f-a[2*_+1])*a[2*_],a[2*_+1]=f),d--)}})(t,e),v(a,h,t.bl_count)},Z=(t,e,a)=>{let i,n,s=-1,r=e[1],o=0,l=7,h=4;for(0===r&&(l=138,h=3),e[2*(a+1)+1]=65535,i=0;i<=a;i++)n=r,r=e[2*(i+1)+1],++o<l&&n===r||(o<h?t.bl_tree[2*n]+=o:0!==n?(n!==s&&t.bl_tree[2*n]++,t.bl_tree[32]++):o<=10?t.bl_tree[34]++:t.bl_tree[36]++,o=0,s=n,0===r?(l=138,h=3):n===r?(l=6,h=3):(l=7,h=4))},U=(t,e,a)=>{let i,n,s=-1,r=e[1],o=0,l=7,h=4;for(0===r&&(l=138,h=3),i=0;i<=a;i++)if(n=r,r=e[2*(i+1)+1],!(++o<l&&n===r)){if(o<h)do{p(t,n,t.bl_tree)}while(0!=--o);else 0!==n?(n!==s&&(p(t,n,t.bl_tree),o--),p(t,16,t.bl_tree),g(t,o-3,2)):o<=10?(p(t,17,t.bl_tree),g(t,o-3,3)):(p(t,18,t.bl_tree),g(t,o-11,7));o=0,s=n,0===r?(l=138,h=3):n===r?(l=6,h=3):(l=7,h=4)}};let S=!1;const D=(t,e,a,i)=>{g(t,0+(i?1:0),3),x(t),b(t,a),b(t,~a),a&&t.pending_buf.set(t.window.subarray(e,e+a),t.pending),t.pending+=a};var T=(t,e,a,i)=>{let o,l,h=0;t.level>0?(2===t.strm.data_type&&(t.strm.data_type=(t=>{let e,a=4093624447;for(e=0;e<=31;e++,a>>>=1)if(1&a&&0!==t.dyn_ltree[2*e])return 0;if(0!==t.dyn_ltree[18]||0!==t.dyn_ltree[20]||0!==t.dyn_ltree[26])return 1;for(e=32;e<256;e++)if(0!==t.dyn_ltree[2*e])return 1;return 0})(t)),R(t,t.l_desc),R(t,t.d_desc),h=(t=>{let e;for(Z(t,t.dyn_ltree,t.l_desc.max_code),Z(t,t.dyn_dtree,t.d_desc.max_code),R(t,t.bl_desc),e=18;e>=3&&0===t.bl_tree[2*n[e]+1];e--);return t.opt_len+=3*(e+1)+5+5+4,e})(t),o=t.opt_len+3+7>>>3,l=t.static_len+3+7>>>3,l<=o&&(o=l)):o=l=a+5,a+4<=o&&-1!==e?D(t,e,a,i):4===t.strategy||l===o?(g(t,2+(i?1:0),3),E(t,s,r)):(g(t,4+(i?1:0),3),((t,e,a,i)=>{let s;for(g(t,e-257,5),g(t,a-1,5),g(t,i-4,4),s=0;s<i;s++)g(t,t.bl_tree[2*n[s]+1],3);U(t,t.dyn_ltree,e-1),U(t,t.dyn_dtree,a-1)})(t,t.l_desc.max_code+1,t.d_desc.max_code+1,h+1),E(t,t.dyn_ltree,t.dyn_dtree)),y(t),i&&x(t)},O={_tr_init:t=>{S||((()=>{let t,n,w,m,b;const g=new Array(16);for(w=0,m=0;m<28;m++)for(h[m]=w,t=0;t<1<<e[m];t++)l[w++]=m;for(l[w-1]=m,b=0,m=0;m<16;m++)for(d[m]=b,t=0;t<1<<a[m];t++)o[b++]=m;for(b>>=7;m<30;m++)for(d[m]=b<<7,t=0;t<1<<a[m]-7;t++)o[256+b++]=m;for(n=0;n<=15;n++)g[n]=0;for(t=0;t<=143;)s[2*t+1]=8,t++,g[8]++;for(;t<=255;)s[2*t+1]=9,t++,g[9]++;for(;t<=279;)s[2*t+1]=7,t++,g[7]++;for(;t<=287;)s[2*t+1]=8,t++,g[8]++;for(v(s,287,g),t=0;t<30;t++)r[2*t+1]=5,r[2*t]=k(t,5);f=new _(s,e,257,286,15),c=new _(r,a,0,30,15),u=new _(new Array(0),i,0,19,7)})(),S=!0),t.l_desc=new w(t.dyn_ltree,f),t.d_desc=new w(t.dyn_dtree,c),t.bl_desc=new w(t.bl_tree,u),t.bi_buf=0,t.bi_valid=0,y(t)},_tr_stored_block:D,_tr_flush_block:T,_tr_tally:(t,e,a)=>(t.pending_buf[t.sym_buf+t.sym_next++]=e,t.pending_buf[t.sym_buf+t.sym_next++]=e>>8,t.pending_buf[t.sym_buf+t.sym_next++]=a,0===e?t.dyn_ltree[2*a]++:(t.matches++,e--,t.dyn_ltree[2*(l[a]+256+1)]++,t.dyn_dtree[2*m(e)]++),t.sym_next===t.sym_end),_tr_align:t=>{g(t,2,3),p(t,256,s),(t=>{16===t.bi_valid?(b(t,t.bi_buf),t.bi_buf=0,t.bi_valid=0):t.bi_valid>=8&&(t.pending_buf[t.pending++]=255&t.bi_buf,t.bi_buf>>=8,t.bi_valid-=8)})(t)}};var F=(t,e,a,i)=>{let n=65535&t|0,s=t>>>16&65535|0,r=0;for(;0!==a;){r=a>2e3?2e3:a,a-=r;do{n=n+e[i++]|0,s=s+n|0}while(--r);n%=65521,s%=65521}return n|s<<16|0};const L=new Uint32Array((()=>{let t,e=[];for(var a=0;a<256;a++){t=a;for(var i=0;i<8;i++)t=1&t?3988292384^t>>>1:t>>>1;e[a]=t}return e})());var N=(t,e,a,i)=>{const n=L,s=i+a;t^=-1;for(let a=i;a<s;a++)t=t>>>8^n[255&(t^e[a])];return-1^t},I={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},B={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};const{_tr_init:C,_tr_stored_block:H,_tr_flush_block:M,_tr_tally:j,_tr_align:K}=O,{Z_NO_FLUSH:P,Z_PARTIAL_FLUSH:Y,Z_FULL_FLUSH:G,Z_FINISH:X,Z_BLOCK:W,Z_OK:q,Z_STREAM_END:J,Z_STREAM_ERROR:Q,Z_DATA_ERROR:V,Z_BUF_ERROR:$,Z_DEFAULT_COMPRESSION:tt,Z_FILTERED:et,Z_HUFFMAN_ONLY:at,Z_RLE:it,Z_FIXED:nt,Z_DEFAULT_STRATEGY:st,Z_UNKNOWN:rt,Z_DEFLATED:ot}=B,lt=(t,e)=>(t.msg=I[e],e),ht=t=>2*t-(t>4?9:0),dt=t=>{let e=t.length;for(;--e>=0;)t[e]=0},_t=t=>{let e,a,i,n=t.w_size;e=t.hash_size,i=e;do{a=t.head[--i],t.head[i]=a>=n?a-n:0}while(--e);e=n,i=e;do{a=t.prev[--i],t.prev[i]=a>=n?a-n:0}while(--e)};let ft=(t,e,a)=>(e<<t.hash_shift^a)&t.hash_mask;const ct=t=>{const e=t.state;let a=e.pending;a>t.avail_out&&(a=t.avail_out),0!==a&&(t.output.set(e.pending_buf.subarray(e.pending_out,e.pending_out+a),t.next_out),t.next_out+=a,e.pending_out+=a,t.total_out+=a,t.avail_out-=a,e.pending-=a,0===e.pending&&(e.pending_out=0))},ut=(t,e)=>{M(t,t.block_start>=0?t.block_start:-1,t.strstart-t.block_start,e),t.block_start=t.strstart,ct(t.strm)},wt=(t,e)=>{t.pending_buf[t.pending++]=e},mt=(t,e)=>{t.pending_buf[t.pending++]=e>>>8&255,t.pending_buf[t.pending++]=255&e},bt=(t,e,a,i)=>{let n=t.avail_in;return n>i&&(n=i),0===n?0:(t.avail_in-=n,e.set(t.input.subarray(t.next_in,t.next_in+n),a),1===t.state.wrap?t.adler=F(t.adler,e,n,a):2===t.state.wrap&&(t.adler=N(t.adler,e,n,a)),t.next_in+=n,t.total_in+=n,n)},gt=(t,e)=>{let a,i,n=t.max_chain_length,s=t.strstart,r=t.prev_length,o=t.nice_match;const l=t.strstart>t.w_size-262?t.strstart-(t.w_size-262):0,h=t.window,d=t.w_mask,_=t.prev,f=t.strstart+258;let c=h[s+r-1],u=h[s+r];t.prev_length>=t.good_match&&(n>>=2),o>t.lookahead&&(o=t.lookahead);do{if(a=e,h[a+r]===u&&h[a+r-1]===c&&h[a]===h[s]&&h[++a]===h[s+1]){s+=2,a++;do{}while(h[++s]===h[++a]&&h[++s]===h[++a]&&h[++s]===h[++a]&&h[++s]===h[++a]&&h[++s]===h[++a]&&h[++s]===h[++a]&&h[++s]===h[++a]&&h[++s]===h[++a]&&s<f);if(i=258-(f-s),s=f-258,i>r){if(t.match_start=e,r=i,i>=o)break;c=h[s+r-1],u=h[s+r]}}}while((e=_[e&d])>l&&0!=--n);return r<=t.lookahead?r:t.lookahead},pt=t=>{const e=t.w_size;let a,i,n;do{if(i=t.window_size-t.lookahead-t.strstart,t.strstart>=e+(e-262)&&(t.window.set(t.window.subarray(e,e+e-i),0),t.match_start-=e,t.strstart-=e,t.block_start-=e,t.insert>t.strstart&&(t.insert=t.strstart),_t(t),i+=e),0===t.strm.avail_in)break;if(a=bt(t.strm,t.window,t.strstart+t.lookahead,i),t.lookahead+=a,t.lookahead+t.insert>=3)for(n=t.strstart-t.insert,t.ins_h=t.window[n],t.ins_h=ft(t,t.ins_h,t.window[n+1]);t.insert&&(t.ins_h=ft(t,t.ins_h,t.window[n+3-1]),t.prev[n&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=n,n++,t.insert--,!(t.lookahead+t.insert<3)););}while(t.lookahead<262&&0!==t.strm.avail_in)},kt=(t,e)=>{let a,i,n,s=t.pending_buf_size-5>t.w_size?t.w_size:t.pending_buf_size-5,r=0,o=t.strm.avail_in;do{if(a=65535,n=t.bi_valid+42>>3,t.strm.avail_out<n)break;if(n=t.strm.avail_out-n,i=t.strstart-t.block_start,a>i+t.strm.avail_in&&(a=i+t.strm.avail_in),a>n&&(a=n),a<s&&(0===a&&e!==X||e===P||a!==i+t.strm.avail_in))break;r=e===X&&a===i+t.strm.avail_in?1:0,H(t,0,0,r),t.pending_buf[t.pending-4]=a,t.pending_buf[t.pending-3]=a>>8,t.pending_buf[t.pending-2]=~a,t.pending_buf[t.pending-1]=~a>>8,ct(t.strm),i&&(i>a&&(i=a),t.strm.output.set(t.window.subarray(t.block_start,t.block_start+i),t.strm.next_out),t.strm.next_out+=i,t.strm.avail_out-=i,t.strm.total_out+=i,t.block_start+=i,a-=i),a&&(bt(t.strm,t.strm.output,t.strm.next_out,a),t.strm.next_out+=a,t.strm.avail_out-=a,t.strm.total_out+=a)}while(0===r);return o-=t.strm.avail_in,o&&(o>=t.w_size?(t.matches=2,t.window.set(t.strm.input.subarray(t.strm.next_in-t.w_size,t.strm.next_in),0),t.strstart=t.w_size,t.insert=t.strstart):(t.window_size-t.strstart<=o&&(t.strstart-=t.w_size,t.window.set(t.window.subarray(t.w_size,t.w_size+t.strstart),0),t.matches<2&&t.matches++,t.insert>t.strstart&&(t.insert=t.strstart)),t.window.set(t.strm.input.subarray(t.strm.next_in-o,t.strm.next_in),t.strstart),t.strstart+=o,t.insert+=o>t.w_size-t.insert?t.w_size-t.insert:o),t.block_start=t.strstart),t.high_water<t.strstart&&(t.high_water=t.strstart),r?4:e!==P&&e!==X&&0===t.strm.avail_in&&t.strstart===t.block_start?2:(n=t.window_size-t.strstart,t.strm.avail_in>n&&t.block_start>=t.w_size&&(t.block_start-=t.w_size,t.strstart-=t.w_size,t.window.set(t.window.subarray(t.w_size,t.w_size+t.strstart),0),t.matches<2&&t.matches++,n+=t.w_size,t.insert>t.strstart&&(t.insert=t.strstart)),n>t.strm.avail_in&&(n=t.strm.avail_in),n&&(bt(t.strm,t.window,t.strstart,n),t.strstart+=n,t.insert+=n>t.w_size-t.insert?t.w_size-t.insert:n),t.high_water<t.strstart&&(t.high_water=t.strstart),n=t.bi_valid+42>>3,n=t.pending_buf_size-n>65535?65535:t.pending_buf_size-n,s=n>t.w_size?t.w_size:n,i=t.strstart-t.block_start,(i>=s||(i||e===X)&&e!==P&&0===t.strm.avail_in&&i<=n)&&(a=i>n?n:i,r=e===X&&0===t.strm.avail_in&&a===i?1:0,H(t,t.block_start,a,r),t.block_start+=a,ct(t.strm)),r?3:1)},vt=(t,e)=>{let a,i;for(;;){if(t.lookahead<262){if(pt(t),t.lookahead<262&&e===P)return 1;if(0===t.lookahead)break}if(a=0,t.lookahead>=3&&(t.ins_h=ft(t,t.ins_h,t.window[t.strstart+3-1]),a=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),0!==a&&t.strstart-a<=t.w_size-262&&(t.match_length=gt(t,a)),t.match_length>=3)if(i=j(t,t.strstart-t.match_start,t.match_length-3),t.lookahead-=t.match_length,t.match_length<=t.max_lazy_match&&t.lookahead>=3){t.match_length--;do{t.strstart++,t.ins_h=ft(t,t.ins_h,t.window[t.strstart+3-1]),a=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart}while(0!=--t.match_length);t.strstart++}else t.strstart+=t.match_length,t.match_length=0,t.ins_h=t.window[t.strstart],t.ins_h=ft(t,t.ins_h,t.window[t.strstart+1]);else i=j(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++;if(i&&(ut(t,!1),0===t.strm.avail_out))return 1}return t.insert=t.strstart<2?t.strstart:2,e===X?(ut(t,!0),0===t.strm.avail_out?3:4):t.sym_next&&(ut(t,!1),0===t.strm.avail_out)?1:2},yt=(t,e)=>{let a,i,n;for(;;){if(t.lookahead<262){if(pt(t),t.lookahead<262&&e===P)return 1;if(0===t.lookahead)break}if(a=0,t.lookahead>=3&&(t.ins_h=ft(t,t.ins_h,t.window[t.strstart+3-1]),a=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),t.prev_length=t.match_length,t.prev_match=t.match_start,t.match_length=2,0!==a&&t.prev_length<t.max_lazy_match&&t.strstart-a<=t.w_size-262&&(t.match_length=gt(t,a),t.match_length<=5&&(t.strategy===et||3===t.match_length&&t.strstart-t.match_start>4096)&&(t.match_length=2)),t.prev_length>=3&&t.match_length<=t.prev_length){n=t.strstart+t.lookahead-3,i=j(t,t.strstart-1-t.prev_match,t.prev_length-3),t.lookahead-=t.prev_length-1,t.prev_length-=2;do{++t.strstart<=n&&(t.ins_h=ft(t,t.ins_h,t.window[t.strstart+3-1]),a=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart)}while(0!=--t.prev_length);if(t.match_available=0,t.match_length=2,t.strstart++,i&&(ut(t,!1),0===t.strm.avail_out))return 1}else if(t.match_available){if(i=j(t,0,t.window[t.strstart-1]),i&&ut(t,!1),t.strstart++,t.lookahead--,0===t.strm.avail_out)return 1}else t.match_available=1,t.strstart++,t.lookahead--}return t.match_available&&(i=j(t,0,t.window[t.strstart-1]),t.match_available=0),t.insert=t.strstart<2?t.strstart:2,e===X?(ut(t,!0),0===t.strm.avail_out?3:4):t.sym_next&&(ut(t,!1),0===t.strm.avail_out)?1:2};function xt(t,e,a,i,n){this.good_length=t,this.max_lazy=e,this.nice_length=a,this.max_chain=i,this.func=n}const zt=[new xt(0,0,0,0,kt),new xt(4,4,8,4,vt),new xt(4,5,16,8,vt),new xt(4,6,32,32,vt),new xt(4,4,16,16,yt),new xt(8,16,32,32,yt),new xt(8,16,128,128,yt),new xt(8,32,128,256,yt),new xt(32,128,258,1024,yt),new xt(32,258,258,4096,yt)];function At(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=ot,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(1146),this.dyn_dtree=new Uint16Array(122),this.bl_tree=new Uint16Array(78),dt(this.dyn_ltree),dt(this.dyn_dtree),dt(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(16),this.heap=new Uint16Array(573),dt(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(573),dt(this.depth),this.sym_buf=0,this.lit_bufsize=0,this.sym_next=0,this.sym_end=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}const Et=t=>{if(!t)return 1;const e=t.state;return!e||e.strm!==t||42!==e.status&&57!==e.status&&69!==e.status&&73!==e.status&&91!==e.status&&103!==e.status&&113!==e.status&&666!==e.status?1:0},Rt=t=>{if(Et(t))return lt(t,Q);t.total_in=t.total_out=0,t.data_type=rt;const e=t.state;return e.pending=0,e.pending_out=0,e.wrap<0&&(e.wrap=-e.wrap),e.status=2===e.wrap?57:e.wrap?42:113,t.adler=2===e.wrap?0:1,e.last_flush=-2,C(e),q},Zt=t=>{const e=Rt(t);var a;return e===q&&((a=t.state).window_size=2*a.w_size,dt(a.head),a.max_lazy_match=zt[a.level].max_lazy,a.good_match=zt[a.level].good_length,a.nice_match=zt[a.level].nice_length,a.max_chain_length=zt[a.level].max_chain,a.strstart=0,a.block_start=0,a.lookahead=0,a.insert=0,a.match_length=a.prev_length=2,a.match_available=0,a.ins_h=0),e},Ut=(t,e,a,i,n,s)=>{if(!t)return Q;let r=1;if(e===tt&&(e=6),i<0?(r=0,i=-i):i>15&&(r=2,i-=16),n<1||n>9||a!==ot||i<8||i>15||e<0||e>9||s<0||s>nt||8===i&&1!==r)return lt(t,Q);8===i&&(i=9);const o=new At;return t.state=o,o.strm=t,o.status=42,o.wrap=r,o.gzhead=null,o.w_bits=i,o.w_size=1<<o.w_bits,o.w_mask=o.w_size-1,o.hash_bits=n+7,o.hash_size=1<<o.hash_bits,o.hash_mask=o.hash_size-1,o.hash_shift=~~((o.hash_bits+3-1)/3),o.window=new Uint8Array(2*o.w_size),o.head=new Uint16Array(o.hash_size),o.prev=new Uint16Array(o.w_size),o.lit_bufsize=1<<n+6,o.pending_buf_size=4*o.lit_bufsize,o.pending_buf=new Uint8Array(o.pending_buf_size),o.sym_buf=o.lit_bufsize,o.sym_end=3*(o.lit_bufsize-1),o.level=e,o.strategy=s,o.method=a,Zt(t)};var St={deflateInit:(t,e)=>Ut(t,e,ot,15,8,st),deflateInit2:Ut,deflateReset:Zt,deflateResetKeep:Rt,deflateSetHeader:(t,e)=>Et(t)||2!==t.state.wrap?Q:(t.state.gzhead=e,q),deflate:(t,e)=>{if(Et(t)||e>W||e<0)return t?lt(t,Q):Q;const a=t.state;if(!t.output||0!==t.avail_in&&!t.input||666===a.status&&e!==X)return lt(t,0===t.avail_out?$:Q);const i=a.last_flush;if(a.last_flush=e,0!==a.pending){if(ct(t),0===t.avail_out)return a.last_flush=-1,q}else if(0===t.avail_in&&ht(e)<=ht(i)&&e!==X)return lt(t,$);if(666===a.status&&0!==t.avail_in)return lt(t,$);if(42===a.status&&0===a.wrap&&(a.status=113),42===a.status){let e=ot+(a.w_bits-8<<4)<<8,i=-1;if(i=a.strategy>=at||a.level<2?0:a.level<6?1:6===a.level?2:3,e|=i<<6,0!==a.strstart&&(e|=32),e+=31-e%31,mt(a,e),0!==a.strstart&&(mt(a,t.adler>>>16),mt(a,65535&t.adler)),t.adler=1,a.status=113,ct(t),0!==a.pending)return a.last_flush=-1,q}if(57===a.status)if(t.adler=0,wt(a,31),wt(a,139),wt(a,8),a.gzhead)wt(a,(a.gzhead.text?1:0)+(a.gzhead.hcrc?2:0)+(a.gzhead.extra?4:0)+(a.gzhead.name?8:0)+(a.gzhead.comment?16:0)),wt(a,255&a.gzhead.time),wt(a,a.gzhead.time>>8&255),wt(a,a.gzhead.time>>16&255),wt(a,a.gzhead.time>>24&255),wt(a,9===a.level?2:a.strategy>=at||a.level<2?4:0),wt(a,255&a.gzhead.os),a.gzhead.extra&&a.gzhead.extra.length&&(wt(a,255&a.gzhead.extra.length),wt(a,a.gzhead.extra.length>>8&255)),a.gzhead.hcrc&&(t.adler=N(t.adler,a.pending_buf,a.pending,0)),a.gzindex=0,a.status=69;else if(wt(a,0),wt(a,0),wt(a,0),wt(a,0),wt(a,0),wt(a,9===a.level?2:a.strategy>=at||a.level<2?4:0),wt(a,3),a.status=113,ct(t),0!==a.pending)return a.last_flush=-1,q;if(69===a.status){if(a.gzhead.extra){let e=a.pending,i=(65535&a.gzhead.extra.length)-a.gzindex;for(;a.pending+i>a.pending_buf_size;){let n=a.pending_buf_size-a.pending;if(a.pending_buf.set(a.gzhead.extra.subarray(a.gzindex,a.gzindex+n),a.pending),a.pending=a.pending_buf_size,a.gzhead.hcrc&&a.pending>e&&(t.adler=N(t.adler,a.pending_buf,a.pending-e,e)),a.gzindex+=n,ct(t),0!==a.pending)return a.last_flush=-1,q;e=0,i-=n}let n=new Uint8Array(a.gzhead.extra);a.pending_buf.set(n.subarray(a.gzindex,a.gzindex+i),a.pending),a.pending+=i,a.gzhead.hcrc&&a.pending>e&&(t.adler=N(t.adler,a.pending_buf,a.pending-e,e)),a.gzindex=0}a.status=73}if(73===a.status){if(a.gzhead.name){let e,i=a.pending;do{if(a.pending===a.pending_buf_size){if(a.gzhead.hcrc&&a.pending>i&&(t.adler=N(t.adler,a.pending_buf,a.pending-i,i)),ct(t),0!==a.pending)return a.last_flush=-1,q;i=0}e=a.gzindex<a.gzhead.name.length?255&a.gzhead.name.charCodeAt(a.gzindex++):0,wt(a,e)}while(0!==e);a.gzhead.hcrc&&a.pending>i&&(t.adler=N(t.adler,a.pending_buf,a.pending-i,i)),a.gzindex=0}a.status=91}if(91===a.status){if(a.gzhead.comment){let e,i=a.pending;do{if(a.pending===a.pending_buf_size){if(a.gzhead.hcrc&&a.pending>i&&(t.adler=N(t.adler,a.pending_buf,a.pending-i,i)),ct(t),0!==a.pending)return a.last_flush=-1,q;i=0}e=a.gzindex<a.gzhead.comment.length?255&a.gzhead.comment.charCodeAt(a.gzindex++):0,wt(a,e)}while(0!==e);a.gzhead.hcrc&&a.pending>i&&(t.adler=N(t.adler,a.pending_buf,a.pending-i,i))}a.status=103}if(103===a.status){if(a.gzhead.hcrc){if(a.pending+2>a.pending_buf_size&&(ct(t),0!==a.pending))return a.last_flush=-1,q;wt(a,255&t.adler),wt(a,t.adler>>8&255),t.adler=0}if(a.status=113,ct(t),0!==a.pending)return a.last_flush=-1,q}if(0!==t.avail_in||0!==a.lookahead||e!==P&&666!==a.status){let i=0===a.level?kt(a,e):a.strategy===at?((t,e)=>{let a;for(;;){if(0===t.lookahead&&(pt(t),0===t.lookahead)){if(e===P)return 1;break}if(t.match_length=0,a=j(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++,a&&(ut(t,!1),0===t.strm.avail_out))return 1}return t.insert=0,e===X?(ut(t,!0),0===t.strm.avail_out?3:4):t.sym_next&&(ut(t,!1),0===t.strm.avail_out)?1:2})(a,e):a.strategy===it?((t,e)=>{let a,i,n,s;const r=t.window;for(;;){if(t.lookahead<=258){if(pt(t),t.lookahead<=258&&e===P)return 1;if(0===t.lookahead)break}if(t.match_length=0,t.lookahead>=3&&t.strstart>0&&(n=t.strstart-1,i=r[n],i===r[++n]&&i===r[++n]&&i===r[++n])){s=t.strstart+258;do{}while(i===r[++n]&&i===r[++n]&&i===r[++n]&&i===r[++n]&&i===r[++n]&&i===r[++n]&&i===r[++n]&&i===r[++n]&&n<s);t.match_length=258-(s-n),t.match_length>t.lookahead&&(t.match_length=t.lookahead)}if(t.match_length>=3?(a=j(t,1,t.match_length-3),t.lookahead-=t.match_length,t.strstart+=t.match_length,t.match_length=0):(a=j(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++),a&&(ut(t,!1),0===t.strm.avail_out))return 1}return t.insert=0,e===X?(ut(t,!0),0===t.strm.avail_out?3:4):t.sym_next&&(ut(t,!1),0===t.strm.avail_out)?1:2})(a,e):zt[a.level].func(a,e);if(3!==i&&4!==i||(a.status=666),1===i||3===i)return 0===t.avail_out&&(a.last_flush=-1),q;if(2===i&&(e===Y?K(a):e!==W&&(H(a,0,0,!1),e===G&&(dt(a.head),0===a.lookahead&&(a.strstart=0,a.block_start=0,a.insert=0))),ct(t),0===t.avail_out))return a.last_flush=-1,q}return e!==X?q:a.wrap<=0?J:(2===a.wrap?(wt(a,255&t.adler),wt(a,t.adler>>8&255),wt(a,t.adler>>16&255),wt(a,t.adler>>24&255),wt(a,255&t.total_in),wt(a,t.total_in>>8&255),wt(a,t.total_in>>16&255),wt(a,t.total_in>>24&255)):(mt(a,t.adler>>>16),mt(a,65535&t.adler)),ct(t),a.wrap>0&&(a.wrap=-a.wrap),0!==a.pending?q:J)},deflateEnd:t=>{if(Et(t))return Q;const e=t.state.status;return t.state=null,113===e?lt(t,V):q},deflateSetDictionary:(t,e)=>{let a=e.length;if(Et(t))return Q;const i=t.state,n=i.wrap;if(2===n||1===n&&42!==i.status||i.lookahead)return Q;if(1===n&&(t.adler=F(t.adler,e,a,0)),i.wrap=0,a>=i.w_size){0===n&&(dt(i.head),i.strstart=0,i.block_start=0,i.insert=0);let t=new Uint8Array(i.w_size);t.set(e.subarray(a-i.w_size,a),0),e=t,a=i.w_size}const s=t.avail_in,r=t.next_in,o=t.input;for(t.avail_in=a,t.next_in=0,t.input=e,pt(i);i.lookahead>=3;){let t=i.strstart,e=i.lookahead-2;do{i.ins_h=ft(i,i.ins_h,i.window[t+3-1]),i.prev[t&i.w_mask]=i.head[i.ins_h],i.head[i.ins_h]=t,t++}while(--e);i.strstart=t,i.lookahead=2,pt(i)}return i.strstart+=i.lookahead,i.block_start=i.strstart,i.insert=i.lookahead,i.lookahead=0,i.match_length=i.prev_length=2,i.match_available=0,t.next_in=r,t.input=o,t.avail_in=s,i.wrap=n,q},deflateInfo:"pako deflate (from Nodeca project)"};const Dt=(t,e)=>Object.prototype.hasOwnProperty.call(t,e);var Tt=function(t){const e=Array.prototype.slice.call(arguments,1);for(;e.length;){const a=e.shift();if(a){if("object"!=typeof a)throw new TypeError(a+"must be non-object");for(const e in a)Dt(a,e)&&(t[e]=a[e])}}return t},Ot=t=>{let e=0;for(let a=0,i=t.length;a<i;a++)e+=t[a].length;const a=new Uint8Array(e);for(let e=0,i=0,n=t.length;e<n;e++){let n=t[e];a.set(n,i),i+=n.length}return a};let Ft=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(t){Ft=!1}const Lt=new Uint8Array(256);for(let t=0;t<256;t++)Lt[t]=t>=252?6:t>=248?5:t>=240?4:t>=224?3:t>=192?2:1;Lt[254]=Lt[254]=1;var Nt=t=>{if("function"==typeof TextEncoder&&TextEncoder.prototype.encode)return(new TextEncoder).encode(t);let e,a,i,n,s,r=t.length,o=0;for(n=0;n<r;n++)a=t.charCodeAt(n),55296==(64512&a)&&n+1<r&&(i=t.charCodeAt(n+1),56320==(64512&i)&&(a=65536+(a-55296<<10)+(i-56320),n++)),o+=a<128?1:a<2048?2:a<65536?3:4;for(e=new Uint8Array(o),s=0,n=0;s<o;n++)a=t.charCodeAt(n),55296==(64512&a)&&n+1<r&&(i=t.charCodeAt(n+1),56320==(64512&i)&&(a=65536+(a-55296<<10)+(i-56320),n++)),a<128?e[s++]=a:a<2048?(e[s++]=192|a>>>6,e[s++]=128|63&a):a<65536?(e[s++]=224|a>>>12,e[s++]=128|a>>>6&63,e[s++]=128|63&a):(e[s++]=240|a>>>18,e[s++]=128|a>>>12&63,e[s++]=128|a>>>6&63,e[s++]=128|63&a);return e},It=(t,e)=>{const a=e||t.length;if("function"==typeof TextDecoder&&TextDecoder.prototype.decode)return(new TextDecoder).decode(t.subarray(0,e));let i,n;const s=new Array(2*a);for(n=0,i=0;i<a;){let e=t[i++];if(e<128){s[n++]=e;continue}let r=Lt[e];if(r>4)s[n++]=65533,i+=r-1;else{for(e&=2===r?31:3===r?15:7;r>1&&i<a;)e=e<<6|63&t[i++],r--;r>1?s[n++]=65533:e<65536?s[n++]=e:(e-=65536,s[n++]=55296|e>>10&1023,s[n++]=56320|1023&e)}}return((t,e)=>{if(e<65534&&t.subarray&&Ft)return String.fromCharCode.apply(null,t.length===e?t:t.subarray(0,e));let a="";for(let i=0;i<e;i++)a+=String.fromCharCode(t[i]);return a})(s,n)},Bt=(t,e)=>{(e=e||t.length)>t.length&&(e=t.length);let a=e-1;for(;a>=0&&128==(192&t[a]);)a--;return a<0||0===a?e:a+Lt[t[a]]>e?a:e};var Ct=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0};const Ht=Object.prototype.toString,{Z_NO_FLUSH:Mt,Z_SYNC_FLUSH:jt,Z_FULL_FLUSH:Kt,Z_FINISH:Pt,Z_OK:Yt,Z_STREAM_END:Gt,Z_DEFAULT_COMPRESSION:Xt,Z_DEFAULT_STRATEGY:Wt,Z_DEFLATED:qt}=B;function Jt(t){this.options=Tt({level:Xt,method:qt,chunkSize:16384,windowBits:15,memLevel:8,strategy:Wt},t||{});let e=this.options;e.raw&&e.windowBits>0?e.windowBits=-e.windowBits:e.gzip&&e.windowBits>0&&e.windowBits<16&&(e.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Ct,this.strm.avail_out=0;let a=St.deflateInit2(this.strm,e.level,e.method,e.windowBits,e.memLevel,e.strategy);if(a!==Yt)throw new Error(I[a]);if(e.header&&St.deflateSetHeader(this.strm,e.header),e.dictionary){let t;if(t="string"==typeof e.dictionary?Nt(e.dictionary):"[object ArrayBuffer]"===Ht.call(e.dictionary)?new Uint8Array(e.dictionary):e.dictionary,a=St.deflateSetDictionary(this.strm,t),a!==Yt)throw new Error(I[a]);this._dict_set=!0}}function Qt(t,e){const a=new Jt(e);if(a.push(t,!0),a.err)throw a.msg||I[a.err];return a.result}Jt.prototype.push=function(t,e){const a=this.strm,i=this.options.chunkSize;let n,s;if(this.ended)return!1;for(s=e===~~e?e:!0===e?Pt:Mt,"string"==typeof t?a.input=Nt(t):"[object ArrayBuffer]"===Ht.call(t)?a.input=new Uint8Array(t):a.input=t,a.next_in=0,a.avail_in=a.input.length;;)if(0===a.avail_out&&(a.output=new Uint8Array(i),a.next_out=0,a.avail_out=i),(s===jt||s===Kt)&&a.avail_out<=6)this.onData(a.output.subarray(0,a.next_out)),a.avail_out=0;else{if(n=St.deflate(a,s),n===Gt)return a.next_out>0&&this.onData(a.output.subarray(0,a.next_out)),n=St.deflateEnd(this.strm),this.onEnd(n),this.ended=!0,n===Yt;if(0!==a.avail_out){if(s>0&&a.next_out>0)this.onData(a.output.subarray(0,a.next_out)),a.avail_out=0;else if(0===a.avail_in)break}else this.onData(a.output)}return!0},Jt.prototype.onData=function(t){this.chunks.push(t)},Jt.prototype.onEnd=function(t){t===Yt&&(this.result=Ot(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg};var Vt={Deflate:Jt,deflate:Qt,deflateRaw:function(t,e){return(e=e||{}).raw=!0,Qt(t,e)},gzip:function(t,e){return(e=e||{}).gzip=!0,Qt(t,e)},constants:B};var $t=function(t,e){let a,i,n,s,r,o,l,h,d,_,f,c,u,w,m,b,g,p,k,v,y,x,z,A;const E=t.state;a=t.next_in,z=t.input,i=a+(t.avail_in-5),n=t.next_out,A=t.output,s=n-(e-t.avail_out),r=n+(t.avail_out-257),o=E.dmax,l=E.wsize,h=E.whave,d=E.wnext,_=E.window,f=E.hold,c=E.bits,u=E.lencode,w=E.distcode,m=(1<<E.lenbits)-1,b=(1<<E.distbits)-1;t:do{c<15&&(f+=z[a++]<<c,c+=8,f+=z[a++]<<c,c+=8),g=u[f&m];e:for(;;){if(p=g>>>24,f>>>=p,c-=p,p=g>>>16&255,0===p)A[n++]=65535&g;else{if(!(16&p)){if(0==(64&p)){g=u[(65535&g)+(f&(1<<p)-1)];continue e}if(32&p){E.mode=16191;break t}t.msg="invalid literal/length code",E.mode=16209;break t}k=65535&g,p&=15,p&&(c<p&&(f+=z[a++]<<c,c+=8),k+=f&(1<<p)-1,f>>>=p,c-=p),c<15&&(f+=z[a++]<<c,c+=8,f+=z[a++]<<c,c+=8),g=w[f&b];a:for(;;){if(p=g>>>24,f>>>=p,c-=p,p=g>>>16&255,!(16&p)){if(0==(64&p)){g=w[(65535&g)+(f&(1<<p)-1)];continue a}t.msg="invalid distance code",E.mode=16209;break t}if(v=65535&g,p&=15,c<p&&(f+=z[a++]<<c,c+=8,c<p&&(f+=z[a++]<<c,c+=8)),v+=f&(1<<p)-1,v>o){t.msg="invalid distance too far back",E.mode=16209;break t}if(f>>>=p,c-=p,p=n-s,v>p){if(p=v-p,p>h&&E.sane){t.msg="invalid distance too far back",E.mode=16209;break t}if(y=0,x=_,0===d){if(y+=l-p,p<k){k-=p;do{A[n++]=_[y++]}while(--p);y=n-v,x=A}}else if(d<p){if(y+=l+d-p,p-=d,p<k){k-=p;do{A[n++]=_[y++]}while(--p);if(y=0,d<k){p=d,k-=p;do{A[n++]=_[y++]}while(--p);y=n-v,x=A}}}else if(y+=d-p,p<k){k-=p;do{A[n++]=_[y++]}while(--p);y=n-v,x=A}for(;k>2;)A[n++]=x[y++],A[n++]=x[y++],A[n++]=x[y++],k-=3;k&&(A[n++]=x[y++],k>1&&(A[n++]=x[y++]))}else{y=n-v;do{A[n++]=A[y++],A[n++]=A[y++],A[n++]=A[y++],k-=3}while(k>2);k&&(A[n++]=A[y++],k>1&&(A[n++]=A[y++]))}break}}break}}while(a<i&&n<r);k=c>>3,a-=k,c-=k<<3,f&=(1<<c)-1,t.next_in=a,t.next_out=n,t.avail_in=a<i?i-a+5:5-(a-i),t.avail_out=n<r?r-n+257:257-(n-r),E.hold=f,E.bits=c};const te=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),ee=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),ae=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),ie=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]);var ne=(t,e,a,i,n,s,r,o)=>{const l=o.bits;let h,d,_,f,c,u,w=0,m=0,b=0,g=0,p=0,k=0,v=0,y=0,x=0,z=0,A=null;const E=new Uint16Array(16),R=new Uint16Array(16);let Z,U,S,D=null;for(w=0;w<=15;w++)E[w]=0;for(m=0;m<i;m++)E[e[a+m]]++;for(p=l,g=15;g>=1&&0===E[g];g--);if(p>g&&(p=g),0===g)return n[s++]=20971520,n[s++]=20971520,o.bits=1,0;for(b=1;b<g&&0===E[b];b++);for(p<b&&(p=b),y=1,w=1;w<=15;w++)if(y<<=1,y-=E[w],y<0)return-1;if(y>0&&(0===t||1!==g))return-1;for(R[1]=0,w=1;w<15;w++)R[w+1]=R[w]+E[w];for(m=0;m<i;m++)0!==e[a+m]&&(r[R[e[a+m]]++]=m);if(0===t?(A=D=r,u=20):1===t?(A=te,D=ee,u=257):(A=ae,D=ie,u=0),z=0,m=0,w=b,c=s,k=p,v=0,_=-1,x=1<<p,f=x-1,1===t&&x>852||2===t&&x>592)return 1;for(;;){Z=w-v,r[m]+1<u?(U=0,S=r[m]):r[m]>=u?(U=D[r[m]-u],S=A[r[m]-u]):(U=96,S=0),h=1<<w-v,d=1<<k,b=d;do{d-=h,n[c+(z>>v)+d]=Z<<24|U<<16|S|0}while(0!==d);for(h=1<<w-1;z&h;)h>>=1;if(0!==h?(z&=h-1,z+=h):z=0,m++,0==--E[w]){if(w===g)break;w=e[a+r[m]]}if(w>p&&(z&f)!==_){for(0===v&&(v=p),c+=b,k=w-v,y=1<<k;k+v<g&&(y-=E[k+v],!(y<=0));)k++,y<<=1;if(x+=1<<k,1===t&&x>852||2===t&&x>592)return 1;_=z&f,n[_]=p<<24|k<<16|c-s|0}}return 0!==z&&(n[c+z]=w-v<<24|64<<16|0),o.bits=p,0};const{Z_FINISH:se,Z_BLOCK:re,Z_TREES:oe,Z_OK:le,Z_STREAM_END:he,Z_NEED_DICT:de,Z_STREAM_ERROR:_e,Z_DATA_ERROR:fe,Z_MEM_ERROR:ce,Z_BUF_ERROR:ue,Z_DEFLATED:we}=B,me=16209,be=t=>(t>>>24&255)+(t>>>8&65280)+((65280&t)<<8)+((255&t)<<24);function ge(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const pe=t=>{if(!t)return 1;const e=t.state;return!e||e.strm!==t||e.mode<16180||e.mode>16211?1:0},ke=t=>{if(pe(t))return _e;const e=t.state;return t.total_in=t.total_out=e.total=0,t.msg="",e.wrap&&(t.adler=1&e.wrap),e.mode=16180,e.last=0,e.havedict=0,e.flags=-1,e.dmax=32768,e.head=null,e.hold=0,e.bits=0,e.lencode=e.lendyn=new Int32Array(852),e.distcode=e.distdyn=new Int32Array(592),e.sane=1,e.back=-1,le},ve=t=>{if(pe(t))return _e;const e=t.state;return e.wsize=0,e.whave=0,e.wnext=0,ke(t)},ye=(t,e)=>{let a;if(pe(t))return _e;const i=t.state;return e<0?(a=0,e=-e):(a=5+(e>>4),e<48&&(e&=15)),e&&(e<8||e>15)?_e:(null!==i.window&&i.wbits!==e&&(i.window=null),i.wrap=a,i.wbits=e,ve(t))},xe=(t,e)=>{if(!t)return _e;const a=new ge;t.state=a,a.strm=t,a.window=null,a.mode=16180;const i=ye(t,e);return i!==le&&(t.state=null),i};let ze,Ae,Ee=!0;const Re=t=>{if(Ee){ze=new Int32Array(512),Ae=new Int32Array(32);let e=0;for(;e<144;)t.lens[e++]=8;for(;e<256;)t.lens[e++]=9;for(;e<280;)t.lens[e++]=7;for(;e<288;)t.lens[e++]=8;for(ne(1,t.lens,0,288,ze,0,t.work,{bits:9}),e=0;e<32;)t.lens[e++]=5;ne(2,t.lens,0,32,Ae,0,t.work,{bits:5}),Ee=!1}t.lencode=ze,t.lenbits=9,t.distcode=Ae,t.distbits=5},Ze=(t,e,a,i)=>{let n;const s=t.state;return null===s.window&&(s.wsize=1<<s.wbits,s.wnext=0,s.whave=0,s.window=new Uint8Array(s.wsize)),i>=s.wsize?(s.window.set(e.subarray(a-s.wsize,a),0),s.wnext=0,s.whave=s.wsize):(n=s.wsize-s.wnext,n>i&&(n=i),s.window.set(e.subarray(a-i,a-i+n),s.wnext),(i-=n)?(s.window.set(e.subarray(a-i,a),0),s.wnext=i,s.whave=s.wsize):(s.wnext+=n,s.wnext===s.wsize&&(s.wnext=0),s.whave<s.wsize&&(s.whave+=n))),0};var Ue={inflateReset:ve,inflateReset2:ye,inflateResetKeep:ke,inflateInit:t=>xe(t,15),inflateInit2:xe,inflate:(t,e)=>{let a,i,n,s,r,o,l,h,d,_,f,c,u,w,m,b,g,p,k,v,y,x,z=0;const A=new Uint8Array(4);let E,R;const Z=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(pe(t)||!t.output||!t.input&&0!==t.avail_in)return _e;a=t.state,16191===a.mode&&(a.mode=16192),r=t.next_out,n=t.output,l=t.avail_out,s=t.next_in,i=t.input,o=t.avail_in,h=a.hold,d=a.bits,_=o,f=l,x=le;t:for(;;)switch(a.mode){case 16180:if(0===a.wrap){a.mode=16192;break}for(;d<16;){if(0===o)break t;o--,h+=i[s++]<<d,d+=8}if(2&a.wrap&&35615===h){0===a.wbits&&(a.wbits=15),a.check=0,A[0]=255&h,A[1]=h>>>8&255,a.check=N(a.check,A,2,0),h=0,d=0,a.mode=16181;break}if(a.head&&(a.head.done=!1),!(1&a.wrap)||(((255&h)<<8)+(h>>8))%31){t.msg="incorrect header check",a.mode=me;break}if((15&h)!==we){t.msg="unknown compression method",a.mode=me;break}if(h>>>=4,d-=4,y=8+(15&h),0===a.wbits&&(a.wbits=y),y>15||y>a.wbits){t.msg="invalid window size",a.mode=me;break}a.dmax=1<<a.wbits,a.flags=0,t.adler=a.check=1,a.mode=512&h?16189:16191,h=0,d=0;break;case 16181:for(;d<16;){if(0===o)break t;o--,h+=i[s++]<<d,d+=8}if(a.flags=h,(255&a.flags)!==we){t.msg="unknown compression method",a.mode=me;break}if(57344&a.flags){t.msg="unknown header flags set",a.mode=me;break}a.head&&(a.head.text=h>>8&1),512&a.flags&&4&a.wrap&&(A[0]=255&h,A[1]=h>>>8&255,a.check=N(a.check,A,2,0)),h=0,d=0,a.mode=16182;case 16182:for(;d<32;){if(0===o)break t;o--,h+=i[s++]<<d,d+=8}a.head&&(a.head.time=h),512&a.flags&&4&a.wrap&&(A[0]=255&h,A[1]=h>>>8&255,A[2]=h>>>16&255,A[3]=h>>>24&255,a.check=N(a.check,A,4,0)),h=0,d=0,a.mode=16183;case 16183:for(;d<16;){if(0===o)break t;o--,h+=i[s++]<<d,d+=8}a.head&&(a.head.xflags=255&h,a.head.os=h>>8),512&a.flags&&4&a.wrap&&(A[0]=255&h,A[1]=h>>>8&255,a.check=N(a.check,A,2,0)),h=0,d=0,a.mode=16184;case 16184:if(1024&a.flags){for(;d<16;){if(0===o)break t;o--,h+=i[s++]<<d,d+=8}a.length=h,a.head&&(a.head.extra_len=h),512&a.flags&&4&a.wrap&&(A[0]=255&h,A[1]=h>>>8&255,a.check=N(a.check,A,2,0)),h=0,d=0}else a.head&&(a.head.extra=null);a.mode=16185;case 16185:if(1024&a.flags&&(c=a.length,c>o&&(c=o),c&&(a.head&&(y=a.head.extra_len-a.length,a.head.extra||(a.head.extra=new Uint8Array(a.head.extra_len)),a.head.extra.set(i.subarray(s,s+c),y)),512&a.flags&&4&a.wrap&&(a.check=N(a.check,i,c,s)),o-=c,s+=c,a.length-=c),a.length))break t;a.length=0,a.mode=16186;case 16186:if(2048&a.flags){if(0===o)break t;c=0;do{y=i[s+c++],a.head&&y&&a.length<65536&&(a.head.name+=String.fromCharCode(y))}while(y&&c<o);if(512&a.flags&&4&a.wrap&&(a.check=N(a.check,i,c,s)),o-=c,s+=c,y)break t}else a.head&&(a.head.name=null);a.length=0,a.mode=16187;case 16187:if(4096&a.flags){if(0===o)break t;c=0;do{y=i[s+c++],a.head&&y&&a.length<65536&&(a.head.comment+=String.fromCharCode(y))}while(y&&c<o);if(512&a.flags&&4&a.wrap&&(a.check=N(a.check,i,c,s)),o-=c,s+=c,y)break t}else a.head&&(a.head.comment=null);a.mode=16188;case 16188:if(512&a.flags){for(;d<16;){if(0===o)break t;o--,h+=i[s++]<<d,d+=8}if(4&a.wrap&&h!==(65535&a.check)){t.msg="header crc mismatch",a.mode=me;break}h=0,d=0}a.head&&(a.head.hcrc=a.flags>>9&1,a.head.done=!0),t.adler=a.check=0,a.mode=16191;break;case 16189:for(;d<32;){if(0===o)break t;o--,h+=i[s++]<<d,d+=8}t.adler=a.check=be(h),h=0,d=0,a.mode=16190;case 16190:if(0===a.havedict)return t.next_out=r,t.avail_out=l,t.next_in=s,t.avail_in=o,a.hold=h,a.bits=d,de;t.adler=a.check=1,a.mode=16191;case 16191:if(e===re||e===oe)break t;case 16192:if(a.last){h>>>=7&d,d-=7&d,a.mode=16206;break}for(;d<3;){if(0===o)break t;o--,h+=i[s++]<<d,d+=8}switch(a.last=1&h,h>>>=1,d-=1,3&h){case 0:a.mode=16193;break;case 1:if(Re(a),a.mode=16199,e===oe){h>>>=2,d-=2;break t}break;case 2:a.mode=16196;break;case 3:t.msg="invalid block type",a.mode=me}h>>>=2,d-=2;break;case 16193:for(h>>>=7&d,d-=7&d;d<32;){if(0===o)break t;o--,h+=i[s++]<<d,d+=8}if((65535&h)!=(h>>>16^65535)){t.msg="invalid stored block lengths",a.mode=me;break}if(a.length=65535&h,h=0,d=0,a.mode=16194,e===oe)break t;case 16194:a.mode=16195;case 16195:if(c=a.length,c){if(c>o&&(c=o),c>l&&(c=l),0===c)break t;n.set(i.subarray(s,s+c),r),o-=c,s+=c,l-=c,r+=c,a.length-=c;break}a.mode=16191;break;case 16196:for(;d<14;){if(0===o)break t;o--,h+=i[s++]<<d,d+=8}if(a.nlen=257+(31&h),h>>>=5,d-=5,a.ndist=1+(31&h),h>>>=5,d-=5,a.ncode=4+(15&h),h>>>=4,d-=4,a.nlen>286||a.ndist>30){t.msg="too many length or distance symbols",a.mode=me;break}a.have=0,a.mode=16197;case 16197:for(;a.have<a.ncode;){for(;d<3;){if(0===o)break t;o--,h+=i[s++]<<d,d+=8}a.lens[Z[a.have++]]=7&h,h>>>=3,d-=3}for(;a.have<19;)a.lens[Z[a.have++]]=0;if(a.lencode=a.lendyn,a.lenbits=7,E={bits:a.lenbits},x=ne(0,a.lens,0,19,a.lencode,0,a.work,E),a.lenbits=E.bits,x){t.msg="invalid code lengths set",a.mode=me;break}a.have=0,a.mode=16198;case 16198:for(;a.have<a.nlen+a.ndist;){for(;z=a.lencode[h&(1<<a.lenbits)-1],m=z>>>24,b=z>>>16&255,g=65535&z,!(m<=d);){if(0===o)break t;o--,h+=i[s++]<<d,d+=8}if(g<16)h>>>=m,d-=m,a.lens[a.have++]=g;else{if(16===g){for(R=m+2;d<R;){if(0===o)break t;o--,h+=i[s++]<<d,d+=8}if(h>>>=m,d-=m,0===a.have){t.msg="invalid bit length repeat",a.mode=me;break}y=a.lens[a.have-1],c=3+(3&h),h>>>=2,d-=2}else if(17===g){for(R=m+3;d<R;){if(0===o)break t;o--,h+=i[s++]<<d,d+=8}h>>>=m,d-=m,y=0,c=3+(7&h),h>>>=3,d-=3}else{for(R=m+7;d<R;){if(0===o)break t;o--,h+=i[s++]<<d,d+=8}h>>>=m,d-=m,y=0,c=11+(127&h),h>>>=7,d-=7}if(a.have+c>a.nlen+a.ndist){t.msg="invalid bit length repeat",a.mode=me;break}for(;c--;)a.lens[a.have++]=y}}if(a.mode===me)break;if(0===a.lens[256]){t.msg="invalid code -- missing end-of-block",a.mode=me;break}if(a.lenbits=9,E={bits:a.lenbits},x=ne(1,a.lens,0,a.nlen,a.lencode,0,a.work,E),a.lenbits=E.bits,x){t.msg="invalid literal/lengths set",a.mode=me;break}if(a.distbits=6,a.distcode=a.distdyn,E={bits:a.distbits},x=ne(2,a.lens,a.nlen,a.ndist,a.distcode,0,a.work,E),a.distbits=E.bits,x){t.msg="invalid distances set",a.mode=me;break}if(a.mode=16199,e===oe)break t;case 16199:a.mode=16200;case 16200:if(o>=6&&l>=258){t.next_out=r,t.avail_out=l,t.next_in=s,t.avail_in=o,a.hold=h,a.bits=d,$t(t,f),r=t.next_out,n=t.output,l=t.avail_out,s=t.next_in,i=t.input,o=t.avail_in,h=a.hold,d=a.bits,16191===a.mode&&(a.back=-1);break}for(a.back=0;z=a.lencode[h&(1<<a.lenbits)-1],m=z>>>24,b=z>>>16&255,g=65535&z,!(m<=d);){if(0===o)break t;o--,h+=i[s++]<<d,d+=8}if(b&&0==(240&b)){for(p=m,k=b,v=g;z=a.lencode[v+((h&(1<<p+k)-1)>>p)],m=z>>>24,b=z>>>16&255,g=65535&z,!(p+m<=d);){if(0===o)break t;o--,h+=i[s++]<<d,d+=8}h>>>=p,d-=p,a.back+=p}if(h>>>=m,d-=m,a.back+=m,a.length=g,0===b){a.mode=16205;break}if(32&b){a.back=-1,a.mode=16191;break}if(64&b){t.msg="invalid literal/length code",a.mode=me;break}a.extra=15&b,a.mode=16201;case 16201:if(a.extra){for(R=a.extra;d<R;){if(0===o)break t;o--,h+=i[s++]<<d,d+=8}a.length+=h&(1<<a.extra)-1,h>>>=a.extra,d-=a.extra,a.back+=a.extra}a.was=a.length,a.mode=16202;case 16202:for(;z=a.distcode[h&(1<<a.distbits)-1],m=z>>>24,b=z>>>16&255,g=65535&z,!(m<=d);){if(0===o)break t;o--,h+=i[s++]<<d,d+=8}if(0==(240&b)){for(p=m,k=b,v=g;z=a.distcode[v+((h&(1<<p+k)-1)>>p)],m=z>>>24,b=z>>>16&255,g=65535&z,!(p+m<=d);){if(0===o)break t;o--,h+=i[s++]<<d,d+=8}h>>>=p,d-=p,a.back+=p}if(h>>>=m,d-=m,a.back+=m,64&b){t.msg="invalid distance code",a.mode=me;break}a.offset=g,a.extra=15&b,a.mode=16203;case 16203:if(a.extra){for(R=a.extra;d<R;){if(0===o)break t;o--,h+=i[s++]<<d,d+=8}a.offset+=h&(1<<a.extra)-1,h>>>=a.extra,d-=a.extra,a.back+=a.extra}if(a.offset>a.dmax){t.msg="invalid distance too far back",a.mode=me;break}a.mode=16204;case 16204:if(0===l)break t;if(c=f-l,a.offset>c){if(c=a.offset-c,c>a.whave&&a.sane){t.msg="invalid distance too far back",a.mode=me;break}c>a.wnext?(c-=a.wnext,u=a.wsize-c):u=a.wnext-c,c>a.length&&(c=a.length),w=a.window}else w=n,u=r-a.offset,c=a.length;c>l&&(c=l),l-=c,a.length-=c;do{n[r++]=w[u++]}while(--c);0===a.length&&(a.mode=16200);break;case 16205:if(0===l)break t;n[r++]=a.length,l--,a.mode=16200;break;case 16206:if(a.wrap){for(;d<32;){if(0===o)break t;o--,h|=i[s++]<<d,d+=8}if(f-=l,t.total_out+=f,a.total+=f,4&a.wrap&&f&&(t.adler=a.check=a.flags?N(a.check,n,f,r-f):F(a.check,n,f,r-f)),f=l,4&a.wrap&&(a.flags?h:be(h))!==a.check){t.msg="incorrect data check",a.mode=me;break}h=0,d=0}a.mode=16207;case 16207:if(a.wrap&&a.flags){for(;d<32;){if(0===o)break t;o--,h+=i[s++]<<d,d+=8}if(4&a.wrap&&h!==(4294967295&a.total)){t.msg="incorrect length check",a.mode=me;break}h=0,d=0}a.mode=16208;case 16208:x=he;break t;case me:x=fe;break t;case 16210:return ce;default:return _e}return t.next_out=r,t.avail_out=l,t.next_in=s,t.avail_in=o,a.hold=h,a.bits=d,(a.wsize||f!==t.avail_out&&a.mode<me&&(a.mode<16206||e!==se))&&Ze(t,t.output,t.next_out,f-t.avail_out),_-=t.avail_in,f-=t.avail_out,t.total_in+=_,t.total_out+=f,a.total+=f,4&a.wrap&&f&&(t.adler=a.check=a.flags?N(a.check,n,f,t.next_out-f):F(a.check,n,f,t.next_out-f)),t.data_type=a.bits+(a.last?64:0)+(16191===a.mode?128:0)+(16199===a.mode||16194===a.mode?256:0),(0===_&&0===f||e===se)&&x===le&&(x=ue),x},inflateEnd:t=>{if(pe(t))return _e;let e=t.state;return e.window&&(e.window=null),t.state=null,le},inflateGetHeader:(t,e)=>{if(pe(t))return _e;const a=t.state;return 0==(2&a.wrap)?_e:(a.head=e,e.done=!1,le)},inflateSetDictionary:(t,e)=>{const a=e.length;let i,n,s;return pe(t)?_e:(i=t.state,0!==i.wrap&&16190!==i.mode?_e:16190===i.mode&&(n=1,n=F(n,e,a,0),n!==i.check)?fe:(s=Ze(t,e,a,a),s?(i.mode=16210,ce):(i.havedict=1,le)))},inflateInfo:"pako inflate (from Nodeca project)"};var Se=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1};const De=Object.prototype.toString,{Z_NO_FLUSH:Te,Z_FINISH:Oe,Z_OK:Fe,Z_STREAM_END:Le,Z_NEED_DICT:Ne,Z_STREAM_ERROR:Ie,Z_DATA_ERROR:Be,Z_MEM_ERROR:Ce}=B;function He(t){this.options=Tt({chunkSize:65536,windowBits:15,to:""},t||{});const e=this.options;e.raw&&e.windowBits>=0&&e.windowBits<16&&(e.windowBits=-e.windowBits,0===e.windowBits&&(e.windowBits=-15)),!(e.windowBits>=0&&e.windowBits<16)||t&&t.windowBits||(e.windowBits+=32),e.windowBits>15&&e.windowBits<48&&0==(15&e.windowBits)&&(e.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Ct,this.strm.avail_out=0;let a=Ue.inflateInit2(this.strm,e.windowBits);if(a!==Fe)throw new Error(I[a]);if(this.header=new Se,Ue.inflateGetHeader(this.strm,this.header),e.dictionary&&("string"==typeof e.dictionary?e.dictionary=Nt(e.dictionary):"[object ArrayBuffer]"===De.call(e.dictionary)&&(e.dictionary=new Uint8Array(e.dictionary)),e.raw&&(a=Ue.inflateSetDictionary(this.strm,e.dictionary),a!==Fe)))throw new Error(I[a])}He.prototype.push=function(t,e){const a=this.strm,i=this.options.chunkSize,n=this.options.dictionary;let s,r,o;if(this.ended)return!1;for(r=e===~~e?e:!0===e?Oe:Te,"[object ArrayBuffer]"===De.call(t)?a.input=new Uint8Array(t):a.input=t,a.next_in=0,a.avail_in=a.input.length;;){for(0===a.avail_out&&(a.output=new Uint8Array(i),a.next_out=0,a.avail_out=i),s=Ue.inflate(a,r),s===Ne&&n&&(s=Ue.inflateSetDictionary(a,n),s===Fe?s=Ue.inflate(a,r):s===Be&&(s=Ne));a.avail_in>0&&s===Le&&a.state.wrap>0&&0!==t[a.next_in];)Ue.inflateReset(a),s=Ue.inflate(a,r);switch(s){case Ie:case Be:case Ne:case Ce:return this.onEnd(s),this.ended=!0,!1}if(o=a.avail_out,a.next_out&&(0===a.avail_out||s===Le))if("string"===this.options.to){let t=Bt(a.output,a.next_out),e=a.next_out-t,n=It(a.output,t);a.next_out=e,a.avail_out=i-e,e&&a.output.set(a.output.subarray(t,t+e),0),this.onData(n)}else this.onData(a.output.length===a.next_out?a.output:a.output.subarray(0,a.next_out));if(s!==Fe||0!==o){if(s===Le)return s=Ue.inflateEnd(this.strm),this.onEnd(s),this.ended=!0,!0;if(0===a.avail_in)break}}return!0},He.prototype.onData=function(t){this.chunks.push(t)},He.prototype.onEnd=function(t){t===Fe&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=Ot(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg};const{Deflate:Me,deflate:je,deflateRaw:Ke,gzip:Pe}=Vt;var Ye=Me,Ge=je,Xe=B;const We=new class{constructor(){this._init()}clear(){this._init()}addEvent(t){if(!t)throw new Error("Adding invalid event");const e=this._hasEvents?",":"";this.deflate.push(e+t,Xe.Z_SYNC_FLUSH),this._hasEvents=!0}finish(){if(this.deflate.push("]",Xe.Z_FINISH),this.deflate.err)throw this.deflate.err;const t=this.deflate.result;return this._init(),t}_init(){this._hasEvents=!1,this.deflate=new Ye,this.deflate.push("[",Xe.Z_NO_FLUSH)}},qe={clear:()=>{We.clear()},addEvent:t=>We.addEvent(t),finish:()=>We.finish(),compress:t=>function(t){return Ge(t)}(t)};addEventListener("message",(function(t){const e=t.data.method,a=t.data.id,i=t.data.arg;if(e in qe&&"function"==typeof qe[e])try{const t=qe[e](i);postMessage({id:a,method:e,success:!0,response:t})}catch(t){postMessage({id:a,method:e,success:!1,response:t.message}),console.error(t)}})),postMessage({id:void 0,method:"init",success:!0,response:void 0});`;function a4(){const e=new Blob([s4]);return URL.createObjectURL(e)}function mr(e,t){(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&(st.info(e),t&&$2(e))}function _l(e,t){(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&(st.info(e),t&&setTimeout(()=>{$2(e)},0))}function $2(e){_n().addBreadcrumb({category:"console",data:{logger:"replay"},level:"info",message:e},{level:"info"})}class s0 extends Error{constructor(){super(`Event buffer exceeded maximum size of ${n0}.`)}}class V2{constructor(){this.events=[],this._totalSize=0,this.hasCheckout=!1}get hasEvents(){return this.events.length>0}get type(){return"sync"}destroy(){this.events=[]}async addEvent(t){const i=JSON.stringify(t).length;if(this._totalSize+=i,this._totalSize>n0)throw new s0;this.events.push(t)}finish(){return new Promise(t=>{const i=this.events;this.clear(),t(JSON.stringify(i))})}clear(){this.events=[],this._totalSize=0,this.hasCheckout=!1}getEarliestTimestamp(){const t=this.events.map(i=>i.timestamp).sort()[0];return t?i0(t):null}}class o4{constructor(t){this._worker=t,this._id=0}ensureReady(){return this._ensureReadyPromise?this._ensureReadyPromise:(this._ensureReadyPromise=new Promise((t,i)=>{this._worker.addEventListener("message",({data:a})=>{a.success?t():i()},{once:!0}),this._worker.addEventListener("error",a=>{i(a)},{once:!0})}),this._ensureReadyPromise)}destroy(){mr("[Replay] Destroying compression worker"),this._worker.terminate()}postMessage(t,i){const a=this._getAndIncrementId();return new Promise((u,d)=>{const p=({data:l})=>{const b=l;if(b.method===t&&b.id===a){if(this._worker.removeEventListener("message",p),!b.success){(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&st.error("[Replay]",b.response),d(new Error("Error in compression worker"));return}u(b.response)}};this._worker.addEventListener("message",p),this._worker.postMessage({id:a,method:t,arg:i})})}_getAndIncrementId(){return this._id++}}class l4{constructor(t){this._worker=new o4(t),this._earliestTimestamp=null,this._totalSize=0,this.hasCheckout=!1}get hasEvents(){return!!this._earliestTimestamp}get type(){return"worker"}ensureReady(){return this._worker.ensureReady()}destroy(){this._worker.destroy()}addEvent(t){const i=i0(t.timestamp);(!this._earliestTimestamp||i<this._earliestTimestamp)&&(this._earliestTimestamp=i);const a=JSON.stringify(t);return this._totalSize+=a.length,this._totalSize>n0?Promise.reject(new s0):this._sendEventToWorker(a)}finish(){return this._finishRequest()}clear(){this._earliestTimestamp=null,this._totalSize=0,this.hasCheckout=!1,this._worker.postMessage("clear")}getEarliestTimestamp(){return this._earliestTimestamp}_sendEventToWorker(t){return this._worker.postMessage("addEvent",t)}async _finishRequest(){const t=await this._worker.postMessage("finish");return this._earliestTimestamp=null,this._totalSize=0,t}}class c4{constructor(t){this._fallback=new V2,this._compression=new l4(t),this._used=this._fallback,this._ensureWorkerIsLoadedPromise=this._ensureWorkerIsLoaded()}get type(){return this._used.type}get hasEvents(){return this._used.hasEvents}get hasCheckout(){return this._used.hasCheckout}set hasCheckout(t){this._used.hasCheckout=t}destroy(){this._fallback.destroy(),this._compression.destroy()}clear(){return this._used.clear()}getEarliestTimestamp(){return this._used.getEarliestTimestamp()}addEvent(t){return this._used.addEvent(t)}async finish(){return await this.ensureWorkerIsLoaded(),this._used.finish()}ensureWorkerIsLoaded(){return this._ensureWorkerIsLoadedPromise}async _ensureWorkerIsLoaded(){try{await this._compression.ensureReady()}catch{mr("[Replay] Failed to load the compression worker, falling back to simple buffer");return}await this._switchToCompressionWorker()}async _switchToCompressionWorker(){const{events:t,hasCheckout:i}=this._fallback,a=[];for(const u of t)a.push(this._compression.addEvent(u));this._compression.hasCheckout=i,this._used=this._compression;try{await Promise.all(a)}catch(u){(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&st.warn("[Replay] Failed to add events when switching buffers.",u)}}}function u4({useCompression:e}){if(e&&window.Worker)try{const t=a4();mr("[Replay] Using compression worker");const i=new Worker(t);return new c4(i)}catch{mr("[Replay] Failed to create compression worker")}return mr("[Replay] Using simple buffer"),new V2}function a0(){try{return"sessionStorage"in An&&!!An.sessionStorage}catch{return!1}}function h4(e){d4(),e.session=void 0}function d4(){if(a0())try{An.sessionStorage.removeItem(e0)}catch{}}function Iy(e,t,i=+new Date){return e===null||t===void 0||t<0?!0:t===0?!1:e+t<=i}function j2(e,t,i=+new Date){return Iy(e.started,t.maxSessionLife,i)||Iy(e.lastActivity,t.sessionIdleExpire,i)}function G2(e){return e===void 0?!1:Math.random()<e}function o0(e){if(a0())try{An.sessionStorage.setItem(e0,JSON.stringify(e))}catch{}}function l0(e){const t=Date.now(),i=e.id||Dr(),a=e.started||t,u=e.lastActivity||t,d=e.segmentId||0,p=e.sampled,l=typeof e.shouldRefresh=="boolean"?e.shouldRefresh:!0;return{id:i,started:a,lastActivity:u,segmentId:d,sampled:p,shouldRefresh:l}}function f4(e,t){return G2(e)?"session":t?"buffer":!1}function p4({sessionSampleRate:e,allowBuffering:t,stickySession:i=!1}){const a=f4(e,t),u=l0({sampled:a});return i&&o0(u),u}function m4(e){if(!a0())return null;try{const t=An.sessionStorage.getItem(e0);if(!t)return null;const i=JSON.parse(t);return _l("[Replay] Loading existing session",e),l0(i)}catch{return null}}function m_({timeouts:e,currentSession:t,stickySession:i,sessionSampleRate:a,allowBuffering:u,traceInternals:d}){const p=t||i&&m4(d);if(p){if(!j2(p,e)||u&&p.shouldRefresh)return{type:"saved",session:p};if(p.shouldRefresh)_l("[Replay] Session has expired",d);else{const w=l0({sampled:!1});return _l("[Replay] Session should not be refreshed",d),{type:"new",session:w}}}const l=p4({stickySession:i,sessionSampleRate:a,allowBuffering:u});return _l("[Replay] Created new session",d),{type:"new",session:l}}function g4(e){return e.type===Vn.Custom}async function Hp(e,t,i){if(!e.eventBuffer||e.isPaused())return null;const a=i0(t.timestamp);if(a+e.timeouts.sessionIdlePause<Date.now())return null;if(a>e.getContext().initialTimestamp+e.timeouts.maxSessionLife)return mr(`[Replay] Skipping event with timestamp ${a} because it is after maxSessionLife`,e.getOptions()._experiments.traceInternals),null;try{i&&e.recordingMode==="buffer"&&e.eventBuffer.clear(),i&&(e.eventBuffer.hasCheckout=!0);const u=e.getOptions(),d=_4(t,u.beforeAddRecordingEvent);return d?await e.eventBuffer.addEvent(d):void 0}catch(u){const d=u&&u instanceof s0?"addEventSizeExceeded":"addEvent";(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&st.error(u),await e.stop({reason:d});const p=_n().getClient();p&&p.recordDroppedEvent("internal_sdk_error","replay")}}function _4(e,t){try{if(typeof t=="function"&&g4(e))return t(e)}catch(i){return(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&st.error("[Replay] An error occured in the `beforeAddRecordingEvent` callback, skipping the event...",i),null}return e}function q2(e){return!e.type}function ky(e){return e.type==="transaction"}function y4(e){return e.type==="replay_event"}function H2(e){const t=b4();return(i,a)=>{if(!e.isEnabled()||!q2(i)&&!ky(i))return;const u=a&&a.statusCode;if(!(t&&(!u||u<200||u>=300))){if(ky(i)){v4(e,i);return}x4(e,i)}}}function v4(e,t){const i=e.getContext();t.contexts&&t.contexts.trace&&t.contexts.trace.trace_id&&i.traceIds.size<100&&i.traceIds.add(t.contexts.trace.trace_id)}function x4(e,t){const i=e.getContext();t.event_id&&i.errorIds.size<100&&i.errorIds.add(t.event_id),e.recordingMode==="buffer"&&t.tags&&t.tags.replayId&&setTimeout(()=>{e.sendBufferedReplayOrFlush()})}function b4(){const e=_n().getClient();if(!e)return!1;const t=e.getTransport();return t&&t.send.__sentry__baseTransport__||!1}function w4(e,t){return e.type||!e.exception||!e.exception.values||!e.exception.values.length?!1:t.originalException&&t.originalException.__rrweb__?!0:e.exception.values.some(i=>!i.stacktrace||!i.stacktrace.frames||!i.stacktrace.frames.length?!1:i.stacktrace.frames.some(a=>a.filename&&a.filename.includes("/rrweb/src/")))}function S4(e,t){return e.recordingMode!=="buffer"||t.message===t0||!t.exception||t.type?!1:G2(e.getOptions().errorSampleRate)}function E4(e,t=!1){const i=t?H2(e):void 0;return(a,u)=>e.isEnabled()?y4(a)?(delete a.breadcrumbs,a):!q2(a)&&!ky(a)?a:w4(a,u)&&!e.getOptions()._experiments.captureExceptions?((typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&st.log("[Replay] Ignoring error from rrweb internals",a),null):((S4(e,a)||e.recordingMode==="session")&&(a.tags={...a.tags,replayId:e.getSessionId()}),i&&i(a,{statusCode:200}),a):a}function Mm(e,t){return t.map(({type:i,start:a,end:u,name:d,data:p})=>{const l=e.throttledAddEvent({type:Vn.Custom,timestamp:a,data:{tag:"performanceSpan",payload:{op:i,description:d,startTimestamp:a,endTimestamp:u,data:p}}});return typeof l=="string"?Promise.resolve(null):l})}function T4(e){const{from:t,to:i}=e,a=Date.now()/1e3;return{type:"navigation.push",start:a,end:a,name:i,data:{previous:t}}}function C4(e){return t=>{if(!e.isEnabled())return;const i=T4(t);i!==null&&(e.getContext().urls.push(i.name),e.triggerUserActivity(),e.addUpdate(()=>(Mm(e,[i]),!1)))}}function I4(e,t){return(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&e.getOptions()._experiments.traceInternals?!1:k4(t)}function k4(e){const t=_n().getClient(),i=t&&t.getDsn();return i?e.includes(i.host):!1}function Dm(e,t){e.isEnabled()&&t!==null&&(I4(e,t.name)||e.addUpdate(()=>(Mm(e,[t]),!0)))}function A4(e){const{startTimestamp:t,endTimestamp:i,fetchData:a,response:u}=e;if(!i)return null;const{method:d,url:p}=a;return{type:"resource.fetch",start:t/1e3,end:i/1e3,name:p,data:{method:d,statusCode:u?u.status:void 0}}}function P4(e){return t=>{if(!e.isEnabled())return;const i=A4(t);Dm(e,i)}}function R4(e){const{startTimestamp:t,endTimestamp:i,xhr:a}=e,u=a[vo];if(!t||!i||!u)return null;const{method:d,url:p,status_code:l}=u;return p===void 0?null:{type:"resource.xhr",name:p,start:t/1e3,end:i/1e3,data:{method:d,statusCode:l}}}function M4(e){return t=>{if(!e.isEnabled())return;const i=R4(t);Dm(e,i)}}const xo=10,c0=11,Ay=12,Na=13,Py=14,Zc=15,Ra=20,Ss=21,Ry=22,Yc=23,W2=["true","false","null"];function D4(e,t){if(!t.length)return e;let i=e;const a=t.length-1,u=t[a];i=L4(i,u);for(let d=a;d>=0;d--)switch(t[d]){case xo:i=`${i}}`;break;case Ra:i=`${i}]`;break}return i}function L4(e,t){switch(t){case xo:return`${e}"~~":"~~"`;case c0:return`${e}:"~~"`;case Ay:return`${e}~~":"~~"`;case Na:return B4(e);case Py:return`${e}~~"`;case Zc:return`${e},"~~":"~~"`;case Ra:return`${e}"~~"`;case Ss:return z4(e);case Ry:return`${e}~~"`;case Yc:return`${e},"~~"`}return e}function z4(e){const t=O4(e);if(t>-1){const i=e.slice(t+1);return W2.includes(i.trim())?`${e},"~~"`:`${e.slice(0,t+1)}"~~"`}return e}function O4(e){for(let t=e.length-1;t>=0;t--){const i=e[t];if(i===","||i==="[")return t}return-1}function B4(e){const t=e.lastIndexOf(":"),i=e.slice(t+1);return W2.includes(i.trim())?`${e},"~~":"~~"`:`${e.slice(0,t+1)}"~~"`}function F4(e){const t=[];for(let i=0;i<e.length;i++)N4(t,e,i);return t}function N4(e,t,i){const a=e[e.length-1],u=t[i];if(!/\s/.test(u)){if(u==='"'&&!Z2(t,i)){U4(e,a);return}switch(u){case"{":$4(e,a);break;case"[":V4(e,a);break;case":":j4(e,a);break;case",":G4(e,a);break;case"}":q4(e,a);break;case"]":H4(e,a);break}}}function U4(e,t){if(t===Py){e.pop(),e.push(Zc);return}if(t===Ry){e.pop(),e.push(Yc);return}if(t===Na){e.push(Py);return}if(t===Ss){e.push(Ry);return}if(t===xo){e.push(Ay);return}if(t===Ay){e.pop(),e.push(c0);return}}function $4(e,t){if(!t){e.push(xo);return}if(t===Na){e.push(xo);return}if(t===Ss&&e.push(xo),t===Ra){e.push(xo);return}}function V4(e,t){if(!t){e.push(Ra),e.push(Ss);return}if(t===Na){e.push(Ra),e.push(Ss);return}if(t===Ss&&(e.push(Ra),e.push(Ss)),t===Ra){e.push(Ra),e.push(Ss);return}}function j4(e,t){t===c0&&(e.pop(),e.push(Na))}function G4(e,t){if(t===Na){e.pop();return}if(t===Zc){e.pop(),e.pop();return}if(t!==Ss&&t===Yc){e.pop();return}}function q4(e,t){t===xo&&e.pop(),t===Na&&(e.pop(),e.pop()),t===Zc&&(e.pop(),e.pop(),e.pop()),e[e.length-1]===Na&&e.push(Zc),e[e.length-1]===Ss&&e.push(Yc)}function H4(e,t){t===Ra&&e.pop(),t===Ss&&(e.pop(),e.pop()),t===Yc&&(e.pop(),e.pop(),e.pop()),e[e.length-1]===Na&&e.push(Zc),e[e.length-1]===Ss&&e.push(Yc)}function Z2(e,t){return e[t-1]==="\\"&&!Z2(e,t-1)}function Y2(e){const t=F4(e);return D4(e,t)}function Wp(e,t){if(e)try{if(typeof e=="string")return t.encode(e).length;if(e instanceof URLSearchParams)return t.encode(e.toString()).length;if(e instanceof FormData){const i=Q2(e);return t.encode(i).length}if(e instanceof Blob)return e.size;if(e instanceof ArrayBuffer)return e.byteLength}catch{}}function X2(e){if(!e)return;const t=parseInt(e,10);return isNaN(t)?void 0:t}function K2(e){if(typeof e=="string")return e;if(e instanceof URLSearchParams)return e.toString();if(e instanceof FormData)return Q2(e)}function J2(e,t){if(!t)return null;const{startTimestamp:i,endTimestamp:a,url:u,method:d,statusCode:p,request:l,response:b}=t;return{type:e,start:i/1e3,end:a/1e3,name:u,data:da({method:d,statusCode:p,request:l,response:b})}}function fd(e){return{headers:{},size:e,_meta:{warnings:["URL_SKIPPED"]}}}function bo(e,t,i){if(!t&&Object.keys(e).length===0)return;if(!t)return{headers:e};if(!i)return{headers:e,size:t};const a={headers:e,size:t},{body:u,warnings:d}=W4(i);return a.body=u,d.length>0&&(a._meta={warnings:d}),a}function My(e,t){return Object.keys(e).reduce((i,a)=>{const u=a.toLowerCase();return t.includes(u)&&e[a]&&(i[u]=e[a]),i},{})}function Q2(e){return new URLSearchParams(e).toString()}function W4(e){if(!e||typeof e!="string")return{body:e,warnings:[]};const t=e.length>Kf;if(Z4(e))try{const i=t?Y2(e.slice(0,Kf)):e;return{body:JSON.parse(i),warnings:t?["JSON_TRUNCATED"]:[]}}catch{return{body:t?`${e.slice(0,Kf)}`:e,warnings:t?["INVALID_JSON","TEXT_TRUNCATED"]:["INVALID_JSON"]}}return{body:t?`${e.slice(0,Kf)}`:e,warnings:t?["TEXT_TRUNCATED"]:[]}}function Z4(e){const t=e[0],i=e[e.length-1];return t==="["&&i==="]"||t==="{"&&i==="}"}function Zp(e,t){const i=Y4(e);return du(i,t)}function Y4(e,t=An.document.baseURI){if(e.startsWith("http://")||e.startsWith("https://")||e.startsWith(An.location.origin))return e;const i=new URL(e,t);if(i.origin!==new URL(t).origin)return e;const a=i.href;return!e.endsWith("/")&&a.endsWith("/")?a.slice(0,-1):a}async function X4(e,t,i){try{const a=await J4(e,t,i),u=J2("resource.fetch",a);Dm(i.replay,u)}catch(a){(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&st.error("[Replay] Failed to capture fetch breadcrumb",a)}}function K4(e,t,i){const{input:a,response:u}=t,d=eC(a),p=Wp(d,i.textEncoder),l=u?X2(u.headers.get("content-length")):void 0;p!==void 0&&(e.data.request_body_size=p),l!==void 0&&(e.data.response_body_size=l)}async function J4(e,t,i){const{startTimestamp:a,endTimestamp:u}=t,{url:d,method:p,status_code:l=0,request_body_size:b,response_body_size:w}=e.data,C=Zp(d,i.networkDetailAllowUrls)&&!Zp(d,i.networkDetailDenyUrls),I=C?Q4(i,t.input,b):fd(b),M=await e6(C,i,t.response,w);return{startTimestamp:a,endTimestamp:u,url:d,method:p,statusCode:l,request:I,response:M}}function Q4({networkCaptureBodies:e,networkRequestHeaders:t},i,a){const u=n6(i,t);if(!e)return bo(u,a,void 0);const d=eC(i),p=K2(d);return bo(u,a,p)}async function e6(e,{networkCaptureBodies:t,textEncoder:i,networkResponseHeaders:a},u,d){if(!e&&d!==void 0)return fd(d);const p=tC(u.headers,a);if(!t&&d!==void 0)return bo(p,d,void 0);try{const l=u.clone(),b=await t6(l),w=b&&b.length&&d===void 0?Wp(b,i):d;return e?t?bo(p,w,b):bo(p,w,void 0):fd(w)}catch{return bo(p,d,void 0)}}async function t6(e){try{return await e.text()}catch{return}}function eC(e=[]){if(!(e.length!==2||typeof e[1]!="object"))return e[1].body}function tC(e,t){const i={};return t.forEach(a=>{e.get(a)&&(i[a]=e.get(a))}),i}function n6(e,t){return e.length===1&&typeof e[0]!="string"?Cw(e[0],t):e.length===2?Cw(e[1],t):{}}function Cw(e,t){if(!e)return{};const i=e.headers;return i?i instanceof Headers?tC(i,t):Array.isArray(i)?{}:My(i,t):{}}async function i6(e,t,i){try{const a=s6(e,t,i),u=J2("resource.xhr",a);Dm(i.replay,u)}catch(a){(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&st.error("[Replay] Failed to capture fetch breadcrumb",a)}}function r6(e,t,i){const{xhr:a,input:u}=t,d=Wp(u,i.textEncoder),p=a.getResponseHeader("content-length")?X2(a.getResponseHeader("content-length")):Wp(a.response,i.textEncoder);d!==void 0&&(e.data.request_body_size=d),p!==void 0&&(e.data.response_body_size=p)}function s6(e,t,i){const{startTimestamp:a,endTimestamp:u,input:d,xhr:p}=t,{url:l,method:b,status_code:w=0,request_body_size:C,response_body_size:I}=e.data;if(!l)return null;if(!Zp(l,i.networkDetailAllowUrls)||Zp(l,i.networkDetailDenyUrls)){const ce=fd(C),ve=fd(I);return{startTimestamp:a,endTimestamp:u,url:l,method:b,statusCode:w,request:ce,response:ve}}const M=p[vo],O=M?My(M.request_headers,i.networkRequestHeaders):{},j=My(a6(p),i.networkResponseHeaders),Z=bo(O,C,i.networkCaptureBodies?K2(d):void 0),ue=bo(j,I,i.networkCaptureBodies?t.xhr.responseText:void 0);return{startTimestamp:a,endTimestamp:u,url:l,method:b,statusCode:w,request:Z,response:ue}}function a6(e){const t=e.getAllResponseHeaders();return t?t.split(`\r
`).reduce((i,a)=>{const[u,d]=a.split(": ");return i[u.toLowerCase()]=d,i},{}):{}}function o6(e){const t=_n().getClient();try{const i=new TextEncoder,{networkDetailAllowUrls:a,networkDetailDenyUrls:u,networkCaptureBodies:d,networkRequestHeaders:p,networkResponseHeaders:l}=e.getOptions(),b={replay:e,textEncoder:i,networkDetailAllowUrls:a,networkDetailDenyUrls:u,networkCaptureBodies:d,networkRequestHeaders:p,networkResponseHeaders:l};t&&t.on?t.on("beforeAddBreadcrumb",(w,C)=>l6(b,w,C)):(cr("fetch",P4(e)),cr("xhr",M4(e)))}catch{}}function l6(e,t,i){if(t.data)try{c6(t)&&h6(i)&&(r6(t,i,e),i6(t,i,e)),u6(t)&&d6(i)&&(K4(t,i,e),X4(t,i,e))}catch{(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&st.warn("Error when enriching network breadcrumb")}}function c6(e){return e.category==="xhr"}function u6(e){return e.category==="fetch"}function h6(e){return e&&e.xhr}function d6(e){return e&&e.response}let Iw=null;function f6(e){return!!e.category}const p6=e=>t=>{if(!e.isEnabled())return;const i=m6(t);i&&Rm(e,i)};function m6(e){const t=e.getLastBreadcrumb&&e.getLastBreadcrumb();return Iw===t||!t||(Iw=t,!f6(t)||["fetch","xhr","sentry.event","sentry.transaction"].includes(t.category)||t.category.startsWith("ui."))?null:t.category==="console"?g6(t):Ma(t)}function g6(e){const t=e.data&&e.data.arguments;if(!Array.isArray(t)||t.length===0)return Ma(e);let i=!1;const a=t.map(u=>{if(!u)return u;if(typeof u=="string")return u.length>Jf?(i=!0,`${u.slice(0,Jf)}`):u;if(typeof u=="object")try{const d=aa(u,7),p=JSON.stringify(d);if(p.length>Jf){const l=Y2(p.slice(0,Jf)),b=JSON.parse(l);return i=!0,b}return d}catch{}return u});return Ma({...e,data:{...e.data,arguments:a,...i?{_meta:{warnings:["CONSOLE_ARG_TRUNCATED"]}}:{}}})}function _6(e){const t=_n().getScope(),i=_n().getClient();t&&t.addScopeListener(p6(e)),cr("dom",YU(e)),cr("history",C4(e)),o6(e),Yv(E4(e,!kw(i))),kw(i)&&(i.on("afterSendEvent",H2(e)),i.on("createDsc",a=>{const u=e.getSessionId();u&&e.isEnabled()&&e.recordingMode==="session"&&(a.replay_id=u)}),i.on("startTransaction",a=>{e.lastTransaction=a}),i.on("finishTransaction",a=>{e.lastTransaction=a}))}function kw(e){return!!(e&&e.on)}async function y6(e){try{return Promise.all(Mm(e,[v6(An.performance.memory)]))}catch{return[]}}function v6(e){const{jsHeapSizeLimit:t,totalJSHeapSize:i,usedJSHeapSize:a}=e,u=Date.now()/1e3;return{type:"memory",name:"memory",start:u,end:u,data:{memory:{jsHeapSizeLimit:t,totalJSHeapSize:i,usedJSHeapSize:a}}}}const Aw={resource:E6,paint:w6,navigation:S6,["largest-contentful-paint"]:T6};function x6(e){return e.map(b6).filter(Boolean)}function b6(e){return Aw[e.entryType]===void 0?null:Aw[e.entryType](e)}function Xc(e){return((qs||An.performance.timeOrigin)+e)/1e3}function w6(e){const{duration:t,entryType:i,name:a,startTime:u}=e,d=Xc(u);return{type:i,name:a,start:d,end:d+t,data:void 0}}function S6(e){const{entryType:t,name:i,decodedBodySize:a,duration:u,domComplete:d,encodedBodySize:p,domContentLoadedEventStart:l,domContentLoadedEventEnd:b,domInteractive:w,loadEventStart:C,loadEventEnd:I,redirectCount:M,startTime:O,transferSize:j,type:Z}=e;return u===0?null:{type:`${t}.${Z}`,start:Xc(O),end:Xc(d),name:i,data:{size:j,decodedBodySize:a,encodedBodySize:p,duration:u,domInteractive:w,domContentLoadedEventStart:l,domContentLoadedEventEnd:b,loadEventStart:C,loadEventEnd:I,domComplete:d,redirectCount:M}}}function E6(e){const{entryType:t,initiatorType:i,name:a,responseEnd:u,startTime:d,decodedBodySize:p,encodedBodySize:l,responseStatus:b,transferSize:w}=e;return["fetch","xmlhttprequest"].includes(i)?null:{type:`${t}.${i}`,start:Xc(d),end:Xc(u),name:a,data:{size:w,statusCode:b,decodedBodySize:p,encodedBodySize:l}}}function T6(e){const{entryType:t,startTime:i,size:a}=e;let u=0;if(An.performance){const l=An.performance.getEntriesByType("navigation")[0];u=l&&l.activationStart||0}const d=Math.max(i-u,0),p=Xc(u)+d/1e3;return{type:t,name:t,start:p,end:p,data:{value:d,size:a,nodeId:bl.mirror.getId(e.element)}}}function C6(e,t,i){let a,u,d;const p=i&&i.maxWait?Math.max(i.maxWait,t):0;function l(){return b(),a=e(),a}function b(){u!==void 0&&clearTimeout(u),d!==void 0&&clearTimeout(d),u=d=void 0}function w(){return u!==void 0||d!==void 0?l():a}function C(){return u&&clearTimeout(u),u=setTimeout(l,t),p&&d===void 0&&(d=setTimeout(l,p)),a}return C.cancel=b,C.flush=w,C}function I6(e){let t=!1;return(i,a)=>{if(!e.checkAndHandleExpiredSession()){(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&st.warn("[Replay] Received replay event after session expired.");return}const u=a||!t;t=!0,e.addUpdate(()=>{if(e.recordingMode==="buffer"&&u&&e.setInitialState(),Hp(e,i,u),!u)return!1;if(A6(e,u),e.session&&e.session.previousSessionId)return!0;if(e.recordingMode==="buffer"&&e.session&&e.eventBuffer){const d=e.eventBuffer.getEarliestTimestamp();d&&(mr(`[Replay] Updating session start time to earliest event in buffer to ${new Date(d)}`,e.getOptions()._experiments.traceInternals),e.session.started=d,e.getOptions().stickySession&&o0(e.session))}return e.recordingMode==="session"&&e.flush(),!0})}}function k6(e){const t=e.getOptions();return{type:Vn.Custom,timestamp:Date.now(),data:{tag:"options",payload:{sessionSampleRate:t.sessionSampleRate,errorSampleRate:t.errorSampleRate,useCompressionOption:t.useCompression,blockAllMedia:t.blockAllMedia,maskAllText:t.maskAllText,maskAllInputs:t.maskAllInputs,useCompression:e.eventBuffer?e.eventBuffer.type==="worker":!1,networkDetailHasUrls:t.networkDetailAllowUrls.length>0,networkCaptureBodies:t.networkCaptureBodies,networkRequestHasHeaders:t.networkRequestHeaders.length>0,networkResponseHasHeaders:t.networkResponseHeaders.length>0}}}}function A6(e,t){return!t||!e.session||e.session.segmentId!==0?Promise.resolve(null):Hp(e,k6(e),!1)}function P6(e,t,i,a){return fu(n2(e,Wv(e),a,i),[[{type:"replay_event"},e],[{type:"replay_recording",length:typeof t=="string"?new TextEncoder().encode(t).length:t.length},t]])}function R6({recordingData:e,headers:t}){let i;const a=`${JSON.stringify(t)}
`;if(typeof e=="string")i=`${a}${e}`;else{const d=new TextEncoder().encode(a);i=new Uint8Array(d.length+e.length),i.set(d),i.set(e,d.length)}return i}async function M6({client:e,scope:t,replayId:i,event:a}){const u=typeof e._integrations=="object"&&e._integrations!==null&&!Array.isArray(e._integrations)?Object.keys(e._integrations):void 0,d=await h2(e.getOptions(),a,{event_id:i,integrations:u},t);if(!d)return null;d.platform=d.platform||"javascript";const p=e.getSdkMetadata&&e.getSdkMetadata(),{name:l,version:b}=p&&p.sdk||{};return d.sdk={...d.sdk,name:l||"sentry.javascript.unknown",version:b||"0.0.0"},d}async function D6({recordingData:e,replayId:t,segmentId:i,eventContext:a,timestamp:u,session:d}){const p=R6({recordingData:e,headers:{segment_id:i}}),{urls:l,errorIds:b,traceIds:w,initialTimestamp:C}=a,I=_n(),M=I.getClient(),O=I.getScope(),j=M&&M.getTransport(),Z=M&&M.getDsn();if(!M||!j||!Z||!d.sampled)return;const ue={type:I3,replay_start_timestamp:C/1e3,timestamp:u/1e3,error_ids:b,trace_ids:w,urls:l,replay_id:t,segment_id:i,replay_type:d.sampled},ce=await M6({scope:O,client:M,replayId:t,event:ue});if(!ce){M.recordDroppedEvent("event_processor","replay",ue),mr("An event processor returned `null`, will not send event.");return}delete ce.sdkProcessingMetadata;const ve=P6(ce,p,Z,M.getOptions().tunnel);let ye;try{ye=await j.send(ve)}catch(Ae){const Be=new Error(t0);try{Be.cause=Ae}catch{}throw Be}if(!ye)return ye;if(typeof ye.statusCode=="number"&&(ye.statusCode<200||ye.statusCode>=300))throw new nC(ye.statusCode);return ye}class nC extends Error{constructor(t){super(`Transport returned status code ${t}`)}}async function iC(e,t={count:0,interval:L3}){const{recordingData:i,options:a}=e;if(i.length)try{return await D6(e),!0}catch(u){if(u instanceof nC)throw u;if(G5("Replays",{_retryCount:t.count}),(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&a._experiments&&a._experiments.captureExceptions&&Tm(u),t.count>=z3){const d=new Error(`${t0} - max retries exceeded`);try{d.cause=u}catch{}throw d}return t.interval*=++t.count,new Promise((d,p)=>{setTimeout(async()=>{try{await iC(e,t),d(!0)}catch(l){p(l)}},t.interval)})}}const rC="__THROTTLED",L6="__SKIPPED";function z6(e,t,i){const a=new Map,u=l=>{const b=l-i;a.forEach((w,C)=>{C<b&&a.delete(C)})},d=()=>[...a.values()].reduce((l,b)=>l+b,0);let p=!1;return(...l)=>{const b=Math.floor(Date.now()/1e3);if(u(b),d()>=t){const C=p;return p=!0,C?L6:rC}p=!1;const w=a.get(b)||0;return a.set(b,w+1),e(...l)}}class go{constructor({options:t,recordingOptions:i}){go.prototype.__init.call(this),go.prototype.__init2.call(this),go.prototype.__init3.call(this),go.prototype.__init4.call(this),go.prototype.__init5.call(this),go.prototype.__init6.call(this),this.eventBuffer=null,this.performanceEvents=[],this.recordingMode="session",this.timeouts={sessionIdlePause:k3,sessionIdleExpire:A3,maxSessionLife:P3},this._lastActivity=Date.now(),this._isEnabled=!1,this._isPaused=!1,this._hasInitializedCoreListeners=!1,this._context={errorIds:new Set,traceIds:new Set,urls:[],initialTimestamp:Date.now(),initialUrl:""},this._recordingOptions=i,this._options=t,this._debouncedFlush=C6(()=>this._flush(),this._options.flushMinDelay,{maxWait:this._options.flushMaxDelay}),this._throttledAddEvent=z6((p,l)=>Hp(this,p,l),300,5);const{slowClickTimeout:a,slowClickIgnoreSelectors:u}=this.getOptions(),d=a?{threshold:Math.min(O3,a),timeout:a,scrollTimeout:B3,ignoreSelector:u?u.join(","):""}:void 0;d&&(this.clickDetector=new jU(this,d))}getContext(){return this._context}isEnabled(){return this._isEnabled}isPaused(){return this._isPaused}getOptions(){return this._options}initializeSampling(){const{errorSampleRate:t,sessionSampleRate:i}=this._options;if(!(t<=0&&i<=0||!this._loadAndCheckSession())){if(!this.session){this._handleException(new Error("Unable to initialize and create session"));return}this.session.sampled&&this.session.sampled!=="session"&&(this.recordingMode="buffer"),_l(`[Replay] Starting replay in ${this.recordingMode} mode`,this._options._experiments.traceInternals),this._initializeRecording()}}start(){if(this._isEnabled&&this.recordingMode==="session")throw new Error("Replay recording is already in progress");if(this._isEnabled&&this.recordingMode==="buffer")throw new Error("Replay buffering is in progress, call `flush()` to save the replay");_l("[Replay] Starting replay in session mode",this._options._experiments.traceInternals);const t=this.session&&this.session.id,{session:i}=m_({timeouts:this.timeouts,stickySession:!!this._options.stickySession,currentSession:this.session,sessionSampleRate:1,allowBuffering:!1,traceInternals:this._options._experiments.traceInternals});i.previousSessionId=t,this.session=i,this._initializeRecording()}startBuffering(){if(this._isEnabled)throw new Error("Replay recording is already in progress");_l("[Replay] Starting replay in buffer mode",this._options._experiments.traceInternals);const t=this.session&&this.session.id,{session:i}=m_({timeouts:this.timeouts,stickySession:!!this._options.stickySession,currentSession:this.session,sessionSampleRate:0,allowBuffering:!0,traceInternals:this._options._experiments.traceInternals});i.previousSessionId=t,this.session=i,this.recordingMode="buffer",this._initializeRecording()}startRecording(){try{this._stopRecording=bl({...this._recordingOptions,...this.recordingMode==="buffer"&&{checkoutEveryNms:D3},emit:I6(this),onMutation:this._onMutationHandler})}catch(t){this._handleException(t)}}stopRecording(){try{return this._stopRecording&&(this._stopRecording(),this._stopRecording=void 0),!0}catch(t){return this._handleException(t),!1}}async stop({forceFlush:t=!1,reason:i}={}){if(this._isEnabled)try{mr(`[Replay] Stopping Replay${i?` triggered by ${i}`:""}`,this._options._experiments.traceInternals),this._isEnabled=!1,this._removeListeners(),this.stopRecording(),this._debouncedFlush.cancel(),t&&await this._flush({force:!0}),this.eventBuffer&&this.eventBuffer.destroy(),this.eventBuffer=null,h4(this)}catch(a){this._handleException(a)}}pause(){this._isPaused||(this._isPaused=!0,this.stopRecording(),mr("[Replay] Pausing replay",this._options._experiments.traceInternals))}resume(){!this._isPaused||!this._loadAndCheckSession()||(this._isPaused=!1,this.startRecording(),mr("[Replay] Resuming replay",this._options._experiments.traceInternals))}async sendBufferedReplayOrFlush({continueRecording:t=!0}={}){if(this.recordingMode==="session")return this.flushImmediate();const i=Date.now();mr("[Replay] Converting buffer to session",this._options._experiments.traceInternals),await this.flushImmediate();const a=this.stopRecording();!t||!a||this.recordingMode!=="session"&&(this.recordingMode="session",this.session&&(this.session.shouldRefresh=!1,this._updateUserActivity(i),this._updateSessionActivity(i),this._maybeSaveSession()),this.startRecording())}addUpdate(t){const i=t();this.recordingMode!=="buffer"&&i!==!0&&this._debouncedFlush()}triggerUserActivity(){if(this._updateUserActivity(),!this._stopRecording){if(!this._loadAndCheckSession())return;this.resume();return}this.checkAndHandleExpiredSession(),this._updateSessionActivity()}updateUserActivity(){this._updateUserActivity(),this._updateSessionActivity()}conditionalFlush(){return this.recordingMode==="buffer"?Promise.resolve():this.flushImmediate()}flush(){return this._debouncedFlush()}flushImmediate(){return this._debouncedFlush(),this._debouncedFlush.flush()}cancelFlush(){this._debouncedFlush.cancel()}getSessionId(){return this.session&&this.session.id}checkAndHandleExpiredSession(){const t=this.getSessionId();if(this._lastActivity&&Iy(this._lastActivity,this.timeouts.sessionIdlePause)&&this.session&&this.session.sampled==="session"){this.pause();return}return this._loadAndCheckSession()?t!==this.getSessionId()?(this._triggerFullSnapshot(),!1):!0:void 0}setInitialState(){const t=`${An.location.pathname}${An.location.hash}${An.location.search}`,i=`${An.location.origin}${t}`;this.performanceEvents=[],this._clearContext(),this._context.initialUrl=i,this._context.initialTimestamp=Date.now(),this._context.urls.push(i)}throttledAddEvent(t,i){const a=this._throttledAddEvent(t,i);if(a===rC){const u=Ma({category:"replay.throttled"});this.addUpdate(()=>{Hp(this,{type:Vn.Custom,timestamp:u.timestamp||0,data:{tag:"breadcrumb",payload:u,metric:!0}})})}return a}getCurrentRoute(){const t=this.lastTransaction||_n().getScope().getTransaction();if(!(!t||!["route","custom"].includes(t.metadata.source)))return t.name}_initializeRecording(){this.setInitialState(),this._updateSessionActivity(),this.eventBuffer=u4({useCompression:this._options.useCompression}),this._removeListeners(),this._addListeners(),this._isEnabled=!0,this.startRecording()}_handleException(t){(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&st.error("[Replay]",t),(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&this._options._experiments&&this._options._experiments.captureExceptions&&Tm(t)}_loadAndCheckSession(){const{type:t,session:i}=m_({timeouts:this.timeouts,stickySession:!!this._options.stickySession,currentSession:this.session,sessionSampleRate:this._options.sessionSampleRate,allowBuffering:this._options.errorSampleRate>0||this.recordingMode==="buffer",traceInternals:this._options._experiments.traceInternals});t==="new"&&this.setInitialState();const a=this.getSessionId();return i.id!==a&&(i.previousSessionId=a),this.session=i,this.session.sampled?!0:(this.stop({reason:"session not refreshed"}),!1)}_addListeners(){try{An.document.addEventListener("visibilitychange",this._handleVisibilityChange),An.addEventListener("blur",this._handleWindowBlur),An.addEventListener("focus",this._handleWindowFocus),An.addEventListener("keydown",this._handleKeyboardEvent),this.clickDetector&&this.clickDetector.addListeners(),this._hasInitializedCoreListeners||(_6(this),this._hasInitializedCoreListeners=!0)}catch(t){this._handleException(t)}"PerformanceObserver"in An&&(this._performanceObserver=r4(this))}_removeListeners(){try{An.document.removeEventListener("visibilitychange",this._handleVisibilityChange),An.removeEventListener("blur",this._handleWindowBlur),An.removeEventListener("focus",this._handleWindowFocus),An.removeEventListener("keydown",this._handleKeyboardEvent),this.clickDetector&&this.clickDetector.removeListeners(),this._performanceObserver&&(this._performanceObserver.disconnect(),this._performanceObserver=void 0)}catch(t){this._handleException(t)}}__init(){this._handleVisibilityChange=()=>{An.document.visibilityState==="visible"?this._doChangeToForegroundTasks():this._doChangeToBackgroundTasks()}}__init2(){this._handleWindowBlur=()=>{const t=Ma({category:"ui.blur"});this._doChangeToBackgroundTasks(t)}}__init3(){this._handleWindowFocus=()=>{const t=Ma({category:"ui.focus"});this._doChangeToForegroundTasks(t)}}__init4(){this._handleKeyboardEvent=t=>{QU(this,t)}}_doChangeToBackgroundTasks(t){if(!this.session)return;const i=j2(this.session,this.timeouts);t&&!i&&this._createCustomBreadcrumb(t),this.conditionalFlush()}_doChangeToForegroundTasks(t){if(!this.session)return;if(!this.checkAndHandleExpiredSession()){mr("[Replay] Document has become active, but session has expired");return}t&&this._createCustomBreadcrumb(t)}_triggerFullSnapshot(t=!0){try{mr("[Replay] Taking full rrweb snapshot"),bl.takeFullSnapshot(t)}catch(i){this._handleException(i)}}_updateUserActivity(t=Date.now()){this._lastActivity=t}_updateSessionActivity(t=Date.now()){this.session&&(this.session.lastActivity=t,this._maybeSaveSession())}_createCustomBreadcrumb(t){this.addUpdate(()=>{this.throttledAddEvent({type:Vn.Custom,timestamp:t.timestamp||0,data:{tag:"breadcrumb",payload:t}})})}_addPerformanceEntries(){const t=[...this.performanceEvents];return this.performanceEvents=[],Promise.all(Mm(this,x6(t)))}_clearContext(){this._context.errorIds.clear(),this._context.traceIds.clear(),this._context.urls=[]}_updateInitialTimestampFromEventBuffer(){const{session:t,eventBuffer:i}=this;if(!t||!i||t.segmentId)return;const a=i.getEarliestTimestamp();a&&a<this._context.initialTimestamp&&(this._context.initialTimestamp=a)}_popEventContext(){const t={initialTimestamp:this._context.initialTimestamp,initialUrl:this._context.initialUrl,errorIds:Array.from(this._context.errorIds),traceIds:Array.from(this._context.traceIds),urls:this._context.urls};return this._clearContext(),t}async _runFlush(){if(!this.session||!this.eventBuffer){(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&st.error("[Replay] No session or eventBuffer found to flush.");return}if(await this._addPerformanceEntries(),!(!this.eventBuffer||!this.eventBuffer.hasEvents)&&(await y6(this),!!this.eventBuffer))try{this._updateInitialTimestampFromEventBuffer();const t=await this.eventBuffer.finish(),i=Date.now();if(i-this._context.initialTimestamp>this.timeouts.maxSessionLife+3e4)throw new Error("Session is too long, not sending replay");const a=this.session.id,u=this._popEventContext(),d=this.session.segmentId++;this._maybeSaveSession(),await iC({replayId:a,recordingData:t,segmentId:d,eventContext:u,session:this.session,options:this.getOptions(),timestamp:i})}catch(t){this._handleException(t),this.stop({reason:"sendReplay"});const i=_n().getClient();i&&i.recordDroppedEvent("send_error","replay")}}__init5(){this._flush=async({force:t=!1}={})=>{if(!this._isEnabled&&!t)return;if(!this.checkAndHandleExpiredSession()){(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&st.error("[Replay] Attempting to finish replay event after session expired.");return}if(!this.session){(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&st.error("[Replay] No session found to flush.");return}const i=this.session.started,u=Date.now()-i;this._debouncedFlush.cancel();const d=u<this._options.minReplayDuration,p=u>this.timeouts.maxSessionLife+5e3;if(d||p){mr(`[Replay] Session duration (${Math.floor(u/1e3)}s) is too ${d?"short":"long"}, not sending replay.`,this._options._experiments.traceInternals),d&&this._debouncedFlush();return}const l=this.eventBuffer;if(l&&this.session.segmentId===0&&!l.hasCheckout&&mr("[Replay] Flushing initial segment without checkout.",this._options._experiments.traceInternals),!this._flushLock){this._flushLock=this._runFlush(),await this._flushLock,this._flushLock=void 0;return}try{await this._flushLock}catch(b){(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&st.error(b)}finally{this._debouncedFlush()}}}_maybeSaveSession(){this.session&&this._options.stickySession&&o0(this.session)}__init6(){this._onMutationHandler=t=>{const i=t.length,a=this._options.mutationLimit,u=this._options.mutationBreadcrumbLimit,d=a&&i>a;if(i>u||d){const p=Ma({category:"replay.mutations",data:{count:i,limit:d}});this._createCustomBreadcrumb(p)}return d?(this.stop({reason:"mutationLimit",forceFlush:this.recordingMode==="session"}),!1):!0}}}function wh(e,t,i,a){const u=typeof a=="string"?a.split(","):[],d=[...e,...u,...t];return typeof i<"u"&&(typeof i=="string"&&d.push(`.${i}`),console.warn("[Replay] You are using a deprecated configuration item for privacy. Read the documentation on how to use the new privacy configuration.")),d.join(",")}function O6({mask:e,unmask:t,block:i,unblock:a,ignore:u,blockClass:d,blockSelector:p,maskTextClass:l,maskTextSelector:b,ignoreClass:w}){const C=['base[href="/"]'],I=wh(e,[".sentry-mask","[data-sentry-mask]"],l,b),M=wh(t,[".sentry-unmask","[data-sentry-unmask]"]),O={maskTextSelector:I,unmaskTextSelector:M,maskInputSelector:I,unmaskInputSelector:M,blockSelector:wh(i,[".sentry-block","[data-sentry-block]",...C],d,p),unblockSelector:wh(a,[".sentry-unblock","[data-sentry-unblock]"]),ignoreSelector:wh(u,[".sentry-ignore","[data-sentry-ignore]",'input[type="file"]'],w)};return d instanceof RegExp&&(O.blockClass=d),l instanceof RegExp&&(O.maskTextClass=l),O}function Pw(){return typeof window<"u"&&(!JT()||B6())}function B6(){return typeof process<"u"&&process.type==="renderer"}const Rw='img,image,svg,video,object,picture,embed,map,audio,link[rel="icon"],link[rel="apple-touch-icon"]',F6=["content-length","content-type","accept"];let Mw=!1;class Lm{static __initStatic(){this.id="Replay"}constructor({flushMinDelay:t=R3,flushMaxDelay:i=M3,minReplayDuration:a=F3,stickySession:u=!0,useCompression:d=!0,_experiments:p={},sessionSampleRate:l,errorSampleRate:b,maskAllText:w=!0,maskAllInputs:C=!0,blockAllMedia:I=!0,mutationBreadcrumbLimit:M=750,mutationLimit:O=1e4,slowClickTimeout:j=7e3,slowClickIgnoreSelectors:Z=[],networkDetailAllowUrls:ue=[],networkDetailDenyUrls:ce=[],networkCaptureBodies:ve=!0,networkRequestHeaders:ye=[],networkResponseHeaders:Ae=[],mask:Be=[],unmask:Le=[],block:Ie=[],unblock:U=[],ignore:H=[],maskFn:he,beforeAddRecordingEvent:xe,blockClass:we,blockSelector:oe,maskInputOptions:ke,maskTextClass:tt,maskTextSelector:et,ignoreClass:Ve}={}){if(this.name=Lm.id,this._recordingOptions={maskAllInputs:C,maskAllText:w,maskInputOptions:{...ke||{},password:!0},maskTextFn:he,maskInputFn:he,...O6({mask:Be,unmask:Le,block:Ie,unblock:U,ignore:H,blockClass:we,blockSelector:oe,maskTextClass:tt,maskTextSelector:et,ignoreClass:Ve}),slimDOMOptions:"all",inlineStylesheet:!0,inlineImages:!1,collectFonts:!0},this._initialOptions={flushMinDelay:t,flushMaxDelay:i,minReplayDuration:Math.min(a,N3),stickySession:u,sessionSampleRate:l,errorSampleRate:b,useCompression:d,blockAllMedia:I,maskAllInputs:C,maskAllText:w,mutationBreadcrumbLimit:M,mutationLimit:O,slowClickTimeout:j,slowClickIgnoreSelectors:Z,networkDetailAllowUrls:ue,networkDetailDenyUrls:ce,networkCaptureBodies:ve,networkRequestHeaders:Dw(ye),networkResponseHeaders:Dw(Ae),beforeAddRecordingEvent:xe,_experiments:p},typeof l=="number"&&(console.warn(`[Replay] You are passing \`sessionSampleRate\` to the Replay integration.
This option is deprecated and will be removed soon.
Instead, configure \`replaysSessionSampleRate\` directly in the SDK init options, e.g.:
Sentry.init({ replaysSessionSampleRate: ${l} })`),this._initialOptions.sessionSampleRate=l),typeof b=="number"&&(console.warn(`[Replay] You are passing \`errorSampleRate\` to the Replay integration.
This option is deprecated and will be removed soon.
Instead, configure \`replaysOnErrorSampleRate\` directly in the SDK init options, e.g.:
Sentry.init({ replaysOnErrorSampleRate: ${b} })`),this._initialOptions.errorSampleRate=b),this._initialOptions.blockAllMedia&&(this._recordingOptions.blockSelector=this._recordingOptions.blockSelector?`${this._recordingOptions.blockSelector},${Rw}`:Rw),this._isInitialized&&Pw())throw new Error("Multiple Sentry Session Replay instances are not supported");this._isInitialized=!0}get _isInitialized(){return Mw}set _isInitialized(t){Mw=t}setupOnce(){Pw()&&(this._setup(),setTimeout(()=>this._initialize()))}start(){this._replay&&this._replay.start()}startBuffering(){this._replay&&this._replay.startBuffering()}stop(){return this._replay?this._replay.stop({forceFlush:this._replay.recordingMode==="session"}):Promise.resolve()}flush(t){return!this._replay||!this._replay.isEnabled()?Promise.resolve():this._replay.sendBufferedReplayOrFlush(t)}getReplayId(){if(!(!this._replay||!this._replay.isEnabled()))return this._replay.getSessionId()}_initialize(){this._replay&&this._replay.initializeSampling()}_setup(){const t=N6(this._initialOptions);this._replay=new go({options:t,recordingOptions:this._recordingOptions})}}Lm.__initStatic();function N6(e){const t=_n().getClient(),i=t&&t.getOptions(),a={sessionSampleRate:0,errorSampleRate:0,...da(e)};return i?(e.sessionSampleRate==null&&e.errorSampleRate==null&&i.replaysSessionSampleRate==null&&i.replaysOnErrorSampleRate==null&&console.warn("Replay is disabled because neither `replaysSessionSampleRate` nor `replaysOnErrorSampleRate` are set."),typeof i.replaysSessionSampleRate=="number"&&(a.sessionSampleRate=i.replaysSessionSampleRate),typeof i.replaysOnErrorSampleRate=="number"&&(a.errorSampleRate=i.replaysOnErrorSampleRate),a):(console.warn("SDK client is not available."),a)}function Dw(e){return[...F6,...e.map(t=>t.toLowerCase())]}const Xn=Mr;function U6(){Xn&&Xn.document?Xn.document.addEventListener("visibilitychange",()=>{const e=Sd();if(Xn.document.hidden&&e){const t="cancelled";(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&st.log(`[Tracing] Transaction: ${t} -> since tab moved to the background, op: ${e.op}`),e.status||e.setStatus(t),e.setTag("visibilitychange","document.hidden"),e.finish()}}):(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&st.warn("[Tracing] Could not set up background tab detection due to lack of global document")}const u0=(e,t,i)=>{let a,u;return d=>{t.value>=0&&(d||i)&&(u=t.value-(a||0),(u||a===void 0)&&(a=t.value,t.delta=u,e(t)))}},$6=()=>`v3-${Date.now()}-${Math.floor(Math.random()*(9e12-1))+1e12}`,V6=()=>{const e=Xn.performance.timing,t=Xn.performance.navigation.type,i={entryType:"navigation",startTime:0,type:t==2?"back_forward":t===1?"reload":"navigate"};for(const a in e)a!=="navigationStart"&&a!=="toJSON"&&(i[a]=Math.max(e[a]-e.navigationStart,0));return i},sC=()=>Xn.__WEB_VITALS_POLYFILL__?Xn.performance&&(performance.getEntriesByType&&performance.getEntriesByType("navigation")[0]||V6()):Xn.performance&&performance.getEntriesByType&&performance.getEntriesByType("navigation")[0],aC=()=>{const e=sC();return e&&e.activationStart||0},h0=(e,t)=>{const i=sC();let a="navigate";return i&&(Xn.document.prerendering||aC()>0?a="prerender":a=i.type.replace(/_/g,"-")),{name:e,value:typeof t>"u"?-1:t,rating:"good",delta:0,entries:[],id:$6(),navigationType:a}},Td=(e,t,i)=>{try{if(PerformanceObserver.supportedEntryTypes.includes(e)){const a=new PerformanceObserver(u=>{t(u.getEntries())});return a.observe(Object.assign({type:e,buffered:!0},i||{})),a}}catch{}},zm=(e,t)=>{const i=a=>{(a.type==="pagehide"||Xn.document.visibilityState==="hidden")&&(e(a),t&&(removeEventListener("visibilitychange",i,!0),removeEventListener("pagehide",i,!0)))};addEventListener("visibilitychange",i,!0),addEventListener("pagehide",i,!0)},j6=e=>{const t=h0("CLS",0);let i,a=0,u=[];const d=l=>{l.forEach(b=>{if(!b.hadRecentInput){const w=u[0],C=u[u.length-1];a&&u.length!==0&&b.startTime-C.startTime<1e3&&b.startTime-w.startTime<5e3?(a+=b.value,u.push(b)):(a=b.value,u=[b]),a>t.value&&(t.value=a,t.entries=u,i&&i())}})},p=Td("layout-shift",d);if(p){i=u0(e,t);const l=()=>{d(p.takeRecords()),i(!0)};return zm(l),l}};let mp=-1;const G6=()=>Xn.document.visibilityState==="hidden"&&!Xn.document.prerendering?0:1/0,q6=()=>{zm(({timeStamp:e})=>{mp=e},!0)},d0=()=>(mp<0&&(mp=G6(),q6()),{get firstHiddenTime(){return mp}}),H6=e=>{const t=d0(),i=h0("FID");let a;const u=l=>{l.startTime<t.firstHiddenTime&&(i.value=l.processingStart-l.startTime,i.entries.push(l),a(!0))},d=l=>{l.forEach(u)},p=Td("first-input",d);a=u0(e,i),p&&zm(()=>{d(p.takeRecords()),p.disconnect()},!0)},Lw={},W6=e=>{const t=d0(),i=h0("LCP");let a;const u=p=>{const l=p[p.length-1];if(l){const b=Math.max(l.startTime-aC(),0);b<t.firstHiddenTime&&(i.value=b,i.entries=[l],a())}},d=Td("largest-contentful-paint",u);if(d){a=u0(e,i);const p=()=>{Lw[i.id]||(u(d.takeRecords()),d.disconnect(),Lw[i.id]=!0,a(!0))};return["keydown","click"].forEach(l=>{addEventListener(l,p,{once:!0,capture:!0})}),zm(p,!0),p}};function g_(e){return typeof e=="number"&&isFinite(e)}function Kc(e,{startTimestamp:t,...i}){return t&&e.startTimestamp>t&&(e.startTimestamp=t),e.startChild({startTimestamp:t,...i})}function $i(e){return e/1e3}function oC(){return Xn&&Xn.addEventListener&&Xn.performance}let zw=0,wi={},ra,Nh;function Z6(){const e=oC();if(e&&qs){e.mark&&Xn.performance.mark("sentry-tracing-init"),Q6();const t=K6(),i=J6();return()=>{t&&t(),i&&i()}}return()=>{}}function Y6(){Td("longtask",t=>{for(const i of t){const a=Sd();if(!a)return;const u=$i(qs+i.startTime),d=$i(i.duration);a.startChild({description:"Main UI thread blocked",op:"ui.long-task",startTimestamp:u,endTimestamp:u+d})}})}function X6(){Td("event",t=>{for(const i of t){const a=Sd();if(!a)return;if(i.name==="click"){const u=$i(qs+i.startTime),d=$i(i.duration);a.startChild({description:ko(i.target),op:`ui.interaction.${i.name}`,startTimestamp:u,endTimestamp:u+d})}}},{durationThreshold:0})}function K6(){return j6(e=>{const t=e.entries.pop();t&&((typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&st.log("[Measurements] Adding CLS"),wi.cls={value:e.value,unit:""},Nh=t)})}function J6(){return W6(e=>{const t=e.entries.pop();t&&((typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&st.log("[Measurements] Adding LCP"),wi.lcp={value:e.value,unit:"millisecond"},ra=t)})}function Q6(){H6(e=>{const t=e.entries.pop();if(!t)return;const i=$i(qs),a=$i(t.startTime);(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&st.log("[Measurements] Adding FID"),wi.fid={value:e.value,unit:"millisecond"},wi["mark.fid"]={value:i+a,unit:"second"}})}function e$(e){const t=oC();if(!t||!Xn.performance.getEntries||!qs)return;(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&st.log("[Tracing] Adding & adjusting spans using Performance API");const i=$i(qs),a=t.getEntries();let u,d;if(a.slice(zw).forEach(p=>{const l=$i(p.startTime),b=$i(p.duration);if(!(e.op==="navigation"&&i+l<e.startTimestamp))switch(p.entryType){case"navigation":{n$(e,p,i),u=i+$i(p.responseStart),d=i+$i(p.requestStart);break}case"mark":case"paint":case"measure":{t$(e,p,l,b,i);const w=d0(),C=p.startTime<w.firstHiddenTime;p.name==="first-paint"&&C&&((typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&st.log("[Measurements] Adding FP"),wi.fp={value:p.startTime,unit:"millisecond"}),p.name==="first-contentful-paint"&&C&&((typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&st.log("[Measurements] Adding FCP"),wi.fcp={value:p.startTime,unit:"millisecond"});break}case"resource":{const w=p.name.replace(Xn.location.origin,"");r$(e,p,w,l,b,i);break}}}),zw=Math.max(a.length-1,0),s$(e),e.op==="pageload"){typeof u=="number"&&((typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&st.log("[Measurements] Adding TTFB"),wi.ttfb={value:(u-e.startTimestamp)*1e3,unit:"millisecond"},typeof d=="number"&&d<=u&&(wi["ttfb.requestTime"]={value:(u-d)*1e3,unit:"millisecond"})),["fcp","fp","lcp"].forEach(l=>{if(!wi[l]||i>=e.startTimestamp)return;const b=wi[l].value,w=i+$i(b),C=Math.abs((w-e.startTimestamp)*1e3),I=C-b;(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&st.log(`[Measurements] Normalized ${l} from ${b} to ${C} (${I})`),wi[l].value=C});const p=wi["mark.fid"];p&&wi.fid&&(Kc(e,{description:"first input delay",endTimestamp:p.value+$i(wi.fid.value),op:"ui.action",startTimestamp:p.value}),delete wi["mark.fid"]),"fcp"in wi||delete wi.cls,Object.keys(wi).forEach(l=>{e.setMeasurement(l,wi[l].value,wi[l].unit)}),a$(e)}ra=void 0,Nh=void 0,wi={}}function t$(e,t,i,a,u){const d=u+i,p=d+a;return Kc(e,{description:t.name,endTimestamp:p,op:t.entryType,startTimestamp:d}),d}function n$(e,t,i){["unloadEvent","redirect","domContentLoadedEvent","loadEvent","connect"].forEach(a=>{ip(e,t,a,i)}),ip(e,t,"secureConnection",i,"TLS/SSL","connectEnd"),ip(e,t,"fetch",i,"cache","domainLookupStart"),ip(e,t,"domainLookup",i,"DNS"),i$(e,t,i)}function ip(e,t,i,a,u,d){const p=d?t[d]:t[`${i}End`],l=t[`${i}Start`];!l||!p||Kc(e,{op:"browser",description:u||i,startTimestamp:a+$i(l),endTimestamp:a+$i(p)})}function i$(e,t,i){Kc(e,{op:"browser",description:"request",startTimestamp:i+$i(t.requestStart),endTimestamp:i+$i(t.responseEnd)}),Kc(e,{op:"browser",description:"response",startTimestamp:i+$i(t.responseStart),endTimestamp:i+$i(t.responseEnd)})}function r$(e,t,i,a,u,d){if(t.initiatorType==="xmlhttprequest"||t.initiatorType==="fetch")return;const p={};"transferSize"in t&&(p["http.response_transfer_size"]=t.transferSize),"encodedBodySize"in t&&(p["http.response_content_length"]=t.encodedBodySize),"decodedBodySize"in t&&(p["http.decoded_response_content_length"]=t.decodedBodySize),"renderBlockingStatus"in t&&(p["resource.render_blocking_status"]=t.renderBlockingStatus);const l=d+a,b=l+u;Kc(e,{description:i,endTimestamp:b,op:t.initiatorType?`resource.${t.initiatorType}`:"resource.other",startTimestamp:l,data:p})}function s$(e){const t=Xn.navigator;if(!t)return;const i=t.connection;i&&(i.effectiveType&&e.setTag("effectiveConnectionType",i.effectiveType),i.type&&e.setTag("connectionType",i.type),g_(i.rtt)&&(wi["connection.rtt"]={value:i.rtt,unit:"millisecond"})),g_(t.deviceMemory)&&e.setTag("deviceMemory",`${t.deviceMemory} GB`),g_(t.hardwareConcurrency)&&e.setTag("hardwareConcurrency",String(t.hardwareConcurrency))}function a$(e){ra&&((typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&st.log("[Measurements] Adding LCP Data"),ra.element&&e.setTag("lcp.element",ko(ra.element)),ra.id&&e.setTag("lcp.id",ra.id),ra.url&&e.setTag("lcp.url",ra.url.trim().slice(0,200)),e.setTag("lcp.size",ra.size)),Nh&&Nh.sources&&((typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&st.log("[Measurements] Adding CLS Data"),Nh.sources.forEach((t,i)=>e.setTag(`cls.source.${i+1}`,ko(t.node))))}const Dy=["localhost",/^\/(?!\/)/],Ly={traceFetch:!0,traceXHR:!0,enableHTTPTimings:!0,tracingOrigins:Dy,tracePropagationTargets:Dy};function o$(e){const{traceFetch:t,traceXHR:i,tracePropagationTargets:a,tracingOrigins:u,shouldCreateSpanForRequest:d,enableHTTPTimings:p}={traceFetch:Ly.traceFetch,traceXHR:Ly.traceXHR,...e},l=typeof d=="function"?d:C=>!0,b=C=>u$(C,a||u),w={};t&&cr("fetch",C=>{const I=h$(C,l,b,w);p&&I&&Ow(I)}),i&&cr("xhr",C=>{const I=f$(C,l,b,w);p&&I&&Ow(I)})}function Ow(e){const t=e.data.url,i=new PerformanceObserver(a=>{a.getEntries().forEach(d=>{(d.initiatorType==="fetch"||d.initiatorType==="xmlhttprequest")&&d.name.endsWith(t)&&(c$(d).forEach(l=>e.setData(...l)),i.disconnect())})});i.observe({entryTypes:["resource"]})}function l$(e){let t="unknown",i="unknown",a="";for(const u of e){if(u==="/"){[t,i]=e.split("/");break}if(!isNaN(Number(u))){t=a==="h"?"http":a,i=e.split(a)[1];break}a+=u}return a===e&&(t=a),{name:t,version:i}}function ia(e){return((qs||performance.timeOrigin)+e)/1e3}function c$(e){const{name:t,version:i}=l$(e.nextHopProtocol),a=[];return a.push(["network.protocol.version",i],["network.protocol.name",t]),qs?[...a,["http.request.redirect_start",ia(e.redirectStart)],["http.request.fetch_start",ia(e.fetchStart)],["http.request.domain_lookup_start",ia(e.domainLookupStart)],["http.request.domain_lookup_end",ia(e.domainLookupEnd)],["http.request.connect_start",ia(e.connectStart)],["http.request.secure_connection_start",ia(e.secureConnectionStart)],["http.request.connection_end",ia(e.connectEnd)],["http.request.request_start",ia(e.requestStart)],["http.request.response_start",ia(e.responseStart)],["http.request.response_end",ia(e.responseEnd)]]:a}function u$(e,t){return du(e,t||Dy)}function h$(e,t,i,a){if(!Sm()||!e.fetchData)return;const u=t(e.fetchData.url);if(e.endTimestamp&&u){const M=e.fetchData.__span;if(!M)return;const O=a[M];if(O){if(e.response){O.setHttpStatus(e.response.status);const j=e.response&&e.response.headers&&e.response.headers.get("content-length"),Z=parseInt(j);Z>0&&O.setData("http.response_content_length",Z)}else e.error&&O.setStatus("internal_error");O.finish(),delete a[M]}return}const d=_n(),p=d.getScope(),l=d.getClient(),b=p.getSpan(),{method:w,url:C}=e.fetchData,I=u&&b?b.startChild({data:{url:C,type:"fetch","http.method":w},description:`${w} ${C}`,op:"http.client"}):void 0;if(I&&(e.fetchData.__span=I.spanId,a[I.spanId]=I),i(e.fetchData.url)&&l){const M=e.args[0];e.args[1]=e.args[1]||{};const O=e.args[1];O.headers=d$(M,l,p,O,I)}return I}function d$(e,t,i,a,u){const d=u||i.getSpan(),p=d&&d.transaction,{traceId:l,sampled:b,dsc:w}=i.getPropagationContext(),C=d?d.toTraceparent():Hv(l,void 0,b),I=p?p.getDynamicSamplingContext():w||Em(l,t,i),M=my(I),O=typeof Request<"u"&&Fa(e,Request)?e.headers:a.headers;if(O)if(typeof Headers<"u"&&Fa(O,Headers)){const j=new Headers(O);return j.append("sentry-trace",C),M&&j.append(py,M),j}else if(Array.isArray(O)){const j=[...O,["sentry-trace",C]];return M&&j.push([py,M]),j}else{const j="baggage"in O?O.baggage:void 0,Z=[];return Array.isArray(j)?Z.push(...j):j&&Z.push(j),M&&Z.push(M),{...O,"sentry-trace":C,baggage:Z.length>0?Z.join(","):void 0}}else return{"sentry-trace":C,baggage:M}}function f$(e,t,i,a){const u=e.xhr,d=u&&u[vo];if(!Sm()||u&&u.__sentry_own_request__||!u||!d)return;const p=t(d.url);if(e.endTimestamp&&p){const I=u.__sentry_xhr_span_id__;if(!I)return;const M=a[I];M&&(M.setHttpStatus(d.status_code),M.finish(),delete a[I]);return}const l=_n(),b=l.getScope(),w=b.getSpan(),C=p&&w?w.startChild({data:{...d.data,type:"xhr","http.method":d.method,url:d.url},description:`${d.method} ${d.url}`,op:"http.client"}):void 0;if(C&&(u.__sentry_xhr_span_id__=C.spanId,a[u.__sentry_xhr_span_id__]=C),u.setRequestHeader&&i(d.url))if(C){const I=C&&C.transaction,M=I&&I.getDynamicSamplingContext(),O=my(M);Bw(u,C.toTraceparent(),O)}else{const I=l.getClient(),{traceId:M,sampled:O,dsc:j}=b.getPropagationContext(),Z=Hv(M,void 0,O),ue=j||(I?Em(M,I,b):void 0),ce=my(ue);Bw(u,Z,ce)}return C}function Bw(e,t,i){try{e.setRequestHeader("sentry-trace",t),i&&e.setRequestHeader(py,i)}catch{}}function p$(e,t=!0,i=!0){if(!Xn||!Xn.location){(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&st.warn("Could not initialize routing instrumentation due to invalid location");return}let a=Xn.location.href,u;t&&(u=e({name:Xn.location.pathname,startTimestamp:qs?qs/1e3:void 0,op:"pageload",metadata:{source:"url"}})),i&&cr("history",({to:d,from:p})=>{if(p===void 0&&a&&a.indexOf(d)!==-1){a=void 0;return}p!==d&&(a=void 0,u&&((typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&st.log(`[Tracing] Finishing current transaction with op: ${u.op}`),u.finish()),u=e({name:Xn.location.pathname,op:"navigation",metadata:{source:"url"}}))})}const m$="BrowserTracing",g$={...dp,markBackgroundTransactions:!0,routingInstrumentation:p$,startTransactionOnLocationChange:!0,startTransactionOnPageLoad:!0,enableLongTask:!0,_experiments:{},...Ly};class _${constructor(t){this.name=m$,this._hasSetTracePropagationTargets=!1,j5(),(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&(this._hasSetTracePropagationTargets=!!(t&&(t.tracePropagationTargets||t.tracingOrigins))),this.options={...g$,...t},this.options._experiments.enableLongTask!==void 0&&(this.options.enableLongTask=this.options._experiments.enableLongTask),t&&!t.tracePropagationTargets&&t.tracingOrigins&&(this.options.tracePropagationTargets=t.tracingOrigins),this._collectWebVitals=Z6(),this.options.enableLongTask&&Y6(),this.options._experiments.enableInteractions&&X6()}setupOnce(t,i){this._getCurrentHub=i;const u=i().getClient(),d=u&&u.getOptions(),{routingInstrumentation:p,startTransactionOnLocationChange:l,startTransactionOnPageLoad:b,markBackgroundTransactions:w,traceFetch:C,traceXHR:I,shouldCreateSpanForRequest:M,enableHTTPTimings:O,_experiments:j}=this.options,Z=d&&d.tracePropagationTargets,ue=Z||this.options.tracePropagationTargets;(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&this._hasSetTracePropagationTargets&&Z&&st.warn("[Tracing] The `tracePropagationTargets` option was set in the BrowserTracing integration and top level `Sentry.init`. The top level `Sentry.init` value is being used."),p(ce=>{const ve=this._createRouteTransaction(ce);return this.options._experiments.onStartRouteTransaction&&this.options._experiments.onStartRouteTransaction(ve,ce,i),ve},b,l),w&&U6(),j.enableInteractions&&this._registerInteractionListener(),o$({traceFetch:C,traceXHR:I,tracePropagationTargets:ue,shouldCreateSpanForRequest:M,enableHTTPTimings:O})}_createRouteTransaction(t){if(!this._getCurrentHub){(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&st.warn(`[Tracing] Did not create ${t.op} transaction because _getCurrentHub is invalid.`);return}const i=this._getCurrentHub(),{beforeNavigate:a,idleTimeout:u,finalTimeout:d,heartbeatInterval:p}=this.options,l=t.op==="pageload",b=l?Fw("sentry-trace"):"",w=l?Fw("baggage"):"",{traceparentData:C,dynamicSamplingContext:I,propagationContext:M}=g5(b,w),O={...t,...C,metadata:{...t.metadata,dynamicSamplingContext:C&&!I?{}:I},trimEnd:!0},j=typeof a=="function"?a(O):O,Z=j===void 0?{...O,sampled:!1}:j;Z.metadata=Z.name!==O.name?{...Z.metadata,source:"custom"}:Z.metadata,this._latestRouteName=Z.name,this._latestRouteSource=Z.metadata&&Z.metadata.source,Z.sampled===!1&&(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&st.log(`[Tracing] Will not send ${Z.op} transaction because of beforeNavigate.`),(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&st.log(`[Tracing] Starting ${Z.op} transaction on scope`);const{location:ue}=Xn,ce=iw(i,Z,u,d,!0,{location:ue},p),ve=i.getScope();return l&&C?ve.setPropagationContext(M):ve.setPropagationContext({traceId:ce.traceId,spanId:ce.spanId,parentSpanId:ce.parentSpanId,sampled:!!ce.sampled}),ce.registerBeforeFinishCallback(ye=>{this._collectWebVitals(),e$(ye)}),ce}_registerInteractionListener(){let t;const i=()=>{const{idleTimeout:a,finalTimeout:u,heartbeatInterval:d}=this.options,p="ui.action.click",l=Sd();if(l&&l.op&&["navigation","pageload"].includes(l.op)){(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&st.warn(`[Tracing] Did not create ${p} transaction because a pageload or navigation transaction is in progress.`);return}if(t&&(t.setFinishReason("interactionInterrupted"),t.finish(),t=void 0),!this._getCurrentHub){(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&st.warn(`[Tracing] Did not create ${p} transaction because _getCurrentHub is invalid.`);return}if(!this._latestRouteName){(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&st.warn(`[Tracing] Did not create ${p} transaction because _latestRouteName is missing.`);return}const b=this._getCurrentHub(),{location:w}=Xn,C={name:this._latestRouteName,op:p,trimEnd:!0,metadata:{source:this._latestRouteSource||"url"}};t=iw(b,C,a,u,!0,{location:w},d)};["click"].forEach(a=>{addEventListener(a,i,{once:!1,capture:!0})})}}function Fw(e){const t=CF(`meta[name=${e}]`);return t?t.getAttribute("content"):void 0}const lC=["activate","mount","update"],y$=/(?:^|[-_])(\w)/g,v$=e=>e.replace(y$,t=>t.toUpperCase()).replace(/[-_]/g,""),x$="<Root>",__="<Anonymous>",b$=(e,t)=>e.repeat?e.repeat(t):e,Uh=(e,t)=>{if(!e)return __;if(e.$root===e)return x$;if(!e.$options)return __;const i=e.$options;let a=i.name||i._componentTag;const u=i.__file;if(!a&&u){const d=u.match(/([^/\\]+)\.vue$/);d&&(a=d[1])}return(a?`<${v$(a)}>`:__)+(u&&t!==!1?` at ${u}`:"")},w$=e=>{if(e&&(e._isVue||e.__isVue)&&e.$parent){const t=[];let i=0;for(;e;){if(t.length>0){const u=t[t.length-1];if(u.constructor===e.constructor){i++,e=e.$parent;continue}else i>0&&(t[t.length-1]=[u,i],i=0)}t.push(e),e=e.$parent}return`

found in

${t.map((u,d)=>`${(d===0?"---> ":b$(" ",5+d*2))+(Array.isArray(u)?`${Uh(u[0])}... (${u[1]} recursive calls)`:Uh(u))}`).join(`
`)}`}return`

(found in ${Uh(e)})`},S$=(e,t)=>{const{errorHandler:i,warnHandler:a,silent:u}=e.config;e.config.errorHandler=(d,p,l)=>{const b=Uh(p,!1),w=p?w$(p):"",C={componentName:b,lifecycleHook:l,trace:w};if(t.attachProps&&p&&(p.$options&&p.$options.propsData?C.propsData=p.$options.propsData:p.$props&&(C.propsData=p.$props)),setTimeout(()=>{_n().withScope(I=>{I.setContext("vue",C),_n().captureException(d)})}),typeof i=="function"&&i.call(e,d,p,l),t.logErrors){const I=typeof console<"u",M=`Error in ${l}: "${d&&d.toString()}"`;a?a.call(null,M,p,w):I&&!u&&console.error(`[Vue warn]: ${M}${w}`)}}},Nw="ui.vue",E$={activate:["activated","deactivated"],create:["beforeCreate","created"],destroy:["beforeDestroy","destroyed"],mount:["beforeMount","mounted"],update:["beforeUpdate","updated"]};function zy(){return _n().getScope().getTransaction()}function T$(e,t,i){e.$_sentryRootSpanTimer&&clearTimeout(e.$_sentryRootSpanTimer),e.$_sentryRootSpanTimer=setTimeout(()=>{e.$root&&e.$root.$_sentryRootSpan&&(e.$root.$_sentryRootSpan.finish(t),e.$root.$_sentryRootSpan=void 0)},i)}const C$=e=>{const t=(e.hooks||[]).concat(lC).filter((a,u,d)=>d.indexOf(a)===u),i={};for(const a of t){const u=E$[a];if(!u){(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&st.warn(`Unknown hook: ${a}`);continue}for(const d of u)i[d]=function(){const p=this.$root===this;if(p){const w=zy();w&&(this.$_sentryRootSpan=this.$_sentryRootSpan||w.startChild({description:"Application Render",op:`${Nw}.render`}))}const l=Uh(this,!1),b=Array.isArray(e.trackComponents)?e.trackComponents.indexOf(l)>-1:e.trackComponents;if(!(!p&&!b))if(this.$_sentrySpans=this.$_sentrySpans||{},d==u[0]){const w=this.$root&&this.$root.$_sentryRootSpan||zy();if(w){const C=this.$_sentrySpans[a];C&&!C.endTimestamp&&C.finish(),this.$_sentrySpans[a]=w.startChild({description:`Vue <${l}>`,op:`${Nw}.${a}`})}}else{const w=this.$_sentrySpans[a];if(!w)return;w.finish(),T$(this,Po(),e.timeout)}}}return i},I$=Mr,k$={Vue:I$.Vue,attachProps:!0,logErrors:!0,hooks:lC,timeout:2e3,trackComponents:!1,_metadata:{sdk:{name:"sentry.javascript.vue",packages:[{name:"npm:@sentry/vue",version:Up}],version:Up}}};function A$(e={}){const t={...k$,...e};if(T3(t),!t.Vue&&!t.app){console.warn("[@sentry/vue]: Misconfigured SDK. Vue specific errors will not be captured.\nUpdate your `Sentry.init` call with an appropriate config option:\n`app` (Application Instance - Vue 3) or `Vue` (Vue Constructor - Vue 2).");return}t.app?qv(t.app).forEach(a=>Uw(a,t)):t.Vue&&Uw(t.Vue,t)}const Uw=(e,t)=>{const i=e;(i._instance&&i._instance.isMounted)===!0&&console.warn("[@sentry/vue]: Misconfigured SDK. Vue app is already mounted. Make sure to call `app.mount()` after `Sentry.init()`."),S$(e,t),Sm(t)&&e.mixin(C$({...t,...t.tracingOptions}))};function P$(e,t={}){return(i,a=!0,u=!0)=>{const d={"routing.instrumentation":"vue-router"};a&&Nn&&Nn.location&&i({name:Nn.location.pathname,op:"pageload",tags:d,metadata:{source:"url"}}),e.onError(p=>Tm(p)),e.beforeEach((p,l,b)=>{const w=l.name==null&&l.matched.length===0,C={params:p.params,query:p.query};let I=p.path,M="url";if(p.name&&t.routeLabel!=="path"?(I=p.name.toString(),M="custom"):p.matched[0]&&p.matched[0].path&&(I=p.matched[0].path,M="route"),a&&w){const O=zy();O&&(O.metadata.source!=="custom"&&O.setName(I,M),O.setData("params",C.params),O.setData("query",C.query))}u&&!w&&i({name:I,op:"navigation",tags:d,data:C,metadata:{source:M}}),b&&b()})}}const Cd=CP(dB);Cd.use(aM);Cd.use(AP());A$({app:Cd,dsn:"https://d7f1d553a334ff1f006a7e1e323919fe@o4505765929287680.ingest.sentry.io/4505765932826624",integrations:[new _$({tracePropagationTargets:["localhost"],routingInstrumentation:P$(NT)}),new Lm],tracesSampleRate:1,replaysSessionSampleRate:.1,replaysOnErrorSampleRate:1});Cd.use(NT);Cd.mount("#app")});export default R$();
