var Pw=Object.defineProperty;var kw=(e,s,l)=>s in e?Pw(e,s,{enumerable:!0,configurable:!0,writable:!0,value:l}):e[s]=l;var Wn=(e,s,l)=>(kw(e,typeof s!="symbol"?s+"":s,l),l);(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const m of document.querySelectorAll('link[rel="modulepreload"]'))h(m);new MutationObserver(m=>{for(const _ of m)if(_.type==="childList")for(const x of _.addedNodes)x.tagName==="LINK"&&x.rel==="modulepreload"&&h(x)}).observe(document,{childList:!0,subtree:!0});function l(m){const _={};return m.integrity&&(_.integrity=m.integrity),m.referrerPolicy&&(_.referrerPolicy=m.referrerPolicy),m.crossOrigin==="use-credentials"?_.credentials="include":m.crossOrigin==="anonymous"?_.credentials="omit":_.credentials="same-origin",_}function h(m){if(m.ep)return;m.ep=!0;const _=l(m);fetch(m.href,_)}})();function xm(e,s){const l=Object.create(null),h=e.split(",");for(let m=0;m<h.length;m++)l[h[m]]=!0;return s?m=>!!l[m.toLowerCase()]:m=>!!l[m]}const Kn={},Pl=[],gs=()=>{},Mw=()=>!1,Dw=/^on[^a-z]/,Md=e=>Dw.test(e),bm=e=>e.startsWith("onUpdate:"),vi=Object.assign,wm=(e,s)=>{const l=e.indexOf(s);l>-1&&e.splice(l,1)},zw=Object.prototype.hasOwnProperty,Pn=(e,s)=>zw.call(e,s),Qt=Array.isArray,kl=e=>Dd(e)==="[object Map]",Hv=e=>Dd(e)==="[object Set]",ln=e=>typeof e=="function",pi=e=>typeof e=="string",Sm=e=>typeof e=="symbol",Hn=e=>e!==null&&typeof e=="object",Xv=e=>Hn(e)&&ln(e.then)&&ln(e.catch),Kv=Object.prototype.toString,Dd=e=>Kv.call(e),Lw=e=>Dd(e).slice(8,-1),Yv=e=>Dd(e)==="[object Object]",Cm=e=>pi(e)&&e!=="NaN"&&e[0]!=="-"&&""+parseInt(e,10)===e,nd=xm(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),zd=e=>{const s=Object.create(null);return l=>s[l]||(s[l]=e(l))},Rw=/-(\w)/g,ns=zd(e=>e.replace(Rw,(s,l)=>l?l.toUpperCase():"")),Bw=/\B([A-Z])/g,Vl=zd(e=>e.replace(Bw,"-$1").toLowerCase()),$l=zd(e=>e.charAt(0).toUpperCase()+e.slice(1)),dp=zd(e=>e?`on${$l(e)}`:""),mu=(e,s)=>!Object.is(e,s),id=(e,s)=>{for(let l=0;l<e.length;l++)e[l](s)},cd=(e,s,l)=>{Object.defineProperty(e,s,{configurable:!0,enumerable:!1,value:l})},Dp=e=>{const s=parseFloat(e);return isNaN(s)?e:s},Fw=e=>{const s=pi(e)?Number(e):NaN;return isNaN(s)?e:s};let t_;const zp=()=>t_||(t_=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function Em(e){if(Qt(e)){const s={};for(let l=0;l<e.length;l++){const h=e[l],m=pi(h)?Uw(h):Em(h);if(m)for(const _ in m)s[_]=m[_]}return s}else{if(pi(e))return e;if(Hn(e))return e}}const Ow=/;(?![^(]*\))/g,Vw=/:([^]+)/,$w=/\/\*[^]*?\*\//g;function Uw(e){const s={};return e.replace($w,"").split(Ow).forEach(l=>{if(l){const h=l.split(Vw);h.length>1&&(s[h[0].trim()]=h[1].trim())}}),s}function Ld(e){let s="";if(pi(e))s=e;else if(Qt(e))for(let l=0;l<e.length;l++){const h=Ld(e[l]);h&&(s+=h+" ")}else if(Hn(e))for(const l in e)e[l]&&(s+=l+" ");return s.trim()}const Nw="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",jw=xm(Nw);function Jv(e){return!!e||e===""}const Pi=e=>pi(e)?e:e==null?"":Qt(e)||Hn(e)&&(e.toString===Kv||!ln(e.toString))?JSON.stringify(e,Qv,2):String(e),Qv=(e,s)=>s&&s.__v_isRef?Qv(e,s.value):kl(s)?{[`Map(${s.size})`]:[...s.entries()].reduce((l,[h,m])=>(l[`${h} =>`]=m,l),{})}:Hv(s)?{[`Set(${s.size})`]:[...s.values()]}:Hn(s)&&!Qt(s)&&!Yv(s)?String(s):s;let Or;class ex{constructor(s=!1){this.detached=s,this._active=!0,this.effects=[],this.cleanups=[],this.parent=Or,!s&&Or&&(this.index=(Or.scopes||(Or.scopes=[])).push(this)-1)}get active(){return this._active}run(s){if(this._active){const l=Or;try{return Or=this,s()}finally{Or=l}}}on(){Or=this}off(){Or=this.parent}stop(s){if(this._active){let l,h;for(l=0,h=this.effects.length;l<h;l++)this.effects[l].stop();for(l=0,h=this.cleanups.length;l<h;l++)this.cleanups[l]();if(this.scopes)for(l=0,h=this.scopes.length;l<h;l++)this.scopes[l].stop(!0);if(!this.detached&&this.parent&&!s){const m=this.parent.scopes.pop();m&&m!==this&&(this.parent.scopes[this.index]=m,m.index=this.index)}this.parent=void 0,this._active=!1}}}function Lu(e){return new ex(e)}function qw(e,s=Or){s&&s.active&&s.effects.push(e)}function tx(){return Or}function Tr(e){Or&&Or.cleanups.push(e)}const Tm=e=>{const s=new Set(e);return s.w=0,s.n=0,s},nx=e=>(e.w&Fo)>0,ix=e=>(e.n&Fo)>0,Zw=({deps:e})=>{if(e.length)for(let s=0;s<e.length;s++)e[s].w|=Fo},Gw=e=>{const{deps:s}=e;if(s.length){let l=0;for(let h=0;h<s.length;h++){const m=s[h];nx(m)&&!ix(m)?m.delete(e):s[l++]=m,m.w&=~Fo,m.n&=~Fo}s.length=l}},ud=new WeakMap;let su=0,Fo=1;const Lp=30;let ps;const va=Symbol(""),Rp=Symbol("");class Im{constructor(s,l=null,h){this.fn=s,this.scheduler=l,this.active=!0,this.deps=[],this.parent=void 0,qw(this,h)}run(){if(!this.active)return this.fn();let s=ps,l=Lo;for(;s;){if(s===this)return;s=s.parent}try{return this.parent=ps,ps=this,Lo=!0,Fo=1<<++su,su<=Lp?Zw(this):n_(this),this.fn()}finally{su<=Lp&&Gw(this),Fo=1<<--su,ps=this.parent,Lo=l,this.parent=void 0,this.deferStop&&this.stop()}}stop(){ps===this?this.deferStop=!0:this.active&&(n_(this),this.onStop&&this.onStop(),this.active=!1)}}function n_(e){const{deps:s}=e;if(s.length){for(let l=0;l<s.length;l++)s[l].delete(e);s.length=0}}let Lo=!0;const rx=[];function Ul(){rx.push(Lo),Lo=!1}function Nl(){const e=rx.pop();Lo=e===void 0?!0:e}function Ir(e,s,l){if(Lo&&ps){let h=ud.get(e);h||ud.set(e,h=new Map);let m=h.get(l);m||h.set(l,m=Tm()),sx(m)}}function sx(e,s){let l=!1;su<=Lp?ix(e)||(e.n|=Fo,l=!nx(e)):l=!e.has(ps),l&&(e.add(ps),ps.deps.push(e))}function Qs(e,s,l,h,m,_){const x=ud.get(e);if(!x)return;let a=[];if(s==="clear")a=[...x.values()];else if(l==="length"&&Qt(e)){const I=Number(h);x.forEach((T,M)=>{(M==="length"||M>=I)&&a.push(T)})}else switch(l!==void 0&&a.push(x.get(l)),s){case"add":Qt(e)?Cm(l)&&a.push(x.get("length")):(a.push(x.get(va)),kl(e)&&a.push(x.get(Rp)));break;case"delete":Qt(e)||(a.push(x.get(va)),kl(e)&&a.push(x.get(Rp)));break;case"set":kl(e)&&a.push(x.get(va));break}if(a.length===1)a[0]&&Bp(a[0]);else{const I=[];for(const T of a)T&&I.push(...T);Bp(Tm(I))}}function Bp(e,s){const l=Qt(e)?e:[...e];for(const h of l)h.computed&&i_(h);for(const h of l)h.computed||i_(h)}function i_(e,s){(e!==ps||e.allowRecurse)&&(e.scheduler?e.scheduler():e.run())}function Ww(e,s){var l;return(l=ud.get(e))==null?void 0:l.get(s)}const Hw=xm("__proto__,__v_isRef,__isVue"),ox=new Set(Object.getOwnPropertyNames(Symbol).filter(e=>e!=="arguments"&&e!=="caller").map(e=>Symbol[e]).filter(Sm)),Xw=Am(),Kw=Am(!1,!0),Yw=Am(!0),r_=Jw();function Jw(){const e={};return["includes","indexOf","lastIndexOf"].forEach(s=>{e[s]=function(...l){const h=rn(this);for(let _=0,x=this.length;_<x;_++)Ir(h,"get",_+"");const m=h[s](...l);return m===-1||m===!1?h[s](...l.map(rn)):m}}),["push","pop","shift","unshift","splice"].forEach(s=>{e[s]=function(...l){Ul();const h=rn(this)[s].apply(this,l);return Nl(),h}}),e}function Qw(e){const s=rn(this);return Ir(s,"has",e),s.hasOwnProperty(e)}function Am(e=!1,s=!1){return function(h,m,_){if(m==="__v_isReactive")return!e;if(m==="__v_isReadonly")return e;if(m==="__v_isShallow")return s;if(m==="__v_raw"&&_===(e?s?m2:hx:s?ux:cx).get(h))return h;const x=Qt(h);if(!e){if(x&&Pn(r_,m))return Reflect.get(r_,m,_);if(m==="hasOwnProperty")return Qw}const a=Reflect.get(h,m,_);return(Sm(m)?ox.has(m):Hw(m))||(e||Ir(h,"get",m),s)?a:qn(a)?x&&Cm(m)?a:a.value:Hn(a)?e?Ru(a):Oi(a):a}}const e2=ax(),t2=ax(!0);function ax(e=!1){return function(l,h,m,_){let x=l[h];if(Ll(x)&&qn(x)&&!qn(m))return!1;if(!e&&(!hd(m)&&!Ll(m)&&(x=rn(x),m=rn(m)),!Qt(l)&&qn(x)&&!qn(m)))return x.value=m,!0;const a=Qt(l)&&Cm(h)?Number(h)<l.length:Pn(l,h),I=Reflect.set(l,h,m,_);return l===rn(_)&&(a?mu(m,x)&&Qs(l,"set",h,m):Qs(l,"add",h,m)),I}}function n2(e,s){const l=Pn(e,s);e[s];const h=Reflect.deleteProperty(e,s);return h&&l&&Qs(e,"delete",s,void 0),h}function i2(e,s){const l=Reflect.has(e,s);return(!Sm(s)||!ox.has(s))&&Ir(e,"has",s),l}function r2(e){return Ir(e,"iterate",Qt(e)?"length":va),Reflect.ownKeys(e)}const lx={get:Xw,set:e2,deleteProperty:n2,has:i2,ownKeys:r2},s2={get:Yw,set(e,s){return!0},deleteProperty(e,s){return!0}},o2=vi({},lx,{get:Kw,set:t2}),Pm=e=>e,Rd=e=>Reflect.getPrototypeOf(e);function Zh(e,s,l=!1,h=!1){e=e.__v_raw;const m=rn(e),_=rn(s);l||(s!==_&&Ir(m,"get",s),Ir(m,"get",_));const{has:x}=Rd(m),a=h?Pm:l?Dm:gu;if(x.call(m,s))return a(e.get(s));if(x.call(m,_))return a(e.get(_));e!==m&&e.get(s)}function Gh(e,s=!1){const l=this.__v_raw,h=rn(l),m=rn(e);return s||(e!==m&&Ir(h,"has",e),Ir(h,"has",m)),e===m?l.has(e):l.has(e)||l.has(m)}function Wh(e,s=!1){return e=e.__v_raw,!s&&Ir(rn(e),"iterate",va),Reflect.get(e,"size",e)}function s_(e){e=rn(e);const s=rn(this);return Rd(s).has.call(s,e)||(s.add(e),Qs(s,"add",e,e)),this}function o_(e,s){s=rn(s);const l=rn(this),{has:h,get:m}=Rd(l);let _=h.call(l,e);_||(e=rn(e),_=h.call(l,e));const x=m.call(l,e);return l.set(e,s),_?mu(s,x)&&Qs(l,"set",e,s):Qs(l,"add",e,s),this}function a_(e){const s=rn(this),{has:l,get:h}=Rd(s);let m=l.call(s,e);m||(e=rn(e),m=l.call(s,e)),h&&h.call(s,e);const _=s.delete(e);return m&&Qs(s,"delete",e,void 0),_}function l_(){const e=rn(this),s=e.size!==0,l=e.clear();return s&&Qs(e,"clear",void 0,void 0),l}function Hh(e,s){return function(h,m){const _=this,x=_.__v_raw,a=rn(x),I=s?Pm:e?Dm:gu;return!e&&Ir(a,"iterate",va),x.forEach((T,M)=>h.call(m,I(T),I(M),_))}}function Xh(e,s,l){return function(...h){const m=this.__v_raw,_=rn(m),x=kl(_),a=e==="entries"||e===Symbol.iterator&&x,I=e==="keys"&&x,T=m[e](...h),M=l?Pm:s?Dm:gu;return!s&&Ir(_,"iterate",I?Rp:va),{next(){const{value:k,done:F}=T.next();return F?{value:k,done:F}:{value:a?[M(k[0]),M(k[1])]:M(k),done:F}},[Symbol.iterator](){return this}}}}function To(e){return function(...s){return e==="delete"?!1:this}}function a2(){const e={get(_){return Zh(this,_)},get size(){return Wh(this)},has:Gh,add:s_,set:o_,delete:a_,clear:l_,forEach:Hh(!1,!1)},s={get(_){return Zh(this,_,!1,!0)},get size(){return Wh(this)},has:Gh,add:s_,set:o_,delete:a_,clear:l_,forEach:Hh(!1,!0)},l={get(_){return Zh(this,_,!0)},get size(){return Wh(this,!0)},has(_){return Gh.call(this,_,!0)},add:To("add"),set:To("set"),delete:To("delete"),clear:To("clear"),forEach:Hh(!0,!1)},h={get(_){return Zh(this,_,!0,!0)},get size(){return Wh(this,!0)},has(_){return Gh.call(this,_,!0)},add:To("add"),set:To("set"),delete:To("delete"),clear:To("clear"),forEach:Hh(!0,!0)};return["keys","values","entries",Symbol.iterator].forEach(_=>{e[_]=Xh(_,!1,!1),l[_]=Xh(_,!0,!1),s[_]=Xh(_,!1,!0),h[_]=Xh(_,!0,!0)}),[e,l,s,h]}const[l2,c2,u2,h2]=a2();function km(e,s){const l=s?e?h2:u2:e?c2:l2;return(h,m,_)=>m==="__v_isReactive"?!e:m==="__v_isReadonly"?e:m==="__v_raw"?h:Reflect.get(Pn(l,m)&&m in h?l:h,m,_)}const d2={get:km(!1,!1)},f2={get:km(!1,!0)},p2={get:km(!0,!1)},cx=new WeakMap,ux=new WeakMap,hx=new WeakMap,m2=new WeakMap;function g2(e){switch(e){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function y2(e){return e.__v_skip||!Object.isExtensible(e)?0:g2(Lw(e))}function Oi(e){return Ll(e)?e:Mm(e,!1,lx,d2,cx)}function _2(e){return Mm(e,!1,o2,f2,ux)}function Ru(e){return Mm(e,!0,s2,p2,hx)}function Mm(e,s,l,h,m){if(!Hn(e)||e.__v_raw&&!(s&&e.__v_isReactive))return e;const _=m.get(e);if(_)return _;const x=y2(e);if(x===0)return e;const a=new Proxy(e,x===2?h:l);return m.set(e,a),a}function Ro(e){return Ll(e)?Ro(e.__v_raw):!!(e&&e.__v_isReactive)}function Ll(e){return!!(e&&e.__v_isReadonly)}function hd(e){return!!(e&&e.__v_isShallow)}function dx(e){return Ro(e)||Ll(e)}function rn(e){const s=e&&e.__v_raw;return s?rn(s):e}function Bd(e){return cd(e,"__v_skip",!0),e}const gu=e=>Hn(e)?Oi(e):e,Dm=e=>Hn(e)?Ru(e):e;function fx(e){Lo&&ps&&(e=rn(e),sx(e.dep||(e.dep=Tm())))}function px(e,s){e=rn(e);const l=e.dep;l&&Bp(l)}function qn(e){return!!(e&&e.__v_isRef===!0)}function Kt(e){return mx(e,!1)}function bn(e){return mx(e,!0)}function mx(e,s){return qn(e)?e:new v2(e,s)}class v2{constructor(s,l){this.__v_isShallow=l,this.dep=void 0,this.__v_isRef=!0,this._rawValue=l?s:rn(s),this._value=l?s:gu(s)}get value(){return fx(this),this._value}set value(s){const l=this.__v_isShallow||hd(s)||Ll(s);s=l?s:rn(s),mu(s,this._rawValue)&&(this._rawValue=s,this._value=l?s:gu(s),px(this))}}function Wi(e){return qn(e)?e.value:e}const x2={get:(e,s,l)=>Wi(Reflect.get(e,s,l)),set:(e,s,l,h)=>{const m=e[s];return qn(m)&&!qn(l)?(m.value=l,!0):Reflect.set(e,s,l,h)}};function gx(e){return Ro(e)?e:new Proxy(e,x2)}function Fd(e){const s=Qt(e)?new Array(e.length):{};for(const l in e)s[l]=yx(e,l);return s}class b2{constructor(s,l,h){this._object=s,this._key=l,this._defaultValue=h,this.__v_isRef=!0}get value(){const s=this._object[this._key];return s===void 0?this._defaultValue:s}set value(s){this._object[this._key]=s}get dep(){return Ww(rn(this._object),this._key)}}class w2{constructor(s){this._getter=s,this.__v_isRef=!0,this.__v_isReadonly=!0}get value(){return this._getter()}}function xn(e,s,l){return qn(e)?e:ln(e)?new w2(e):Hn(e)&&arguments.length>1?yx(e,s,l):Kt(e)}function yx(e,s,l){const h=e[s];return qn(h)?h:new b2(e,s,l)}class S2{constructor(s,l,h,m){this._setter=l,this.dep=void 0,this.__v_isRef=!0,this.__v_isReadonly=!1,this._dirty=!0,this.effect=new Im(s,()=>{this._dirty||(this._dirty=!0,px(this))}),this.effect.computed=this,this.effect.active=this._cacheable=!m,this.__v_isReadonly=h}get value(){const s=rn(this);return fx(s),(s._dirty||!s._cacheable)&&(s._dirty=!1,s._value=s.effect.run()),s._value}set value(s){this._setter(s)}}function C2(e,s,l=!1){let h,m;const _=ln(e);return _?(h=e,m=gs):(h=e.get,m=e.set),new S2(h,m,_||!m,l)}function Bo(e,s,l,h){let m;try{m=h?e(...h):e()}catch(_){Od(_,s,l)}return m}function ts(e,s,l,h){if(ln(e)){const _=Bo(e,s,l,h);return _&&Xv(_)&&_.catch(x=>{Od(x,s,l)}),_}const m=[];for(let _=0;_<e.length;_++)m.push(ts(e[_],s,l,h));return m}function Od(e,s,l,h=!0){const m=s?s.vnode:null;if(s){let _=s.parent;const x=s.proxy,a=l;for(;_;){const T=_.ec;if(T){for(let M=0;M<T.length;M++)if(T[M](e,x,a)===!1)return}_=_.parent}const I=s.appContext.config.errorHandler;if(I){Bo(I,null,10,[e,x,a]);return}}E2(e,l,m,h)}function E2(e,s,l,h=!0){console.error(e)}let yu=!1,Fp=!1;const Ji=[];let Ms=0;const Ml=[];let Js=null,pa=0;const _x=Promise.resolve();let zm=null;function er(e){const s=zm||_x;return e?s.then(this?e.bind(this):e):s}function T2(e){let s=Ms+1,l=Ji.length;for(;s<l;){const h=s+l>>>1;_u(Ji[h])<e?s=h+1:l=h}return s}function Lm(e){(!Ji.length||!Ji.includes(e,yu&&e.allowRecurse?Ms+1:Ms))&&(e.id==null?Ji.push(e):Ji.splice(T2(e.id),0,e),vx())}function vx(){!yu&&!Fp&&(Fp=!0,zm=_x.then(bx))}function I2(e){const s=Ji.indexOf(e);s>Ms&&Ji.splice(s,1)}function A2(e){Qt(e)?Ml.push(...e):(!Js||!Js.includes(e,e.allowRecurse?pa+1:pa))&&Ml.push(e),vx()}function c_(e,s=yu?Ms+1:0){for(;s<Ji.length;s++){const l=Ji[s];l&&l.pre&&(Ji.splice(s,1),s--,l())}}function xx(e){if(Ml.length){const s=[...new Set(Ml)];if(Ml.length=0,Js){Js.push(...s);return}for(Js=s,Js.sort((l,h)=>_u(l)-_u(h)),pa=0;pa<Js.length;pa++)Js[pa]();Js=null,pa=0}}const _u=e=>e.id==null?1/0:e.id,P2=(e,s)=>{const l=_u(e)-_u(s);if(l===0){if(e.pre&&!s.pre)return-1;if(s.pre&&!e.pre)return 1}return l};function bx(e){Fp=!1,yu=!0,Ji.sort(P2);const s=gs;try{for(Ms=0;Ms<Ji.length;Ms++){const l=Ji[Ms];l&&l.active!==!1&&Bo(l,null,14)}}finally{Ms=0,Ji.length=0,xx(),yu=!1,zm=null,(Ji.length||Ml.length)&&bx()}}function k2(e,s,...l){if(e.isUnmounted)return;const h=e.vnode.props||Kn;let m=l;const _=s.startsWith("update:"),x=_&&s.slice(7);if(x&&x in h){const M=`${x==="modelValue"?"model":x}Modifiers`,{number:k,trim:F}=h[M]||Kn;F&&(m=l.map(q=>pi(q)?q.trim():q)),k&&(m=l.map(Dp))}let a,I=h[a=dp(s)]||h[a=dp(ns(s))];!I&&_&&(I=h[a=dp(Vl(s))]),I&&ts(I,e,6,m);const T=h[a+"Once"];if(T){if(!e.emitted)e.emitted={};else if(e.emitted[a])return;e.emitted[a]=!0,ts(T,e,6,m)}}function wx(e,s,l=!1){const h=s.emitsCache,m=h.get(e);if(m!==void 0)return m;const _=e.emits;let x={},a=!1;if(!ln(e)){const I=T=>{const M=wx(T,s,!0);M&&(a=!0,vi(x,M))};!l&&s.mixins.length&&s.mixins.forEach(I),e.extends&&I(e.extends),e.mixins&&e.mixins.forEach(I)}return!_&&!a?(Hn(e)&&h.set(e,null),null):(Qt(_)?_.forEach(I=>x[I]=null):vi(x,_),Hn(e)&&h.set(e,x),x)}function Vd(e,s){return!e||!Md(s)?!1:(s=s.slice(2).replace(/Once$/,""),Pn(e,s[0].toLowerCase()+s.slice(1))||Pn(e,Vl(s))||Pn(e,s))}let Er=null,Sx=null;function dd(e){const s=Er;return Er=e,Sx=e&&e.type.__scopeId||null,s}function Cx(e,s=Er,l){if(!s||e._n)return e;const h=(...m)=>{h._d&&w_(-1);const _=dd(s);let x;try{x=e(...m)}finally{dd(_),h._d&&w_(1)}return x};return h._n=!0,h._c=!0,h._d=!0,h}function fp(e){const{type:s,vnode:l,proxy:h,withProxy:m,props:_,propsOptions:[x],slots:a,attrs:I,emit:T,render:M,renderCache:k,data:F,setupState:q,ctx:X,inheritAttrs:re}=e;let me,ye;const Ee=dd(e);try{if(l.shapeFlag&4){const Oe=m||h;me=ks(M.call(Oe,Oe,k,_,q,F,X)),ye=I}else{const Oe=s;me=ks(Oe.length>1?Oe(_,{attrs:I,slots:a,emit:T}):Oe(_,null)),ye=s.props?I:M2(I)}}catch(Oe){uu.length=0,Od(Oe,e,1),me=ae(ys)}let be=me;if(ye&&re!==!1){const Oe=Object.keys(ye),{shapeFlag:Qe}=be;Oe.length&&Qe&7&&(x&&Oe.some(bm)&&(ye=D2(ye,x)),be=eo(be,ye))}return l.dirs&&(be=eo(be),be.dirs=be.dirs?be.dirs.concat(l.dirs):l.dirs),l.transition&&(be.transition=l.transition),me=be,dd(Ee),me}const M2=e=>{let s;for(const l in e)(l==="class"||l==="style"||Md(l))&&((s||(s={}))[l]=e[l]);return s},D2=(e,s)=>{const l={};for(const h in e)(!bm(h)||!(h.slice(9)in s))&&(l[h]=e[h]);return l};function z2(e,s,l){const{props:h,children:m,component:_}=e,{props:x,children:a,patchFlag:I}=s,T=_.emitsOptions;if(s.dirs||s.transition)return!0;if(l&&I>=0){if(I&1024)return!0;if(I&16)return h?u_(h,x,T):!!x;if(I&8){const M=s.dynamicProps;for(let k=0;k<M.length;k++){const F=M[k];if(x[F]!==h[F]&&!Vd(T,F))return!0}}}else return(m||a)&&(!a||!a.$stable)?!0:h===x?!1:h?x?u_(h,x,T):!0:!!x;return!1}function u_(e,s,l){const h=Object.keys(s);if(h.length!==Object.keys(e).length)return!0;for(let m=0;m<h.length;m++){const _=h[m];if(s[_]!==e[_]&&!Vd(l,_))return!0}return!1}function L2({vnode:e,parent:s},l){for(;s&&s.subTree===e;)(e=s.vnode).el=l,s=s.parent}const R2=e=>e.__isSuspense;function B2(e,s){s&&s.pendingBranch?Qt(e)?s.effects.push(...e):s.effects.push(e):A2(e)}function ro(e,s){return Rm(e,null,s)}const Kh={};function wn(e,s,l){return Rm(e,s,l)}function Rm(e,s,{immediate:l,deep:h,flush:m,onTrack:_,onTrigger:x}=Kn){var a;const I=tx()===((a=ki)==null?void 0:a.scope)?ki:null;let T,M=!1,k=!1;if(qn(e)?(T=()=>e.value,M=hd(e)):Ro(e)?(T=()=>e,h=!0):Qt(e)?(k=!0,M=e.some(Oe=>Ro(Oe)||hd(Oe)),T=()=>e.map(Oe=>{if(qn(Oe))return Oe.value;if(Ro(Oe))return ya(Oe);if(ln(Oe))return Bo(Oe,I,2)})):ln(e)?s?T=()=>Bo(e,I,2):T=()=>{if(!(I&&I.isUnmounted))return F&&F(),ts(e,I,3,[q])}:T=gs,s&&h){const Oe=T;T=()=>ya(Oe())}let F,q=Oe=>{F=Ee.onStop=()=>{Bo(Oe,I,4)}},X;if(Cu)if(q=gs,s?l&&ts(s,I,3,[T(),k?[]:void 0,q]):T(),m==="sync"){const Oe=kS();X=Oe.__watcherHandles||(Oe.__watcherHandles=[])}else return gs;let re=k?new Array(e.length).fill(Kh):Kh;const me=()=>{if(Ee.active)if(s){const Oe=Ee.run();(h||M||(k?Oe.some((Qe,Ue)=>mu(Qe,re[Ue])):mu(Oe,re)))&&(F&&F(),ts(s,I,3,[Oe,re===Kh?void 0:k&&re[0]===Kh?[]:re,q]),re=Oe)}else Ee.run()};me.allowRecurse=!!s;let ye;m==="sync"?ye=me:m==="post"?ye=()=>Cr(me,I&&I.suspense):(me.pre=!0,I&&(me.id=I.uid),ye=()=>Lm(me));const Ee=new Im(T,ye);s?l?me():re=Ee.run():m==="post"?Cr(Ee.run.bind(Ee),I&&I.suspense):Ee.run();const be=()=>{Ee.stop(),I&&I.scope&&wm(I.scope.effects,Ee)};return X&&X.push(be),be}function F2(e,s,l){const h=this.proxy,m=pi(e)?e.includes(".")?Ex(h,e):()=>h[e]:e.bind(h,h);let _;ln(s)?_=s:(_=s.handler,l=s);const x=ki;Rl(this);const a=Rm(m,_.bind(h),l);return x?Rl(x):xa(),a}function Ex(e,s){const l=s.split(".");return()=>{let h=e;for(let m=0;m<l.length&&h;m++)h=h[l[m]];return h}}function ya(e,s){if(!Hn(e)||e.__v_skip||(s=s||new Set,s.has(e)))return e;if(s.add(e),qn(e))ya(e.value,s);else if(Qt(e))for(let l=0;l<e.length;l++)ya(e[l],s);else if(Hv(e)||kl(e))e.forEach(l=>{ya(l,s)});else if(Yv(e))for(const l in e)ya(e[l],s);return e}function Ur(e,s){const l=Er;if(l===null)return e;const h=Zd(l)||l.proxy,m=e.dirs||(e.dirs=[]);for(let _=0;_<s.length;_++){let[x,a,I,T=Kn]=s[_];x&&(ln(x)&&(x={mounted:x,updated:x}),x.deep&&ya(a),m.push({dir:x,instance:h,value:a,oldValue:void 0,arg:I,modifiers:T}))}return e}function ua(e,s,l,h){const m=e.dirs,_=s&&s.dirs;for(let x=0;x<m.length;x++){const a=m[x];_&&(a.oldValue=_[x].value);let I=a.dir[h];I&&(Ul(),ts(I,l,8,[e.el,a,e,s]),Nl())}}function Tx(){const e={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return Ca(()=>{e.isMounted=!0}),oo(()=>{e.isUnmounting=!0}),e}const Qr=[Function,Array],Ix={mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:Qr,onEnter:Qr,onAfterEnter:Qr,onEnterCancelled:Qr,onBeforeLeave:Qr,onLeave:Qr,onAfterLeave:Qr,onLeaveCancelled:Qr,onBeforeAppear:Qr,onAppear:Qr,onAfterAppear:Qr,onAppearCancelled:Qr},O2={name:"BaseTransition",props:Ix,setup(e,{slots:s}){const l=qm(),h=Tx();let m;return()=>{const _=s.default&&Bm(s.default(),!0);if(!_||!_.length)return;let x=_[0];if(_.length>1){for(const re of _)if(re.type!==ys){x=re;break}}const a=rn(e),{mode:I}=a;if(h.isLeaving)return pp(x);const T=h_(x);if(!T)return pp(x);const M=vu(T,a,h,l);xu(T,M);const k=l.subTree,F=k&&h_(k);let q=!1;const{getTransitionKey:X}=T.type;if(X){const re=X();m===void 0?m=re:re!==m&&(m=re,q=!0)}if(F&&F.type!==ys&&(!ma(T,F)||q)){const re=vu(F,a,h,l);if(xu(F,re),I==="out-in")return h.isLeaving=!0,re.afterLeave=()=>{h.isLeaving=!1,l.update.active!==!1&&l.update()},pp(x);I==="in-out"&&T.type!==ys&&(re.delayLeave=(me,ye,Ee)=>{const be=Ax(h,F);be[String(F.key)]=F,me._leaveCb=()=>{ye(),me._leaveCb=void 0,delete M.delayedLeave},M.delayedLeave=Ee})}return x}}},V2=O2;function Ax(e,s){const{leavingVNodes:l}=e;let h=l.get(s.type);return h||(h=Object.create(null),l.set(s.type,h)),h}function vu(e,s,l,h){const{appear:m,mode:_,persisted:x=!1,onBeforeEnter:a,onEnter:I,onAfterEnter:T,onEnterCancelled:M,onBeforeLeave:k,onLeave:F,onAfterLeave:q,onLeaveCancelled:X,onBeforeAppear:re,onAppear:me,onAfterAppear:ye,onAppearCancelled:Ee}=s,be=String(e.key),Oe=Ax(l,e),Qe=(j,G)=>{j&&ts(j,h,9,G)},Ue=(j,G)=>{const pe=G[1];Qe(j,G),Qt(j)?j.every(Se=>Se.length<=1)&&pe():j.length<=1&&pe()},ze={mode:_,persisted:x,beforeEnter(j){let G=a;if(!l.isMounted)if(m)G=re||a;else return;j._leaveCb&&j._leaveCb(!0);const pe=Oe[be];pe&&ma(e,pe)&&pe.el._leaveCb&&pe.el._leaveCb(),Qe(G,[j])},enter(j){let G=I,pe=T,Se=M;if(!l.isMounted)if(m)G=me||I,pe=ye||T,Se=Ee||M;else return;let Ce=!1;const _e=j._enterCb=Fe=>{Ce||(Ce=!0,Fe?Qe(Se,[j]):Qe(pe,[j]),ze.delayedLeave&&ze.delayedLeave(),j._enterCb=void 0)};G?Ue(G,[j,_e]):_e()},leave(j,G){const pe=String(e.key);if(j._enterCb&&j._enterCb(!0),l.isUnmounting)return G();Qe(k,[j]);let Se=!1;const Ce=j._leaveCb=_e=>{Se||(Se=!0,G(),_e?Qe(X,[j]):Qe(q,[j]),j._leaveCb=void 0,Oe[pe]===e&&delete Oe[pe])};Oe[pe]=e,F?Ue(F,[j,Ce]):Ce()},clone(j){return vu(j,s,l,h)}};return ze}function pp(e){if(Ud(e))return e=eo(e),e.children=null,e}function h_(e){return Ud(e)?e.children?e.children[0]:void 0:e}function xu(e,s){e.shapeFlag&6&&e.component?xu(e.component.subTree,s):e.shapeFlag&128?(e.ssContent.transition=s.clone(e.ssContent),e.ssFallback.transition=s.clone(e.ssFallback)):e.transition=s}function Bm(e,s=!1,l){let h=[],m=0;for(let _=0;_<e.length;_++){let x=e[_];const a=l==null?x.key:String(l)+String(x.key!=null?x.key:_);x.type===mn?(x.patchFlag&128&&m++,h=h.concat(Bm(x.children,s,a))):(s||x.type!==ys)&&h.push(a!=null?eo(x,{key:a}):x)}if(m>1)for(let _=0;_<h.length;_++)h[_].patchFlag=-2;return h}function $d(e,s){return ln(e)?(()=>vi({name:e.name},s,{setup:e}))():e}const rd=e=>!!e.type.__asyncLoader,Ud=e=>e.type.__isKeepAlive;function $2(e,s){Px(e,"a",s)}function U2(e,s){Px(e,"da",s)}function Px(e,s,l=ki){const h=e.__wdc||(e.__wdc=()=>{let m=l;for(;m;){if(m.isDeactivated)return;m=m.parent}return e()});if(Nd(s,h,l),l){let m=l.parent;for(;m&&m.parent;)Ud(m.parent.vnode)&&N2(h,s,l,m),m=m.parent}}function N2(e,s,l,h){const m=Nd(s,e,h,!0);Mx(()=>{wm(h[s],m)},l)}function Nd(e,s,l=ki,h=!1){if(l){const m=l[e]||(l[e]=[]),_=s.__weh||(s.__weh=(...x)=>{if(l.isUnmounted)return;Ul(),Rl(l);const a=ts(s,l,e,x);return xa(),Nl(),a});return h?m.unshift(_):m.push(_),_}}const so=e=>(s,l=ki)=>(!Cu||e==="sp")&&Nd(e,(...h)=>s(...h),l),Fm=so("bm"),Ca=so("m"),j2=so("bu"),kx=so("u"),oo=so("bum"),Mx=so("um"),q2=so("sp"),Z2=so("rtg"),G2=so("rtc");function W2(e,s=ki){Nd("ec",e,s)}const Om="components",H2="directives";function Gi(e,s){return Vm(Om,e,!0,s)||e}const Dx=Symbol.for("v-ndc");function X2(e){return pi(e)?Vm(Om,e,!1)||e:e||Dx}function wa(e){return Vm(H2,e)}function Vm(e,s,l=!0,h=!1){const m=Er||ki;if(m){const _=m.type;if(e===Om){const a=IS(_,!1);if(a&&(a===s||a===ns(s)||a===$l(ns(s))))return _}const x=d_(m[e]||_[e],s)||d_(m.appContext[e],s);return!x&&h?_:x}}function d_(e,s){return e&&(e[s]||e[ns(s)]||e[$l(ns(s))])}function Dl(e,s,l,h){let m;const _=l&&l[h];if(Qt(e)||pi(e)){m=new Array(e.length);for(let x=0,a=e.length;x<a;x++)m[x]=s(e[x],x,void 0,_&&_[x])}else if(typeof e=="number"){m=new Array(e);for(let x=0;x<e;x++)m[x]=s(x+1,x,void 0,_&&_[x])}else if(Hn(e))if(e[Symbol.iterator])m=Array.from(e,(x,a)=>s(x,a,void 0,_&&_[a]));else{const x=Object.keys(e);m=new Array(x.length);for(let a=0,I=x.length;a<I;a++){const T=x[a];m[a]=s(e[T],T,a,_&&_[a])}}else m=[];return l&&(l[h]=m),m}const Op=e=>e?jx(e)?Zd(e)||e.proxy:Op(e.parent):null,lu=vi(Object.create(null),{$:e=>e,$el:e=>e.vnode.el,$data:e=>e.data,$props:e=>e.props,$attrs:e=>e.attrs,$slots:e=>e.slots,$refs:e=>e.refs,$parent:e=>Op(e.parent),$root:e=>Op(e.root),$emit:e=>e.emit,$options:e=>$m(e),$forceUpdate:e=>e.f||(e.f=()=>Lm(e.update)),$nextTick:e=>e.n||(e.n=er.bind(e.proxy)),$watch:e=>F2.bind(e)}),mp=(e,s)=>e!==Kn&&!e.__isScriptSetup&&Pn(e,s),K2={get({_:e},s){const{ctx:l,setupState:h,data:m,props:_,accessCache:x,type:a,appContext:I}=e;let T;if(s[0]!=="$"){const q=x[s];if(q!==void 0)switch(q){case 1:return h[s];case 2:return m[s];case 4:return l[s];case 3:return _[s]}else{if(mp(h,s))return x[s]=1,h[s];if(m!==Kn&&Pn(m,s))return x[s]=2,m[s];if((T=e.propsOptions[0])&&Pn(T,s))return x[s]=3,_[s];if(l!==Kn&&Pn(l,s))return x[s]=4,l[s];Vp&&(x[s]=0)}}const M=lu[s];let k,F;if(M)return s==="$attrs"&&Ir(e,"get",s),M(e);if((k=a.__cssModules)&&(k=k[s]))return k;if(l!==Kn&&Pn(l,s))return x[s]=4,l[s];if(F=I.config.globalProperties,Pn(F,s))return F[s]},set({_:e},s,l){const{data:h,setupState:m,ctx:_}=e;return mp(m,s)?(m[s]=l,!0):h!==Kn&&Pn(h,s)?(h[s]=l,!0):Pn(e.props,s)||s[0]==="$"&&s.slice(1)in e?!1:(_[s]=l,!0)},has({_:{data:e,setupState:s,accessCache:l,ctx:h,appContext:m,propsOptions:_}},x){let a;return!!l[x]||e!==Kn&&Pn(e,x)||mp(s,x)||(a=_[0])&&Pn(a,x)||Pn(h,x)||Pn(lu,x)||Pn(m.config.globalProperties,x)},defineProperty(e,s,l){return l.get!=null?e._.accessCache[s]=0:Pn(l,"value")&&this.set(e,s,l.value,null),Reflect.defineProperty(e,s,l)}};function f_(e){return Qt(e)?e.reduce((s,l)=>(s[l]=null,s),{}):e}let Vp=!0;function Y2(e){const s=$m(e),l=e.proxy,h=e.ctx;Vp=!1,s.beforeCreate&&p_(s.beforeCreate,e,"bc");const{data:m,computed:_,methods:x,watch:a,provide:I,inject:T,created:M,beforeMount:k,mounted:F,beforeUpdate:q,updated:X,activated:re,deactivated:me,beforeDestroy:ye,beforeUnmount:Ee,destroyed:be,unmounted:Oe,render:Qe,renderTracked:Ue,renderTriggered:ze,errorCaptured:j,serverPrefetch:G,expose:pe,inheritAttrs:Se,components:Ce,directives:_e,filters:Fe}=s;if(T&&J2(T,h,null),x)for(const je in x){const Ve=x[je];ln(Ve)&&(h[je]=Ve.bind(l))}if(m){const je=m.call(l,l);Hn(je)&&(e.data=Oi(je))}if(Vp=!0,_)for(const je in _){const Ve=_[je],Ge=ln(Ve)?Ve.bind(l,l):ln(Ve.get)?Ve.get.bind(l,l):gs,Tt=!ln(Ve)&&ln(Ve.set)?Ve.set.bind(l):gs,At=we({get:Ge,set:Tt});Object.defineProperty(h,je,{enumerable:!0,configurable:!0,get:()=>At.value,set:rt=>At.value=rt})}if(a)for(const je in a)zx(a[je],h,l,je);if(I){const je=ln(I)?I.call(l):I;Reflect.ownKeys(je).forEach(Ve=>{Qi(Ve,je[Ve])})}M&&p_(M,e,"c");function at(je,Ve){Qt(Ve)?Ve.forEach(Ge=>je(Ge.bind(l))):Ve&&je(Ve.bind(l))}if(at(Fm,k),at(Ca,F),at(j2,q),at(kx,X),at($2,re),at(U2,me),at(W2,j),at(G2,Ue),at(Z2,ze),at(oo,Ee),at(Mx,Oe),at(q2,G),Qt(pe))if(pe.length){const je=e.exposed||(e.exposed={});pe.forEach(Ve=>{Object.defineProperty(je,Ve,{get:()=>l[Ve],set:Ge=>l[Ve]=Ge})})}else e.exposed||(e.exposed={});Qe&&e.render===gs&&(e.render=Qe),Se!=null&&(e.inheritAttrs=Se),Ce&&(e.components=Ce),_e&&(e.directives=_e)}function J2(e,s,l=gs){Qt(e)&&(e=$p(e));for(const h in e){const m=e[h];let _;Hn(m)?"default"in m?_=Zn(m.from||h,m.default,!0):_=Zn(m.from||h):_=Zn(m),qn(_)?Object.defineProperty(s,h,{enumerable:!0,configurable:!0,get:()=>_.value,set:x=>_.value=x}):s[h]=_}}function p_(e,s,l){ts(Qt(e)?e.map(h=>h.bind(s.proxy)):e.bind(s.proxy),s,l)}function zx(e,s,l,h){const m=h.includes(".")?Ex(l,h):()=>l[h];if(pi(e)){const _=s[e];ln(_)&&wn(m,_)}else if(ln(e))wn(m,e.bind(l));else if(Hn(e))if(Qt(e))e.forEach(_=>zx(_,s,l,h));else{const _=ln(e.handler)?e.handler.bind(l):s[e.handler];ln(_)&&wn(m,_,e)}}function $m(e){const s=e.type,{mixins:l,extends:h}=s,{mixins:m,optionsCache:_,config:{optionMergeStrategies:x}}=e.appContext,a=_.get(s);let I;return a?I=a:!m.length&&!l&&!h?I=s:(I={},m.length&&m.forEach(T=>fd(I,T,x,!0)),fd(I,s,x)),Hn(s)&&_.set(s,I),I}function fd(e,s,l,h=!1){const{mixins:m,extends:_}=s;_&&fd(e,_,l,!0),m&&m.forEach(x=>fd(e,x,l,!0));for(const x in s)if(!(h&&x==="expose")){const a=Q2[x]||l&&l[x];e[x]=a?a(e[x],s[x]):s[x]}return e}const Q2={data:m_,props:g_,emits:g_,methods:ou,computed:ou,beforeCreate:dr,created:dr,beforeMount:dr,mounted:dr,beforeUpdate:dr,updated:dr,beforeDestroy:dr,beforeUnmount:dr,destroyed:dr,unmounted:dr,activated:dr,deactivated:dr,errorCaptured:dr,serverPrefetch:dr,components:ou,directives:ou,watch:tS,provide:m_,inject:eS};function m_(e,s){return s?e?function(){return vi(ln(e)?e.call(this,this):e,ln(s)?s.call(this,this):s)}:s:e}function eS(e,s){return ou($p(e),$p(s))}function $p(e){if(Qt(e)){const s={};for(let l=0;l<e.length;l++)s[e[l]]=e[l];return s}return e}function dr(e,s){return e?[...new Set([].concat(e,s))]:s}function ou(e,s){return e?vi(Object.create(null),e,s):s}function g_(e,s){return e?Qt(e)&&Qt(s)?[...new Set([...e,...s])]:vi(Object.create(null),f_(e),f_(s??{})):s}function tS(e,s){if(!e)return s;if(!s)return e;const l=vi(Object.create(null),e);for(const h in s)l[h]=dr(e[h],s[h]);return l}function Lx(){return{app:null,config:{isNativeTag:Mw,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let nS=0;function iS(e,s){return function(h,m=null){ln(h)||(h=vi({},h)),m!=null&&!Hn(m)&&(m=null);const _=Lx(),x=new Set;let a=!1;const I=_.app={_uid:nS++,_component:h,_props:m,_container:null,_context:_,_instance:null,version:MS,get config(){return _.config},set config(T){},use(T,...M){return x.has(T)||(T&&ln(T.install)?(x.add(T),T.install(I,...M)):ln(T)&&(x.add(T),T(I,...M))),I},mixin(T){return _.mixins.includes(T)||_.mixins.push(T),I},component(T,M){return M?(_.components[T]=M,I):_.components[T]},directive(T,M){return M?(_.directives[T]=M,I):_.directives[T]},mount(T,M,k){if(!a){const F=ae(h,m);return F.appContext=_,M&&s?s(F,T):e(F,T,k),a=!0,I._container=T,T.__vue_app__=I,Zd(F.component)||F.component.proxy}},unmount(){a&&(e(null,I._container),delete I._container.__vue_app__)},provide(T,M){return _.provides[T]=M,I},runWithContext(T){bu=I;try{return T()}finally{bu=null}}};return I}}let bu=null;function Qi(e,s){if(ki){let l=ki.provides;const h=ki.parent&&ki.parent.provides;h===l&&(l=ki.provides=Object.create(h)),l[e]=s}}function Zn(e,s,l=!1){const h=ki||Er;if(h||bu){const m=h?h.parent==null?h.vnode.appContext&&h.vnode.appContext.provides:h.parent.provides:bu._context.provides;if(m&&e in m)return m[e];if(arguments.length>1)return l&&ln(s)?s.call(h&&h.proxy):s}}function rS(){return!!(ki||Er||bu)}function sS(e,s,l,h=!1){const m={},_={};cd(_,qd,1),e.propsDefaults=Object.create(null),Rx(e,s,m,_);for(const x in e.propsOptions[0])x in m||(m[x]=void 0);l?e.props=h?m:_2(m):e.type.props?e.props=m:e.props=_,e.attrs=_}function oS(e,s,l,h){const{props:m,attrs:_,vnode:{patchFlag:x}}=e,a=rn(m),[I]=e.propsOptions;let T=!1;if((h||x>0)&&!(x&16)){if(x&8){const M=e.vnode.dynamicProps;for(let k=0;k<M.length;k++){let F=M[k];if(Vd(e.emitsOptions,F))continue;const q=s[F];if(I)if(Pn(_,F))q!==_[F]&&(_[F]=q,T=!0);else{const X=ns(F);m[X]=Up(I,a,X,q,e,!1)}else q!==_[F]&&(_[F]=q,T=!0)}}}else{Rx(e,s,m,_)&&(T=!0);let M;for(const k in a)(!s||!Pn(s,k)&&((M=Vl(k))===k||!Pn(s,M)))&&(I?l&&(l[k]!==void 0||l[M]!==void 0)&&(m[k]=Up(I,a,k,void 0,e,!0)):delete m[k]);if(_!==a)for(const k in _)(!s||!Pn(s,k))&&(delete _[k],T=!0)}T&&Qs(e,"set","$attrs")}function Rx(e,s,l,h){const[m,_]=e.propsOptions;let x=!1,a;if(s)for(let I in s){if(nd(I))continue;const T=s[I];let M;m&&Pn(m,M=ns(I))?!_||!_.includes(M)?l[M]=T:(a||(a={}))[M]=T:Vd(e.emitsOptions,I)||(!(I in h)||T!==h[I])&&(h[I]=T,x=!0)}if(_){const I=rn(l),T=a||Kn;for(let M=0;M<_.length;M++){const k=_[M];l[k]=Up(m,I,k,T[k],e,!Pn(T,k))}}return x}function Up(e,s,l,h,m,_){const x=e[l];if(x!=null){const a=Pn(x,"default");if(a&&h===void 0){const I=x.default;if(x.type!==Function&&!x.skipFactory&&ln(I)){const{propsDefaults:T}=m;l in T?h=T[l]:(Rl(m),h=T[l]=I.call(null,s),xa())}else h=I}x[0]&&(_&&!a?h=!1:x[1]&&(h===""||h===Vl(l))&&(h=!0))}return h}function Bx(e,s,l=!1){const h=s.propsCache,m=h.get(e);if(m)return m;const _=e.props,x={},a=[];let I=!1;if(!ln(e)){const M=k=>{I=!0;const[F,q]=Bx(k,s,!0);vi(x,F),q&&a.push(...q)};!l&&s.mixins.length&&s.mixins.forEach(M),e.extends&&M(e.extends),e.mixins&&e.mixins.forEach(M)}if(!_&&!I)return Hn(e)&&h.set(e,Pl),Pl;if(Qt(_))for(let M=0;M<_.length;M++){const k=ns(_[M]);y_(k)&&(x[k]=Kn)}else if(_)for(const M in _){const k=ns(M);if(y_(k)){const F=_[M],q=x[k]=Qt(F)||ln(F)?{type:F}:vi({},F);if(q){const X=x_(Boolean,q.type),re=x_(String,q.type);q[0]=X>-1,q[1]=re<0||X<re,(X>-1||Pn(q,"default"))&&a.push(k)}}}const T=[x,a];return Hn(e)&&h.set(e,T),T}function y_(e){return e[0]!=="$"}function __(e){const s=e&&e.toString().match(/^\s*(function|class) (\w+)/);return s?s[2]:e===null?"null":""}function v_(e,s){return __(e)===__(s)}function x_(e,s){return Qt(s)?s.findIndex(l=>v_(l,e)):ln(s)&&v_(s,e)?0:-1}const Fx=e=>e[0]==="_"||e==="$stable",Um=e=>Qt(e)?e.map(ks):[ks(e)],aS=(e,s,l)=>{if(s._n)return s;const h=Cx((...m)=>Um(s(...m)),l);return h._c=!1,h},Ox=(e,s,l)=>{const h=e._ctx;for(const m in e){if(Fx(m))continue;const _=e[m];if(ln(_))s[m]=aS(m,_,h);else if(_!=null){const x=Um(_);s[m]=()=>x}}},Vx=(e,s)=>{const l=Um(s);e.slots.default=()=>l},lS=(e,s)=>{if(e.vnode.shapeFlag&32){const l=s._;l?(e.slots=rn(s),cd(s,"_",l)):Ox(s,e.slots={})}else e.slots={},s&&Vx(e,s);cd(e.slots,qd,1)},cS=(e,s,l)=>{const{vnode:h,slots:m}=e;let _=!0,x=Kn;if(h.shapeFlag&32){const a=s._;a?l&&a===1?_=!1:(vi(m,s),!l&&a===1&&delete m._):(_=!s.$stable,Ox(s,m)),x=s}else s&&(Vx(e,s),x={default:1});if(_)for(const a in m)!Fx(a)&&!(a in x)&&delete m[a]};function Np(e,s,l,h,m=!1){if(Qt(e)){e.forEach((F,q)=>Np(F,s&&(Qt(s)?s[q]:s),l,h,m));return}if(rd(h)&&!m)return;const _=h.shapeFlag&4?Zd(h.component)||h.component.proxy:h.el,x=m?null:_,{i:a,r:I}=e,T=s&&s.r,M=a.refs===Kn?a.refs={}:a.refs,k=a.setupState;if(T!=null&&T!==I&&(pi(T)?(M[T]=null,Pn(k,T)&&(k[T]=null)):qn(T)&&(T.value=null)),ln(I))Bo(I,a,12,[x,M]);else{const F=pi(I),q=qn(I);if(F||q){const X=()=>{if(e.f){const re=F?Pn(k,I)?k[I]:M[I]:I.value;m?Qt(re)&&wm(re,_):Qt(re)?re.includes(_)||re.push(_):F?(M[I]=[_],Pn(k,I)&&(k[I]=M[I])):(I.value=[_],e.k&&(M[e.k]=I.value))}else F?(M[I]=x,Pn(k,I)&&(k[I]=x)):q&&(I.value=x,e.k&&(M[e.k]=x))};x?(X.id=-1,Cr(X,l)):X()}}}const Cr=B2;function uS(e){return hS(e)}function hS(e,s){const l=zp();l.__VUE__=!0;const{insert:h,remove:m,patchProp:_,createElement:x,createText:a,createComment:I,setText:T,setElementText:M,parentNode:k,nextSibling:F,setScopeId:q=gs,insertStaticContent:X}=e,re=(K,ne,Z,ke=null,Be=null,Re=null,Ze=!1,ot=null,ht=!!ne.dynamicChildren)=>{if(K===ne)return;K&&!ma(K,ne)&&(ke=Ae(K),rt(K,Be,Re,!0),K=null),ne.patchFlag===-2&&(ht=!1,ne.dynamicChildren=null);const{type:Je,ref:lt,shapeFlag:ft}=ne;switch(Je){case Bu:me(K,ne,Z,ke);break;case ys:ye(K,ne,Z,ke);break;case gp:K==null&&Ee(ne,Z,ke,Ze);break;case mn:Ce(K,ne,Z,ke,Be,Re,Ze,ot,ht);break;default:ft&1?Qe(K,ne,Z,ke,Be,Re,Ze,ot,ht):ft&6?_e(K,ne,Z,ke,Be,Re,Ze,ot,ht):(ft&64||ft&128)&&Je.process(K,ne,Z,ke,Be,Re,Ze,ot,ht,Le)}lt!=null&&Be&&Np(lt,K&&K.ref,Re,ne||K,!ne)},me=(K,ne,Z,ke)=>{if(K==null)h(ne.el=a(ne.children),Z,ke);else{const Be=ne.el=K.el;ne.children!==K.children&&T(Be,ne.children)}},ye=(K,ne,Z,ke)=>{K==null?h(ne.el=I(ne.children||""),Z,ke):ne.el=K.el},Ee=(K,ne,Z,ke)=>{[K.el,K.anchor]=X(K.children,ne,Z,ke,K.el,K.anchor)},be=({el:K,anchor:ne},Z,ke)=>{let Be;for(;K&&K!==ne;)Be=F(K),h(K,Z,ke),K=Be;h(ne,Z,ke)},Oe=({el:K,anchor:ne})=>{let Z;for(;K&&K!==ne;)Z=F(K),m(K),K=Z;m(ne)},Qe=(K,ne,Z,ke,Be,Re,Ze,ot,ht)=>{Ze=Ze||ne.type==="svg",K==null?Ue(ne,Z,ke,Be,Re,Ze,ot,ht):G(K,ne,Be,Re,Ze,ot,ht)},Ue=(K,ne,Z,ke,Be,Re,Ze,ot)=>{let ht,Je;const{type:lt,props:ft,shapeFlag:Mt,transition:xt,dirs:$e}=K;if(ht=K.el=x(K.type,Re,ft&&ft.is,ft),Mt&8?M(ht,K.children):Mt&16&&j(K.children,ht,null,ke,Be,Re&&lt!=="foreignObject",Ze,ot),$e&&ua(K,null,ke,"created"),ze(ht,K,K.scopeId,Ze,ke),ft){for(const Wt in ft)Wt!=="value"&&!nd(Wt)&&_(ht,Wt,null,ft[Wt],Re,K.children,ke,Be,Ne);"value"in ft&&_(ht,"value",null,ft.value),(Je=ft.onVnodeBeforeMount)&&Ps(Je,ke,K)}$e&&ua(K,null,ke,"beforeMount");const en=(!Be||Be&&!Be.pendingBranch)&&xt&&!xt.persisted;en&&xt.beforeEnter(ht),h(ht,ne,Z),((Je=ft&&ft.onVnodeMounted)||en||$e)&&Cr(()=>{Je&&Ps(Je,ke,K),en&&xt.enter(ht),$e&&ua(K,null,ke,"mounted")},Be)},ze=(K,ne,Z,ke,Be)=>{if(Z&&q(K,Z),ke)for(let Re=0;Re<ke.length;Re++)q(K,ke[Re]);if(Be){let Re=Be.subTree;if(ne===Re){const Ze=Be.vnode;ze(K,Ze,Ze.scopeId,Ze.slotScopeIds,Be.parent)}}},j=(K,ne,Z,ke,Be,Re,Ze,ot,ht=0)=>{for(let Je=ht;Je<K.length;Je++){const lt=K[Je]=ot?Mo(K[Je]):ks(K[Je]);re(null,lt,ne,Z,ke,Be,Re,Ze,ot)}},G=(K,ne,Z,ke,Be,Re,Ze)=>{const ot=ne.el=K.el;let{patchFlag:ht,dynamicChildren:Je,dirs:lt}=ne;ht|=K.patchFlag&16;const ft=K.props||Kn,Mt=ne.props||Kn;let xt;Z&&ha(Z,!1),(xt=Mt.onVnodeBeforeUpdate)&&Ps(xt,Z,ne,K),lt&&ua(ne,K,Z,"beforeUpdate"),Z&&ha(Z,!0);const $e=Be&&ne.type!=="foreignObject";if(Je?pe(K.dynamicChildren,Je,ot,Z,ke,$e,Re):Ze||Ve(K,ne,ot,null,Z,ke,$e,Re,!1),ht>0){if(ht&16)Se(ot,ne,ft,Mt,Z,ke,Be);else if(ht&2&&ft.class!==Mt.class&&_(ot,"class",null,Mt.class,Be),ht&4&&_(ot,"style",ft.style,Mt.style,Be),ht&8){const en=ne.dynamicProps;for(let Wt=0;Wt<en.length;Wt++){const hn=en[Wt],Mn=ft[hn],nt=Mt[hn];(nt!==Mn||hn==="value")&&_(ot,hn,Mn,nt,Be,K.children,Z,ke,Ne)}}ht&1&&K.children!==ne.children&&M(ot,ne.children)}else!Ze&&Je==null&&Se(ot,ne,ft,Mt,Z,ke,Be);((xt=Mt.onVnodeUpdated)||lt)&&Cr(()=>{xt&&Ps(xt,Z,ne,K),lt&&ua(ne,K,Z,"updated")},ke)},pe=(K,ne,Z,ke,Be,Re,Ze)=>{for(let ot=0;ot<ne.length;ot++){const ht=K[ot],Je=ne[ot],lt=ht.el&&(ht.type===mn||!ma(ht,Je)||ht.shapeFlag&70)?k(ht.el):Z;re(ht,Je,lt,null,ke,Be,Re,Ze,!0)}},Se=(K,ne,Z,ke,Be,Re,Ze)=>{if(Z!==ke){if(Z!==Kn)for(const ot in Z)!nd(ot)&&!(ot in ke)&&_(K,ot,Z[ot],null,Ze,ne.children,Be,Re,Ne);for(const ot in ke){if(nd(ot))continue;const ht=ke[ot],Je=Z[ot];ht!==Je&&ot!=="value"&&_(K,ot,Je,ht,Ze,ne.children,Be,Re,Ne)}"value"in ke&&_(K,"value",Z.value,ke.value)}},Ce=(K,ne,Z,ke,Be,Re,Ze,ot,ht)=>{const Je=ne.el=K?K.el:a(""),lt=ne.anchor=K?K.anchor:a("");let{patchFlag:ft,dynamicChildren:Mt,slotScopeIds:xt}=ne;xt&&(ot=ot?ot.concat(xt):xt),K==null?(h(Je,Z,ke),h(lt,Z,ke),j(ne.children,Z,lt,Be,Re,Ze,ot,ht)):ft>0&&ft&64&&Mt&&K.dynamicChildren?(pe(K.dynamicChildren,Mt,Z,Be,Re,Ze,ot),(ne.key!=null||Be&&ne===Be.subTree)&&Nm(K,ne,!0)):Ve(K,ne,Z,lt,Be,Re,Ze,ot,ht)},_e=(K,ne,Z,ke,Be,Re,Ze,ot,ht)=>{ne.slotScopeIds=ot,K==null?ne.shapeFlag&512?Be.ctx.activate(ne,Z,ke,Ze,ht):Fe(ne,Z,ke,Be,Re,Ze,ht):ut(K,ne,ht)},Fe=(K,ne,Z,ke,Be,Re,Ze)=>{const ot=K.component=wS(K,ke,Be);if(Ud(K)&&(ot.ctx.renderer=Le),SS(ot),ot.asyncDep){if(Be&&Be.registerDep(ot,at),!K.el){const ht=ot.subTree=ae(ys);ye(null,ht,ne,Z)}return}at(ot,K,ne,Z,Be,Re,Ze)},ut=(K,ne,Z)=>{const ke=ne.component=K.component;if(z2(K,ne,Z))if(ke.asyncDep&&!ke.asyncResolved){je(ke,ne,Z);return}else ke.next=ne,I2(ke.update),ke.update();else ne.el=K.el,ke.vnode=ne},at=(K,ne,Z,ke,Be,Re,Ze)=>{const ot=()=>{if(K.isMounted){let{next:lt,bu:ft,u:Mt,parent:xt,vnode:$e}=K,en=lt,Wt;ha(K,!1),lt?(lt.el=$e.el,je(K,lt,Ze)):lt=$e,ft&&id(ft),(Wt=lt.props&&lt.props.onVnodeBeforeUpdate)&&Ps(Wt,xt,lt,$e),ha(K,!0);const hn=fp(K),Mn=K.subTree;K.subTree=hn,re(Mn,hn,k(Mn.el),Ae(Mn),K,Be,Re),lt.el=hn.el,en===null&&L2(K,hn.el),Mt&&Cr(Mt,Be),(Wt=lt.props&&lt.props.onVnodeUpdated)&&Cr(()=>Ps(Wt,xt,lt,$e),Be)}else{let lt;const{el:ft,props:Mt}=ne,{bm:xt,m:$e,parent:en}=K,Wt=rd(ne);if(ha(K,!1),xt&&id(xt),!Wt&&(lt=Mt&&Mt.onVnodeBeforeMount)&&Ps(lt,en,ne),ha(K,!0),ft&&wt){const hn=()=>{K.subTree=fp(K),wt(ft,K.subTree,K,Be,null)};Wt?ne.type.__asyncLoader().then(()=>!K.isUnmounted&&hn()):hn()}else{const hn=K.subTree=fp(K);re(null,hn,Z,ke,K,Be,Re),ne.el=hn.el}if($e&&Cr($e,Be),!Wt&&(lt=Mt&&Mt.onVnodeMounted)){const hn=ne;Cr(()=>Ps(lt,en,hn),Be)}(ne.shapeFlag&256||en&&rd(en.vnode)&&en.vnode.shapeFlag&256)&&K.a&&Cr(K.a,Be),K.isMounted=!0,ne=Z=ke=null}},ht=K.effect=new Im(ot,()=>Lm(Je),K.scope),Je=K.update=()=>ht.run();Je.id=K.uid,ha(K,!0),Je()},je=(K,ne,Z)=>{ne.component=K;const ke=K.vnode.props;K.vnode=ne,K.next=null,oS(K,ne.props,ke,Z),cS(K,ne.children,Z),Ul(),c_(),Nl()},Ve=(K,ne,Z,ke,Be,Re,Ze,ot,ht=!1)=>{const Je=K&&K.children,lt=K?K.shapeFlag:0,ft=ne.children,{patchFlag:Mt,shapeFlag:xt}=ne;if(Mt>0){if(Mt&128){Tt(Je,ft,Z,ke,Be,Re,Ze,ot,ht);return}else if(Mt&256){Ge(Je,ft,Z,ke,Be,Re,Ze,ot,ht);return}}xt&8?(lt&16&&Ne(Je,Be,Re),ft!==Je&&M(Z,ft)):lt&16?xt&16?Tt(Je,ft,Z,ke,Be,Re,Ze,ot,ht):Ne(Je,Be,Re,!0):(lt&8&&M(Z,""),xt&16&&j(ft,Z,ke,Be,Re,Ze,ot,ht))},Ge=(K,ne,Z,ke,Be,Re,Ze,ot,ht)=>{K=K||Pl,ne=ne||Pl;const Je=K.length,lt=ne.length,ft=Math.min(Je,lt);let Mt;for(Mt=0;Mt<ft;Mt++){const xt=ne[Mt]=ht?Mo(ne[Mt]):ks(ne[Mt]);re(K[Mt],xt,Z,null,Be,Re,Ze,ot,ht)}Je>lt?Ne(K,Be,Re,!0,!1,ft):j(ne,Z,ke,Be,Re,Ze,ot,ht,ft)},Tt=(K,ne,Z,ke,Be,Re,Ze,ot,ht)=>{let Je=0;const lt=ne.length;let ft=K.length-1,Mt=lt-1;for(;Je<=ft&&Je<=Mt;){const xt=K[Je],$e=ne[Je]=ht?Mo(ne[Je]):ks(ne[Je]);if(ma(xt,$e))re(xt,$e,Z,null,Be,Re,Ze,ot,ht);else break;Je++}for(;Je<=ft&&Je<=Mt;){const xt=K[ft],$e=ne[Mt]=ht?Mo(ne[Mt]):ks(ne[Mt]);if(ma(xt,$e))re(xt,$e,Z,null,Be,Re,Ze,ot,ht);else break;ft--,Mt--}if(Je>ft){if(Je<=Mt){const xt=Mt+1,$e=xt<lt?ne[xt].el:ke;for(;Je<=Mt;)re(null,ne[Je]=ht?Mo(ne[Je]):ks(ne[Je]),Z,$e,Be,Re,Ze,ot,ht),Je++}}else if(Je>Mt)for(;Je<=ft;)rt(K[Je],Be,Re,!0),Je++;else{const xt=Je,$e=Je,en=new Map;for(Je=$e;Je<=Mt;Je++){const dn=ne[Je]=ht?Mo(ne[Je]):ks(ne[Je]);dn.key!=null&&en.set(dn.key,Je)}let Wt,hn=0;const Mn=Mt-$e+1;let nt=!1,$t=0;const Nt=new Array(Mn);for(Je=0;Je<Mn;Je++)Nt[Je]=0;for(Je=xt;Je<=ft;Je++){const dn=K[Je];if(hn>=Mn){rt(dn,Be,Re,!0);continue}let Lt;if(dn.key!=null)Lt=en.get(dn.key);else for(Wt=$e;Wt<=Mt;Wt++)if(Nt[Wt-$e]===0&&ma(dn,ne[Wt])){Lt=Wt;break}Lt===void 0?rt(dn,Be,Re,!0):(Nt[Lt-$e]=Je+1,Lt>=$t?$t=Lt:nt=!0,re(dn,ne[Lt],Z,null,Be,Re,Ze,ot,ht),hn++)}const kn=nt?dS(Nt):Pl;for(Wt=kn.length-1,Je=Mn-1;Je>=0;Je--){const dn=$e+Je,Lt=ne[dn],yr=dn+1<lt?ne[dn+1].el:ke;Nt[Je]===0?re(null,Lt,Z,yr,Be,Re,Ze,ot,ht):nt&&(Wt<0||Je!==kn[Wt]?At(Lt,Z,yr,2):Wt--)}}},At=(K,ne,Z,ke,Be=null)=>{const{el:Re,type:Ze,transition:ot,children:ht,shapeFlag:Je}=K;if(Je&6){At(K.component.subTree,ne,Z,ke);return}if(Je&128){K.suspense.move(ne,Z,ke);return}if(Je&64){Ze.move(K,ne,Z,Le);return}if(Ze===mn){h(Re,ne,Z);for(let ft=0;ft<ht.length;ft++)At(ht[ft],ne,Z,ke);h(K.anchor,ne,Z);return}if(Ze===gp){be(K,ne,Z);return}if(ke!==2&&Je&1&&ot)if(ke===0)ot.beforeEnter(Re),h(Re,ne,Z),Cr(()=>ot.enter(Re),Be);else{const{leave:ft,delayLeave:Mt,afterLeave:xt}=ot,$e=()=>h(Re,ne,Z),en=()=>{ft(Re,()=>{$e(),xt&&xt()})};Mt?Mt(Re,$e,en):en()}else h(Re,ne,Z)},rt=(K,ne,Z,ke=!1,Be=!1)=>{const{type:Re,props:Ze,ref:ot,children:ht,dynamicChildren:Je,shapeFlag:lt,patchFlag:ft,dirs:Mt}=K;if(ot!=null&&Np(ot,null,Z,K,!0),lt&256){ne.ctx.deactivate(K);return}const xt=lt&1&&Mt,$e=!rd(K);let en;if($e&&(en=Ze&&Ze.onVnodeBeforeUnmount)&&Ps(en,ne,K),lt&6)Rt(K.component,Z,ke);else{if(lt&128){K.suspense.unmount(Z,ke);return}xt&&ua(K,null,ne,"beforeUnmount"),lt&64?K.type.remove(K,ne,Z,Be,Le,ke):Je&&(Re!==mn||ft>0&&ft&64)?Ne(Je,ne,Z,!1,!0):(Re===mn&&ft&384||!Be&&lt&16)&&Ne(ht,ne,Z),ke&&It(K)}($e&&(en=Ze&&Ze.onVnodeUnmounted)||xt)&&Cr(()=>{en&&Ps(en,ne,K),xt&&ua(K,null,ne,"unmounted")},Z)},It=K=>{const{type:ne,el:Z,anchor:ke,transition:Be}=K;if(ne===mn){Gt(Z,ke);return}if(ne===gp){Oe(K);return}const Re=()=>{m(Z),Be&&!Be.persisted&&Be.afterLeave&&Be.afterLeave()};if(K.shapeFlag&1&&Be&&!Be.persisted){const{leave:Ze,delayLeave:ot}=Be,ht=()=>Ze(Z,Re);ot?ot(K.el,Re,ht):ht()}else Re()},Gt=(K,ne)=>{let Z;for(;K!==ne;)Z=F(K),m(K),K=Z;m(ne)},Rt=(K,ne,Z)=>{const{bum:ke,scope:Be,update:Re,subTree:Ze,um:ot}=K;ke&&id(ke),Be.stop(),Re&&(Re.active=!1,rt(Ze,K,ne,Z)),ot&&Cr(ot,ne),Cr(()=>{K.isUnmounted=!0},ne),ne&&ne.pendingBranch&&!ne.isUnmounted&&K.asyncDep&&!K.asyncResolved&&K.suspenseId===ne.pendingId&&(ne.deps--,ne.deps===0&&ne.resolve())},Ne=(K,ne,Z,ke=!1,Be=!1,Re=0)=>{for(let Ze=Re;Ze<K.length;Ze++)rt(K[Ze],ne,Z,ke,Be)},Ae=K=>K.shapeFlag&6?Ae(K.component.subTree):K.shapeFlag&128?K.suspense.next():F(K.anchor||K.el),tt=(K,ne,Z)=>{K==null?ne._vnode&&rt(ne._vnode,null,null,!0):re(ne._vnode||null,K,ne,null,null,null,Z),c_(),xx(),ne._vnode=K},Le={p:re,um:rt,m:At,r:It,mt:Fe,mc:j,pc:Ve,pbc:pe,n:Ae,o:e};let He,wt;return s&&([He,wt]=s(Le)),{render:tt,hydrate:He,createApp:iS(tt,He)}}function ha({effect:e,update:s},l){e.allowRecurse=s.allowRecurse=l}function Nm(e,s,l=!1){const h=e.children,m=s.children;if(Qt(h)&&Qt(m))for(let _=0;_<h.length;_++){const x=h[_];let a=m[_];a.shapeFlag&1&&!a.dynamicChildren&&((a.patchFlag<=0||a.patchFlag===32)&&(a=m[_]=Mo(m[_]),a.el=x.el),l||Nm(x,a)),a.type===Bu&&(a.el=x.el)}}function dS(e){const s=e.slice(),l=[0];let h,m,_,x,a;const I=e.length;for(h=0;h<I;h++){const T=e[h];if(T!==0){if(m=l[l.length-1],e[m]<T){s[h]=m,l.push(h);continue}for(_=0,x=l.length-1;_<x;)a=_+x>>1,e[l[a]]<T?_=a+1:x=a;T<e[l[_]]&&(_>0&&(s[h]=l[_-1]),l[_]=h)}}for(_=l.length,x=l[_-1];_-- >0;)l[_]=x,x=s[x];return l}const fS=e=>e.__isTeleport,cu=e=>e&&(e.disabled||e.disabled===""),b_=e=>typeof SVGElement<"u"&&e instanceof SVGElement,jp=(e,s)=>{const l=e&&e.to;return pi(l)?s?s(l):null:l},pS={__isTeleport:!0,process(e,s,l,h,m,_,x,a,I,T){const{mc:M,pc:k,pbc:F,o:{insert:q,querySelector:X,createText:re,createComment:me}}=T,ye=cu(s.props);let{shapeFlag:Ee,children:be,dynamicChildren:Oe}=s;if(e==null){const Qe=s.el=re(""),Ue=s.anchor=re("");q(Qe,l,h),q(Ue,l,h);const ze=s.target=jp(s.props,X),j=s.targetAnchor=re("");ze&&(q(j,ze),x=x||b_(ze));const G=(pe,Se)=>{Ee&16&&M(be,pe,Se,m,_,x,a,I)};ye?G(l,Ue):ze&&G(ze,j)}else{s.el=e.el;const Qe=s.anchor=e.anchor,Ue=s.target=e.target,ze=s.targetAnchor=e.targetAnchor,j=cu(e.props),G=j?l:Ue,pe=j?Qe:ze;if(x=x||b_(Ue),Oe?(F(e.dynamicChildren,Oe,G,m,_,x,a),Nm(e,s,!0)):I||k(e,s,G,pe,m,_,x,a,!1),ye)j||Yh(s,l,Qe,T,1);else if((s.props&&s.props.to)!==(e.props&&e.props.to)){const Se=s.target=jp(s.props,X);Se&&Yh(s,Se,null,T,0)}else j&&Yh(s,Ue,ze,T,1)}$x(s)},remove(e,s,l,h,{um:m,o:{remove:_}},x){const{shapeFlag:a,children:I,anchor:T,targetAnchor:M,target:k,props:F}=e;if(k&&_(M),(x||!cu(F))&&(_(T),a&16))for(let q=0;q<I.length;q++){const X=I[q];m(X,s,l,!0,!!X.dynamicChildren)}},move:Yh,hydrate:mS};function Yh(e,s,l,{o:{insert:h},m},_=2){_===0&&h(e.targetAnchor,s,l);const{el:x,anchor:a,shapeFlag:I,children:T,props:M}=e,k=_===2;if(k&&h(x,s,l),(!k||cu(M))&&I&16)for(let F=0;F<T.length;F++)m(T[F],s,l,2);k&&h(a,s,l)}function mS(e,s,l,h,m,_,{o:{nextSibling:x,parentNode:a,querySelector:I}},T){const M=s.target=jp(s.props,I);if(M){const k=M._lpa||M.firstChild;if(s.shapeFlag&16)if(cu(s.props))s.anchor=T(x(e),s,a(e),l,h,m,_),s.targetAnchor=k;else{s.anchor=x(e);let F=k;for(;F;)if(F=x(F),F&&F.nodeType===8&&F.data==="teleport anchor"){s.targetAnchor=F,M._lpa=s.targetAnchor&&x(s.targetAnchor);break}T(k,s,M,l,h,m,_)}$x(s)}return s.anchor&&x(s.anchor)}const gS=pS;function $x(e){const s=e.ctx;if(s&&s.ut){let l=e.children[0].el;for(;l!==e.targetAnchor;)l.nodeType===1&&l.setAttribute("data-v-owner",s.uid),l=l.nextSibling;s.ut()}}const mn=Symbol.for("v-fgt"),Bu=Symbol.for("v-txt"),ys=Symbol.for("v-cmt"),gp=Symbol.for("v-stc"),uu=[];let ms=null;function an(e=!1){uu.push(ms=e?null:[])}function yS(){uu.pop(),ms=uu[uu.length-1]||null}let wu=1;function w_(e){wu+=e}function Ux(e){return e.dynamicChildren=wu>0?ms||Pl:null,yS(),wu>0&&ms&&ms.push(e),e}function fn(e,s,l,h,m,_){return Ux(jt(e,s,l,h,m,_,!0))}function jd(e,s,l,h,m){return Ux(ae(e,s,l,h,m,!0))}function qp(e){return e?e.__v_isVNode===!0:!1}function ma(e,s){return e.type===s.type&&e.key===s.key}const qd="__vInternal",Nx=({key:e})=>e??null,sd=({ref:e,ref_key:s,ref_for:l})=>(typeof e=="number"&&(e=""+e),e!=null?pi(e)||qn(e)||ln(e)?{i:Er,r:e,k:s,f:!!l}:e:null);function jt(e,s=null,l=null,h=0,m=null,_=e===mn?0:1,x=!1,a=!1){const I={__v_isVNode:!0,__v_skip:!0,type:e,props:s,key:s&&Nx(s),ref:s&&sd(s),scopeId:Sx,slotScopeIds:null,children:l,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetAnchor:null,staticCount:0,shapeFlag:_,patchFlag:h,dynamicProps:m,dynamicChildren:null,appContext:null,ctx:Er};return a?(jm(I,l),_&128&&e.normalize(I)):l&&(I.shapeFlag|=pi(l)?8:16),wu>0&&!x&&ms&&(I.patchFlag>0||_&6)&&I.patchFlag!==32&&ms.push(I),I}const ae=_S;function _S(e,s=null,l=null,h=0,m=null,_=!1){if((!e||e===Dx)&&(e=ys),qp(e)){const a=eo(e,s,!0);return l&&jm(a,l),wu>0&&!_&&ms&&(a.shapeFlag&6?ms[ms.indexOf(e)]=a:ms.push(a)),a.patchFlag|=-2,a}if(AS(e)&&(e=e.__vccOpts),s){s=vS(s);let{class:a,style:I}=s;a&&!pi(a)&&(s.class=Ld(a)),Hn(I)&&(dx(I)&&!Qt(I)&&(I=vi({},I)),s.style=Em(I))}const x=pi(e)?1:R2(e)?128:fS(e)?64:Hn(e)?4:ln(e)?2:0;return jt(e,s,l,h,m,x,_,!0)}function vS(e){return e?dx(e)||qd in e?vi({},e):e:null}function eo(e,s,l=!1){const{props:h,ref:m,patchFlag:_,children:x}=e,a=s?In(h||{},s):h;return{__v_isVNode:!0,__v_skip:!0,type:e.type,props:a,key:a&&Nx(a),ref:s&&s.ref?l&&m?Qt(m)?m.concat(sd(s)):[m,sd(s)]:sd(s):m,scopeId:e.scopeId,slotScopeIds:e.slotScopeIds,children:x,target:e.target,targetAnchor:e.targetAnchor,staticCount:e.staticCount,shapeFlag:e.shapeFlag,patchFlag:s&&e.type!==mn?_===-1?16:_|16:_,dynamicProps:e.dynamicProps,dynamicChildren:e.dynamicChildren,appContext:e.appContext,dirs:e.dirs,transition:e.transition,component:e.component,suspense:e.suspense,ssContent:e.ssContent&&eo(e.ssContent),ssFallback:e.ssFallback&&eo(e.ssFallback),el:e.el,anchor:e.anchor,ctx:e.ctx,ce:e.ce}}function Su(e=" ",s=0){return ae(Bu,null,e,s)}function Zi(e="",s=!1){return s?(an(),jd(ys,null,e)):ae(ys,null,e)}function ks(e){return e==null||typeof e=="boolean"?ae(ys):Qt(e)?ae(mn,null,e.slice()):typeof e=="object"?Mo(e):ae(Bu,null,String(e))}function Mo(e){return e.el===null&&e.patchFlag!==-1||e.memo?e:eo(e)}function jm(e,s){let l=0;const{shapeFlag:h}=e;if(s==null)s=null;else if(Qt(s))l=16;else if(typeof s=="object")if(h&65){const m=s.default;m&&(m._c&&(m._d=!1),jm(e,m()),m._c&&(m._d=!0));return}else{l=32;const m=s._;!m&&!(qd in s)?s._ctx=Er:m===3&&Er&&(Er.slots._===1?s._=1:(s._=2,e.patchFlag|=1024))}else ln(s)?(s={default:s,_ctx:Er},l=32):(s=String(s),h&64?(l=16,s=[Su(s)]):l=8);e.children=s,e.shapeFlag|=l}function In(...e){const s={};for(let l=0;l<e.length;l++){const h=e[l];for(const m in h)if(m==="class")s.class!==h.class&&(s.class=Ld([s.class,h.class]));else if(m==="style")s.style=Em([s.style,h.style]);else if(Md(m)){const _=s[m],x=h[m];x&&_!==x&&!(Qt(_)&&_.includes(x))&&(s[m]=_?[].concat(_,x):x)}else m!==""&&(s[m]=h[m])}return s}function Ps(e,s,l,h=null){ts(e,s,7,[l,h])}const xS=Lx();let bS=0;function wS(e,s,l){const h=e.type,m=(s?s.appContext:e.appContext)||xS,_={uid:bS++,vnode:e,type:h,parent:s,appContext:m,root:null,next:null,subTree:null,effect:null,update:null,scope:new ex(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:s?s.provides:Object.create(m.provides),accessCache:null,renderCache:[],components:null,directives:null,propsOptions:Bx(h,m),emitsOptions:wx(h,m),emit:null,emitted:null,propsDefaults:Kn,inheritAttrs:h.inheritAttrs,ctx:Kn,data:Kn,props:Kn,attrs:Kn,slots:Kn,refs:Kn,setupState:Kn,setupContext:null,attrsProxy:null,slotsProxy:null,suspense:l,suspenseId:l?l.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return _.ctx={_},_.root=s?s.root:_,_.emit=k2.bind(null,_),e.ce&&e.ce(_),_}let ki=null;const qm=()=>ki||Er;let Zm,wl,S_="__VUE_INSTANCE_SETTERS__";(wl=zp()[S_])||(wl=zp()[S_]=[]),wl.push(e=>ki=e),Zm=e=>{wl.length>1?wl.forEach(s=>s(e)):wl[0](e)};const Rl=e=>{Zm(e),e.scope.on()},xa=()=>{ki&&ki.scope.off(),Zm(null)};function jx(e){return e.vnode.shapeFlag&4}let Cu=!1;function SS(e,s=!1){Cu=s;const{props:l,children:h}=e.vnode,m=jx(e);sS(e,l,m,s),lS(e,h);const _=m?CS(e,s):void 0;return Cu=!1,_}function CS(e,s){const l=e.type;e.accessCache=Object.create(null),e.proxy=Bd(new Proxy(e.ctx,K2));const{setup:h}=l;if(h){const m=e.setupContext=h.length>1?TS(e):null;Rl(e),Ul();const _=Bo(h,e,0,[e.props,m]);if(Nl(),xa(),Xv(_)){if(_.then(xa,xa),s)return _.then(x=>{C_(e,x,s)}).catch(x=>{Od(x,e,0)});e.asyncDep=_}else C_(e,_,s)}else qx(e,s)}function C_(e,s,l){ln(s)?e.type.__ssrInlineRender?e.ssrRender=s:e.render=s:Hn(s)&&(e.setupState=gx(s)),qx(e,l)}let E_;function qx(e,s,l){const h=e.type;if(!e.render){if(!s&&E_&&!h.render){const m=h.template||$m(e).template;if(m){const{isCustomElement:_,compilerOptions:x}=e.appContext.config,{delimiters:a,compilerOptions:I}=h,T=vi(vi({isCustomElement:_,delimiters:a},x),I);h.render=E_(m,T)}}e.render=h.render||gs}Rl(e),Ul(),Y2(e),Nl(),xa()}function ES(e){return e.attrsProxy||(e.attrsProxy=new Proxy(e.attrs,{get(s,l){return Ir(e,"get","$attrs"),s[l]}}))}function TS(e){const s=l=>{e.exposed=l||{}};return{get attrs(){return ES(e)},slots:e.slots,emit:e.emit,expose:s}}function Zd(e){if(e.exposed)return e.exposeProxy||(e.exposeProxy=new Proxy(gx(Bd(e.exposed)),{get(s,l){if(l in s)return s[l];if(l in lu)return lu[l](e)},has(s,l){return l in s||l in lu}}))}function IS(e,s=!0){return ln(e)?e.displayName||e.name:e.name||s&&e.__name}function AS(e){return ln(e)&&"__vccOpts"in e}const we=(e,s)=>C2(e,s,Cu);function Oo(e,s,l){const h=arguments.length;return h===2?Hn(s)&&!Qt(s)?qp(s)?ae(e,null,[s]):ae(e,s):ae(e,null,s):(h>3?l=Array.prototype.slice.call(arguments,2):h===3&&qp(l)&&(l=[l]),ae(e,s,l))}const PS=Symbol.for("v-scx"),kS=()=>Zn(PS),MS="3.3.4",DS="http://www.w3.org/2000/svg",ga=typeof document<"u"?document:null,T_=ga&&ga.createElement("template"),zS={insert:(e,s,l)=>{s.insertBefore(e,l||null)},remove:e=>{const s=e.parentNode;s&&s.removeChild(e)},createElement:(e,s,l,h)=>{const m=s?ga.createElementNS(DS,e):ga.createElement(e,l?{is:l}:void 0);return e==="select"&&h&&h.multiple!=null&&m.setAttribute("multiple",h.multiple),m},createText:e=>ga.createTextNode(e),createComment:e=>ga.createComment(e),setText:(e,s)=>{e.nodeValue=s},setElementText:(e,s)=>{e.textContent=s},parentNode:e=>e.parentNode,nextSibling:e=>e.nextSibling,querySelector:e=>ga.querySelector(e),setScopeId(e,s){e.setAttribute(s,"")},insertStaticContent(e,s,l,h,m,_){const x=l?l.previousSibling:s.lastChild;if(m&&(m===_||m.nextSibling))for(;s.insertBefore(m.cloneNode(!0),l),!(m===_||!(m=m.nextSibling)););else{T_.innerHTML=h?`<svg>${e}</svg>`:e;const a=T_.content;if(h){const I=a.firstChild;for(;I.firstChild;)a.appendChild(I.firstChild);a.removeChild(I)}s.insertBefore(a,l)}return[x?x.nextSibling:s.firstChild,l?l.previousSibling:s.lastChild]}};function LS(e,s,l){const h=e._vtc;h&&(s=(s?[s,...h]:[...h]).join(" ")),s==null?e.removeAttribute("class"):l?e.setAttribute("class",s):e.className=s}function RS(e,s,l){const h=e.style,m=pi(l);if(l&&!m){if(s&&!pi(s))for(const _ in s)l[_]==null&&Zp(h,_,"");for(const _ in l)Zp(h,_,l[_])}else{const _=h.display;m?s!==l&&(h.cssText=l):s&&e.removeAttribute("style"),"_vod"in e&&(h.display=_)}}const I_=/\s*!important$/;function Zp(e,s,l){if(Qt(l))l.forEach(h=>Zp(e,s,h));else if(l==null&&(l=""),s.startsWith("--"))e.setProperty(s,l);else{const h=BS(e,s);I_.test(l)?e.setProperty(Vl(h),l.replace(I_,""),"important"):e[h]=l}}const A_=["Webkit","Moz","ms"],yp={};function BS(e,s){const l=yp[s];if(l)return l;let h=ns(s);if(h!=="filter"&&h in e)return yp[s]=h;h=$l(h);for(let m=0;m<A_.length;m++){const _=A_[m]+h;if(_ in e)return yp[s]=_}return s}const P_="http://www.w3.org/1999/xlink";function FS(e,s,l,h,m){if(h&&s.startsWith("xlink:"))l==null?e.removeAttributeNS(P_,s.slice(6,s.length)):e.setAttributeNS(P_,s,l);else{const _=jw(s);l==null||_&&!Jv(l)?e.removeAttribute(s):e.setAttribute(s,_?"":l)}}function OS(e,s,l,h,m,_,x){if(s==="innerHTML"||s==="textContent"){h&&x(h,m,_),e[s]=l??"";return}const a=e.tagName;if(s==="value"&&a!=="PROGRESS"&&!a.includes("-")){e._value=l;const T=a==="OPTION"?e.getAttribute("value"):e.value,M=l??"";T!==M&&(e.value=M),l==null&&e.removeAttribute(s);return}let I=!1;if(l===""||l==null){const T=typeof e[s];T==="boolean"?l=Jv(l):l==null&&T==="string"?(l="",I=!0):T==="number"&&(l=0,I=!0)}try{e[s]=l}catch{}I&&e.removeAttribute(s)}function Tl(e,s,l,h){e.addEventListener(s,l,h)}function VS(e,s,l,h){e.removeEventListener(s,l,h)}function $S(e,s,l,h,m=null){const _=e._vei||(e._vei={}),x=_[s];if(h&&x)x.value=h;else{const[a,I]=US(s);if(h){const T=_[s]=qS(h,m);Tl(e,a,T,I)}else x&&(VS(e,a,x,I),_[s]=void 0)}}const k_=/(?:Once|Passive|Capture)$/;function US(e){let s;if(k_.test(e)){s={};let h;for(;h=e.match(k_);)e=e.slice(0,e.length-h[0].length),s[h[0].toLowerCase()]=!0}return[e[2]===":"?e.slice(3):Vl(e.slice(2)),s]}let _p=0;const NS=Promise.resolve(),jS=()=>_p||(NS.then(()=>_p=0),_p=Date.now());function qS(e,s){const l=h=>{if(!h._vts)h._vts=Date.now();else if(h._vts<=l.attached)return;ts(ZS(h,l.value),s,5,[h])};return l.value=e,l.attached=jS(),l}function ZS(e,s){if(Qt(s)){const l=e.stopImmediatePropagation;return e.stopImmediatePropagation=()=>{l.call(e),e._stopped=!0},s.map(h=>m=>!m._stopped&&h&&h(m))}else return s}const M_=/^on[a-z]/,GS=(e,s,l,h,m=!1,_,x,a,I)=>{s==="class"?LS(e,h,m):s==="style"?RS(e,l,h):Md(s)?bm(s)||$S(e,s,l,h,x):(s[0]==="."?(s=s.slice(1),!0):s[0]==="^"?(s=s.slice(1),!1):WS(e,s,h,m))?OS(e,s,h,_,x,a,I):(s==="true-value"?e._trueValue=h:s==="false-value"&&(e._falseValue=h),FS(e,s,h,m))};function WS(e,s,l,h){return h?!!(s==="innerHTML"||s==="textContent"||s in e&&M_.test(s)&&ln(l)):s==="spellcheck"||s==="draggable"||s==="translate"||s==="form"||s==="list"&&e.tagName==="INPUT"||s==="type"&&e.tagName==="TEXTAREA"||M_.test(s)&&pi(l)?!1:s in e}const Io="transition",eu="animation",to=(e,{slots:s})=>Oo(V2,Gx(e),s);to.displayName="Transition";const Zx={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String},HS=to.props=vi({},Ix,Zx),da=(e,s=[])=>{Qt(e)?e.forEach(l=>l(...s)):e&&e(...s)},D_=e=>e?Qt(e)?e.some(s=>s.length>1):e.length>1:!1;function Gx(e){const s={};for(const Ce in e)Ce in Zx||(s[Ce]=e[Ce]);if(e.css===!1)return s;const{name:l="v",type:h,duration:m,enterFromClass:_=`${l}-enter-from`,enterActiveClass:x=`${l}-enter-active`,enterToClass:a=`${l}-enter-to`,appearFromClass:I=_,appearActiveClass:T=x,appearToClass:M=a,leaveFromClass:k=`${l}-leave-from`,leaveActiveClass:F=`${l}-leave-active`,leaveToClass:q=`${l}-leave-to`}=e,X=XS(m),re=X&&X[0],me=X&&X[1],{onBeforeEnter:ye,onEnter:Ee,onEnterCancelled:be,onLeave:Oe,onLeaveCancelled:Qe,onBeforeAppear:Ue=ye,onAppear:ze=Ee,onAppearCancelled:j=be}=s,G=(Ce,_e,Fe)=>{Po(Ce,_e?M:a),Po(Ce,_e?T:x),Fe&&Fe()},pe=(Ce,_e)=>{Ce._isLeaving=!1,Po(Ce,k),Po(Ce,q),Po(Ce,F),_e&&_e()},Se=Ce=>(_e,Fe)=>{const ut=Ce?ze:Ee,at=()=>G(_e,Ce,Fe);da(ut,[_e,at]),z_(()=>{Po(_e,Ce?I:_),Ys(_e,Ce?M:a),D_(ut)||L_(_e,h,re,at)})};return vi(s,{onBeforeEnter(Ce){da(ye,[Ce]),Ys(Ce,_),Ys(Ce,x)},onBeforeAppear(Ce){da(Ue,[Ce]),Ys(Ce,I),Ys(Ce,T)},onEnter:Se(!1),onAppear:Se(!0),onLeave(Ce,_e){Ce._isLeaving=!0;const Fe=()=>pe(Ce,_e);Ys(Ce,k),Hx(),Ys(Ce,F),z_(()=>{Ce._isLeaving&&(Po(Ce,k),Ys(Ce,q),D_(Oe)||L_(Ce,h,me,Fe))}),da(Oe,[Ce,Fe])},onEnterCancelled(Ce){G(Ce,!1),da(be,[Ce])},onAppearCancelled(Ce){G(Ce,!0),da(j,[Ce])},onLeaveCancelled(Ce){pe(Ce),da(Qe,[Ce])}})}function XS(e){if(e==null)return null;if(Hn(e))return[vp(e.enter),vp(e.leave)];{const s=vp(e);return[s,s]}}function vp(e){return Fw(e)}function Ys(e,s){s.split(/\s+/).forEach(l=>l&&e.classList.add(l)),(e._vtc||(e._vtc=new Set)).add(s)}function Po(e,s){s.split(/\s+/).forEach(h=>h&&e.classList.remove(h));const{_vtc:l}=e;l&&(l.delete(s),l.size||(e._vtc=void 0))}function z_(e){requestAnimationFrame(()=>{requestAnimationFrame(e)})}let KS=0;function L_(e,s,l,h){const m=e._endId=++KS,_=()=>{m===e._endId&&h()};if(l)return setTimeout(_,l);const{type:x,timeout:a,propCount:I}=Wx(e,s);if(!x)return h();const T=x+"end";let M=0;const k=()=>{e.removeEventListener(T,F),_()},F=q=>{q.target===e&&++M>=I&&k()};setTimeout(()=>{M<I&&k()},a+1),e.addEventListener(T,F)}function Wx(e,s){const l=window.getComputedStyle(e),h=X=>(l[X]||"").split(", "),m=h(`${Io}Delay`),_=h(`${Io}Duration`),x=R_(m,_),a=h(`${eu}Delay`),I=h(`${eu}Duration`),T=R_(a,I);let M=null,k=0,F=0;s===Io?x>0&&(M=Io,k=x,F=_.length):s===eu?T>0&&(M=eu,k=T,F=I.length):(k=Math.max(x,T),M=k>0?x>T?Io:eu:null,F=M?M===Io?_.length:I.length:0);const q=M===Io&&/\b(transform|all)(,|$)/.test(h(`${Io}Property`).toString());return{type:M,timeout:k,propCount:F,hasTransform:q}}function R_(e,s){for(;e.length<s.length;)e=e.concat(e);return Math.max(...s.map((l,h)=>B_(l)+B_(e[h])))}function B_(e){return Number(e.slice(0,-1).replace(",","."))*1e3}function Hx(){return document.body.offsetHeight}const Xx=new WeakMap,Kx=new WeakMap,Yx={name:"TransitionGroup",props:vi({},HS,{tag:String,moveClass:String}),setup(e,{slots:s}){const l=qm(),h=Tx();let m,_;return kx(()=>{if(!m.length)return;const x=e.moveClass||`${e.name||"v"}-move`;if(!nC(m[0].el,l.vnode.el,x))return;m.forEach(QS),m.forEach(eC);const a=m.filter(tC);Hx(),a.forEach(I=>{const T=I.el,M=T.style;Ys(T,x),M.transform=M.webkitTransform=M.transitionDuration="";const k=T._moveCb=F=>{F&&F.target!==T||(!F||/transform$/.test(F.propertyName))&&(T.removeEventListener("transitionend",k),T._moveCb=null,Po(T,x))};T.addEventListener("transitionend",k)})}),()=>{const x=rn(e),a=Gx(x);let I=x.tag||mn;m=_,_=s.default?Bm(s.default()):[];for(let T=0;T<_.length;T++){const M=_[T];M.key!=null&&xu(M,vu(M,a,h,l))}if(m)for(let T=0;T<m.length;T++){const M=m[T];xu(M,vu(M,a,h,l)),Xx.set(M,M.el.getBoundingClientRect())}return ae(I,null,_)}}},YS=e=>delete e.mode;Yx.props;const JS=Yx;function QS(e){const s=e.el;s._moveCb&&s._moveCb(),s._enterCb&&s._enterCb()}function eC(e){Kx.set(e,e.el.getBoundingClientRect())}function tC(e){const s=Xx.get(e),l=Kx.get(e),h=s.left-l.left,m=s.top-l.top;if(h||m){const _=e.el.style;return _.transform=_.webkitTransform=`translate(${h}px,${m}px)`,_.transitionDuration="0s",e}}function nC(e,s,l){const h=e.cloneNode();e._vtc&&e._vtc.forEach(x=>{x.split(/\s+/).forEach(a=>a&&h.classList.remove(a))}),l.split(/\s+/).forEach(x=>x&&h.classList.add(x)),h.style.display="none";const m=s.nodeType===1?s:s.parentNode;m.appendChild(h);const{hasTransform:_}=Wx(h);return m.removeChild(h),_}const F_=e=>{const s=e.props["onUpdate:modelValue"]||!1;return Qt(s)?l=>id(s,l):s};function iC(e){e.target.composing=!0}function O_(e){const s=e.target;s.composing&&(s.composing=!1,s.dispatchEvent(new Event("input")))}const rC={created(e,{modifiers:{lazy:s,trim:l,number:h}},m){e._assign=F_(m);const _=h||m.props&&m.props.type==="number";Tl(e,s?"change":"input",x=>{if(x.target.composing)return;let a=e.value;l&&(a=a.trim()),_&&(a=Dp(a)),e._assign(a)}),l&&Tl(e,"change",()=>{e.value=e.value.trim()}),s||(Tl(e,"compositionstart",iC),Tl(e,"compositionend",O_),Tl(e,"change",O_))},mounted(e,{value:s}){e.value=s??""},beforeUpdate(e,{value:s,modifiers:{lazy:l,trim:h,number:m}},_){if(e._assign=F_(_),e.composing||document.activeElement===e&&e.type!=="range"&&(l||h&&e.value.trim()===s||(m||e.type==="number")&&Dp(e.value)===s))return;const x=s??"";e.value!==x&&(e.value=x)}},jl={beforeMount(e,{value:s},{transition:l}){e._vod=e.style.display==="none"?"":e.style.display,l&&s?l.beforeEnter(e):tu(e,s)},mounted(e,{value:s},{transition:l}){l&&s&&l.enter(e)},updated(e,{value:s,oldValue:l},{transition:h}){!s!=!l&&(h?s?(h.beforeEnter(e),tu(e,!0),h.enter(e)):h.leave(e,()=>{tu(e,!1)}):tu(e,s))},beforeUnmount(e,{value:s}){tu(e,s)}};function tu(e,s){e.style.display=s?e._vod:"none"}const sC=vi({patchProp:GS},zS);let V_;function oC(){return V_||(V_=uS(sC))}const aC=(...e)=>{const s=oC().createApp(...e),{mount:l}=s;return s.mount=h=>{const m=lC(h);if(!m)return;const _=s._component;!ln(_)&&!_.render&&!_.template&&(_.template=m.innerHTML),m.innerHTML="";const x=l(m,!1,m instanceof SVGElement);return m instanceof Element&&(m.removeAttribute("v-cloak"),m.setAttribute("data-v-app","")),x},s};function lC(e){return pi(e)?document.querySelector(e):e}var cC=!1;/*!
  * pinia v2.1.4
  * (c) 2023 Eduardo San Martin Morote
  * @license MIT
  */let Jx;const Gd=e=>Jx=e,Qx=Symbol();function Gp(e){return e&&typeof e=="object"&&Object.prototype.toString.call(e)==="[object Object]"&&typeof e.toJSON!="function"}var hu;(function(e){e.direct="direct",e.patchObject="patch object",e.patchFunction="patch function"})(hu||(hu={}));function uC(){const e=Lu(!0),s=e.run(()=>Kt({}));let l=[],h=[];const m=Bd({install(_){Gd(m),m._a=_,_.provide(Qx,m),_.config.globalProperties.$pinia=m,h.forEach(x=>l.push(x)),h=[]},use(_){return!this._a&&!cC?h.push(_):l.push(_),this},_p:l,_a:null,_e:e,_s:new Map,state:s});return m}const e0=()=>{};function $_(e,s,l,h=e0){e.push(s);const m=()=>{const _=e.indexOf(s);_>-1&&(e.splice(_,1),h())};return!l&&tx()&&Tr(m),m}function Sl(e,...s){e.slice().forEach(l=>{l(...s)})}const hC=e=>e();function Wp(e,s){e instanceof Map&&s instanceof Map&&s.forEach((l,h)=>e.set(h,l)),e instanceof Set&&s instanceof Set&&s.forEach(e.add,e);for(const l in s){if(!s.hasOwnProperty(l))continue;const h=s[l],m=e[l];Gp(m)&&Gp(h)&&e.hasOwnProperty(l)&&!qn(h)&&!Ro(h)?e[l]=Wp(m,h):e[l]=h}return e}const dC=Symbol();function fC(e){return!Gp(e)||!e.hasOwnProperty(dC)}const{assign:ko}=Object;function pC(e){return!!(qn(e)&&e.effect)}function mC(e,s,l,h){const{state:m,actions:_,getters:x}=s,a=l.state.value[e];let I;function T(){a||(l.state.value[e]=m?m():{});const M=Fd(l.state.value[e]);return ko(M,_,Object.keys(x||{}).reduce((k,F)=>(k[F]=Bd(we(()=>{Gd(l);const q=l._s.get(e);return x[F].call(q,q)})),k),{}))}return I=t0(e,T,s,l,h,!0),I}function t0(e,s,l={},h,m,_){let x;const a=ko({actions:{}},l),I={deep:!0};let T,M,k=[],F=[],q;const X=h.state.value[e];!_&&!X&&(h.state.value[e]={}),Kt({});let re;function me(j){let G;T=M=!1,typeof j=="function"?(j(h.state.value[e]),G={type:hu.patchFunction,storeId:e,events:q}):(Wp(h.state.value[e],j),G={type:hu.patchObject,payload:j,storeId:e,events:q});const pe=re=Symbol();er().then(()=>{re===pe&&(T=!0)}),M=!0,Sl(k,G,h.state.value[e])}const ye=_?function(){const{state:G}=l,pe=G?G():{};this.$patch(Se=>{ko(Se,pe)})}:e0;function Ee(){x.stop(),k=[],F=[],h._s.delete(e)}function be(j,G){return function(){Gd(h);const pe=Array.from(arguments),Se=[],Ce=[];function _e(at){Se.push(at)}function Fe(at){Ce.push(at)}Sl(F,{args:pe,name:j,store:Qe,after:_e,onError:Fe});let ut;try{ut=G.apply(this&&this.$id===e?this:Qe,pe)}catch(at){throw Sl(Ce,at),at}return ut instanceof Promise?ut.then(at=>(Sl(Se,at),at)).catch(at=>(Sl(Ce,at),Promise.reject(at))):(Sl(Se,ut),ut)}}const Oe={_p:h,$id:e,$onAction:$_.bind(null,F),$patch:me,$reset:ye,$subscribe(j,G={}){const pe=$_(k,j,G.detached,()=>Se()),Se=x.run(()=>wn(()=>h.state.value[e],Ce=>{(G.flush==="sync"?M:T)&&j({storeId:e,type:hu.direct,events:q},Ce)},ko({},I,G)));return pe},$dispose:Ee},Qe=Oi(Oe);h._s.set(e,Qe);const Ue=h._a&&h._a.runWithContext||hC,ze=h._e.run(()=>(x=Lu(),Ue(()=>x.run(s))));for(const j in ze){const G=ze[j];if(qn(G)&&!pC(G)||Ro(G))_||(X&&fC(G)&&(qn(G)?G.value=X[j]:Wp(G,X[j])),h.state.value[e][j]=G);else if(typeof G=="function"){const pe=be(j,G);ze[j]=pe,a.actions[j]=G}}return ko(Qe,ze),ko(rn(Qe),ze),Object.defineProperty(Qe,"$state",{get:()=>h.state.value[e],set:j=>{me(G=>{ko(G,j)})}}),h._p.forEach(j=>{ko(Qe,x.run(()=>j({store:Qe,app:h._a,pinia:h,options:a})))}),X&&_&&l.hydrate&&l.hydrate(Qe.$state,X),T=!0,M=!0,Qe}function Gm(e,s,l){let h,m;const _=typeof s=="function";typeof e=="string"?(h=e,m=_?l:s):(m=e,h=e.id);function x(a,I){const T=rS();return a=a||(T?Zn(Qx,null):null),a&&Gd(a),a=Jx,a._s.has(h)||(_?t0(h,s,m,a):mC(h,m,a)),a._s.get(h)}return x.$id=h,x}function Sa(e,s){let l;function h(){l=Lu(),l.run(()=>s.length?s(()=>{l==null||l.stop(),h()}):s())}wn(e,m=>{m&&!l?h():m||(l==null||l.stop(),l=void 0)},{immediate:!0}),Tr(()=>{l==null||l.stop()})}function n0(e,s,l){const h=s.length-1;if(h<0)return e===void 0?l:e;for(let m=0;m<h;m++){if(e==null)return l;e=e[s[m]]}return e==null||e[s[h]]===void 0?l:e[s[h]]}function ql(e,s){if(e===s)return!0;if(e instanceof Date&&s instanceof Date&&e.getTime()!==s.getTime()||e!==Object(e)||s!==Object(s))return!1;const l=Object.keys(e);return l.length!==Object.keys(s).length?!1:l.every(h=>ql(e[h],s[h]))}function Hp(e,s,l){return e==null||!s||typeof s!="string"?l:e[s]!==void 0?e[s]:(s=s.replace(/\[(\w+)\]/g,".$1"),s=s.replace(/^\./,""),n0(e,s.split("."),l))}function Ds(e,s,l){if(s==null)return e===void 0?l:e;if(e!==Object(e)){if(typeof s!="function")return l;const m=s(e,l);return typeof m>"u"?l:m}if(typeof s=="string")return Hp(e,s,l);if(Array.isArray(s))return n0(e,s,l);if(typeof s!="function")return l;const h=s(e,l);return typeof h>"u"?l:h}function i0(e){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return Array.from({length:e},(l,h)=>s+h)}function pn(e){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"px";if(!(e==null||e===""))return isNaN(+e)?String(e):isFinite(+e)?`${Number(e)}${s}`:void 0}function Xp(e){return e!==null&&typeof e=="object"&&!Array.isArray(e)}function Kp(e){return e&&"$el"in e?e.$el:e}const U_=Object.freeze({enter:13,tab:9,delete:46,esc:27,space:32,up:38,down:40,left:37,right:39,end:35,home:36,del:46,backspace:8,insert:45,pageup:33,pagedown:34,shift:16});function xp(e,s){return s.every(l=>e.hasOwnProperty(l))}function Fu(e,s,l){const h=Object.create(null),m=Object.create(null);for(const _ in e)s.some(x=>x instanceof RegExp?x.test(_):x===_)&&!(l!=null&&l.some(x=>x===_))?h[_]=e[_]:m[_]=e[_];return[h,m]}function Wm(e,s){const l={...e};return s.forEach(h=>delete l[h]),l}function Hm(e){return Fu(e,["class","style","id",/^data-/])}function Ls(e){return e==null?[]:Array.isArray(e)?e:[e]}function Yp(e){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;return Math.max(s,Math.min(l,e))}function N_(e,s){let l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"0";return e+l.repeat(Math.max(0,s-e.length))}function gC(e){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;const l=[];let h=0;for(;h<e.length;)l.push(e.substr(h,s)),h+=s;return l}function es(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},l=arguments.length>2?arguments[2]:void 0;const h={};for(const m in e)h[m]=e[m];for(const m in s){const _=e[m],x=s[m];if(Xp(_)&&Xp(x)){h[m]=es(_,x,l);continue}if(Array.isArray(_)&&Array.isArray(x)&&l){h[m]=l(_,x);continue}h[m]=x}return h}function r0(e){return e.map(s=>s.type===mn?r0(s.children):s).flat()}function ba(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";if(ba.cache.has(e))return ba.cache.get(e);const s=e.replace(/[^a-z]/gi,"-").replace(/\B([A-Z])/g,"-$1").toLowerCase();return ba.cache.set(e,s),s}ba.cache=new Map;function du(e,s){if(!s||typeof s!="object")return[];if(Array.isArray(s))return s.map(l=>du(e,l)).flat(1);if(Array.isArray(s.children))return s.children.map(l=>du(e,l)).flat(1);if(s.component){if(Object.getOwnPropertySymbols(s.component.provides).includes(e))return[s.component];if(s.component.subTree)return du(e,s.component.subTree).flat(1)}return[]}function Xm(e){const s=Oi({}),l=we(e);return ro(()=>{for(const h in l.value)s[h]=l.value[h]},{flush:"sync"}),Fd(s)}function pd(e,s){return e.includes(s)}const yC=/^on[^a-z]/,Km=e=>yC.test(e);function s0(e){return e[2].toLowerCase()+e.slice(3)}const Rs=()=>[Function,Array];function j_(e,s){return s="on"+$l(s),!!(e[s]||e[`${s}Once`]||e[`${s}Capture`]||e[`${s}OnceCapture`]||e[`${s}CaptureOnce`])}function _C(e){for(var s=arguments.length,l=new Array(s>1?s-1:0),h=1;h<s;h++)l[h-1]=arguments[h];if(Array.isArray(e))for(const m of e)m(...l);else typeof e=="function"&&e(...l)}function vC(e){const s=["button","[href]",'input:not([type="hidden"])',"select","textarea","[tabindex]"].map(l=>`${l}:not([tabindex="-1"]):not([disabled])`).join(", ");return[...e.querySelectorAll(s)]}function md(e,s){var m,_,x;const l=vC(e),h=l.indexOf(document.activeElement);if(!s)(e===document.activeElement||!e.contains(document.activeElement))&&((m=l[0])==null||m.focus());else if(s==="first")(_=l[0])==null||_.focus();else if(s==="last")(x=l.at(-1))==null||x.focus();else{let a,I=h;const T=s==="next"?1:-1;do I+=T,a=l[I];while((!a||a.offsetParent==null)&&I<l.length&&I>=0);a?a.focus():md(e,s==="next"?"first":"last")}}function xC(){}const o0=["top","bottom"],bC=["start","end","left","right"];function Jp(e,s){let[l,h]=e.split(" ");return h||(h=pd(o0,l)?"start":pd(bC,l)?"top":"center"),{side:q_(l,s),align:q_(h,s)}}function q_(e,s){return e==="start"?s?"right":"left":e==="end"?s?"left":"right":e}function bp(e){return{side:{center:"center",top:"bottom",bottom:"top",left:"right",right:"left"}[e.side],align:e.align}}function wp(e){return{side:e.side,align:{center:"center",top:"bottom",bottom:"top",left:"right",right:"left"}[e.align]}}function Z_(e){return{side:e.align,align:e.side}}function G_(e){return pd(o0,e.side)?"y":"x"}class zl{constructor(s){let{x:l,y:h,width:m,height:_}=s;this.x=l,this.y=h,this.width=m,this.height=_}get top(){return this.y}get bottom(){return this.y+this.height}get left(){return this.x}get right(){return this.x+this.width}}function W_(e,s){return{x:{before:Math.max(0,s.left-e.left),after:Math.max(0,e.right-s.right)},y:{before:Math.max(0,s.top-e.top),after:Math.max(0,e.bottom-s.bottom)}}}function Ym(e){const s=e.getBoundingClientRect(),l=getComputedStyle(e),h=l.transform;if(h){let m,_,x,a,I;if(h.startsWith("matrix3d("))m=h.slice(9,-1).split(/, /),_=+m[0],x=+m[5],a=+m[12],I=+m[13];else if(h.startsWith("matrix("))m=h.slice(7,-1).split(/, /),_=+m[0],x=+m[3],a=+m[4],I=+m[5];else return new zl(s);const T=l.transformOrigin,M=s.x-a-(1-_)*parseFloat(T),k=s.y-I-(1-x)*parseFloat(T.slice(T.indexOf(" ")+1)),F=_?s.width/_:e.offsetWidth+1,q=x?s.height/x:e.offsetHeight+1;return new zl({x:M,y:k,width:F,height:q})}else return new zl(s)}function Al(e,s,l){if(typeof e.animate>"u")return{finished:Promise.resolve()};let h;try{h=e.animate(s,l)}catch{return{finished:Promise.resolve()}}return typeof h.finished>"u"&&(h.finished=new Promise(m=>{h.onfinish=()=>{m(h)}})),h}const od=new WeakMap;function wC(e,s){Object.keys(s).forEach(l=>{if(Km(l)){const h=s0(l),m=od.get(e);if(s[l]==null)m==null||m.forEach(_=>{const[x,a]=_;x===h&&(e.removeEventListener(h,a),m.delete(_))});else if(!m||![...m].some(_=>_[0]===h&&_[1]===s[l])){e.addEventListener(h,s[l]);const _=m||new Set;_.add([h,s[l]]),od.has(e)||od.set(e,_)}}else s[l]==null?e.removeAttribute(l):e.setAttribute(l,s[l])})}function SC(e,s){Object.keys(s).forEach(l=>{if(Km(l)){const h=s0(l),m=od.get(e);m==null||m.forEach(_=>{const[x,a]=_;x===h&&(e.removeEventListener(h,a),m.delete(_))})}else e.removeAttribute(l)})}function CC(e,s){s=Array.isArray(s)?s.slice(0,-1).map(l=>`'${l}'`).join(", ")+` or '${s.at(-1)}'`:`'${s}'`}const gd=.20689655172413793,EC=e=>e>gd**3?Math.cbrt(e):e/(3*gd**2)+4/29,TC=e=>e>gd?e**3:3*gd**2*(e-4/29);function a0(e){const s=EC,l=s(e[1]);return[116*l-16,500*(s(e[0]/.95047)-l),200*(l-s(e[2]/1.08883))]}function l0(e){const s=TC,l=(e[0]+16)/116;return[s(l+e[1]/500)*.95047,s(l),s(l-e[2]/200)*1.08883]}const IC=[[3.2406,-1.5372,-.4986],[-.9689,1.8758,.0415],[.0557,-.204,1.057]],AC=e=>e<=.0031308?e*12.92:1.055*e**(1/2.4)-.055,PC=[[.4124,.3576,.1805],[.2126,.7152,.0722],[.0193,.1192,.9505]],kC=e=>e<=.04045?e/12.92:((e+.055)/1.055)**2.4;function c0(e){const s=Array(3),l=AC,h=IC;for(let m=0;m<3;++m)s[m]=Math.round(Yp(l(h[m][0]*e[0]+h[m][1]*e[1]+h[m][2]*e[2]))*255);return{r:s[0],g:s[1],b:s[2]}}function Jm(e){let{r:s,g:l,b:h}=e;const m=[0,0,0],_=kC,x=PC;s=_(s/255),l=_(l/255),h=_(h/255);for(let a=0;a<3;++a)m[a]=x[a][0]*s+x[a][1]*l+x[a][2]*h;return m}function H_(e){return!!e&&/^(#|var\(--|(rgb|hsl)a?\()/.test(e)}const X_=/^(?<fn>(?:rgb|hsl)a?)\((?<values>.+)\)/,MC={rgb:(e,s,l,h)=>({r:e,g:s,b:l,a:h}),rgba:(e,s,l,h)=>({r:e,g:s,b:l,a:h}),hsl:(e,s,l,h)=>K_({h:e,s,l,a:h}),hsla:(e,s,l,h)=>K_({h:e,s,l,a:h}),hsv:(e,s,l,h)=>Eu({h:e,s,v:l,a:h}),hsva:(e,s,l,h)=>Eu({h:e,s,v:l,a:h})};function _a(e){if(typeof e=="number")return{r:(e&16711680)>>16,g:(e&65280)>>8,b:e&255};if(typeof e=="string"&&X_.test(e)){const{groups:s}=e.match(X_),{fn:l,values:h}=s,m=h.split(/,\s*/).map(_=>_.endsWith("%")&&["hsl","hsla","hsv","hsva"].includes(l)?parseFloat(_)/100:parseFloat(_));return MC[l](...m)}else if(typeof e=="string"){let s=e.startsWith("#")?e.slice(1):e;return[3,4].includes(s.length)?s=s.split("").map(l=>l+l).join(""):[6,8].includes(s.length),zC(s)}else if(typeof e=="object"){if(xp(e,["r","g","b"]))return e;if(xp(e,["h","s","l"]))return Eu(u0(e));if(xp(e,["h","s","v"]))return Eu(e)}throw new TypeError(`Invalid color: ${e==null?e:String(e)||e.constructor.name}
Expected #hex, #hexa, rgb(), rgba(), hsl(), hsla(), object or number`)}function Eu(e){const{h:s,s:l,v:h,a:m}=e,_=a=>{const I=(a+s/60)%6;return h-h*l*Math.max(Math.min(I,4-I,1),0)},x=[_(5),_(3),_(1)].map(a=>Math.round(a*255));return{r:x[0],g:x[1],b:x[2],a:m}}function K_(e){return Eu(u0(e))}function u0(e){const{h:s,s:l,l:h,a:m}=e,_=h+l*Math.min(h,1-h),x=_===0?0:2-2*h/_;return{h:s,s:x,v:_,a:m}}function Jh(e){const s=Math.round(e).toString(16);return("00".substr(0,2-s.length)+s).toUpperCase()}function DC(e){let{r:s,g:l,b:h,a:m}=e;return`#${[Jh(s),Jh(l),Jh(h),m!==void 0?Jh(Math.round(m*255)):""].join("")}`}function zC(e){e=LC(e);let[s,l,h,m]=gC(e,2).map(_=>parseInt(_,16));return m=m===void 0?m:m/255,{r:s,g:l,b:h,a:m}}function LC(e){return e.startsWith("#")&&(e=e.slice(1)),e=e.replace(/([^0-9a-f])/gi,"F"),(e.length===3||e.length===4)&&(e=e.split("").map(s=>s+s).join("")),e.length!==6&&(e=N_(N_(e,6),8,"F")),e}function RC(e,s){const l=a0(Jm(e));return l[0]=l[0]+s*10,c0(l0(l))}function BC(e,s){const l=a0(Jm(e));return l[0]=l[0]-s*10,c0(l0(l))}function FC(e){const s=_a(e);return Jm(s)[1]}function Bt(e,s){return l=>Object.keys(e).reduce((h,m)=>{const x=typeof e[m]=="object"&&e[m]!=null&&!Array.isArray(e[m])?e[m]:{type:e[m]};return l&&m in l?h[m]={...x,default:l[m]}:h[m]=x,s&&!h[m].source&&(h[m].source=s),h},{})}const ei=Bt({class:[String,Array],style:{type:[String,Array,Object],default:null}},"component");function Zl(e){if(e._setup=e._setup??e.setup,!e.name)return e;if(e._setup){e.props=Bt(e.props??{},e.name)();const s=Object.keys(e.props);e.filterProps=function(h){return Fu(h,s,["class","style"])},e.props._as=String,e.setup=function(h,m){const _=tg();if(!_.value)return e._setup(h,m);const{props:x,provideSubDefaults:a}=GC(h,h._as??e.name,_),I=e._setup(x,m);return a(),I}}return e}function Sn(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return s=>(e?Zl:$d)(s)}function h0(e){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"div",l=arguments.length>2?arguments[2]:void 0;return Sn()({name:l??$l(ns(e.replace(/__/g,"-"))),props:{tag:{type:String,default:s},...ei()},setup(h,m){let{slots:_}=m;return()=>{var x;return Oo(h.tag,{class:[e,h.class],style:h.style},(x=_.default)==null?void 0:x.call(_))}}})}function d0(e){if(typeof e.getRootNode!="function"){for(;e.parentNode;)e=e.parentNode;return e!==document?null:document}const s=e.getRootNode();return s!==document&&s.getRootNode({composed:!0})!==document?null:s}const yd="cubic-bezier(0.4, 0, 0.2, 1)",OC="cubic-bezier(0.0, 0, 0.2, 1)",VC="cubic-bezier(0.4, 0, 1, 1)";function fr(e,s){const l=qm();if(!l)throw new Error(`[Vuetify] ${e} ${s||"must be called from inside a setup function"}`);return l}function Vo(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"composables";const s=fr(e).type;return ba((s==null?void 0:s.aliasName)||(s==null?void 0:s.name))}let f0=0,ad=new WeakMap;function vs(){const e=fr("getUid");if(ad.has(e))return ad.get(e);{const s=f0++;return ad.set(e,s),s}}vs.reset=()=>{f0=0,ad=new WeakMap};function $C(e){for(;e;){if(Qm(e))return e;e=e.parentElement}return document.scrollingElement}function _d(e,s){const l=[];if(s&&e&&!s.contains(e))return l;for(;e&&(Qm(e)&&l.push(e),e!==s);)e=e.parentElement;return l}function Qm(e){if(!e||e.nodeType!==Node.ELEMENT_NODE)return!1;const s=window.getComputedStyle(e);return s.overflowY==="scroll"||s.overflowY==="auto"&&e.scrollHeight>e.clientHeight}const Mi=typeof window<"u",eg=Mi&&"IntersectionObserver"in window,UC=Mi&&("ontouchstart"in window||window.navigator.maxTouchPoints>0),Qp=Mi&&typeof CSS<"u"&&typeof CSS.supports<"u"&&CSS.supports("selector(:focus-visible)");function NC(e){const{provides:s}=fr("injectSelf");if(s&&e in s)return s[e]}function jC(e){for(;e;){if(window.getComputedStyle(e).position==="fixed")return!0;e=e.offsetParent}return!1}function $n(e){const s=fr("useRender");s.render=e}const Tu=Symbol.for("vuetify:defaults");function qC(e){return Kt(e)}function tg(){const e=Zn(Tu);if(!e)throw new Error("[Vuetify] Could not find defaults instance");return e}function Ou(e,s){const l=tg(),h=Kt(e),m=we(()=>{if(Wi(s==null?void 0:s.disabled))return l.value;const x=Wi(s==null?void 0:s.scoped),a=Wi(s==null?void 0:s.reset),I=Wi(s==null?void 0:s.root);let T=es(h.value,{prev:l.value});if(x)return T;if(a||I){const M=Number(a||1/0);for(let k=0;k<=M&&!(!T||!("prev"in T));k++)T=T.prev;return T&&typeof I=="string"&&I in T&&(T=es(es(T,{prev:T}),T[I])),T}return T.prev?es(T.prev,T):T});return Qi(Tu,m),m}function ZC(e,s){var l,h;return typeof((l=e.props)==null?void 0:l[s])<"u"||typeof((h=e.props)==null?void 0:h[ba(s)])<"u"}function GC(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},s=arguments.length>1?arguments[1]:void 0,l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:tg();const h=fr("useDefaults");if(s=s??h.type.name??h.type.__name,!s)throw new Error("[Vuetify] Could not determine component name");const m=we(()=>{var I;return(I=l.value)==null?void 0:I[e._as??s]}),_=new Proxy(e,{get(I,T){var k,F,q,X;const M=Reflect.get(I,T);return T==="class"||T==="style"?[(k=m.value)==null?void 0:k[T],M].filter(re=>re!=null):typeof T=="string"&&!ZC(h.vnode,T)?((F=m.value)==null?void 0:F[T])??((X=(q=l.value)==null?void 0:q.global)==null?void 0:X[T])??M:M}}),x=bn();ro(()=>{if(m.value){const I=Object.entries(m.value).filter(T=>{let[M]=T;return M.startsWith(M[0].toUpperCase())});I.length&&(x.value=Object.fromEntries(I))}});function a(){Sa(x,()=>{var I;Ou(es(((I=NC(Tu))==null?void 0:I.value)??{},x.value))})}return{props:_,provideSubDefaults:a}}const em=Symbol.for("vuetify:display"),Y_={mobileBreakpoint:"lg",thresholds:{xs:0,sm:600,md:960,lg:1280,xl:1920,xxl:2560}},WC=function(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Y_;return es(Y_,e)};function J_(e){return Mi&&!e?window.innerWidth:typeof e=="object"&&e.clientWidth||0}function Q_(e){return Mi&&!e?window.innerHeight:typeof e=="object"&&e.clientHeight||0}function ev(e){const s=Mi&&!e?window.navigator.userAgent:"ssr";function l(X){return!!s.match(X)}const h=l(/android/i),m=l(/iphone|ipad|ipod/i),_=l(/cordova/i),x=l(/electron/i),a=l(/chrome/i),I=l(/edge/i),T=l(/firefox/i),M=l(/opera/i),k=l(/win/i),F=l(/mac/i),q=l(/linux/i);return{android:h,ios:m,cordova:_,electron:x,chrome:a,edge:I,firefox:T,opera:M,win:k,mac:F,linux:q,touch:UC,ssr:s==="ssr"}}function HC(e,s){const{thresholds:l,mobileBreakpoint:h}=WC(e),m=bn(Q_(s)),_=bn(ev(s)),x=Oi({}),a=bn(J_(s));function I(){m.value=Q_(),a.value=J_()}function T(){I(),_.value=ev()}return ro(()=>{const M=a.value<l.sm,k=a.value<l.md&&!M,F=a.value<l.lg&&!(k||M),q=a.value<l.xl&&!(F||k||M),X=a.value<l.xxl&&!(q||F||k||M),re=a.value>=l.xxl,me=M?"xs":k?"sm":F?"md":q?"lg":X?"xl":"xxl",ye=typeof h=="number"?h:l[h],Ee=a.value<ye;x.xs=M,x.sm=k,x.md=F,x.lg=q,x.xl=X,x.xxl=re,x.smAndUp=!M,x.mdAndUp=!(M||k),x.lgAndUp=!(M||k||F),x.xlAndUp=!(M||k||F||q),x.smAndDown=!(F||q||X||re),x.mdAndDown=!(q||X||re),x.lgAndDown=!(X||re),x.xlAndDown=!re,x.name=me,x.height=m.value,x.width=a.value,x.mobile=Ee,x.mobileBreakpoint=h,x.platform=_.value,x.thresholds=l}),Mi&&window.addEventListener("resize",I,{passive:!0}),{...Fd(x),update:T,ssr:!!s}}function XC(){const e=Zn(em);if(!e)throw new Error("Could not find Vuetify display injection");return e}const KC={collapse:"mdi-chevron-up",complete:"mdi-check",cancel:"mdi-close-circle",close:"mdi-close",delete:"mdi-close-circle",clear:"mdi-close-circle",success:"mdi-check-circle",info:"mdi-information",warning:"mdi-alert-circle",error:"mdi-close-circle",prev:"mdi-chevron-left",next:"mdi-chevron-right",checkboxOn:"mdi-checkbox-marked",checkboxOff:"mdi-checkbox-blank-outline",checkboxIndeterminate:"mdi-minus-box",delimiter:"mdi-circle",sortAsc:"mdi-arrow-up",sortDesc:"mdi-arrow-down",expand:"mdi-chevron-down",menu:"mdi-menu",subgroup:"mdi-menu-down",dropdown:"mdi-menu-down",radioOn:"mdi-radiobox-marked",radioOff:"mdi-radiobox-blank",edit:"mdi-pencil",ratingEmpty:"mdi-star-outline",ratingFull:"mdi-star",ratingHalf:"mdi-star-half-full",loading:"mdi-cached",first:"mdi-page-first",last:"mdi-page-last",unfold:"mdi-unfold-more-horizontal",file:"mdi-paperclip",plus:"mdi-plus",minus:"mdi-minus",calendar:"mdi-calendar"},YC={component:e=>Oo(m0,{...e,class:"mdi"})},_i=[String,Function,Object,Array],tm=Symbol.for("vuetify:icons"),Wd=Bt({icon:{type:_i},tag:{type:String,required:!0}},"icon"),tv=Sn()({name:"VComponentIcon",props:Wd(),setup(e,s){let{slots:l}=s;return()=>{const h=e.icon;return ae(e.tag,null,{default:()=>{var m;return[e.icon?ae(h,null,null):(m=l.default)==null?void 0:m.call(l)]}})}}}),p0=Zl({name:"VSvgIcon",inheritAttrs:!1,props:Wd(),setup(e,s){let{attrs:l}=s;return()=>ae(e.tag,In(l,{style:null}),{default:()=>[ae("svg",{class:"v-icon__svg",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",role:"img","aria-hidden":"true"},[Array.isArray(e.icon)?e.icon.map(h=>Array.isArray(h)?ae("path",{d:h[0],"fill-opacity":h[1]},null):ae("path",{d:h},null)):ae("path",{d:e.icon},null)])]})}});Zl({name:"VLigatureIcon",props:Wd(),setup(e){return()=>ae(e.tag,null,{default:()=>[e.icon]})}});const m0=Zl({name:"VClassIcon",props:Wd(),setup(e){return()=>ae(e.tag,{class:e.icon},null)}}),JC={svg:{component:p0},class:{component:m0}};function QC(e){return es({defaultSet:"mdi",sets:{...JC,mdi:YC},aliases:{...KC,vuetify:["M8.2241 14.2009L12 21L22 3H14.4459L8.2241 14.2009Z",["M7.26303 12.4733L7.00113 12L2 3H12.5261C12.5261 3 12.5261 3 12.5261 3L7.26303 12.4733Z",.6]],"vuetify-outline":"svg:M7.26 12.47 12.53 3H2L7.26 12.47ZM14.45 3 8.22 14.2 12 21 22 3H14.45ZM18.6 5 12 16.88 10.51 14.2 15.62 5ZM7.26 8.35 5.4 5H9.13L7.26 8.35Z"}},e)}const eE=e=>{const s=Zn(tm);if(!s)throw new Error("Missing Vuetify Icons provide!");return{iconData:we(()=>{var I;const h=Wi(e);if(!h)return{component:tv};let m=h;if(typeof m=="string"&&(m=m.trim(),m.startsWith("$")&&(m=(I=s.aliases)==null?void 0:I[m.slice(1)])),!m)throw new Error(`Could not find aliased icon "${h}"`);if(Array.isArray(m))return{component:p0,icon:m};if(typeof m!="string")return{component:tv,icon:m};const _=Object.keys(s.sets).find(T=>typeof m=="string"&&m.startsWith(`${T}:`)),x=_?m.slice(_.length+1):m;return{component:s.sets[_??s.defaultSet].component,icon:x}})}},tE={badge:"Badge",close:"Close",dataIterator:{noResultsText:"No matching records found",loadingText:"Loading items..."},dataTable:{itemsPerPageText:"Rows per page:",ariaLabel:{sortDescending:"Sorted descending.",sortAscending:"Sorted ascending.",sortNone:"Not sorted.",activateNone:"Activate to remove sorting.",activateDescending:"Activate to sort descending.",activateAscending:"Activate to sort ascending."},sortBy:"Sort by"},dataFooter:{itemsPerPageText:"Items per page:",itemsPerPageAll:"All",nextPage:"Next page",prevPage:"Previous page",firstPage:"First page",lastPage:"Last page",pageText:"{0}-{1} of {2}"},dateRangeInput:{divider:"to"},datePicker:{ok:"OK",cancel:"Cancel",range:{title:"Select dates",header:"Enter dates"},title:"Select date",header:"Enter date",input:{placeholder:"Enter date"}},noDataText:"No data available",carousel:{prev:"Previous visual",next:"Next visual",ariaLabel:{delimiter:"Carousel slide {0} of {1}"}},calendar:{moreEvents:"{0} more"},input:{clear:"Clear {0}",prependAction:"{0} prepended action",appendAction:"{0} appended action"},fileInput:{counter:"{0} files",counterSize:"{0} files ({1} in total)"},timePicker:{am:"AM",pm:"PM"},pagination:{ariaLabel:{root:"Pagination Navigation",next:"Next page",previous:"Previous page",page:"Go to page {0}",currentPage:"Page {0}, Current page",first:"First page",last:"Last page"}},rating:{ariaLabel:{item:"Rating {0} of {1}"}},loading:"Loading...",infiniteScroll:{loadMore:"Load more",empty:"No more"}},nE={af:!1,ar:!0,bg:!1,ca:!1,ckb:!1,cs:!1,de:!1,el:!1,en:!1,es:!1,et:!1,fa:!0,fi:!1,fr:!1,hr:!1,hu:!1,he:!0,id:!1,it:!1,ja:!1,ko:!1,lv:!1,lt:!1,nl:!1,no:!1,pl:!1,pt:!1,ro:!1,ru:!1,sk:!1,sl:!1,srCyrl:!1,srLatn:!1,sv:!1,th:!1,tr:!1,az:!1,uk:!1,vi:!1,zhHans:!1,zhHant:!1};function fi(e,s,l){let h=arguments.length>3&&arguments[3]!==void 0?arguments[3]:k=>k,m=arguments.length>4&&arguments[4]!==void 0?arguments[4]:k=>k;const _=fr("useProxiedModel"),x=Kt(e[s]!==void 0?e[s]:l),a=ba(s),T=we(a!==s?()=>{var k,F,q,X;return e[s],!!(((k=_.vnode.props)!=null&&k.hasOwnProperty(s)||(F=_.vnode.props)!=null&&F.hasOwnProperty(a))&&((q=_.vnode.props)!=null&&q.hasOwnProperty(`onUpdate:${s}`)||(X=_.vnode.props)!=null&&X.hasOwnProperty(`onUpdate:${a}`)))}:()=>{var k,F;return e[s],!!((k=_.vnode.props)!=null&&k.hasOwnProperty(s)&&((F=_.vnode.props)!=null&&F.hasOwnProperty(`onUpdate:${s}`)))});Sa(()=>!T.value,()=>{wn(()=>e[s],k=>{x.value=k})});const M=we({get(){const k=e[s];return h(T.value?k:x.value)},set(k){const F=m(k),q=rn(T.value?e[s]:x.value);q===F||h(q)===k||(x.value=F,_==null||_.emit(`update:${s}`,F))}});return Object.defineProperty(M,"externalValue",{get:()=>T.value?e[s]:x.value}),M}const nv="$vuetify.",iv=(e,s)=>e.replace(/\{(\d+)\}/g,(l,h)=>String(s[+h])),g0=(e,s,l)=>function(h){for(var m=arguments.length,_=new Array(m>1?m-1:0),x=1;x<m;x++)_[x-1]=arguments[x];if(!h.startsWith(nv))return iv(h,_);const a=h.replace(nv,""),I=e.value&&l.value[e.value],T=s.value&&l.value[s.value];let M=Hp(I,a,null);return M||(`${h}${e.value}`,M=Hp(T,a,null)),M||(M=h),typeof M!="string"&&(M=h),iv(M,_)};function y0(e,s){return(l,h)=>new Intl.NumberFormat([e.value,s.value],h).format(l)}function Sp(e,s,l){const h=fi(e,s,e[s]??l.value);return h.value=e[s]??l.value,wn(l,m=>{e[s]==null&&(h.value=l.value)}),h}function _0(e){return s=>{const l=Sp(s,"locale",e.current),h=Sp(s,"fallback",e.fallback),m=Sp(s,"messages",e.messages);return{name:"vuetify",current:l,fallback:h,messages:m,t:g0(l,h,m),n:y0(l,h),provide:_0({current:l,fallback:h,messages:m})}}}function iE(e){const s=bn((e==null?void 0:e.locale)??"en"),l=bn((e==null?void 0:e.fallback)??"en"),h=Kt({en:tE,...e==null?void 0:e.messages});return{name:"vuetify",current:s,fallback:l,messages:h,t:g0(s,l,h),n:y0(s,l),provide:_0({current:s,fallback:l,messages:h})}}const vd=Symbol.for("vuetify:locale");function rE(e){return e.name!=null}function sE(e){const s=e!=null&&e.adapter&&rE(e==null?void 0:e.adapter)?e==null?void 0:e.adapter:iE(e),l=oE(s,e);return{...s,...l}}function Hd(){const e=Zn(vd);if(!e)throw new Error("[Vuetify] Could not find injected locale instance");return e}function oE(e,s){const l=Kt((s==null?void 0:s.rtl)??nE),h=we(()=>l.value[e.current.value]??!1);return{isRtl:h,rtl:l,rtlClasses:we(()=>`v-locale--is-${h.value?"rtl":"ltr"}`)}}function Gl(){const e=Zn(vd);if(!e)throw new Error("[Vuetify] Could not find injected rtl instance");return{isRtl:e.isRtl,rtlClasses:e.rtlClasses}}const Cl=2.4,rv=.2126729,sv=.7151522,ov=.072175,aE=.55,lE=.58,cE=.57,uE=.62,Qh=.03,av=1.45,hE=5e-4,dE=1.25,fE=1.25,lv=.078,cv=12.82051282051282,ed=.06,uv=.001;function hv(e,s){const l=(e.r/255)**Cl,h=(e.g/255)**Cl,m=(e.b/255)**Cl,_=(s.r/255)**Cl,x=(s.g/255)**Cl,a=(s.b/255)**Cl;let I=l*rv+h*sv+m*ov,T=_*rv+x*sv+a*ov;if(I<=Qh&&(I+=(Qh-I)**av),T<=Qh&&(T+=(Qh-T)**av),Math.abs(T-I)<hE)return 0;let M;if(T>I){const k=(T**aE-I**lE)*dE;M=k<uv?0:k<lv?k-k*cv*ed:k-ed}else{const k=(T**uE-I**cE)*fE;M=k>-uv?0:k>-lv?k-k*cv*ed:k+ed}return M*100}const xd=Symbol.for("vuetify:theme"),Ar=Bt({theme:String},"theme"),nu={defaultTheme:"light",variations:{colors:[],lighten:0,darken:0},themes:{light:{dark:!1,colors:{background:"#FFFFFF",surface:"#FFFFFF","surface-variant":"#424242","on-surface-variant":"#EEEEEE",primary:"#6200EE","primary-darken-1":"#3700B3",secondary:"#03DAC6","secondary-darken-1":"#018786",error:"#B00020",info:"#2196F3",success:"#4CAF50",warning:"#FB8C00"},variables:{"border-color":"#000000","border-opacity":.12,"high-emphasis-opacity":.87,"medium-emphasis-opacity":.6,"disabled-opacity":.38,"idle-opacity":.04,"hover-opacity":.04,"focus-opacity":.12,"selected-opacity":.08,"activated-opacity":.12,"pressed-opacity":.12,"dragged-opacity":.08,"theme-kbd":"#212529","theme-on-kbd":"#FFFFFF","theme-code":"#F5F5F5","theme-on-code":"#000000"}},dark:{dark:!0,colors:{background:"#121212",surface:"#212121","surface-variant":"#BDBDBD","on-surface-variant":"#424242",primary:"#BB86FC","primary-darken-1":"#3700B3",secondary:"#03DAC5","secondary-darken-1":"#03DAC5",error:"#CF6679",info:"#2196F3",success:"#4CAF50",warning:"#FB8C00"},variables:{"border-color":"#FFFFFF","border-opacity":.12,"high-emphasis-opacity":1,"medium-emphasis-opacity":.7,"disabled-opacity":.5,"idle-opacity":.1,"hover-opacity":.04,"focus-opacity":.12,"selected-opacity":.08,"activated-opacity":.12,"pressed-opacity":.16,"dragged-opacity":.08,"theme-kbd":"#212529","theme-on-kbd":"#FFFFFF","theme-code":"#343434","theme-on-code":"#CCCCCC"}}}};function pE(){var l,h;let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:nu;if(!e)return{...nu,isDisabled:!0};const s={};for(const[m,_]of Object.entries(e.themes??{})){const x=_.dark||m==="dark"?(l=nu.themes)==null?void 0:l.dark:(h=nu.themes)==null?void 0:h.light;s[m]=es(x,_)}return es(nu,{...e,themes:s})}function mE(e){const s=Oi(pE(e)),l=Kt(s.defaultTheme),h=Kt(s.themes),m=we(()=>{const M={};for(const[k,F]of Object.entries(h.value)){const q=M[k]={...F,colors:{...F.colors}};if(s.variations)for(const X of s.variations.colors){const re=q.colors[X];if(re)for(const me of["lighten","darken"]){const ye=me==="lighten"?RC:BC;for(const Ee of i0(s.variations[me],1))q.colors[`${X}-${me}-${Ee}`]=DC(ye(_a(re),Ee))}}for(const X of Object.keys(q.colors)){if(/^on-[a-z]/.test(X)||q.colors[`on-${X}`])continue;const re=`on-${X}`,me=_a(q.colors[X]),ye=Math.abs(hv(_a(0),me)),Ee=Math.abs(hv(_a(16777215),me));q.colors[re]=Ee>Math.min(ye,50)?"#fff":"#000"}}return M}),_=we(()=>m.value[l.value]),x=we(()=>{const M=[];_.value.dark&&fa(M,":root",["color-scheme: dark"]),fa(M,":root",dv(_.value));for(const[X,re]of Object.entries(m.value))fa(M,`.v-theme--${X}`,[`color-scheme: ${re.dark?"dark":"normal"}`,...dv(re)]);const k=[],F=[],q=new Set(Object.values(m.value).flatMap(X=>Object.keys(X.colors)));for(const X of q)/^on-[a-z]/.test(X)?fa(F,`.${X}`,[`color: rgb(var(--v-theme-${X})) !important`]):(fa(k,`.bg-${X}`,[`--v-theme-overlay-multiplier: var(--v-theme-${X}-overlay-multiplier)`,`background-color: rgb(var(--v-theme-${X})) !important`,`color: rgb(var(--v-theme-on-${X})) !important`]),fa(F,`.text-${X}`,[`color: rgb(var(--v-theme-${X})) !important`]),fa(F,`.border-${X}`,[`--v-border-color: var(--v-theme-${X})`]));return M.push(...k,...F),M.map((X,re)=>re===0?X:`    ${X}`).join("")});function a(){return{style:[{children:x.value,id:"vuetify-theme-stylesheet",nonce:s.cspNonce||!1}]}}function I(M){if(s.isDisabled)return;const k=M._context.provides.usehead;if(k)if(k.push){const q=k.push(a);wn(x,()=>{q.patch(a)})}else Mi?(k.addHeadObjs(we(a)),ro(()=>k.updateDOM())):k.addHeadObjs(a());else{let X=function(){if(typeof document<"u"&&!q){const re=document.createElement("style");re.type="text/css",re.id="vuetify-theme-stylesheet",s.cspNonce&&re.setAttribute("nonce",s.cspNonce),q=re,document.head.appendChild(q)}q&&(q.innerHTML=x.value)};var F=X;let q=Mi?document.getElementById("vuetify-theme-stylesheet"):null;wn(x,X,{immediate:!0})}}const T=we(()=>s.isDisabled?void 0:`v-theme--${l.value}`);return{install:I,isDisabled:s.isDisabled,name:l,themes:h,current:_,computedThemes:m,themeClasses:T,styles:x,global:{name:l,current:_}}}function is(e){fr("provideTheme");const s=Zn(xd,null);if(!s)throw new Error("Could not find Vuetify theme injection");const l=we(()=>e.theme??(s==null?void 0:s.name.value)),h=we(()=>s.isDisabled?void 0:`v-theme--${l.value}`),m={...s,name:l,themeClasses:h};return Qi(xd,m),m}function fa(e,s,l){e.push(`${s} {
`,...l.map(h=>`  ${h};
`),`}
`)}function dv(e){const s=e.dark?2:1,l=e.dark?1:2,h=[];for(const[m,_]of Object.entries(e.colors)){const x=_a(_);h.push(`--v-theme-${m}: ${x.r},${x.g},${x.b}`),m.startsWith("on-")||h.push(`--v-theme-${m}-overlay-multiplier: ${FC(_)>.18?s:l}`)}for(const[m,_]of Object.entries(e.variables)){const x=typeof _=="string"&&_.startsWith("#")?_a(_):void 0,a=x?`${x.r}, ${x.g}, ${x.b}`:void 0;h.push(`--v-${m}: ${a??_}`)}return h}const nm={"001":1,AD:1,AE:6,AF:6,AG:0,AI:1,AL:1,AM:1,AN:1,AR:1,AS:0,AT:1,AU:1,AX:1,AZ:1,BA:1,BD:0,BE:1,BG:1,BH:6,BM:1,BN:1,BR:0,BS:0,BT:0,BW:0,BY:1,BZ:0,CA:0,CH:1,CL:1,CM:1,CN:1,CO:0,CR:1,CY:1,CZ:1,DE:1,DJ:6,DK:1,DM:0,DO:0,DZ:6,EC:1,EE:1,EG:6,ES:1,ET:0,FI:1,FJ:1,FO:1,FR:1,GB:1,"GB-alt-variant":0,GE:1,GF:1,GP:1,GR:1,GT:0,GU:0,HK:0,HN:0,HR:1,HU:1,ID:0,IE:1,IL:0,IN:0,IQ:6,IR:6,IS:1,IT:1,JM:0,JO:6,JP:0,KE:0,KG:1,KH:0,KR:0,KW:6,KZ:1,LA:0,LB:1,LI:1,LK:1,LT:1,LU:1,LV:1,LY:6,MC:1,MD:1,ME:1,MH:0,MK:1,MM:0,MN:1,MO:0,MQ:1,MT:0,MV:5,MX:0,MY:1,MZ:0,NI:0,NL:1,NO:1,NP:0,NZ:1,OM:6,PA:0,PE:0,PH:0,PK:0,PL:1,PR:0,PT:0,PY:0,QA:6,RE:1,RO:1,RS:1,RU:1,SA:0,SD:6,SE:1,SG:0,SI:1,SK:1,SM:1,SV:0,SY:6,TH:0,TJ:1,TM:1,TR:1,TT:0,TW:0,UA:1,UM:0,US:0,UY:1,UZ:1,VA:1,VE:0,VI:0,VN:1,WS:0,XK:1,YE:0,ZA:0,ZW:0};function gE(e,s){const l=[];let h=[];const m=v0(e),_=x0(e),x=m.getDay()-nm[s.slice(-2).toUpperCase()],a=_.getDay()-nm[s.slice(-2).toUpperCase()];for(let I=0;I<x;I++){const T=new Date(m);T.setDate(T.getDate()-(x-I)),h.push(T)}for(let I=1;I<=_.getDate();I++){const T=new Date(e.getFullYear(),e.getMonth(),I);h.push(T),h.length===7&&(l.push(h),h=[])}for(let I=1;I<7-a;I++){const T=new Date(_);T.setDate(T.getDate()+I),h.push(T)}return l.push(h),l}function v0(e){return new Date(e.getFullYear(),e.getMonth(),1)}function x0(e){return new Date(e.getFullYear(),e.getMonth()+1,0)}function yE(e){if(e==null)return new Date;if(e instanceof Date)return e;if(typeof e=="string"){const s=Date.parse(e);if(!isNaN(s))return new Date(s)}return null}const fv=new Date(2e3,0,2);function _E(e){const s=nm[e.slice(-2).toUpperCase()];return i0(7).map(l=>{const h=new Date(fv);return h.setDate(fv.getDate()+s+l),new Intl.DateTimeFormat(e,{weekday:"short"}).format(h)})}function vE(e,s,l){const h=new Date(e);let m={};switch(s){case"fullDateWithWeekday":m={weekday:"long",day:"numeric",month:"long",year:"numeric"};break;case"normalDateWithWeekday":m={weekday:"short",day:"numeric",month:"short"};break;case"keyboardDate":m={};break;case"monthAndDate":m={month:"long",day:"numeric"};break;case"monthAndYear":m={month:"long",year:"numeric"};break;case"dayOfMonth":m={day:"numeric"};break;default:m={timeZone:"UTC",timeZoneName:"short"}}return new Intl.DateTimeFormat(l,m).format(h)}function xE(e,s){const l=new Date(e);return l.setDate(l.getDate()+s),l}function bE(e,s){const l=new Date(e);return l.setMonth(l.getMonth()+s),l}function wE(e){return e.getFullYear()}function SE(e){return e.getMonth()}function CE(e){return new Date(e.getFullYear(),0,1)}function EE(e){return new Date(e.getFullYear(),11,31)}function TE(e,s){return im(e,s[0])&&AE(e,s[1])}function IE(e){const s=new Date(e);return s instanceof Date&&!isNaN(s.getTime())}function im(e,s){return e.getTime()>s.getTime()}function AE(e,s){return e.getTime()<s.getTime()}function pv(e,s){return e.getTime()===s.getTime()}function PE(e,s){return e.getDate()===s.getDate()&&e.getMonth()===s.getMonth()&&e.getFullYear()===s.getFullYear()}function kE(e,s){return e.getMonth()===s.getMonth()&&e.getFullYear()===s.getFullYear()}function ME(e,s,l){const h=new Date(e),m=new Date(s);return l==="month"?h.getMonth()-m.getMonth()+(h.getFullYear()-m.getFullYear())*12:Math.floor((h.getTime()-m.getTime())/(1e3*60*60*24))}function DE(e,s){const l=new Date(e);return l.setFullYear(s),l}class zE{constructor(s){this.locale=s.locale}date(s){return yE(s)}toJsDate(s){return s}addDays(s,l){return xE(s,l)}addMonths(s,l){return bE(s,l)}getWeekArray(s){return gE(s,this.locale)}startOfMonth(s){return v0(s)}endOfMonth(s){return x0(s)}format(s,l){return vE(s,l,this.locale)}isEqual(s,l){return pv(s,l)}isValid(s){return IE(s)}isWithinRange(s,l){return TE(s,l)}isAfter(s,l){return im(s,l)}isBefore(s,l){return!im(s,l)&&!pv(s,l)}isSameDay(s,l){return PE(s,l)}isSameMonth(s,l){return kE(s,l)}setYear(s,l){return DE(s,l)}getDiff(s,l,h){return ME(s,l,h)}getWeekdays(){return _E(this.locale)}getYear(s){return wE(s)}getMonth(s){return SE(s)}startOfYear(s){return CE(s)}endOfYear(s){return EE(s)}}const mv=Symbol.for("vuetify:date-adapter");function LE(e){return es({adapter:zE,locale:{af:"af-ZA",bg:"bg-BG",ca:"ca-ES",ckb:"",cs:"",de:"de-DE",el:"el-GR",en:"en-US",et:"et-EE",fa:"fa-IR",fi:"fi-FI",hr:"hr-HR",hu:"hu-HU",he:"he-IL",id:"id-ID",it:"it-IT",ja:"ja-JP",ko:"ko-KR",lv:"lv-LV",lt:"lt-LT",nl:"nl-NL",no:"nn-NO",pl:"pl-PL",pt:"pt-PT",ro:"ro-RO",ru:"ru-RU",sk:"sk-SK",sl:"sl-SI",srCyrl:"sr-SP",srLatn:"sr-SP",sv:"sv-SE",th:"th-TH",tr:"tr-TR",az:"az-AZ",uk:"uk-UA",vi:"vi-VN",zhHans:"zh-CN",zhHant:"zh-TW"}},e)}function b0(e){const s=Kt(),l=Kt();if(Mi){const h=new ResizeObserver(m=>{e==null||e(m,h),m.length&&(l.value=m[0].contentRect)});oo(()=>{h.disconnect()}),wn(s,(m,_)=>{_&&(h.unobserve(Kp(_)),l.value=void 0),m&&h.observe(Kp(m))},{flush:"post"})}return{resizeRef:s,contentRect:Ru(l)}}const gv=Symbol.for("vuetify:layout"),RE=Symbol.for("vuetify:layout-item"),yv=1e3,BE=Bt({overlaps:{type:Array,default:()=>[]},fullHeight:Boolean},"layout"),FE=(e,s,l,h)=>{let m={top:0,left:0,right:0,bottom:0};const _=[{id:"",layer:{...m}}];for(const x of e){const a=s.get(x),I=l.get(x),T=h.get(x);if(!a||!I||!T)continue;const M={...m,[a.value]:parseInt(m[a.value],10)+(T.value?parseInt(I.value,10):0)};_.push({id:x,layer:M}),m=M}return _};function OE(e){const s=Zn(gv,null),l=we(()=>s?s.rootZIndex.value-100:yv),h=Kt([]),m=Oi(new Map),_=Oi(new Map),x=Oi(new Map),a=Oi(new Map),I=Oi(new Map),{resizeRef:T,contentRect:M}=b0(),k=we(()=>{const Ue=new Map,ze=e.overlaps??[];for(const j of ze.filter(G=>G.includes(":"))){const[G,pe]=j.split(":");if(!h.value.includes(G)||!h.value.includes(pe))continue;const Se=m.get(G),Ce=m.get(pe),_e=_.get(G),Fe=_.get(pe);!Se||!Ce||!_e||!Fe||(Ue.set(pe,{position:Se.value,amount:parseInt(_e.value,10)}),Ue.set(G,{position:Ce.value,amount:-parseInt(Fe.value,10)}))}return Ue}),F=we(()=>{const Ue=[...new Set([...x.values()].map(j=>j.value))].sort((j,G)=>j-G),ze=[];for(const j of Ue){const G=h.value.filter(pe=>{var Se;return((Se=x.get(pe))==null?void 0:Se.value)===j});ze.push(...G)}return FE(ze,m,_,a)}),q=we(()=>!Array.from(I.values()).some(Ue=>Ue.value)),X=we(()=>F.value[F.value.length-1].layer),re=we(()=>({"--v-layout-left":pn(X.value.left),"--v-layout-right":pn(X.value.right),"--v-layout-top":pn(X.value.top),"--v-layout-bottom":pn(X.value.bottom),...q.value?void 0:{transition:"none"}})),me=we(()=>F.value.slice(1).map((Ue,ze)=>{let{id:j}=Ue;const{layer:G}=F.value[ze],pe=_.get(j),Se=m.get(j);return{id:j,...G,size:Number(pe.value),position:Se.value}})),ye=Ue=>me.value.find(ze=>ze.id===Ue),Ee=fr("createLayout"),be=bn(!1);Ca(()=>{be.value=!0}),Qi(gv,{register:(Ue,ze)=>{let{id:j,order:G,position:pe,layoutSize:Se,elementSize:Ce,active:_e,disableTransitions:Fe,absolute:ut}=ze;x.set(j,G),m.set(j,pe),_.set(j,Se),a.set(j,_e),Fe&&I.set(j,Fe);const je=du(RE,Ee==null?void 0:Ee.vnode).indexOf(Ue);je>-1?h.value.splice(je,0,j):h.value.push(j);const Ve=we(()=>me.value.findIndex(rt=>rt.id===j)),Ge=we(()=>l.value+F.value.length*2-Ve.value*2),Tt=we(()=>{const rt=pe.value==="left"||pe.value==="right",It=pe.value==="right",Gt=pe.value==="bottom",Rt={[pe.value]:0,zIndex:Ge.value,transform:`translate${rt?"X":"Y"}(${(_e.value?0:-110)*(It||Gt?-1:1)}%)`,position:ut.value||l.value!==yv?"absolute":"fixed",...q.value?void 0:{transition:"none"}};if(!be.value)return Rt;const Ne=me.value[Ve.value];if(!Ne)throw new Error(`[Vuetify] Could not find layout item "${j}"`);const Ae=k.value.get(j);return Ae&&(Ne[Ae.position]+=Ae.amount),{...Rt,height:rt?`calc(100% - ${Ne.top}px - ${Ne.bottom}px)`:Ce.value?`${Ce.value}px`:void 0,left:It?void 0:`${Ne.left}px`,right:It?`${Ne.right}px`:void 0,top:pe.value!=="bottom"?`${Ne.top}px`:void 0,bottom:pe.value!=="top"?`${Ne.bottom}px`:void 0,width:rt?Ce.value?`${Ce.value}px`:void 0:`calc(100% - ${Ne.left}px - ${Ne.right}px)`}}),At=we(()=>({zIndex:Ge.value-1}));return{layoutItemStyles:Tt,layoutItemScrimStyles:At,zIndex:Ge}},unregister:Ue=>{x.delete(Ue),m.delete(Ue),_.delete(Ue),a.delete(Ue),I.delete(Ue),h.value=h.value.filter(ze=>ze!==Ue)},mainRect:X,mainStyles:re,getLayoutItem:ye,items:me,layoutRect:M,rootZIndex:l});const Oe=we(()=>["v-layout",{"v-layout--full-height":e.fullHeight}]),Qe=we(()=>({zIndex:l.value,position:s?"relative":void 0,overflow:s?"hidden":void 0}));return{layoutClasses:Oe,layoutStyles:Qe,getLayoutItem:ye,items:me,layoutRect:M,layoutRef:T}}function w0(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{blueprint:s,...l}=e,h=es(s,l),{aliases:m={},components:_={},directives:x={}}=h,a=qC(h.defaults),I=HC(h.display,h.ssr),T=mE(h.theme),M=QC(h.icons),k=sE(h.locale),F=LE(h.date);return{install:X=>{for(const re in x)X.directive(re,x[re]);for(const re in _)X.component(re,_[re]);for(const re in m)X.component(re,Zl({...m[re],name:re,aliasName:m[re].name}));if(T.install(X),X.provide(Tu,a),X.provide(em,I),X.provide(xd,T),X.provide(tm,M),X.provide(vd,k),X.provide(mv,F),Mi&&h.ssr)if(X.$nuxt)X.$nuxt.hook("app:suspense:resolve",()=>{I.update()});else{const{mount:re}=X;X.mount=function(){const me=re(...arguments);return er(()=>I.update()),X.mount=re,me}}vs.reset(),X.mixin({computed:{$vuetify(){return Oi({defaults:El.call(this,Tu),display:El.call(this,em),theme:El.call(this,xd),icons:El.call(this,tm),locale:El.call(this,vd),date:El.call(this,mv)})}}})},defaults:a,display:I,theme:T,icons:M,locale:k,date:F}}const VE="3.3.6";w0.version=VE;function El(e){var h,m;const s=this.$,l=((h=s.parent)==null?void 0:h.provides)??((m=s.vnode.appContext)==null?void 0:m.provides);if(l&&e in l)return l[e]}const $E=w0({theme:{defaultTheme:"light"}}),S0=Symbol("vue-facing-decorator-slot");class UE{constructor(s){this.names=new Map,this.inComponent=!1,this.cachedVueComponent=null,this.master=s}obtainMap(s){let l=this.names.get(s);return l||(l=new Map,this.names.set(s,l)),l}}function NE(e){if(Xd(e))throw"";const s=new UE(e);return Object.defineProperty(e,S0,{enumerable:!1,value:s}),s}function Xd(e){var s;return(s=Object.getOwnPropertyDescriptor(e,S0))===null||s===void 0?void 0:s.value}function Vi(e){const s=Xd(e);return s||NE(e)}function jE(e,s){return e.reduce((l,h)=>(l[h]=s[h],l),{})}function ng(e){const s=[];let l=e;do s.unshift(l),l=Object.getPrototypeOf(l);while(l.constructor!==sg&&!Xd(l));return s}function C0(e){let s=Object.getPrototypeOf(e);for(;s.constructor!==sg;){const l=Xd(s);if(l)return l;s=Object.getPrototypeOf(s)}return null}function E0(e,s){return e.filter(l=>{let h=s;for(;h!=null;){for(const m of h.names.keys()){if(["watch","hooks","setup","emits"].includes(m))continue;if(h.names.get(m).has(l))return!1}h=C0(h.master)}return!0})}function ig(e,s){const l=Object.getOwnPropertyDescriptors(e);return Object.keys(l).filter(h=>s(l[h],h))}function rg(e){function s(l,h){if(h)e(l,h);else return function(m,_){e(m,_,l)}}return s}const qE=e=>e instanceof Promise;function ZE(e,s){const h=Vi(e.prototype).obtainMap("setup");if(h.size===0)return;const m=function(_,x){const a={};let I=null;for(const T of h.keys()){const M=h.get(T).setupFunction(_,x);qE(M)?(I??(I=[]),I.push(M.then(k=>{a[T]=k}))):a[T]=M}return Array.isArray(I)?Promise.all(I).then(()=>a):a};s.setup=m}function GE(e,s){var l;(l=s.computed)!==null&&l!==void 0||(s.computed={});const h=Vi(e.prototype),m=h.obtainMap("computed"),_=h.obtainMap("vanilla");ng(e.prototype).forEach(a=>{ig(a,(I,T)=>(typeof I.get=="function"||typeof I.set=="function")&&!_.has(T)).forEach(I=>{m.set(I,!0);const T=Object.getOwnPropertyDescriptor(a,I);s.computed[I]={get:typeof T.get=="function"?T.get:void 0,set:typeof T.set=="function"?T.set:void 0}})})}function WE(e,s,l,h){var m;(m=s.data)!==null&&m!==void 0||(s.data={});const _=new e(s,l);let x=ig(_,I=>!!I.enumerable);const a=Vi(e.prototype);x=E0(x,a),Object.assign(s.data,jE(x,_))}const HE=["beforeCreate","created","beforeMount","mounted","beforeUpdate","updated","activated","deactivated","beforeDestroy","beforeUnmount","destroyed","unmounted","renderTracked","renderTriggered","errorCaptured","serverPrefetch","render"];function XE(e,s){var l,h;const m=Vi(e.prototype),_=ng(e.prototype),x=m.obtainMap("hooks");(l=s.hooks)!==null&&l!==void 0||(s.hooks={}),(h=s.methods)!==null&&h!==void 0||(s.methods={});const a={},I={};_.forEach(M=>{E0(ig(M,(k,F)=>F==="constructor"?!1:typeof k.value=="function"),m).forEach(k=>{HE.includes(k)||x.has(k)?a[k]=M[k]:I[k]=M[k]})}),Object.assign(s.methods,I);const T=s.beforeCreateCallbacks;if(T&&T.length>0){const M=a.beforeCreate;a.beforeCreate=function(){T.forEach(k=>k.apply(this,arguments)),M&&M.apply(this,arguments)}}Object.assign(s.hooks,a)}function T0(e,s){var l;(l=e.beforeCreateCallbacks)!==null&&l!==void 0||(e.beforeCreateCallbacks=[]),e.beforeCreateCallbacks.push(function(){const h=this;s(h).forEach((_,x)=>{Object.defineProperty(h,x,_)})})}const KE=rg(function(e,s){Vi(e).obtainMap("ref").set(s,!0)});function YE(e,s){const h=Vi(e.prototype).obtainMap("ref");h&&T0(s,m=>{const _=new Map;return h.forEach((x,a)=>{_.set(a,{get:function(){return m.$refs[a]},set:void 0})}),_})}function xs(e,s){return function(l,h){const _=Vi(l).obtainMap("watch"),x=Object.assign({},s??{},{key:e,handler:l[h]});if(_.has(h)){const a=_.get(h);Array.isArray(a)?a.push(x):_.set(h,[a,x])}else _.set(h,x)}}function JE(e,s){var l;(l=s.watch)!==null&&l!==void 0||(s.watch={});const m=Vi(e.prototype).obtainMap("watch");m&&m.forEach((_,x)=>{(Array.isArray(_)?_:[_]).forEach(I=>{if(!s.watch[I.key])s.watch[I.key]=I;else{const T=s.watch[I.key];Array.isArray(T)?T.push(I):s.watch[I.key]=[T,I]}})})}const Pr=rg(function(e,s,l){const m=Vi(e).obtainMap("props"),_=Object.assign({},l??{});m.set(s,_)});function QE(e,s){var l;(l=s.props)!==null&&l!==void 0||(s.props={});const m=Vi(e.prototype).obtainMap("props");m&&m.forEach((_,x)=>{s.props[x]=_})}function eT(e,s){var l;(l=s.inject)!==null&&l!==void 0||(s.inject={});const m=Vi(e.prototype).obtainMap("inject");m&&m.forEach((_,x)=>{s.inject[x]=_})}var tT=globalThis&&globalThis.__awaiter||function(e,s,l,h){function m(_){return _ instanceof l?_:new l(function(x){x(_)})}return new(l||(l=Promise))(function(_,x){function a(M){try{T(h.next(M))}catch(k){x(k)}}function I(M){try{T(h.throw(M))}catch(k){x(k)}}function T(M){M.done?_(M.value):m(M.value).then(a,I)}T((h=h.apply(e,s||[])).next())})};const nT=rg(function(e,s,l){Vi(e).obtainMap("emit").set(s,typeof l>"u"?null:l)});function iT(e,s){var l;(l=s.methods)!==null&&l!==void 0||(s.methods={});const h=e.prototype,m=Vi(h),_=m.obtainMap("emit"),x=m.obtainMap("emits");_&&_.forEach((a,I)=>{const T=a===null?I:a;x.set(T,!0),s.methods[I]=function(){return tT(this,arguments,void 0,function*(){const M=h[I].apply(this,arguments);if(M instanceof Promise){const k=yield M;this.$emit(T,k)}else this.$emit(T,M)})}})}function rT(e,s){var l;(l=s.computed)!==null&&l!==void 0||(s.computed={});const m=Vi(e.prototype).obtainMap("v-model");m&&m.size>0&&m.forEach((_,x)=>{var a;const I=(a=_&&_.name)!==null&&a!==void 0?a:"modelValue";s.computed[x]={get:function(){return this[I]},set:function(T){this.$emit(`update:${I}`,T)}}})}function sT(e,s){const h=Vi(e.prototype).obtainMap("vanilla"),m=ng(e.prototype),_=new Map;T0(s,x=>(m.forEach(a=>{const I=Object.getOwnPropertyDescriptors(a);for(const T in I){const M=I[T];M&&h.has(T)&&(typeof M.get=="function"||typeof M.set=="function")&&_.set(T,{set:typeof M.set=="function"?M.set.bind(x):void 0,get:typeof M.get=="function"?M.get.bind(x):void 0})}}),_))}const oT=[];function aT(e,s){const l={};ZE(e,l),rT(e,l),GE(e,l),JE(e,l),QE(e,l),eT(e,l),iT(e,l),YE(e,l),XE(e,l),sT(e,l);const h=l.setup?function(_,x){return l.setup(_,x)}:void 0;return Object.assign(Object.assign({setup:h,data(){var _;return delete l.data,WE(e,l,this),(_=l.data)!==null&&_!==void 0?_:{}},methods:l.methods,computed:l.computed,watch:l.watch,props:l.props,inject:l.inject},l.hooks),{extends:s})}function lT(e,s,l){const h=aT(e,l),m=Vi(e.prototype);Object.keys(s).reduce((x,a)=>(["options","modifier","emits","setup"].includes(a)||(x[a]=s[a]),x),h);let _=Array.from(m.obtainMap("emits").keys());if(Array.isArray(s.emits)&&(_=Array.from(new Set([..._,...s.emits]))),h.emits=_,oT.forEach(x=>{x.creator.apply({},[h,x.key])}),s.setup)if(!h.setup)h.setup=s.setup;else{const x=h.setup,a=s.setup,I=function(T,M){const k=a(T,M),F=x(T,M);return F instanceof Promise||k instanceof Promise?Promise.all([k,F]).then(q=>Object.assign({},q[0],q[1])):Object.assign({},k,F)};h.setup=I}return s.options&&Object.assign(h,s.options),s.modifier&&s.modifier(h),$d(h)}function cT(e,s){const l=Vi(e.prototype);l.inComponent=!0;const h=C0(e.prototype);if(h){if(!h.inComponent)throw"Class should be decorated by Component or ComponentBase: "+l.master;if(h.cachedVueComponent===null)throw"Component decorator 1"}const m=lT(e,s,h===null?void 0:h.cachedVueComponent);m.__vfdConstructor=e,l.cachedVueComponent=m}function uT(e,s){return typeof e=="function"?s(e,{}):function(l){return s(l,e)}}function pr(e){return uT(e,function(s,l){return cT(s,l),Vi(s.prototype).cachedVueComponent})}const sg=class{constructor(e,s){const l=e.props;l&&Object.keys(l).forEach(h=>{this[h]=s[h]})}},mr=sg,jn=Gm("filter",{state:()=>({search:"",isMapSynced:!1,resetTrigger:!1,mapShownAssociations:[],countriesFilter:[],thematicsFilter:[],countries:[],thematics:[{value:"accueil",label:"Accueil, assistance et orientation"},{value:"accompagnement",label:"Accompagnement  des migrants de retour"},{value:"humanitaire",label:"Assistance humanitaire (réfugies, déplacés, apatrides)"},{value:"cohesion",label:"Cohésion sociale et vivre ensemble, lutte contre les discriminations"},{value:"droit",label:"Droit et protection des migrants"},{value:"education_sante",label:"Education et santé"},{value:"enfants",label:"Enfants et migration"},{value:"genre",label:"Genre et migration"},{value:"gouvernance",label:"Gouvernance et politiques migratoires"},{value:"professionnel",label:"Formation, insertion professionnelle, intégration économique"},{value:"developpement",label:"Migration et développement "},{value:"plaidoyer",label:"Plaidoyer et sensibilisation"},{value:"circulation",label:"Prévention de la migration irrégulière, promotion de la migration légale et de la liberté de circulation"},{value:"autre_theme",label:"Autre"}]}),getters:{getThematicName:e=>s=>{var l;return((l=e.thematics.find(h=>h.value===s))==null?void 0:l.label)??null}},actions:{}}),Ei=Gm("associations",{state:()=>({associations:[],activeAssociationId:null,hoveredAssociationId:null}),getters:{filteredAssociationsWithoutMapFilter:e=>{let s=e.associations;if(jn().countriesFilter.length&&(s=s.filter(l=>jn().countriesFilter.includes(l.country))),jn().thematicsFilter.length&&(s=s.filter(l=>l.thematics.some(h=>jn().thematicsFilter.includes(h)))),jn().search!==""){let l=[];s.forEach(h=>{let m=h.name.normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLowerCase(),_=jn().search.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"");m.includes(_)&&l.push(h)}),s=l}return s},filteredAssociations(){let e=this.filteredAssociationsWithoutMapFilter;return jn().isMapSynced&&(e=e.filter(s=>jn().mapShownAssociations.includes(s.id))),e.sort((s,l)=>s.name.localeCompare(l.name))},activeAssociation:e=>e.associations.find(s=>s.id===e.activeAssociationId)??null},actions:{}}),oi=Gm("app",{state:()=>({isAboutModalShown:!1,isRedirectionModalShown:!1,isInfoPanelShown:!1,isFiltersBarShown:!1,isDownloadShown:!1,triggerZoomReset:!1,downloadReports:[{name:"Résultats synthétiques Tunisie",filename:"Résultats synthétiques_Tunisie.pdf"},{name:"Synthèse Nationale Côte d'Ivoire",filename:"Synthèse Nationale _Côte d'Ivoire.pdf"},{name:"Synthèse Nationale Sénégal",filename:"Synthèse Nationale_Sénégal.pdf"}]}),getters:{},actions:{}});var I0=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function hT(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var A0={exports:{}};(function(e,s){(function(l,h){e.exports=h()})(I0,function(){var l,h,m;function _(a,I){if(!l)l=I;else if(!h)h=I;else{var T="var sharedChunk = {}; ("+l+")(sharedChunk); ("+h+")(sharedChunk);",M={};l(M),m=I(M),typeof window<"u"&&(m.workerUrl=window.URL.createObjectURL(new Blob([T],{type:"text/javascript"})))}}_(["exports"],function(a){function I(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}var T=M;function M(i,t){this.x=i,this.y=t}M.prototype={clone:function(){return new M(this.x,this.y)},add:function(i){return this.clone()._add(i)},sub:function(i){return this.clone()._sub(i)},multByPoint:function(i){return this.clone()._multByPoint(i)},divByPoint:function(i){return this.clone()._divByPoint(i)},mult:function(i){return this.clone()._mult(i)},div:function(i){return this.clone()._div(i)},rotate:function(i){return this.clone()._rotate(i)},rotateAround:function(i,t){return this.clone()._rotateAround(i,t)},matMult:function(i){return this.clone()._matMult(i)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(i){return this.x===i.x&&this.y===i.y},dist:function(i){return Math.sqrt(this.distSqr(i))},distSqr:function(i){var t=i.x-this.x,r=i.y-this.y;return t*t+r*r},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(i){return Math.atan2(this.y-i.y,this.x-i.x)},angleWith:function(i){return this.angleWithSep(i.x,i.y)},angleWithSep:function(i,t){return Math.atan2(this.x*t-this.y*i,this.x*i+this.y*t)},_matMult:function(i){var t=i[2]*this.x+i[3]*this.y;return this.x=i[0]*this.x+i[1]*this.y,this.y=t,this},_add:function(i){return this.x+=i.x,this.y+=i.y,this},_sub:function(i){return this.x-=i.x,this.y-=i.y,this},_mult:function(i){return this.x*=i,this.y*=i,this},_div:function(i){return this.x/=i,this.y/=i,this},_multByPoint:function(i){return this.x*=i.x,this.y*=i.y,this},_divByPoint:function(i){return this.x/=i.x,this.y/=i.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var i=this.y;return this.y=this.x,this.x=-i,this},_rotate:function(i){var t=Math.cos(i),r=Math.sin(i),c=r*this.x+t*this.y;return this.x=t*this.x-r*this.y,this.y=c,this},_rotateAround:function(i,t){var r=Math.cos(i),c=Math.sin(i),f=t.y+c*(this.x-t.x)+r*(this.y-t.y);return this.x=t.x+r*(this.x-t.x)-c*(this.y-t.y),this.y=f,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},M.convert=function(i){return i instanceof M?i:Array.isArray(i)?new M(i[0],i[1]):i};var k=I(T),F=q;function q(i,t,r,c){this.cx=3*i,this.bx=3*(r-i)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*t,this.by=3*(c-t)-this.cy,this.ay=1-this.cy-this.by,this.p1x=i,this.p1y=t,this.p2x=r,this.p2y=c}q.prototype={sampleCurveX:function(i){return((this.ax*i+this.bx)*i+this.cx)*i},sampleCurveY:function(i){return((this.ay*i+this.by)*i+this.cy)*i},sampleCurveDerivativeX:function(i){return(3*this.ax*i+2*this.bx)*i+this.cx},solveCurveX:function(i,t){if(t===void 0&&(t=1e-6),i<0)return 0;if(i>1)return 1;for(var r=i,c=0;c<8;c++){var f=this.sampleCurveX(r)-i;if(Math.abs(f)<t)return r;var g=this.sampleCurveDerivativeX(r);if(Math.abs(g)<1e-6)break;r-=f/g}var y=0,b=1;for(r=i,c=0;c<20&&(f=this.sampleCurveX(r),!(Math.abs(f-i)<t));c++)i>f?y=r:b=r,r=.5*(b-y)+y;return r},solve:function(i,t){return this.sampleCurveY(this.solveCurveX(i,t))}};var X=I(F);function re(i,t,r,c){const f=new X(i,t,r,c);return function(g){return f.solve(g)}}const me=re(.25,.1,.25,1);function ye(i,t,r){return Math.min(r,Math.max(t,i))}function Ee(i,t,r){const c=r-t,f=((i-t)%c+c)%c+t;return f===t?r:f}function be(i,...t){for(const r of t)for(const c in r)i[c]=r[c];return i}let Oe=1;function Qe(i,t){i.forEach(r=>{t[r]&&(t[r]=t[r].bind(t))})}function Ue(i,t,r){const c={};for(const f in i)c[f]=t.call(r||this,i[f],f,i);return c}function ze(i,t,r){const c={};for(const f in i)t.call(r||this,i[f],f,i)&&(c[f]=i[f]);return c}function j(i){return Array.isArray(i)?i.map(j):typeof i=="object"&&i?Ue(i,j):i}const G={};function pe(i){G[i]||(typeof console<"u"&&console.warn(i),G[i]=!0)}function Se(i,t,r){return(r.y-i.y)*(t.x-i.x)>(t.y-i.y)*(r.x-i.x)}function Ce(i){let t=0;for(let r,c,f=0,g=i.length,y=g-1;f<g;y=f++)r=i[f],c=i[y],t+=(c.x-r.x)*(r.y+c.y);return t}function _e(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}let Fe=null;function ut(i){if(Fe==null){const t=i.navigator?i.navigator.userAgent:null;Fe=!!i.safari||!(!t||!(/\b(iPad|iPhone|iPod)\b/.test(t)||t.match("Safari")&&!t.match("Chrome")))}return Fe}function at(i){return typeof ImageBitmap<"u"&&i instanceof ImageBitmap}const je="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let Ve,Ge;const Tt={now:typeof performance<"u"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),frame(i){const t=requestAnimationFrame(i);return{cancel:()=>cancelAnimationFrame(t)}},getImageData(i,t=0){return this.getImageCanvasContext(i).getImageData(-t,-t,i.width+2*t,i.height+2*t)},getImageCanvasContext(i){const t=window.document.createElement("canvas"),r=t.getContext("2d",{willReadFrequently:!0});if(!r)throw new Error("failed to create canvas 2d context");return t.width=i.width,t.height=i.height,r.drawImage(i,0,0,i.width,i.height),r},resolveURL:i=>(Ve||(Ve=document.createElement("a")),Ve.href=i,Ve.href),hardwareConcurrency:typeof navigator<"u"&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return!!matchMedia&&(Ge==null&&(Ge=matchMedia("(prefers-reduced-motion: reduce)")),Ge.matches)}},At={MAX_PARALLEL_IMAGE_REQUESTS:16,MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:8,MAX_TILE_CACHE_ZOOM_LEVELS:5,REGISTERED_PROTOCOLS:{},WORKER_URL:""};class rt extends Error{constructor(t,r,c,f){super(`AJAXError: ${r} (${t}): ${c}`),this.status=t,this.statusText=r,this.url=c,this.body=f}}const It=_e()?()=>self.worker&&self.worker.referrer:()=>(window.location.protocol==="blob:"?window.parent:window).location.href,Gt=i=>At.REGISTERED_PROTOCOLS[i.substring(0,i.indexOf("://"))];function Rt(i,t){const r=new AbortController,c=new Request(i.url,{method:i.method||"GET",body:i.body,credentials:i.credentials,headers:i.headers,referrer:It(),signal:r.signal});let f=!1,g=!1;return i.type==="json"&&c.headers.set("Accept","application/json"),g||fetch(c).then(y=>y.ok?(b=>{(i.type==="arrayBuffer"||i.type==="image"?b.arrayBuffer():i.type==="json"?b.json():b.text()).then(S=>{g||(f=!0,t(null,S,b.headers.get("Cache-Control"),b.headers.get("Expires")))}).catch(S=>{g||t(new Error(S.message))})})(y):y.blob().then(b=>t(new rt(y.status,y.statusText,i.url,b)))).catch(y=>{y.code!==20&&t(new Error(y.message))}),{cancel:()=>{g=!0,f||r.abort()}}}const Ne=function(i,t){if(/:\/\//.test(i.url)&&!/^https?:|^file:/.test(i.url)){if(_e()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",i,t);if(!_e())return(Gt(i.url)||Rt)(i,t)}if(!(/^file:/.test(r=i.url)||/^file:/.test(It())&&!/^\w+:/.test(r))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return Rt(i,t);if(_e()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",i,t,void 0,!0)}var r;return function(c,f){const g=new XMLHttpRequest;g.open(c.method||"GET",c.url,!0),c.type!=="arrayBuffer"&&c.type!=="image"||(g.responseType="arraybuffer");for(const y in c.headers)g.setRequestHeader(y,c.headers[y]);return c.type==="json"&&(g.responseType="text",g.setRequestHeader("Accept","application/json")),g.withCredentials=c.credentials==="include",g.onerror=()=>{f(new Error(g.statusText))},g.onload=()=>{if((g.status>=200&&g.status<300||g.status===0)&&g.response!==null){let y=g.response;if(c.type==="json")try{y=JSON.parse(g.response)}catch(b){return f(b)}f(null,y,g.getResponseHeader("Cache-Control"),g.getResponseHeader("Expires"))}else{const y=new Blob([g.response],{type:g.getResponseHeader("Content-Type")});f(new rt(g.status,g.statusText,c.url,y))}},g.send(c.body),{cancel:()=>g.abort()}}(i,t)},Ae=function(i,t){return Ne(be(i,{type:"arrayBuffer"}),t)};function tt(i){if(!i||i.indexOf("://")<=0||i.indexOf("data:image/")===0||i.indexOf("blob:")===0)return!0;const t=new URL(i),r=window.location;return t.protocol===r.protocol&&t.host===r.host}function Le(i,t,r){r[i]&&r[i].indexOf(t)!==-1||(r[i]=r[i]||[],r[i].push(t))}function He(i,t,r){if(r&&r[i]){const c=r[i].indexOf(t);c!==-1&&r[i].splice(c,1)}}class wt{constructor(t,r={}){be(this,r),this.type=t}}class K extends wt{constructor(t,r={}){super("error",be({error:t},r))}}class ne{on(t,r){return this._listeners=this._listeners||{},Le(t,r,this._listeners),this}off(t,r){return He(t,r,this._listeners),He(t,r,this._oneTimeListeners),this}once(t,r){return r?(this._oneTimeListeners=this._oneTimeListeners||{},Le(t,r,this._oneTimeListeners),this):new Promise(c=>this.once(t,c))}fire(t,r){typeof t=="string"&&(t=new wt(t,r||{}));const c=t.type;if(this.listens(c)){t.target=this;const f=this._listeners&&this._listeners[c]?this._listeners[c].slice():[];for(const b of f)b.call(this,t);const g=this._oneTimeListeners&&this._oneTimeListeners[c]?this._oneTimeListeners[c].slice():[];for(const b of g)He(c,b,this._oneTimeListeners),b.call(this,t);const y=this._eventedParent;y&&(be(t,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),y.fire(t))}else t instanceof K&&console.error(t.error);return this}listens(t){return this._listeners&&this._listeners[t]&&this._listeners[t].length>0||this._oneTimeListeners&&this._oneTimeListeners[t]&&this._oneTimeListeners[t].length>0||this._eventedParent&&this._eventedParent.listens(t)}setEventedParent(t,r){return this._eventedParent=t,this._eventedParentData=r,this}}var Z={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{}},default:"mapbox"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};const ke=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function Be(i,t){const r={};for(const c in i)c!=="ref"&&(r[c]=i[c]);return ke.forEach(c=>{c in t&&(r[c]=t[c])}),r}function Re(i,t){if(Array.isArray(i)){if(!Array.isArray(t)||i.length!==t.length)return!1;for(let r=0;r<i.length;r++)if(!Re(i[r],t[r]))return!1;return!0}if(typeof i=="object"&&i!==null&&t!==null){if(typeof t!="object"||Object.keys(i).length!==Object.keys(t).length)return!1;for(const r in i)if(!Re(i[r],t[r]))return!1;return!0}return i===t}const Ze={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight"};function ot(i,t,r){r.push({command:Ze.addSource,args:[i,t[i]]})}function ht(i,t,r){t.push({command:Ze.removeSource,args:[i]}),r[i]=!0}function Je(i,t,r,c){ht(i,r,c),ot(i,t,r)}function lt(i,t,r){let c;for(c in i[r])if(Object.prototype.hasOwnProperty.call(i[r],c)&&c!=="data"&&!Re(i[r][c],t[r][c]))return!1;for(c in t[r])if(Object.prototype.hasOwnProperty.call(t[r],c)&&c!=="data"&&!Re(i[r][c],t[r][c]))return!1;return!0}function ft(i,t,r,c,f,g){let y;for(y in t=t||{},i=i||{})Object.prototype.hasOwnProperty.call(i,y)&&(Re(i[y],t[y])||r.push({command:g,args:[c,y,t[y],f]}));for(y in t)Object.prototype.hasOwnProperty.call(t,y)&&!Object.prototype.hasOwnProperty.call(i,y)&&(Re(i[y],t[y])||r.push({command:g,args:[c,y,t[y],f]}))}function Mt(i){return i.id}function xt(i,t){return i[t.id]=t,i}class $e{constructor(t,r,c,f){this.message=(t?`${t}: `:"")+c,f&&(this.identifier=f),r!=null&&r.__line__&&(this.line=r.__line__)}}function en(i,...t){for(const r of t)for(const c in r)i[c]=r[c];return i}class Wt extends Error{constructor(t,r){super(r),this.message=r,this.key=t}}class hn{constructor(t,r=[]){this.parent=t,this.bindings={};for(const[c,f]of r)this.bindings[c]=f}concat(t){return new hn(this,t)}get(t){if(this.bindings[t])return this.bindings[t];if(this.parent)return this.parent.get(t);throw new Error(`${t} not found in scope.`)}has(t){return!!this.bindings[t]||!!this.parent&&this.parent.has(t)}}const Mn={kind:"null"},nt={kind:"number"},$t={kind:"string"},Nt={kind:"boolean"},kn={kind:"color"},dn={kind:"object"},Lt={kind:"value"},yr={kind:"collator"},rs={kind:"formatted"},kr={kind:"padding"},ss={kind:"resolvedImage"};function Ti(i,t){return{kind:"array",itemType:i,N:t}}function Rn(i){if(i.kind==="array"){const t=Rn(i.itemType);return typeof i.N=="number"?`array<${t}, ${i.N}>`:i.itemType.kind==="value"?"array":`array<${t}>`}return i.kind}const Uo=[Mn,nt,$t,Nt,kn,rs,dn,Ti(Lt),kr,ss];function jr(i,t){if(t.kind==="error")return null;if(i.kind==="array"){if(t.kind==="array"&&(t.N===0&&t.itemType.kind==="value"||!jr(i.itemType,t.itemType))&&(typeof i.N!="number"||i.N===t.N))return null}else{if(i.kind===t.kind)return null;if(i.kind==="value"){for(const r of Uo)if(!jr(r,t))return null}}return`Expected ${Rn(i)} but found ${Rn(t)} instead.`}function te(i,t){return t.some(r=>r.kind===i.kind)}function B(i,t){return t.some(r=>r==="null"?i===null:r==="array"?Array.isArray(i):r==="object"?i&&!Array.isArray(i)&&typeof i=="object":r===typeof i)}function V(i,t){return i.kind==="array"&&t.kind==="array"?i.itemType.kind===t.itemType.kind&&typeof i.N=="number":i.kind===t.kind}const W=.96422,oe=.82521,le=4/29,ge=6/29,he=3*ge*ge,ce=ge*ge*ge,xe=Math.PI/180,We=180/Math.PI;function Ke(i){return(i%=360)<0&&(i+=360),i}function Xe([i,t,r,c]){let f,g;const y=Yt((.2225045*(i=Ut(i))+.7168786*(t=Ut(t))+.0606169*(r=Ut(r)))/1);i===t&&t===r?f=g=y:(f=Yt((.4360747*i+.3850649*t+.1430804*r)/W),g=Yt((.0139322*i+.0971045*t+.7141733*r)/oe));const b=116*y-16;return[b<0?0:b,500*(f-y),200*(y-g),c]}function Ut(i){return i<=.04045?i/12.92:Math.pow((i+.055)/1.055,2.4)}function Yt(i){return i>ce?Math.pow(i,1/3):i/he+le}function Pt([i,t,r,c]){let f=(i+16)/116,g=isNaN(t)?f:f+t/500,y=isNaN(r)?f:f-r/200;return f=1*Xt(f),g=W*Xt(g),y=oe*Xt(y),[Ft(3.1338561*g-1.6168667*f-.4906146*y),Ft(-.9787684*g+1.9161415*f+.033454*y),Ft(.0719453*g-.2289914*f+1.4052427*y),c]}function Ft(i){return(i=i<=.00304?12.92*i:1.055*Math.pow(i,1/2.4)-.055)<0?0:i>1?1:i}function Xt(i){return i>ge?i*i*i:he*(i-le)}function un(i){return parseInt(i.padEnd(2,i),16)/255}function nn(i,t){return gn(t?i/100:i,0,1)}function gn(i,t,r){return Math.min(Math.max(t,i),r)}function zn(i){return!i.some(Number.isNaN)}const ai={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};class Ht{constructor(t,r,c,f=1,g=!0){this.r=t,this.g=r,this.b=c,this.a=f,g||(this.r*=f,this.g*=f,this.b*=f,f||this.overwriteGetter("rgb",[t,r,c,f]))}static parse(t){if(t instanceof Ht)return t;if(typeof t!="string")return;const r=function(c){if((c=c.toLowerCase())==="transparent")return[0,0,0,0];const f=ai[c];if(f){const[y,b,S]=f;return[y/255,b/255,S/255,1]}if(c.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(c)){const y=c.length<6?1:2;let b=1;return[un(c.slice(b,b+=y)),un(c.slice(b,b+=y)),un(c.slice(b,b+=y)),un(c.slice(b,b+y)||"ff")]}if(c.startsWith("rgb")){const y=c.match(/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(y){const[b,S,P,D,R,O,$,N,ee,J,fe,ve]=y,ue=[D||" ",$||" ",J].join("");if(ue==="  "||ue==="  /"||ue===",,"||ue===",,,"){const Ie=[P,O,ee].join(""),Me=Ie==="%%%"?100:Ie===""?255:0;if(Me){const qe=[gn(+S/Me,0,1),gn(+R/Me,0,1),gn(+N/Me,0,1),fe?nn(+fe,ve):1];if(zn(qe))return qe}}return}}const g=c.match(/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(g){const[y,b,S,P,D,R,O,$,N]=g,ee=[S||" ",D||" ",O].join("");if(ee==="  "||ee==="  /"||ee===",,"||ee===",,,"){const J=[+b,gn(+P,0,100),gn(+R,0,100),$?nn(+$,N):1];if(zn(J))return function([fe,ve,ue,Ie]){function Me(qe){const Ct=(qe+fe/30)%12,kt=ve*Math.min(ue,1-ue);return ue-kt*Math.max(-1,Math.min(Ct-3,9-Ct,1))}return fe=Ke(fe),ve/=100,ue/=100,[Me(0),Me(8),Me(4),Ie]}(J)}}}(t);return r?new Ht(...r,!1):void 0}get rgb(){const{r:t,g:r,b:c,a:f}=this,g=f||1/0;return this.overwriteGetter("rgb",[t/g,r/g,c/g,f])}get hcl(){return this.overwriteGetter("hcl",function(t){const[r,c,f,g]=Xe(t),y=Math.sqrt(c*c+f*f);return[Math.round(1e4*y)?Ke(Math.atan2(f,c)*We):NaN,y,r,g]}(this.rgb))}get lab(){return this.overwriteGetter("lab",Xe(this.rgb))}overwriteGetter(t,r){return Object.defineProperty(this,t,{value:r}),r}toString(){const[t,r,c,f]=this.rgb;return`rgba(${[t,r,c].map(g=>Math.round(255*g)).join(",")},${f})`}}Ht.black=new Ht(0,0,0,1),Ht.white=new Ht(1,1,1,1),Ht.transparent=new Ht(0,0,0,0),Ht.red=new Ht(1,0,0,1);class Xn{constructor(t,r,c){this.sensitivity=t?r?"variant":"case":r?"accent":"base",this.locale=c,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(t,r){return this.collator.compare(t,r)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class bs{constructor(t,r,c,f,g){this.text=t,this.image=r,this.scale=c,this.fontStack=f,this.textColor=g}}class Ii{constructor(t){this.sections=t}static fromString(t){return new Ii([new bs(t,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(t=>t.text.length!==0||t.image&&t.image.name.length!==0)}static factory(t){return t instanceof Ii?t:Ii.fromString(t)}toString(){return this.sections.length===0?"":this.sections.map(t=>t.text).join("")}}class tr{constructor(t){this.values=t.slice()}static parse(t){if(t instanceof tr)return t;if(typeof t=="number")return new tr([t,t,t,t]);if(Array.isArray(t)&&!(t.length<1||t.length>4)){for(const r of t)if(typeof r!="number")return;switch(t.length){case 1:t=[t[0],t[0],t[0],t[0]];break;case 2:t=[t[0],t[1],t[0],t[1]];break;case 3:t=[t[0],t[1],t[2],t[1]]}return new tr(t)}}toString(){return JSON.stringify(this.values)}}class _r{constructor(t){this.name=t.name,this.available=t.available}toString(){return this.name}static fromString(t){return t?new _r({name:t,available:!1}):null}}function ao(i,t,r,c){return typeof i=="number"&&i>=0&&i<=255&&typeof t=="number"&&t>=0&&t<=255&&typeof r=="number"&&r>=0&&r<=255?c===void 0||typeof c=="number"&&c>=0&&c<=1?null:`Invalid rgba value [${[i,t,r,c].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof c=="number"?[i,t,r,c]:[i,t,r]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function Ia(i){if(i===null||typeof i=="string"||typeof i=="boolean"||typeof i=="number"||i instanceof Ht||i instanceof Xn||i instanceof Ii||i instanceof tr||i instanceof _r)return!0;if(Array.isArray(i)){for(const t of i)if(!Ia(t))return!1;return!0}if(typeof i=="object"){for(const t in i)if(!Ia(i[t]))return!1;return!0}return!1}function li(i){if(i===null)return Mn;if(typeof i=="string")return $t;if(typeof i=="boolean")return Nt;if(typeof i=="number")return nt;if(i instanceof Ht)return kn;if(i instanceof Xn)return yr;if(i instanceof Ii)return rs;if(i instanceof tr)return kr;if(i instanceof _r)return ss;if(Array.isArray(i)){const t=i.length;let r;for(const c of i){const f=li(c);if(r){if(r===f)continue;r=Lt;break}r=f}return Ti(r||Lt,t)}return dn}function No(i){const t=typeof i;return i===null?"":t==="string"||t==="number"||t==="boolean"?String(i):i instanceof Ht||i instanceof Ii||i instanceof tr||i instanceof _r?i.toString():JSON.stringify(i)}class ws{constructor(t,r){this.type=t,this.value=r}static parse(t,r){if(t.length!==2)return r.error(`'literal' expression requires exactly one argument, but found ${t.length-1} instead.`);if(!Ia(t[1]))return r.error("invalid value");const c=t[1];let f=li(c);const g=r.expectedType;return f.kind!=="array"||f.N!==0||!g||g.kind!=="array"||typeof g.N=="number"&&g.N!==0||(f=g),new ws(f,c)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}class ti{constructor(t){this.name="ExpressionEvaluationError",this.message=t}toJSON(){return this.message}}const Aa={string:$t,number:nt,boolean:Nt,object:dn};class Mr{constructor(t,r){this.type=t,this.args=r}static parse(t,r){if(t.length<2)return r.error("Expected at least one argument.");let c,f=1;const g=t[0];if(g==="array"){let b,S;if(t.length>2){const P=t[1];if(typeof P!="string"||!(P in Aa)||P==="object")return r.error('The item type argument of "array" must be one of string, number, boolean',1);b=Aa[P],f++}else b=Lt;if(t.length>3){if(t[2]!==null&&(typeof t[2]!="number"||t[2]<0||t[2]!==Math.floor(t[2])))return r.error('The length argument to "array" must be a positive integer literal',2);S=t[2],f++}c=Ti(b,S)}else{if(!Aa[g])throw new Error(`Types doesn't contain name = ${g}`);c=Aa[g]}const y=[];for(;f<t.length;f++){const b=r.parse(t[f],f,Lt);if(!b)return null;y.push(b)}return new Mr(c,y)}evaluate(t){for(let r=0;r<this.args.length;r++){const c=this.args[r].evaluate(t);if(!jr(this.type,li(c)))return c;if(r===this.args.length-1)throw new ti(`Expected value to be of type ${Rn(this.type)}, but found ${Rn(li(c))} instead.`)}throw new Error}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}}const Uu={"to-boolean":Nt,"to-color":kn,"to-number":nt,"to-string":$t};class Ai{constructor(t,r){this.type=t,this.args=r}static parse(t,r){if(t.length<2)return r.error("Expected at least one argument.");const c=t[0];if(!Uu[c])throw new Error(`Can't parse ${c} as it is not part of the known types`);if((c==="to-boolean"||c==="to-string")&&t.length!==2)return r.error("Expected one argument.");const f=Uu[c],g=[];for(let y=1;y<t.length;y++){const b=r.parse(t[y],y,Lt);if(!b)return null;g.push(b)}return new Ai(f,g)}evaluate(t){if(this.type.kind==="boolean")return!!this.args[0].evaluate(t);if(this.type.kind==="color"){let r,c;for(const f of this.args){if(r=f.evaluate(t),c=null,r instanceof Ht)return r;if(typeof r=="string"){const g=t.parseColor(r);if(g)return g}else if(Array.isArray(r)&&(c=r.length<3||r.length>4?`Invalid rbga value ${JSON.stringify(r)}: expected an array containing either three or four numeric values.`:ao(r[0],r[1],r[2],r[3]),!c))return new Ht(r[0]/255,r[1]/255,r[2]/255,r[3])}throw new ti(c||`Could not parse color from value '${typeof r=="string"?r:JSON.stringify(r)}'`)}if(this.type.kind==="padding"){let r;for(const c of this.args){r=c.evaluate(t);const f=tr.parse(r);if(f)return f}throw new ti(`Could not parse padding from value '${typeof r=="string"?r:JSON.stringify(r)}'`)}if(this.type.kind==="number"){let r=null;for(const c of this.args){if(r=c.evaluate(t),r===null)return 0;const f=Number(r);if(!isNaN(f))return f}throw new ti(`Could not convert ${JSON.stringify(r)} to number.`)}return this.type.kind==="formatted"?Ii.fromString(No(this.args[0].evaluate(t))):this.type.kind==="resolvedImage"?_r.fromString(No(this.args[0].evaluate(t))):No(this.args[0].evaluate(t))}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}}const Jl=["Unknown","Point","LineString","Polygon"];class Pa{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?Jl[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(t){let r=this._parseColorCache[t];return r||(r=this._parseColorCache[t]=Ht.parse(t)),r}}class Ss{constructor(t,r,c=[],f,g=new hn,y=[]){this.registry=t,this.path=c,this.key=c.map(b=>`[${b}]`).join(""),this.scope=g,this.errors=y,this.expectedType=f,this._isConstant=r}parse(t,r,c,f,g={}){return r?this.concat(r,c,f)._parse(t,g):this._parse(t,g)}_parse(t,r){function c(f,g,y){return y==="assert"?new Mr(g,[f]):y==="coerce"?new Ai(g,[f]):f}if(t!==null&&typeof t!="string"&&typeof t!="boolean"&&typeof t!="number"||(t=["literal",t]),Array.isArray(t)){if(t.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const f=t[0];if(typeof f!="string")return this.error(`Expression name must be a string, but found ${typeof f} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const g=this.registry[f];if(g){let y=g.parse(t,this);if(!y)return null;if(this.expectedType){const b=this.expectedType,S=y.type;if(b.kind!=="string"&&b.kind!=="number"&&b.kind!=="boolean"&&b.kind!=="object"&&b.kind!=="array"||S.kind!=="value")if(b.kind!=="color"&&b.kind!=="formatted"&&b.kind!=="resolvedImage"||S.kind!=="value"&&S.kind!=="string")if(b.kind!=="padding"||S.kind!=="value"&&S.kind!=="number"&&S.kind!=="array"){if(this.checkSubtype(b,S))return null}else y=c(y,b,r.typeAnnotation||"coerce");else y=c(y,b,r.typeAnnotation||"coerce");else y=c(y,b,r.typeAnnotation||"assert")}if(!(y instanceof ws)&&y.type.kind!=="resolvedImage"&&this._isConstant(y)){const b=new Pa;try{y=new ws(y.type,y.evaluate(b))}catch(S){return this.error(S.message),null}}return y}return this.error(`Unknown expression "${f}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(t===void 0?"'undefined' value invalid. Use null instead.":typeof t=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof t} instead.`)}concat(t,r,c){const f=typeof t=="number"?this.path.concat(t):this.path,g=c?this.scope.concat(c):this.scope;return new Ss(this.registry,this._isConstant,f,r||null,g,this.errors)}error(t,...r){const c=`${this.key}${r.map(f=>`[${f}]`).join("")}`;this.errors.push(new Wt(c,t))}checkSubtype(t,r){const c=jr(t,r);return c&&this.error(c),c}}class En{constructor(t,r,c){this.type=yr,this.locale=c,this.caseSensitive=t,this.diacriticSensitive=r}static parse(t,r){if(t.length!==2)return r.error("Expected one argument.");const c=t[1];if(typeof c!="object"||Array.isArray(c))return r.error("Collator options argument must be an object.");const f=r.parse(c["case-sensitive"]!==void 0&&c["case-sensitive"],1,Nt);if(!f)return null;const g=r.parse(c["diacritic-sensitive"]!==void 0&&c["diacritic-sensitive"],1,Nt);if(!g)return null;let y=null;return c.locale&&(y=r.parse(c.locale,1,$t),!y)?null:new En(f,g,y)}evaluate(t){return new Xn(this.caseSensitive.evaluate(t),this.diacriticSensitive.evaluate(t),this.locale?this.locale.evaluate(t):null)}eachChild(t){t(this.caseSensitive),t(this.diacriticSensitive),this.locale&&t(this.locale)}outputDefined(){return!1}}const Cs=8192;function jo(i,t){i[0]=Math.min(i[0],t[0]),i[1]=Math.min(i[1],t[1]),i[2]=Math.max(i[2],t[0]),i[3]=Math.max(i[3],t[1])}function ka(i,t){return!(i[0]<=t[0]||i[2]>=t[2]||i[1]<=t[1]||i[3]>=t[3])}function Nu(i,t){const r=(180+i[0])/360,c=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+i[1]*Math.PI/360)))/360,f=Math.pow(2,t.z);return[Math.round(r*f*Cs),Math.round(c*f*Cs)]}function ju(i,t,r){const c=i[0]-t[0],f=i[1]-t[1],g=i[0]-r[0],y=i[1]-r[1];return c*y-g*f==0&&c*g<=0&&f*y<=0}function Ql(i,t){let r=!1;for(let y=0,b=t.length;y<b;y++){const S=t[y];for(let P=0,D=S.length;P<D-1;P++){if(ju(i,S[P],S[P+1]))return!1;(f=S[P])[1]>(c=i)[1]!=(g=S[P+1])[1]>c[1]&&c[0]<(g[0]-f[0])*(c[1]-f[1])/(g[1]-f[1])+f[0]&&(r=!r)}}var c,f,g;return r}function qu(i,t){for(let r=0;r<t.length;r++)if(Ql(i,t[r]))return!0;return!1}function ec(i,t,r,c){const f=c[0]-r[0],g=c[1]-r[1],y=(i[0]-r[0])*g-f*(i[1]-r[1]),b=(t[0]-r[0])*g-f*(t[1]-r[1]);return y>0&&b<0||y<0&&b>0}function rf(i,t,r){for(const P of r)for(let D=0;D<P.length-1;++D)if((b=[(y=P[D+1])[0]-(g=P[D])[0],y[1]-g[1]])[0]*(S=[(f=t)[0]-(c=i)[0],f[1]-c[1]])[1]-b[1]*S[0]!=0&&ec(c,f,g,y)&&ec(g,y,c,f))return!0;var c,f,g,y,b,S;return!1}function Zu(i,t){for(let r=0;r<i.length;++r)if(!Ql(i[r],t))return!1;for(let r=0;r<i.length-1;++r)if(rf(i[r],i[r+1],t))return!1;return!0}function sf(i,t){for(let r=0;r<t.length;r++)if(Zu(i,t[r]))return!0;return!1}function tc(i,t,r){const c=[];for(let f=0;f<i.length;f++){const g=[];for(let y=0;y<i[f].length;y++){const b=Nu(i[f][y],r);jo(t,b),g.push(b)}c.push(g)}return c}function nc(i,t,r){const c=[];for(let f=0;f<i.length;f++){const g=tc(i[f],t,r);c.push(g)}return c}function ic(i,t,r,c){if(i[0]<r[0]||i[0]>r[2]){const f=.5*c;let g=i[0]-r[0]>f?-c:r[0]-i[0]>f?c:0;g===0&&(g=i[0]-r[2]>f?-c:r[2]-i[0]>f?c:0),i[0]+=g}jo(t,i)}function Gu(i,t,r,c){const f=Math.pow(2,c.z)*Cs,g=[c.x*Cs,c.y*Cs],y=[];for(const b of i)for(const S of b){const P=[S.x+g[0],S.y+g[1]];ic(P,t,r,f),y.push(P)}return y}function Wu(i,t,r,c){const f=Math.pow(2,c.z)*Cs,g=[c.x*Cs,c.y*Cs],y=[];for(const S of i){const P=[];for(const D of S){const R=[D.x+g[0],D.y+g[1]];jo(t,R),P.push(R)}y.push(P)}if(t[2]-t[0]<=f/2){(b=t)[0]=b[1]=1/0,b[2]=b[3]=-1/0;for(const S of y)for(const P of S)ic(P,t,r,f)}var b;return y}class os{constructor(t,r){this.type=Nt,this.geojson=t,this.geometries=r}static parse(t,r){if(t.length!==2)return r.error(`'within' expression requires exactly one argument, but found ${t.length-1} instead.`);if(Ia(t[1])){const c=t[1];if(c.type==="FeatureCollection")for(let f=0;f<c.features.length;++f){const g=c.features[f].geometry.type;if(g==="Polygon"||g==="MultiPolygon")return new os(c,c.features[f].geometry)}else if(c.type==="Feature"){const f=c.geometry.type;if(f==="Polygon"||f==="MultiPolygon")return new os(c,c.geometry)}else if(c.type==="Polygon"||c.type==="MultiPolygon")return new os(c,c)}return r.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(t){if(t.geometry()!=null&&t.canonicalID()!=null){if(t.geometryType()==="Point")return function(r,c){const f=[1/0,1/0,-1/0,-1/0],g=[1/0,1/0,-1/0,-1/0],y=r.canonicalID();if(c.type==="Polygon"){const b=tc(c.coordinates,g,y),S=Gu(r.geometry(),f,g,y);if(!ka(f,g))return!1;for(const P of S)if(!Ql(P,b))return!1}if(c.type==="MultiPolygon"){const b=nc(c.coordinates,g,y),S=Gu(r.geometry(),f,g,y);if(!ka(f,g))return!1;for(const P of S)if(!qu(P,b))return!1}return!0}(t,this.geometries);if(t.geometryType()==="LineString")return function(r,c){const f=[1/0,1/0,-1/0,-1/0],g=[1/0,1/0,-1/0,-1/0],y=r.canonicalID();if(c.type==="Polygon"){const b=tc(c.coordinates,g,y),S=Wu(r.geometry(),f,g,y);if(!ka(f,g))return!1;for(const P of S)if(!Zu(P,b))return!1}if(c.type==="MultiPolygon"){const b=nc(c.coordinates,g,y),S=Wu(r.geometry(),f,g,y);if(!ka(f,g))return!1;for(const P of S)if(!sf(P,b))return!1}return!0}(t,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}class Ma{constructor(t,r){this.type=r.type,this.name=t,this.boundExpression=r}static parse(t,r){if(t.length!==2||typeof t[1]!="string")return r.error("'var' expression requires exactly one string literal argument.");const c=t[1];return r.scope.has(c)?new Ma(c,r.scope.get(c)):r.error(`Unknown variable "${c}". Make sure "${c}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(t){return this.boundExpression.evaluate(t)}eachChild(){}outputDefined(){return!1}}class vr{constructor(t,r,c,f){this.name=t,this.type=r,this._evaluate=c,this.args=f}evaluate(t){return this._evaluate(t,this.args)}eachChild(t){this.args.forEach(t)}outputDefined(){return!1}static parse(t,r){const c=t[0],f=vr.definitions[c];if(!f)return r.error(`Unknown expression "${c}". If you wanted a literal array, use ["literal", [...]].`,0);const g=Array.isArray(f)?f[0]:f.type,y=Array.isArray(f)?[[f[1],f[2]]]:f.overloads,b=y.filter(([P])=>!Array.isArray(P)||P.length===t.length-1);let S=null;for(const[P,D]of b){S=new Ss(r.registry,Da,r.path,null,r.scope);const R=[];let O=!1;for(let $=1;$<t.length;$++){const N=t[$],ee=Array.isArray(P)?P[$-1]:P.type,J=S.parse(N,1+R.length,ee);if(!J){O=!0;break}R.push(J)}if(!O)if(Array.isArray(P)&&P.length!==R.length)S.error(`Expected ${P.length} arguments, but found ${R.length} instead.`);else{for(let $=0;$<R.length;$++){const N=Array.isArray(P)?P[$]:P.type,ee=R[$];S.concat($+1).checkSubtype(N,ee.type)}if(S.errors.length===0)return new vr(c,g,D,R)}}if(b.length===1)r.errors.push(...S.errors);else{const P=(b.length?b:y).map(([R])=>{return O=R,Array.isArray(O)?`(${O.map(Rn).join(", ")})`:`(${Rn(O.type)}...)`;var O}).join(" | "),D=[];for(let R=1;R<t.length;R++){const O=r.parse(t[R],1+D.length);if(!O)return null;D.push(Rn(O.type))}r.error(`Expected arguments of type ${P}, but found (${D.join(", ")}) instead.`)}return null}static register(t,r){vr.definitions=r;for(const c in r)t[c]=vr}}function Da(i){if(i instanceof Ma)return Da(i.boundExpression);if(i instanceof vr&&i.name==="error"||i instanceof En||i instanceof os)return!1;const t=i instanceof Ai||i instanceof Mr;let r=!0;return i.eachChild(c=>{r=t?r&&Da(c):r&&c instanceof ws}),!!r&&qo(i)&&za(i,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}function qo(i){if(i instanceof vr&&(i.name==="get"&&i.args.length===1||i.name==="feature-state"||i.name==="has"&&i.args.length===1||i.name==="properties"||i.name==="geometry-type"||i.name==="id"||/^filter-/.test(i.name))||i instanceof os)return!1;let t=!0;return i.eachChild(r=>{t&&!qo(r)&&(t=!1)}),t}function lo(i){if(i instanceof vr&&i.name==="feature-state")return!1;let t=!0;return i.eachChild(r=>{t&&!lo(r)&&(t=!1)}),t}function za(i,t){if(i instanceof vr&&t.indexOf(i.name)>=0)return!1;let r=!0;return i.eachChild(c=>{r&&!za(c,t)&&(r=!1)}),r}function La(i,t){const r=i.length-1;let c,f,g=0,y=r,b=0;for(;g<=y;)if(b=Math.floor((g+y)/2),c=i[b],f=i[b+1],c<=t){if(b===r||t<f)return b;g=b+1}else{if(!(c>t))throw new ti("Input is not a number.");y=b-1}return 0}class co{constructor(t,r,c){this.type=t,this.input=r,this.labels=[],this.outputs=[];for(const[f,g]of c)this.labels.push(f),this.outputs.push(g)}static parse(t,r){if(t.length-1<4)return r.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if((t.length-1)%2!=0)return r.error("Expected an even number of arguments.");const c=r.parse(t[1],1,nt);if(!c)return null;const f=[];let g=null;r.expectedType&&r.expectedType.kind!=="value"&&(g=r.expectedType);for(let y=1;y<t.length;y+=2){const b=y===1?-1/0:t[y],S=t[y+1],P=y,D=y+1;if(typeof b!="number")return r.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',P);if(f.length&&f[f.length-1][0]>=b)return r.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',P);const R=r.parse(S,D,g);if(!R)return null;g=g||R.type,f.push([b,R])}return new co(g,c,f)}evaluate(t){const r=this.labels,c=this.outputs;if(r.length===1)return c[0].evaluate(t);const f=this.input.evaluate(t);if(f<=r[0])return c[0].evaluate(t);const g=r.length;return f>=r[g-1]?c[g-1].evaluate(t):c[La(r,f)].evaluate(t)}eachChild(t){t(this.input);for(const r of this.outputs)t(r)}outputDefined(){return this.outputs.every(t=>t.outputDefined())}}function uo(i,t,r){return i+r*(t-i)}function Ra(i,t,r){return i.map((c,f)=>uo(c,t[f],r))}const nr={number:uo,color:function(i,t,r,c="rgb"){switch(c){case"rgb":{const[f,g,y,b]=Ra(i.rgb,t.rgb,r);return new Ht(f,g,y,b,!1)}case"hcl":{const[f,g,y,b]=i.hcl,[S,P,D,R]=t.hcl;let O,$;if(isNaN(f)||isNaN(S))isNaN(f)?isNaN(S)?O=NaN:(O=S,y!==1&&y!==0||($=P)):(O=f,D!==1&&D!==0||($=g));else{let ve=S-f;S>f&&ve>180?ve-=360:S<f&&f-S>180&&(ve+=360),O=f+r*ve}const[N,ee,J,fe]=function([ve,ue,Ie,Me]){return ve=isNaN(ve)?0:ve*xe,Pt([Ie,Math.cos(ve)*ue,Math.sin(ve)*ue,Me])}([O,$??uo(g,P,r),uo(y,D,r),uo(b,R,r)]);return new Ht(N,ee,J,fe,!1)}case"lab":{const[f,g,y,b]=Pt(Ra(i.lab,t.lab,r));return new Ht(f,g,y,b,!1)}}},array:Ra,padding:function(i,t,r){return new tr(Ra(i.values,t.values,r))}};class ir{constructor(t,r,c,f,g){this.type=t,this.operator=r,this.interpolation=c,this.input=f,this.labels=[],this.outputs=[];for(const[y,b]of g)this.labels.push(y),this.outputs.push(b)}static interpolationFactor(t,r,c,f){let g=0;if(t.name==="exponential")g=rc(r,t.base,c,f);else if(t.name==="linear")g=rc(r,1,c,f);else if(t.name==="cubic-bezier"){const y=t.controlPoints;g=new X(y[0],y[1],y[2],y[3]).solve(rc(r,1,c,f))}return g}static parse(t,r){let[c,f,g,...y]=t;if(!Array.isArray(f)||f.length===0)return r.error("Expected an interpolation type expression.",1);if(f[0]==="linear")f={name:"linear"};else if(f[0]==="exponential"){const P=f[1];if(typeof P!="number")return r.error("Exponential interpolation requires a numeric base.",1,1);f={name:"exponential",base:P}}else{if(f[0]!=="cubic-bezier")return r.error(`Unknown interpolation type ${String(f[0])}`,1,0);{const P=f.slice(1);if(P.length!==4||P.some(D=>typeof D!="number"||D<0||D>1))return r.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);f={name:"cubic-bezier",controlPoints:P}}}if(t.length-1<4)return r.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if((t.length-1)%2!=0)return r.error("Expected an even number of arguments.");if(g=r.parse(g,2,nt),!g)return null;const b=[];let S=null;c==="interpolate-hcl"||c==="interpolate-lab"?S=kn:r.expectedType&&r.expectedType.kind!=="value"&&(S=r.expectedType);for(let P=0;P<y.length;P+=2){const D=y[P],R=y[P+1],O=P+3,$=P+4;if(typeof D!="number")return r.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',O);if(b.length&&b[b.length-1][0]>=D)return r.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',O);const N=r.parse(R,$,S);if(!N)return null;S=S||N.type,b.push([D,N])}return V(S,nt)||V(S,kn)||V(S,kr)||V(S,Ti(nt))?new ir(S,c,f,g,b):r.error(`Type ${Rn(S)} is not interpolatable.`)}evaluate(t){const r=this.labels,c=this.outputs;if(r.length===1)return c[0].evaluate(t);const f=this.input.evaluate(t);if(f<=r[0])return c[0].evaluate(t);const g=r.length;if(f>=r[g-1])return c[g-1].evaluate(t);const y=La(r,f),b=ir.interpolationFactor(this.interpolation,f,r[y],r[y+1]),S=c[y].evaluate(t),P=c[y+1].evaluate(t);switch(this.operator){case"interpolate":return nr[this.type.kind](S,P,b);case"interpolate-hcl":return nr.color(S,P,b,"hcl");case"interpolate-lab":return nr.color(S,P,b,"lab")}}eachChild(t){t(this.input);for(const r of this.outputs)t(r)}outputDefined(){return this.outputs.every(t=>t.outputDefined())}}function rc(i,t,r,c){const f=c-r,g=i-r;return f===0?0:t===1?g/f:(Math.pow(t,g)-1)/(Math.pow(t,f)-1)}class Ba{constructor(t,r){this.type=t,this.args=r}static parse(t,r){if(t.length<2)return r.error("Expectected at least one argument.");let c=null;const f=r.expectedType;f&&f.kind!=="value"&&(c=f);const g=[];for(const b of t.slice(1)){const S=r.parse(b,1+g.length,c,void 0,{typeAnnotation:"omit"});if(!S)return null;c=c||S.type,g.push(S)}if(!c)throw new Error("No output type");const y=f&&g.some(b=>jr(f,b.type));return new Ba(y?Lt:c,g)}evaluate(t){let r,c=null,f=0;for(const g of this.args)if(f++,c=g.evaluate(t),c&&c instanceof _r&&!c.available&&(r||(r=c.name),c=null,f===this.args.length&&(c=r)),c!==null)break;return c}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}}class Fa{constructor(t,r){this.type=r.type,this.bindings=[].concat(t),this.result=r}evaluate(t){return this.result.evaluate(t)}eachChild(t){for(const r of this.bindings)t(r[1]);t(this.result)}static parse(t,r){if(t.length<4)return r.error(`Expected at least 3 arguments, but found ${t.length-1} instead.`);const c=[];for(let g=1;g<t.length-1;g+=2){const y=t[g];if(typeof y!="string")return r.error(`Expected string, but found ${typeof y} instead.`,g);if(/[^a-zA-Z0-9_]/.test(y))return r.error("Variable names must contain only alphanumeric characters or '_'.",g);const b=r.parse(t[g+1],g+1);if(!b)return null;c.push([y,b])}const f=r.parse(t[t.length-1],t.length-1,r.expectedType,c);return f?new Fa(c,f):null}outputDefined(){return this.result.outputDefined()}}class sc{constructor(t,r,c){this.type=t,this.index=r,this.input=c}static parse(t,r){if(t.length!==3)return r.error(`Expected 2 arguments, but found ${t.length-1} instead.`);const c=r.parse(t[1],1,nt),f=r.parse(t[2],2,Ti(r.expectedType||Lt));return c&&f?new sc(f.type.itemType,c,f):null}evaluate(t){const r=this.index.evaluate(t),c=this.input.evaluate(t);if(r<0)throw new ti(`Array index out of bounds: ${r} < 0.`);if(r>=c.length)throw new ti(`Array index out of bounds: ${r} > ${c.length-1}.`);if(r!==Math.floor(r))throw new ti(`Array index must be an integer, but found ${r} instead.`);return c[r]}eachChild(t){t(this.index),t(this.input)}outputDefined(){return!1}}class Zo{constructor(t,r){this.type=Nt,this.needle=t,this.haystack=r}static parse(t,r){if(t.length!==3)return r.error(`Expected 2 arguments, but found ${t.length-1} instead.`);const c=r.parse(t[1],1,Lt),f=r.parse(t[2],2,Lt);return c&&f?te(c.type,[Nt,$t,nt,Mn,Lt])?new Zo(c,f):r.error(`Expected first argument to be of type boolean, string, number or null, but found ${Rn(c.type)} instead`):null}evaluate(t){const r=this.needle.evaluate(t),c=this.haystack.evaluate(t);if(!c)return!1;if(!B(r,["boolean","string","number","null"]))throw new ti(`Expected first argument to be of type boolean, string, number or null, but found ${Rn(li(r))} instead.`);if(!B(c,["string","array"]))throw new ti(`Expected second argument to be of type array or string, but found ${Rn(li(c))} instead.`);return c.indexOf(r)>=0}eachChild(t){t(this.needle),t(this.haystack)}outputDefined(){return!0}}class Vs{constructor(t,r,c){this.type=nt,this.needle=t,this.haystack=r,this.fromIndex=c}static parse(t,r){if(t.length<=2||t.length>=5)return r.error(`Expected 3 or 4 arguments, but found ${t.length-1} instead.`);const c=r.parse(t[1],1,Lt),f=r.parse(t[2],2,Lt);if(!c||!f)return null;if(!te(c.type,[Nt,$t,nt,Mn,Lt]))return r.error(`Expected first argument to be of type boolean, string, number or null, but found ${Rn(c.type)} instead`);if(t.length===4){const g=r.parse(t[3],3,nt);return g?new Vs(c,f,g):null}return new Vs(c,f)}evaluate(t){const r=this.needle.evaluate(t),c=this.haystack.evaluate(t);if(!B(r,["boolean","string","number","null"]))throw new ti(`Expected first argument to be of type boolean, string, number or null, but found ${Rn(li(r))} instead.`);if(!B(c,["string","array"]))throw new ti(`Expected second argument to be of type array or string, but found ${Rn(li(c))} instead.`);if(this.fromIndex){const f=this.fromIndex.evaluate(t);return c.indexOf(r,f)}return c.indexOf(r)}eachChild(t){t(this.needle),t(this.haystack),this.fromIndex&&t(this.fromIndex)}outputDefined(){return!1}}class yn{constructor(t,r,c,f,g,y){this.inputType=t,this.type=r,this.input=c,this.cases=f,this.outputs=g,this.otherwise=y}static parse(t,r){if(t.length<5)return r.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if(t.length%2!=1)return r.error("Expected an even number of arguments.");let c,f;r.expectedType&&r.expectedType.kind!=="value"&&(f=r.expectedType);const g={},y=[];for(let P=2;P<t.length-1;P+=2){let D=t[P];const R=t[P+1];Array.isArray(D)||(D=[D]);const O=r.concat(P);if(D.length===0)return O.error("Expected at least one branch label.");for(const N of D){if(typeof N!="number"&&typeof N!="string")return O.error("Branch labels must be numbers or strings.");if(typeof N=="number"&&Math.abs(N)>Number.MAX_SAFE_INTEGER)return O.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof N=="number"&&Math.floor(N)!==N)return O.error("Numeric branch labels must be integer values.");if(c){if(O.checkSubtype(c,li(N)))return null}else c=li(N);if(g[String(N)]!==void 0)return O.error("Branch labels must be unique.");g[String(N)]=y.length}const $=r.parse(R,P,f);if(!$)return null;f=f||$.type,y.push($)}const b=r.parse(t[1],1,Lt);if(!b)return null;const S=r.parse(t[t.length-1],t.length-1,f);return S?b.type.kind!=="value"&&r.concat(1).checkSubtype(c,b.type)?null:new yn(c,f,b,g,y,S):null}evaluate(t){const r=this.input.evaluate(t);return(li(r)===this.inputType&&this.outputs[this.cases[r]]||this.otherwise).evaluate(t)}eachChild(t){t(this.input),this.outputs.forEach(t),t(this.otherwise)}outputDefined(){return this.outputs.every(t=>t.outputDefined())&&this.otherwise.outputDefined()}}class oc{constructor(t,r,c){this.type=t,this.branches=r,this.otherwise=c}static parse(t,r){if(t.length<4)return r.error(`Expected at least 3 arguments, but found only ${t.length-1}.`);if(t.length%2!=0)return r.error("Expected an odd number of arguments.");let c;r.expectedType&&r.expectedType.kind!=="value"&&(c=r.expectedType);const f=[];for(let y=1;y<t.length-1;y+=2){const b=r.parse(t[y],y,Nt);if(!b)return null;const S=r.parse(t[y+1],y+1,c);if(!S)return null;f.push([b,S]),c=c||S.type}const g=r.parse(t[t.length-1],t.length-1,c);if(!g)return null;if(!c)throw new Error("Can't infer output type");return new oc(c,f,g)}evaluate(t){for(const[r,c]of this.branches)if(r.evaluate(t))return c.evaluate(t);return this.otherwise.evaluate(t)}eachChild(t){for(const[r,c]of this.branches)t(r),t(c);t(this.otherwise)}outputDefined(){return this.branches.every(([t,r])=>r.outputDefined())&&this.otherwise.outputDefined()}}class Oa{constructor(t,r,c,f){this.type=t,this.input=r,this.beginIndex=c,this.endIndex=f}static parse(t,r){if(t.length<=2||t.length>=5)return r.error(`Expected 3 or 4 arguments, but found ${t.length-1} instead.`);const c=r.parse(t[1],1,Lt),f=r.parse(t[2],2,nt);if(!c||!f)return null;if(!te(c.type,[Ti(Lt),$t,Lt]))return r.error(`Expected first argument to be of type array or string, but found ${Rn(c.type)} instead`);if(t.length===4){const g=r.parse(t[3],3,nt);return g?new Oa(c.type,c,f,g):null}return new Oa(c.type,c,f)}evaluate(t){const r=this.input.evaluate(t),c=this.beginIndex.evaluate(t);if(!B(r,["string","array"]))throw new ti(`Expected first argument to be of type array or string, but found ${Rn(li(r))} instead.`);if(this.endIndex){const f=this.endIndex.evaluate(t);return r.slice(c,f)}return r.slice(c)}eachChild(t){t(this.input),t(this.beginIndex),this.endIndex&&t(this.endIndex)}outputDefined(){return!1}}function Hu(i,t){return i==="=="||i==="!="?t.kind==="boolean"||t.kind==="string"||t.kind==="number"||t.kind==="null"||t.kind==="value":t.kind==="string"||t.kind==="number"||t.kind==="value"}function Xu(i,t,r,c){return c.compare(t,r)===0}function ho(i,t,r){const c=i!=="=="&&i!=="!=";return class P0{constructor(g,y,b){this.type=Nt,this.lhs=g,this.rhs=y,this.collator=b,this.hasUntypedArgument=g.type.kind==="value"||y.type.kind==="value"}static parse(g,y){if(g.length!==3&&g.length!==4)return y.error("Expected two or three arguments.");const b=g[0];let S=y.parse(g[1],1,Lt);if(!S)return null;if(!Hu(b,S.type))return y.concat(1).error(`"${b}" comparisons are not supported for type '${Rn(S.type)}'.`);let P=y.parse(g[2],2,Lt);if(!P)return null;if(!Hu(b,P.type))return y.concat(2).error(`"${b}" comparisons are not supported for type '${Rn(P.type)}'.`);if(S.type.kind!==P.type.kind&&S.type.kind!=="value"&&P.type.kind!=="value")return y.error(`Cannot compare types '${Rn(S.type)}' and '${Rn(P.type)}'.`);c&&(S.type.kind==="value"&&P.type.kind!=="value"?S=new Mr(P.type,[S]):S.type.kind!=="value"&&P.type.kind==="value"&&(P=new Mr(S.type,[P])));let D=null;if(g.length===4){if(S.type.kind!=="string"&&P.type.kind!=="string"&&S.type.kind!=="value"&&P.type.kind!=="value")return y.error("Cannot use collator to compare non-string types.");if(D=y.parse(g[3],3,yr),!D)return null}return new P0(S,P,D)}evaluate(g){const y=this.lhs.evaluate(g),b=this.rhs.evaluate(g);if(c&&this.hasUntypedArgument){const S=li(y),P=li(b);if(S.kind!==P.kind||S.kind!=="string"&&S.kind!=="number")throw new ti(`Expected arguments for "${i}" to be (string, string) or (number, number), but found (${S.kind}, ${P.kind}) instead.`)}if(this.collator&&!c&&this.hasUntypedArgument){const S=li(y),P=li(b);if(S.kind!=="string"||P.kind!=="string")return t(g,y,b)}return this.collator?r(g,y,b,this.collator.evaluate(g)):t(g,y,b)}eachChild(g){g(this.lhs),g(this.rhs),this.collator&&g(this.collator)}outputDefined(){return!0}}}const of=ho("==",function(i,t,r){return t===r},Xu),af=ho("!=",function(i,t,r){return t!==r},function(i,t,r,c){return!Xu(0,t,r,c)}),lf=ho("<",function(i,t,r){return t<r},function(i,t,r,c){return c.compare(t,r)<0}),cf=ho(">",function(i,t,r){return t>r},function(i,t,r,c){return c.compare(t,r)>0}),uf=ho("<=",function(i,t,r){return t<=r},function(i,t,r,c){return c.compare(t,r)<=0}),hf=ho(">=",function(i,t,r){return t>=r},function(i,t,r,c){return c.compare(t,r)>=0});class ac{constructor(t,r,c,f,g){this.type=$t,this.number=t,this.locale=r,this.currency=c,this.minFractionDigits=f,this.maxFractionDigits=g}static parse(t,r){if(t.length!==3)return r.error("Expected two arguments.");const c=r.parse(t[1],1,nt);if(!c)return null;const f=t[2];if(typeof f!="object"||Array.isArray(f))return r.error("NumberFormat options argument must be an object.");let g=null;if(f.locale&&(g=r.parse(f.locale,1,$t),!g))return null;let y=null;if(f.currency&&(y=r.parse(f.currency,1,$t),!y))return null;let b=null;if(f["min-fraction-digits"]&&(b=r.parse(f["min-fraction-digits"],1,nt),!b))return null;let S=null;return f["max-fraction-digits"]&&(S=r.parse(f["max-fraction-digits"],1,nt),!S)?null:new ac(c,g,y,b,S)}evaluate(t){return new Intl.NumberFormat(this.locale?this.locale.evaluate(t):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(t):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(t):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(t):void 0}).format(this.number.evaluate(t))}eachChild(t){t(this.number),this.locale&&t(this.locale),this.currency&&t(this.currency),this.minFractionDigits&&t(this.minFractionDigits),this.maxFractionDigits&&t(this.maxFractionDigits)}outputDefined(){return!1}}class Va{constructor(t){this.type=rs,this.sections=t}static parse(t,r){if(t.length<2)return r.error("Expected at least one argument.");const c=t[1];if(!Array.isArray(c)&&typeof c=="object")return r.error("First argument must be an image or text section.");const f=[];let g=!1;for(let y=1;y<=t.length-1;++y){const b=t[y];if(g&&typeof b=="object"&&!Array.isArray(b)){g=!1;let S=null;if(b["font-scale"]&&(S=r.parse(b["font-scale"],1,nt),!S))return null;let P=null;if(b["text-font"]&&(P=r.parse(b["text-font"],1,Ti($t)),!P))return null;let D=null;if(b["text-color"]&&(D=r.parse(b["text-color"],1,kn),!D))return null;const R=f[f.length-1];R.scale=S,R.font=P,R.textColor=D}else{const S=r.parse(t[y],1,Lt);if(!S)return null;const P=S.type.kind;if(P!=="string"&&P!=="value"&&P!=="null"&&P!=="resolvedImage")return r.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");g=!0,f.push({content:S,scale:null,font:null,textColor:null})}}return new Va(f)}evaluate(t){return new Ii(this.sections.map(r=>{const c=r.content.evaluate(t);return li(c)===ss?new bs("",c,null,null,null):new bs(No(c),null,r.scale?r.scale.evaluate(t):null,r.font?r.font.evaluate(t).join(","):null,r.textColor?r.textColor.evaluate(t):null)}))}eachChild(t){for(const r of this.sections)t(r.content),r.scale&&t(r.scale),r.font&&t(r.font),r.textColor&&t(r.textColor)}outputDefined(){return!1}}class lc{constructor(t){this.type=ss,this.input=t}static parse(t,r){if(t.length!==2)return r.error("Expected two arguments.");const c=r.parse(t[1],1,$t);return c?new lc(c):r.error("No image name provided.")}evaluate(t){const r=this.input.evaluate(t),c=_r.fromString(r);return c&&t.availableImages&&(c.available=t.availableImages.indexOf(r)>-1),c}eachChild(t){t(this.input)}outputDefined(){return!1}}class cc{constructor(t){this.type=nt,this.input=t}static parse(t,r){if(t.length!==2)return r.error(`Expected 1 argument, but found ${t.length-1} instead.`);const c=r.parse(t[1],1);return c?c.type.kind!=="array"&&c.type.kind!=="string"&&c.type.kind!=="value"?r.error(`Expected argument of type string or array, but found ${Rn(c.type)} instead.`):new cc(c):null}evaluate(t){const r=this.input.evaluate(t);if(typeof r=="string"||Array.isArray(r))return r.length;throw new ti(`Expected value to be of type string or array, but found ${Rn(li(r))} instead.`)}eachChild(t){t(this.input)}outputDefined(){return!1}}const fo={"==":of,"!=":af,">":cf,"<":lf,">=":hf,"<=":uf,array:Mr,at:sc,boolean:Mr,case:oc,coalesce:Ba,collator:En,format:Va,image:lc,in:Zo,"index-of":Vs,interpolate:ir,"interpolate-hcl":ir,"interpolate-lab":ir,length:cc,let:Fa,literal:ws,match:yn,number:Mr,"number-format":ac,object:Mr,slice:Oa,step:co,string:Mr,"to-boolean":Ai,"to-color":Ai,"to-number":Ai,"to-string":Ai,var:Ma,within:os};function Ku(i,[t,r,c,f]){t=t.evaluate(i),r=r.evaluate(i),c=c.evaluate(i);const g=f?f.evaluate(i):1,y=ao(t,r,c,g);if(y)throw new ti(y);return new Ht(t/255,r/255,c/255,g,!1)}function Yu(i,t){return i in t}function uc(i,t){const r=t[i];return r===void 0?null:r}function $s(i){return{type:i}}function Ju(i){return{result:"success",value:i}}function po(i){return{result:"error",value:i}}function mo(i){return i["property-type"]==="data-driven"||i["property-type"]==="cross-faded-data-driven"}function Qu(i){return!!i.expression&&i.expression.parameters.indexOf("zoom")>-1}function hc(i){return!!i.expression&&i.expression.interpolated}function An(i){return i instanceof Number?"number":i instanceof String?"string":i instanceof Boolean?"boolean":Array.isArray(i)?"array":i===null?"null":typeof i}function $a(i){return typeof i=="object"&&i!==null&&!Array.isArray(i)}function df(i){return i}function eh(i,t){const r=t.type==="color",c=i.stops&&typeof i.stops[0][0]=="object",f=c||!(c||i.property!==void 0),g=i.type||(hc(t)?"exponential":"interval");if(r||t.type==="padding"){const D=r?Ht.parse:tr.parse;(i=en({},i)).stops&&(i.stops=i.stops.map(R=>[R[0],D(R[1])])),i.default=D(i.default?i.default:t.default)}if(i.colorSpace&&(y=i.colorSpace)!=="rgb"&&y!=="hcl"&&y!=="lab")throw new Error(`Unknown color space: "${i.colorSpace}"`);var y;let b,S,P;if(g==="exponential")b=th;else if(g==="interval")b=dc;else if(g==="categorical"){b=ff,S=Object.create(null);for(const D of i.stops)S[D[0]]=D[1];P=typeof i.stops[0][0]}else{if(g!=="identity")throw new Error(`Unknown function type "${g}"`);b=pf}if(c){const D={},R=[];for(let N=0;N<i.stops.length;N++){const ee=i.stops[N],J=ee[0].zoom;D[J]===void 0&&(D[J]={zoom:J,type:i.type,property:i.property,default:i.default,stops:[]},R.push(J)),D[J].stops.push([ee[0].value,ee[1]])}const O=[];for(const N of R)O.push([D[N].zoom,eh(D[N],t)]);const $={name:"linear"};return{kind:"composite",interpolationType:$,interpolationFactor:ir.interpolationFactor.bind(void 0,$),zoomStops:O.map(N=>N[0]),evaluate:({zoom:N},ee)=>th({stops:O,base:i.base},t,N).evaluate(N,ee)}}if(f){const D=g==="exponential"?{name:"exponential",base:i.base!==void 0?i.base:1}:null;return{kind:"camera",interpolationType:D,interpolationFactor:ir.interpolationFactor.bind(void 0,D),zoomStops:i.stops.map(R=>R[0]),evaluate:({zoom:R})=>b(i,t,R,S,P)}}return{kind:"source",evaluate(D,R){const O=R&&R.properties?R.properties[i.property]:void 0;return O===void 0?Go(i.default,t.default):b(i,t,O,S,P)}}}function Go(i,t,r){return i!==void 0?i:t!==void 0?t:r!==void 0?r:void 0}function ff(i,t,r,c,f){return Go(typeof r===f?c[r]:void 0,i.default,t.default)}function dc(i,t,r){if(An(r)!=="number")return Go(i.default,t.default);const c=i.stops.length;if(c===1||r<=i.stops[0][0])return i.stops[0][1];if(r>=i.stops[c-1][0])return i.stops[c-1][1];const f=La(i.stops.map(g=>g[0]),r);return i.stops[f][1]}function th(i,t,r){const c=i.base!==void 0?i.base:1;if(An(r)!=="number")return Go(i.default,t.default);const f=i.stops.length;if(f===1||r<=i.stops[0][0])return i.stops[0][1];if(r>=i.stops[f-1][0])return i.stops[f-1][1];const g=La(i.stops.map(D=>D[0]),r),y=function(D,R,O,$){const N=$-O,ee=D-O;return N===0?0:R===1?ee/N:(Math.pow(R,ee)-1)/(Math.pow(R,N)-1)}(r,c,i.stops[g][0],i.stops[g+1][0]),b=i.stops[g][1],S=i.stops[g+1][1],P=nr[t.type]||df;return typeof b.evaluate=="function"?{evaluate(...D){const R=b.evaluate.apply(void 0,D),O=S.evaluate.apply(void 0,D);if(R!==void 0&&O!==void 0)return P(R,O,y,i.colorSpace)}}:P(b,S,y,i.colorSpace)}function pf(i,t,r){switch(t.type){case"color":r=Ht.parse(r);break;case"formatted":r=Ii.fromString(r.toString());break;case"resolvedImage":r=_r.fromString(r.toString());break;case"padding":r=tr.parse(r);break;default:An(r)===t.type||t.type==="enum"&&t.values[r]||(r=void 0)}return Go(r,i.default,t.default)}vr.register(fo,{error:[{kind:"error"},[$t],(i,[t])=>{throw new ti(t.evaluate(i))}],typeof:[$t,[Lt],(i,[t])=>Rn(li(t.evaluate(i)))],"to-rgba":[Ti(nt,4),[kn],(i,[t])=>{const[r,c,f,g]=t.evaluate(i).rgb;return[255*r,255*c,255*f,g]}],rgb:[kn,[nt,nt,nt],Ku],rgba:[kn,[nt,nt,nt,nt],Ku],has:{type:Nt,overloads:[[[$t],(i,[t])=>Yu(t.evaluate(i),i.properties())],[[$t,dn],(i,[t,r])=>Yu(t.evaluate(i),r.evaluate(i))]]},get:{type:Lt,overloads:[[[$t],(i,[t])=>uc(t.evaluate(i),i.properties())],[[$t,dn],(i,[t,r])=>uc(t.evaluate(i),r.evaluate(i))]]},"feature-state":[Lt,[$t],(i,[t])=>uc(t.evaluate(i),i.featureState||{})],properties:[dn,[],i=>i.properties()],"geometry-type":[$t,[],i=>i.geometryType()],id:[Lt,[],i=>i.id()],zoom:[nt,[],i=>i.globals.zoom],"heatmap-density":[nt,[],i=>i.globals.heatmapDensity||0],"line-progress":[nt,[],i=>i.globals.lineProgress||0],accumulated:[Lt,[],i=>i.globals.accumulated===void 0?null:i.globals.accumulated],"+":[nt,$s(nt),(i,t)=>{let r=0;for(const c of t)r+=c.evaluate(i);return r}],"*":[nt,$s(nt),(i,t)=>{let r=1;for(const c of t)r*=c.evaluate(i);return r}],"-":{type:nt,overloads:[[[nt,nt],(i,[t,r])=>t.evaluate(i)-r.evaluate(i)],[[nt],(i,[t])=>-t.evaluate(i)]]},"/":[nt,[nt,nt],(i,[t,r])=>t.evaluate(i)/r.evaluate(i)],"%":[nt,[nt,nt],(i,[t,r])=>t.evaluate(i)%r.evaluate(i)],ln2:[nt,[],()=>Math.LN2],pi:[nt,[],()=>Math.PI],e:[nt,[],()=>Math.E],"^":[nt,[nt,nt],(i,[t,r])=>Math.pow(t.evaluate(i),r.evaluate(i))],sqrt:[nt,[nt],(i,[t])=>Math.sqrt(t.evaluate(i))],log10:[nt,[nt],(i,[t])=>Math.log(t.evaluate(i))/Math.LN10],ln:[nt,[nt],(i,[t])=>Math.log(t.evaluate(i))],log2:[nt,[nt],(i,[t])=>Math.log(t.evaluate(i))/Math.LN2],sin:[nt,[nt],(i,[t])=>Math.sin(t.evaluate(i))],cos:[nt,[nt],(i,[t])=>Math.cos(t.evaluate(i))],tan:[nt,[nt],(i,[t])=>Math.tan(t.evaluate(i))],asin:[nt,[nt],(i,[t])=>Math.asin(t.evaluate(i))],acos:[nt,[nt],(i,[t])=>Math.acos(t.evaluate(i))],atan:[nt,[nt],(i,[t])=>Math.atan(t.evaluate(i))],min:[nt,$s(nt),(i,t)=>Math.min(...t.map(r=>r.evaluate(i)))],max:[nt,$s(nt),(i,t)=>Math.max(...t.map(r=>r.evaluate(i)))],abs:[nt,[nt],(i,[t])=>Math.abs(t.evaluate(i))],round:[nt,[nt],(i,[t])=>{const r=t.evaluate(i);return r<0?-Math.round(-r):Math.round(r)}],floor:[nt,[nt],(i,[t])=>Math.floor(t.evaluate(i))],ceil:[nt,[nt],(i,[t])=>Math.ceil(t.evaluate(i))],"filter-==":[Nt,[$t,Lt],(i,[t,r])=>i.properties()[t.value]===r.value],"filter-id-==":[Nt,[Lt],(i,[t])=>i.id()===t.value],"filter-type-==":[Nt,[$t],(i,[t])=>i.geometryType()===t.value],"filter-<":[Nt,[$t,Lt],(i,[t,r])=>{const c=i.properties()[t.value],f=r.value;return typeof c==typeof f&&c<f}],"filter-id-<":[Nt,[Lt],(i,[t])=>{const r=i.id(),c=t.value;return typeof r==typeof c&&r<c}],"filter->":[Nt,[$t,Lt],(i,[t,r])=>{const c=i.properties()[t.value],f=r.value;return typeof c==typeof f&&c>f}],"filter-id->":[Nt,[Lt],(i,[t])=>{const r=i.id(),c=t.value;return typeof r==typeof c&&r>c}],"filter-<=":[Nt,[$t,Lt],(i,[t,r])=>{const c=i.properties()[t.value],f=r.value;return typeof c==typeof f&&c<=f}],"filter-id-<=":[Nt,[Lt],(i,[t])=>{const r=i.id(),c=t.value;return typeof r==typeof c&&r<=c}],"filter->=":[Nt,[$t,Lt],(i,[t,r])=>{const c=i.properties()[t.value],f=r.value;return typeof c==typeof f&&c>=f}],"filter-id->=":[Nt,[Lt],(i,[t])=>{const r=i.id(),c=t.value;return typeof r==typeof c&&r>=c}],"filter-has":[Nt,[Lt],(i,[t])=>t.value in i.properties()],"filter-has-id":[Nt,[],i=>i.id()!==null&&i.id()!==void 0],"filter-type-in":[Nt,[Ti($t)],(i,[t])=>t.value.indexOf(i.geometryType())>=0],"filter-id-in":[Nt,[Ti(Lt)],(i,[t])=>t.value.indexOf(i.id())>=0],"filter-in-small":[Nt,[$t,Ti(Lt)],(i,[t,r])=>r.value.indexOf(i.properties()[t.value])>=0],"filter-in-large":[Nt,[$t,Ti(Lt)],(i,[t,r])=>function(c,f,g,y){for(;g<=y;){const b=g+y>>1;if(f[b]===c)return!0;f[b]>c?y=b-1:g=b+1}return!1}(i.properties()[t.value],r.value,0,r.value.length-1)],all:{type:Nt,overloads:[[[Nt,Nt],(i,[t,r])=>t.evaluate(i)&&r.evaluate(i)],[$s(Nt),(i,t)=>{for(const r of t)if(!r.evaluate(i))return!1;return!0}]]},any:{type:Nt,overloads:[[[Nt,Nt],(i,[t,r])=>t.evaluate(i)||r.evaluate(i)],[$s(Nt),(i,t)=>{for(const r of t)if(r.evaluate(i))return!0;return!1}]]},"!":[Nt,[Nt],(i,[t])=>!t.evaluate(i)],"is-supported-script":[Nt,[$t],(i,[t])=>{const r=i.globals&&i.globals.isSupportedScript;return!r||r(t.evaluate(i))}],upcase:[$t,[$t],(i,[t])=>t.evaluate(i).toUpperCase()],downcase:[$t,[$t],(i,[t])=>t.evaluate(i).toLowerCase()],concat:[$t,$s(Lt),(i,t)=>t.map(r=>No(r.evaluate(i))).join("")],"resolved-locale":[$t,[yr],(i,[t])=>t.evaluate(i).resolvedLocale()]});class fc{constructor(t,r){var c;this.expression=t,this._warningHistory={},this._evaluator=new Pa,this._defaultValue=r?(c=r).type==="color"&&$a(c.default)?new Ht(0,0,0,0):c.type==="color"?Ht.parse(c.default)||null:c.type==="padding"?tr.parse(c.default)||null:c.default===void 0?null:c.default:null,this._enumValues=r&&r.type==="enum"?r.values:null}evaluateWithoutErrorHandling(t,r,c,f,g,y){return this._evaluator.globals=t,this._evaluator.feature=r,this._evaluator.featureState=c,this._evaluator.canonical=f,this._evaluator.availableImages=g||null,this._evaluator.formattedSection=y,this.expression.evaluate(this._evaluator)}evaluate(t,r,c,f,g,y){this._evaluator.globals=t,this._evaluator.feature=r||null,this._evaluator.featureState=c||null,this._evaluator.canonical=f,this._evaluator.availableImages=g||null,this._evaluator.formattedSection=y||null;try{const b=this.expression.evaluate(this._evaluator);if(b==null||typeof b=="number"&&b!=b)return this._defaultValue;if(this._enumValues&&!(b in this._enumValues))throw new ti(`Expected value to be one of ${Object.keys(this._enumValues).map(S=>JSON.stringify(S)).join(", ")}, but found ${JSON.stringify(b)} instead.`);return b}catch(b){return this._warningHistory[b.message]||(this._warningHistory[b.message]=!0,typeof console<"u"&&console.warn(b.message)),this._defaultValue}}}function Ua(i){return Array.isArray(i)&&i.length>0&&typeof i[0]=="string"&&i[0]in fo}function Gn(i,t){const r=new Ss(fo,Da,[],t?function(f){const g={color:kn,string:$t,number:nt,enum:$t,boolean:Nt,formatted:rs,padding:kr,resolvedImage:ss};return f.type==="array"?Ti(g[f.value]||Lt,f.length):g[f.type]}(t):void 0),c=r.parse(i,void 0,void 0,void 0,t&&t.type==="string"?{typeAnnotation:"coerce"}:void 0);return c?Ju(new fc(c,t)):po(r.errors)}class pc{constructor(t,r){this.kind=t,this._styleExpression=r,this.isStateDependent=t!=="constant"&&!lo(r.expression)}evaluateWithoutErrorHandling(t,r,c,f,g,y){return this._styleExpression.evaluateWithoutErrorHandling(t,r,c,f,g,y)}evaluate(t,r,c,f,g,y){return this._styleExpression.evaluate(t,r,c,f,g,y)}}class cn{constructor(t,r,c,f){this.kind=t,this.zoomStops=c,this._styleExpression=r,this.isStateDependent=t!=="camera"&&!lo(r.expression),this.interpolationType=f}evaluateWithoutErrorHandling(t,r,c,f,g,y){return this._styleExpression.evaluateWithoutErrorHandling(t,r,c,f,g,y)}evaluate(t,r,c,f,g,y){return this._styleExpression.evaluate(t,r,c,f,g,y)}interpolationFactor(t,r,c){return this.interpolationType?ir.interpolationFactor(this.interpolationType,t,r,c):0}}function Na(i,t){const r=Gn(i,t);if(r.result==="error")return r;const c=r.value.expression,f=qo(c);if(!f&&!mo(t))return po([new Wt("","data expressions not supported")]);const g=za(c,["zoom"]);if(!g&&!Qu(t))return po([new Wt("","zoom expressions not supported")]);const y=Ln(c);return y||g?y instanceof Wt?po([y]):y instanceof ir&&!hc(t)?po([new Wt("",'"interpolate" expressions cannot be used with this property')]):Ju(y?new cn(f?"camera":"composite",r.value,y.labels,y instanceof ir?y.interpolation:void 0):new pc(f?"constant":"source",r.value)):po([new Wt("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class Bn{constructor(t,r){this._parameters=t,this._specification=r,en(this,eh(this._parameters,this._specification))}static deserialize(t){return new Bn(t._parameters,t._specification)}static serialize(t){return{_parameters:t._parameters,_specification:t._specification}}}function Ln(i){let t=null;if(i instanceof Fa)t=Ln(i.result);else if(i instanceof Ba){for(const r of i.args)if(t=Ln(r),t)break}else(i instanceof co||i instanceof ir)&&i.input instanceof vr&&i.input.name==="zoom"&&(t=i);return t instanceof Wt||i.eachChild(r=>{const c=Ln(r);c instanceof Wt?t=c:!t&&c?t=new Wt("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):t&&c&&t!==c&&(t=new Wt("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),t}function go(i){if(i===!0||i===!1)return!0;if(!Array.isArray(i)||i.length===0)return!1;switch(i[0]){case"has":return i.length>=2&&i[1]!=="$id"&&i[1]!=="$type";case"in":return i.length>=3&&(typeof i[1]!="string"||Array.isArray(i[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return i.length!==3||Array.isArray(i[1])||Array.isArray(i[2]);case"any":case"all":for(const t of i.slice(1))if(!go(t)&&typeof t!="boolean")return!1;return!0;default:return!0}}const nh={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function mc(i){if(i==null)return{filter:()=>!0,needGeometry:!1};go(i)||(i=ja(i));const t=Gn(i,nh);if(t.result==="error")throw new Error(t.value.map(r=>`${r.key}: ${r.message}`).join(", "));return{filter:(r,c,f)=>t.value.evaluate(r,c,{},f),needGeometry:ih(i)}}function mf(i,t){return i<t?-1:i>t?1:0}function ih(i){if(!Array.isArray(i))return!1;if(i[0]==="within")return!0;for(let t=1;t<i.length;t++)if(ih(i[t]))return!0;return!1}function ja(i){if(!i)return!0;const t=i[0];return i.length<=1?t!=="any":t==="=="?qa(i[1],i[2],"=="):t==="!="?Wo(qa(i[1],i[2],"==")):t==="<"||t===">"||t==="<="||t===">="?qa(i[1],i[2],t):t==="any"?(r=i.slice(1),["any"].concat(r.map(ja))):t==="all"?["all"].concat(i.slice(1).map(ja)):t==="none"?["all"].concat(i.slice(1).map(ja).map(Wo)):t==="in"?gc(i[1],i.slice(2)):t==="!in"?Wo(gc(i[1],i.slice(2))):t==="has"?yc(i[1]):t==="!has"?Wo(yc(i[1])):t!=="within"||i;var r}function qa(i,t,r){switch(i){case"$type":return[`filter-type-${r}`,t];case"$id":return[`filter-id-${r}`,t];default:return[`filter-${r}`,i,t]}}function gc(i,t){if(t.length===0)return!1;switch(i){case"$type":return["filter-type-in",["literal",t]];case"$id":return["filter-id-in",["literal",t]];default:return t.length>200&&!t.some(r=>typeof r!=typeof t[0])?["filter-in-large",i,["literal",t.sort(mf)]]:["filter-in-small",i,["literal",t]]}}function yc(i){switch(i){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",i]}}function Wo(i){return["!",i]}function Ho(i){const t=typeof i;if(t==="number"||t==="boolean"||t==="string"||i==null)return JSON.stringify(i);if(Array.isArray(i)){let f="[";for(const g of i)f+=`${Ho(g)},`;return`${f}]`}const r=Object.keys(i).sort();let c="{";for(let f=0;f<r.length;f++)c+=`${JSON.stringify(r[f])}:${Ho(i[r[f]])},`;return`${c}}`}function gf(i){let t="";for(const r of ke)t+=`/${Ho(i[r])}`;return t}function rh(i){const t=i.value;return t?[new $e(i.key,t,"constants have been deprecated as of v8")]:[]}function ni(i){return i instanceof Number||i instanceof String||i instanceof Boolean?i.valueOf():i}function Us(i){if(Array.isArray(i))return i.map(Us);if(i instanceof Object&&!(i instanceof Number||i instanceof String||i instanceof Boolean)){const t={};for(const r in i)t[r]=Us(i[r]);return t}return ni(i)}function xr(i){const t=i.key,r=i.value,c=i.valueSpec||{},f=i.objectElementValidators||{},g=i.style,y=i.styleSpec,b=i.validateSpec;let S=[];const P=An(r);if(P!=="object")return[new $e(t,r,`object expected, ${P} found`)];for(const D in r){const R=D.split(".")[0],O=c[R]||c["*"];let $;if(f[R])$=f[R];else if(c[R])$=b;else if(f["*"])$=f["*"];else{if(!c["*"]){S.push(new $e(t,r[D],`unknown property "${D}"`));continue}$=b}S=S.concat($({key:(t&&`${t}.`)+D,value:r[D],valueSpec:O,style:g,styleSpec:y,object:r,objectKey:D,validateSpec:b},r))}for(const D in c)f[D]||c[D].required&&c[D].default===void 0&&r[D]===void 0&&S.push(new $e(t,r,`missing required property "${D}"`));return S}function sh(i){const t=i.value,r=i.valueSpec,c=i.style,f=i.styleSpec,g=i.key,y=i.arrayElementValidator||i.validateSpec;if(An(t)!=="array")return[new $e(g,t,`array expected, ${An(t)} found`)];if(r.length&&t.length!==r.length)return[new $e(g,t,`array length ${r.length} expected, length ${t.length} found`)];if(r["min-length"]&&t.length<r["min-length"])return[new $e(g,t,`array length at least ${r["min-length"]} expected, length ${t.length} found`)];let b={type:r.value,values:r.values};f.$version<7&&(b.function=r.function),An(r.value)==="object"&&(b=r.value);let S=[];for(let P=0;P<t.length;P++)S=S.concat(y({array:t,arrayIndex:P,value:t[P],valueSpec:b,validateSpec:i.validateSpec,style:c,styleSpec:f,key:`${g}[${P}]`}));return S}function _c(i){const t=i.key,r=i.value,c=i.valueSpec;let f=An(r);return f==="number"&&r!=r&&(f="NaN"),f!=="number"?[new $e(t,r,`number expected, ${f} found`)]:"minimum"in c&&r<c.minimum?[new $e(t,r,`${r} is less than the minimum value ${c.minimum}`)]:"maximum"in c&&r>c.maximum?[new $e(t,r,`${r} is greater than the maximum value ${c.maximum}`)]:[]}function oh(i){const t=i.valueSpec,r=ni(i.value.type);let c,f,g,y={};const b=r!=="categorical"&&i.value.property===void 0,S=!b,P=An(i.value.stops)==="array"&&An(i.value.stops[0])==="array"&&An(i.value.stops[0][0])==="object",D=xr({key:i.key,value:i.value,valueSpec:i.styleSpec.function,validateSpec:i.validateSpec,style:i.style,styleSpec:i.styleSpec,objectElementValidators:{stops:function($){if(r==="identity")return[new $e($.key,$.value,'identity function may not have a "stops" property')];let N=[];const ee=$.value;return N=N.concat(sh({key:$.key,value:ee,valueSpec:$.valueSpec,validateSpec:$.validateSpec,style:$.style,styleSpec:$.styleSpec,arrayElementValidator:R})),An(ee)==="array"&&ee.length===0&&N.push(new $e($.key,ee,"array must have at least one stop")),N},default:function($){return $.validateSpec({key:$.key,value:$.value,valueSpec:t,validateSpec:$.validateSpec,style:$.style,styleSpec:$.styleSpec})}}});return r==="identity"&&b&&D.push(new $e(i.key,i.value,'missing required property "property"')),r==="identity"||i.value.stops||D.push(new $e(i.key,i.value,'missing required property "stops"')),r==="exponential"&&i.valueSpec.expression&&!hc(i.valueSpec)&&D.push(new $e(i.key,i.value,"exponential functions not supported")),i.styleSpec.$version>=8&&(S&&!mo(i.valueSpec)?D.push(new $e(i.key,i.value,"property functions not supported")):b&&!Qu(i.valueSpec)&&D.push(new $e(i.key,i.value,"zoom functions not supported"))),r!=="categorical"&&!P||i.value.property!==void 0||D.push(new $e(i.key,i.value,'"property" property is required')),D;function R($){let N=[];const ee=$.value,J=$.key;if(An(ee)!=="array")return[new $e(J,ee,`array expected, ${An(ee)} found`)];if(ee.length!==2)return[new $e(J,ee,`array length 2 expected, length ${ee.length} found`)];if(P){if(An(ee[0])!=="object")return[new $e(J,ee,`object expected, ${An(ee[0])} found`)];if(ee[0].zoom===void 0)return[new $e(J,ee,"object stop key must have zoom")];if(ee[0].value===void 0)return[new $e(J,ee,"object stop key must have value")];if(g&&g>ni(ee[0].zoom))return[new $e(J,ee[0].zoom,"stop zoom values must appear in ascending order")];ni(ee[0].zoom)!==g&&(g=ni(ee[0].zoom),f=void 0,y={}),N=N.concat(xr({key:`${J}[0]`,value:ee[0],valueSpec:{zoom:{}},validateSpec:$.validateSpec,style:$.style,styleSpec:$.styleSpec,objectElementValidators:{zoom:_c,value:O}}))}else N=N.concat(O({key:`${J}[0]`,value:ee[0],valueSpec:{},validateSpec:$.validateSpec,style:$.style,styleSpec:$.styleSpec},ee));return Ua(Us(ee[1]))?N.concat([new $e(`${J}[1]`,ee[1],"expressions are not allowed in function stops.")]):N.concat($.validateSpec({key:`${J}[1]`,value:ee[1],valueSpec:t,validateSpec:$.validateSpec,style:$.style,styleSpec:$.styleSpec}))}function O($,N){const ee=An($.value),J=ni($.value),fe=$.value!==null?$.value:N;if(c){if(ee!==c)return[new $e($.key,fe,`${ee} stop domain type must match previous stop domain type ${c}`)]}else c=ee;if(ee!=="number"&&ee!=="string"&&ee!=="boolean")return[new $e($.key,fe,"stop domain value must be a number, string, or boolean")];if(ee!=="number"&&r!=="categorical"){let ve=`number expected, ${ee} found`;return mo(t)&&r===void 0&&(ve+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new $e($.key,fe,ve)]}return r!=="categorical"||ee!=="number"||isFinite(J)&&Math.floor(J)===J?r!=="categorical"&&ee==="number"&&f!==void 0&&J<f?[new $e($.key,fe,"stop domain values must appear in ascending order")]:(f=J,r==="categorical"&&J in y?[new $e($.key,fe,"stop domain values must be unique")]:(y[J]=!0,[])):[new $e($.key,fe,`integer expected, found ${J}`)]}}function Ns(i){const t=(i.expressionContext==="property"?Na:Gn)(Us(i.value),i.valueSpec);if(t.result==="error")return t.value.map(c=>new $e(`${i.key}${c.key}`,i.value,c.message));const r=t.value.expression||t.value._styleExpression.expression;if(i.expressionContext==="property"&&i.propertyKey==="text-font"&&!r.outputDefined())return[new $e(i.key,i.value,`Invalid data expression for "${i.propertyKey}". Output values must be contained as literals within the expression.`)];if(i.expressionContext==="property"&&i.propertyType==="layout"&&!lo(r))return[new $e(i.key,i.value,'"feature-state" data expressions are not supported with layout properties.')];if(i.expressionContext==="filter"&&!lo(r))return[new $e(i.key,i.value,'"feature-state" data expressions are not supported with filters.')];if(i.expressionContext&&i.expressionContext.indexOf("cluster")===0){if(!za(r,["zoom","feature-state"]))return[new $e(i.key,i.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(i.expressionContext==="cluster-initial"&&!qo(r))return[new $e(i.key,i.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Xo(i){const t=i.key,r=i.value,c=i.valueSpec,f=[];return Array.isArray(c.values)?c.values.indexOf(ni(r))===-1&&f.push(new $e(t,r,`expected one of [${c.values.join(", ")}], ${JSON.stringify(r)} found`)):Object.keys(c.values).indexOf(ni(r))===-1&&f.push(new $e(t,r,`expected one of [${Object.keys(c.values).join(", ")}], ${JSON.stringify(r)} found`)),f}function yo(i){return go(Us(i.value))?Ns(en({},i,{expressionContext:"filter",valueSpec:{value:"boolean"}})):ah(i)}function ah(i){const t=i.value,r=i.key;if(An(t)!=="array")return[new $e(r,t,`array expected, ${An(t)} found`)];const c=i.styleSpec;let f,g=[];if(t.length<1)return[new $e(r,t,"filter array must have at least 1 element")];switch(g=g.concat(Xo({key:`${r}[0]`,value:t[0],valueSpec:c.filter_operator,style:i.style,styleSpec:i.styleSpec})),ni(t[0])){case"<":case"<=":case">":case">=":t.length>=2&&ni(t[1])==="$type"&&g.push(new $e(r,t,`"$type" cannot be use with operator "${t[0]}"`));case"==":case"!=":t.length!==3&&g.push(new $e(r,t,`filter array for operator "${t[0]}" must have 3 elements`));case"in":case"!in":t.length>=2&&(f=An(t[1]),f!=="string"&&g.push(new $e(`${r}[1]`,t[1],`string expected, ${f} found`)));for(let y=2;y<t.length;y++)f=An(t[y]),ni(t[1])==="$type"?g=g.concat(Xo({key:`${r}[${y}]`,value:t[y],valueSpec:c.geometry_type,style:i.style,styleSpec:i.styleSpec})):f!=="string"&&f!=="number"&&f!=="boolean"&&g.push(new $e(`${r}[${y}]`,t[y],`string, number, or boolean expected, ${f} found`));break;case"any":case"all":case"none":for(let y=1;y<t.length;y++)g=g.concat(ah({key:`${r}[${y}]`,value:t[y],style:i.style,styleSpec:i.styleSpec}));break;case"has":case"!has":f=An(t[1]),t.length!==2?g.push(new $e(r,t,`filter array for "${t[0]}" operator must have 2 elements`)):f!=="string"&&g.push(new $e(`${r}[1]`,t[1],`string expected, ${f} found`));break;case"within":f=An(t[1]),t.length!==2?g.push(new $e(r,t,`filter array for "${t[0]}" operator must have 2 elements`)):f!=="object"&&g.push(new $e(`${r}[1]`,t[1],`object expected, ${f} found`))}return g}function vc(i,t){const r=i.key,c=i.validateSpec,f=i.style,g=i.styleSpec,y=i.value,b=i.objectKey,S=g[`${t}_${i.layerType}`];if(!S)return[];const P=b.match(/^(.*)-transition$/);if(t==="paint"&&P&&S[P[1]]&&S[P[1]].transition)return c({key:r,value:y,valueSpec:g.transition,style:f,styleSpec:g});const D=i.valueSpec||S[b];if(!D)return[new $e(r,y,`unknown property "${b}"`)];let R;if(An(y)==="string"&&mo(D)&&!D.tokens&&(R=/^{([^}]+)}$/.exec(y)))return[new $e(r,y,`"${b}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(R[1])} }\`.`)];const O=[];return i.layerType==="symbol"&&(b==="text-field"&&f&&!f.glyphs&&O.push(new $e(r,y,'use of "text-field" requires a style "glyphs" property')),b==="text-font"&&$a(Us(y))&&ni(y.type)==="identity"&&O.push(new $e(r,y,'"text-font" does not support identity functions'))),O.concat(c({key:i.key,value:y,valueSpec:D,style:f,styleSpec:g,expressionContext:"property",propertyType:t,propertyKey:b}))}function xc(i){return vc(i,"paint")}function lh(i){return vc(i,"layout")}function Za(i){let t=[];const r=i.value,c=i.key,f=i.style,g=i.styleSpec;r.type||r.ref||t.push(new $e(c,r,'either "type" or "ref" is required'));let y=ni(r.type);const b=ni(r.ref);if(r.id){const S=ni(r.id);for(let P=0;P<i.arrayIndex;P++){const D=f.layers[P];ni(D.id)===S&&t.push(new $e(c,r.id,`duplicate layer id "${r.id}", previously used at line ${D.id.__line__}`))}}if("ref"in r){let S;["type","source","source-layer","filter","layout"].forEach(P=>{P in r&&t.push(new $e(c,r[P],`"${P}" is prohibited for ref layers`))}),f.layers.forEach(P=>{ni(P.id)===b&&(S=P)}),S?S.ref?t.push(new $e(c,r.ref,"ref cannot reference another ref layer")):y=ni(S.type):t.push(new $e(c,r.ref,`ref layer "${b}" not found`))}else if(y!=="background")if(r.source){const S=f.sources&&f.sources[r.source],P=S&&ni(S.type);S?P==="vector"&&y==="raster"?t.push(new $e(c,r.source,`layer "${r.id}" requires a raster source`)):P==="raster"&&y!=="raster"?t.push(new $e(c,r.source,`layer "${r.id}" requires a vector source`)):P!=="vector"||r["source-layer"]?P==="raster-dem"&&y!=="hillshade"?t.push(new $e(c,r.source,"raster-dem source can only be used with layer type 'hillshade'.")):y!=="line"||!r.paint||!r.paint["line-gradient"]||P==="geojson"&&S.lineMetrics||t.push(new $e(c,r,`layer "${r.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):t.push(new $e(c,r,`layer "${r.id}" must specify a "source-layer"`)):t.push(new $e(c,r.source,`source "${r.source}" not found`))}else t.push(new $e(c,r,'missing required property "source"'));return t=t.concat(xr({key:c,value:r,valueSpec:g.layer,style:i.style,styleSpec:i.styleSpec,validateSpec:i.validateSpec,objectElementValidators:{"*":()=>[],type:()=>i.validateSpec({key:`${c}.type`,value:r.type,valueSpec:g.layer.type,style:i.style,styleSpec:i.styleSpec,validateSpec:i.validateSpec,object:r,objectKey:"type"}),filter:yo,layout:S=>xr({layer:r,key:S.key,value:S.value,style:S.style,styleSpec:S.styleSpec,validateSpec:S.validateSpec,objectElementValidators:{"*":P=>lh(en({layerType:y},P))}}),paint:S=>xr({layer:r,key:S.key,value:S.value,style:S.style,styleSpec:S.styleSpec,validateSpec:S.validateSpec,objectElementValidators:{"*":P=>xc(en({layerType:y},P))}})}})),t}function qr(i){const t=i.value,r=i.key,c=An(t);return c!=="string"?[new $e(r,t,`string expected, ${c} found`)]:[]}const Ga={promoteId:function({key:i,value:t}){if(An(t)==="string")return qr({key:i,value:t});{const r=[];for(const c in t)r.push(...qr({key:`${i}.${c}`,value:t[c]}));return r}}};function Wa(i){const t=i.value,r=i.key,c=i.styleSpec,f=i.style,g=i.validateSpec;if(!t.type)return[new $e(r,t,'"type" is required')];const y=ni(t.type);let b;switch(y){case"vector":case"raster":case"raster-dem":return b=xr({key:r,value:t,valueSpec:c[`source_${y.replace("-","_")}`],style:i.style,styleSpec:c,objectElementValidators:Ga,validateSpec:g}),b;case"geojson":if(b=xr({key:r,value:t,valueSpec:c.source_geojson,style:f,styleSpec:c,validateSpec:g,objectElementValidators:Ga}),t.cluster)for(const S in t.clusterProperties){const[P,D]=t.clusterProperties[S],R=typeof P=="string"?[P,["accumulated"],["get",S]]:P;b.push(...Ns({key:`${r}.${S}.map`,value:D,validateSpec:g,expressionContext:"cluster-map"})),b.push(...Ns({key:`${r}.${S}.reduce`,value:R,validateSpec:g,expressionContext:"cluster-reduce"}))}return b;case"video":return xr({key:r,value:t,valueSpec:c.source_video,style:f,validateSpec:g,styleSpec:c});case"image":return xr({key:r,value:t,valueSpec:c.source_image,style:f,validateSpec:g,styleSpec:c});case"canvas":return[new $e(r,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Xo({key:`${r}.type`,value:t.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:f,validateSpec:g,styleSpec:c})}}function ch(i){const t=i.value,r=i.styleSpec,c=r.light,f=i.style;let g=[];const y=An(t);if(t===void 0)return g;if(y!=="object")return g=g.concat([new $e("light",t,`object expected, ${y} found`)]),g;for(const b in t){const S=b.match(/^(.*)-transition$/);g=g.concat(S&&c[S[1]]&&c[S[1]].transition?i.validateSpec({key:b,value:t[b],valueSpec:r.transition,validateSpec:i.validateSpec,style:f,styleSpec:r}):c[b]?i.validateSpec({key:b,value:t[b],valueSpec:c[b],validateSpec:i.validateSpec,style:f,styleSpec:r}):[new $e(b,t[b],`unknown property "${b}"`)])}return g}function Ko(i){const t=i.value,r=i.styleSpec,c=r.terrain,f=i.style;let g=[];const y=An(t);if(t===void 0)return g;if(y!=="object")return g=g.concat([new $e("terrain",t,`object expected, ${y} found`)]),g;for(const b in t)g=g.concat(c[b]?i.validateSpec({key:b,value:t[b],valueSpec:c[b],validateSpec:i.validateSpec,style:f,styleSpec:r}):[new $e(b,t[b],`unknown property "${b}"`)]);return g}function uh(i){let t=[];const r=i.value,c=i.key;if(Array.isArray(r)){const f=[],g=[];for(const y in r)r[y].id&&f.includes(r[y].id)&&t.push(new $e(c,r,`all the sprites' ids must be unique, but ${r[y].id} is duplicated`)),f.push(r[y].id),r[y].url&&g.includes(r[y].url)&&t.push(new $e(c,r,`all the sprites' URLs must be unique, but ${r[y].url} is duplicated`)),g.push(r[y].url),t=t.concat(xr({key:`${c}[${y}]`,value:r[y],valueSpec:{id:{type:"string",required:!0},url:{type:"string",required:!0}},validateSpec:i.validateSpec}));return t}return qr({key:c,value:r})}const hh={"*":()=>[],array:sh,boolean:function(i){const t=i.value,r=i.key,c=An(t);return c!=="boolean"?[new $e(r,t,`boolean expected, ${c} found`)]:[]},number:_c,color:function(i){const t=i.key,r=i.value,c=An(r);return c!=="string"?[new $e(t,r,`color expected, ${c} found`)]:Ht.parse(String(r))?[]:[new $e(t,r,`color expected, "${r}" found`)]},constants:rh,enum:Xo,filter:yo,function:oh,layer:Za,object:xr,source:Wa,light:ch,terrain:Ko,string:qr,formatted:function(i){return qr(i).length===0?[]:Ns(i)},resolvedImage:function(i){return qr(i).length===0?[]:Ns(i)},padding:function(i){const t=i.key,r=i.value;if(An(r)==="array"){if(r.length<1||r.length>4)return[new $e(t,r,`padding requires 1 to 4 values; ${r.length} values found`)];const c={type:"number"};let f=[];for(let g=0;g<r.length;g++)f=f.concat(i.validateSpec({key:`${t}[${g}]`,value:r[g],validateSpec:i.validateSpec,valueSpec:c}));return f}return _c({key:t,value:r,valueSpec:{}})},sprite:uh};function Yo(i){const t=i.value,r=i.valueSpec,c=i.styleSpec;return i.validateSpec=Yo,r.expression&&$a(ni(t))?oh(i):r.expression&&Ua(Us(t))?Ns(i):r.type&&hh[r.type]?hh[r.type](i):xr(en({},i,{valueSpec:r.type?c[r.type]:r}))}function dh(i){const t=i.value,r=i.key,c=qr(i);return c.length||(t.indexOf("{fontstack}")===-1&&c.push(new $e(r,t,'"glyphs" url must include a "{fontstack}" token')),t.indexOf("{range}")===-1&&c.push(new $e(r,t,'"glyphs" url must include a "{range}" token'))),c}function Zr(i,t=Z){let r=[];return r=r.concat(Yo({key:"",value:i,valueSpec:t.$root,styleSpec:t,style:i,validateSpec:Yo,objectElementValidators:{glyphs:dh,"*":()=>[]}})),i.constants&&(r=r.concat(rh({key:"constants",value:i.constants,style:i,styleSpec:t,validateSpec:Yo}))),Jo(r)}function br(i){return function(t){return i({...t,validateSpec:Yo})}}function Jo(i){return[].concat(i).sort((t,r)=>t.line-r.line)}function ci(i){return function(...t){return Jo(i.apply(this,t))}}Zr.source=ci(br(Wa)),Zr.sprite=ci(br(uh)),Zr.glyphs=ci(br(dh)),Zr.light=ci(br(ch)),Zr.terrain=ci(br(Ko)),Zr.layer=ci(br(Za)),Zr.filter=ci(br(yo)),Zr.paintProperty=ci(br(xc)),Zr.layoutProperty=ci(br(lh));const Es=Zr,yf=Es.light,_f=Es.paintProperty,vf=Es.layoutProperty;function _o(i,t){let r=!1;if(t&&t.length)for(const c of t)i.fire(new K(new Error(c.message))),r=!0;return r}class Qo{constructor(t,r,c){const f=this.cells=[];if(t instanceof ArrayBuffer){this.arrayBuffer=t;const y=new Int32Array(this.arrayBuffer);t=y[0],this.d=(r=y[1])+2*(c=y[2]);for(let S=0;S<this.d*this.d;S++){const P=y[3+S],D=y[3+S+1];f.push(P===D?null:y.subarray(P,D))}const b=y[3+f.length+1];this.keys=y.subarray(y[3+f.length],b),this.bboxes=y.subarray(b),this.insert=this._insertReadonly}else{this.d=r+2*c;for(let y=0;y<this.d*this.d;y++)f.push([]);this.keys=[],this.bboxes=[]}this.n=r,this.extent=t,this.padding=c,this.scale=r/t,this.uid=0;const g=c/r*t;this.min=-g,this.max=t+g}insert(t,r,c,f,g){this._forEachCell(r,c,f,g,this._insertCell,this.uid++,void 0,void 0),this.keys.push(t),this.bboxes.push(r),this.bboxes.push(c),this.bboxes.push(f),this.bboxes.push(g)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(t,r,c,f,g,y){this.cells[g].push(y)}query(t,r,c,f,g){const y=this.min,b=this.max;if(t<=y&&r<=y&&b<=c&&b<=f&&!g)return Array.prototype.slice.call(this.keys);{const S=[];return this._forEachCell(t,r,c,f,this._queryCell,S,{},g),S}}_queryCell(t,r,c,f,g,y,b,S){const P=this.cells[g];if(P!==null){const D=this.keys,R=this.bboxes;for(let O=0;O<P.length;O++){const $=P[O];if(b[$]===void 0){const N=4*$;(S?S(R[N+0],R[N+1],R[N+2],R[N+3]):t<=R[N+2]&&r<=R[N+3]&&c>=R[N+0]&&f>=R[N+1])?(b[$]=!0,y.push(D[$])):b[$]=!1}}}}_forEachCell(t,r,c,f,g,y,b,S){const P=this._convertToCellCoord(t),D=this._convertToCellCoord(r),R=this._convertToCellCoord(c),O=this._convertToCellCoord(f);for(let $=P;$<=R;$++)for(let N=D;N<=O;N++){const ee=this.d*N+$;if((!S||S(this._convertFromCellCoord($),this._convertFromCellCoord(N),this._convertFromCellCoord($+1),this._convertFromCellCoord(N+1)))&&g.call(this,t,r,c,f,ee,y,b,S))return}}_convertFromCellCoord(t){return(t-this.padding)/this.scale}_convertToCellCoord(t){return Math.max(0,Math.min(this.d-1,Math.floor(t*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;const t=this.cells,r=3+this.cells.length+1+1;let c=0;for(let y=0;y<this.cells.length;y++)c+=this.cells[y].length;const f=new Int32Array(r+c+this.keys.length+this.bboxes.length);f[0]=this.extent,f[1]=this.n,f[2]=this.padding;let g=r;for(let y=0;y<t.length;y++){const b=t[y];f[3+y]=g,f.set(b,g),g+=b.length}return f[3+t.length]=g,f.set(this.keys,g),g+=this.keys.length,f[3+t.length+1]=g,f.set(this.bboxes,g),g+=this.bboxes.length,f.buffer}static serialize(t,r){const c=t.toArrayBuffer();return r&&r.push(c),{buffer:c}}static deserialize(t){return new Qo(t.buffer)}}const Gr={};function Et(i,t,r={}){if(Gr[i])throw new Error(`${i} is already registered.`);Object.defineProperty(t,"_classRegistryKey",{value:i,writeable:!1}),Gr[i]={klass:t,omit:r.omit||[],shallow:r.shallow||[]}}Et("Object",Object),Et("TransferableGridIndex",Qo),Et("Color",Ht),Et("Error",Error),Et("AJAXError",rt),Et("ResolvedImage",_r),Et("StylePropertyFunction",Bn),Et("StyleExpression",fc,{omit:["_evaluator"]}),Et("ZoomDependentExpression",cn),Et("ZoomConstantExpression",pc),Et("CompoundExpression",vr,{omit:["_evaluate"]});for(const i in fo)fo[i]._classRegistryKey||Et(`Expression_${i}`,fo[i]);function Ha(i){return i&&typeof ArrayBuffer<"u"&&(i instanceof ArrayBuffer||i.constructor&&i.constructor.name==="ArrayBuffer")}function ea(i,t){if(i==null||typeof i=="boolean"||typeof i=="number"||typeof i=="string"||i instanceof Boolean||i instanceof Number||i instanceof String||i instanceof Date||i instanceof RegExp||i instanceof Blob)return i;if(Ha(i)||at(i))return t&&t.push(i),i;if(ArrayBuffer.isView(i)){const r=i;return t&&t.push(r.buffer),r}if(i instanceof ImageData)return t&&t.push(i.data.buffer),i;if(Array.isArray(i)){const r=[];for(const c of i)r.push(ea(c,t));return r}if(typeof i=="object"){const r=i.constructor,c=r._classRegistryKey;if(!c)throw new Error("can't serialize object of unregistered class");if(!Gr[c])throw new Error(`${c} is not registered.`);const f=r.serialize?r.serialize(i,t):{};if(r.serialize){if(t&&f===t[t.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(const g in i){if(!i.hasOwnProperty(g)||Gr[c].omit.indexOf(g)>=0)continue;const y=i[g];f[g]=Gr[c].shallow.indexOf(g)>=0?y:ea(y,t)}i instanceof Error&&(f.message=i.message)}if(f.$name)throw new Error("$name property is reserved for worker serialization logic.");return c!=="Object"&&(f.$name=c),f}throw new Error("can't serialize object of type "+typeof i)}function as(i){if(i==null||typeof i=="boolean"||typeof i=="number"||typeof i=="string"||i instanceof Boolean||i instanceof Number||i instanceof String||i instanceof Date||i instanceof RegExp||i instanceof Blob||Ha(i)||at(i)||ArrayBuffer.isView(i)||i instanceof ImageData)return i;if(Array.isArray(i))return i.map(as);if(typeof i=="object"){const t=i.$name||"Object";if(!Gr[t])throw new Error(`can't deserialize unregistered class ${t}`);const{klass:r}=Gr[t];if(!r)throw new Error(`can't deserialize unregistered class ${t}`);if(r.deserialize)return r.deserialize(i);const c=Object.create(r.prototype);for(const f of Object.keys(i)){if(f==="$name")continue;const g=i[f];c[f]=Gr[t].shallow.indexOf(f)>=0?g:as(g)}return c}throw new Error("can't deserialize object of type "+typeof i)}class fh{constructor(){this.first=!0}update(t,r){const c=Math.floor(t);return this.first?(this.first=!1,this.lastIntegerZoom=c,this.lastIntegerZoomTime=0,this.lastZoom=t,this.lastFloorZoom=c,!0):(this.lastFloorZoom>c?(this.lastIntegerZoom=c+1,this.lastIntegerZoomTime=r):this.lastFloorZoom<c&&(this.lastIntegerZoom=c,this.lastIntegerZoomTime=r),t!==this.lastZoom&&(this.lastZoom=t,this.lastFloorZoom=c,!0))}}const yt={"Latin-1 Supplement":i=>i>=128&&i<=255,Arabic:i=>i>=1536&&i<=1791,"Arabic Supplement":i=>i>=1872&&i<=1919,"Arabic Extended-A":i=>i>=2208&&i<=2303,"Hangul Jamo":i=>i>=4352&&i<=4607,"Unified Canadian Aboriginal Syllabics":i=>i>=5120&&i<=5759,Khmer:i=>i>=6016&&i<=6143,"Unified Canadian Aboriginal Syllabics Extended":i=>i>=6320&&i<=6399,"General Punctuation":i=>i>=8192&&i<=8303,"Letterlike Symbols":i=>i>=8448&&i<=8527,"Number Forms":i=>i>=8528&&i<=8591,"Miscellaneous Technical":i=>i>=8960&&i<=9215,"Control Pictures":i=>i>=9216&&i<=9279,"Optical Character Recognition":i=>i>=9280&&i<=9311,"Enclosed Alphanumerics":i=>i>=9312&&i<=9471,"Geometric Shapes":i=>i>=9632&&i<=9727,"Miscellaneous Symbols":i=>i>=9728&&i<=9983,"Miscellaneous Symbols and Arrows":i=>i>=11008&&i<=11263,"CJK Radicals Supplement":i=>i>=11904&&i<=12031,"Kangxi Radicals":i=>i>=12032&&i<=12255,"Ideographic Description Characters":i=>i>=12272&&i<=12287,"CJK Symbols and Punctuation":i=>i>=12288&&i<=12351,Hiragana:i=>i>=12352&&i<=12447,Katakana:i=>i>=12448&&i<=12543,Bopomofo:i=>i>=12544&&i<=12591,"Hangul Compatibility Jamo":i=>i>=12592&&i<=12687,Kanbun:i=>i>=12688&&i<=12703,"Bopomofo Extended":i=>i>=12704&&i<=12735,"CJK Strokes":i=>i>=12736&&i<=12783,"Katakana Phonetic Extensions":i=>i>=12784&&i<=12799,"Enclosed CJK Letters and Months":i=>i>=12800&&i<=13055,"CJK Compatibility":i=>i>=13056&&i<=13311,"CJK Unified Ideographs Extension A":i=>i>=13312&&i<=19903,"Yijing Hexagram Symbols":i=>i>=19904&&i<=19967,"CJK Unified Ideographs":i=>i>=19968&&i<=40959,"Yi Syllables":i=>i>=40960&&i<=42127,"Yi Radicals":i=>i>=42128&&i<=42191,"Hangul Jamo Extended-A":i=>i>=43360&&i<=43391,"Hangul Syllables":i=>i>=44032&&i<=55215,"Hangul Jamo Extended-B":i=>i>=55216&&i<=55295,"Private Use Area":i=>i>=57344&&i<=63743,"CJK Compatibility Ideographs":i=>i>=63744&&i<=64255,"Arabic Presentation Forms-A":i=>i>=64336&&i<=65023,"Vertical Forms":i=>i>=65040&&i<=65055,"CJK Compatibility Forms":i=>i>=65072&&i<=65103,"Small Form Variants":i=>i>=65104&&i<=65135,"Arabic Presentation Forms-B":i=>i>=65136&&i<=65279,"Halfwidth and Fullwidth Forms":i=>i>=65280&&i<=65519};function Xa(i){for(const t of i)if(Ka(t.charCodeAt(0)))return!0;return!1}function bc(i){for(const t of i)if(!ph(t.charCodeAt(0)))return!1;return!0}function ph(i){return!(yt.Arabic(i)||yt["Arabic Supplement"](i)||yt["Arabic Extended-A"](i)||yt["Arabic Presentation Forms-A"](i)||yt["Arabic Presentation Forms-B"](i))}function Ka(i){return!(i!==746&&i!==747&&(i<4352||!(yt["Bopomofo Extended"](i)||yt.Bopomofo(i)||yt["CJK Compatibility Forms"](i)&&!(i>=65097&&i<=65103)||yt["CJK Compatibility Ideographs"](i)||yt["CJK Compatibility"](i)||yt["CJK Radicals Supplement"](i)||yt["CJK Strokes"](i)||!(!yt["CJK Symbols and Punctuation"](i)||i>=12296&&i<=12305||i>=12308&&i<=12319||i===12336)||yt["CJK Unified Ideographs Extension A"](i)||yt["CJK Unified Ideographs"](i)||yt["Enclosed CJK Letters and Months"](i)||yt["Hangul Compatibility Jamo"](i)||yt["Hangul Jamo Extended-A"](i)||yt["Hangul Jamo Extended-B"](i)||yt["Hangul Jamo"](i)||yt["Hangul Syllables"](i)||yt.Hiragana(i)||yt["Ideographic Description Characters"](i)||yt.Kanbun(i)||yt["Kangxi Radicals"](i)||yt["Katakana Phonetic Extensions"](i)||yt.Katakana(i)&&i!==12540||!(!yt["Halfwidth and Fullwidth Forms"](i)||i===65288||i===65289||i===65293||i>=65306&&i<=65310||i===65339||i===65341||i===65343||i>=65371&&i<=65503||i===65507||i>=65512&&i<=65519)||!(!yt["Small Form Variants"](i)||i>=65112&&i<=65118||i>=65123&&i<=65126)||yt["Unified Canadian Aboriginal Syllabics"](i)||yt["Unified Canadian Aboriginal Syllabics Extended"](i)||yt["Vertical Forms"](i)||yt["Yijing Hexagram Symbols"](i)||yt["Yi Syllables"](i)||yt["Yi Radicals"](i))))}function mh(i){return!(Ka(i)||function(t){return!!(yt["Latin-1 Supplement"](t)&&(t===167||t===169||t===174||t===177||t===188||t===189||t===190||t===215||t===247)||yt["General Punctuation"](t)&&(t===8214||t===8224||t===8225||t===8240||t===8241||t===8251||t===8252||t===8258||t===8263||t===8264||t===8265||t===8273)||yt["Letterlike Symbols"](t)||yt["Number Forms"](t)||yt["Miscellaneous Technical"](t)&&(t>=8960&&t<=8967||t>=8972&&t<=8991||t>=8996&&t<=9e3||t===9003||t>=9085&&t<=9114||t>=9150&&t<=9165||t===9167||t>=9169&&t<=9179||t>=9186&&t<=9215)||yt["Control Pictures"](t)&&t!==9251||yt["Optical Character Recognition"](t)||yt["Enclosed Alphanumerics"](t)||yt["Geometric Shapes"](t)||yt["Miscellaneous Symbols"](t)&&!(t>=9754&&t<=9759)||yt["Miscellaneous Symbols and Arrows"](t)&&(t>=11026&&t<=11055||t>=11088&&t<=11097||t>=11192&&t<=11243)||yt["CJK Symbols and Punctuation"](t)||yt.Katakana(t)||yt["Private Use Area"](t)||yt["CJK Compatibility Forms"](t)||yt["Small Form Variants"](t)||yt["Halfwidth and Fullwidth Forms"](t)||t===8734||t===8756||t===8757||t>=9984&&t<=10087||t>=10102&&t<=10131||t===65532||t===65533)}(i))}function Ya(i){return i>=1424&&i<=2303||yt["Arabic Presentation Forms-A"](i)||yt["Arabic Presentation Forms-B"](i)}function Ja(i,t){return!(!t&&Ya(i)||i>=2304&&i<=3583||i>=3840&&i<=4255||yt.Khmer(i))}function gh(i){for(const t of i)if(Ya(t.charCodeAt(0)))return!0;return!1}const wc="deferred",Qa="loading",Sc="loaded";let ta=null,Hi="unavailable",Ts=null;const yh=function(i){i&&typeof i=="string"&&i.indexOf("NetworkError")>-1&&(Hi="error"),ta&&ta(i)};function Cc(){el.fire(new wt("pluginStateChange",{pluginStatus:Hi,pluginURL:Ts}))}const el=new ne,Ec=function(){return Hi},_h=function(){if(Hi!==wc||!Ts)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");Hi=Qa,Cc(),Ts&&Ae({url:Ts},i=>{i?yh(i):(Hi=Sc,Cc())})},wr={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>Hi===Sc||wr.applyArabicShaping!=null,isLoading:()=>Hi===Qa,setState(i){if(!_e())throw new Error("Cannot set the state of the rtl-text-plugin when not in the web-worker context");Hi=i.pluginStatus,Ts=i.pluginURL},isParsed(){if(!_e())throw new Error("rtl-text-plugin is only parsed on the worker-threads");return wr.applyArabicShaping!=null&&wr.processBidirectionalText!=null&&wr.processStyledBidirectionalText!=null},getPluginURL(){if(!_e())throw new Error("rtl-text-plugin url can only be queried from the worker threads");return Ts}};class Un{constructor(t,r){this.zoom=t,r?(this.now=r.now,this.fadeDuration=r.fadeDuration,this.zoomHistory=r.zoomHistory,this.transition=r.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new fh,this.transition={})}isSupportedScript(t){return function(r,c){for(const f of r)if(!Ja(f.charCodeAt(0),c))return!1;return!0}(t,wr.isLoaded())}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const t=this.zoom,r=t-Math.floor(t),c=this.crossFadingFactor();return t>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:r+(1-r)*c}:{fromScale:.5,toScale:1,t:1-(1-c)*r}}}class tl{constructor(t,r){this.property=t,this.value=r,this.expression=function(c,f){if($a(c))return new Bn(c,f);if(Ua(c)){const g=Na(c,f);if(g.result==="error")throw new Error(g.value.map(y=>`${y.key}: ${y.message}`).join(", "));return g.value}{let g=c;return f.type==="color"&&typeof c=="string"?g=Ht.parse(c):f.type!=="padding"||typeof c!="number"&&!Array.isArray(c)||(g=tr.parse(c)),{kind:"constant",evaluate:()=>g}}}(r===void 0?t.specification.default:r,t.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(t,r,c){return this.property.possiblyEvaluate(this,t,r,c)}}class Tc{constructor(t){this.property=t,this.value=new tl(t,void 0)}transitioned(t,r){return new na(this.property,this.value,r,be({},t.transition,this.transition),t.now)}untransitioned(){return new na(this.property,this.value,null,{},0)}}class vh{constructor(t){this._properties=t,this._values=Object.create(t.defaultTransitionablePropertyValues)}getValue(t){return j(this._values[t].value.value)}setValue(t,r){Object.prototype.hasOwnProperty.call(this._values,t)||(this._values[t]=new Tc(this._values[t].property)),this._values[t].value=new tl(this._values[t].property,r===null?void 0:j(r))}getTransition(t){return j(this._values[t].transition)}setTransition(t,r){Object.prototype.hasOwnProperty.call(this._values,t)||(this._values[t]=new Tc(this._values[t].property)),this._values[t].transition=j(r)||void 0}serialize(){const t={};for(const r of Object.keys(this._values)){const c=this.getValue(r);c!==void 0&&(t[r]=c);const f=this.getTransition(r);f!==void 0&&(t[`${r}-transition`]=f)}return t}transitioned(t,r){const c=new xh(this._properties);for(const f of Object.keys(this._values))c._values[f]=this._values[f].transitioned(t,r._values[f]);return c}untransitioned(){const t=new xh(this._properties);for(const r of Object.keys(this._values))t._values[r]=this._values[r].untransitioned();return t}}class na{constructor(t,r,c,f,g){this.property=t,this.value=r,this.begin=g+f.delay||0,this.end=this.begin+f.duration||0,t.specification.transition&&(f.delay||f.duration)&&(this.prior=c)}possiblyEvaluate(t,r,c){const f=t.now||0,g=this.value.possiblyEvaluate(t,r,c),y=this.prior;if(y){if(f>this.end)return this.prior=null,g;if(this.value.isDataDriven())return this.prior=null,g;if(f<this.begin)return y.possiblyEvaluate(t,r,c);{const b=(f-this.begin)/(this.end-this.begin);return this.property.interpolate(y.possiblyEvaluate(t,r,c),g,function(S){if(S<=0)return 0;if(S>=1)return 1;const P=S*S,D=P*S;return 4*(S<.5?D:3*(S-P)+D-.75)}(b))}}return g}}class xh{constructor(t){this._properties=t,this._values=Object.create(t.defaultTransitioningPropertyValues)}possiblyEvaluate(t,r,c){const f=new nl(this._properties);for(const g of Object.keys(this._values))f._values[g]=this._values[g].possiblyEvaluate(t,r,c);return f}hasTransition(){for(const t of Object.keys(this._values))if(this._values[t].prior)return!0;return!1}}class Ic{constructor(t){this._properties=t,this._values=Object.create(t.defaultPropertyValues)}getValue(t){return j(this._values[t].value)}setValue(t,r){this._values[t]=new tl(this._values[t].property,r===null?void 0:j(r))}serialize(){const t={};for(const r of Object.keys(this._values)){const c=this.getValue(r);c!==void 0&&(t[r]=c)}return t}possiblyEvaluate(t,r,c){const f=new nl(this._properties);for(const g of Object.keys(this._values))f._values[g]=this._values[g].possiblyEvaluate(t,r,c);return f}}class Wr{constructor(t,r,c){this.property=t,this.value=r,this.parameters=c}isConstant(){return this.value.kind==="constant"}constantOr(t){return this.value.kind==="constant"?this.value.value:t}evaluate(t,r,c,f){return this.property.evaluate(this.value,this.parameters,t,r,c,f)}}class nl{constructor(t){this._properties=t,this._values=Object.create(t.defaultPossiblyEvaluatedValues)}get(t){return this._values[t]}}class zt{constructor(t){this.specification=t}possiblyEvaluate(t,r){if(t.isDataDriven())throw new Error("Value should not be data driven");return t.expression.evaluate(r)}interpolate(t,r,c){const f=nr[this.specification.type];return f?f(t,r,c):t}}class qt{constructor(t,r){this.specification=t,this.overrides=r}possiblyEvaluate(t,r,c,f){return new Wr(this,t.expression.kind==="constant"||t.expression.kind==="camera"?{kind:"constant",value:t.expression.evaluate(r,null,{},c,f)}:t.expression,r)}interpolate(t,r,c){if(t.value.kind!=="constant"||r.value.kind!=="constant")return t;if(t.value.value===void 0||r.value.value===void 0)return new Wr(this,{kind:"constant",value:void 0},t.parameters);const f=nr[this.specification.type];if(f){const g=f(t.value.value,r.value.value,c);return new Wr(this,{kind:"constant",value:g},t.parameters)}return t}evaluate(t,r,c,f,g,y){return t.kind==="constant"?t.value:t.evaluate(r,c,f,g,y)}}class ia extends qt{possiblyEvaluate(t,r,c,f){if(t.value===void 0)return new Wr(this,{kind:"constant",value:void 0},r);if(t.expression.kind==="constant"){const g=t.expression.evaluate(r,null,{},c,f),y=t.property.specification.type==="resolvedImage"&&typeof g!="string"?g.name:g,b=this._calculate(y,y,y,r);return new Wr(this,{kind:"constant",value:b},r)}if(t.expression.kind==="camera"){const g=this._calculate(t.expression.evaluate({zoom:r.zoom-1}),t.expression.evaluate({zoom:r.zoom}),t.expression.evaluate({zoom:r.zoom+1}),r);return new Wr(this,{kind:"constant",value:g},r)}return new Wr(this,t.expression,r)}evaluate(t,r,c,f,g,y){if(t.kind==="source"){const b=t.evaluate(r,c,f,g,y);return this._calculate(b,b,b,r)}return t.kind==="composite"?this._calculate(t.evaluate({zoom:Math.floor(r.zoom)-1},c,f),t.evaluate({zoom:Math.floor(r.zoom)},c,f),t.evaluate({zoom:Math.floor(r.zoom)+1},c,f),r):t.value}_calculate(t,r,c,f){return f.zoom>f.zoomHistory.lastIntegerZoom?{from:t,to:r}:{from:c,to:r}}interpolate(t){return t}}class Ac{constructor(t){this.specification=t}possiblyEvaluate(t,r,c,f){if(t.value!==void 0){if(t.expression.kind==="constant"){const g=t.expression.evaluate(r,null,{},c,f);return this._calculate(g,g,g,r)}return this._calculate(t.expression.evaluate(new Un(Math.floor(r.zoom-1),r)),t.expression.evaluate(new Un(Math.floor(r.zoom),r)),t.expression.evaluate(new Un(Math.floor(r.zoom+1),r)),r)}}_calculate(t,r,c,f){return f.zoom>f.zoomHistory.lastIntegerZoom?{from:t,to:r}:{from:c,to:r}}interpolate(t){return t}}class Pc{constructor(t){this.specification=t}possiblyEvaluate(t,r,c,f){return!!t.expression.evaluate(r,null,{},c,f)}interpolate(){return!1}}class Xi{constructor(t){this.properties=t,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const r in t){const c=t[r];c.specification.overridable&&this.overridableProperties.push(r);const f=this.defaultPropertyValues[r]=new tl(c,void 0),g=this.defaultTransitionablePropertyValues[r]=new Tc(c);this.defaultTransitioningPropertyValues[r]=g.untransitioned(),this.defaultPossiblyEvaluatedValues[r]=f.possiblyEvaluate({})}}}Et("DataDrivenProperty",qt),Et("DataConstantProperty",zt),Et("CrossFadedDataDrivenProperty",ia),Et("CrossFadedProperty",Ac),Et("ColorRampProperty",Pc);const bh="-transition";class Hr extends ne{constructor(t,r){if(super(),this.id=t.id,this.type=t.type,this._featureFilter={filter:()=>!0,needGeometry:!1},t.type!=="custom"&&(this.metadata=t.metadata,this.minzoom=t.minzoom,this.maxzoom=t.maxzoom,t.type!=="background"&&(this.source=t.source,this.sourceLayer=t["source-layer"],this.filter=t.filter),r.layout&&(this._unevaluatedLayout=new Ic(r.layout)),r.paint)){this._transitionablePaint=new vh(r.paint);for(const c in t.paint)this.setPaintProperty(c,t.paint[c],{validate:!1});for(const c in t.layout)this.setLayoutProperty(c,t.layout[c],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new nl(r.paint)}}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(t){return t==="visibility"?this.visibility:this._unevaluatedLayout.getValue(t)}setLayoutProperty(t,r,c={}){r!=null&&this._validate(vf,`layers.${this.id}.layout.${t}`,t,r,c)||(t!=="visibility"?this._unevaluatedLayout.setValue(t,r):this.visibility=r)}getPaintProperty(t){return t.endsWith(bh)?this._transitionablePaint.getTransition(t.slice(0,-11)):this._transitionablePaint.getValue(t)}setPaintProperty(t,r,c={}){if(r!=null&&this._validate(_f,`layers.${this.id}.paint.${t}`,t,r,c))return!1;if(t.endsWith(bh))return this._transitionablePaint.setTransition(t.slice(0,-11),r||void 0),!1;{const f=this._transitionablePaint._values[t],g=f.property.specification["property-type"]==="cross-faded-data-driven",y=f.value.isDataDriven(),b=f.value;this._transitionablePaint.setValue(t,r),this._handleSpecialPaintPropertyUpdate(t);const S=this._transitionablePaint._values[t].value;return S.isDataDriven()||y||g||this._handleOverridablePaintPropertyUpdate(t,b,S)}}_handleSpecialPaintPropertyUpdate(t){}_handleOverridablePaintPropertyUpdate(t,r,c){return!1}isHidden(t){return!!(this.minzoom&&t<this.minzoom)||!!(this.maxzoom&&t>=this.maxzoom)||this.visibility==="none"}updateTransitions(t){this._transitioningPaint=this._transitionablePaint.transitioned(t,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(t,r){t.getCrossfadeParameters&&(this._crossfadeParameters=t.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(t,void 0,r)),this.paint=this._transitioningPaint.possiblyEvaluate(t,void 0,r)}serialize(){const t={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(t.layout=t.layout||{},t.layout.visibility=this.visibility),ze(t,(r,c)=>!(r===void 0||c==="layout"&&!Object.keys(r).length||c==="paint"&&!Object.keys(r).length))}_validate(t,r,c,f,g={}){return(!g||g.validate!==!1)&&_o(this,t.call(Es,{key:r,layerType:this.type,objectKey:c,value:f,styleSpec:Z,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const t in this.paint._values){const r=this.paint.get(t);if(r instanceof Wr&&mo(r.property.specification)&&(r.value.kind==="source"||r.value.kind==="composite")&&r.value.isStateDependent)return!0}return!1}}const xf={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class ls{constructor(t,r){this._structArray=t,this._pos1=r*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class Yn{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(t,r){return t._trim(),r&&(t.isTransferred=!0,r.push(t.arrayBuffer)),{length:t.length,arrayBuffer:t.arrayBuffer}}static deserialize(t){const r=Object.create(this.prototype);return r.arrayBuffer=t.arrayBuffer,r.length=t.length,r.capacity=t.arrayBuffer.byteLength/r.bytesPerElement,r._refreshViews(),r}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(t){this.reserve(t),this.length=t}reserve(t){if(t>this.capacity){this.capacity=Math.max(t,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const r=this.uint8;this._refreshViews(),r&&this.uint8.set(r)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function ui(i,t=1){let r=0,c=0;return{members:i.map(f=>{const g=xf[f.type].BYTES_PER_ELEMENT,y=r=wh(r,Math.max(t,g)),b=f.components||1;return c=Math.max(c,g),r+=g*b,{name:f.name,type:f.type,components:b,offset:y}}),size:wh(r,Math.max(c,t)),alignment:t}}function wh(i,t){return Math.ceil(i/t)*t}class vo extends Yn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,r){const c=this.length;return this.resize(c+1),this.emplace(c,t,r)}emplace(t,r,c){const f=2*t;return this.int16[f+0]=r,this.int16[f+1]=c,t}}vo.prototype.bytesPerElement=4,Et("StructArrayLayout2i4",vo);class il extends Yn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,r,c){const f=this.length;return this.resize(f+1),this.emplace(f,t,r,c)}emplace(t,r,c,f){const g=3*t;return this.int16[g+0]=r,this.int16[g+1]=c,this.int16[g+2]=f,t}}il.prototype.bytesPerElement=6,Et("StructArrayLayout3i6",il);class kc extends Yn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,r,c,f){const g=this.length;return this.resize(g+1),this.emplace(g,t,r,c,f)}emplace(t,r,c,f,g){const y=4*t;return this.int16[y+0]=r,this.int16[y+1]=c,this.int16[y+2]=f,this.int16[y+3]=g,t}}kc.prototype.bytesPerElement=8,Et("StructArrayLayout4i8",kc);class Xr extends Yn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,r,c,f,g,y){const b=this.length;return this.resize(b+1),this.emplace(b,t,r,c,f,g,y)}emplace(t,r,c,f,g,y,b){const S=6*t;return this.int16[S+0]=r,this.int16[S+1]=c,this.int16[S+2]=f,this.int16[S+3]=g,this.int16[S+4]=y,this.int16[S+5]=b,t}}Xr.prototype.bytesPerElement=12,Et("StructArrayLayout2i4i12",Xr);class rl extends Yn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,r,c,f,g,y){const b=this.length;return this.resize(b+1),this.emplace(b,t,r,c,f,g,y)}emplace(t,r,c,f,g,y,b){const S=4*t,P=8*t;return this.int16[S+0]=r,this.int16[S+1]=c,this.uint8[P+4]=f,this.uint8[P+5]=g,this.uint8[P+6]=y,this.uint8[P+7]=b,t}}rl.prototype.bytesPerElement=8,Et("StructArrayLayout2i4ub8",rl);class js extends Yn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,r){const c=this.length;return this.resize(c+1),this.emplace(c,t,r)}emplace(t,r,c){const f=2*t;return this.float32[f+0]=r,this.float32[f+1]=c,t}}js.prototype.bytesPerElement=8,Et("StructArrayLayout2f8",js);class sl extends Yn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,r,c,f,g,y,b,S,P,D){const R=this.length;return this.resize(R+1),this.emplace(R,t,r,c,f,g,y,b,S,P,D)}emplace(t,r,c,f,g,y,b,S,P,D,R){const O=10*t;return this.uint16[O+0]=r,this.uint16[O+1]=c,this.uint16[O+2]=f,this.uint16[O+3]=g,this.uint16[O+4]=y,this.uint16[O+5]=b,this.uint16[O+6]=S,this.uint16[O+7]=P,this.uint16[O+8]=D,this.uint16[O+9]=R,t}}sl.prototype.bytesPerElement=20,Et("StructArrayLayout10ui20",sl);class ra extends Yn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,r,c,f,g,y,b,S,P,D,R,O){const $=this.length;return this.resize($+1),this.emplace($,t,r,c,f,g,y,b,S,P,D,R,O)}emplace(t,r,c,f,g,y,b,S,P,D,R,O,$){const N=12*t;return this.int16[N+0]=r,this.int16[N+1]=c,this.int16[N+2]=f,this.int16[N+3]=g,this.uint16[N+4]=y,this.uint16[N+5]=b,this.uint16[N+6]=S,this.uint16[N+7]=P,this.int16[N+8]=D,this.int16[N+9]=R,this.int16[N+10]=O,this.int16[N+11]=$,t}}ra.prototype.bytesPerElement=24,Et("StructArrayLayout4i4ui4i24",ra);class Mc extends Yn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,r,c){const f=this.length;return this.resize(f+1),this.emplace(f,t,r,c)}emplace(t,r,c,f){const g=3*t;return this.float32[g+0]=r,this.float32[g+1]=c,this.float32[g+2]=f,t}}Mc.prototype.bytesPerElement=12,Et("StructArrayLayout3f12",Mc);class xo extends Yn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(t){const r=this.length;return this.resize(r+1),this.emplace(r,t)}emplace(t,r){return this.uint32[1*t+0]=r,t}}xo.prototype.bytesPerElement=4,Et("StructArrayLayout1ul4",xo);class qs extends Yn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,r,c,f,g,y,b,S,P){const D=this.length;return this.resize(D+1),this.emplace(D,t,r,c,f,g,y,b,S,P)}emplace(t,r,c,f,g,y,b,S,P,D){const R=10*t,O=5*t;return this.int16[R+0]=r,this.int16[R+1]=c,this.int16[R+2]=f,this.int16[R+3]=g,this.int16[R+4]=y,this.int16[R+5]=b,this.uint32[O+3]=S,this.uint16[R+8]=P,this.uint16[R+9]=D,t}}qs.prototype.bytesPerElement=20,Et("StructArrayLayout6i1ul2ui20",qs);class Dc extends Yn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,r,c,f,g,y){const b=this.length;return this.resize(b+1),this.emplace(b,t,r,c,f,g,y)}emplace(t,r,c,f,g,y,b){const S=6*t;return this.int16[S+0]=r,this.int16[S+1]=c,this.int16[S+2]=f,this.int16[S+3]=g,this.int16[S+4]=y,this.int16[S+5]=b,t}}Dc.prototype.bytesPerElement=12,Et("StructArrayLayout2i2i2i12",Dc);class ol extends Yn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,r,c,f,g){const y=this.length;return this.resize(y+1),this.emplace(y,t,r,c,f,g)}emplace(t,r,c,f,g,y){const b=4*t,S=8*t;return this.float32[b+0]=r,this.float32[b+1]=c,this.float32[b+2]=f,this.int16[S+6]=g,this.int16[S+7]=y,t}}ol.prototype.bytesPerElement=16,Et("StructArrayLayout2f1f2i16",ol);class Zs extends Yn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,r,c,f){const g=this.length;return this.resize(g+1),this.emplace(g,t,r,c,f)}emplace(t,r,c,f,g){const y=12*t,b=3*t;return this.uint8[y+0]=r,this.uint8[y+1]=c,this.float32[b+1]=f,this.float32[b+2]=g,t}}Zs.prototype.bytesPerElement=12,Et("StructArrayLayout2ub2f12",Zs);class al extends Yn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,r,c){const f=this.length;return this.resize(f+1),this.emplace(f,t,r,c)}emplace(t,r,c,f){const g=3*t;return this.uint16[g+0]=r,this.uint16[g+1]=c,this.uint16[g+2]=f,t}}al.prototype.bytesPerElement=6,Et("StructArrayLayout3ui6",al);class zc extends Yn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,r,c,f,g,y,b,S,P,D,R,O,$,N,ee,J,fe){const ve=this.length;return this.resize(ve+1),this.emplace(ve,t,r,c,f,g,y,b,S,P,D,R,O,$,N,ee,J,fe)}emplace(t,r,c,f,g,y,b,S,P,D,R,O,$,N,ee,J,fe,ve){const ue=24*t,Ie=12*t,Me=48*t;return this.int16[ue+0]=r,this.int16[ue+1]=c,this.uint16[ue+2]=f,this.uint16[ue+3]=g,this.uint32[Ie+2]=y,this.uint32[Ie+3]=b,this.uint32[Ie+4]=S,this.uint16[ue+10]=P,this.uint16[ue+11]=D,this.uint16[ue+12]=R,this.float32[Ie+7]=O,this.float32[Ie+8]=$,this.uint8[Me+36]=N,this.uint8[Me+37]=ee,this.uint8[Me+38]=J,this.uint32[Ie+10]=fe,this.int16[ue+22]=ve,t}}zc.prototype.bytesPerElement=48,Et("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",zc);class ll extends Yn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,r,c,f,g,y,b,S,P,D,R,O,$,N,ee,J,fe,ve,ue,Ie,Me,qe,Ct,kt,_t,mt,dt,vt){const gt=this.length;return this.resize(gt+1),this.emplace(gt,t,r,c,f,g,y,b,S,P,D,R,O,$,N,ee,J,fe,ve,ue,Ie,Me,qe,Ct,kt,_t,mt,dt,vt)}emplace(t,r,c,f,g,y,b,S,P,D,R,O,$,N,ee,J,fe,ve,ue,Ie,Me,qe,Ct,kt,_t,mt,dt,vt,gt){const st=34*t,Vt=17*t;return this.int16[st+0]=r,this.int16[st+1]=c,this.int16[st+2]=f,this.int16[st+3]=g,this.int16[st+4]=y,this.int16[st+5]=b,this.int16[st+6]=S,this.int16[st+7]=P,this.uint16[st+8]=D,this.uint16[st+9]=R,this.uint16[st+10]=O,this.uint16[st+11]=$,this.uint16[st+12]=N,this.uint16[st+13]=ee,this.uint16[st+14]=J,this.uint16[st+15]=fe,this.uint16[st+16]=ve,this.uint16[st+17]=ue,this.uint16[st+18]=Ie,this.uint16[st+19]=Me,this.uint16[st+20]=qe,this.uint16[st+21]=Ct,this.uint16[st+22]=kt,this.uint32[Vt+12]=_t,this.float32[Vt+13]=mt,this.float32[Vt+14]=dt,this.float32[Vt+15]=vt,this.float32[Vt+16]=gt,t}}ll.prototype.bytesPerElement=68,Et("StructArrayLayout8i15ui1ul4f68",ll);class cl extends Yn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t){const r=this.length;return this.resize(r+1),this.emplace(r,t)}emplace(t,r){return this.float32[1*t+0]=r,t}}cl.prototype.bytesPerElement=4,Et("StructArrayLayout1f4",cl);class ul extends Yn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,r,c){const f=this.length;return this.resize(f+1),this.emplace(f,t,r,c)}emplace(t,r,c,f){const g=4*t;return this.uint32[2*t+0]=r,this.uint16[g+2]=c,this.uint16[g+3]=f,t}}ul.prototype.bytesPerElement=8,Et("StructArrayLayout1ul2ui8",ul);class d extends Yn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,r){const c=this.length;return this.resize(c+1),this.emplace(c,t,r)}emplace(t,r,c){const f=2*t;return this.uint16[f+0]=r,this.uint16[f+1]=c,t}}d.prototype.bytesPerElement=4,Et("StructArrayLayout2ui4",d);class n extends Yn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t){const r=this.length;return this.resize(r+1),this.emplace(r,t)}emplace(t,r){return this.uint16[1*t+0]=r,t}}n.prototype.bytesPerElement=2,Et("StructArrayLayout1ui2",n);class o extends Yn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,r,c,f){const g=this.length;return this.resize(g+1),this.emplace(g,t,r,c,f)}emplace(t,r,c,f,g){const y=4*t;return this.float32[y+0]=r,this.float32[y+1]=c,this.float32[y+2]=f,this.float32[y+3]=g,t}}o.prototype.bytesPerElement=16,Et("StructArrayLayout4f16",o);class u extends ls{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new k(this.anchorPointX,this.anchorPointY)}}u.prototype.size=20;class p extends qs{get(t){return new u(this,t)}}Et("CollisionBoxArray",p);class v extends ls{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(t){this._structArray.uint8[this._pos1+37]=t}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(t){this._structArray.uint8[this._pos1+38]=t}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(t){this._structArray.uint32[this._pos4+10]=t}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}v.prototype.size=48;class w extends zc{get(t){return new v(this,t)}}Et("PlacedSymbolArray",w);class E extends ls{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(t){this._structArray.uint32[this._pos4+12]=t}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get textOffset0(){return this._structArray.float32[this._pos4+14]}get textOffset1(){return this._structArray.float32[this._pos4+15]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+16]}}E.prototype.size=68;class C extends ll{get(t){return new E(this,t)}}Et("SymbolInstanceArray",C);class A extends cl{getoffsetX(t){return this.float32[1*t+0]}}Et("GlyphOffsetArray",A);class L extends il{getx(t){return this.int16[3*t+0]}gety(t){return this.int16[3*t+1]}gettileUnitDistanceFromAnchor(t){return this.int16[3*t+2]}}Et("SymbolLineVertexArray",L);class z extends ls{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}z.prototype.size=8;class U extends ul{get(t){return new z(this,t)}}Et("FeatureIndexArray",U);class Q extends vo{}class H extends vo{}class Y extends vo{}class se extends Xr{}class de extends rl{}class Pe extends js{}class ie extends sl{}class Te extends ra{}class De extends Mc{}class Ye extends xo{}class it extends Dc{}class ct extends Zs{}class et extends al{}class bt extends d{}const Ot=ui([{name:"a_pos",components:2,type:"Int16"}],4),{members:Jt}=Ot;class pt{constructor(t=[]){this.segments=t}prepareSegment(t,r,c,f){let g=this.segments[this.segments.length-1];return t>pt.MAX_VERTEX_ARRAY_LENGTH&&pe(`Max vertices per segment is ${pt.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${t}`),(!g||g.vertexLength+t>pt.MAX_VERTEX_ARRAY_LENGTH||g.sortKey!==f)&&(g={vertexOffset:r.length,primitiveOffset:c.length,vertexLength:0,primitiveLength:0},f!==void 0&&(g.sortKey=f),this.segments.push(g)),g}get(){return this.segments}destroy(){for(const t of this.segments)for(const r in t.vaos)t.vaos[r].destroy()}static simpleSegment(t,r,c,f){return new pt([{vertexOffset:t,primitiveOffset:r,vertexLength:c,primitiveLength:f,vaos:{},sortKey:0}])}}function Zt(i,t){return 256*(i=ye(Math.floor(i),0,255))+ye(Math.floor(t),0,255)}pt.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Et("SegmentVector",pt);const St=ui([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]);var _n={exports:{}},ii={exports:{}};ii.exports=function(i,t){var r,c,f,g,y,b,S,P;for(c=i.length-(r=3&i.length),f=t,y=3432918353,b=461845907,P=0;P<c;)S=255&i.charCodeAt(P)|(255&i.charCodeAt(++P))<<8|(255&i.charCodeAt(++P))<<16|(255&i.charCodeAt(++P))<<24,++P,f=27492+(65535&(g=5*(65535&(f=(f^=S=(65535&(S=(S=(65535&S)*y+(((S>>>16)*y&65535)<<16)&4294967295)<<15|S>>>17))*b+(((S>>>16)*b&65535)<<16)&4294967295)<<13|f>>>19))+((5*(f>>>16)&65535)<<16)&4294967295))+((58964+(g>>>16)&65535)<<16);switch(S=0,r){case 3:S^=(255&i.charCodeAt(P+2))<<16;case 2:S^=(255&i.charCodeAt(P+1))<<8;case 1:f^=S=(65535&(S=(S=(65535&(S^=255&i.charCodeAt(P)))*y+(((S>>>16)*y&65535)<<16)&4294967295)<<15|S>>>17))*b+(((S>>>16)*b&65535)<<16)&4294967295}return f^=i.length,f=2246822507*(65535&(f^=f>>>16))+((2246822507*(f>>>16)&65535)<<16)&4294967295,f=3266489909*(65535&(f^=f>>>13))+((3266489909*(f>>>16)&65535)<<16)&4294967295,(f^=f>>>16)>>>0};var vn=ii.exports,tn={exports:{}};tn.exports=function(i,t){for(var r,c=i.length,f=t^c,g=0;c>=4;)r=1540483477*(65535&(r=255&i.charCodeAt(g)|(255&i.charCodeAt(++g))<<8|(255&i.charCodeAt(++g))<<16|(255&i.charCodeAt(++g))<<24))+((1540483477*(r>>>16)&65535)<<16),f=1540483477*(65535&f)+((1540483477*(f>>>16)&65535)<<16)^(r=1540483477*(65535&(r^=r>>>24))+((1540483477*(r>>>16)&65535)<<16)),c-=4,++g;switch(c){case 3:f^=(255&i.charCodeAt(g+2))<<16;case 2:f^=(255&i.charCodeAt(g+1))<<8;case 1:f=1540483477*(65535&(f^=255&i.charCodeAt(g)))+((1540483477*(f>>>16)&65535)<<16)}return f=1540483477*(65535&(f^=f>>>13))+((1540483477*(f>>>16)&65535)<<16),(f^=f>>>15)>>>0};var Jn=vn,$i=tn.exports;_n.exports=Jn,_n.exports.murmur3=Jn,_n.exports.murmur2=$i;var ri=I(_n.exports);class xi{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(t,r,c,f){this.ids.push(rr(t)),this.positions.push(r,c,f)}getPositions(t){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");const r=rr(t);let c=0,f=this.ids.length-1;for(;c<f;){const y=c+f>>1;this.ids[y]>=r?f=y:c=y+1}const g=[];for(;this.ids[c]===r;)g.push({index:this.positions[3*c],start:this.positions[3*c+1],end:this.positions[3*c+2]}),c++;return g}static serialize(t,r){const c=new Float64Array(t.ids),f=new Uint32Array(t.positions);return Dr(c,f,0,c.length-1),r&&r.push(c.buffer,f.buffer),{ids:c,positions:f}}static deserialize(t){const r=new xi;return r.ids=t.ids,r.positions=t.positions,r.indexed=!0,r}}function rr(i){const t=+i;return!isNaN(t)&&t<=Number.MAX_SAFE_INTEGER?t:ri(String(i))}function Dr(i,t,r,c){for(;r<c;){const f=i[r+c>>1];let g=r-1,y=c+1;for(;;){do g++;while(i[g]<f);do y--;while(i[y]>f);if(g>=y)break;zr(i,g,y),zr(t,3*g,3*y),zr(t,3*g+1,3*y+1),zr(t,3*g+2,3*y+2)}y-r<c-y?(Dr(i,t,r,y),r=y+1):(Dr(i,t,y+1,c),c=y)}}function zr(i,t,r){const c=i[t];i[t]=i[r],i[r]=c}Et("FeaturePositionMap",xi);class Ui{constructor(t,r){this.gl=t.gl,this.location=r}}class Kr extends Ui{constructor(t,r){super(t,r),this.current=0}set(t){this.current!==t&&(this.current=t,this.gl.uniform1f(this.location,t))}}class sa extends Ui{constructor(t,r){super(t,r),this.current=[0,0,0,0]}set(t){t[0]===this.current[0]&&t[1]===this.current[1]&&t[2]===this.current[2]&&t[3]===this.current[3]||(this.current=t,this.gl.uniform4f(this.location,t[0],t[1],t[2],t[3]))}}class Di extends Ui{constructor(t,r){super(t,r),this.current=Ht.transparent}set(t){t.r===this.current.r&&t.g===this.current.g&&t.b===this.current.b&&t.a===this.current.a||(this.current=t,this.gl.uniform4f(this.location,t.r,t.g,t.b,t.a))}}const bi=new Float32Array(16);function Cn(i){return[Zt(255*i.r,255*i.g),Zt(255*i.b,255*i.a)]}class mi{constructor(t,r,c){this.value=t,this.uniformNames=r.map(f=>`u_${f}`),this.type=c}setUniform(t,r,c){t.set(c.constantOr(this.value))}getBinding(t,r,c){return this.type==="color"?new Di(t,r):new Kr(t,r)}}class wi{constructor(t,r){this.uniformNames=r.map(c=>`u_${c}`),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(t,r){this.pixelRatioFrom=r.pixelRatio,this.pixelRatioTo=t.pixelRatio,this.patternFrom=r.tlbr,this.patternTo=t.tlbr}setUniform(t,r,c,f){const g=f==="u_pattern_to"?this.patternTo:f==="u_pattern_from"?this.patternFrom:f==="u_pixel_ratio_to"?this.pixelRatioTo:f==="u_pixel_ratio_from"?this.pixelRatioFrom:null;g&&t.set(g)}getBinding(t,r,c){return c.substr(0,9)==="u_pattern"?new sa(t,r):new Kr(t,r)}}class Tn{constructor(t,r,c,f){this.expression=t,this.type=c,this.maxValue=0,this.paintVertexAttributes=r.map(g=>({name:`a_${g}`,type:"Float32",components:c==="color"?2:1,offset:0})),this.paintVertexArray=new f}populatePaintArray(t,r,c,f,g){const y=this.paintVertexArray.length,b=this.expression.evaluate(new Un(0),r,{},f,[],g);this.paintVertexArray.resize(t),this._setPaintValue(y,t,b)}updatePaintArray(t,r,c,f){const g=this.expression.evaluate({zoom:0},c,f);this._setPaintValue(t,r,g)}_setPaintValue(t,r,c){if(this.type==="color"){const f=Cn(c);for(let g=t;g<r;g++)this.paintVertexArray.emplace(g,f[0],f[1])}else{for(let f=t;f<r;f++)this.paintVertexArray.emplace(f,c);this.maxValue=Math.max(this.maxValue,Math.abs(c))}}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class gi{constructor(t,r,c,f,g,y){this.expression=t,this.uniformNames=r.map(b=>`u_${b}_t`),this.type=c,this.useIntegerZoom=f,this.zoom=g,this.maxValue=0,this.paintVertexAttributes=r.map(b=>({name:`a_${b}`,type:"Float32",components:c==="color"?4:2,offset:0})),this.paintVertexArray=new y}populatePaintArray(t,r,c,f,g){const y=this.expression.evaluate(new Un(this.zoom),r,{},f,[],g),b=this.expression.evaluate(new Un(this.zoom+1),r,{},f,[],g),S=this.paintVertexArray.length;this.paintVertexArray.resize(t),this._setPaintValue(S,t,y,b)}updatePaintArray(t,r,c,f){const g=this.expression.evaluate({zoom:this.zoom},c,f),y=this.expression.evaluate({zoom:this.zoom+1},c,f);this._setPaintValue(t,r,g,y)}_setPaintValue(t,r,c,f){if(this.type==="color"){const g=Cn(c),y=Cn(f);for(let b=t;b<r;b++)this.paintVertexArray.emplace(b,g[0],g[1],y[0],y[1])}else{for(let g=t;g<r;g++)this.paintVertexArray.emplace(g,c,f);this.maxValue=Math.max(this.maxValue,Math.abs(c),Math.abs(f))}}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(t,r){const c=this.useIntegerZoom?Math.floor(r.zoom):r.zoom,f=ye(this.expression.interpolationFactor(c,this.zoom,this.zoom+1),0,1);t.set(f)}getBinding(t,r,c){return new Kr(t,r)}}class sr{constructor(t,r,c,f,g,y){this.expression=t,this.type=r,this.useIntegerZoom=c,this.zoom=f,this.layerId=y,this.zoomInPaintVertexArray=new g,this.zoomOutPaintVertexArray=new g}populatePaintArray(t,r,c){const f=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(t),this.zoomOutPaintVertexArray.resize(t),this._setPaintValues(f,t,r.patterns&&r.patterns[this.layerId],c)}updatePaintArray(t,r,c,f,g){this._setPaintValues(t,r,c.patterns&&c.patterns[this.layerId],g)}_setPaintValues(t,r,c,f){if(!f||!c)return;const{min:g,mid:y,max:b}=c,S=f[g],P=f[y],D=f[b];if(S&&P&&D)for(let R=t;R<r;R++)this.zoomInPaintVertexArray.emplace(R,P.tl[0],P.tl[1],P.br[0],P.br[1],S.tl[0],S.tl[1],S.br[0],S.br[1],P.pixelRatio,S.pixelRatio),this.zoomOutPaintVertexArray.emplace(R,P.tl[0],P.tl[1],P.br[0],P.br[1],D.tl[0],D.tl[1],D.br[0],D.br[1],P.pixelRatio,D.pixelRatio)}upload(t){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=t.createVertexBuffer(this.zoomInPaintVertexArray,St.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=t.createVertexBuffer(this.zoomOutPaintVertexArray,St.members,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class hl{constructor(t,r,c){this.binders={},this._buffers=[];const f=[];for(const g in t.paint._values){if(!c(g))continue;const y=t.paint.get(g);if(!(y instanceof Wr&&mo(y.property.specification)))continue;const b=bf(g,t.type),S=y.value,P=y.property.specification.type,D=y.property.useIntegerZoom,R=y.property.specification["property-type"],O=R==="cross-faded"||R==="cross-faded-data-driven";if(S.kind==="constant")this.binders[g]=O?new wi(S.value,b):new mi(S.value,b,P),f.push(`/u_${g}`);else if(S.kind==="source"||O){const $=Sh(g,P,"source");this.binders[g]=O?new sr(S,P,D,r,$,t.id):new Tn(S,b,P,$),f.push(`/a_${g}`)}else{const $=Sh(g,P,"composite");this.binders[g]=new gi(S,b,P,D,r,$),f.push(`/z_${g}`)}}this.cacheKey=f.sort().join("")}getMaxValue(t){const r=this.binders[t];return r instanceof Tn||r instanceof gi?r.maxValue:0}populatePaintArrays(t,r,c,f,g){for(const y in this.binders){const b=this.binders[y];(b instanceof Tn||b instanceof gi||b instanceof sr)&&b.populatePaintArray(t,r,c,f,g)}}setConstantPatternPositions(t,r){for(const c in this.binders){const f=this.binders[c];f instanceof wi&&f.setConstantPatternPositions(t,r)}}updatePaintArrays(t,r,c,f,g){let y=!1;for(const b in t){const S=r.getPositions(b);for(const P of S){const D=c.feature(P.index);for(const R in this.binders){const O=this.binders[R];if((O instanceof Tn||O instanceof gi||O instanceof sr)&&O.expression.isStateDependent===!0){const $=f.paint.get(R);O.expression=$.value,O.updatePaintArray(P.start,P.end,D,t[b],g),y=!0}}}}return y}defines(){const t=[];for(const r in this.binders){const c=this.binders[r];(c instanceof mi||c instanceof wi)&&t.push(...c.uniformNames.map(f=>`#define HAS_UNIFORM_${f}`))}return t}getBinderAttributes(){const t=[];for(const r in this.binders){const c=this.binders[r];if(c instanceof Tn||c instanceof gi)for(let f=0;f<c.paintVertexAttributes.length;f++)t.push(c.paintVertexAttributes[f].name);else if(c instanceof sr)for(let f=0;f<St.members.length;f++)t.push(St.members[f].name)}return t}getBinderUniforms(){const t=[];for(const r in this.binders){const c=this.binders[r];if(c instanceof mi||c instanceof wi||c instanceof gi)for(const f of c.uniformNames)t.push(f)}return t}getPaintVertexBuffers(){return this._buffers}getUniforms(t,r){const c=[];for(const f in this.binders){const g=this.binders[f];if(g instanceof mi||g instanceof wi||g instanceof gi){for(const y of g.uniformNames)if(r[y]){const b=g.getBinding(t,r[y],y);c.push({name:y,property:f,binding:b})}}}return c}setUniforms(t,r,c,f){for(const{name:g,property:y,binding:b}of r)this.binders[y].setUniform(b,f,c.get(y),g)}updatePaintBuffers(t){this._buffers=[];for(const r in this.binders){const c=this.binders[r];if(t&&c instanceof sr){const f=t.fromScale===2?c.zoomInPaintVertexBuffer:c.zoomOutPaintVertexBuffer;f&&this._buffers.push(f)}else(c instanceof Tn||c instanceof gi)&&c.paintVertexBuffer&&this._buffers.push(c.paintVertexBuffer)}}upload(t){for(const r in this.binders){const c=this.binders[r];(c instanceof Tn||c instanceof gi||c instanceof sr)&&c.upload(t)}this.updatePaintBuffers()}destroy(){for(const t in this.binders){const r=this.binders[t];(r instanceof Tn||r instanceof gi||r instanceof sr)&&r.destroy()}}}class cs{constructor(t,r,c=()=>!0){this.programConfigurations={};for(const f of t)this.programConfigurations[f.id]=new hl(f,r,c);this.needsUpload=!1,this._featureMap=new xi,this._bufferOffset=0}populatePaintArrays(t,r,c,f,g,y){for(const b in this.programConfigurations)this.programConfigurations[b].populatePaintArrays(t,r,f,g,y);r.id!==void 0&&this._featureMap.add(r.id,c,this._bufferOffset,t),this._bufferOffset=t,this.needsUpload=!0}updatePaintArrays(t,r,c,f){for(const g of c)this.needsUpload=this.programConfigurations[g.id].updatePaintArrays(t,this._featureMap,r,g,f)||this.needsUpload}get(t){return this.programConfigurations[t]}upload(t){if(this.needsUpload){for(const r in this.programConfigurations)this.programConfigurations[r].upload(t);this.needsUpload=!1}}destroy(){for(const t in this.programConfigurations)this.programConfigurations[t].destroy()}}function bf(i,t){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[i]||[i.replace(`${t}-`,"").replace(/-/g,"_")]}function Sh(i,t,r){const c={color:{source:js,composite:o},number:{source:cl,composite:js}},f=function(g){return{"line-pattern":{source:ie,composite:ie},"fill-pattern":{source:ie,composite:ie},"fill-extrusion-pattern":{source:ie,composite:ie}}[g]}(i);return f&&f[r]||c[t][r]}Et("ConstantBinder",mi),Et("CrossFadedConstantBinder",wi),Et("SourceExpressionBinder",Tn),Et("CrossFadedCompositeBinder",sr),Et("CompositeExpressionBinder",gi),Et("ProgramConfiguration",hl,{omit:["_buffers"]}),Et("ProgramConfigurationSet",cs);var On=8192;const Lc=Math.pow(2,14)-1,oa=-Lc-1;function us(i){const t=On/i.extent,r=i.loadGeometry();for(let c=0;c<r.length;c++){const f=r[c];for(let g=0;g<f.length;g++){const y=f[g],b=Math.round(y.x*t),S=Math.round(y.y*t);y.x=ye(b,oa,Lc),y.y=ye(S,oa,Lc),(b<y.x||b>y.x+1||S<y.y||S>y.y+1)&&pe("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return r}function aa(i,t){return{type:i.type,id:i.id,properties:i.properties,geometry:t?us(i):[]}}function Ch(i,t,r,c,f){i.emplaceBack(2*t+(c+1)/2,2*r+(f+1)/2)}class wf{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(r=>r.id),this.index=t.index,this.hasPattern=!1,this.layoutVertexArray=new H,this.indexArray=new et,this.segments=new pt,this.programConfigurations=new cs(t.layers,t.zoom),this.stateDependentLayerIds=this.layers.filter(r=>r.isStateDependent()).map(r=>r.id)}populate(t,r,c){const f=this.layers[0],g=[];let y=null,b=!1;f.type==="circle"&&(y=f.layout.get("circle-sort-key"),b=!y.isConstant());for(const{feature:S,id:P,index:D,sourceLayerIndex:R}of t){const O=this.layers[0]._featureFilter.needGeometry,$=aa(S,O);if(!this.layers[0]._featureFilter.filter(new Un(this.zoom),$,c))continue;const N=b?y.evaluate($,{},c):void 0,ee={id:P,properties:S.properties,type:S.type,sourceLayerIndex:R,index:D,geometry:O?$.geometry:us(S),patterns:{},sortKey:N};g.push(ee)}b&&g.sort((S,P)=>S.sortKey-P.sortKey);for(const S of g){const{geometry:P,index:D,sourceLayerIndex:R}=S,O=t[D].feature;this.addFeature(S,P,D,c),r.featureIndex.insert(O,P,D,R,this.index)}}update(t,r,c){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,r,this.stateDependentLayers,c)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Jt),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(t,r,c,f){for(const g of r)for(const y of g){const b=y.x,S=y.y;if(b<0||b>=On||S<0||S>=On)continue;const P=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,t.sortKey),D=P.vertexLength;Ch(this.layoutVertexArray,b,S,-1,-1),Ch(this.layoutVertexArray,b,S,1,-1),Ch(this.layoutVertexArray,b,S,1,1),Ch(this.layoutVertexArray,b,S,-1,1),this.indexArray.emplaceBack(D,D+1,D+2),this.indexArray.emplaceBack(D,D+3,D+2),P.vertexLength+=4,P.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,c,{},f)}}function Cg(i,t){for(let r=0;r<i.length;r++)if(dl(t,i[r]))return!0;for(let r=0;r<t.length;r++)if(dl(i,t[r]))return!0;return!!Sf(i,t)}function Gb(i,t,r){return!!dl(i,t)||!!Cf(t,i,r)}function Eg(i,t){if(i.length===1)return Ig(t,i[0]);for(let r=0;r<t.length;r++){const c=t[r];for(let f=0;f<c.length;f++)if(dl(i,c[f]))return!0}for(let r=0;r<i.length;r++)if(Ig(t,i[r]))return!0;for(let r=0;r<t.length;r++)if(Sf(i,t[r]))return!0;return!1}function Wb(i,t,r){if(i.length>1){if(Sf(i,t))return!0;for(let c=0;c<t.length;c++)if(Cf(t[c],i,r))return!0}for(let c=0;c<i.length;c++)if(Cf(i[c],t,r))return!0;return!1}function Sf(i,t){if(i.length===0||t.length===0)return!1;for(let r=0;r<i.length-1;r++){const c=i[r],f=i[r+1];for(let g=0;g<t.length-1;g++)if(Hb(c,f,t[g],t[g+1]))return!0}return!1}function Hb(i,t,r,c){return Se(i,r,c)!==Se(t,r,c)&&Se(i,t,r)!==Se(i,t,c)}function Cf(i,t,r){const c=r*r;if(t.length===1)return i.distSqr(t[0])<c;for(let f=1;f<t.length;f++)if(Tg(i,t[f-1],t[f])<c)return!0;return!1}function Tg(i,t,r){const c=t.distSqr(r);if(c===0)return i.distSqr(t);const f=((i.x-t.x)*(r.x-t.x)+(i.y-t.y)*(r.y-t.y))/c;return i.distSqr(f<0?t:f>1?r:r.sub(t)._mult(f)._add(t))}function Ig(i,t){let r,c,f,g=!1;for(let y=0;y<i.length;y++){r=i[y];for(let b=0,S=r.length-1;b<r.length;S=b++)c=r[b],f=r[S],c.y>t.y!=f.y>t.y&&t.x<(f.x-c.x)*(t.y-c.y)/(f.y-c.y)+c.x&&(g=!g)}return g}function dl(i,t){let r=!1;for(let c=0,f=i.length-1;c<i.length;f=c++){const g=i[c],y=i[f];g.y>t.y!=y.y>t.y&&t.x<(y.x-g.x)*(t.y-g.y)/(y.y-g.y)+g.x&&(r=!r)}return r}function Xb(i,t,r){const c=r[0],f=r[2];if(i.x<c.x&&t.x<c.x||i.x>f.x&&t.x>f.x||i.y<c.y&&t.y<c.y||i.y>f.y&&t.y>f.y)return!1;const g=Se(i,t,r[0]);return g!==Se(i,t,r[1])||g!==Se(i,t,r[2])||g!==Se(i,t,r[3])}function Rc(i,t,r){const c=t.paint.get(i).value;return c.kind==="constant"?c.value:r.programConfigurations.get(t.id).getMaxValue(i)}function Eh(i){return Math.sqrt(i[0]*i[0]+i[1]*i[1])}function Th(i,t,r,c,f){if(!t[0]&&!t[1])return i;const g=k.convert(t)._mult(f);r==="viewport"&&g._rotate(-c);const y=[];for(let b=0;b<i.length;b++)y.push(i[b].sub(g));return y}let Ag,Pg;Et("CircleBucket",wf,{omit:["layers"]});var Kb={get paint(){return Pg=Pg||new Xi({"circle-radius":new qt(Z.paint_circle["circle-radius"]),"circle-color":new qt(Z.paint_circle["circle-color"]),"circle-blur":new qt(Z.paint_circle["circle-blur"]),"circle-opacity":new qt(Z.paint_circle["circle-opacity"]),"circle-translate":new zt(Z.paint_circle["circle-translate"]),"circle-translate-anchor":new zt(Z.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new zt(Z.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new zt(Z.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new qt(Z.paint_circle["circle-stroke-width"]),"circle-stroke-color":new qt(Z.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new qt(Z.paint_circle["circle-stroke-opacity"])})},get layout(){return Ag=Ag||new Xi({"circle-sort-key":new qt(Z.layout_circle["circle-sort-key"])})}},Ki=1e-6,fl=typeof Float32Array<"u"?Float32Array:Array;function Ef(i){return i[0]=1,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=1,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=1,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,i}function kg(i,t,r){var c=t[0],f=t[1],g=t[2],y=t[3],b=t[4],S=t[5],P=t[6],D=t[7],R=t[8],O=t[9],$=t[10],N=t[11],ee=t[12],J=t[13],fe=t[14],ve=t[15],ue=r[0],Ie=r[1],Me=r[2],qe=r[3];return i[0]=ue*c+Ie*b+Me*R+qe*ee,i[1]=ue*f+Ie*S+Me*O+qe*J,i[2]=ue*g+Ie*P+Me*$+qe*fe,i[3]=ue*y+Ie*D+Me*N+qe*ve,i[4]=(ue=r[4])*c+(Ie=r[5])*b+(Me=r[6])*R+(qe=r[7])*ee,i[5]=ue*f+Ie*S+Me*O+qe*J,i[6]=ue*g+Ie*P+Me*$+qe*fe,i[7]=ue*y+Ie*D+Me*N+qe*ve,i[8]=(ue=r[8])*c+(Ie=r[9])*b+(Me=r[10])*R+(qe=r[11])*ee,i[9]=ue*f+Ie*S+Me*O+qe*J,i[10]=ue*g+Ie*P+Me*$+qe*fe,i[11]=ue*y+Ie*D+Me*N+qe*ve,i[12]=(ue=r[12])*c+(Ie=r[13])*b+(Me=r[14])*R+(qe=r[15])*ee,i[13]=ue*f+Ie*S+Me*O+qe*J,i[14]=ue*g+Ie*P+Me*$+qe*fe,i[15]=ue*y+Ie*D+Me*N+qe*ve,i}Math.hypot||(Math.hypot=function(){for(var i=0,t=arguments.length;t--;)i+=arguments[t]*arguments[t];return Math.sqrt(i)});var Bc,Yb=kg;function Ih(i,t,r){var c=t[0],f=t[1],g=t[2],y=t[3];return i[0]=r[0]*c+r[4]*f+r[8]*g+r[12]*y,i[1]=r[1]*c+r[5]*f+r[9]*g+r[13]*y,i[2]=r[2]*c+r[6]*f+r[10]*g+r[14]*y,i[3]=r[3]*c+r[7]*f+r[11]*g+r[15]*y,i}function Mg(i,t){const r=Ih([],[i.x,i.y,0,1],t);return new k(r[0]/r[3],r[1]/r[3])}Bc=new fl(4),fl!=Float32Array&&(Bc[0]=0,Bc[1]=0,Bc[2]=0,Bc[3]=0);class Dg extends wf{}let zg;Et("HeatmapBucket",Dg,{omit:["layers"]});var Jb={get paint(){return zg=zg||new Xi({"heatmap-radius":new qt(Z.paint_heatmap["heatmap-radius"]),"heatmap-weight":new qt(Z.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new zt(Z.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Pc(Z.paint_heatmap["heatmap-color"]),"heatmap-opacity":new zt(Z.paint_heatmap["heatmap-opacity"])})}};function Tf(i,{width:t,height:r},c,f){if(f){if(f instanceof Uint8ClampedArray)f=new Uint8Array(f.buffer);else if(f.length!==t*r*c)throw new RangeError(`mismatched image size. expected: ${f.length} but got: ${t*r*c}`)}else f=new Uint8Array(t*r*c);return i.width=t,i.height=r,i.data=f,i}function Lg(i,{width:t,height:r},c){if(t===i.width&&r===i.height)return;const f=Tf({},{width:t,height:r},c);If(i,f,{x:0,y:0},{x:0,y:0},{width:Math.min(i.width,t),height:Math.min(i.height,r)},c),i.width=t,i.height=r,i.data=f.data}function If(i,t,r,c,f,g){if(f.width===0||f.height===0)return t;if(f.width>i.width||f.height>i.height||r.x>i.width-f.width||r.y>i.height-f.height)throw new RangeError("out of range source coordinates for image copy");if(f.width>t.width||f.height>t.height||c.x>t.width-f.width||c.y>t.height-f.height)throw new RangeError("out of range destination coordinates for image copy");const y=i.data,b=t.data;if(y===b)throw new Error("srcData equals dstData, so image is already copied");for(let S=0;S<f.height;S++){const P=((r.y+S)*i.width+r.x)*g,D=((c.y+S)*t.width+c.x)*g;for(let R=0;R<f.width*g;R++)b[D+R]=y[P+R]}return t}class Fc{constructor(t,r){Tf(this,t,1,r)}resize(t){Lg(this,t,1)}clone(){return new Fc({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(t,r,c,f,g){If(t,r,c,f,g,1)}}class Lr{constructor(t,r){Tf(this,t,4,r)}resize(t){Lg(this,t,4)}replace(t,r){r?this.data.set(t):this.data=t instanceof Uint8ClampedArray?new Uint8Array(t.buffer):t}clone(){return new Lr({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(t,r,c,f,g){If(t,r,c,f,g,4)}}function Rg(i){const t={},r=i.resolution||256,c=i.clips?i.clips.length:1,f=i.image||new Lr({width:r,height:c});if(Math.log(r)/Math.LN2%1!=0)throw new Error(`width is not a power of 2 - ${r}`);const g=(y,b,S)=>{t[i.evaluationKey]=S;const P=i.expression.evaluate(t);f.data[y+b+0]=Math.floor(255*P.r/P.a),f.data[y+b+1]=Math.floor(255*P.g/P.a),f.data[y+b+2]=Math.floor(255*P.b/P.a),f.data[y+b+3]=Math.floor(255*P.a)};if(i.clips)for(let y=0,b=0;y<c;++y,b+=4*r)for(let S=0,P=0;S<r;S++,P+=4){const D=S/(r-1),{start:R,end:O}=i.clips[y];g(b,P,R*(1-D)+O*D)}else for(let y=0,b=0;y<r;y++,b+=4)g(0,b,y/(r-1));return f}let Bg;Et("AlphaImage",Fc),Et("RGBAImage",Lr);var Qb={get paint(){return Bg=Bg||new Xi({"hillshade-illumination-direction":new zt(Z.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new zt(Z.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new zt(Z.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new zt(Z.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new zt(Z.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new zt(Z.paint_hillshade["hillshade-accent-color"])})}};const e1=ui([{name:"a_pos",components:2,type:"Int16"}],4),{members:t1}=e1;var Af={exports:{}};function Ah(i,t,r){r=r||2;var c,f,g,y,b,S,P,D=t&&t.length,R=D?t[0]*r:i.length,O=Fg(i,0,R,r,!0),$=[];if(!O||O.next===O.prev)return $;if(D&&(O=function(ee,J,fe,ve){var ue,Ie,Me,qe=[];for(ue=0,Ie=J.length;ue<Ie;ue++)(Me=Fg(ee,J[ue]*ve,ue<Ie-1?J[ue+1]*ve:ee.length,ve,!1))===Me.next&&(Me.steiner=!0),qe.push(c1(Me));for(qe.sort(o1),ue=0;ue<qe.length;ue++)fe=a1(qe[ue],fe);return fe}(i,t,O,r)),i.length>80*r){c=g=i[0],f=y=i[1];for(var N=r;N<R;N+=r)(b=i[N])<c&&(c=b),(S=i[N+1])<f&&(f=S),b>g&&(g=b),S>y&&(y=S);P=(P=Math.max(g-c,y-f))!==0?32767/P:0}return Oc(O,$,r,c,f,P,0),$}function Fg(i,t,r,c,f){var g,y;if(f===Mf(i,t,r,c)>0)for(g=t;g<r;g+=c)y=$g(g,i[g],i[g+1],y);else for(g=r-c;g>=t;g-=c)y=$g(g,i[g],i[g+1],y);return y&&Ph(y,y.next)&&($c(y),y=y.next),y}function la(i,t){if(!i)return i;t||(t=i);var r,c=i;do if(r=!1,c.steiner||!Ph(c,c.next)&&si(c.prev,c,c.next)!==0)c=c.next;else{if($c(c),(c=t=c.prev)===c.next)break;r=!0}while(r||c!==t);return t}function Oc(i,t,r,c,f,g,y){if(i){!y&&g&&function(D,R,O,$){var N=D;do N.z===0&&(N.z=Pf(N.x,N.y,R,O,$)),N.prevZ=N.prev,N.nextZ=N.next,N=N.next;while(N!==D);N.prevZ.nextZ=null,N.prevZ=null,function(ee){var J,fe,ve,ue,Ie,Me,qe,Ct,kt=1;do{for(fe=ee,ee=null,Ie=null,Me=0;fe;){for(Me++,ve=fe,qe=0,J=0;J<kt&&(qe++,ve=ve.nextZ);J++);for(Ct=kt;qe>0||Ct>0&&ve;)qe!==0&&(Ct===0||!ve||fe.z<=ve.z)?(ue=fe,fe=fe.nextZ,qe--):(ue=ve,ve=ve.nextZ,Ct--),Ie?Ie.nextZ=ue:ee=ue,ue.prevZ=Ie,Ie=ue;fe=ve}Ie.nextZ=null,kt*=2}while(Me>1)}(N)}(i,c,f,g);for(var b,S,P=i;i.prev!==i.next;)if(b=i.prev,S=i.next,g?i1(i,c,f,g):n1(i))t.push(b.i/r|0),t.push(i.i/r|0),t.push(S.i/r|0),$c(i),i=S.next,P=S.next;else if((i=S)===P){y?y===1?Oc(i=r1(la(i),t,r),t,r,c,f,g,2):y===2&&s1(i,t,r,c,f,g):Oc(la(i),t,r,c,f,g,1);break}}}function n1(i){var t=i.prev,r=i,c=i.next;if(si(t,r,c)>=0)return!1;for(var f=t.x,g=r.x,y=c.x,b=t.y,S=r.y,P=c.y,D=f<g?f<y?f:y:g<y?g:y,R=b<S?b<P?b:P:S<P?S:P,O=f>g?f>y?f:y:g>y?g:y,$=b>S?b>P?b:P:S>P?S:P,N=c.next;N!==t;){if(N.x>=D&&N.x<=O&&N.y>=R&&N.y<=$&&pl(f,b,g,S,y,P,N.x,N.y)&&si(N.prev,N,N.next)>=0)return!1;N=N.next}return!0}function i1(i,t,r,c){var f=i.prev,g=i,y=i.next;if(si(f,g,y)>=0)return!1;for(var b=f.x,S=g.x,P=y.x,D=f.y,R=g.y,O=y.y,$=b<S?b<P?b:P:S<P?S:P,N=D<R?D<O?D:O:R<O?R:O,ee=b>S?b>P?b:P:S>P?S:P,J=D>R?D>O?D:O:R>O?R:O,fe=Pf($,N,t,r,c),ve=Pf(ee,J,t,r,c),ue=i.prevZ,Ie=i.nextZ;ue&&ue.z>=fe&&Ie&&Ie.z<=ve;){if(ue.x>=$&&ue.x<=ee&&ue.y>=N&&ue.y<=J&&ue!==f&&ue!==y&&pl(b,D,S,R,P,O,ue.x,ue.y)&&si(ue.prev,ue,ue.next)>=0||(ue=ue.prevZ,Ie.x>=$&&Ie.x<=ee&&Ie.y>=N&&Ie.y<=J&&Ie!==f&&Ie!==y&&pl(b,D,S,R,P,O,Ie.x,Ie.y)&&si(Ie.prev,Ie,Ie.next)>=0))return!1;Ie=Ie.nextZ}for(;ue&&ue.z>=fe;){if(ue.x>=$&&ue.x<=ee&&ue.y>=N&&ue.y<=J&&ue!==f&&ue!==y&&pl(b,D,S,R,P,O,ue.x,ue.y)&&si(ue.prev,ue,ue.next)>=0)return!1;ue=ue.prevZ}for(;Ie&&Ie.z<=ve;){if(Ie.x>=$&&Ie.x<=ee&&Ie.y>=N&&Ie.y<=J&&Ie!==f&&Ie!==y&&pl(b,D,S,R,P,O,Ie.x,Ie.y)&&si(Ie.prev,Ie,Ie.next)>=0)return!1;Ie=Ie.nextZ}return!0}function r1(i,t,r){var c=i;do{var f=c.prev,g=c.next.next;!Ph(f,g)&&Og(f,c,c.next,g)&&Vc(f,g)&&Vc(g,f)&&(t.push(f.i/r|0),t.push(c.i/r|0),t.push(g.i/r|0),$c(c),$c(c.next),c=i=g),c=c.next}while(c!==i);return la(c)}function s1(i,t,r,c,f,g){var y=i;do{for(var b=y.next.next;b!==y.prev;){if(y.i!==b.i&&u1(y,b)){var S=Vg(y,b);return y=la(y,y.next),S=la(S,S.next),Oc(y,t,r,c,f,g,0),void Oc(S,t,r,c,f,g,0)}b=b.next}y=y.next}while(y!==i)}function o1(i,t){return i.x-t.x}function a1(i,t){var r=function(f,g){var y,b=g,S=f.x,P=f.y,D=-1/0;do{if(P<=b.y&&P>=b.next.y&&b.next.y!==b.y){var R=b.x+(P-b.y)*(b.next.x-b.x)/(b.next.y-b.y);if(R<=S&&R>D&&(D=R,y=b.x<b.next.x?b:b.next,R===S))return y}b=b.next}while(b!==g);if(!y)return null;var O,$=y,N=y.x,ee=y.y,J=1/0;b=y;do S>=b.x&&b.x>=N&&S!==b.x&&pl(P<ee?S:D,P,N,ee,P<ee?D:S,P,b.x,b.y)&&(O=Math.abs(P-b.y)/(S-b.x),Vc(b,f)&&(O<J||O===J&&(b.x>y.x||b.x===y.x&&l1(y,b)))&&(y=b,J=O)),b=b.next;while(b!==$);return y}(i,t);if(!r)return t;var c=Vg(r,i);return la(c,c.next),la(r,r.next)}function l1(i,t){return si(i.prev,i,t.prev)<0&&si(t.next,i,i.next)<0}function Pf(i,t,r,c,f){return(i=1431655765&((i=858993459&((i=252645135&((i=16711935&((i=(i-r)*f|0)|i<<8))|i<<4))|i<<2))|i<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-c)*f|0)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function c1(i){var t=i,r=i;do(t.x<r.x||t.x===r.x&&t.y<r.y)&&(r=t),t=t.next;while(t!==i);return r}function pl(i,t,r,c,f,g,y,b){return(f-y)*(t-b)>=(i-y)*(g-b)&&(i-y)*(c-b)>=(r-y)*(t-b)&&(r-y)*(g-b)>=(f-y)*(c-b)}function u1(i,t){return i.next.i!==t.i&&i.prev.i!==t.i&&!function(r,c){var f=r;do{if(f.i!==r.i&&f.next.i!==r.i&&f.i!==c.i&&f.next.i!==c.i&&Og(f,f.next,r,c))return!0;f=f.next}while(f!==r);return!1}(i,t)&&(Vc(i,t)&&Vc(t,i)&&function(r,c){var f=r,g=!1,y=(r.x+c.x)/2,b=(r.y+c.y)/2;do f.y>b!=f.next.y>b&&f.next.y!==f.y&&y<(f.next.x-f.x)*(b-f.y)/(f.next.y-f.y)+f.x&&(g=!g),f=f.next;while(f!==r);return g}(i,t)&&(si(i.prev,i,t.prev)||si(i,t.prev,t))||Ph(i,t)&&si(i.prev,i,i.next)>0&&si(t.prev,t,t.next)>0)}function si(i,t,r){return(t.y-i.y)*(r.x-t.x)-(t.x-i.x)*(r.y-t.y)}function Ph(i,t){return i.x===t.x&&i.y===t.y}function Og(i,t,r,c){var f=Mh(si(i,t,r)),g=Mh(si(i,t,c)),y=Mh(si(r,c,i)),b=Mh(si(r,c,t));return f!==g&&y!==b||!(f!==0||!kh(i,r,t))||!(g!==0||!kh(i,c,t))||!(y!==0||!kh(r,i,c))||!(b!==0||!kh(r,t,c))}function kh(i,t,r){return t.x<=Math.max(i.x,r.x)&&t.x>=Math.min(i.x,r.x)&&t.y<=Math.max(i.y,r.y)&&t.y>=Math.min(i.y,r.y)}function Mh(i){return i>0?1:i<0?-1:0}function Vc(i,t){return si(i.prev,i,i.next)<0?si(i,t,i.next)>=0&&si(i,i.prev,t)>=0:si(i,t,i.prev)<0||si(i,i.next,t)<0}function Vg(i,t){var r=new kf(i.i,i.x,i.y),c=new kf(t.i,t.x,t.y),f=i.next,g=t.prev;return i.next=t,t.prev=i,r.next=f,f.prev=r,c.next=r,r.prev=c,g.next=c,c.prev=g,c}function $g(i,t,r,c){var f=new kf(i,t,r);return c?(f.next=c.next,f.prev=c,c.next.prev=f,c.next=f):(f.prev=f,f.next=f),f}function $c(i){i.next.prev=i.prev,i.prev.next=i.next,i.prevZ&&(i.prevZ.nextZ=i.nextZ),i.nextZ&&(i.nextZ.prevZ=i.prevZ)}function kf(i,t,r){this.i=i,this.x=t,this.y=r,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Mf(i,t,r,c){for(var f=0,g=t,y=r-c;g<r;g+=c)f+=(i[y]-i[g])*(i[g+1]+i[y+1]),y=g;return f}Af.exports=Ah,Af.exports.default=Ah,Ah.deviation=function(i,t,r,c){var f=t&&t.length,g=Math.abs(Mf(i,0,f?t[0]*r:i.length,r));if(f)for(var y=0,b=t.length;y<b;y++)g-=Math.abs(Mf(i,t[y]*r,y<b-1?t[y+1]*r:i.length,r));var S=0;for(y=0;y<c.length;y+=3){var P=c[y]*r,D=c[y+1]*r,R=c[y+2]*r;S+=Math.abs((i[P]-i[R])*(i[D+1]-i[P+1])-(i[P]-i[D])*(i[R+1]-i[P+1]))}return g===0&&S===0?0:Math.abs((S-g)/g)},Ah.flatten=function(i){for(var t=i[0][0].length,r={vertices:[],holes:[],dimensions:t},c=0,f=0;f<i.length;f++){for(var g=0;g<i[f].length;g++)for(var y=0;y<t;y++)r.vertices.push(i[f][g][y]);f>0&&r.holes.push(c+=i[f-1].length)}return r};var Ug=I(Af.exports);function h1(i,t,r,c,f){Ng(i,t,r||0,c||i.length-1,f||d1)}function Ng(i,t,r,c,f){for(;c>r;){if(c-r>600){var g=c-r+1,y=t-r+1,b=Math.log(g),S=.5*Math.exp(2*b/3),P=.5*Math.sqrt(b*S*(g-S)/g)*(y-g/2<0?-1:1);Ng(i,t,Math.max(r,Math.floor(t-y*S/g+P)),Math.min(c,Math.floor(t+(g-y)*S/g+P)),f)}var D=i[t],R=r,O=c;for(Uc(i,r,t),f(i[c],D)>0&&Uc(i,r,c);R<O;){for(Uc(i,R,O),R++,O--;f(i[R],D)<0;)R++;for(;f(i[O],D)>0;)O--}f(i[r],D)===0?Uc(i,r,O):Uc(i,++O,c),O<=t&&(r=O+1),t<=O&&(c=O-1)}}function Uc(i,t,r){var c=i[t];i[t]=i[r],i[r]=c}function d1(i,t){return i<t?-1:i>t?1:0}function Df(i,t){const r=i.length;if(r<=1)return[i];const c=[];let f,g;for(let y=0;y<r;y++){const b=Ce(i[y]);b!==0&&(i[y].area=Math.abs(b),g===void 0&&(g=b<0),g===b<0?(f&&c.push(f),f=[i[y]]):f.push(i[y]))}if(f&&c.push(f),t>1)for(let y=0;y<c.length;y++)c[y].length<=t||(h1(c[y],t,1,c[y].length-1,f1),c[y]=c[y].slice(0,t));return c}function f1(i,t){return t.area-i.area}function zf(i,t,r){const c=r.patternDependencies;let f=!1;for(const g of t){const y=g.paint.get(`${i}-pattern`);y.isConstant()||(f=!0);const b=y.constantOr(null);b&&(f=!0,c[b.to]=!0,c[b.from]=!0)}return f}function Lf(i,t,r,c,f){const g=f.patternDependencies;for(const y of t){const b=y.paint.get(`${i}-pattern`).value;if(b.kind!=="constant"){let S=b.evaluate({zoom:c-1},r,{},f.availableImages),P=b.evaluate({zoom:c},r,{},f.availableImages),D=b.evaluate({zoom:c+1},r,{},f.availableImages);S=S&&S.name?S.name:S,P=P&&P.name?P.name:P,D=D&&D.name?D.name:D,g[S]=!0,g[P]=!0,g[D]=!0,r.patterns[y.id]={min:S,mid:P,max:D}}}return r}class Rf{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(r=>r.id),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Y,this.indexArray=new et,this.indexArray2=new bt,this.programConfigurations=new cs(t.layers,t.zoom),this.segments=new pt,this.segments2=new pt,this.stateDependentLayerIds=this.layers.filter(r=>r.isStateDependent()).map(r=>r.id)}populate(t,r,c){this.hasPattern=zf("fill",this.layers,r);const f=this.layers[0].layout.get("fill-sort-key"),g=!f.isConstant(),y=[];for(const{feature:b,id:S,index:P,sourceLayerIndex:D}of t){const R=this.layers[0]._featureFilter.needGeometry,O=aa(b,R);if(!this.layers[0]._featureFilter.filter(new Un(this.zoom),O,c))continue;const $=g?f.evaluate(O,{},c,r.availableImages):void 0,N={id:S,properties:b.properties,type:b.type,sourceLayerIndex:D,index:P,geometry:R?O.geometry:us(b),patterns:{},sortKey:$};y.push(N)}g&&y.sort((b,S)=>b.sortKey-S.sortKey);for(const b of y){const{geometry:S,index:P,sourceLayerIndex:D}=b;if(this.hasPattern){const R=Lf("fill",this.layers,b,this.zoom,r);this.patternFeatures.push(R)}else this.addFeature(b,S,P,c,{});r.featureIndex.insert(t[P].feature,S,P,D,this.index)}}update(t,r,c){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,r,this.stateDependentLayers,c)}addFeatures(t,r,c){for(const f of this.patternFeatures)this.addFeature(f,f.geometry,f.index,r,c)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,t1),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.indexBuffer2=t.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(t,r,c,f,g){for(const y of Df(r,500)){let b=0;for(const $ of y)b+=$.length;const S=this.segments.prepareSegment(b,this.layoutVertexArray,this.indexArray),P=S.vertexLength,D=[],R=[];for(const $ of y){if($.length===0)continue;$!==y[0]&&R.push(D.length/2);const N=this.segments2.prepareSegment($.length,this.layoutVertexArray,this.indexArray2),ee=N.vertexLength;this.layoutVertexArray.emplaceBack($[0].x,$[0].y),this.indexArray2.emplaceBack(ee+$.length-1,ee),D.push($[0].x),D.push($[0].y);for(let J=1;J<$.length;J++)this.layoutVertexArray.emplaceBack($[J].x,$[J].y),this.indexArray2.emplaceBack(ee+J-1,ee+J),D.push($[J].x),D.push($[J].y);N.vertexLength+=$.length,N.primitiveLength+=$.length}const O=Ug(D,R);for(let $=0;$<O.length;$+=3)this.indexArray.emplaceBack(P+O[$],P+O[$+1],P+O[$+2]);S.vertexLength+=b,S.primitiveLength+=O.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,c,g,f)}}let jg,qg;Et("FillBucket",Rf,{omit:["layers","patternFeatures"]});var p1={get paint(){return qg=qg||new Xi({"fill-antialias":new zt(Z.paint_fill["fill-antialias"]),"fill-opacity":new qt(Z.paint_fill["fill-opacity"]),"fill-color":new qt(Z.paint_fill["fill-color"]),"fill-outline-color":new qt(Z.paint_fill["fill-outline-color"]),"fill-translate":new zt(Z.paint_fill["fill-translate"]),"fill-translate-anchor":new zt(Z.paint_fill["fill-translate-anchor"]),"fill-pattern":new ia(Z.paint_fill["fill-pattern"])})},get layout(){return jg=jg||new Xi({"fill-sort-key":new qt(Z.layout_fill["fill-sort-key"])})}};const m1=ui([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),g1=ui([{name:"a_centroid",components:2,type:"Int16"}],4),{members:y1}=m1;var bo={},_1=T,Zg=ml;function ml(i,t,r,c,f){this.properties={},this.extent=r,this.type=0,this._pbf=i,this._geometry=-1,this._keys=c,this._values=f,i.readFields(v1,this,t)}function v1(i,t,r){i==1?t.id=r.readVarint():i==2?function(c,f){for(var g=c.readVarint()+c.pos;c.pos<g;){var y=f._keys[c.readVarint()],b=f._values[c.readVarint()];f.properties[y]=b}}(r,t):i==3?t.type=r.readVarint():i==4&&(t._geometry=r.pos)}function x1(i){for(var t,r,c=0,f=0,g=i.length,y=g-1;f<g;y=f++)c+=((r=i[y]).x-(t=i[f]).x)*(t.y+r.y);return c}ml.types=["Unknown","Point","LineString","Polygon"],ml.prototype.loadGeometry=function(){var i=this._pbf;i.pos=this._geometry;for(var t,r=i.readVarint()+i.pos,c=1,f=0,g=0,y=0,b=[];i.pos<r;){if(f<=0){var S=i.readVarint();c=7&S,f=S>>3}if(f--,c===1||c===2)g+=i.readSVarint(),y+=i.readSVarint(),c===1&&(t&&b.push(t),t=[]),t.push(new _1(g,y));else{if(c!==7)throw new Error("unknown command "+c);t&&t.push(t[0].clone())}}return t&&b.push(t),b},ml.prototype.bbox=function(){var i=this._pbf;i.pos=this._geometry;for(var t=i.readVarint()+i.pos,r=1,c=0,f=0,g=0,y=1/0,b=-1/0,S=1/0,P=-1/0;i.pos<t;){if(c<=0){var D=i.readVarint();r=7&D,c=D>>3}if(c--,r===1||r===2)(f+=i.readSVarint())<y&&(y=f),f>b&&(b=f),(g+=i.readSVarint())<S&&(S=g),g>P&&(P=g);else if(r!==7)throw new Error("unknown command "+r)}return[y,S,b,P]},ml.prototype.toGeoJSON=function(i,t,r){var c,f,g=this.extent*Math.pow(2,r),y=this.extent*i,b=this.extent*t,S=this.loadGeometry(),P=ml.types[this.type];function D($){for(var N=0;N<$.length;N++){var ee=$[N];$[N]=[360*(ee.x+y)/g-180,360/Math.PI*Math.atan(Math.exp((180-360*(ee.y+b)/g)*Math.PI/180))-90]}}switch(this.type){case 1:var R=[];for(c=0;c<S.length;c++)R[c]=S[c][0];D(S=R);break;case 2:for(c=0;c<S.length;c++)D(S[c]);break;case 3:for(S=function($){var N=$.length;if(N<=1)return[$];for(var ee,J,fe=[],ve=0;ve<N;ve++){var ue=x1($[ve]);ue!==0&&(J===void 0&&(J=ue<0),J===ue<0?(ee&&fe.push(ee),ee=[$[ve]]):ee.push($[ve]))}return ee&&fe.push(ee),fe}(S),c=0;c<S.length;c++)for(f=0;f<S[c].length;f++)D(S[c][f])}S.length===1?S=S[0]:P="Multi"+P;var O={type:"Feature",geometry:{type:P,coordinates:S},properties:this.properties};return"id"in this&&(O.id=this.id),O};var b1=Zg,Gg=Wg;function Wg(i,t){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=i,this._keys=[],this._values=[],this._features=[],i.readFields(w1,this,t),this.length=this._features.length}function w1(i,t,r){i===15?t.version=r.readVarint():i===1?t.name=r.readString():i===5?t.extent=r.readVarint():i===2?t._features.push(r.pos):i===3?t._keys.push(r.readString()):i===4&&t._values.push(function(c){for(var f=null,g=c.readVarint()+c.pos;c.pos<g;){var y=c.readVarint()>>3;f=y===1?c.readString():y===2?c.readFloat():y===3?c.readDouble():y===4?c.readVarint64():y===5?c.readVarint():y===6?c.readSVarint():y===7?c.readBoolean():null}return f}(r))}Wg.prototype.feature=function(i){if(i<0||i>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[i];var t=this._pbf.readVarint()+this._pbf.pos;return new b1(this._pbf,t,this.extent,this._keys,this._values)};var S1=Gg;function C1(i,t,r){if(i===3){var c=new S1(r,r.readVarint()+r.pos);c.length&&(t[c.name]=c)}}bo.VectorTile=function(i,t){this.layers=i.readFields(C1,{},t)},bo.VectorTileFeature=Zg,bo.VectorTileLayer=Gg;const E1=bo.VectorTileFeature.types,Bf=Math.pow(2,13);function Nc(i,t,r,c,f,g,y,b){i.emplaceBack(t,r,2*Math.floor(c*Bf)+y,f*Bf*2,g*Bf*2,Math.round(b))}class Ff{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(r=>r.id),this.index=t.index,this.hasPattern=!1,this.layoutVertexArray=new se,this.centroidVertexArray=new Q,this.indexArray=new et,this.programConfigurations=new cs(t.layers,t.zoom),this.segments=new pt,this.stateDependentLayerIds=this.layers.filter(r=>r.isStateDependent()).map(r=>r.id)}populate(t,r,c){this.features=[],this.hasPattern=zf("fill-extrusion",this.layers,r);for(const{feature:f,id:g,index:y,sourceLayerIndex:b}of t){const S=this.layers[0]._featureFilter.needGeometry,P=aa(f,S);if(!this.layers[0]._featureFilter.filter(new Un(this.zoom),P,c))continue;const D={id:g,sourceLayerIndex:b,index:y,geometry:S?P.geometry:us(f),properties:f.properties,type:f.type,patterns:{}};this.hasPattern?this.features.push(Lf("fill-extrusion",this.layers,D,this.zoom,r)):this.addFeature(D,D.geometry,y,c,{}),r.featureIndex.insert(f,D.geometry,y,b,this.index,!0)}}addFeatures(t,r,c){for(const f of this.features){const{geometry:g}=f;this.addFeature(f,g,f.index,r,c)}}update(t,r,c){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,r,this.stateDependentLayers,c)}isEmpty(){return this.layoutVertexArray.length===0&&this.centroidVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,y1),this.centroidVertexBuffer=t.createVertexBuffer(this.centroidVertexArray,g1.members,!0),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(t,r,c,f,g){const y={x:0,y:0,vertexCount:0};for(const b of Df(r,500)){let S=0;for(const N of b)S+=N.length;let P=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray);for(const N of b){if(N.length===0||I1(N))continue;let ee=0;for(let J=0;J<N.length;J++){const fe=N[J];if(J>=1){const ve=N[J-1];if(!T1(fe,ve)){P.vertexLength+4>pt.MAX_VERTEX_ARRAY_LENGTH&&(P=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const ue=fe.sub(ve)._perp()._unit(),Ie=ve.dist(fe);ee+Ie>32768&&(ee=0),Nc(this.layoutVertexArray,fe.x,fe.y,ue.x,ue.y,0,0,ee),Nc(this.layoutVertexArray,fe.x,fe.y,ue.x,ue.y,0,1,ee),y.x+=2*fe.x,y.y+=2*fe.y,y.vertexCount+=2,ee+=Ie,Nc(this.layoutVertexArray,ve.x,ve.y,ue.x,ue.y,0,0,ee),Nc(this.layoutVertexArray,ve.x,ve.y,ue.x,ue.y,0,1,ee),y.x+=2*ve.x,y.y+=2*ve.y,y.vertexCount+=2;const Me=P.vertexLength;this.indexArray.emplaceBack(Me,Me+2,Me+1),this.indexArray.emplaceBack(Me+1,Me+2,Me+3),P.vertexLength+=4,P.primitiveLength+=2}}}}if(P.vertexLength+S>pt.MAX_VERTEX_ARRAY_LENGTH&&(P=this.segments.prepareSegment(S,this.layoutVertexArray,this.indexArray)),E1[t.type]!=="Polygon")continue;const D=[],R=[],O=P.vertexLength;for(const N of b)if(N.length!==0){N!==b[0]&&R.push(D.length/2);for(let ee=0;ee<N.length;ee++){const J=N[ee];Nc(this.layoutVertexArray,J.x,J.y,0,0,1,1,0),y.x+=J.x,y.y+=J.y,y.vertexCount+=1,D.push(J.x),D.push(J.y)}}const $=Ug(D,R);for(let N=0;N<$.length;N+=3)this.indexArray.emplaceBack(O+$[N],O+$[N+2],O+$[N+1]);P.primitiveLength+=$.length/3,P.vertexLength+=S}for(let b=0;b<y.vertexCount;b++)this.centroidVertexArray.emplaceBack(Math.floor(y.x/y.vertexCount),Math.floor(y.y/y.vertexCount));this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,c,g,f)}}function T1(i,t){return i.x===t.x&&(i.x<0||i.x>On)||i.y===t.y&&(i.y<0||i.y>On)}function I1(i){return i.every(t=>t.x<0)||i.every(t=>t.x>On)||i.every(t=>t.y<0)||i.every(t=>t.y>On)}let Hg;Et("FillExtrusionBucket",Ff,{omit:["layers","features"]});var A1={get paint(){return Hg=Hg||new Xi({"fill-extrusion-opacity":new zt(Z["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new qt(Z["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new zt(Z["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new zt(Z["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new ia(Z["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new qt(Z["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new qt(Z["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new zt(Z["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})}};function jc(i,t){return i.x*t.x+i.y*t.y}function Xg(i,t){if(i.length===1){let r=0;const c=t[r++];let f;for(;!f||c.equals(f);)if(f=t[r++],!f)return 1/0;for(;r<t.length;r++){const g=t[r],y=i[0],b=f.sub(c),S=g.sub(c),P=y.sub(c),D=jc(b,b),R=jc(b,S),O=jc(S,S),$=jc(P,b),N=jc(P,S),ee=D*O-R*R,J=(O*$-R*N)/ee,fe=(D*N-R*$)/ee,ve=c.z*(1-J-fe)+f.z*J+g.z*fe;if(isFinite(ve))return ve}return 1/0}{let r=1/0;for(const c of t)r=Math.min(r,c.z);return r}}const P1=ui([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:k1}=P1,M1=ui([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:D1}=M1,z1=bo.VectorTileFeature.types,L1=Math.cos(Math.PI/180*37.5),Kg=Math.pow(2,14)/.5;class Of{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(r=>r.id),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(r=>{this.gradients[r.id]={}}),this.layoutVertexArray=new de,this.layoutVertexArray2=new Pe,this.indexArray=new et,this.programConfigurations=new cs(t.layers,t.zoom),this.segments=new pt,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(r=>r.isStateDependent()).map(r=>r.id)}populate(t,r,c){this.hasPattern=zf("line",this.layers,r);const f=this.layers[0].layout.get("line-sort-key"),g=!f.isConstant(),y=[];for(const{feature:b,id:S,index:P,sourceLayerIndex:D}of t){const R=this.layers[0]._featureFilter.needGeometry,O=aa(b,R);if(!this.layers[0]._featureFilter.filter(new Un(this.zoom),O,c))continue;const $=g?f.evaluate(O,{},c):void 0,N={id:S,properties:b.properties,type:b.type,sourceLayerIndex:D,index:P,geometry:R?O.geometry:us(b),patterns:{},sortKey:$};y.push(N)}g&&y.sort((b,S)=>b.sortKey-S.sortKey);for(const b of y){const{geometry:S,index:P,sourceLayerIndex:D}=b;if(this.hasPattern){const R=Lf("line",this.layers,b,this.zoom,r);this.patternFeatures.push(R)}else this.addFeature(b,S,P,c,{});r.featureIndex.insert(t[P].feature,S,P,D,this.index)}}update(t,r,c){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,r,this.stateDependentLayers,c)}addFeatures(t,r,c){for(const f of this.patternFeatures)this.addFeature(f,f.geometry,f.index,r,c)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=t.createVertexBuffer(this.layoutVertexArray2,D1)),this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,k1),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(t){if(t.properties&&Object.prototype.hasOwnProperty.call(t.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(t.properties,"mapbox_clip_end"))return{start:+t.properties.mapbox_clip_start,end:+t.properties.mapbox_clip_end}}addFeature(t,r,c,f,g){const y=this.layers[0].layout,b=y.get("line-join").evaluate(t,{}),S=y.get("line-cap"),P=y.get("line-miter-limit"),D=y.get("line-round-limit");this.lineClips=this.lineFeatureClips(t);for(const R of r)this.addLine(R,t,b,S,P,D);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,c,g,f)}addLine(t,r,c,f,g,y){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let fe=0;fe<t.length-1;fe++)this.totalDistance+=t[fe].dist(t[fe+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const b=z1[r.type]==="Polygon";let S=t.length;for(;S>=2&&t[S-1].equals(t[S-2]);)S--;let P=0;for(;P<S-1&&t[P].equals(t[P+1]);)P++;if(S<(b?3:2))return;c==="bevel"&&(g=1.05);const D=this.overscaling<=16?15*On/(512*this.overscaling):0,R=this.segments.prepareSegment(10*S,this.layoutVertexArray,this.indexArray);let O,$,N,ee,J;this.e1=this.e2=-1,b&&(O=t[S-2],J=t[P].sub(O)._unit()._perp());for(let fe=P;fe<S;fe++){if(N=fe===S-1?b?t[P+1]:void 0:t[fe+1],N&&t[fe].equals(N))continue;J&&(ee=J),O&&($=O),O=t[fe],J=N?N.sub(O)._unit()._perp():ee,ee=ee||J;let ve=ee.add(J);ve.x===0&&ve.y===0||ve._unit();const ue=ee.x*J.x+ee.y*J.y,Ie=ve.x*J.x+ve.y*J.y,Me=Ie!==0?1/Ie:1/0,qe=2*Math.sqrt(2-2*Ie),Ct=Ie<L1&&$&&N,kt=ee.x*J.y-ee.y*J.x>0;if(Ct&&fe>P){const dt=O.dist($);if(dt>2*D){const vt=O.sub(O.sub($)._mult(D/dt)._round());this.updateDistance($,vt),this.addCurrentVertex(vt,ee,0,0,R),$=vt}}const _t=$&&N;let mt=_t?c:b?"butt":f;if(_t&&mt==="round"&&(Me<y?mt="miter":Me<=2&&(mt="fakeround")),mt==="miter"&&Me>g&&(mt="bevel"),mt==="bevel"&&(Me>2&&(mt="flipbevel"),Me<g&&(mt="miter")),$&&this.updateDistance($,O),mt==="miter")ve._mult(Me),this.addCurrentVertex(O,ve,0,0,R);else if(mt==="flipbevel"){if(Me>100)ve=J.mult(-1);else{const dt=Me*ee.add(J).mag()/ee.sub(J).mag();ve._perp()._mult(dt*(kt?-1:1))}this.addCurrentVertex(O,ve,0,0,R),this.addCurrentVertex(O,ve.mult(-1),0,0,R)}else if(mt==="bevel"||mt==="fakeround"){const dt=-Math.sqrt(Me*Me-1),vt=kt?dt:0,gt=kt?0:dt;if($&&this.addCurrentVertex(O,ee,vt,gt,R),mt==="fakeround"){const st=Math.round(180*qe/Math.PI/20);for(let Vt=1;Vt<st;Vt++){let Dt=Vt/st;if(Dt!==.5){const Vn=Dt-.5;Dt+=Dt*Vn*(Dt-1)*((1.0904+ue*(ue*(3.55645-1.43519*ue)-3.2452))*Vn*Vn+(.848013+ue*(.215638*ue-1.06021)))}const sn=J.sub(ee)._mult(Dt)._add(ee)._unit()._mult(kt?-1:1);this.addHalfVertex(O,sn.x,sn.y,!1,kt,0,R)}}N&&this.addCurrentVertex(O,J,-vt,-gt,R)}else if(mt==="butt")this.addCurrentVertex(O,ve,0,0,R);else if(mt==="square"){const dt=$?1:-1;this.addCurrentVertex(O,ve,dt,dt,R)}else mt==="round"&&($&&(this.addCurrentVertex(O,ee,0,0,R),this.addCurrentVertex(O,ee,1,1,R,!0)),N&&(this.addCurrentVertex(O,J,-1,-1,R,!0),this.addCurrentVertex(O,J,0,0,R)));if(Ct&&fe<S-1){const dt=O.dist(N);if(dt>2*D){const vt=O.add(N.sub(O)._mult(D/dt)._round());this.updateDistance(O,vt),this.addCurrentVertex(vt,J,0,0,R),O=vt}}}}addCurrentVertex(t,r,c,f,g,y=!1){const b=r.y*f-r.x,S=-r.y-r.x*f;this.addHalfVertex(t,r.x+r.y*c,r.y-r.x*c,y,!1,c,g),this.addHalfVertex(t,b,S,y,!0,-f,g),this.distance>Kg/2&&this.totalDistance===0&&(this.distance=0,this.updateScaledDistance(),this.addCurrentVertex(t,r,c,f,g,y))}addHalfVertex({x:t,y:r},c,f,g,y,b,S){const P=.5*(this.lineClips?this.scaledDistance*(Kg-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((t<<1)+(g?1:0),(r<<1)+(y?1:0),Math.round(63*c)+128,Math.round(63*f)+128,1+(b===0?0:b<0?-1:1)|(63&P)<<2,P>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);const D=S.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,D),S.primitiveLength++),y?this.e2=D:this.e1=D}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(t,r){this.distance+=t.dist(r),this.updateScaledDistance()}}let Yg,Jg;Et("LineBucket",Of,{omit:["layers","patternFeatures"]});var Qg={get paint(){return Jg=Jg||new Xi({"line-opacity":new qt(Z.paint_line["line-opacity"]),"line-color":new qt(Z.paint_line["line-color"]),"line-translate":new zt(Z.paint_line["line-translate"]),"line-translate-anchor":new zt(Z.paint_line["line-translate-anchor"]),"line-width":new qt(Z.paint_line["line-width"]),"line-gap-width":new qt(Z.paint_line["line-gap-width"]),"line-offset":new qt(Z.paint_line["line-offset"]),"line-blur":new qt(Z.paint_line["line-blur"]),"line-dasharray":new Ac(Z.paint_line["line-dasharray"]),"line-pattern":new ia(Z.paint_line["line-pattern"]),"line-gradient":new Pc(Z.paint_line["line-gradient"])})},get layout(){return Yg=Yg||new Xi({"line-cap":new zt(Z.layout_line["line-cap"]),"line-join":new qt(Z.layout_line["line-join"]),"line-miter-limit":new zt(Z.layout_line["line-miter-limit"]),"line-round-limit":new zt(Z.layout_line["line-round-limit"]),"line-sort-key":new qt(Z.layout_line["line-sort-key"])})}};class R1 extends qt{possiblyEvaluate(t,r){return r=new Un(Math.floor(r.zoom),{now:r.now,fadeDuration:r.fadeDuration,zoomHistory:r.zoomHistory,transition:r.transition}),super.possiblyEvaluate(t,r)}evaluate(t,r,c,f){return r=be({},r,{zoom:Math.floor(r.zoom)}),super.evaluate(t,r,c,f)}}let Dh;function ey(i,t){return t>0?t+2*i:i}const B1=ui([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),F1=ui([{name:"a_projected_pos",components:3,type:"Float32"}],4);ui([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const O1=ui([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]);ui([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const ty=ui([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),V1=ui([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function $1(i,t,r){return i.sections.forEach(c=>{c.text=function(f,g,y){const b=g.layout.get("text-transform").evaluate(y,{});return b==="uppercase"?f=f.toLocaleUpperCase():b==="lowercase"&&(f=f.toLocaleLowerCase()),wr.applyArabicShaping&&(f=wr.applyArabicShaping(f)),f}(c.text,t,r)}),i}ui([{name:"triangle",components:3,type:"Uint16"}]),ui([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),ui([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),ui([{type:"Float32",name:"offsetX"}]),ui([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);const qc={"!":"︕","#":"＃",$:"＄","%":"％","&":"＆","(":"︵",")":"︶","*":"＊","+":"＋",",":"︐","-":"︲",".":"・","/":"／",":":"︓",";":"︔","<":"︿","=":"＝",">":"﹀","?":"︖","@":"＠","[":"﹇","\\":"＼","]":"﹈","^":"＾",_:"︳","`":"｀","{":"︷","|":"―","}":"︸","~":"～","¢":"￠","£":"￡","¥":"￥","¦":"￤","¬":"￢","¯":"￣","–":"︲","—":"︱","‘":"﹃","’":"﹄","“":"﹁","”":"﹂","…":"︙","‧":"・","₩":"￦","、":"︑","。":"︒","〈":"︿","〉":"﹀","《":"︽","》":"︾","「":"﹁","」":"﹂","『":"﹃","』":"﹄","【":"︻","】":"︼","〔":"︹","〕":"︺","〖":"︗","〗":"︘","！":"︕","（":"︵","）":"︶","，":"︐","－":"︲","．":"・","：":"︓","；":"︔","＜":"︿","＞":"﹀","？":"︖","［":"﹇","］":"﹈","＿":"︳","｛":"︷","｜":"―","｝":"︸","｟":"︵","｠":"︶","｡":"︒","｢":"﹁","｣":"﹂"};var Si=24,ny=Dn,iy=function(i,t,r,c,f){var g,y,b=8*f-c-1,S=(1<<b)-1,P=S>>1,D=-7,R=r?f-1:0,O=r?-1:1,$=i[t+R];for(R+=O,g=$&(1<<-D)-1,$>>=-D,D+=b;D>0;g=256*g+i[t+R],R+=O,D-=8);for(y=g&(1<<-D)-1,g>>=-D,D+=c;D>0;y=256*y+i[t+R],R+=O,D-=8);if(g===0)g=1-P;else{if(g===S)return y?NaN:1/0*($?-1:1);y+=Math.pow(2,c),g-=P}return($?-1:1)*y*Math.pow(2,g-c)},ry=function(i,t,r,c,f,g){var y,b,S,P=8*g-f-1,D=(1<<P)-1,R=D>>1,O=f===23?Math.pow(2,-24)-Math.pow(2,-77):0,$=c?0:g-1,N=c?1:-1,ee=t<0||t===0&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(b=isNaN(t)?1:0,y=D):(y=Math.floor(Math.log(t)/Math.LN2),t*(S=Math.pow(2,-y))<1&&(y--,S*=2),(t+=y+R>=1?O/S:O*Math.pow(2,1-R))*S>=2&&(y++,S/=2),y+R>=D?(b=0,y=D):y+R>=1?(b=(t*S-1)*Math.pow(2,f),y+=R):(b=t*Math.pow(2,R-1)*Math.pow(2,f),y=0));f>=8;i[r+$]=255&b,$+=N,b/=256,f-=8);for(y=y<<f|b,P+=f;P>0;i[r+$]=255&y,$+=N,y/=256,P-=8);i[r+$-N]|=128*ee};function Dn(i){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(i)?i:new Uint8Array(i||0),this.pos=0,this.type=0,this.length=this.buf.length}Dn.Varint=0,Dn.Fixed64=1,Dn.Bytes=2,Dn.Fixed32=5;var Vf=4294967296,sy=1/Vf,oy=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function Gs(i){return i.type===Dn.Bytes?i.readVarint()+i.pos:i.pos+1}function gl(i,t,r){return r?4294967296*t+(i>>>0):4294967296*(t>>>0)+(i>>>0)}function ay(i,t,r){var c=t<=16383?1:t<=2097151?2:t<=268435455?3:Math.floor(Math.log(t)/(7*Math.LN2));r.realloc(c);for(var f=r.pos-1;f>=i;f--)r.buf[f+c]=r.buf[f]}function U1(i,t){for(var r=0;r<i.length;r++)t.writeVarint(i[r])}function N1(i,t){for(var r=0;r<i.length;r++)t.writeSVarint(i[r])}function j1(i,t){for(var r=0;r<i.length;r++)t.writeFloat(i[r])}function q1(i,t){for(var r=0;r<i.length;r++)t.writeDouble(i[r])}function Z1(i,t){for(var r=0;r<i.length;r++)t.writeBoolean(i[r])}function G1(i,t){for(var r=0;r<i.length;r++)t.writeFixed32(i[r])}function W1(i,t){for(var r=0;r<i.length;r++)t.writeSFixed32(i[r])}function H1(i,t){for(var r=0;r<i.length;r++)t.writeFixed64(i[r])}function X1(i,t){for(var r=0;r<i.length;r++)t.writeSFixed64(i[r])}function zh(i,t){return(i[t]|i[t+1]<<8|i[t+2]<<16)+16777216*i[t+3]}function yl(i,t,r){i[r]=t,i[r+1]=t>>>8,i[r+2]=t>>>16,i[r+3]=t>>>24}function ly(i,t){return(i[t]|i[t+1]<<8|i[t+2]<<16)+(i[t+3]<<24)}Dn.prototype={destroy:function(){this.buf=null},readFields:function(i,t,r){for(r=r||this.length;this.pos<r;){var c=this.readVarint(),f=c>>3,g=this.pos;this.type=7&c,i(f,t,this),this.pos===g&&this.skip(c)}return t},readMessage:function(i,t){return this.readFields(i,t,this.readVarint()+this.pos)},readFixed32:function(){var i=zh(this.buf,this.pos);return this.pos+=4,i},readSFixed32:function(){var i=ly(this.buf,this.pos);return this.pos+=4,i},readFixed64:function(){var i=zh(this.buf,this.pos)+zh(this.buf,this.pos+4)*Vf;return this.pos+=8,i},readSFixed64:function(){var i=zh(this.buf,this.pos)+ly(this.buf,this.pos+4)*Vf;return this.pos+=8,i},readFloat:function(){var i=iy(this.buf,this.pos,!0,23,4);return this.pos+=4,i},readDouble:function(){var i=iy(this.buf,this.pos,!0,52,8);return this.pos+=8,i},readVarint:function(i){var t,r,c=this.buf;return t=127&(r=c[this.pos++]),r<128?t:(t|=(127&(r=c[this.pos++]))<<7,r<128?t:(t|=(127&(r=c[this.pos++]))<<14,r<128?t:(t|=(127&(r=c[this.pos++]))<<21,r<128?t:function(f,g,y){var b,S,P=y.buf;if(b=(112&(S=P[y.pos++]))>>4,S<128||(b|=(127&(S=P[y.pos++]))<<3,S<128)||(b|=(127&(S=P[y.pos++]))<<10,S<128)||(b|=(127&(S=P[y.pos++]))<<17,S<128)||(b|=(127&(S=P[y.pos++]))<<24,S<128)||(b|=(1&(S=P[y.pos++]))<<31,S<128))return gl(f,b,g);throw new Error("Expected varint not more than 10 bytes")}(t|=(15&(r=c[this.pos]))<<28,i,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var i=this.readVarint();return i%2==1?(i+1)/-2:i/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var i=this.readVarint()+this.pos,t=this.pos;return this.pos=i,i-t>=12&&oy?function(r,c,f){return oy.decode(r.subarray(c,f))}(this.buf,t,i):function(r,c,f){for(var g="",y=c;y<f;){var b,S,P,D=r[y],R=null,O=D>239?4:D>223?3:D>191?2:1;if(y+O>f)break;O===1?D<128&&(R=D):O===2?(192&(b=r[y+1]))==128&&(R=(31&D)<<6|63&b)<=127&&(R=null):O===3?(S=r[y+2],(192&(b=r[y+1]))==128&&(192&S)==128&&((R=(15&D)<<12|(63&b)<<6|63&S)<=2047||R>=55296&&R<=57343)&&(R=null)):O===4&&(S=r[y+2],P=r[y+3],(192&(b=r[y+1]))==128&&(192&S)==128&&(192&P)==128&&((R=(15&D)<<18|(63&b)<<12|(63&S)<<6|63&P)<=65535||R>=1114112)&&(R=null)),R===null?(R=65533,O=1):R>65535&&(R-=65536,g+=String.fromCharCode(R>>>10&1023|55296),R=56320|1023&R),g+=String.fromCharCode(R),y+=O}return g}(this.buf,t,i)},readBytes:function(){var i=this.readVarint()+this.pos,t=this.buf.subarray(this.pos,i);return this.pos=i,t},readPackedVarint:function(i,t){if(this.type!==Dn.Bytes)return i.push(this.readVarint(t));var r=Gs(this);for(i=i||[];this.pos<r;)i.push(this.readVarint(t));return i},readPackedSVarint:function(i){if(this.type!==Dn.Bytes)return i.push(this.readSVarint());var t=Gs(this);for(i=i||[];this.pos<t;)i.push(this.readSVarint());return i},readPackedBoolean:function(i){if(this.type!==Dn.Bytes)return i.push(this.readBoolean());var t=Gs(this);for(i=i||[];this.pos<t;)i.push(this.readBoolean());return i},readPackedFloat:function(i){if(this.type!==Dn.Bytes)return i.push(this.readFloat());var t=Gs(this);for(i=i||[];this.pos<t;)i.push(this.readFloat());return i},readPackedDouble:function(i){if(this.type!==Dn.Bytes)return i.push(this.readDouble());var t=Gs(this);for(i=i||[];this.pos<t;)i.push(this.readDouble());return i},readPackedFixed32:function(i){if(this.type!==Dn.Bytes)return i.push(this.readFixed32());var t=Gs(this);for(i=i||[];this.pos<t;)i.push(this.readFixed32());return i},readPackedSFixed32:function(i){if(this.type!==Dn.Bytes)return i.push(this.readSFixed32());var t=Gs(this);for(i=i||[];this.pos<t;)i.push(this.readSFixed32());return i},readPackedFixed64:function(i){if(this.type!==Dn.Bytes)return i.push(this.readFixed64());var t=Gs(this);for(i=i||[];this.pos<t;)i.push(this.readFixed64());return i},readPackedSFixed64:function(i){if(this.type!==Dn.Bytes)return i.push(this.readSFixed64());var t=Gs(this);for(i=i||[];this.pos<t;)i.push(this.readSFixed64());return i},skip:function(i){var t=7&i;if(t===Dn.Varint)for(;this.buf[this.pos++]>127;);else if(t===Dn.Bytes)this.pos=this.readVarint()+this.pos;else if(t===Dn.Fixed32)this.pos+=4;else{if(t!==Dn.Fixed64)throw new Error("Unimplemented type: "+t);this.pos+=8}},writeTag:function(i,t){this.writeVarint(i<<3|t)},realloc:function(i){for(var t=this.length||16;t<this.pos+i;)t*=2;if(t!==this.length){var r=new Uint8Array(t);r.set(this.buf),this.buf=r,this.length=t}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(i){this.realloc(4),yl(this.buf,i,this.pos),this.pos+=4},writeSFixed32:function(i){this.realloc(4),yl(this.buf,i,this.pos),this.pos+=4},writeFixed64:function(i){this.realloc(8),yl(this.buf,-1&i,this.pos),yl(this.buf,Math.floor(i*sy),this.pos+4),this.pos+=8},writeSFixed64:function(i){this.realloc(8),yl(this.buf,-1&i,this.pos),yl(this.buf,Math.floor(i*sy),this.pos+4),this.pos+=8},writeVarint:function(i){(i=+i||0)>268435455||i<0?function(t,r){var c,f;if(t>=0?(c=t%4294967296|0,f=t/4294967296|0):(f=~(-t/4294967296),4294967295^(c=~(-t%4294967296))?c=c+1|0:(c=0,f=f+1|0)),t>=18446744073709552e3||t<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");r.realloc(10),function(g,y,b){b.buf[b.pos++]=127&g|128,g>>>=7,b.buf[b.pos++]=127&g|128,g>>>=7,b.buf[b.pos++]=127&g|128,g>>>=7,b.buf[b.pos++]=127&g|128,b.buf[b.pos]=127&(g>>>=7)}(c,0,r),function(g,y){var b=(7&g)<<4;y.buf[y.pos++]|=b|((g>>>=3)?128:0),g&&(y.buf[y.pos++]=127&g|((g>>>=7)?128:0),g&&(y.buf[y.pos++]=127&g|((g>>>=7)?128:0),g&&(y.buf[y.pos++]=127&g|((g>>>=7)?128:0),g&&(y.buf[y.pos++]=127&g|((g>>>=7)?128:0),g&&(y.buf[y.pos++]=127&g)))))}(f,r)}(i,this):(this.realloc(4),this.buf[this.pos++]=127&i|(i>127?128:0),i<=127||(this.buf[this.pos++]=127&(i>>>=7)|(i>127?128:0),i<=127||(this.buf[this.pos++]=127&(i>>>=7)|(i>127?128:0),i<=127||(this.buf[this.pos++]=i>>>7&127))))},writeSVarint:function(i){this.writeVarint(i<0?2*-i-1:2*i)},writeBoolean:function(i){this.writeVarint(!!i)},writeString:function(i){i=String(i),this.realloc(4*i.length),this.pos++;var t=this.pos;this.pos=function(c,f,g){for(var y,b,S=0;S<f.length;S++){if((y=f.charCodeAt(S))>55295&&y<57344){if(!b){y>56319||S+1===f.length?(c[g++]=239,c[g++]=191,c[g++]=189):b=y;continue}if(y<56320){c[g++]=239,c[g++]=191,c[g++]=189,b=y;continue}y=b-55296<<10|y-56320|65536,b=null}else b&&(c[g++]=239,c[g++]=191,c[g++]=189,b=null);y<128?c[g++]=y:(y<2048?c[g++]=y>>6|192:(y<65536?c[g++]=y>>12|224:(c[g++]=y>>18|240,c[g++]=y>>12&63|128),c[g++]=y>>6&63|128),c[g++]=63&y|128)}return g}(this.buf,i,this.pos);var r=this.pos-t;r>=128&&ay(t,r,this),this.pos=t-1,this.writeVarint(r),this.pos+=r},writeFloat:function(i){this.realloc(4),ry(this.buf,i,this.pos,!0,23,4),this.pos+=4},writeDouble:function(i){this.realloc(8),ry(this.buf,i,this.pos,!0,52,8),this.pos+=8},writeBytes:function(i){var t=i.length;this.writeVarint(t),this.realloc(t);for(var r=0;r<t;r++)this.buf[this.pos++]=i[r]},writeRawMessage:function(i,t){this.pos++;var r=this.pos;i(t,this);var c=this.pos-r;c>=128&&ay(r,c,this),this.pos=r-1,this.writeVarint(c),this.pos+=c},writeMessage:function(i,t,r){this.writeTag(i,Dn.Bytes),this.writeRawMessage(t,r)},writePackedVarint:function(i,t){t.length&&this.writeMessage(i,U1,t)},writePackedSVarint:function(i,t){t.length&&this.writeMessage(i,N1,t)},writePackedBoolean:function(i,t){t.length&&this.writeMessage(i,Z1,t)},writePackedFloat:function(i,t){t.length&&this.writeMessage(i,j1,t)},writePackedDouble:function(i,t){t.length&&this.writeMessage(i,q1,t)},writePackedFixed32:function(i,t){t.length&&this.writeMessage(i,G1,t)},writePackedSFixed32:function(i,t){t.length&&this.writeMessage(i,W1,t)},writePackedFixed64:function(i,t){t.length&&this.writeMessage(i,H1,t)},writePackedSFixed64:function(i,t){t.length&&this.writeMessage(i,X1,t)},writeBytesField:function(i,t){this.writeTag(i,Dn.Bytes),this.writeBytes(t)},writeFixed32Field:function(i,t){this.writeTag(i,Dn.Fixed32),this.writeFixed32(t)},writeSFixed32Field:function(i,t){this.writeTag(i,Dn.Fixed32),this.writeSFixed32(t)},writeFixed64Field:function(i,t){this.writeTag(i,Dn.Fixed64),this.writeFixed64(t)},writeSFixed64Field:function(i,t){this.writeTag(i,Dn.Fixed64),this.writeSFixed64(t)},writeVarintField:function(i,t){this.writeTag(i,Dn.Varint),this.writeVarint(t)},writeSVarintField:function(i,t){this.writeTag(i,Dn.Varint),this.writeSVarint(t)},writeStringField:function(i,t){this.writeTag(i,Dn.Bytes),this.writeString(t)},writeFloatField:function(i,t){this.writeTag(i,Dn.Fixed32),this.writeFloat(t)},writeDoubleField:function(i,t){this.writeTag(i,Dn.Fixed64),this.writeDouble(t)},writeBooleanField:function(i,t){this.writeVarintField(i,!!t)}};var $f=I(ny);const Uf=3;function K1(i,t,r){i===1&&r.readMessage(Y1,t)}function Y1(i,t,r){if(i===3){const{id:c,bitmap:f,width:g,height:y,left:b,top:S,advance:P}=r.readMessage(J1,{});t.push({id:c,bitmap:new Fc({width:g+2*Uf,height:y+2*Uf},f),metrics:{width:g,height:y,left:b,top:S,advance:P}})}}function J1(i,t,r){i===1?t.id=r.readVarint():i===2?t.bitmap=r.readBytes():i===3?t.width=r.readVarint():i===4?t.height=r.readVarint():i===5?t.left=r.readSVarint():i===6?t.top=r.readSVarint():i===7&&(t.advance=r.readVarint())}const cy=Uf;function uy(i){let t=0,r=0;for(const y of i)t+=y.w*y.h,r=Math.max(r,y.w);i.sort((y,b)=>b.h-y.h);const c=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(t/.95)),r),h:1/0}];let f=0,g=0;for(const y of i)for(let b=c.length-1;b>=0;b--){const S=c[b];if(!(y.w>S.w||y.h>S.h)){if(y.x=S.x,y.y=S.y,g=Math.max(g,y.y+y.h),f=Math.max(f,y.x+y.w),y.w===S.w&&y.h===S.h){const P=c.pop();b<c.length&&(c[b]=P)}else y.h===S.h?(S.x+=y.w,S.w-=y.w):y.w===S.w?(S.y+=y.h,S.h-=y.h):(c.push({x:S.x+y.w,y:S.y,w:S.w-y.w,h:y.h}),S.y+=y.h,S.h-=y.h);break}}return{w:f,h:g,fill:t/(f*g)||0}}const or=1;class Nf{constructor(t,{pixelRatio:r,version:c,stretchX:f,stretchY:g,content:y}){this.paddedRect=t,this.pixelRatio=r,this.stretchX=f,this.stretchY=g,this.content=y,this.version=c}get tl(){return[this.paddedRect.x+or,this.paddedRect.y+or]}get br(){return[this.paddedRect.x+this.paddedRect.w-or,this.paddedRect.y+this.paddedRect.h-or]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2*or)/this.pixelRatio,(this.paddedRect.h-2*or)/this.pixelRatio]}}class hy{constructor(t,r){const c={},f={};this.haveRenderCallbacks=[];const g=[];this.addImages(t,c,g),this.addImages(r,f,g);const{w:y,h:b}=uy(g),S=new Lr({width:y||1,height:b||1});for(const P in t){const D=t[P],R=c[P].paddedRect;Lr.copy(D.data,S,{x:0,y:0},{x:R.x+or,y:R.y+or},D.data)}for(const P in r){const D=r[P],R=f[P].paddedRect,O=R.x+or,$=R.y+or,N=D.data.width,ee=D.data.height;Lr.copy(D.data,S,{x:0,y:0},{x:O,y:$},D.data),Lr.copy(D.data,S,{x:0,y:ee-1},{x:O,y:$-1},{width:N,height:1}),Lr.copy(D.data,S,{x:0,y:0},{x:O,y:$+ee},{width:N,height:1}),Lr.copy(D.data,S,{x:N-1,y:0},{x:O-1,y:$},{width:1,height:ee}),Lr.copy(D.data,S,{x:0,y:0},{x:O+N,y:$},{width:1,height:ee})}this.image=S,this.iconPositions=c,this.patternPositions=f}addImages(t,r,c){for(const f in t){const g=t[f],y={x:0,y:0,w:g.data.width+2*or,h:g.data.height+2*or};c.push(y),r[f]=new Nf(y,g),g.hasRenderCallback&&this.haveRenderCallbacks.push(f)}}patchUpdatedImages(t,r){t.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const c in t.updatedImages)this.patchUpdatedImage(this.iconPositions[c],t.getImage(c),r),this.patchUpdatedImage(this.patternPositions[c],t.getImage(c),r)}patchUpdatedImage(t,r,c){if(!t||!r||t.version===r.version)return;t.version=r.version;const[f,g]=t.tl;c.update(r.data,void 0,{x:f,y:g})}}var wo;Et("ImagePosition",Nf),Et("ImageAtlas",hy),a.WritingMode=void 0,(wo=a.WritingMode||(a.WritingMode={}))[wo.none=0]="none",wo[wo.horizontal=1]="horizontal",wo[wo.vertical=2]="vertical",wo[wo.horizontalOnly=3]="horizontalOnly";const Zc=-17;class Gc{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(t,r){const c=new Gc;return c.scale=t||1,c.fontStack=r,c}static forImage(t){const r=new Gc;return r.imageName=t,r}}class _l{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(t,r){const c=new _l;for(let f=0;f<t.sections.length;f++){const g=t.sections[f];g.image?c.addImageSection(g):c.addTextSection(g,r)}return c}length(){return this.text.length}getSection(t){return this.sections[this.sectionIndex[t]]}getSectionIndex(t){return this.sectionIndex[t]}getCharCode(t){return this.text.charCodeAt(t)}verticalizePunctuation(){this.text=function(t){let r="";for(let c=0;c<t.length;c++){const f=t.charCodeAt(c+1)||null,g=t.charCodeAt(c-1)||null;r+=f&&mh(f)&&!qc[t[c+1]]||g&&mh(g)&&!qc[t[c-1]]||!qc[t[c]]?t[c]:qc[t[c]]}return r}(this.text)}trim(){let t=0;for(let c=0;c<this.text.length&&Rh[this.text.charCodeAt(c)];c++)t++;let r=this.text.length;for(let c=this.text.length-1;c>=0&&c>=t&&Rh[this.text.charCodeAt(c)];c--)r--;this.text=this.text.substring(t,r),this.sectionIndex=this.sectionIndex.slice(t,r)}substring(t,r){const c=new _l;return c.text=this.text.substring(t,r),c.sectionIndex=this.sectionIndex.slice(t,r),c.sections=this.sections,c}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((t,r)=>Math.max(t,this.sections[r].scale),0)}addTextSection(t,r){this.text+=t.text,this.sections.push(Gc.forText(t.scale,t.fontStack||r));const c=this.sections.length-1;for(let f=0;f<t.text.length;++f)this.sectionIndex.push(c)}addImageSection(t){const r=t.image?t.image.name:"";if(r.length===0)return void pe("Can't add FormattedSection with an empty image.");const c=this.getNextImageSectionCharCode();c?(this.text+=String.fromCharCode(c),this.sections.push(Gc.forImage(r)),this.sectionIndex.push(this.sections.length-1)):pe("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function Lh(i,t,r,c,f,g,y,b,S,P,D,R,O,$,N,ee){const J=_l.fromFeature(i,f);let fe;R===a.WritingMode.vertical&&J.verticalizePunctuation();const{processBidirectionalText:ve,processStyledBidirectionalText:ue}=wr;if(ve&&J.sections.length===1){fe=[];const qe=ve(J.toString(),jf(J,P,g,t,c,$,N));for(const Ct of qe){const kt=new _l;kt.text=Ct,kt.sections=J.sections;for(let _t=0;_t<Ct.length;_t++)kt.sectionIndex.push(0);fe.push(kt)}}else if(ue){fe=[];const qe=ue(J.text,J.sectionIndex,jf(J,P,g,t,c,$,N));for(const Ct of qe){const kt=new _l;kt.text=Ct[0],kt.sectionIndex=Ct[1],kt.sections=J.sections,fe.push(kt)}}else fe=function(qe,Ct){const kt=[],_t=qe.text;let mt=0;for(const dt of Ct)kt.push(qe.substring(mt,dt)),mt=dt;return mt<_t.length&&kt.push(qe.substring(mt,_t.length)),kt}(J,jf(J,P,g,t,c,$,N));const Ie=[],Me={positionedLines:Ie,text:J.toString(),top:D[1],bottom:D[1],left:D[0],right:D[0],writingMode:R,iconsInText:!1,verticalizable:!1};return function(qe,Ct,kt,_t,mt,dt,vt,gt,st,Vt,Dt,sn){let Vn=0,Nn=Zc,yi=0,Br=0;const zi=gt==="right"?1:gt==="left"?0:.5;let hi=0;for(const di of mt){di.trim();const Ri=di.getMaxScale(),ji=(Ri-1)*Si,Yi={positionedGlyphs:[],lineOffset:0};qe.positionedLines[hi]=Yi;const lr=Yi.positionedGlyphs;let cr=0;if(!di.length()){Nn+=dt,++hi;continue}for(let Bi=0;Bi<di.length();Bi++){const on=di.getSection(Bi),Sr=di.getSectionIndex(Bi),Fi=di.getCharCode(Bi);let qi=0,Yr=null,hs=null,ds=null,Ws=Si;const Jr=!(st===a.WritingMode.horizontal||!Dt&&!Ka(Fi)||Dt&&(Rh[Fi]||(Ci=Fi,yt.Arabic(Ci)||yt["Arabic Supplement"](Ci)||yt["Arabic Extended-A"](Ci)||yt["Arabic Presentation Forms-A"](Ci)||yt["Arabic Presentation Forms-B"](Ci))));if(on.imageName){const Fr=_t[on.imageName];if(!Fr)continue;ds=on.imageName,qe.iconsInText=qe.iconsInText||!0,hs=Fr.paddedRect;const ur=Fr.displaySize;on.scale=on.scale*Si/sn,Yr={width:ur[0],height:ur[1],left:or,top:-cy,advance:Jr?ur[1]:ur[0]},qi=ji+(Si-ur[1]*on.scale),Ws=Yr.advance;const Hs=Jr?ur[0]*on.scale-Si*Ri:ur[1]*on.scale-Si*Ri;Hs>0&&Hs>cr&&(cr=Hs)}else{const Fr=kt[on.fontStack],ur=Fr&&Fr[Fi];if(ur&&ur.rect)hs=ur.rect,Yr=ur.metrics;else{const Hs=Ct[on.fontStack],Yc=Hs&&Hs[Fi];if(!Yc)continue;Yr=Yc.metrics}qi=(Ri-on.scale)*Si}Jr?(qe.verticalizable=!0,lr.push({glyph:Fi,imageName:ds,x:Vn,y:Nn+qi,vertical:Jr,scale:on.scale,fontStack:on.fontStack,sectionIndex:Sr,metrics:Yr,rect:hs}),Vn+=Ws*on.scale+Vt):(lr.push({glyph:Fi,imageName:ds,x:Vn,y:Nn+qi,vertical:Jr,scale:on.scale,fontStack:on.fontStack,sectionIndex:Sr,metrics:Yr,rect:hs}),Vn+=Yr.advance*on.scale+Vt)}lr.length!==0&&(yi=Math.max(Vn-Vt,yi),tw(lr,0,lr.length-1,zi,cr)),Vn=0;const Qn=dt*Ri+cr;Yi.lineOffset=Math.max(cr,ji),Nn+=Qn,Br=Math.max(Qn,Br),++hi}var Ci;const Li=Nn-Zc,{horizontalAlign:Ni,verticalAlign:ar}=qf(vt);(function(di,Ri,ji,Yi,lr,cr,Qn,Bi,on){const Sr=(Ri-ji)*lr;let Fi=0;Fi=cr!==Qn?-Bi*Yi-Zc:(-Yi*on+.5)*Qn;for(const qi of di)for(const Yr of qi.positionedGlyphs)Yr.x+=Sr,Yr.y+=Fi})(qe.positionedLines,zi,Ni,ar,yi,Br,dt,Li,mt.length),qe.top+=-ar*Li,qe.bottom=qe.top+Li,qe.left+=-Ni*yi,qe.right=qe.left+yi}(Me,t,r,c,fe,y,b,S,R,P,O,ee),!function(qe){for(const Ct of qe)if(Ct.positionedGlyphs.length!==0)return!1;return!0}(Ie)&&Me}const Rh={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},Q1={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function dy(i,t,r,c,f,g){if(t.imageName){const y=c[t.imageName];return y?y.displaySize[0]*t.scale*Si/g+f:0}{const y=r[t.fontStack],b=y&&y[i];return b?b.metrics.advance*t.scale+f:0}}function fy(i,t,r,c){const f=Math.pow(i-t,2);return c?i<t?f/2:2*f:f+Math.abs(r)*r}function ew(i,t,r){let c=0;return i===10&&(c-=1e4),r&&(c+=150),i!==40&&i!==65288||(c+=50),t!==41&&t!==65289||(c+=50),c}function py(i,t,r,c,f,g){let y=null,b=fy(t,r,f,g);for(const S of c){const P=fy(t-S.x,r,f,g)+S.badness;P<=b&&(y=S,b=P)}return{index:i,x:t,priorBreak:y,badness:b}}function my(i){return i?my(i.priorBreak).concat(i.index):[]}function jf(i,t,r,c,f,g,y){if(g!=="point")return[];if(!i)return[];const b=[],S=function(O,$,N,ee,J,fe){let ve=0;for(let ue=0;ue<O.length();ue++){const Ie=O.getSection(ue);ve+=dy(O.getCharCode(ue),Ie,ee,J,$,fe)}return ve/Math.max(1,Math.ceil(ve/N))}(i,t,r,c,f,y),P=i.text.indexOf("​")>=0;let D=0;for(let O=0;O<i.length();O++){const $=i.getSection(O),N=i.getCharCode(O);if(Rh[N]||(D+=dy(N,$,c,f,t,y)),O<i.length()-1){const ee=!((R=N)<11904||!(yt["Bopomofo Extended"](R)||yt.Bopomofo(R)||yt["CJK Compatibility Forms"](R)||yt["CJK Compatibility Ideographs"](R)||yt["CJK Compatibility"](R)||yt["CJK Radicals Supplement"](R)||yt["CJK Strokes"](R)||yt["CJK Symbols and Punctuation"](R)||yt["CJK Unified Ideographs Extension A"](R)||yt["CJK Unified Ideographs"](R)||yt["Enclosed CJK Letters and Months"](R)||yt["Halfwidth and Fullwidth Forms"](R)||yt.Hiragana(R)||yt["Ideographic Description Characters"](R)||yt["Kangxi Radicals"](R)||yt["Katakana Phonetic Extensions"](R)||yt.Katakana(R)||yt["Vertical Forms"](R)||yt["Yi Radicals"](R)||yt["Yi Syllables"](R)));(Q1[N]||ee||$.imageName)&&b.push(py(O+1,D,S,b,ew(N,i.getCharCode(O+1),ee&&P),!1))}}var R;return my(py(i.length(),D,S,b,0,!0))}function qf(i){let t=.5,r=.5;switch(i){case"right":case"top-right":case"bottom-right":t=1;break;case"left":case"top-left":case"bottom-left":t=0}switch(i){case"bottom":case"bottom-right":case"bottom-left":r=1;break;case"top":case"top-right":case"top-left":r=0}return{horizontalAlign:t,verticalAlign:r}}function tw(i,t,r,c,f){if(!c&&!f)return;const g=i[r],y=(i[r].x+g.metrics.advance*g.scale)*c;for(let b=t;b<=r;b++)i[b].x-=y,i[b].y+=f}function nw(i,t,r){const{horizontalAlign:c,verticalAlign:f}=qf(r),g=t[0]-i.displaySize[0]*c,y=t[1]-i.displaySize[1]*f;return{image:i,top:y,bottom:y+i.displaySize[1],left:g,right:g+i.displaySize[0]}}function gy(i,t,r,c,f,g){const y=i.image;let b;if(y.content){const J=y.content,fe=y.pixelRatio||1;b=[J[0]/fe,J[1]/fe,y.displaySize[0]-J[2]/fe,y.displaySize[1]-J[3]/fe]}const S=t.left*g,P=t.right*g;let D,R,O,$;r==="width"||r==="both"?($=f[0]+S-c[3],R=f[0]+P+c[1]):($=f[0]+(S+P-y.displaySize[0])/2,R=$+y.displaySize[0]);const N=t.top*g,ee=t.bottom*g;return r==="height"||r==="both"?(D=f[1]+N-c[0],O=f[1]+ee+c[2]):(D=f[1]+(N+ee-y.displaySize[1])/2,O=D+y.displaySize[1]),{image:y,top:D,right:R,bottom:O,left:$,collisionPadding:b}}const Wc=255,Is=128,So=Wc*Is;function yy(i,t){const{expression:r}=t;if(r.kind==="constant")return{kind:"constant",layoutSize:r.evaluate(new Un(i+1))};if(r.kind==="source")return{kind:"source"};{const{zoomStops:c,interpolationType:f}=r;let g=0;for(;g<c.length&&c[g]<=i;)g++;g=Math.max(0,g-1);let y=g;for(;y<c.length&&c[y]<i+1;)y++;y=Math.min(c.length-1,y);const b=c[g],S=c[y];return r.kind==="composite"?{kind:"composite",minZoom:b,maxZoom:S,interpolationType:f}:{kind:"camera",minZoom:b,maxZoom:S,minSize:r.evaluate(new Un(b)),maxSize:r.evaluate(new Un(S)),interpolationType:f}}}function Zf(i,t,r){let c="never";const f=i.get(t);return f?c=f:i.get(r)&&(c="always"),c}const iw=bo.VectorTileFeature.types,rw=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Bh(i,t,r,c,f,g,y,b,S,P,D,R,O){const $=b?Math.min(So,Math.round(b[0])):0,N=b?Math.min(So,Math.round(b[1])):0;i.emplaceBack(t,r,Math.round(32*c),Math.round(32*f),g,y,($<<1)+(S?1:0),N,16*P,16*D,256*R,256*O)}function Gf(i,t,r){i.emplaceBack(t.x,t.y,r),i.emplaceBack(t.x,t.y,r),i.emplaceBack(t.x,t.y,r),i.emplaceBack(t.x,t.y,r)}function sw(i){for(const t of i.sections)if(gh(t.text))return!0;return!1}class Wf{constructor(t){this.layoutVertexArray=new Te,this.indexArray=new et,this.programConfigurations=t,this.segments=new pt,this.dynamicLayoutVertexArray=new De,this.opacityVertexArray=new Ye,this.hasVisibleVertices=!1,this.placedSymbolArray=new w}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(t,r,c,f){this.isEmpty()||(c&&(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,B1.members),this.indexBuffer=t.createIndexBuffer(this.indexArray,r),this.dynamicLayoutVertexBuffer=t.createVertexBuffer(this.dynamicLayoutVertexArray,F1.members,!0),this.opacityVertexBuffer=t.createVertexBuffer(this.opacityVertexArray,rw,!0),this.opacityVertexBuffer.itemSize=1),(c||f)&&this.programConfigurations.upload(t))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}Et("SymbolBuffers",Wf);class Hf{constructor(t,r,c){this.layoutVertexArray=new t,this.layoutAttributes=r,this.indexArray=new c,this.segments=new pt,this.collisionVertexArray=new ct}upload(t){this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=t.createVertexBuffer(this.collisionVertexArray,O1.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}Et("CollisionBuffers",Hf);class vl{constructor(t){this.collisionBoxArray=t.collisionBoxArray,this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(y=>y.id),this.index=t.index,this.pixelRatio=t.pixelRatio,this.sourceLayerIndex=t.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=Ef([]),this.placementViewportMatrix=Ef([]);const r=this.layers[0]._unevaluatedLayout._values;this.textSizeData=yy(this.zoom,r["text-size"]),this.iconSizeData=yy(this.zoom,r["icon-size"]);const c=this.layers[0].layout,f=c.get("symbol-sort-key"),g=c.get("symbol-z-order");this.canOverlap=Zf(c,"text-overlap","text-allow-overlap")!=="never"||Zf(c,"icon-overlap","icon-allow-overlap")!=="never"||c.get("text-ignore-placement")||c.get("icon-ignore-placement"),this.sortFeaturesByKey=g!=="viewport-y"&&!f.isConstant(),this.sortFeaturesByY=(g==="viewport-y"||g==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,c.get("symbol-placement")==="point"&&(this.writingModes=c.get("text-writing-mode").map(y=>a.WritingMode[y])),this.stateDependentLayerIds=this.layers.filter(y=>y.isStateDependent()).map(y=>y.id),this.sourceID=t.sourceID}createArrays(){this.text=new Wf(new cs(this.layers,this.zoom,t=>/^text/.test(t))),this.icon=new Wf(new cs(this.layers,this.zoom,t=>/^icon/.test(t))),this.glyphOffsetArray=new A,this.lineVertexArray=new L,this.symbolInstances=new C}calculateGlyphDependencies(t,r,c,f,g){for(let y=0;y<t.length;y++)if(r[t.charCodeAt(y)]=!0,(c||f)&&g){const b=qc[t.charAt(y)];b&&(r[b.charCodeAt(0)]=!0)}}populate(t,r,c){const f=this.layers[0],g=f.layout,y=g.get("text-font"),b=g.get("text-field"),S=g.get("icon-image"),P=(b.value.kind!=="constant"||b.value.value instanceof Ii&&!b.value.value.isEmpty()||b.value.value.toString().length>0)&&(y.value.kind!=="constant"||y.value.value.length>0),D=S.value.kind!=="constant"||!!S.value.value||Object.keys(S.parameters).length>0,R=g.get("symbol-sort-key");if(this.features=[],!P&&!D)return;const O=r.iconDependencies,$=r.glyphDependencies,N=r.availableImages,ee=new Un(this.zoom);for(const{feature:J,id:fe,index:ve,sourceLayerIndex:ue}of t){const Ie=f._featureFilter.needGeometry,Me=aa(J,Ie);if(!f._featureFilter.filter(ee,Me,c))continue;let qe,Ct;if(Ie||(Me.geometry=us(J)),P){const _t=f.getValueAndResolveTokens("text-field",Me,c,N),mt=Ii.factory(_t);sw(mt)&&(this.hasRTLText=!0),(!this.hasRTLText||Ec()==="unavailable"||this.hasRTLText&&wr.isParsed())&&(qe=$1(mt,f,Me))}if(D){const _t=f.getValueAndResolveTokens("icon-image",Me,c,N);Ct=_t instanceof _r?_t:_r.fromString(_t)}if(!qe&&!Ct)continue;const kt=this.sortFeaturesByKey?R.evaluate(Me,{},c):void 0;if(this.features.push({id:fe,text:qe,icon:Ct,index:ve,sourceLayerIndex:ue,geometry:Me.geometry,properties:J.properties,type:iw[J.type],sortKey:kt}),Ct&&(O[Ct.name]=!0),qe){const _t=y.evaluate(Me,{},c).join(","),mt=g.get("text-rotation-alignment")!=="viewport"&&g.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(a.WritingMode.vertical)>=0;for(const dt of qe.sections)if(dt.image)O[dt.image.name]=!0;else{const vt=Xa(qe.toString()),gt=dt.fontStack||_t,st=$[gt]=$[gt]||{};this.calculateGlyphDependencies(dt.text,st,mt,this.allowVerticalPlacement,vt)}}}g.get("symbol-placement")==="line"&&(this.features=function(J){const fe={},ve={},ue=[];let Ie=0;function Me(_t){ue.push(J[_t]),Ie++}function qe(_t,mt,dt){const vt=ve[_t];return delete ve[_t],ve[mt]=vt,ue[vt].geometry[0].pop(),ue[vt].geometry[0]=ue[vt].geometry[0].concat(dt[0]),vt}function Ct(_t,mt,dt){const vt=fe[mt];return delete fe[mt],fe[_t]=vt,ue[vt].geometry[0].shift(),ue[vt].geometry[0]=dt[0].concat(ue[vt].geometry[0]),vt}function kt(_t,mt,dt){const vt=dt?mt[0][mt[0].length-1]:mt[0][0];return`${_t}:${vt.x}:${vt.y}`}for(let _t=0;_t<J.length;_t++){const mt=J[_t],dt=mt.geometry,vt=mt.text?mt.text.toString():null;if(!vt){Me(_t);continue}const gt=kt(vt,dt),st=kt(vt,dt,!0);if(gt in ve&&st in fe&&ve[gt]!==fe[st]){const Vt=Ct(gt,st,dt),Dt=qe(gt,st,ue[Vt].geometry);delete fe[gt],delete ve[st],ve[kt(vt,ue[Dt].geometry,!0)]=Dt,ue[Vt].geometry=null}else gt in ve?qe(gt,st,dt):st in fe?Ct(gt,st,dt):(Me(_t),fe[gt]=Ie-1,ve[st]=Ie-1)}return ue.filter(_t=>_t.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((J,fe)=>J.sortKey-fe.sortKey)}update(t,r,c){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(t,r,this.layers,c),this.icon.programConfigurations.updatePaintArrays(t,r,this.layers,c))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(t){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(t),this.iconCollisionBox.upload(t)),this.text.upload(t,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(t,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(t,r){const c=this.lineVertexArray.length;if(t.segment!==void 0){let f=t.dist(r[t.segment+1]),g=t.dist(r[t.segment]);const y={};for(let b=t.segment+1;b<r.length;b++)y[b]={x:r[b].x,y:r[b].y,tileUnitDistanceFromAnchor:f},b<r.length-1&&(f+=r[b+1].dist(r[b]));for(let b=t.segment||0;b>=0;b--)y[b]={x:r[b].x,y:r[b].y,tileUnitDistanceFromAnchor:g},b>0&&(g+=r[b-1].dist(r[b]));for(let b=0;b<r.length;b++){const S=y[b];this.lineVertexArray.emplaceBack(S.x,S.y,S.tileUnitDistanceFromAnchor)}}return{lineStartIndex:c,lineLength:this.lineVertexArray.length-c}}addSymbols(t,r,c,f,g,y,b,S,P,D,R,O){const $=t.indexArray,N=t.layoutVertexArray,ee=t.segments.prepareSegment(4*r.length,N,$,this.canOverlap?y.sortKey:void 0),J=this.glyphOffsetArray.length,fe=ee.vertexLength,ve=this.allowVerticalPlacement&&b===a.WritingMode.vertical?Math.PI/2:0,ue=y.text&&y.text.sections;for(let Ie=0;Ie<r.length;Ie++){const{tl:Me,tr:qe,bl:Ct,br:kt,tex:_t,pixelOffsetTL:mt,pixelOffsetBR:dt,minFontScaleX:vt,minFontScaleY:gt,glyphOffset:st,isSDF:Vt,sectionIndex:Dt}=r[Ie],sn=ee.vertexLength,Vn=st[1];Bh(N,S.x,S.y,Me.x,Vn+Me.y,_t.x,_t.y,c,Vt,mt.x,mt.y,vt,gt),Bh(N,S.x,S.y,qe.x,Vn+qe.y,_t.x+_t.w,_t.y,c,Vt,dt.x,mt.y,vt,gt),Bh(N,S.x,S.y,Ct.x,Vn+Ct.y,_t.x,_t.y+_t.h,c,Vt,mt.x,dt.y,vt,gt),Bh(N,S.x,S.y,kt.x,Vn+kt.y,_t.x+_t.w,_t.y+_t.h,c,Vt,dt.x,dt.y,vt,gt),Gf(t.dynamicLayoutVertexArray,S,ve),$.emplaceBack(sn,sn+1,sn+2),$.emplaceBack(sn+1,sn+2,sn+3),ee.vertexLength+=4,ee.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(st[0]),Ie!==r.length-1&&Dt===r[Ie+1].sectionIndex||t.programConfigurations.populatePaintArrays(N.length,y,y.index,{},O,ue&&ue[Dt])}t.placedSymbolArray.emplaceBack(S.x,S.y,J,this.glyphOffsetArray.length-J,fe,P,D,S.segment,c?c[0]:0,c?c[1]:0,f[0],f[1],b,0,!1,0,R)}_addCollisionDebugVertex(t,r,c,f,g,y){return r.emplaceBack(0,0),t.emplaceBack(c.x,c.y,f,g,Math.round(y.x),Math.round(y.y))}addCollisionDebugVertices(t,r,c,f,g,y,b){const S=g.segments.prepareSegment(4,g.layoutVertexArray,g.indexArray),P=S.vertexLength,D=g.layoutVertexArray,R=g.collisionVertexArray,O=b.anchorX,$=b.anchorY;this._addCollisionDebugVertex(D,R,y,O,$,new k(t,r)),this._addCollisionDebugVertex(D,R,y,O,$,new k(c,r)),this._addCollisionDebugVertex(D,R,y,O,$,new k(c,f)),this._addCollisionDebugVertex(D,R,y,O,$,new k(t,f)),S.vertexLength+=4;const N=g.indexArray;N.emplaceBack(P,P+1),N.emplaceBack(P+1,P+2),N.emplaceBack(P+2,P+3),N.emplaceBack(P+3,P),S.primitiveLength+=4}addDebugCollisionBoxes(t,r,c,f){for(let g=t;g<r;g++){const y=this.collisionBoxArray.get(g);this.addCollisionDebugVertices(y.x1,y.y1,y.x2,y.y2,f?this.textCollisionBox:this.iconCollisionBox,y.anchorPoint,c)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new Hf(it,ty.members,bt),this.iconCollisionBox=new Hf(it,ty.members,bt);for(let t=0;t<this.symbolInstances.length;t++){const r=this.symbolInstances.get(t);this.addDebugCollisionBoxes(r.textBoxStartIndex,r.textBoxEndIndex,r,!0),this.addDebugCollisionBoxes(r.verticalTextBoxStartIndex,r.verticalTextBoxEndIndex,r,!0),this.addDebugCollisionBoxes(r.iconBoxStartIndex,r.iconBoxEndIndex,r,!1),this.addDebugCollisionBoxes(r.verticalIconBoxStartIndex,r.verticalIconBoxEndIndex,r,!1)}}_deserializeCollisionBoxesForSymbol(t,r,c,f,g,y,b,S,P){const D={};for(let R=r;R<c;R++){const O=t.get(R);D.textBox={x1:O.x1,y1:O.y1,x2:O.x2,y2:O.y2,anchorPointX:O.anchorPointX,anchorPointY:O.anchorPointY},D.textFeatureIndex=O.featureIndex;break}for(let R=f;R<g;R++){const O=t.get(R);D.verticalTextBox={x1:O.x1,y1:O.y1,x2:O.x2,y2:O.y2,anchorPointX:O.anchorPointX,anchorPointY:O.anchorPointY},D.verticalTextFeatureIndex=O.featureIndex;break}for(let R=y;R<b;R++){const O=t.get(R);D.iconBox={x1:O.x1,y1:O.y1,x2:O.x2,y2:O.y2,anchorPointX:O.anchorPointX,anchorPointY:O.anchorPointY},D.iconFeatureIndex=O.featureIndex;break}for(let R=S;R<P;R++){const O=t.get(R);D.verticalIconBox={x1:O.x1,y1:O.y1,x2:O.x2,y2:O.y2,anchorPointX:O.anchorPointX,anchorPointY:O.anchorPointY},D.verticalIconFeatureIndex=O.featureIndex;break}return D}deserializeCollisionBoxes(t){this.collisionArrays=[];for(let r=0;r<this.symbolInstances.length;r++){const c=this.symbolInstances.get(r);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(t,c.textBoxStartIndex,c.textBoxEndIndex,c.verticalTextBoxStartIndex,c.verticalTextBoxEndIndex,c.iconBoxStartIndex,c.iconBoxEndIndex,c.verticalIconBoxStartIndex,c.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(t,r){const c=t.placedSymbolArray.get(r),f=c.vertexStartIndex+4*c.numGlyphs;for(let g=c.vertexStartIndex;g<f;g+=4)t.indexArray.emplaceBack(g,g+1,g+2),t.indexArray.emplaceBack(g+1,g+2,g+3)}getSortedSymbolIndexes(t){if(this.sortedAngle===t&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const r=Math.sin(t),c=Math.cos(t),f=[],g=[],y=[];for(let b=0;b<this.symbolInstances.length;++b){y.push(b);const S=this.symbolInstances.get(b);f.push(0|Math.round(r*S.anchorX+c*S.anchorY)),g.push(S.featureIndex)}return y.sort((b,S)=>f[b]-f[S]||g[S]-g[b]),y}addToSortKeyRanges(t,r){const c=this.sortKeyRanges[this.sortKeyRanges.length-1];c&&c.sortKey===r?c.symbolInstanceEnd=t+1:this.sortKeyRanges.push({sortKey:r,symbolInstanceStart:t,symbolInstanceEnd:t+1})}sortFeatures(t){if(this.sortFeaturesByY&&this.sortedAngle!==t&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(t),this.sortedAngle=t,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const r of this.symbolInstanceIndexes){const c=this.symbolInstances.get(r);this.featureSortOrder.push(c.featureIndex),[c.rightJustifiedTextSymbolIndex,c.centerJustifiedTextSymbolIndex,c.leftJustifiedTextSymbolIndex].forEach((f,g,y)=>{f>=0&&y.indexOf(f)===g&&this.addIndicesForPlacedSymbol(this.text,f)}),c.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,c.verticalPlacedTextSymbolIndex),c.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,c.placedIconSymbolIndex),c.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,c.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let _y,vy;Et("SymbolBucket",vl,{omit:["layers","collisionBoxArray","features","compareText"]}),vl.MAX_GLYPHS=65535,vl.addDynamicAttributes=Gf;var Xf={get paint(){return vy=vy||new Xi({"icon-opacity":new qt(Z.paint_symbol["icon-opacity"]),"icon-color":new qt(Z.paint_symbol["icon-color"]),"icon-halo-color":new qt(Z.paint_symbol["icon-halo-color"]),"icon-halo-width":new qt(Z.paint_symbol["icon-halo-width"]),"icon-halo-blur":new qt(Z.paint_symbol["icon-halo-blur"]),"icon-translate":new zt(Z.paint_symbol["icon-translate"]),"icon-translate-anchor":new zt(Z.paint_symbol["icon-translate-anchor"]),"text-opacity":new qt(Z.paint_symbol["text-opacity"]),"text-color":new qt(Z.paint_symbol["text-color"],{runtimeType:kn,getOverride:i=>i.textColor,hasOverride:i=>!!i.textColor}),"text-halo-color":new qt(Z.paint_symbol["text-halo-color"]),"text-halo-width":new qt(Z.paint_symbol["text-halo-width"]),"text-halo-blur":new qt(Z.paint_symbol["text-halo-blur"]),"text-translate":new zt(Z.paint_symbol["text-translate"]),"text-translate-anchor":new zt(Z.paint_symbol["text-translate-anchor"])})},get layout(){return _y=_y||new Xi({"symbol-placement":new zt(Z.layout_symbol["symbol-placement"]),"symbol-spacing":new zt(Z.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new zt(Z.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new qt(Z.layout_symbol["symbol-sort-key"]),"symbol-z-order":new zt(Z.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new zt(Z.layout_symbol["icon-allow-overlap"]),"icon-overlap":new zt(Z.layout_symbol["icon-overlap"]),"icon-ignore-placement":new zt(Z.layout_symbol["icon-ignore-placement"]),"icon-optional":new zt(Z.layout_symbol["icon-optional"]),"icon-rotation-alignment":new zt(Z.layout_symbol["icon-rotation-alignment"]),"icon-size":new qt(Z.layout_symbol["icon-size"]),"icon-text-fit":new zt(Z.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new zt(Z.layout_symbol["icon-text-fit-padding"]),"icon-image":new qt(Z.layout_symbol["icon-image"]),"icon-rotate":new qt(Z.layout_symbol["icon-rotate"]),"icon-padding":new qt(Z.layout_symbol["icon-padding"]),"icon-keep-upright":new zt(Z.layout_symbol["icon-keep-upright"]),"icon-offset":new qt(Z.layout_symbol["icon-offset"]),"icon-anchor":new qt(Z.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new zt(Z.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new zt(Z.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new zt(Z.layout_symbol["text-rotation-alignment"]),"text-field":new qt(Z.layout_symbol["text-field"]),"text-font":new qt(Z.layout_symbol["text-font"]),"text-size":new qt(Z.layout_symbol["text-size"]),"text-max-width":new qt(Z.layout_symbol["text-max-width"]),"text-line-height":new zt(Z.layout_symbol["text-line-height"]),"text-letter-spacing":new qt(Z.layout_symbol["text-letter-spacing"]),"text-justify":new qt(Z.layout_symbol["text-justify"]),"text-radial-offset":new qt(Z.layout_symbol["text-radial-offset"]),"text-variable-anchor":new zt(Z.layout_symbol["text-variable-anchor"]),"text-anchor":new qt(Z.layout_symbol["text-anchor"]),"text-max-angle":new zt(Z.layout_symbol["text-max-angle"]),"text-writing-mode":new zt(Z.layout_symbol["text-writing-mode"]),"text-rotate":new qt(Z.layout_symbol["text-rotate"]),"text-padding":new zt(Z.layout_symbol["text-padding"]),"text-keep-upright":new zt(Z.layout_symbol["text-keep-upright"]),"text-transform":new qt(Z.layout_symbol["text-transform"]),"text-offset":new qt(Z.layout_symbol["text-offset"]),"text-allow-overlap":new zt(Z.layout_symbol["text-allow-overlap"]),"text-overlap":new zt(Z.layout_symbol["text-overlap"]),"text-ignore-placement":new zt(Z.layout_symbol["text-ignore-placement"]),"text-optional":new zt(Z.layout_symbol["text-optional"])})}};class xy{constructor(t){if(t.property.overrides===void 0)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=t.property.overrides?t.property.overrides.runtimeType:Mn,this.defaultValue=t}evaluate(t){if(t.formattedSection){const r=this.defaultValue.property.overrides;if(r&&r.hasOverride(t.formattedSection))return r.getOverride(t.formattedSection)}return t.feature&&t.featureState?this.defaultValue.evaluate(t.feature,t.featureState):this.defaultValue.property.specification.default}eachChild(t){this.defaultValue.isConstant()||t(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}Et("FormatSectionOverride",xy,{omit:["defaultValue"]});class Fh extends Hr{constructor(t){super(t,Xf)}recalculate(t,r){if(super.recalculate(t,r),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")==="map"?"map":"viewport"),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){const c=this.layout.get("text-writing-mode");if(c){const f=[];for(const g of c)f.indexOf(g)<0&&f.push(g);this.layout._values["text-writing-mode"]=f}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(t,r,c,f){const g=this.layout.get(t).evaluate(r,{},c,f),y=this._unevaluatedLayout._values[t];return y.isDataDriven()||Ua(y.value)||!g?g:function(b,S){return S.replace(/{([^{}]+)}/g,(P,D)=>D in b?String(b[D]):"")}(r.properties,g)}createBucket(t){return new vl(t)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(const t of Xf.paint.overridableProperties){if(!Fh.hasPaintOverride(this.layout,t))continue;const r=this.paint.get(t),c=new xy(r),f=new fc(c,r.property.specification);let g=null;g=r.value.kind==="constant"||r.value.kind==="source"?new pc("source",f):new cn("composite",f,r.value.zoomStops),this.paint._values[t]=new Wr(r.property,g,r.parameters)}}_handleOverridablePaintPropertyUpdate(t,r,c){return!(!this.layout||r.isDataDriven()||c.isDataDriven())&&Fh.hasPaintOverride(this.layout,t)}static hasPaintOverride(t,r){const c=t.get("text-field"),f=Xf.paint.properties[r];let g=!1;const y=b=>{for(const S of b)if(f.overrides&&f.overrides.hasOverride(S))return void(g=!0)};if(c.value.kind==="constant"&&c.value.value instanceof Ii)y(c.value.value.sections);else if(c.value.kind==="source"){const b=P=>{g||(P instanceof ws&&li(P.value)===rs?y(P.value.sections):P instanceof Va?y(P.sections):P.eachChild(b))},S=c.value;S._styleExpression&&b(S._styleExpression.expression)}return g}}let by;var ow={get paint(){return by=by||new Xi({"background-color":new zt(Z.paint_background["background-color"]),"background-pattern":new Ac(Z.paint_background["background-pattern"]),"background-opacity":new zt(Z.paint_background["background-opacity"])})}};let wy;var aw={get paint(){return wy=wy||new Xi({"raster-opacity":new zt(Z.paint_raster["raster-opacity"]),"raster-hue-rotate":new zt(Z.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new zt(Z.paint_raster["raster-brightness-min"]),"raster-brightness-max":new zt(Z.paint_raster["raster-brightness-max"]),"raster-saturation":new zt(Z.paint_raster["raster-saturation"]),"raster-contrast":new zt(Z.paint_raster["raster-contrast"]),"raster-resampling":new zt(Z.paint_raster["raster-resampling"]),"raster-fade-duration":new zt(Z.paint_raster["raster-fade-duration"])})}};class lw extends Hr{constructor(t){super(t,{}),this.onAdd=r=>{this.implementation.onAdd&&this.implementation.onAdd(r,r.painter.context.gl)},this.onRemove=r=>{this.implementation.onRemove&&this.implementation.onRemove(r,r.painter.context.gl)},this.implementation=t}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}const cw={circle:class extends Hr{constructor(i){super(i,Kb)}createBucket(i){return new wf(i)}queryRadius(i){const t=i;return Rc("circle-radius",this,t)+Rc("circle-stroke-width",this,t)+Eh(this.paint.get("circle-translate"))}queryIntersectsFeature(i,t,r,c,f,g,y,b){const S=Th(i,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),g.angle,y),P=this.paint.get("circle-radius").evaluate(t,r)+this.paint.get("circle-stroke-width").evaluate(t,r),D=this.paint.get("circle-pitch-alignment")==="map",R=D?S:function($,N){return $.map(ee=>Mg(ee,N))}(S,b),O=D?P*y:P;for(const $ of c)for(const N of $){const ee=D?N:Mg(N,b);let J=O;const fe=Ih([],[N.x,N.y,0,1],b);if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?J*=fe[3]/g.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(J*=g.cameraToCenterDistance/fe[3]),Gb(R,ee,J))return!0}return!1}},heatmap:class extends Hr{createBucket(i){return new Dg(i)}constructor(i){super(i,Jb),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(i){i==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=Rg({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(){return 0}queryIntersectsFeature(){return!1}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}},hillshade:class extends Hr{constructor(i){super(i,Qb)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}},fill:class extends Hr{constructor(i){super(i,p1)}recalculate(i,t){super.recalculate(i,t);const r=this.paint._values["fill-outline-color"];r.value.kind==="constant"&&r.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(i){return new Rf(i)}queryRadius(){return Eh(this.paint.get("fill-translate"))}queryIntersectsFeature(i,t,r,c,f,g,y){return Eg(Th(i,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),g.angle,y),c)}isTileClipped(){return!0}},"fill-extrusion":class extends Hr{constructor(i){super(i,A1)}createBucket(i){return new Ff(i)}queryRadius(){return Eh(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature(i,t,r,c,f,g,y,b){const S=Th(i,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),g.angle,y),P=this.paint.get("fill-extrusion-height").evaluate(t,r),D=this.paint.get("fill-extrusion-base").evaluate(t,r),R=function($,N,ee,J){const fe=[];for(const ve of $){const ue=[ve.x,ve.y,0,1];Ih(ue,ue,N),fe.push(new k(ue[0]/ue[3],ue[1]/ue[3]))}return fe}(S,b),O=function($,N,ee,J){const fe=[],ve=[],ue=J[8]*N,Ie=J[9]*N,Me=J[10]*N,qe=J[11]*N,Ct=J[8]*ee,kt=J[9]*ee,_t=J[10]*ee,mt=J[11]*ee;for(const dt of $){const vt=[],gt=[];for(const st of dt){const Vt=st.x,Dt=st.y,sn=J[0]*Vt+J[4]*Dt+J[12],Vn=J[1]*Vt+J[5]*Dt+J[13],Nn=J[2]*Vt+J[6]*Dt+J[14],yi=J[3]*Vt+J[7]*Dt+J[15],Br=Nn+Me,zi=yi+qe,hi=sn+Ct,Ci=Vn+kt,Li=Nn+_t,Ni=yi+mt,ar=new k((sn+ue)/zi,(Vn+Ie)/zi);ar.z=Br/zi,vt.push(ar);const di=new k(hi/Ni,Ci/Ni);di.z=Li/Ni,gt.push(di)}fe.push(vt),ve.push(gt)}return[fe,ve]}(c,D,P,b);return function($,N,ee){let J=1/0;Eg(ee,N)&&(J=Xg(ee,N[0]));for(let fe=0;fe<N.length;fe++){const ve=N[fe],ue=$[fe];for(let Ie=0;Ie<ve.length-1;Ie++){const Me=ve[Ie],qe=[Me,ve[Ie+1],ue[Ie+1],ue[Ie],Me];Cg(ee,qe)&&(J=Math.min(J,Xg(ee,qe)))}}return J!==1/0&&J}(O[0],O[1],R)}},line:class extends Hr{constructor(i){super(i,Qg),this.gradientVersion=0,Dh||(Dh=new R1(Qg.paint.properties["line-width"].specification),Dh.useIntegerZoom=!0)}_handleSpecialPaintPropertyUpdate(i){i==="line-gradient"&&(this.stepInterpolant=this._transitionablePaint._values["line-gradient"].value.expression._styleExpression.expression instanceof co,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER)}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(i,t){super.recalculate(i,t),this.paint._values["line-floorwidth"]=Dh.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,i)}createBucket(i){return new Of(i)}queryRadius(i){const t=i,r=ey(Rc("line-width",this,t),Rc("line-gap-width",this,t)),c=Rc("line-offset",this,t);return r/2+Math.abs(c)+Eh(this.paint.get("line-translate"))}queryIntersectsFeature(i,t,r,c,f,g,y){const b=Th(i,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),g.angle,y),S=y/2*ey(this.paint.get("line-width").evaluate(t,r),this.paint.get("line-gap-width").evaluate(t,r)),P=this.paint.get("line-offset").evaluate(t,r);return P&&(c=function(D,R){const O=[];for(let $=0;$<D.length;$++){const N=D[$],ee=[];for(let J=0;J<N.length;J++){const fe=N[J-1],ve=N[J],ue=N[J+1],Ie=J===0?new k(0,0):ve.sub(fe)._unit()._perp(),Me=J===N.length-1?new k(0,0):ue.sub(ve)._unit()._perp(),qe=Ie._add(Me)._unit(),Ct=qe.x*Me.x+qe.y*Me.y;Ct!==0&&qe._mult(1/Ct),ee.push(qe._mult(R)._add(ve))}O.push(ee)}return O}(c,P*y)),function(D,R,O){for(let $=0;$<R.length;$++){const N=R[$];if(D.length>=3){for(let ee=0;ee<N.length;ee++)if(dl(D,N[ee]))return!0}if(Wb(D,N,O))return!0}return!1}(b,c,S)}isTileClipped(){return!0}},symbol:Fh,background:class extends Hr{constructor(i){super(i,ow)}},raster:class extends Hr{constructor(i){super(i,aw)}}};class uw{constructor(t){this._callback=t,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){delete this._channel,this._callback=()=>{}}}const Kf=63710088e-1;class Co{constructor(t,r){if(isNaN(t)||isNaN(r))throw new Error(`Invalid LngLat object: (${t}, ${r})`);if(this.lng=+t,this.lat=+r,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new Co(Ee(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(t){const r=Math.PI/180,c=this.lat*r,f=t.lat*r,g=Math.sin(c)*Math.sin(f)+Math.cos(c)*Math.cos(f)*Math.cos((t.lng-this.lng)*r);return Kf*Math.acos(Math.min(g,1))}static convert(t){if(t instanceof Co)return t;if(Array.isArray(t)&&(t.length===2||t.length===3))return new Co(Number(t[0]),Number(t[1]));if(!Array.isArray(t)&&typeof t=="object"&&t!==null)return new Co(Number("lng"in t?t.lng:t.lon),Number(t.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const Sy=2*Math.PI*Kf;function Cy(i){return Sy*Math.cos(i*Math.PI/180)}function Ey(i){return(180+i)/360}function Ty(i){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+i*Math.PI/360)))/360}function Iy(i,t){return i/Cy(t)}function Yf(i){return 360/Math.PI*Math.atan(Math.exp((180-360*i)*Math.PI/180))-90}class Oh{constructor(t,r,c=0){this.x=+t,this.y=+r,this.z=+c}static fromLngLat(t,r=0){const c=Co.convert(t);return new Oh(Ey(c.lng),Ty(c.lat),Iy(r,c.lat))}toLngLat(){return new Co(360*this.x-180,Yf(this.y))}toAltitude(){return this.z*Cy(Yf(this.y))}meterInMercatorCoordinateUnits(){return 1/Sy*(t=Yf(this.y),1/Math.cos(t*Math.PI/180));var t}}function Ay(i,t,r){var c=2*Math.PI*6378137/256/Math.pow(2,r);return[i*c-2*Math.PI*6378137/2,t*c-2*Math.PI*6378137/2]}class Jf{constructor(t,r,c){if(t<0||t>25||c<0||c>=Math.pow(2,t)||r<0||r>=Math.pow(2,t))throw new Error(`x=${r}, y=${c}, z=${t} outside of bounds. 0<=x<${Math.pow(2,t)}, 0<=y<${Math.pow(2,t)} 0<=z<=25 `);this.z=t,this.x=r,this.y=c,this.key=Hc(0,t,t,r,c)}equals(t){return this.z===t.z&&this.x===t.x&&this.y===t.y}url(t,r,c){const f=(y=this.y,b=this.z,S=Ay(256*(g=this.x),256*(y=Math.pow(2,b)-y-1),b),P=Ay(256*(g+1),256*(y+1),b),S[0]+","+S[1]+","+P[0]+","+P[1]);var g,y,b,S,P;const D=function(R,O,$){let N,ee="";for(let J=R;J>0;J--)N=1<<J-1,ee+=(O&N?1:0)+($&N?2:0);return ee}(this.z,this.x,this.y);return t[(this.x+this.y)%t.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(c==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,r>1?"@2x":"").replace(/{quadkey}/g,D).replace(/{bbox-epsg-3857}/g,f)}isChildOf(t){const r=this.z-t.z;return r>0&&t.x===this.x>>r&&t.y===this.y>>r}getTilePoint(t){const r=Math.pow(2,this.z);return new k((t.x*r-this.x)*On,(t.y*r-this.y)*On)}toString(){return`${this.z}/${this.x}/${this.y}`}}class Py{constructor(t,r){this.wrap=t,this.canonical=r,this.key=Hc(t,r.z,r.z,r.x,r.y)}}class Rr{constructor(t,r,c,f,g){if(t<c)throw new Error(`overscaledZ should be >= z; overscaledZ = ${t}; z = ${c}`);this.overscaledZ=t,this.wrap=r,this.canonical=new Jf(c,+f,+g),this.key=Hc(r,t,c,f,g)}clone(){return new Rr(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(t){return this.overscaledZ===t.overscaledZ&&this.wrap===t.wrap&&this.canonical.equals(t.canonical)}scaledTo(t){if(t>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${t}; overscaledZ = ${this.overscaledZ}`);const r=this.canonical.z-t;return t>this.canonical.z?new Rr(t,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Rr(t,this.wrap,t,this.canonical.x>>r,this.canonical.y>>r)}calculateScaledKey(t,r){if(t>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${t}; overscaledZ = ${this.overscaledZ}`);const c=this.canonical.z-t;return t>this.canonical.z?Hc(this.wrap*+r,t,this.canonical.z,this.canonical.x,this.canonical.y):Hc(this.wrap*+r,t,t,this.canonical.x>>c,this.canonical.y>>c)}isChildOf(t){if(t.wrap!==this.wrap)return!1;const r=this.canonical.z-t.canonical.z;return t.overscaledZ===0||t.overscaledZ<this.overscaledZ&&t.canonical.x===this.canonical.x>>r&&t.canonical.y===this.canonical.y>>r}children(t){if(this.overscaledZ>=t)return[new Rr(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const r=this.canonical.z+1,c=2*this.canonical.x,f=2*this.canonical.y;return[new Rr(r,this.wrap,r,c,f),new Rr(r,this.wrap,r,c+1,f),new Rr(r,this.wrap,r,c,f+1),new Rr(r,this.wrap,r,c+1,f+1)]}isLessThan(t){return this.wrap<t.wrap||!(this.wrap>t.wrap)&&(this.overscaledZ<t.overscaledZ||!(this.overscaledZ>t.overscaledZ)&&(this.canonical.x<t.canonical.x||!(this.canonical.x>t.canonical.x)&&this.canonical.y<t.canonical.y))}wrapped(){return new Rr(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(t){return new Rr(this.overscaledZ,t,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new Py(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(t){return this.canonical.getTilePoint(new Oh(t.x-this.wrap,t.y))}}function Hc(i,t,r,c,f){(i*=2)<0&&(i=-1*i-1);const g=1<<r;return(g*g*i+g*f+c).toString(36)+r.toString(36)+t.toString(36)}Et("CanonicalTileID",Jf),Et("OverscaledTileID",Rr,{omit:["posMatrix"]});class ky{constructor(t,r,c){if(this.uid=t,r.height!==r.width)throw new RangeError("DEM tiles must be square");if(c&&c!=="mapbox"&&c!=="terrarium")return void pe(`"${c}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=r.height;const f=this.dim=r.height-2;this.data=new Uint32Array(r.data.buffer),this.encoding=c||"mapbox";for(let g=0;g<f;g++)this.data[this._idx(-1,g)]=this.data[this._idx(0,g)],this.data[this._idx(f,g)]=this.data[this._idx(f-1,g)],this.data[this._idx(g,-1)]=this.data[this._idx(g,0)],this.data[this._idx(g,f)]=this.data[this._idx(g,f-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(f,-1)]=this.data[this._idx(f-1,0)],this.data[this._idx(-1,f)]=this.data[this._idx(0,f-1)],this.data[this._idx(f,f)]=this.data[this._idx(f-1,f-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let g=0;g<f;g++)for(let y=0;y<f;y++){const b=this.get(g,y);b>this.max&&(this.max=b),b<this.min&&(this.min=b)}}get(t,r){const c=new Uint8Array(this.data.buffer),f=4*this._idx(t,r);return(this.encoding==="terrarium"?this._unpackTerrarium:this._unpackMapbox)(c[f],c[f+1],c[f+2])}getUnpackVector(){return this.encoding==="terrarium"?[256,1,1/256,32768]:[6553.6,25.6,.1,1e4]}_idx(t,r){if(t<-1||t>=this.dim+1||r<-1||r>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(r+1)*this.stride+(t+1)}_unpackMapbox(t,r,c){return(256*t*256+256*r+c)/10-1e4}_unpackTerrarium(t,r,c){return 256*t+r+c/256-32768}getPixels(){return new Lr({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(t,r,c){if(this.dim!==t.dim)throw new Error("dem dimension mismatch");let f=r*this.dim,g=r*this.dim+this.dim,y=c*this.dim,b=c*this.dim+this.dim;switch(r){case-1:f=g-1;break;case 1:g=f+1}switch(c){case-1:y=b-1;break;case 1:b=y+1}const S=-r*this.dim,P=-c*this.dim;for(let D=y;D<b;D++)for(let R=f;R<g;R++)this.data[this._idx(R,D)]=t.data[this._idx(R+S,D+P)]}}Et("DEMData",ky);class My{constructor(t){this._stringToNumber={},this._numberToString=[];for(let r=0;r<t.length;r++){const c=t[r];this._stringToNumber[c]=r,this._numberToString[r]=c}}encode(t){return this._stringToNumber[t]}decode(t){if(t>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${t} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[t]}}class Dy{constructor(t,r,c,f,g){this.type="Feature",this._vectorTileFeature=t,t._z=r,t._x=c,t._y=f,this.properties=t.properties,this.id=g}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(t){this._geometry=t}toJSON(){const t={geometry:this.geometry};for(const r in this)r!=="_geometry"&&r!=="_vectorTileFeature"&&(t[r]=this[r]);return t}}class zy{constructor(t,r){this.tileID=t,this.x=t.canonical.x,this.y=t.canonical.y,this.z=t.canonical.z,this.grid=new Qo(On,16,0),this.grid3D=new Qo(On,16,0),this.featureIndexArray=new U,this.promoteId=r}insert(t,r,c,f,g,y){const b=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(c,f,g);const S=y?this.grid3D:this.grid;for(let P=0;P<r.length;P++){const D=r[P],R=[1/0,1/0,-1/0,-1/0];for(let O=0;O<D.length;O++){const $=D[O];R[0]=Math.min(R[0],$.x),R[1]=Math.min(R[1],$.y),R[2]=Math.max(R[2],$.x),R[3]=Math.max(R[3],$.y)}R[0]<On&&R[1]<On&&R[2]>=0&&R[3]>=0&&S.insert(b,R[0],R[1],R[2],R[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new bo.VectorTile(new $f(this.rawTileData)).layers,this.sourceLayerCoder=new My(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(t,r,c,f){this.loadVTLayers();const g=t.params||{},y=On/t.tileSize/t.scale,b=mc(g.filter),S=t.queryGeometry,P=t.queryPadding*y,D=Ry(S),R=this.grid.query(D.minX-P,D.minY-P,D.maxX+P,D.maxY+P),O=Ry(t.cameraQueryGeometry),$=this.grid3D.query(O.minX-P,O.minY-P,O.maxX+P,O.maxY+P,(J,fe,ve,ue)=>function(Ie,Me,qe,Ct,kt){for(const mt of Ie)if(Me<=mt.x&&qe<=mt.y&&Ct>=mt.x&&kt>=mt.y)return!0;const _t=[new k(Me,qe),new k(Me,kt),new k(Ct,kt),new k(Ct,qe)];if(Ie.length>2){for(const mt of _t)if(dl(Ie,mt))return!0}for(let mt=0;mt<Ie.length-1;mt++)if(Xb(Ie[mt],Ie[mt+1],_t))return!0;return!1}(t.cameraQueryGeometry,J-P,fe-P,ve+P,ue+P));for(const J of $)R.push(J);R.sort(hw);const N={};let ee;for(let J=0;J<R.length;J++){const fe=R[J];if(fe===ee)continue;ee=fe;const ve=this.featureIndexArray.get(fe);let ue=null;this.loadMatchingFeature(N,ve.bucketIndex,ve.sourceLayerIndex,ve.featureIndex,b,g.layers,g.availableImages,r,c,f,(Ie,Me,qe)=>(ue||(ue=us(Ie)),Me.queryIntersectsFeature(S,Ie,qe,ue,this.z,t.transform,y,t.pixelPosMatrix)))}return N}loadMatchingFeature(t,r,c,f,g,y,b,S,P,D,R){const O=this.bucketLayerIDs[r];if(y&&!function(J,fe){for(let ve=0;ve<J.length;ve++)if(fe.indexOf(J[ve])>=0)return!0;return!1}(y,O))return;const $=this.sourceLayerCoder.decode(c),N=this.vtLayers[$].feature(f);if(g.needGeometry){const J=aa(N,!0);if(!g.filter(new Un(this.tileID.overscaledZ),J,this.tileID.canonical))return}else if(!g.filter(new Un(this.tileID.overscaledZ),N))return;const ee=this.getId(N,$);for(let J=0;J<O.length;J++){const fe=O[J];if(y&&y.indexOf(fe)<0)continue;const ve=S[fe];if(!ve)continue;let ue={};ee&&D&&(ue=D.getState(ve.sourceLayer||"_geojsonTileLayer",ee));const Ie=be({},P[fe]);Ie.paint=Ly(Ie.paint,ve.paint,N,ue,b),Ie.layout=Ly(Ie.layout,ve.layout,N,ue,b);const Me=!R||R(N,ve,ue);if(!Me)continue;const qe=new Dy(N,this.z,this.x,this.y,ee);qe.layer=Ie;let Ct=t[fe];Ct===void 0&&(Ct=t[fe]=[]),Ct.push({featureIndex:f,feature:qe,intersectionZ:Me})}}lookupSymbolFeatures(t,r,c,f,g,y,b,S){const P={};this.loadVTLayers();const D=mc(g);for(const R of t)this.loadMatchingFeature(P,c,f,R,D,y,b,S,r);return P}hasLayer(t){for(const r of this.bucketLayerIDs)for(const c of r)if(t===c)return!0;return!1}getId(t,r){let c=t.id;return this.promoteId&&(c=t.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[r]],typeof c=="boolean"&&(c=Number(c))),c}}function Ly(i,t,r,c,f){return Ue(i,(g,y)=>{const b=t instanceof nl?t.get(y):null;return b&&b.evaluate?b.evaluate(r,c,f):b})}function Ry(i){let t=1/0,r=1/0,c=-1/0,f=-1/0;for(const g of i)t=Math.min(t,g.x),r=Math.min(r,g.y),c=Math.max(c,g.x),f=Math.max(f,g.y);return{minX:t,minY:r,maxX:c,maxY:f}}function hw(i,t){return t-i}function By(i,t,r,c,f){const g=[];for(let y=0;y<i.length;y++){const b=i[y];let S;for(let P=0;P<b.length-1;P++){let D=b[P],R=b[P+1];D.x<t&&R.x<t||(D.x<t?D=new k(t,D.y+(t-D.x)/(R.x-D.x)*(R.y-D.y))._round():R.x<t&&(R=new k(t,D.y+(t-D.x)/(R.x-D.x)*(R.y-D.y))._round()),D.y<r&&R.y<r||(D.y<r?D=new k(D.x+(r-D.y)/(R.y-D.y)*(R.x-D.x),r)._round():R.y<r&&(R=new k(D.x+(r-D.y)/(R.y-D.y)*(R.x-D.x),r)._round()),D.x>=c&&R.x>=c||(D.x>=c?D=new k(c,D.y+(c-D.x)/(R.x-D.x)*(R.y-D.y))._round():R.x>=c&&(R=new k(c,D.y+(c-D.x)/(R.x-D.x)*(R.y-D.y))._round()),D.y>=f&&R.y>=f||(D.y>=f?D=new k(D.x+(f-D.y)/(R.y-D.y)*(R.x-D.x),f)._round():R.y>=f&&(R=new k(D.x+(f-D.y)/(R.y-D.y)*(R.x-D.x),f)._round()),S&&D.equals(S[S.length-1])||(S=[D],g.push(S)),S.push(R)))))}}return g}Et("FeatureIndex",zy,{omit:["rawTileData","sourceLayerCoder"]});class Eo extends k{constructor(t,r,c,f){super(t,r),this.angle=c,f!==void 0&&(this.segment=f)}clone(){return new Eo(this.x,this.y,this.angle,this.segment)}}function Fy(i,t,r,c,f){if(t.segment===void 0)return!0;let g=t,y=t.segment+1,b=0;for(;b>-r/2;){if(y--,y<0)return!1;b-=i[y].dist(g),g=i[y]}b+=i[y].dist(i[y+1]),y++;const S=[];let P=0;for(;b<r/2;){const D=i[y],R=i[y+1];if(!R)return!1;let O=i[y-1].angleTo(D)-D.angleTo(R);for(O=Math.abs((O+3*Math.PI)%(2*Math.PI)-Math.PI),S.push({distance:b,angleDelta:O}),P+=O;b-S[0].distance>c;)P-=S.shift().angleDelta;if(P>f)return!1;y++,b+=D.dist(R)}return!0}function Oy(i){let t=0;for(let r=0;r<i.length-1;r++)t+=i[r].dist(i[r+1]);return t}function Vy(i,t,r){return i?.6*t*r:0}function $y(i,t){return Math.max(i?i.right-i.left:0,t?t.right-t.left:0)}function dw(i,t,r,c,f,g){const y=Vy(r,f,g),b=$y(r,c)*g;let S=0;const P=Oy(i)/2;for(let D=0;D<i.length-1;D++){const R=i[D],O=i[D+1],$=R.dist(O);if(S+$>P){const N=(P-S)/$,ee=nr.number(R.x,O.x,N),J=nr.number(R.y,O.y,N),fe=new Eo(ee,J,O.angleTo(R),D);return fe._round(),!y||Fy(i,fe,b,y,t)?fe:void 0}S+=$}}function fw(i,t,r,c,f,g,y,b,S){const P=Vy(c,g,y),D=$y(c,f),R=D*y,O=i[0].x===0||i[0].x===S||i[0].y===0||i[0].y===S;return t-R<t/4&&(t=R+t/4),Uy(i,O?t/2*b%t:(D/2+2*g)*y*b%t,t,P,r,R,O,!1,S)}function Uy(i,t,r,c,f,g,y,b,S){const P=g/2,D=Oy(i);let R=0,O=t-r,$=[];for(let N=0;N<i.length-1;N++){const ee=i[N],J=i[N+1],fe=ee.dist(J),ve=J.angleTo(ee);for(;O+r<R+fe;){O+=r;const ue=(O-R)/fe,Ie=nr.number(ee.x,J.x,ue),Me=nr.number(ee.y,J.y,ue);if(Ie>=0&&Ie<S&&Me>=0&&Me<S&&O-P>=0&&O+P<=D){const qe=new Eo(Ie,Me,ve,N);qe._round(),c&&!Fy(i,qe,g,c,f)||$.push(qe)}}R+=fe}return b||$.length||y||($=Uy(i,R/2,r,c,f,g,y,!0,S)),$}Et("Anchor",Eo);const xl=or;function Ny(i,t,r,c){const f=[],g=i.image,y=g.pixelRatio,b=g.paddedRect.w-2*xl,S=g.paddedRect.h-2*xl,P=i.right-i.left,D=i.bottom-i.top,R=g.stretchX||[[0,b]],O=g.stretchY||[[0,S]],$=(dt,vt)=>dt+vt[1]-vt[0],N=R.reduce($,0),ee=O.reduce($,0),J=b-N,fe=S-ee;let ve=0,ue=N,Ie=0,Me=ee,qe=0,Ct=J,kt=0,_t=fe;if(g.content&&c){const dt=g.content;ve=Vh(R,0,dt[0]),Ie=Vh(O,0,dt[1]),ue=Vh(R,dt[0],dt[2]),Me=Vh(O,dt[1],dt[3]),qe=dt[0]-ve,kt=dt[1]-Ie,Ct=dt[2]-dt[0]-ue,_t=dt[3]-dt[1]-Me}const mt=(dt,vt,gt,st)=>{const Vt=$h(dt.stretch-ve,ue,P,i.left),Dt=Uh(dt.fixed-qe,Ct,dt.stretch,N),sn=$h(vt.stretch-Ie,Me,D,i.top),Vn=Uh(vt.fixed-kt,_t,vt.stretch,ee),Nn=$h(gt.stretch-ve,ue,P,i.left),yi=Uh(gt.fixed-qe,Ct,gt.stretch,N),Br=$h(st.stretch-Ie,Me,D,i.top),zi=Uh(st.fixed-kt,_t,st.stretch,ee),hi=new k(Vt,sn),Ci=new k(Nn,sn),Li=new k(Nn,Br),Ni=new k(Vt,Br),ar=new k(Dt/y,Vn/y),di=new k(yi/y,zi/y),Ri=t*Math.PI/180;if(Ri){const lr=Math.sin(Ri),cr=Math.cos(Ri),Qn=[cr,-lr,lr,cr];hi._matMult(Qn),Ci._matMult(Qn),Ni._matMult(Qn),Li._matMult(Qn)}const ji=dt.stretch+dt.fixed,Yi=vt.stretch+vt.fixed;return{tl:hi,tr:Ci,bl:Ni,br:Li,tex:{x:g.paddedRect.x+xl+ji,y:g.paddedRect.y+xl+Yi,w:gt.stretch+gt.fixed-ji,h:st.stretch+st.fixed-Yi},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:ar,pixelOffsetBR:di,minFontScaleX:Ct/y/P,minFontScaleY:_t/y/D,isSDF:r}};if(c&&(g.stretchX||g.stretchY)){const dt=jy(R,J,N),vt=jy(O,fe,ee);for(let gt=0;gt<dt.length-1;gt++){const st=dt[gt],Vt=dt[gt+1];for(let Dt=0;Dt<vt.length-1;Dt++)f.push(mt(st,vt[Dt],Vt,vt[Dt+1]))}}else f.push(mt({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:b+1},{fixed:0,stretch:S+1}));return f}function Vh(i,t,r){let c=0;for(const f of i)c+=Math.max(t,Math.min(r,f[1]))-Math.max(t,Math.min(r,f[0]));return c}function jy(i,t,r){const c=[{fixed:-xl,stretch:0}];for(const[f,g]of i){const y=c[c.length-1];c.push({fixed:f-y.stretch,stretch:y.stretch}),c.push({fixed:f-y.stretch,stretch:y.stretch+(g-f)})}return c.push({fixed:t+xl,stretch:r}),c}function $h(i,t,r,c){return i/t*r+c}function Uh(i,t,r,c){return i-t*r/c}class Nh{constructor(t,r,c,f,g,y,b,S,P,D){if(this.boxStartIndex=t.length,P){let R=y.top,O=y.bottom;const $=y.collisionPadding;$&&(R-=$[1],O+=$[3]);let N=O-R;N>0&&(N=Math.max(10,N),this.circleDiameter=N)}else{let R=y.top*b-S[0],O=y.bottom*b+S[2],$=y.left*b-S[3],N=y.right*b+S[1];const ee=y.collisionPadding;if(ee&&($-=ee[0]*b,R-=ee[1]*b,N+=ee[2]*b,O+=ee[3]*b),D){const J=new k($,R),fe=new k(N,R),ve=new k($,O),ue=new k(N,O),Ie=D*Math.PI/180;J._rotate(Ie),fe._rotate(Ie),ve._rotate(Ie),ue._rotate(Ie),$=Math.min(J.x,fe.x,ve.x,ue.x),N=Math.max(J.x,fe.x,ve.x,ue.x),R=Math.min(J.y,fe.y,ve.y,ue.y),O=Math.max(J.y,fe.y,ve.y,ue.y)}t.emplaceBack(r.x,r.y,$,R,N,O,c,f,g)}this.boxEndIndex=t.length}}class pw{constructor(t=[],r=mw){if(this.data=t,this.length=this.data.length,this.compare=r,this.length>0)for(let c=(this.length>>1)-1;c>=0;c--)this._down(c)}push(t){this.data.push(t),this.length++,this._up(this.length-1)}pop(){if(this.length===0)return;const t=this.data[0],r=this.data.pop();return this.length--,this.length>0&&(this.data[0]=r,this._down(0)),t}peek(){return this.data[0]}_up(t){const{data:r,compare:c}=this,f=r[t];for(;t>0;){const g=t-1>>1,y=r[g];if(c(f,y)>=0)break;r[t]=y,t=g}r[t]=f}_down(t){const{data:r,compare:c}=this,f=this.length>>1,g=r[t];for(;t<f;){let y=1+(t<<1),b=r[y];const S=y+1;if(S<this.length&&c(r[S],b)<0&&(y=S,b=r[S]),c(b,g)>=0)break;r[t]=b,t=y}r[t]=g}}function mw(i,t){return i<t?-1:i>t?1:0}function gw(i,t=1,r=!1){let c=1/0,f=1/0,g=-1/0,y=-1/0;const b=i[0];for(let $=0;$<b.length;$++){const N=b[$];(!$||N.x<c)&&(c=N.x),(!$||N.y<f)&&(f=N.y),(!$||N.x>g)&&(g=N.x),(!$||N.y>y)&&(y=N.y)}const S=Math.min(g-c,y-f);let P=S/2;const D=new pw([],yw);if(S===0)return new k(c,f);for(let $=c;$<g;$+=S)for(let N=f;N<y;N+=S)D.push(new bl($+P,N+P,P,i));let R=function($){let N=0,ee=0,J=0;const fe=$[0];for(let ve=0,ue=fe.length,Ie=ue-1;ve<ue;Ie=ve++){const Me=fe[ve],qe=fe[Ie],Ct=Me.x*qe.y-qe.x*Me.y;ee+=(Me.x+qe.x)*Ct,J+=(Me.y+qe.y)*Ct,N+=3*Ct}return new bl(ee/N,J/N,0,$)}(i),O=D.length;for(;D.length;){const $=D.pop();($.d>R.d||!R.d)&&(R=$,r&&console.log("found best %d after %d probes",Math.round(1e4*$.d)/1e4,O)),$.max-R.d<=t||(P=$.h/2,D.push(new bl($.p.x-P,$.p.y-P,P,i)),D.push(new bl($.p.x+P,$.p.y-P,P,i)),D.push(new bl($.p.x-P,$.p.y+P,P,i)),D.push(new bl($.p.x+P,$.p.y+P,P,i)),O+=4)}return r&&(console.log(`num probes: ${O}`),console.log(`best distance: ${R.d}`)),R.p}function yw(i,t){return t.max-i.max}function bl(i,t,r,c){this.p=new k(i,t),this.h=r,this.d=function(f,g){let y=!1,b=1/0;for(let S=0;S<g.length;S++){const P=g[S];for(let D=0,R=P.length,O=R-1;D<R;O=D++){const $=P[D],N=P[O];$.y>f.y!=N.y>f.y&&f.x<(N.x-$.x)*(f.y-$.y)/(N.y-$.y)+$.x&&(y=!y),b=Math.min(b,Tg(f,$,N))}}return(y?1:-1)*Math.sqrt(b)}(this.p,c),this.max=this.d+this.h*Math.SQRT2}const Qf=Number.POSITIVE_INFINITY;function qy(i,t){return t[1]!==Qf?function(r,c,f){let g=0,y=0;switch(c=Math.abs(c),f=Math.abs(f),r){case"top-right":case"top-left":case"top":y=f-7;break;case"bottom-right":case"bottom-left":case"bottom":y=7-f}switch(r){case"top-right":case"bottom-right":case"right":g=-c;break;case"top-left":case"bottom-left":case"left":g=c}return[g,y]}(i,t[0],t[1]):function(r,c){let f=0,g=0;c<0&&(c=0);const y=c/Math.sqrt(2);switch(r){case"top-right":case"top-left":g=y-7;break;case"bottom-right":case"bottom-left":g=7-y;break;case"bottom":g=7-c;break;case"top":g=c-7}switch(r){case"top-right":case"bottom-right":f=-y;break;case"top-left":case"bottom-left":f=y;break;case"left":f=c;break;case"right":f=-c}return[f,g]}(i,t[0])}function ep(i){switch(i){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function _w(i,t,r,c,f,g,y,b,S,P,D){let R=g.textMaxSize.evaluate(t,{});R===void 0&&(R=y);const O=i.layers[0].layout,$=O.get("icon-offset").evaluate(t,{},D),N=Gy(r.horizontal),ee=y/24,J=i.tilePixelRatio*ee,fe=i.tilePixelRatio*R/24,ve=i.tilePixelRatio*b,ue=i.tilePixelRatio*O.get("symbol-spacing"),Ie=O.get("text-padding")*i.tilePixelRatio,Me=function(st,Vt,Dt,sn=1){const Vn=st.get("icon-padding").evaluate(Vt,{},Dt),Nn=Vn&&Vn.values;return[Nn[0]*sn,Nn[1]*sn,Nn[2]*sn,Nn[3]*sn]}(O,t,D,i.tilePixelRatio),qe=O.get("text-max-angle")/180*Math.PI,Ct=O.get("text-rotation-alignment")!=="viewport"&&O.get("symbol-placement")!=="point",kt=O.get("icon-rotation-alignment")==="map"&&O.get("symbol-placement")!=="point",_t=O.get("symbol-placement"),mt=ue/2,dt=O.get("icon-text-fit");let vt;c&&dt!=="none"&&(i.allowVerticalPlacement&&r.vertical&&(vt=gy(c,r.vertical,dt,O.get("icon-text-fit-padding"),$,ee)),N&&(c=gy(c,N,dt,O.get("icon-text-fit-padding"),$,ee)));const gt=(st,Vt)=>{Vt.x<0||Vt.x>=On||Vt.y<0||Vt.y>=On||function(Dt,sn,Vn,Nn,yi,Br,zi,hi,Ci,Li,Ni,ar,di,Ri,ji,Yi,lr,cr,Qn,Bi,on,Sr,Fi,qi,Yr){const hs=Dt.addToLineVertexArray(sn,Vn);let ds,Ws,Jr,Fr,ur=0,Hs=0,Yc=0,Ky=0,lp=-1,cp=-1;const Xs={};let Yy=ri(""),up=0,hp=0;if(hi._unevaluatedLayout.getValue("text-radial-offset")===void 0?[up,hp]=hi.layout.get("text-offset").evaluate(on,{},qi).map(hr=>hr*Si):(up=hi.layout.get("text-radial-offset").evaluate(on,{},qi)*Si,hp=Qf),Dt.allowVerticalPlacement&&Nn.vertical){const hr=hi.layout.get("text-rotate").evaluate(on,{},qi)+90;Jr=new Nh(Ci,sn,Li,Ni,ar,Nn.vertical,di,Ri,ji,hr),zi&&(Fr=new Nh(Ci,sn,Li,Ni,ar,zi,lr,cr,ji,hr))}if(yi){const hr=hi.layout.get("icon-rotate").evaluate(on,{}),As=hi.layout.get("icon-text-fit")!=="none",Jc=Ny(yi,hr,Fi,As),Qc=zi?Ny(zi,hr,Fi,As):void 0;Ws=new Nh(Ci,sn,Li,Ni,ar,yi,lr,cr,!1,hr),ur=4*Jc.length;const e_=Dt.iconSizeData;let ca=null;e_.kind==="source"?(ca=[Is*hi.layout.get("icon-size").evaluate(on,{})],ca[0]>So&&pe(`${Dt.layerIds[0]}: Value for "icon-size" is >= ${Wc}. Reduce your "icon-size".`)):e_.kind==="composite"&&(ca=[Is*Sr.compositeIconSizes[0].evaluate(on,{},qi),Is*Sr.compositeIconSizes[1].evaluate(on,{},qi)],(ca[0]>So||ca[1]>So)&&pe(`${Dt.layerIds[0]}: Value for "icon-size" is >= ${Wc}. Reduce your "icon-size".`)),Dt.addSymbols(Dt.icon,Jc,ca,Bi,Qn,on,a.WritingMode.none,sn,hs.lineStartIndex,hs.lineLength,-1,qi),lp=Dt.icon.placedSymbolArray.length-1,Qc&&(Hs=4*Qc.length,Dt.addSymbols(Dt.icon,Qc,ca,Bi,Qn,on,a.WritingMode.vertical,sn,hs.lineStartIndex,hs.lineLength,-1,qi),cp=Dt.icon.placedSymbolArray.length-1)}const Jy=Object.keys(Nn.horizontal);for(const hr of Jy){const As=Nn.horizontal[hr];if(!ds){Yy=ri(As.text);const Qc=hi.layout.get("text-rotate").evaluate(on,{},qi);ds=new Nh(Ci,sn,Li,Ni,ar,As,di,Ri,ji,Qc)}const Jc=As.positionedLines.length===1;if(Yc+=Zy(Dt,sn,As,Br,hi,ji,on,Yi,hs,Nn.vertical?a.WritingMode.horizontal:a.WritingMode.horizontalOnly,Jc?Jy:[hr],Xs,lp,Sr,qi),Jc)break}Nn.vertical&&(Ky+=Zy(Dt,sn,Nn.vertical,Br,hi,ji,on,Yi,hs,a.WritingMode.vertical,["vertical"],Xs,cp,Sr,qi));const bw=ds?ds.boxStartIndex:Dt.collisionBoxArray.length,ww=ds?ds.boxEndIndex:Dt.collisionBoxArray.length,Sw=Jr?Jr.boxStartIndex:Dt.collisionBoxArray.length,Cw=Jr?Jr.boxEndIndex:Dt.collisionBoxArray.length,Ew=Ws?Ws.boxStartIndex:Dt.collisionBoxArray.length,Tw=Ws?Ws.boxEndIndex:Dt.collisionBoxArray.length,Iw=Fr?Fr.boxStartIndex:Dt.collisionBoxArray.length,Aw=Fr?Fr.boxEndIndex:Dt.collisionBoxArray.length;let fs=-1;const qh=(hr,As)=>hr&&hr.circleDiameter?Math.max(hr.circleDiameter,As):As;fs=qh(ds,fs),fs=qh(Jr,fs),fs=qh(Ws,fs),fs=qh(Fr,fs);const Qy=fs>-1?1:0;Qy&&(fs*=Yr/Si),Dt.glyphOffsetArray.length>=vl.MAX_GLYPHS&&pe("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),on.sortKey!==void 0&&Dt.addToSortKeyRanges(Dt.symbolInstances.length,on.sortKey),Dt.symbolInstances.emplaceBack(sn.x,sn.y,Xs.right>=0?Xs.right:-1,Xs.center>=0?Xs.center:-1,Xs.left>=0?Xs.left:-1,Xs.vertical||-1,lp,cp,Yy,bw,ww,Sw,Cw,Ew,Tw,Iw,Aw,Li,Yc,Ky,ur,Hs,Qy,0,di,up,hp,fs)}(i,Vt,st,r,c,f,vt,i.layers[0],i.collisionBoxArray,t.index,t.sourceLayerIndex,i.index,J,[Ie,Ie,Ie,Ie],Ct,S,ve,Me,kt,$,t,g,P,D,y)};if(_t==="line")for(const st of By(t.geometry,0,0,On,On)){const Vt=fw(st,ue,qe,r.vertical||N,c,24,fe,i.overscaling,On);for(const Dt of Vt)N&&vw(i,N.text,mt,Dt)||gt(st,Dt)}else if(_t==="line-center"){for(const st of t.geometry)if(st.length>1){const Vt=dw(st,qe,r.vertical||N,c,24,fe);Vt&&gt(st,Vt)}}else if(t.type==="Polygon")for(const st of Df(t.geometry,0)){const Vt=gw(st,16);gt(st[0],new Eo(Vt.x,Vt.y,0))}else if(t.type==="LineString")for(const st of t.geometry)gt(st,new Eo(st[0].x,st[0].y,0));else if(t.type==="Point")for(const st of t.geometry)for(const Vt of st)gt([Vt],new Eo(Vt.x,Vt.y,0))}function Zy(i,t,r,c,f,g,y,b,S,P,D,R,O,$,N){const ee=function(ve,ue,Ie,Me,qe,Ct,kt,_t){const mt=Me.layout.get("text-rotate").evaluate(Ct,{})*Math.PI/180,dt=[];for(const vt of ue.positionedLines)for(const gt of vt.positionedGlyphs){if(!gt.rect)continue;const st=gt.rect||{};let Vt=cy+1,Dt=!0,sn=1,Vn=0;const Nn=(qe||_t)&&gt.vertical,yi=gt.metrics.advance*gt.scale/2;if(_t&&ue.verticalizable&&(Vn=vt.lineOffset/2-(gt.imageName?-(Si-gt.metrics.width*gt.scale)/2:(gt.scale-1)*Si)),gt.imageName){const Qn=kt[gt.imageName];Dt=Qn.sdf,sn=Qn.pixelRatio,Vt=or/sn}const Br=qe?[gt.x+yi,gt.y]:[0,0];let zi=qe?[0,0]:[gt.x+yi+Ie[0],gt.y+Ie[1]-Vn],hi=[0,0];Nn&&(hi=zi,zi=[0,0]);const Ci=(gt.metrics.left-Vt)*gt.scale-yi+zi[0],Li=(-gt.metrics.top-Vt)*gt.scale+zi[1],Ni=Ci+st.w*gt.scale/sn,ar=Li+st.h*gt.scale/sn,di=new k(Ci,Li),Ri=new k(Ni,Li),ji=new k(Ci,ar),Yi=new k(Ni,ar);if(Nn){const Qn=new k(-yi,yi-Zc),Bi=-Math.PI/2,on=Si/2-yi,Sr=new k(5-Zc-on,-(gt.imageName?on:0)),Fi=new k(...hi);di._rotateAround(Bi,Qn)._add(Sr)._add(Fi),Ri._rotateAround(Bi,Qn)._add(Sr)._add(Fi),ji._rotateAround(Bi,Qn)._add(Sr)._add(Fi),Yi._rotateAround(Bi,Qn)._add(Sr)._add(Fi)}if(mt){const Qn=Math.sin(mt),Bi=Math.cos(mt),on=[Bi,-Qn,Qn,Bi];di._matMult(on),Ri._matMult(on),ji._matMult(on),Yi._matMult(on)}const lr=new k(0,0),cr=new k(0,0);dt.push({tl:di,tr:Ri,bl:ji,br:Yi,tex:st,writingMode:ue.writingMode,glyphOffset:Br,sectionIndex:gt.sectionIndex,isSDF:Dt,pixelOffsetTL:lr,pixelOffsetBR:cr,minFontScaleX:0,minFontScaleY:0})}return dt}(0,r,b,f,g,y,c,i.allowVerticalPlacement),J=i.textSizeData;let fe=null;J.kind==="source"?(fe=[Is*f.layout.get("text-size").evaluate(y,{})],fe[0]>So&&pe(`${i.layerIds[0]}: Value for "text-size" is >= ${Wc}. Reduce your "text-size".`)):J.kind==="composite"&&(fe=[Is*$.compositeTextSizes[0].evaluate(y,{},N),Is*$.compositeTextSizes[1].evaluate(y,{},N)],(fe[0]>So||fe[1]>So)&&pe(`${i.layerIds[0]}: Value for "text-size" is >= ${Wc}. Reduce your "text-size".`)),i.addSymbols(i.text,ee,fe,b,g,y,P,t,S.lineStartIndex,S.lineLength,O,N);for(const ve of D)R[ve]=i.text.placedSymbolArray.length-1;return 4*ee.length}function Gy(i){for(const t in i)return i[t];return null}function vw(i,t,r,c){const f=i.compareText;if(t in f){const g=f[t];for(let y=g.length-1;y>=0;y--)if(c.dist(g[y])<r)return!0}else f[t]=[];return f[t].push(c),!1}const Wy=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class tp{static from(t){if(!(t instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[r,c]=new Uint8Array(t,0,2);if(r!==219)throw new Error("Data does not appear to be in a KDBush format.");const f=c>>4;if(f!==1)throw new Error(`Got v${f} data when expected v1.`);const g=Wy[15&c];if(!g)throw new Error("Unrecognized array type.");const[y]=new Uint16Array(t,2,1),[b]=new Uint32Array(t,4,1);return new tp(b,y,g,t)}constructor(t,r=64,c=Float64Array,f){if(isNaN(t)||t<0)throw new Error(`Unpexpected numItems value: ${t}.`);this.numItems=+t,this.nodeSize=Math.min(Math.max(+r,2),65535),this.ArrayType=c,this.IndexArrayType=t<65536?Uint16Array:Uint32Array;const g=Wy.indexOf(this.ArrayType),y=2*t*this.ArrayType.BYTES_PER_ELEMENT,b=t*this.IndexArrayType.BYTES_PER_ELEMENT,S=(8-b%8)%8;if(g<0)throw new Error(`Unexpected typed array class: ${c}.`);f&&f instanceof ArrayBuffer?(this.data=f,this.ids=new this.IndexArrayType(this.data,8,t),this.coords=new this.ArrayType(this.data,8+b+S,2*t),this._pos=2*t,this._finished=!0):(this.data=new ArrayBuffer(8+y+b+S),this.ids=new this.IndexArrayType(this.data,8,t),this.coords=new this.ArrayType(this.data,8+b+S,2*t),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+g]),new Uint16Array(this.data,2,1)[0]=r,new Uint32Array(this.data,4,1)[0]=t)}add(t,r){const c=this._pos>>1;return this.ids[c]=c,this.coords[this._pos++]=t,this.coords[this._pos++]=r,c}finish(){const t=this._pos>>1;if(t!==this.numItems)throw new Error(`Added ${t} items when expected ${this.numItems}.`);return np(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(t,r,c,f){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:g,coords:y,nodeSize:b}=this,S=[0,g.length-1,0],P=[];for(;S.length;){const D=S.pop()||0,R=S.pop()||0,O=S.pop()||0;if(R-O<=b){for(let J=O;J<=R;J++){const fe=y[2*J],ve=y[2*J+1];fe>=t&&fe<=c&&ve>=r&&ve<=f&&P.push(g[J])}continue}const $=O+R>>1,N=y[2*$],ee=y[2*$+1];N>=t&&N<=c&&ee>=r&&ee<=f&&P.push(g[$]),(D===0?t<=N:r<=ee)&&(S.push(O),S.push($-1),S.push(1-D)),(D===0?c>=N:f>=ee)&&(S.push($+1),S.push(R),S.push(1-D))}return P}within(t,r,c){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:f,coords:g,nodeSize:y}=this,b=[0,f.length-1,0],S=[],P=c*c;for(;b.length;){const D=b.pop()||0,R=b.pop()||0,O=b.pop()||0;if(R-O<=y){for(let J=O;J<=R;J++)Xy(g[2*J],g[2*J+1],t,r)<=P&&S.push(f[J]);continue}const $=O+R>>1,N=g[2*$],ee=g[2*$+1];Xy(N,ee,t,r)<=P&&S.push(f[$]),(D===0?t-c<=N:r-c<=ee)&&(b.push(O),b.push($-1),b.push(1-D)),(D===0?t+c>=N:r+c>=ee)&&(b.push($+1),b.push(R),b.push(1-D))}return S}}function np(i,t,r,c,f,g){if(f-c<=r)return;const y=c+f>>1;Hy(i,t,y,c,f,g),np(i,t,r,c,y-1,1-g),np(i,t,r,y+1,f,1-g)}function Hy(i,t,r,c,f,g){for(;f>c;){if(f-c>600){const P=f-c+1,D=r-c+1,R=Math.log(P),O=.5*Math.exp(2*R/3),$=.5*Math.sqrt(R*O*(P-O)/P)*(D-P/2<0?-1:1);Hy(i,t,r,Math.max(c,Math.floor(r-D*O/P+$)),Math.min(f,Math.floor(r+(P-D)*O/P+$)),g)}const y=t[2*r+g];let b=c,S=f;for(Xc(i,t,c,r),t[2*f+g]>y&&Xc(i,t,c,f);b<S;){for(Xc(i,t,b,S),b++,S--;t[2*b+g]<y;)b++;for(;t[2*S+g]>y;)S--}t[2*c+g]===y?Xc(i,t,c,S):(S++,Xc(i,t,S,f)),S<=r&&(c=S+1),r<=S&&(f=S-1)}}function Xc(i,t,r,c){ip(i,r,c),ip(t,2*r,2*c),ip(t,2*r+1,2*c+1)}function ip(i,t,r){const c=i[t];i[t]=i[r],i[r]=c}function Xy(i,t,r,c){const f=i-r,g=t-c;return f*f+g*g}var rp;a.PerformanceMarkers=void 0,(rp=a.PerformanceMarkers||(a.PerformanceMarkers={})).create="create",rp.load="load",rp.fullLoad="fullLoad";let jh=null,Kc=[];const sp=1e3/60,op="loadTime",ap="fullLoadTime",xw={mark(i){performance.mark(i)},frame(i){const t=i;jh!=null&&Kc.push(t-jh),jh=t},clearMetrics(){jh=null,Kc=[],performance.clearMeasures(op),performance.clearMeasures(ap);for(const i in a.PerformanceMarkers)performance.clearMarks(a.PerformanceMarkers[i])},getPerformanceMetrics(){performance.measure(op,a.PerformanceMarkers.create,a.PerformanceMarkers.load),performance.measure(ap,a.PerformanceMarkers.create,a.PerformanceMarkers.fullLoad);const i=performance.getEntriesByName(op)[0].duration,t=performance.getEntriesByName(ap)[0].duration,r=Kc.length,c=1/(Kc.reduce((g,y)=>g+y,0)/r/1e3),f=Kc.filter(g=>g>sp).reduce((g,y)=>g+(y-sp)/sp,0);return{loadTime:i,fullLoadTime:t,fps:c,percentDroppedFrames:f/(r+f)*100,totalFrames:r}}};a.AJAXError=rt,a.ARRAY_TYPE=fl,a.Actor=class{constructor(i,t,r){this.target=i,this.parent=t,this.mapId=r,this.callbacks={},this.tasks={},this.taskQueue=[],this.cancelCallbacks={},Qe(["receive","process"],this),this.invoker=new uw(this.process),this.target.addEventListener("message",this.receive,!1),this.globalScope=_e()?i:window}send(i,t,r,c,f=!1){const g=Math.round(1e18*Math.random()).toString(36).substring(0,10);r&&(this.callbacks[g]=r);const y=ut(this.globalScope)?void 0:[];return this.target.postMessage({id:g,type:i,hasCallback:!!r,targetMapId:c,mustQueue:f,sourceMapId:this.mapId,data:ea(t,y)},y),{cancel:()=>{r&&delete this.callbacks[g],this.target.postMessage({id:g,type:"<cancel>",targetMapId:c,sourceMapId:this.mapId})}}}receive(i){const t=i.data,r=t.id;if(r&&(!t.targetMapId||this.mapId===t.targetMapId))if(t.type==="<cancel>"){delete this.tasks[r];const c=this.cancelCallbacks[r];delete this.cancelCallbacks[r],c&&c()}else _e()||t.mustQueue?(this.tasks[r]=t,this.taskQueue.push(r),this.invoker.trigger()):this.processTask(r,t)}process(){if(!this.taskQueue.length)return;const i=this.taskQueue.shift(),t=this.tasks[i];delete this.tasks[i],this.taskQueue.length&&this.invoker.trigger(),t&&this.processTask(i,t)}processTask(i,t){if(t.type==="<response>"){const r=this.callbacks[i];delete this.callbacks[i],r&&(t.error?r(as(t.error)):r(null,as(t.data)))}else{let r=!1;const c=ut(this.globalScope)?void 0:[],f=t.hasCallback?(b,S)=>{r=!0,delete this.cancelCallbacks[i],this.target.postMessage({id:i,type:"<response>",sourceMapId:this.mapId,error:b?ea(b):null,data:ea(S,c)},c)}:b=>{r=!0};let g=null;const y=as(t.data);if(this.parent[t.type])g=this.parent[t.type](t.sourceMapId,y,f);else if(this.parent.getWorkerSource){const b=t.type.split(".");g=this.parent.getWorkerSource(t.sourceMapId,b[0],y.source)[b[1]](y,f)}else f(new Error(`Could not find function ${t.type}`));!r&&g&&g.cancel&&(this.cancelCallbacks[i]=g.cancel)}}remove(){this.invoker.remove(),this.target.removeEventListener("message",this.receive,!1)}},a.AlphaImage=Fc,a.CanonicalTileID=Jf,a.CollisionBoxArray=p,a.CollisionCircleLayoutArray=class extends ol{},a.Color=Ht,a.DEMData=ky,a.DataConstantProperty=zt,a.DictionaryCoder=My,a.EXTENT=On,a.ErrorEvent=K,a.EvaluationParameters=Un,a.Event=wt,a.Evented=ne,a.FeatureIndex=zy,a.FillBucket=Rf,a.FillExtrusionBucket=Ff,a.GeoJSONFeature=Dy,a.ImageAtlas=hy,a.ImagePosition=Nf,a.KDBush=tp,a.LineBucket=Of,a.LineStripIndexArray=class extends n{},a.LngLat=Co,a.MercatorCoordinate=Oh,a.ONE_EM=Si,a.OverscaledTileID=Rr,a.PerformanceUtils=xw,a.Point=k,a.Pos3dArray=class extends il{},a.PosArray=Q,a.Properties=Xi,a.Protobuf=$f,a.QuadTriangleArray=class extends al{},a.RGBAImage=Lr,a.RasterBoundsArray=class extends kc{},a.RequestPerformance=class{constructor(i){this._marks={start:[i.url,"start"].join("#"),end:[i.url,"end"].join("#"),measure:i.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let i=performance.getEntriesByName(this._marks.measure);return i.length===0&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),i=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),i}},a.SegmentVector=pt,a.SymbolBucket=vl,a.Transitionable=vh,a.TriangleIndexArray=et,a.Uniform1f=Kr,a.Uniform1i=class extends Ui{constructor(i,t){super(i,t),this.current=0}set(i){this.current!==i&&(this.current=i,this.gl.uniform1i(this.location,i))}},a.Uniform2f=class extends Ui{constructor(i,t){super(i,t),this.current=[0,0]}set(i){i[0]===this.current[0]&&i[1]===this.current[1]||(this.current=i,this.gl.uniform2f(this.location,i[0],i[1]))}},a.Uniform3f=class extends Ui{constructor(i,t){super(i,t),this.current=[0,0,0]}set(i){i[0]===this.current[0]&&i[1]===this.current[1]&&i[2]===this.current[2]||(this.current=i,this.gl.uniform3f(this.location,i[0],i[1],i[2]))}},a.Uniform4f=sa,a.UniformColor=Di,a.UniformMatrix4f=class extends Ui{constructor(i,t){super(i,t),this.current=bi}set(i){if(i[12]!==this.current[12]||i[0]!==this.current[0])return this.current=i,void this.gl.uniformMatrix4fv(this.location,!1,i);for(let t=1;t<16;t++)if(i[t]!==this.current[t]){this.current=i,this.gl.uniformMatrix4fv(this.location,!1,i);break}}},a.UnwrappedTileID=Py,a.ValidationError=$e,a.ZoomHistory=fh,a.addDynamicAttributes=Gf,a.arrayBufferToImage=function(i,t){const r=new Image;r.onload=()=>{t(null,r),URL.revokeObjectURL(r.src),r.onload=null,window.requestAnimationFrame(()=>{r.src=je})},r.onerror=()=>t(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const c=new Blob([new Uint8Array(i)],{type:"image/png"});r.src=i.byteLength?URL.createObjectURL(c):je},a.arrayBufferToImageBitmap=function(i,t){const r=new Blob([new Uint8Array(i)],{type:"image/png"});createImageBitmap(r).then(c=>{t(null,c)}).catch(c=>{t(new Error(`Could not load image because of ${c.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})},a.asyncAll=function(i,t,r){if(!i.length)return r(null,[]);let c=i.length;const f=new Array(i.length);let g=null;i.forEach((y,b)=>{t(y,(S,P)=>{S&&(g=S),f[b]=P,--c==0&&r(g,f)})})},a.bezier=re,a.bindAll=Qe,a.clamp=ye,a.clipLine=By,a.clone=function(i){var t=new fl(16);return t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t[4]=i[4],t[5]=i[5],t[6]=i[6],t[7]=i[7],t[8]=i[8],t[9]=i[9],t[10]=i[10],t[11]=i[11],t[12]=i[12],t[13]=i[13],t[14]=i[14],t[15]=i[15],t},a.clone$1=j,a.collisionCircleLayout=V1,a.config=At,a.copy=function(i,t){return i[0]=t[0],i[1]=t[1],i[2]=t[2],i[3]=t[3],i[4]=t[4],i[5]=t[5],i[6]=t[6],i[7]=t[7],i[8]=t[8],i[9]=t[9],i[10]=t[10],i[11]=t[11],i[12]=t[12],i[13]=t[13],i[14]=t[14],i[15]=t[15],i},a.create=function(){var i=new fl(16);return fl!=Float32Array&&(i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[11]=0,i[12]=0,i[13]=0,i[14]=0),i[0]=1,i[5]=1,i[10]=1,i[15]=1,i},a.createExpression=Gn,a.createFilter=mc,a.createLayout=ui,a.createStyleLayer=function(i){return i.type==="custom"?new lw(i):new cw[i.type](i)},a.deepEqual=function i(t,r){if(Array.isArray(t)){if(!Array.isArray(r)||t.length!==r.length)return!1;for(let c=0;c<t.length;c++)if(!i(t[c],r[c]))return!1;return!0}if(typeof t=="object"&&t!==null&&r!==null){if(typeof r!="object"||Object.keys(t).length!==Object.keys(r).length)return!1;for(const c in t)if(!i(t[c],r[c]))return!1;return!0}return t===r},a.derefLayers=function(i){i=i.slice();const t=Object.create(null);for(let r=0;r<i.length;r++)t[i[r].id]=i[r];for(let r=0;r<i.length;r++)"ref"in i[r]&&(i[r]=Be(i[r],t[i[r].ref]));return i},a.diffStyles=function(i,t){if(!i)return[{command:Ze.setStyle,args:[t]}];let r=[];try{if(!Re(i.version,t.version))return[{command:Ze.setStyle,args:[t]}];Re(i.center,t.center)||r.push({command:Ze.setCenter,args:[t.center]}),Re(i.zoom,t.zoom)||r.push({command:Ze.setZoom,args:[t.zoom]}),Re(i.bearing,t.bearing)||r.push({command:Ze.setBearing,args:[t.bearing]}),Re(i.pitch,t.pitch)||r.push({command:Ze.setPitch,args:[t.pitch]}),Re(i.sprite,t.sprite)||r.push({command:Ze.setSprite,args:[t.sprite]}),Re(i.glyphs,t.glyphs)||r.push({command:Ze.setGlyphs,args:[t.glyphs]}),Re(i.transition,t.transition)||r.push({command:Ze.setTransition,args:[t.transition]}),Re(i.light,t.light)||r.push({command:Ze.setLight,args:[t.light]});const c={},f=[];(function(y,b,S,P){let D;for(D in b=b||{},y=y||{})Object.prototype.hasOwnProperty.call(y,D)&&(Object.prototype.hasOwnProperty.call(b,D)||ht(D,S,P));for(D in b)Object.prototype.hasOwnProperty.call(b,D)&&(Object.prototype.hasOwnProperty.call(y,D)?Re(y[D],b[D])||(y[D].type==="geojson"&&b[D].type==="geojson"&&lt(y,b,D)?S.push({command:Ze.setGeoJSONSourceData,args:[D,b[D].data]}):Je(D,b,S,P)):ot(D,b,S))})(i.sources,t.sources,f,c);const g=[];i.layers&&i.layers.forEach(y=>{c[y.source]?r.push({command:Ze.removeLayer,args:[y.id]}):g.push(y)}),r=r.concat(f),function(y,b,S){b=b||[];const P=(y=y||[]).map(Mt),D=b.map(Mt),R=y.reduce(xt,{}),O=b.reduce(xt,{}),$=P.slice(),N=Object.create(null);let ee,J,fe,ve,ue,Ie,Me;for(ee=0,J=0;ee<P.length;ee++)fe=P[ee],Object.prototype.hasOwnProperty.call(O,fe)?J++:(S.push({command:Ze.removeLayer,args:[fe]}),$.splice($.indexOf(fe,J),1));for(ee=0,J=0;ee<D.length;ee++)fe=D[D.length-1-ee],$[$.length-1-ee]!==fe&&(Object.prototype.hasOwnProperty.call(R,fe)?(S.push({command:Ze.removeLayer,args:[fe]}),$.splice($.lastIndexOf(fe,$.length-J),1)):J++,Ie=$[$.length-ee],S.push({command:Ze.addLayer,args:[O[fe],Ie]}),$.splice($.length-ee,0,fe),N[fe]=!0);for(ee=0;ee<D.length;ee++)if(fe=D[ee],ve=R[fe],ue=O[fe],!N[fe]&&!Re(ve,ue))if(Re(ve.source,ue.source)&&Re(ve["source-layer"],ue["source-layer"])&&Re(ve.type,ue.type)){for(Me in ft(ve.layout,ue.layout,S,fe,null,Ze.setLayoutProperty),ft(ve.paint,ue.paint,S,fe,null,Ze.setPaintProperty),Re(ve.filter,ue.filter)||S.push({command:Ze.setFilter,args:[fe,ue.filter]}),Re(ve.minzoom,ue.minzoom)&&Re(ve.maxzoom,ue.maxzoom)||S.push({command:Ze.setLayerZoomRange,args:[fe,ue.minzoom,ue.maxzoom]}),ve)Object.prototype.hasOwnProperty.call(ve,Me)&&Me!=="layout"&&Me!=="paint"&&Me!=="filter"&&Me!=="metadata"&&Me!=="minzoom"&&Me!=="maxzoom"&&(Me.indexOf("paint.")===0?ft(ve[Me],ue[Me],S,fe,Me.slice(6),Ze.setPaintProperty):Re(ve[Me],ue[Me])||S.push({command:Ze.setLayerProperty,args:[fe,Me,ue[Me]]}));for(Me in ue)Object.prototype.hasOwnProperty.call(ue,Me)&&!Object.prototype.hasOwnProperty.call(ve,Me)&&Me!=="layout"&&Me!=="paint"&&Me!=="filter"&&Me!=="metadata"&&Me!=="minzoom"&&Me!=="maxzoom"&&(Me.indexOf("paint.")===0?ft(ve[Me],ue[Me],S,fe,Me.slice(6),Ze.setPaintProperty):Re(ve[Me],ue[Me])||S.push({command:Ze.setLayerProperty,args:[fe,Me,ue[Me]]}))}else S.push({command:Ze.removeLayer,args:[fe]}),Ie=$[$.lastIndexOf(fe)+1],S.push({command:Ze.addLayer,args:[ue,Ie]})}(g,t.layers,r)}catch(c){console.warn("Unable to compute style diff:",c),r=[{command:Ze.setStyle,args:[t]}]}return r},a.dot=function(i,t){return i[0]*t[0]+i[1]*t[1]+i[2]*t[2]+i[3]*t[3]},a.earthRadius=Kf,a.ease=me,a.emitValidationErrors=_o,a.emptyStyle=function(){const i={},t=Z.$version;for(const r in Z.$root){const c=Z.$root[r];if(c.required){let f=null;f=r==="version"?t:c.type==="array"?[]:{},f!=null&&(i[r]=f)}}return i},a.equals=function(i,t){var r=i[0],c=i[1],f=i[2],g=i[3],y=i[4],b=i[5],S=i[6],P=i[7],D=i[8],R=i[9],O=i[10],$=i[11],N=i[12],ee=i[13],J=i[14],fe=i[15],ve=t[0],ue=t[1],Ie=t[2],Me=t[3],qe=t[4],Ct=t[5],kt=t[6],_t=t[7],mt=t[8],dt=t[9],vt=t[10],gt=t[11],st=t[12],Vt=t[13],Dt=t[14],sn=t[15];return Math.abs(r-ve)<=Ki*Math.max(1,Math.abs(r),Math.abs(ve))&&Math.abs(c-ue)<=Ki*Math.max(1,Math.abs(c),Math.abs(ue))&&Math.abs(f-Ie)<=Ki*Math.max(1,Math.abs(f),Math.abs(Ie))&&Math.abs(g-Me)<=Ki*Math.max(1,Math.abs(g),Math.abs(Me))&&Math.abs(y-qe)<=Ki*Math.max(1,Math.abs(y),Math.abs(qe))&&Math.abs(b-Ct)<=Ki*Math.max(1,Math.abs(b),Math.abs(Ct))&&Math.abs(S-kt)<=Ki*Math.max(1,Math.abs(S),Math.abs(kt))&&Math.abs(P-_t)<=Ki*Math.max(1,Math.abs(P),Math.abs(_t))&&Math.abs(D-mt)<=Ki*Math.max(1,Math.abs(D),Math.abs(mt))&&Math.abs(R-dt)<=Ki*Math.max(1,Math.abs(R),Math.abs(dt))&&Math.abs(O-vt)<=Ki*Math.max(1,Math.abs(O),Math.abs(vt))&&Math.abs($-gt)<=Ki*Math.max(1,Math.abs($),Math.abs(gt))&&Math.abs(N-st)<=Ki*Math.max(1,Math.abs(N),Math.abs(st))&&Math.abs(ee-Vt)<=Ki*Math.max(1,Math.abs(ee),Math.abs(Vt))&&Math.abs(J-Dt)<=Ki*Math.max(1,Math.abs(J),Math.abs(Dt))&&Math.abs(fe-sn)<=Ki*Math.max(1,Math.abs(fe),Math.abs(sn))},a.evaluateSizeForFeature=function(i,{uSize:t,uSizeT:r},{lowerSize:c,upperSize:f}){return i.kind==="source"?c/Is:i.kind==="composite"?nr.number(c/Is,f/Is,r):t},a.evaluateSizeForZoom=function(i,t){let r=0,c=0;if(i.kind==="constant")c=i.layoutSize;else if(i.kind!=="source"){const{interpolationType:f,minZoom:g,maxZoom:y}=i,b=f?ye(ir.interpolationFactor(f,t,g,y),0,1):0;i.kind==="camera"?c=nr.number(i.minSize,i.maxSize,b):r=b}return{uSizeT:r,uSize:c}},a.evaluateVariableOffset=qy,a.evented=el,a.exported=Tt,a.extend=be,a.filterObject=ze,a.findLineIntersection=function(i,t,r,c){const f=t.y-i.y,g=t.x-i.x,y=c.y-r.y,b=c.x-r.x,S=y*g-b*f;if(S===0)return null;const P=(b*(i.y-r.y)-y*(i.x-r.x))/S;return new k(i.x+P*g,i.y+P*f)},a.fromScaling=function(i,t){return i[0]=t[0],i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=t[1],i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=t[2],i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,i},a.getAnchorAlignment=qf,a.getAnchorJustification=ep,a.getArrayBuffer=Ae,a.getDefaultExportFromCjs=I,a.getJSON=function(i,t){return Ne(be(i,{type:"json"}),t)},a.getOverlapMode=Zf,a.getProtocolAction=Gt,a.getRTLTextPluginStatus=Ec,a.getReferrer=It,a.getVideo=function(i,t){const r=window.document.createElement("video");r.muted=!0,r.onloadstart=function(){t(null,r)};for(let c=0;c<i.length;c++){const f=window.document.createElement("source");tt(i[c])||(r.crossOrigin="Anonymous"),f.src=i[c],r.appendChild(f)}return{cancel:()=>{}}},a.groupByLayout=function(i,t){const r={};for(let f=0;f<i.length;f++){const g=t&&t[i[f].id]||gf(i[f]);t&&(t[i[f].id]=g);let y=r[g];y||(y=r[g]=[]),y.push(i[f])}const c=[];for(const f in r)c.push(r[f]);return c},a.identity=Ef,a.interpolate=nr,a.invert=function(i,t){var r=t[0],c=t[1],f=t[2],g=t[3],y=t[4],b=t[5],S=t[6],P=t[7],D=t[8],R=t[9],O=t[10],$=t[11],N=t[12],ee=t[13],J=t[14],fe=t[15],ve=r*b-c*y,ue=r*S-f*y,Ie=r*P-g*y,Me=c*S-f*b,qe=c*P-g*b,Ct=f*P-g*S,kt=D*ee-R*N,_t=D*J-O*N,mt=D*fe-$*N,dt=R*J-O*ee,vt=R*fe-$*ee,gt=O*fe-$*J,st=ve*gt-ue*vt+Ie*dt+Me*mt-qe*_t+Ct*kt;return st?(i[0]=(b*gt-S*vt+P*dt)*(st=1/st),i[1]=(f*vt-c*gt-g*dt)*st,i[2]=(ee*Ct-J*qe+fe*Me)*st,i[3]=(O*qe-R*Ct-$*Me)*st,i[4]=(S*mt-y*gt-P*_t)*st,i[5]=(r*gt-f*mt+g*_t)*st,i[6]=(J*Ie-N*Ct-fe*ue)*st,i[7]=(D*Ct-O*Ie+$*ue)*st,i[8]=(y*vt-b*mt+P*kt)*st,i[9]=(c*mt-r*vt-g*kt)*st,i[10]=(N*qe-ee*Ie+fe*ve)*st,i[11]=(R*Ie-D*qe-$*ve)*st,i[12]=(b*_t-y*dt-S*kt)*st,i[13]=(r*dt-c*_t+f*kt)*st,i[14]=(ee*ue-N*Me-J*ve)*st,i[15]=(D*Me-R*ue+O*ve)*st,i):null},a.isImageBitmap=at,a.isSafari=ut,a.isWorker=_e,a.keysDifference=function(i,t){const r=[];for(const c in i)c in t||r.push(c);return r},a.lazyLoadRTLTextPlugin=function(){wr.isLoading()||wr.isLoaded()||Ec()!=="deferred"||_h()},a.makeRequest=Ne,a.mapObject=Ue,a.mercatorXfromLng=Ey,a.mercatorYfromLat=Ty,a.mercatorZfromAltitude=Iy,a.mul=Yb,a.mul$1=function(i,t,r){return i[0]=t[0]*r[0],i[1]=t[1]*r[1],i[2]=t[2]*r[2],i[3]=t[3]*r[3],i},a.multiply=kg,a.nextPowerOfTwo=function(i){return i<=1?1:Math.pow(2,Math.ceil(Math.log(i)/Math.LN2))},a.operations=Ze,a.ortho=function(i,t,r,c,f,g,y){var b=1/(t-r),S=1/(c-f),P=1/(g-y);return i[0]=-2*b,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=-2*S,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=2*P,i[11]=0,i[12]=(t+r)*b,i[13]=(f+c)*S,i[14]=(y+g)*P,i[15]=1,i},a.parseCacheControl=function(i){const t={};if(i.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(r,c,f,g)=>{const y=f||g;return t[c]=!y||y.toLowerCase(),""}),t["max-age"]){const r=parseInt(t["max-age"],10);isNaN(r)?delete t["max-age"]:t["max-age"]=r}return t},a.parseGlyphPbf=function(i){return new $f(i).readFields(K1,[])},a.pbf=ny,a.performSymbolLayout=function(i){i.bucket.createArrays(),i.bucket.tilePixelRatio=On/(512*i.bucket.overscaling),i.bucket.compareText={},i.bucket.iconsNeedLinear=!1;const t=i.bucket.layers[0].layout,r=i.bucket.layers[0]._unevaluatedLayout._values,c={layoutIconSize:r["icon-size"].possiblyEvaluate(new Un(i.bucket.zoom+1),i.canonical),layoutTextSize:r["text-size"].possiblyEvaluate(new Un(i.bucket.zoom+1),i.canonical),textMaxSize:r["text-size"].possiblyEvaluate(new Un(18))};if(i.bucket.textSizeData.kind==="composite"){const{minZoom:S,maxZoom:P}=i.bucket.textSizeData;c.compositeTextSizes=[r["text-size"].possiblyEvaluate(new Un(S),i.canonical),r["text-size"].possiblyEvaluate(new Un(P),i.canonical)]}if(i.bucket.iconSizeData.kind==="composite"){const{minZoom:S,maxZoom:P}=i.bucket.iconSizeData;c.compositeIconSizes=[r["icon-size"].possiblyEvaluate(new Un(S),i.canonical),r["icon-size"].possiblyEvaluate(new Un(P),i.canonical)]}const f=t.get("text-line-height")*Si,g=t.get("text-rotation-alignment")!=="viewport"&&t.get("symbol-placement")!=="point",y=t.get("text-keep-upright"),b=t.get("text-size");for(const S of i.bucket.features){const P=t.get("text-font").evaluate(S,{},i.canonical).join(","),D=b.evaluate(S,{},i.canonical),R=c.layoutTextSize.evaluate(S,{},i.canonical),O=c.layoutIconSize.evaluate(S,{},i.canonical),$={horizontal:{},vertical:void 0},N=S.text;let ee,J=[0,0];if(N){const ue=N.toString(),Ie=t.get("text-letter-spacing").evaluate(S,{},i.canonical)*Si,Me=bc(ue)?Ie:0,qe=t.get("text-anchor").evaluate(S,{},i.canonical),Ct=t.get("text-variable-anchor");if(!Ct){const vt=t.get("text-radial-offset").evaluate(S,{},i.canonical);J=vt?qy(qe,[vt*Si,Qf]):t.get("text-offset").evaluate(S,{},i.canonical).map(gt=>gt*Si)}let kt=g?"center":t.get("text-justify").evaluate(S,{},i.canonical);const _t=t.get("symbol-placement"),mt=_t==="point"?t.get("text-max-width").evaluate(S,{},i.canonical)*Si:0,dt=()=>{i.bucket.allowVerticalPlacement&&Xa(ue)&&($.vertical=Lh(N,i.glyphMap,i.glyphPositions,i.imagePositions,P,mt,f,qe,"left",Me,J,a.WritingMode.vertical,!0,_t,R,D))};if(!g&&Ct){const vt=kt==="auto"?Ct.map(st=>ep(st)):[kt];let gt=!1;for(let st=0;st<vt.length;st++){const Vt=vt[st];if(!$.horizontal[Vt])if(gt)$.horizontal[Vt]=$.horizontal[0];else{const Dt=Lh(N,i.glyphMap,i.glyphPositions,i.imagePositions,P,mt,f,"center",Vt,Me,J,a.WritingMode.horizontal,!1,_t,R,D);Dt&&($.horizontal[Vt]=Dt,gt=Dt.positionedLines.length===1)}}dt()}else{kt==="auto"&&(kt=ep(qe));const vt=Lh(N,i.glyphMap,i.glyphPositions,i.imagePositions,P,mt,f,qe,kt,Me,J,a.WritingMode.horizontal,!1,_t,R,D);vt&&($.horizontal[kt]=vt),dt(),Xa(ue)&&g&&y&&($.vertical=Lh(N,i.glyphMap,i.glyphPositions,i.imagePositions,P,mt,f,qe,kt,Me,J,a.WritingMode.vertical,!1,_t,R,D))}}let fe=!1;if(S.icon&&S.icon.name){const ue=i.imageMap[S.icon.name];ue&&(ee=nw(i.imagePositions[S.icon.name],t.get("icon-offset").evaluate(S,{},i.canonical),t.get("icon-anchor").evaluate(S,{},i.canonical)),fe=!!ue.sdf,i.bucket.sdfIcons===void 0?i.bucket.sdfIcons=fe:i.bucket.sdfIcons!==fe&&pe("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(ue.pixelRatio!==i.bucket.pixelRatio||t.get("icon-rotate").constantOr(1)!==0)&&(i.bucket.iconsNeedLinear=!0))}const ve=Gy($.horizontal)||$.vertical;i.bucket.iconsInText=!!ve&&ve.iconsInText,(ve||ee)&&_w(i.bucket,S,$,ee,i.imageMap,c,R,O,J,fe,i.canonical)}i.showCollisionBoxes&&i.bucket.generateCollisionDebugBuffers()},a.perspective=function(i,t,r,c,f){var g,y=1/Math.tan(t/2);return i[0]=y/r,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=y,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[11]=-1,i[12]=0,i[13]=0,i[15]=0,f!=null&&f!==1/0?(i[10]=(f+c)*(g=1/(c-f)),i[14]=2*f*c*g):(i[10]=-1,i[14]=-2*c),i},a.pick=function(i,t){const r={};for(let c=0;c<t.length;c++){const f=t[c];f in i&&(r[f]=i[f])}return r},a.plugin=wr,a.pointGeometry=T,a.polygonIntersectsPolygon=Cg,a.potpack=uy,a.register=Et,a.registerForPluginStateChange=function(i){return i({pluginStatus:Hi,pluginURL:Ts}),el.on("pluginStateChange",i),i},a.renderColorRamp=Rg,a.rotateX=function(i,t,r){var c=Math.sin(r),f=Math.cos(r),g=t[4],y=t[5],b=t[6],S=t[7],P=t[8],D=t[9],R=t[10],O=t[11];return t!==i&&(i[0]=t[0],i[1]=t[1],i[2]=t[2],i[3]=t[3],i[12]=t[12],i[13]=t[13],i[14]=t[14],i[15]=t[15]),i[4]=g*f+P*c,i[5]=y*f+D*c,i[6]=b*f+R*c,i[7]=S*f+O*c,i[8]=P*f-g*c,i[9]=D*f-y*c,i[10]=R*f-b*c,i[11]=O*f-S*c,i},a.rotateZ=function(i,t,r){var c=Math.sin(r),f=Math.cos(r),g=t[0],y=t[1],b=t[2],S=t[3],P=t[4],D=t[5],R=t[6],O=t[7];return t!==i&&(i[8]=t[8],i[9]=t[9],i[10]=t[10],i[11]=t[11],i[12]=t[12],i[13]=t[13],i[14]=t[14],i[15]=t[15]),i[0]=g*f+P*c,i[1]=y*f+D*c,i[2]=b*f+R*c,i[3]=S*f+O*c,i[4]=P*f-g*c,i[5]=D*f-y*c,i[6]=R*f-b*c,i[7]=O*f-S*c,i},a.sameOrigin=tt,a.scale=function(i,t,r){var c=r[0],f=r[1],g=r[2];return i[0]=t[0]*c,i[1]=t[1]*c,i[2]=t[2]*c,i[3]=t[3]*c,i[4]=t[4]*f,i[5]=t[5]*f,i[6]=t[6]*f,i[7]=t[7]*f,i[8]=t[8]*g,i[9]=t[9]*g,i[10]=t[10]*g,i[11]=t[11]*g,i[12]=t[12],i[13]=t[13],i[14]=t[14],i[15]=t[15],i},a.setRTLTextPlugin=function(i,t,r=!1){if(Hi===wc||Hi===Qa||Hi===Sc)throw new Error("setRTLTextPlugin cannot be called multiple times.");Ts=Tt.resolveURL(i),Hi=wc,ta=t,Cc(),r||_h()},a.sphericalToCartesian=function([i,t,r]){return t+=90,t*=Math.PI/180,r*=Math.PI/180,{x:i*Math.cos(t)*Math.sin(r),y:i*Math.sin(t)*Math.sin(r),z:i*Math.cos(r)}},a.toEvaluationFeature=aa,a.transformMat4=Ih,a.translate=function(i,t,r){var c,f,g,y,b,S,P,D,R,O,$,N,ee=r[0],J=r[1],fe=r[2];return t===i?(i[12]=t[0]*ee+t[4]*J+t[8]*fe+t[12],i[13]=t[1]*ee+t[5]*J+t[9]*fe+t[13],i[14]=t[2]*ee+t[6]*J+t[10]*fe+t[14],i[15]=t[3]*ee+t[7]*J+t[11]*fe+t[15]):(f=t[1],g=t[2],y=t[3],b=t[4],S=t[5],P=t[6],D=t[7],R=t[8],O=t[9],$=t[10],N=t[11],i[0]=c=t[0],i[1]=f,i[2]=g,i[3]=y,i[4]=b,i[5]=S,i[6]=P,i[7]=D,i[8]=R,i[9]=O,i[10]=$,i[11]=N,i[12]=c*ee+b*J+R*fe+t[12],i[13]=f*ee+S*J+O*fe+t[13],i[14]=g*ee+P*J+$*fe+t[14],i[15]=y*ee+D*J+N*fe+t[15]),i},a.triggerPluginCompletionEvent=yh,a.unicodeBlockLookup=yt,a.uniqueId=function(){return Oe++},a.v8Spec=Z,a.validateCustomStyleLayer=function(i){const t=[],r=i.id;return r===void 0&&t.push({message:`layers.${r}: missing required property "id"`}),i.render===void 0&&t.push({message:`layers.${r}: missing required method "render"`}),i.renderingMode&&i.renderingMode!=="2d"&&i.renderingMode!=="3d"&&t.push({message:`layers.${r}: property "renderingMode" must be either "2d" or "3d"`}),t},a.validateLight=yf,a.validateStyle=Es,a.vectorTile=bo,a.warnOnce=pe,a.wrap=Ee}),_(["./shared"],function(a){class I{constructor(B){this.keyCache={},B&&this.replace(B)}replace(B){this._layerConfigs={},this._layers={},this.update(B,[])}update(B,V){for(const oe of B){this._layerConfigs[oe.id]=oe;const le=this._layers[oe.id]=a.createStyleLayer(oe);le._featureFilter=a.createFilter(le.filter),this.keyCache[oe.id]&&delete this.keyCache[oe.id]}for(const oe of V)delete this.keyCache[oe],delete this._layerConfigs[oe],delete this._layers[oe];this.familiesBySource={};const W=a.groupByLayout(Object.values(this._layerConfigs),this.keyCache);for(const oe of W){const le=oe.map(Ke=>this._layers[Ke.id]),ge=le[0];if(ge.visibility==="none")continue;const he=ge.source||"";let ce=this.familiesBySource[he];ce||(ce=this.familiesBySource[he]={});const xe=ge.sourceLayer||"_geojsonTileLayer";let We=ce[xe];We||(We=ce[xe]=[]),We.push(le)}}}class T{constructor(B){const V={},W=[];for(const he in B){const ce=B[he],xe=V[he]={};for(const We in ce){const Ke=ce[+We];if(!Ke||Ke.bitmap.width===0||Ke.bitmap.height===0)continue;const Xe={x:0,y:0,w:Ke.bitmap.width+2,h:Ke.bitmap.height+2};W.push(Xe),xe[We]={rect:Xe,metrics:Ke.metrics}}}const{w:oe,h:le}=a.potpack(W),ge=new a.AlphaImage({width:oe||1,height:le||1});for(const he in B){const ce=B[he];for(const xe in ce){const We=ce[+xe];if(!We||We.bitmap.width===0||We.bitmap.height===0)continue;const Ke=V[he][xe].rect;a.AlphaImage.copy(We.bitmap,ge,{x:0,y:0},{x:Ke.x+1,y:Ke.y+1},We.bitmap)}}this.image=ge,this.positions=V}}a.register("GlyphAtlas",T);class M{constructor(B){this.tileID=new a.OverscaledTileID(B.tileID.overscaledZ,B.tileID.wrap,B.tileID.canonical.z,B.tileID.canonical.x,B.tileID.canonical.y),this.uid=B.uid,this.zoom=B.zoom,this.pixelRatio=B.pixelRatio,this.tileSize=B.tileSize,this.source=B.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=B.showCollisionBoxes,this.collectResourceTiming=!!B.collectResourceTiming,this.returnDependencies=!!B.returnDependencies,this.promoteId=B.promoteId}parse(B,V,W,oe,le){this.status="parsing",this.data=B,this.collisionBoxArray=new a.CollisionBoxArray;const ge=new a.DictionaryCoder(Object.keys(B.layers).sort()),he=new a.FeatureIndex(this.tileID,this.promoteId);he.bucketLayerIDs=[];const ce={},xe={featureIndex:he,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:W},We=V.familiesBySource[this.source];for(const nn in We){const gn=B.layers[nn];if(!gn)continue;gn.version===1&&a.warnOnce(`Vector tile source "${this.source}" layer "${nn}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const zn=ge.encode(nn),ai=[];for(let Ht=0;Ht<gn.length;Ht++){const Xn=gn.feature(Ht),bs=he.getId(Xn,nn);ai.push({feature:Xn,id:bs,index:Ht,sourceLayerIndex:zn})}for(const Ht of We[nn]){const Xn=Ht[0];Xn.source!==this.source&&a.warnOnce(`layer.source = ${Xn.source} does not equal this.source = ${this.source}`),Xn.minzoom&&this.zoom<Math.floor(Xn.minzoom)||Xn.maxzoom&&this.zoom>=Xn.maxzoom||Xn.visibility!=="none"&&(k(Ht,this.zoom,W),(ce[Xn.id]=Xn.createBucket({index:he.bucketLayerIDs.length,layers:Ht,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:zn,sourceID:this.source})).populate(ai,xe,this.tileID.canonical),he.bucketLayerIDs.push(Ht.map(bs=>bs.id)))}}let Ke,Xe,Ut,Yt;const Pt=a.mapObject(xe.glyphDependencies,nn=>Object.keys(nn).map(Number));Object.keys(Pt).length?oe.send("getGlyphs",{uid:this.uid,stacks:Pt,source:this.source,tileID:this.tileID,type:"glyphs"},(nn,gn)=>{Ke||(Ke=nn,Xe=gn,un.call(this))}):Xe={};const Ft=Object.keys(xe.iconDependencies);Ft.length?oe.send("getImages",{icons:Ft,source:this.source,tileID:this.tileID,type:"icons"},(nn,gn)=>{Ke||(Ke=nn,Ut=gn,un.call(this))}):Ut={};const Xt=Object.keys(xe.patternDependencies);function un(){if(Ke)return le(Ke);if(Xe&&Ut&&Yt){const nn=new T(Xe),gn=new a.ImageAtlas(Ut,Yt);for(const zn in ce){const ai=ce[zn];ai instanceof a.SymbolBucket?(k(ai.layers,this.zoom,W),a.performSymbolLayout({bucket:ai,glyphMap:Xe,glyphPositions:nn.positions,imageMap:Ut,imagePositions:gn.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical})):ai.hasPattern&&(ai instanceof a.LineBucket||ai instanceof a.FillBucket||ai instanceof a.FillExtrusionBucket)&&(k(ai.layers,this.zoom,W),ai.addFeatures(xe,this.tileID.canonical,gn.patternPositions))}this.status="done",le(null,{buckets:Object.values(ce).filter(zn=>!zn.isEmpty()),featureIndex:he,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:nn.image,imageAtlas:gn,glyphMap:this.returnDependencies?Xe:null,iconMap:this.returnDependencies?Ut:null,glyphPositions:this.returnDependencies?nn.positions:null})}}Xt.length?oe.send("getImages",{icons:Xt,source:this.source,tileID:this.tileID,type:"patterns"},(nn,gn)=>{Ke||(Ke=nn,Yt=gn,un.call(this))}):Yt={},un.call(this)}}function k(te,B,V){const W=new a.EvaluationParameters(B);for(const oe of te)oe.recalculate(W,V)}function F(te,B){const V=a.getArrayBuffer(te.request,(W,oe,le,ge)=>{W?B(W):oe&&B(null,{vectorTile:new a.vectorTile.VectorTile(new a.Protobuf(oe)),rawData:oe,cacheControl:le,expires:ge})});return()=>{V.cancel(),B()}}class q{constructor(B,V,W,oe){this.actor=B,this.layerIndex=V,this.availableImages=W,this.loadVectorData=oe||F,this.loading={},this.loaded={}}loadTile(B,V){const W=B.uid;this.loading||(this.loading={});const oe=!!(B&&B.request&&B.request.collectResourceTiming)&&new a.RequestPerformance(B.request),le=this.loading[W]=new M(B);le.abort=this.loadVectorData(B,(ge,he)=>{if(delete this.loading[W],ge||!he)return le.status="done",this.loaded[W]=le,V(ge);const ce=he.rawData,xe={};he.expires&&(xe.expires=he.expires),he.cacheControl&&(xe.cacheControl=he.cacheControl);const We={};if(oe){const Ke=oe.finish();Ke&&(We.resourceTiming=JSON.parse(JSON.stringify(Ke)))}le.vectorTile=he.vectorTile,le.parse(he.vectorTile,this.layerIndex,this.availableImages,this.actor,(Ke,Xe)=>{if(Ke||!Xe)return V(Ke);V(null,a.extend({rawTileData:ce.slice(0)},Xe,xe,We))}),this.loaded=this.loaded||{},this.loaded[W]=le})}reloadTile(B,V){const W=this.loaded,oe=B.uid,le=this;if(W&&W[oe]){const ge=W[oe];ge.showCollisionBoxes=B.showCollisionBoxes;const he=(ce,xe)=>{const We=ge.reloadCallback;We&&(delete ge.reloadCallback,ge.parse(ge.vectorTile,le.layerIndex,this.availableImages,le.actor,We)),V(ce,xe)};ge.status==="parsing"?ge.reloadCallback=he:ge.status==="done"&&(ge.vectorTile?ge.parse(ge.vectorTile,this.layerIndex,this.availableImages,this.actor,he):he())}}abortTile(B,V){const W=this.loading,oe=B.uid;W&&W[oe]&&W[oe].abort&&(W[oe].abort(),delete W[oe]),V()}removeTile(B,V){const W=this.loaded,oe=B.uid;W&&W[oe]&&delete W[oe],V()}}class X{constructor(){this.loaded={}}loadTile(B,V){const{uid:W,encoding:oe,rawImageData:le}=B,ge=a.isImageBitmap(le)?this.getImageData(le):le,he=new a.DEMData(W,ge,oe);this.loaded=this.loaded||{},this.loaded[W]=he,V(null,he)}getImageData(B){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(B.width,B.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d",{willReadFrequently:!0})),this.offscreenCanvas.width=B.width,this.offscreenCanvas.height=B.height,this.offscreenCanvasContext.drawImage(B,0,0,B.width,B.height);const V=this.offscreenCanvasContext.getImageData(-1,-1,B.width+2,B.height+2);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),new a.RGBAImage({width:V.width,height:V.height},V.data)}removeTile(B){const V=this.loaded,W=B.uid;V&&V[W]&&delete V[W]}}function re(te,B){if(te.length!==0){me(te[0],B);for(var V=1;V<te.length;V++)me(te[V],!B)}}function me(te,B){for(var V=0,W=0,oe=0,le=te.length,ge=le-1;oe<le;ge=oe++){var he=(te[oe][0]-te[ge][0])*(te[ge][1]+te[oe][1]),ce=V+he;W+=Math.abs(V)>=Math.abs(he)?V-ce+he:he-ce+V,V=ce}V+W>=0!=!!B&&te.reverse()}var ye=a.getDefaultExportFromCjs(function te(B,V){var W,oe=B&&B.type;if(oe==="FeatureCollection")for(W=0;W<B.features.length;W++)te(B.features[W],V);else if(oe==="GeometryCollection")for(W=0;W<B.geometries.length;W++)te(B.geometries[W],V);else if(oe==="Feature")te(B.geometry,V);else if(oe==="Polygon")re(B.coordinates,V);else if(oe==="MultiPolygon")for(W=0;W<B.coordinates.length;W++)re(B.coordinates[W],V);return B});const Ee=a.vectorTile.VectorTileFeature.prototype.toGeoJSON;var be={exports:{}},Oe=a.pointGeometry,Qe=a.vectorTile.VectorTileFeature,Ue=ze;function ze(te,B){this.options=B||{},this.features=te,this.length=te.length}function j(te,B){this.id=typeof te.id=="number"?te.id:void 0,this.type=te.type,this.rawGeometry=te.type===1?[te.geometry]:te.geometry,this.properties=te.tags,this.extent=B||4096}ze.prototype.feature=function(te){return new j(this.features[te],this.options.extent)},j.prototype.loadGeometry=function(){var te=this.rawGeometry;this.geometry=[];for(var B=0;B<te.length;B++){for(var V=te[B],W=[],oe=0;oe<V.length;oe++)W.push(new Oe(V[oe][0],V[oe][1]));this.geometry.push(W)}return this.geometry},j.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var te=this.geometry,B=1/0,V=-1/0,W=1/0,oe=-1/0,le=0;le<te.length;le++)for(var ge=te[le],he=0;he<ge.length;he++){var ce=ge[he];B=Math.min(B,ce.x),V=Math.max(V,ce.x),W=Math.min(W,ce.y),oe=Math.max(oe,ce.y)}return[B,W,V,oe]},j.prototype.toGeoJSON=Qe.prototype.toGeoJSON;var G=a.pbf,pe=Ue;function Se(te){var B=new G;return function(V,W){for(var oe in V.layers)W.writeMessage(3,Ce,V.layers[oe])}(te,B),B.finish()}function Ce(te,B){var V;B.writeVarintField(15,te.version||1),B.writeStringField(1,te.name||""),B.writeVarintField(5,te.extent||4096);var W={keys:[],values:[],keycache:{},valuecache:{}};for(V=0;V<te.length;V++)W.feature=te.feature(V),B.writeMessage(2,_e,W);var oe=W.keys;for(V=0;V<oe.length;V++)B.writeStringField(3,oe[V]);var le=W.values;for(V=0;V<le.length;V++)B.writeMessage(4,Ve,le[V])}function _e(te,B){var V=te.feature;V.id!==void 0&&B.writeVarintField(1,V.id),B.writeMessage(2,Fe,te),B.writeVarintField(3,V.type),B.writeMessage(4,je,V)}function Fe(te,B){var V=te.feature,W=te.keys,oe=te.values,le=te.keycache,ge=te.valuecache;for(var he in V.properties){var ce=V.properties[he],xe=le[he];if(ce!==null){xe===void 0&&(W.push(he),le[he]=xe=W.length-1),B.writeVarint(xe);var We=typeof ce;We!=="string"&&We!=="boolean"&&We!=="number"&&(ce=JSON.stringify(ce));var Ke=We+":"+ce,Xe=ge[Ke];Xe===void 0&&(oe.push(ce),ge[Ke]=Xe=oe.length-1),B.writeVarint(Xe)}}}function ut(te,B){return(B<<3)+(7&te)}function at(te){return te<<1^te>>31}function je(te,B){for(var V=te.loadGeometry(),W=te.type,oe=0,le=0,ge=V.length,he=0;he<ge;he++){var ce=V[he],xe=1;W===1&&(xe=ce.length),B.writeVarint(ut(1,xe));for(var We=W===3?ce.length-1:ce.length,Ke=0;Ke<We;Ke++){Ke===1&&W!==1&&B.writeVarint(ut(2,We-1));var Xe=ce[Ke].x-oe,Ut=ce[Ke].y-le;B.writeVarint(at(Xe)),B.writeVarint(at(Ut)),oe+=Xe,le+=Ut}W===3&&B.writeVarint(ut(7,1))}}function Ve(te,B){var V=typeof te;V==="string"?B.writeStringField(1,te):V==="boolean"?B.writeBooleanField(7,te):V==="number"&&(te%1!=0?B.writeDoubleField(3,te):te<0?B.writeSVarintField(6,te):B.writeVarintField(5,te))}be.exports=Se,be.exports.fromVectorTileJs=Se,be.exports.fromGeojsonVt=function(te,B){B=B||{};var V={};for(var W in te)V[W]=new pe(te[W].features,B),V[W].name=W,V[W].version=B.version,V[W].extent=B.extent;return Se({layers:V})},be.exports.GeoJSONWrapper=pe;var Ge=a.getDefaultExportFromCjs(be.exports);const Tt={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:te=>te},At=Math.fround||(rt=new Float32Array(1),te=>(rt[0]=+te,rt[0]));var rt;const It=3,Gt=5,Rt=6;class Ne{constructor(B){this.options=Object.assign(Object.create(Tt),B),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(B){const{log:V,minZoom:W,maxZoom:oe}=this.options;V&&console.time("total time");const le=`prepare ${B.length} points`;V&&console.time(le),this.points=B;const ge=[];for(let ce=0;ce<B.length;ce++){const xe=B[ce];if(!xe.geometry)continue;const[We,Ke]=xe.geometry.coordinates,Xe=At(Le(We)),Ut=At(He(Ke));ge.push(Xe,Ut,1/0,ce,-1,1),this.options.reduce&&ge.push(0)}let he=this.trees[oe+1]=this._createTree(ge);V&&console.timeEnd(le);for(let ce=oe;ce>=W;ce--){const xe=+Date.now();he=this.trees[ce]=this._createTree(this._cluster(he,ce)),V&&console.log("z%d: %d clusters in %dms",ce,he.numItems,+Date.now()-xe)}return V&&console.timeEnd("total time"),this}getClusters(B,V){let W=((B[0]+180)%360+360)%360-180;const oe=Math.max(-90,Math.min(90,B[1]));let le=B[2]===180?180:((B[2]+180)%360+360)%360-180;const ge=Math.max(-90,Math.min(90,B[3]));if(B[2]-B[0]>=360)W=-180,le=180;else if(W>le){const Ke=this.getClusters([W,oe,180,ge],V),Xe=this.getClusters([-180,oe,le,ge],V);return Ke.concat(Xe)}const he=this.trees[this._limitZoom(V)],ce=he.range(Le(W),He(ge),Le(le),He(oe)),xe=he.data,We=[];for(const Ke of ce){const Xe=this.stride*Ke;We.push(xe[Xe+Gt]>1?Ae(xe,Xe,this.clusterProps):this.points[xe[Xe+It]])}return We}getChildren(B){const V=this._getOriginId(B),W=this._getOriginZoom(B),oe="No cluster with the specified id.",le=this.trees[W];if(!le)throw new Error(oe);const ge=le.data;if(V*this.stride>=ge.length)throw new Error(oe);const he=this.options.radius/(this.options.extent*Math.pow(2,W-1)),ce=le.within(ge[V*this.stride],ge[V*this.stride+1],he),xe=[];for(const We of ce){const Ke=We*this.stride;ge[Ke+4]===B&&xe.push(ge[Ke+Gt]>1?Ae(ge,Ke,this.clusterProps):this.points[ge[Ke+It]])}if(xe.length===0)throw new Error(oe);return xe}getLeaves(B,V,W){const oe=[];return this._appendLeaves(oe,B,V=V||10,W=W||0,0),oe}getTile(B,V,W){const oe=this.trees[this._limitZoom(B)],le=Math.pow(2,B),{extent:ge,radius:he}=this.options,ce=he/ge,xe=(W-ce)/le,We=(W+1+ce)/le,Ke={features:[]};return this._addTileFeatures(oe.range((V-ce)/le,xe,(V+1+ce)/le,We),oe.data,V,W,le,Ke),V===0&&this._addTileFeatures(oe.range(1-ce/le,xe,1,We),oe.data,le,W,le,Ke),V===le-1&&this._addTileFeatures(oe.range(0,xe,ce/le,We),oe.data,-1,W,le,Ke),Ke.features.length?Ke:null}getClusterExpansionZoom(B){let V=this._getOriginZoom(B)-1;for(;V<=this.options.maxZoom;){const W=this.getChildren(B);if(V++,W.length!==1)break;B=W[0].properties.cluster_id}return V}_appendLeaves(B,V,W,oe,le){const ge=this.getChildren(V);for(const he of ge){const ce=he.properties;if(ce&&ce.cluster?le+ce.point_count<=oe?le+=ce.point_count:le=this._appendLeaves(B,ce.cluster_id,W,oe,le):le<oe?le++:B.push(he),B.length===W)break}return le}_createTree(B){const V=new a.KDBush(B.length/this.stride|0,this.options.nodeSize,Float32Array);for(let W=0;W<B.length;W+=this.stride)V.add(B[W],B[W+1]);return V.finish(),V.data=B,V}_addTileFeatures(B,V,W,oe,le,ge){for(const he of B){const ce=he*this.stride,xe=V[ce+Gt]>1;let We,Ke,Xe;if(xe)We=tt(V,ce,this.clusterProps),Ke=V[ce],Xe=V[ce+1];else{const Pt=this.points[V[ce+It]];We=Pt.properties;const[Ft,Xt]=Pt.geometry.coordinates;Ke=Le(Ft),Xe=He(Xt)}const Ut={type:1,geometry:[[Math.round(this.options.extent*(Ke*le-W)),Math.round(this.options.extent*(Xe*le-oe))]],tags:We};let Yt;Yt=xe||this.options.generateId?V[ce+It]:this.points[V[ce+It]].id,Yt!==void 0&&(Ut.id=Yt),ge.features.push(Ut)}}_limitZoom(B){return Math.max(this.options.minZoom,Math.min(Math.floor(+B),this.options.maxZoom+1))}_cluster(B,V){const{radius:W,extent:oe,reduce:le,minPoints:ge}=this.options,he=W/(oe*Math.pow(2,V)),ce=B.data,xe=[],We=this.stride;for(let Ke=0;Ke<ce.length;Ke+=We){if(ce[Ke+2]<=V)continue;ce[Ke+2]=V;const Xe=ce[Ke],Ut=ce[Ke+1],Yt=B.within(ce[Ke],ce[Ke+1],he),Pt=ce[Ke+Gt];let Ft=Pt;for(const Xt of Yt){const un=Xt*We;ce[un+2]>V&&(Ft+=ce[un+Gt])}if(Ft>Pt&&Ft>=ge){let Xt,un=Xe*Pt,nn=Ut*Pt,gn=-1;const zn=((Ke/We|0)<<5)+(V+1)+this.points.length;for(const ai of Yt){const Ht=ai*We;if(ce[Ht+2]<=V)continue;ce[Ht+2]=V;const Xn=ce[Ht+Gt];un+=ce[Ht]*Xn,nn+=ce[Ht+1]*Xn,ce[Ht+4]=zn,le&&(Xt||(Xt=this._map(ce,Ke,!0),gn=this.clusterProps.length,this.clusterProps.push(Xt)),le(Xt,this._map(ce,Ht)))}ce[Ke+4]=zn,xe.push(un/Ft,nn/Ft,1/0,zn,-1,Ft),le&&xe.push(gn)}else{for(let Xt=0;Xt<We;Xt++)xe.push(ce[Ke+Xt]);if(Ft>1)for(const Xt of Yt){const un=Xt*We;if(!(ce[un+2]<=V)){ce[un+2]=V;for(let nn=0;nn<We;nn++)xe.push(ce[un+nn])}}}}return xe}_getOriginId(B){return B-this.points.length>>5}_getOriginZoom(B){return(B-this.points.length)%32}_map(B,V,W){if(B[V+Gt]>1){const ge=this.clusterProps[B[V+Rt]];return W?Object.assign({},ge):ge}const oe=this.points[B[V+It]].properties,le=this.options.map(oe);return W&&le===oe?Object.assign({},le):le}}function Ae(te,B,V){return{type:"Feature",id:te[B+It],properties:tt(te,B,V),geometry:{type:"Point",coordinates:[(W=te[B],360*(W-.5)),wt(te[B+1])]}};var W}function tt(te,B,V){const W=te[B+Gt],oe=W>=1e4?`${Math.round(W/1e3)}k`:W>=1e3?Math.round(W/100)/10+"k":W,le=te[B+Rt],ge=le===-1?{}:Object.assign({},V[le]);return Object.assign(ge,{cluster:!0,cluster_id:te[B+It],point_count:W,point_count_abbreviated:oe})}function Le(te){return te/360+.5}function He(te){const B=Math.sin(te*Math.PI/180),V=.5-.25*Math.log((1+B)/(1-B))/Math.PI;return V<0?0:V>1?1:V}function wt(te){const B=(180-360*te)*Math.PI/180;return 360*Math.atan(Math.exp(B))/Math.PI-90}function K(te,B,V,W){for(var oe,le=W,ge=V-B>>1,he=V-B,ce=te[B],xe=te[B+1],We=te[V],Ke=te[V+1],Xe=B+3;Xe<V;Xe+=3){var Ut=ne(te[Xe],te[Xe+1],ce,xe,We,Ke);if(Ut>le)oe=Xe,le=Ut;else if(Ut===le){var Yt=Math.abs(Xe-ge);Yt<he&&(oe=Xe,he=Yt)}}le>W&&(oe-B>3&&K(te,B,oe,W),te[oe+2]=le,V-oe>3&&K(te,oe,V,W))}function ne(te,B,V,W,oe,le){var ge=oe-V,he=le-W;if(ge!==0||he!==0){var ce=((te-V)*ge+(B-W)*he)/(ge*ge+he*he);ce>1?(V=oe,W=le):ce>0&&(V+=ge*ce,W+=he*ce)}return(ge=te-V)*ge+(he=B-W)*he}function Z(te,B,V,W){var oe={id:te===void 0?null:te,type:B,geometry:V,tags:W,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(le){var ge=le.geometry,he=le.type;if(he==="Point"||he==="MultiPoint"||he==="LineString")ke(le,ge);else if(he==="Polygon"||he==="MultiLineString")for(var ce=0;ce<ge.length;ce++)ke(le,ge[ce]);else if(he==="MultiPolygon")for(ce=0;ce<ge.length;ce++)for(var xe=0;xe<ge[ce].length;xe++)ke(le,ge[ce][xe])}(oe),oe}function ke(te,B){for(var V=0;V<B.length;V+=3)te.minX=Math.min(te.minX,B[V]),te.minY=Math.min(te.minY,B[V+1]),te.maxX=Math.max(te.maxX,B[V]),te.maxY=Math.max(te.maxY,B[V+1])}function Be(te,B,V,W){if(B.geometry){var oe=B.geometry.coordinates,le=B.geometry.type,ge=Math.pow(V.tolerance/((1<<V.maxZoom)*V.extent),2),he=[],ce=B.id;if(V.promoteId?ce=B.properties[V.promoteId]:V.generateId&&(ce=W||0),le==="Point")Re(oe,he);else if(le==="MultiPoint")for(var xe=0;xe<oe.length;xe++)Re(oe[xe],he);else if(le==="LineString")Ze(oe,he,ge,!1);else if(le==="MultiLineString"){if(V.lineMetrics){for(xe=0;xe<oe.length;xe++)Ze(oe[xe],he=[],ge,!1),te.push(Z(ce,"LineString",he,B.properties));return}ot(oe,he,ge,!1)}else if(le==="Polygon")ot(oe,he,ge,!0);else{if(le!=="MultiPolygon"){if(le==="GeometryCollection"){for(xe=0;xe<B.geometry.geometries.length;xe++)Be(te,{id:ce,geometry:B.geometry.geometries[xe],properties:B.properties},V,W);return}throw new Error("Input data is not a valid GeoJSON object.")}for(xe=0;xe<oe.length;xe++){var We=[];ot(oe[xe],We,ge,!0),he.push(We)}}te.push(Z(ce,le,he,B.properties))}}function Re(te,B){B.push(ht(te[0])),B.push(Je(te[1])),B.push(0)}function Ze(te,B,V,W){for(var oe,le,ge=0,he=0;he<te.length;he++){var ce=ht(te[he][0]),xe=Je(te[he][1]);B.push(ce),B.push(xe),B.push(0),he>0&&(ge+=W?(oe*xe-ce*le)/2:Math.sqrt(Math.pow(ce-oe,2)+Math.pow(xe-le,2))),oe=ce,le=xe}var We=B.length-3;B[2]=1,K(B,0,We,V),B[We+2]=1,B.size=Math.abs(ge),B.start=0,B.end=B.size}function ot(te,B,V,W){for(var oe=0;oe<te.length;oe++){var le=[];Ze(te[oe],le,V,W),B.push(le)}}function ht(te){return te/360+.5}function Je(te){var B=Math.sin(te*Math.PI/180),V=.5-.25*Math.log((1+B)/(1-B))/Math.PI;return V<0?0:V>1?1:V}function lt(te,B,V,W,oe,le,ge,he){if(W/=B,le>=(V/=B)&&ge<W)return te;if(ge<V||le>=W)return null;for(var ce=[],xe=0;xe<te.length;xe++){var We=te[xe],Ke=We.geometry,Xe=We.type,Ut=oe===0?We.minX:We.minY,Yt=oe===0?We.maxX:We.maxY;if(Ut>=V&&Yt<W)ce.push(We);else if(!(Yt<V||Ut>=W)){var Pt=[];if(Xe==="Point"||Xe==="MultiPoint")ft(Ke,Pt,V,W,oe);else if(Xe==="LineString")Mt(Ke,Pt,V,W,oe,!1,he.lineMetrics);else if(Xe==="MultiLineString")$e(Ke,Pt,V,W,oe,!1);else if(Xe==="Polygon")$e(Ke,Pt,V,W,oe,!0);else if(Xe==="MultiPolygon")for(var Ft=0;Ft<Ke.length;Ft++){var Xt=[];$e(Ke[Ft],Xt,V,W,oe,!0),Xt.length&&Pt.push(Xt)}if(Pt.length){if(he.lineMetrics&&Xe==="LineString"){for(Ft=0;Ft<Pt.length;Ft++)ce.push(Z(We.id,Xe,Pt[Ft],We.tags));continue}Xe!=="LineString"&&Xe!=="MultiLineString"||(Pt.length===1?(Xe="LineString",Pt=Pt[0]):Xe="MultiLineString"),Xe!=="Point"&&Xe!=="MultiPoint"||(Xe=Pt.length===3?"Point":"MultiPoint"),ce.push(Z(We.id,Xe,Pt,We.tags))}}}return ce.length?ce:null}function ft(te,B,V,W,oe){for(var le=0;le<te.length;le+=3){var ge=te[le+oe];ge>=V&&ge<=W&&(B.push(te[le]),B.push(te[le+1]),B.push(te[le+2]))}}function Mt(te,B,V,W,oe,le,ge){for(var he,ce,xe=xt(te),We=oe===0?Wt:hn,Ke=te.start,Xe=0;Xe<te.length-3;Xe+=3){var Ut=te[Xe],Yt=te[Xe+1],Pt=te[Xe+2],Ft=te[Xe+3],Xt=te[Xe+4],un=oe===0?Ut:Yt,nn=oe===0?Ft:Xt,gn=!1;ge&&(he=Math.sqrt(Math.pow(Ut-Ft,2)+Math.pow(Yt-Xt,2))),un<V?nn>V&&(ce=We(xe,Ut,Yt,Ft,Xt,V),ge&&(xe.start=Ke+he*ce)):un>W?nn<W&&(ce=We(xe,Ut,Yt,Ft,Xt,W),ge&&(xe.start=Ke+he*ce)):en(xe,Ut,Yt,Pt),nn<V&&un>=V&&(ce=We(xe,Ut,Yt,Ft,Xt,V),gn=!0),nn>W&&un<=W&&(ce=We(xe,Ut,Yt,Ft,Xt,W),gn=!0),!le&&gn&&(ge&&(xe.end=Ke+he*ce),B.push(xe),xe=xt(te)),ge&&(Ke+=he)}var zn=te.length-3;Ut=te[zn],Yt=te[zn+1],Pt=te[zn+2],(un=oe===0?Ut:Yt)>=V&&un<=W&&en(xe,Ut,Yt,Pt),zn=xe.length-3,le&&zn>=3&&(xe[zn]!==xe[0]||xe[zn+1]!==xe[1])&&en(xe,xe[0],xe[1],xe[2]),xe.length&&B.push(xe)}function xt(te){var B=[];return B.size=te.size,B.start=te.start,B.end=te.end,B}function $e(te,B,V,W,oe,le){for(var ge=0;ge<te.length;ge++)Mt(te[ge],B,V,W,oe,le,!1)}function en(te,B,V,W){te.push(B),te.push(V),te.push(W)}function Wt(te,B,V,W,oe,le){var ge=(le-B)/(W-B);return te.push(le),te.push(V+(oe-V)*ge),te.push(1),ge}function hn(te,B,V,W,oe,le){var ge=(le-V)/(oe-V);return te.push(B+(W-B)*ge),te.push(le),te.push(1),ge}function Mn(te,B){for(var V=[],W=0;W<te.length;W++){var oe,le=te[W],ge=le.type;if(ge==="Point"||ge==="MultiPoint"||ge==="LineString")oe=nt(le.geometry,B);else if(ge==="MultiLineString"||ge==="Polygon"){oe=[];for(var he=0;he<le.geometry.length;he++)oe.push(nt(le.geometry[he],B))}else if(ge==="MultiPolygon")for(oe=[],he=0;he<le.geometry.length;he++){for(var ce=[],xe=0;xe<le.geometry[he].length;xe++)ce.push(nt(le.geometry[he][xe],B));oe.push(ce)}V.push(Z(le.id,ge,oe,le.tags))}return V}function nt(te,B){var V=[];V.size=te.size,te.start!==void 0&&(V.start=te.start,V.end=te.end);for(var W=0;W<te.length;W+=3)V.push(te[W]+B,te[W+1],te[W+2]);return V}function $t(te,B){if(te.transformed)return te;var V,W,oe,le=1<<te.z,ge=te.x,he=te.y;for(V=0;V<te.features.length;V++){var ce=te.features[V],xe=ce.geometry,We=ce.type;if(ce.geometry=[],We===1)for(W=0;W<xe.length;W+=2)ce.geometry.push(Nt(xe[W],xe[W+1],B,le,ge,he));else for(W=0;W<xe.length;W++){var Ke=[];for(oe=0;oe<xe[W].length;oe+=2)Ke.push(Nt(xe[W][oe],xe[W][oe+1],B,le,ge,he));ce.geometry.push(Ke)}}return te.transformed=!0,te}function Nt(te,B,V,W,oe,le){return[Math.round(V*(te*W-oe)),Math.round(V*(B*W-le))]}function kn(te,B,V,W,oe){for(var le=B===oe.maxZoom?0:oe.tolerance/((1<<B)*oe.extent),ge={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:V,y:W,z:B,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},he=0;he<te.length;he++){ge.numFeatures++,dn(ge,te[he],le,oe);var ce=te[he].minX,xe=te[he].minY,We=te[he].maxX,Ke=te[he].maxY;ce<ge.minX&&(ge.minX=ce),xe<ge.minY&&(ge.minY=xe),We>ge.maxX&&(ge.maxX=We),Ke>ge.maxY&&(ge.maxY=Ke)}return ge}function dn(te,B,V,W){var oe=B.geometry,le=B.type,ge=[];if(le==="Point"||le==="MultiPoint")for(var he=0;he<oe.length;he+=3)ge.push(oe[he]),ge.push(oe[he+1]),te.numPoints++,te.numSimplified++;else if(le==="LineString")Lt(ge,oe,te,V,!1,!1);else if(le==="MultiLineString"||le==="Polygon")for(he=0;he<oe.length;he++)Lt(ge,oe[he],te,V,le==="Polygon",he===0);else if(le==="MultiPolygon")for(var ce=0;ce<oe.length;ce++){var xe=oe[ce];for(he=0;he<xe.length;he++)Lt(ge,xe[he],te,V,!0,he===0)}if(ge.length){var We=B.tags||null;if(le==="LineString"&&W.lineMetrics){for(var Ke in We={},B.tags)We[Ke]=B.tags[Ke];We.mapbox_clip_start=oe.start/oe.size,We.mapbox_clip_end=oe.end/oe.size}var Xe={geometry:ge,type:le==="Polygon"||le==="MultiPolygon"?3:le==="LineString"||le==="MultiLineString"?2:1,tags:We};B.id!==null&&(Xe.id=B.id),te.features.push(Xe)}}function Lt(te,B,V,W,oe,le){var ge=W*W;if(W>0&&B.size<(oe?ge:W))V.numPoints+=B.length/3;else{for(var he=[],ce=0;ce<B.length;ce+=3)(W===0||B[ce+2]>ge)&&(V.numSimplified++,he.push(B[ce]),he.push(B[ce+1])),V.numPoints++;oe&&function(xe,We){for(var Ke=0,Xe=0,Ut=xe.length,Yt=Ut-2;Xe<Ut;Yt=Xe,Xe+=2)Ke+=(xe[Xe]-xe[Yt])*(xe[Xe+1]+xe[Yt+1]);if(Ke>0===We)for(Xe=0,Ut=xe.length;Xe<Ut/2;Xe+=2){var Pt=xe[Xe],Ft=xe[Xe+1];xe[Xe]=xe[Ut-2-Xe],xe[Xe+1]=xe[Ut-1-Xe],xe[Ut-2-Xe]=Pt,xe[Ut-1-Xe]=Ft}}(he,le),te.push(he)}}function yr(te,B){var V=(B=this.options=function(oe,le){for(var ge in le)oe[ge]=le[ge];return oe}(Object.create(this.options),B)).debug;if(V&&console.time("preprocess data"),B.maxZoom<0||B.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(B.promoteId&&B.generateId)throw new Error("promoteId and generateId cannot be used together.");var W=function(oe,le){var ge=[];if(oe.type==="FeatureCollection")for(var he=0;he<oe.features.length;he++)Be(ge,oe.features[he],le,he);else Be(ge,oe.type==="Feature"?oe:{geometry:oe},le);return ge}(te,B);this.tiles={},this.tileCoords=[],V&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",B.indexMaxZoom,B.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),W=function(oe,le){var ge=le.buffer/le.extent,he=oe,ce=lt(oe,1,-1-ge,ge,0,-1,2,le),xe=lt(oe,1,1-ge,2+ge,0,-1,2,le);return(ce||xe)&&(he=lt(oe,1,-ge,1+ge,0,-1,2,le)||[],ce&&(he=Mn(ce,1).concat(he)),xe&&(he=he.concat(Mn(xe,-1)))),he}(W,B),W.length&&this.splitTile(W,0,0,0),V&&(W.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function rs(te,B,V){return 32*((1<<te)*V+B)+te}function kr(te,B){return B?te.properties[B]:te.id}function ss(te,B){if(te==null)return!0;if(te.type==="Feature")return kr(te,B)!=null;if(te.type==="FeatureCollection"){const V=new Set;for(const W of te.features){const oe=kr(W,B);if(oe==null||V.has(oe))return!1;V.add(oe)}return!0}return!1}function Ti(te,B){const V=new Map;if(te!=null)if(te.type==="Feature")V.set(kr(te,B),te);else for(const W of te.features)V.set(kr(W,B),W);return V}function Rn(te,B){const V=te.tileID.canonical;if(!this._geoJSONIndex)return B(null,null);const W=this._geoJSONIndex.getTile(V.z,V.x,V.y);if(!W)return B(null,null);const oe=new class{constructor(ge){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=a.EXTENT,this.length=ge.length,this._features=ge}feature(ge){return new class{constructor(he){this._feature=he,this.extent=a.EXTENT,this.type=he.type,this.properties=he.tags,"id"in he&&!isNaN(he.id)&&(this.id=parseInt(he.id,10))}loadGeometry(){if(this._feature.type===1){const he=[];for(const ce of this._feature.geometry)he.push([new a.Point(ce[0],ce[1])]);return he}{const he=[];for(const ce of this._feature.geometry){const xe=[];for(const We of ce)xe.push(new a.Point(We[0],We[1]));he.push(xe)}return he}}toGeoJSON(he,ce,xe){return Ee.call(this,he,ce,xe)}}(this._features[ge])}}(W.features);let le=Ge(oe);le.byteOffset===0&&le.byteLength===le.buffer.byteLength||(le=new Uint8Array(le)),B(null,{vectorTile:oe,rawData:le.buffer})}yr.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},yr.prototype.splitTile=function(te,B,V,W,oe,le,ge){for(var he=[te,B,V,W],ce=this.options,xe=ce.debug;he.length;){W=he.pop(),V=he.pop(),B=he.pop(),te=he.pop();var We=1<<B,Ke=rs(B,V,W),Xe=this.tiles[Ke];if(!Xe&&(xe>1&&console.time("creation"),Xe=this.tiles[Ke]=kn(te,B,V,W,ce),this.tileCoords.push({z:B,x:V,y:W}),xe)){xe>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",B,V,W,Xe.numFeatures,Xe.numPoints,Xe.numSimplified),console.timeEnd("creation"));var Ut="z"+B;this.stats[Ut]=(this.stats[Ut]||0)+1,this.total++}if(Xe.source=te,oe){if(B===ce.maxZoom||B===oe)continue;var Yt=1<<oe-B;if(V!==Math.floor(le/Yt)||W!==Math.floor(ge/Yt))continue}else if(B===ce.indexMaxZoom||Xe.numPoints<=ce.indexMaxPoints)continue;if(Xe.source=null,te.length!==0){xe>1&&console.time("clipping");var Pt,Ft,Xt,un,nn,gn,zn=.5*ce.buffer/ce.extent,ai=.5-zn,Ht=.5+zn,Xn=1+zn;Pt=Ft=Xt=un=null,nn=lt(te,We,V-zn,V+Ht,0,Xe.minX,Xe.maxX,ce),gn=lt(te,We,V+ai,V+Xn,0,Xe.minX,Xe.maxX,ce),te=null,nn&&(Pt=lt(nn,We,W-zn,W+Ht,1,Xe.minY,Xe.maxY,ce),Ft=lt(nn,We,W+ai,W+Xn,1,Xe.minY,Xe.maxY,ce),nn=null),gn&&(Xt=lt(gn,We,W-zn,W+Ht,1,Xe.minY,Xe.maxY,ce),un=lt(gn,We,W+ai,W+Xn,1,Xe.minY,Xe.maxY,ce),gn=null),xe>1&&console.timeEnd("clipping"),he.push(Pt||[],B+1,2*V,2*W),he.push(Ft||[],B+1,2*V,2*W+1),he.push(Xt||[],B+1,2*V+1,2*W),he.push(un||[],B+1,2*V+1,2*W+1)}}},yr.prototype.getTile=function(te,B,V){var W=this.options,oe=W.extent,le=W.debug;if(te<0||te>24)return null;var ge=1<<te,he=rs(te,B=(B%ge+ge)%ge,V);if(this.tiles[he])return $t(this.tiles[he],oe);le>1&&console.log("drilling down to z%d-%d-%d",te,B,V);for(var ce,xe=te,We=B,Ke=V;!ce&&xe>0;)xe--,We=Math.floor(We/2),Ke=Math.floor(Ke/2),ce=this.tiles[rs(xe,We,Ke)];return ce&&ce.source?(le>1&&console.log("found parent tile z%d-%d-%d",xe,We,Ke),le>1&&console.time("drilling down"),this.splitTile(ce.source,xe,We,Ke,te,B,V),le>1&&console.timeEnd("drilling down"),this.tiles[he]?$t(this.tiles[he],oe):null):null};class Uo extends q{constructor(B,V,W,oe){super(B,V,W,Rn),this._dataUpdateable=new Map,this.loadGeoJSON=(le,ge)=>{const{promoteId:he}=le;if(le.request)return a.getJSON(le.request,(ce,xe,We,Ke)=>{this._dataUpdateable=ss(xe,he)?Ti(xe,he):void 0,ge(ce,xe,We,Ke)});if(typeof le.data=="string")try{const ce=JSON.parse(le.data);this._dataUpdateable=ss(ce,he)?Ti(ce,he):void 0,ge(null,ce)}catch{ge(new Error(`Input data given to '${le.source}' is not a valid GeoJSON object.`))}else le.dataDiff?this._dataUpdateable?(function(ce,xe,We){var Ke,Xe,Ut,Yt;if(xe.removeAll&&ce.clear(),xe.remove)for(const Pt of xe.remove)ce.delete(Pt);if(xe.add)for(const Pt of xe.add){const Ft=kr(Pt,We);Ft!=null&&ce.set(Ft,Pt)}if(xe.update)for(const Pt of xe.update){let Ft=ce.get(Pt.id);if(Ft==null)continue;const Xt=!Pt.removeAllProperties&&(((Ke=Pt.removeProperties)===null||Ke===void 0?void 0:Ke.length)>0||((Xe=Pt.addOrUpdateProperties)===null||Xe===void 0?void 0:Xe.length)>0);if((Pt.newGeometry||Pt.removeAllProperties||Xt)&&(Ft={...Ft},ce.set(Pt.id,Ft),Xt&&(Ft.properties={...Ft.properties})),Pt.newGeometry&&(Ft.geometry=Pt.newGeometry),Pt.removeAllProperties)Ft.properties={};else if(((Ut=Pt.removeProperties)===null||Ut===void 0?void 0:Ut.length)>0)for(const un of Pt.removeProperties)Object.prototype.hasOwnProperty.call(Ft.properties,un)&&delete Ft.properties[un];if(((Yt=Pt.addOrUpdateProperties)===null||Yt===void 0?void 0:Yt.length)>0)for(const{key:un,value:nn}of Pt.addOrUpdateProperties)Ft.properties[un]=nn}}(this._dataUpdateable,le.dataDiff,he),ge(null,{type:"FeatureCollection",features:Array.from(this._dataUpdateable.values())})):ge(new Error(`Cannot update existing geojson data in ${le.source}`)):ge(new Error(`Input data given to '${le.source}' is not a valid GeoJSON object.`));return{cancel:()=>{}}},oe&&(this.loadGeoJSON=oe)}loadData(B,V){var W;(W=this._pendingRequest)===null||W===void 0||W.cancel(),this._pendingCallback&&this._pendingCallback(null,{abandoned:!0});const oe=!!(B&&B.request&&B.request.collectResourceTiming)&&new a.RequestPerformance(B.request);this._pendingCallback=V,this._pendingRequest=this.loadGeoJSON(B,(le,ge)=>{if(delete this._pendingCallback,delete this._pendingRequest,le||!ge)return V(le);if(typeof ge!="object")return V(new Error(`Input data given to '${B.source}' is not a valid GeoJSON object.`));{ye(ge,!0);try{if(B.filter){const ce=a.createExpression(B.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(ce.result==="error")throw new Error(ce.value.map(We=>`${We.key}: ${We.message}`).join(", "));ge={type:"FeatureCollection",features:ge.features.filter(We=>ce.value.evaluate({zoom:0},We))}}this._geoJSONIndex=B.cluster?new Ne(function({superclusterOptions:ce,clusterProperties:xe}){if(!xe||!ce)return ce;const We={},Ke={},Xe={accumulated:null,zoom:0},Ut={properties:null},Yt=Object.keys(xe);for(const Pt of Yt){const[Ft,Xt]=xe[Pt],un=a.createExpression(Xt),nn=a.createExpression(typeof Ft=="string"?[Ft,["accumulated"],["get",Pt]]:Ft);We[Pt]=un.value,Ke[Pt]=nn.value}return ce.map=Pt=>{Ut.properties=Pt;const Ft={};for(const Xt of Yt)Ft[Xt]=We[Xt].evaluate(Xe,Ut);return Ft},ce.reduce=(Pt,Ft)=>{Ut.properties=Ft;for(const Xt of Yt)Xe.accumulated=Pt[Xt],Pt[Xt]=Ke[Xt].evaluate(Xe,Ut)},ce}(B)).load(ge.features):function(ce,xe){return new yr(ce,xe)}(ge,B.geojsonVtOptions)}catch(ce){return V(ce)}this.loaded={};const he={};if(oe){const ce=oe.finish();ce&&(he.resourceTiming={},he.resourceTiming[B.source]=JSON.parse(JSON.stringify(ce)))}V(null,he)}})}reloadTile(B,V){const W=this.loaded;return W&&W[B.uid]?super.reloadTile(B,V):this.loadTile(B,V)}removeSource(B,V){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),V()}getClusterExpansionZoom(B,V){try{V(null,this._geoJSONIndex.getClusterExpansionZoom(B.clusterId))}catch(W){V(W)}}getClusterChildren(B,V){try{V(null,this._geoJSONIndex.getChildren(B.clusterId))}catch(W){V(W)}}getClusterLeaves(B,V){try{V(null,this._geoJSONIndex.getLeaves(B.clusterId,B.limit,B.offset))}catch(W){V(W)}}}class jr{constructor(B){this.self=B,this.actor=new a.Actor(B,this),this.layerIndexes={},this.availableImages={},this.workerSourceTypes={vector:q,geojson:Uo},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(V,W)=>{if(this.workerSourceTypes[V])throw new Error(`Worker source with name "${V}" already registered.`);this.workerSourceTypes[V]=W},this.self.registerRTLTextPlugin=V=>{if(a.plugin.isParsed())throw new Error("RTL text plugin already registered.");a.plugin.applyArabicShaping=V.applyArabicShaping,a.plugin.processBidirectionalText=V.processBidirectionalText,a.plugin.processStyledBidirectionalText=V.processStyledBidirectionalText}}setReferrer(B,V){this.referrer=V}setImages(B,V,W){this.availableImages[B]=V;for(const oe in this.workerSources[B]){const le=this.workerSources[B][oe];for(const ge in le)le[ge].availableImages=V}W()}setLayers(B,V,W){this.getLayerIndex(B).replace(V),W()}updateLayers(B,V,W){this.getLayerIndex(B).update(V.layers,V.removedIds),W()}loadTile(B,V,W){this.getWorkerSource(B,V.type,V.source).loadTile(V,W)}loadDEMTile(B,V,W){this.getDEMWorkerSource(B,V.source).loadTile(V,W)}reloadTile(B,V,W){this.getWorkerSource(B,V.type,V.source).reloadTile(V,W)}abortTile(B,V,W){this.getWorkerSource(B,V.type,V.source).abortTile(V,W)}removeTile(B,V,W){this.getWorkerSource(B,V.type,V.source).removeTile(V,W)}removeDEMTile(B,V){this.getDEMWorkerSource(B,V.source).removeTile(V)}removeSource(B,V,W){if(!this.workerSources[B]||!this.workerSources[B][V.type]||!this.workerSources[B][V.type][V.source])return;const oe=this.workerSources[B][V.type][V.source];delete this.workerSources[B][V.type][V.source],oe.removeSource!==void 0?oe.removeSource(V,W):W()}loadWorkerSource(B,V,W){try{this.self.importScripts(V.url),W()}catch(oe){W(oe.toString())}}syncRTLPluginState(B,V,W){try{a.plugin.setState(V);const oe=a.plugin.getPluginURL();if(a.plugin.isLoaded()&&!a.plugin.isParsed()&&oe!=null){this.self.importScripts(oe);const le=a.plugin.isParsed();W(le?void 0:new Error(`RTL Text Plugin failed to import scripts from ${oe}`),le)}}catch(oe){W(oe.toString())}}getAvailableImages(B){let V=this.availableImages[B];return V||(V=[]),V}getLayerIndex(B){let V=this.layerIndexes[B];return V||(V=this.layerIndexes[B]=new I),V}getWorkerSource(B,V,W){if(this.workerSources[B]||(this.workerSources[B]={}),this.workerSources[B][V]||(this.workerSources[B][V]={}),!this.workerSources[B][V][W]){const oe={send:(le,ge,he)=>{this.actor.send(le,ge,he,B)}};this.workerSources[B][V][W]=new this.workerSourceTypes[V](oe,this.getLayerIndex(B),this.getAvailableImages(B))}return this.workerSources[B][V][W]}getDEMWorkerSource(B,V){return this.demWorkerSources[B]||(this.demWorkerSources[B]={}),this.demWorkerSources[B][V]||(this.demWorkerSources[B][V]=new X),this.demWorkerSources[B][V]}}return a.isWorker()&&(self.worker=new jr(self)),jr}),_(["./shared"],function(a){var I="3.1.0";class T{static testProp(n){if(!T.docStyle)return n[0];for(let o=0;o<n.length;o++)if(n[o]in T.docStyle)return n[o];return n[0]}static create(n,o,u){const p=window.document.createElement(n);return o!==void 0&&(p.className=o),u&&u.appendChild(p),p}static createNS(n,o){return window.document.createElementNS(n,o)}static disableDrag(){T.docStyle&&T.selectProp&&(T.userSelect=T.docStyle[T.selectProp],T.docStyle[T.selectProp]="none")}static enableDrag(){T.docStyle&&T.selectProp&&(T.docStyle[T.selectProp]=T.userSelect)}static setTransform(n,o){n.style[T.transformProp]=o}static addEventListener(n,o,u,p={}){n.addEventListener(o,u,"passive"in p?p:p.capture)}static removeEventListener(n,o,u,p={}){n.removeEventListener(o,u,"passive"in p?p:p.capture)}static suppressClickInternal(n){n.preventDefault(),n.stopPropagation(),window.removeEventListener("click",T.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",T.suppressClickInternal,!0),window.setTimeout(()=>{window.removeEventListener("click",T.suppressClickInternal,!0)},0)}static mousePos(n,o){const u=n.getBoundingClientRect();return new a.Point(o.clientX-u.left-n.clientLeft,o.clientY-u.top-n.clientTop)}static touchPos(n,o){const u=n.getBoundingClientRect(),p=[];for(let v=0;v<o.length;v++)p.push(new a.Point(o[v].clientX-u.left-n.clientLeft,o[v].clientY-u.top-n.clientTop));return p}static mouseButton(n){return n.button}static remove(n){n.parentNode&&n.parentNode.removeChild(n)}}T.docStyle=typeof window<"u"&&window.document&&window.document.documentElement.style,T.selectProp=T.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),T.transformProp=T.testProp(["transform","WebkitTransform"]);const M={supported:!1,testSupport:function(d){!q&&F&&(X?re(d):k=d)}};let k,F,q=!1,X=!1;function re(d){const n=d.createTexture();d.bindTexture(d.TEXTURE_2D,n);try{if(d.texImage2D(d.TEXTURE_2D,0,d.RGBA,d.RGBA,d.UNSIGNED_BYTE,F),d.isContextLost())return;M.supported=!0}catch{}d.deleteTexture(n),q=!0}var me;typeof document<"u"&&(F=document.createElement("img"),F.onload=function(){k&&re(k),k=null,X=!0},F.onerror=function(){q=!0,k=null},F.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA="),function(d){let n,o,u,p;d.resetRequestQueue=()=>{n=[],o=0,u=0,p={}},d.addThrottleControl=A=>{const L=u++;return p[L]=A,L},d.removeThrottleControl=A=>{delete p[A],E()},d.getImage=(A,L,z=!0)=>{M.supported&&(A.headers||(A.headers={}),A.headers.accept="image/webp,*/*");const U={requestParameters:A,supportImageRefresh:z,callback:L,cancelled:!1,completed:!1,cancel:()=>{U.completed||U.cancelled||(U.cancelled=!0,U.innerRequest&&(U.innerRequest.cancel(),o--),E())}};return n.push(U),E(),U};const v=A=>{const{requestParameters:L,supportImageRefresh:z,callback:U}=A;return a.extend(L,{type:"image"}),(z!==!1||a.isWorker()||a.getProtocolAction(L.url)||L.headers&&!Object.keys(L.headers).reduce((Q,H)=>Q&&H==="accept",!0)?a.makeRequest:C)(L,(Q,H,Y,se)=>{w(A,U,Q,H,Y,se)})},w=(A,L,z,U,Q,H)=>{z?L(z):U instanceof HTMLImageElement||U instanceof ImageBitmap?L(null,U):U&&((Y,se)=>{typeof createImageBitmap=="function"?a.arrayBufferToImageBitmap(Y,se):a.arrayBufferToImage(Y,se)})(U,(Y,se)=>{Y!=null?L(Y):se!=null&&L(null,se,{cacheControl:Q,expires:H})}),A.cancelled||(A.completed=!0,o--,E())},E=()=>{const A=(()=>{const L=Object.keys(p);let z=!1;if(L.length>0){for(const U of L)if(z=p[U](),z)break}return z})()?a.config.MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:a.config.MAX_PARALLEL_IMAGE_REQUESTS;for(let L=o;L<A&&n.length>0;L++){const z=n.shift();if(z.cancelled){L--;continue}const U=v(z);o++,z.innerRequest=U}},C=(A,L)=>{const z=new Image,U=A.url;let Q=!1;const H=A.credentials;return H&&H==="include"?z.crossOrigin="use-credentials":(H&&H==="same-origin"||!a.sameOrigin(U))&&(z.crossOrigin="anonymous"),z.fetchPriority="high",z.onload=()=>{L(null,z),z.onerror=z.onload=null},z.onerror=()=>{Q||L(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.")),z.onerror=z.onload=null},z.src=U,{cancel:()=>{Q=!0,z.src=""}}}}(me||(me={})),me.resetRequestQueue();var ye,Ee=me;(function(d){d.Glyphs="Glyphs",d.Image="Image",d.Source="Source",d.SpriteImage="SpriteImage",d.SpriteJSON="SpriteJSON",d.Style="Style",d.Tile="Tile",d.Unknown="Unknown"})(ye||(ye={}));class be{constructor(n){this._transformRequestFn=n}transformRequest(n,o){return this._transformRequestFn&&this._transformRequestFn(n,o)||{url:n}}normalizeSpriteURL(n,o,u){const p=function(v){const w=v.match(Oe);if(!w)throw new Error(`Unable to parse URL "${v}"`);return{protocol:w[1],authority:w[2],path:w[3]||"/",params:w[4]?w[4].split("&"):[]}}(n);return p.path+=`${o}${u}`,function(v){const w=v.params.length?`?${v.params.join("&")}`:"";return`${v.protocol}://${v.authority}${v.path}${w}`}(p)}setTransformRequest(n){this._transformRequestFn=n}}const Oe=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function Qe(d){var n=new a.ARRAY_TYPE(3);return n[0]=d[0],n[1]=d[1],n[2]=d[2],n}var Ue,ze=function(d,n,o){return d[0]=n[0]-o[0],d[1]=n[1]-o[1],d[2]=n[2]-o[2],d};Ue=new a.ARRAY_TYPE(3),a.ARRAY_TYPE!=Float32Array&&(Ue[0]=0,Ue[1]=0,Ue[2]=0);var j=function(d){var n=d[0],o=d[1];return n*n+o*o};function G(d){const n=[];if(typeof d=="string")n.push({id:"default",url:d});else if(d&&d.length>0){const o=[];for(const{id:u,url:p}of d){const v=`${u}${p}`;o.indexOf(v)===-1&&(o.push(v),n.push({id:u,url:p}))}}return n}function pe(d,n,o,u,p){if(u)return void d(u);if(p!==Object.values(n).length||p!==Object.values(o).length)return;const v={};for(const w in n){v[w]={};const E=a.exported.getImageCanvasContext(o[w]),C=n[w];for(const A in C){const{width:L,height:z,x:U,y:Q,sdf:H,pixelRatio:Y,stretchX:se,stretchY:de,content:Pe}=C[A];v[w][A]={data:null,pixelRatio:Y,sdf:H,stretchX:se,stretchY:de,content:Pe,spriteData:{width:L,height:z,x:U,y:Q,context:E}}}}d(null,v)}(function(){var d=new a.ARRAY_TYPE(2);a.ARRAY_TYPE!=Float32Array&&(d[0]=0,d[1]=0)})();class Se{constructor(n,o,u,p){this.context=n,this.format=u,this.texture=n.gl.createTexture(),this.update(o,p)}update(n,o,u){const{width:p,height:v}=n,w=!(this.size&&this.size[0]===p&&this.size[1]===v||u),{context:E}=this,{gl:C}=E;if(this.useMipmap=!!(o&&o.useMipmap),C.bindTexture(C.TEXTURE_2D,this.texture),E.pixelStoreUnpackFlipY.set(!1),E.pixelStoreUnpack.set(1),E.pixelStoreUnpackPremultiplyAlpha.set(this.format===C.RGBA&&(!o||o.premultiply!==!1)),w)this.size=[p,v],n instanceof HTMLImageElement||n instanceof HTMLCanvasElement||n instanceof HTMLVideoElement||n instanceof ImageData||a.isImageBitmap(n)?C.texImage2D(C.TEXTURE_2D,0,this.format,this.format,C.UNSIGNED_BYTE,n):C.texImage2D(C.TEXTURE_2D,0,this.format,p,v,0,this.format,C.UNSIGNED_BYTE,n.data);else{const{x:A,y:L}=u||{x:0,y:0};n instanceof HTMLImageElement||n instanceof HTMLCanvasElement||n instanceof HTMLVideoElement||n instanceof ImageData||a.isImageBitmap(n)?C.texSubImage2D(C.TEXTURE_2D,0,A,L,C.RGBA,C.UNSIGNED_BYTE,n):C.texSubImage2D(C.TEXTURE_2D,0,A,L,p,v,C.RGBA,C.UNSIGNED_BYTE,n.data)}this.useMipmap&&this.isSizePowerOfTwo()&&C.generateMipmap(C.TEXTURE_2D)}bind(n,o,u){const{context:p}=this,{gl:v}=p;v.bindTexture(v.TEXTURE_2D,this.texture),u!==v.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(u=v.LINEAR),n!==this.filter&&(v.texParameteri(v.TEXTURE_2D,v.TEXTURE_MAG_FILTER,n),v.texParameteri(v.TEXTURE_2D,v.TEXTURE_MIN_FILTER,u||n),this.filter=n),o!==this.wrap&&(v.texParameteri(v.TEXTURE_2D,v.TEXTURE_WRAP_S,o),v.texParameteri(v.TEXTURE_2D,v.TEXTURE_WRAP_T,o),this.wrap=o)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:n}=this.context;n.deleteTexture(this.texture),this.texture=null}}function Ce(d){const{userImage:n}=d;return!!(n&&n.render&&n.render())&&(d.data.replace(new Uint8Array(n.data.buffer)),!0)}class _e extends a.Evented{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new a.RGBAImage({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(n){if(this.loaded!==n&&(this.loaded=n,n)){for(const{ids:o,callback:u}of this.requestors)this._notify(o,u);this.requestors=[]}}getImage(n){const o=this.images[n];if(o&&!o.data&&o.spriteData){const u=o.spriteData;o.data=new a.RGBAImage({width:u.width,height:u.height},u.context.getImageData(u.x,u.y,u.width,u.height).data),o.spriteData=null}return o}addImage(n,o){if(this.images[n])throw new Error(`Image id ${n} already exist, use updateImage instead`);this._validate(n,o)&&(this.images[n]=o)}_validate(n,o){let u=!0;const p=o.data||o.spriteData;return this._validateStretch(o.stretchX,p&&p.width)||(this.fire(new a.ErrorEvent(new Error(`Image "${n}" has invalid "stretchX" value`))),u=!1),this._validateStretch(o.stretchY,p&&p.height)||(this.fire(new a.ErrorEvent(new Error(`Image "${n}" has invalid "stretchY" value`))),u=!1),this._validateContent(o.content,o)||(this.fire(new a.ErrorEvent(new Error(`Image "${n}" has invalid "content" value`))),u=!1),u}_validateStretch(n,o){if(!n)return!0;let u=0;for(const p of n){if(p[0]<u||p[1]<p[0]||o<p[1])return!1;u=p[1]}return!0}_validateContent(n,o){if(!n)return!0;if(n.length!==4)return!1;const u=o.spriteData,p=u&&u.width||o.data.width,v=u&&u.height||o.data.height;return!(n[0]<0||p<n[0]||n[1]<0||v<n[1]||n[2]<0||p<n[2]||n[3]<0||v<n[3]||n[2]<n[0]||n[3]<n[1])}updateImage(n,o,u=!0){const p=this.getImage(n);if(u&&(p.data.width!==o.data.width||p.data.height!==o.data.height))throw new Error(`size mismatch between old image (${p.data.width}x${p.data.height}) and new image (${o.data.width}x${o.data.height}).`);o.version=p.version+1,this.images[n]=o,this.updatedImages[n]=!0}removeImage(n){const o=this.images[n];delete this.images[n],delete this.patterns[n],o.userImage&&o.userImage.onRemove&&o.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(n,o){let u=!0;if(!this.isLoaded())for(const p of n)this.images[p]||(u=!1);this.isLoaded()||u?this._notify(n,o):this.requestors.push({ids:n,callback:o})}_notify(n,o){const u={};for(const p of n){let v=this.getImage(p);v||(this.fire(new a.Event("styleimagemissing",{id:p})),v=this.getImage(p)),v?u[p]={data:v.data.clone(),pixelRatio:v.pixelRatio,sdf:v.sdf,version:v.version,stretchX:v.stretchX,stretchY:v.stretchY,content:v.content,hasRenderCallback:!!(v.userImage&&v.userImage.render)}:a.warnOnce(`Image "${p}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}o(null,u)}getPixelSize(){const{width:n,height:o}=this.atlasImage;return{width:n,height:o}}getPattern(n){const o=this.patterns[n],u=this.getImage(n);if(!u)return null;if(o&&o.position.version===u.version)return o.position;if(o)o.position.version=u.version;else{const p={w:u.data.width+2,h:u.data.height+2,x:0,y:0},v=new a.ImagePosition(p,u);this.patterns[n]={bin:p,position:v}}return this._updatePatternAtlas(),this.patterns[n].position}bind(n){const o=n.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new Se(n,this.atlasImage,o.RGBA),this.atlasTexture.bind(o.LINEAR,o.CLAMP_TO_EDGE)}_updatePatternAtlas(){const n=[];for(const v in this.patterns)n.push(this.patterns[v].bin);const{w:o,h:u}=a.potpack(n),p=this.atlasImage;p.resize({width:o||1,height:u||1});for(const v in this.patterns){const{bin:w}=this.patterns[v],E=w.x+1,C=w.y+1,A=this.getImage(v).data,L=A.width,z=A.height;a.RGBAImage.copy(A,p,{x:0,y:0},{x:E,y:C},{width:L,height:z}),a.RGBAImage.copy(A,p,{x:0,y:z-1},{x:E,y:C-1},{width:L,height:1}),a.RGBAImage.copy(A,p,{x:0,y:0},{x:E,y:C+z},{width:L,height:1}),a.RGBAImage.copy(A,p,{x:L-1,y:0},{x:E-1,y:C},{width:1,height:z}),a.RGBAImage.copy(A,p,{x:0,y:0},{x:E+L,y:C},{width:1,height:z})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(n){for(const o of n){if(this.callbackDispatchedThisFrame[o])continue;this.callbackDispatchedThisFrame[o]=!0;const u=this.getImage(o);u||a.warnOnce(`Image with ID: "${o}" was not found`),Ce(u)&&this.updateImage(o,u)}}}const Fe=1e20;function ut(d,n,o,u,p,v,w,E,C){for(let A=n;A<n+u;A++)at(d,o*v+A,v,p,w,E,C);for(let A=o;A<o+p;A++)at(d,A*v+n,1,u,w,E,C)}function at(d,n,o,u,p,v,w){v[0]=0,w[0]=-Fe,w[1]=Fe,p[0]=d[n];for(let E=1,C=0,A=0;E<u;E++){p[E]=d[n+E*o];const L=E*E;do{const z=v[C];A=(p[E]-p[z]+L-z*z)/(E-z)/2}while(A<=w[C]&&--C>-1);C++,v[C]=E,w[C]=A,w[C+1]=Fe}for(let E=0,C=0;E<u;E++){for(;w[C+1]<E;)C++;const A=v[C],L=E-A;d[n+E*o]=p[A]+L*L}}class je{constructor(n,o){this.requestManager=n,this.localIdeographFontFamily=o,this.entries={}}setURL(n){this.url=n}getGlyphs(n,o){const u=[];for(const p in n)for(const v of n[p])u.push({stack:p,id:v});a.asyncAll(u,({stack:p,id:v},w)=>{let E=this.entries[p];E||(E=this.entries[p]={glyphs:{},requests:{},ranges:{}});let C=E.glyphs[v];if(C!==void 0)return void w(null,{stack:p,id:v,glyph:C});if(C=this._tinySDF(E,p,v),C)return E.glyphs[v]=C,void w(null,{stack:p,id:v,glyph:C});const A=Math.floor(v/256);if(256*A>65535)return void w(new Error("glyphs > 65535 not supported"));if(E.ranges[A])return void w(null,{stack:p,id:v,glyph:C});if(!this.url)return void w(new Error("glyphsUrl is not set"));let L=E.requests[A];L||(L=E.requests[A]=[],je.loadGlyphRange(p,A,this.url,this.requestManager,(z,U)=>{if(U){for(const Q in U)this._doesCharSupportLocalGlyph(+Q)||(E.glyphs[+Q]=U[+Q]);E.ranges[A]=!0}for(const Q of L)Q(z,U);delete E.requests[A]})),L.push((z,U)=>{z?w(z):U&&w(null,{stack:p,id:v,glyph:U[v]||null})})},(p,v)=>{if(p)o(p);else if(v){const w={};for(const{stack:E,id:C,glyph:A}of v)(w[E]||(w[E]={}))[C]=A&&{id:A.id,bitmap:A.bitmap.clone(),metrics:A.metrics};o(null,w)}})}_doesCharSupportLocalGlyph(n){return!!this.localIdeographFontFamily&&(a.unicodeBlockLookup["CJK Unified Ideographs"](n)||a.unicodeBlockLookup["Hangul Syllables"](n)||a.unicodeBlockLookup.Hiragana(n)||a.unicodeBlockLookup.Katakana(n))}_tinySDF(n,o,u){const p=this.localIdeographFontFamily;if(!p||!this._doesCharSupportLocalGlyph(u))return;let v=n.tinySDF;if(!v){let E="400";/bold/i.test(o)?E="900":/medium/i.test(o)?E="500":/light/i.test(o)&&(E="200"),v=n.tinySDF=new je.TinySDF({fontSize:24,buffer:3,radius:8,cutoff:.25,fontFamily:p,fontWeight:E})}const w=v.draw(String.fromCharCode(u));return{id:u,bitmap:new a.AlphaImage({width:w.width||30,height:w.height||30},w.data),metrics:{width:w.glyphWidth||24,height:w.glyphHeight||24,left:w.glyphLeft||0,top:w.glyphTop-27||-8,advance:w.glyphAdvance||24}}}}je.loadGlyphRange=function(d,n,o,u,p){const v=256*n,w=v+255,E=u.transformRequest(o.replace("{fontstack}",d).replace("{range}",`${v}-${w}`),ye.Glyphs);a.getArrayBuffer(E,(C,A)=>{if(C)p(C);else if(A){const L={};for(const z of a.parseGlyphPbf(A))L[z.id]=z;p(null,L)}})},je.TinySDF=class{constructor({fontSize:d=24,buffer:n=3,radius:o=8,cutoff:u=.25,fontFamily:p="sans-serif",fontWeight:v="normal",fontStyle:w="normal"}={}){this.buffer=n,this.cutoff=u,this.radius=o;const E=this.size=d+4*n,C=this._createCanvas(E),A=this.ctx=C.getContext("2d",{willReadFrequently:!0});A.font=`${w} ${v} ${d}px ${p}`,A.textBaseline="alphabetic",A.textAlign="left",A.fillStyle="black",this.gridOuter=new Float64Array(E*E),this.gridInner=new Float64Array(E*E),this.f=new Float64Array(E),this.z=new Float64Array(E+1),this.v=new Uint16Array(E)}_createCanvas(d){const n=document.createElement("canvas");return n.width=n.height=d,n}draw(d){const{width:n,actualBoundingBoxAscent:o,actualBoundingBoxDescent:u,actualBoundingBoxLeft:p,actualBoundingBoxRight:v}=this.ctx.measureText(d),w=Math.ceil(o),E=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(v-p))),C=Math.min(this.size-this.buffer,w+Math.ceil(u)),A=E+2*this.buffer,L=C+2*this.buffer,z=Math.max(A*L,0),U=new Uint8ClampedArray(z),Q={data:U,width:A,height:L,glyphWidth:E,glyphHeight:C,glyphTop:w,glyphLeft:0,glyphAdvance:n};if(E===0||C===0)return Q;const{ctx:H,buffer:Y,gridInner:se,gridOuter:de}=this;H.clearRect(Y,Y,E,C),H.fillText(d,Y,Y+w);const Pe=H.getImageData(Y,Y,E,C);de.fill(Fe,0,z),se.fill(0,0,z);for(let ie=0;ie<C;ie++)for(let Te=0;Te<E;Te++){const De=Pe.data[4*(ie*E+Te)+3]/255;if(De===0)continue;const Ye=(ie+Y)*A+Te+Y;if(De===1)de[Ye]=0,se[Ye]=Fe;else{const it=.5-De;de[Ye]=it>0?it*it:0,se[Ye]=it<0?it*it:0}}ut(de,0,0,A,L,A,this.f,this.v,this.z),ut(se,Y,Y,E,C,A,this.f,this.v,this.z);for(let ie=0;ie<z;ie++){const Te=Math.sqrt(de[ie])-Math.sqrt(se[ie]);U[ie]=Math.round(255-255*(Te/this.radius+this.cutoff))}return Q}};class Ve{constructor(){this.specification=a.v8Spec.light.position}possiblyEvaluate(n,o){return a.sphericalToCartesian(n.expression.evaluate(o))}interpolate(n,o,u){return{x:a.interpolate.number(n.x,o.x,u),y:a.interpolate.number(n.y,o.y,u),z:a.interpolate.number(n.z,o.z,u)}}}let Ge,Tt;class At extends a.Evented{constructor(n){super(),Ge=Ge||new a.Properties({anchor:new a.DataConstantProperty(a.v8Spec.light.anchor),position:new Ve,color:new a.DataConstantProperty(a.v8Spec.light.color),intensity:new a.DataConstantProperty(a.v8Spec.light.intensity)}),this._transitionable=new a.Transitionable(Ge),this.setLight(n),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(n,o={}){if(!this._validate(a.validateLight,n,o))for(const u in n){const p=n[u];u.endsWith("-transition")?this._transitionable.setTransition(u.slice(0,-11),p):this._transitionable.setValue(u,p)}}updateTransitions(n){this._transitioning=this._transitionable.transitioned(n,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(n){this.properties=this._transitioning.possiblyEvaluate(n)}_validate(n,o,u){return(!u||u.validate!==!1)&&a.emitValidationErrors(this,n.call(a.validateStyle,a.extend({value:o,style:{glyphs:!0,sprite:!0},styleSpec:a.v8Spec})))}}class rt{constructor(n,o){this.width=n,this.height=o,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(n,o){const u=n.join(",")+String(o);return this.dashEntry[u]||(this.dashEntry[u]=this.addDash(n,o)),this.dashEntry[u]}getDashRanges(n,o,u){const p=[];let v=n.length%2==1?-n[n.length-1]*u:0,w=n[0]*u,E=!0;p.push({left:v,right:w,isDash:E,zeroLength:n[0]===0});let C=n[0];for(let A=1;A<n.length;A++){E=!E;const L=n[A];v=C*u,C+=L,w=C*u,p.push({left:v,right:w,isDash:E,zeroLength:L===0})}return p}addRoundDash(n,o,u){const p=o/2;for(let v=-u;v<=u;v++){const w=this.width*(this.nextRow+u+v);let E=0,C=n[E];for(let A=0;A<this.width;A++){A/C.right>1&&(C=n[++E]);const L=Math.abs(A-C.left),z=Math.abs(A-C.right),U=Math.min(L,z);let Q;const H=v/u*(p+1);if(C.isDash){const Y=p-Math.abs(H);Q=Math.sqrt(U*U+Y*Y)}else Q=p-Math.sqrt(U*U+H*H);this.data[w+A]=Math.max(0,Math.min(255,Q+128))}}}addRegularDash(n){for(let E=n.length-1;E>=0;--E){const C=n[E],A=n[E+1];C.zeroLength?n.splice(E,1):A&&A.isDash===C.isDash&&(A.left=C.left,n.splice(E,1))}const o=n[0],u=n[n.length-1];o.isDash===u.isDash&&(o.left=u.left-this.width,u.right=o.right+this.width);const p=this.width*this.nextRow;let v=0,w=n[v];for(let E=0;E<this.width;E++){E/w.right>1&&(w=n[++v]);const C=Math.abs(E-w.left),A=Math.abs(E-w.right),L=Math.min(C,A);this.data[p+E]=Math.max(0,Math.min(255,(w.isDash?L:-L)+128))}}addDash(n,o){const u=o?7:0,p=2*u+1;if(this.nextRow+p>this.height)return a.warnOnce("LineAtlas out of space"),null;let v=0;for(let E=0;E<n.length;E++)v+=n[E];if(v!==0){const E=this.width/v,C=this.getDashRanges(n,this.width,E);o?this.addRoundDash(C,E,u):this.addRegularDash(C)}const w={y:(this.nextRow+u+.5)/this.height,height:2*u/this.height,width:v};return this.nextRow+=p,this.dirty=!0,w}bind(n){const o=n.gl;this.texture?(o.bindTexture(o.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,o.texSubImage2D(o.TEXTURE_2D,0,0,0,this.width,this.height,o.ALPHA,o.UNSIGNED_BYTE,this.data))):(this.texture=o.createTexture(),o.bindTexture(o.TEXTURE_2D,this.texture),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_S,o.REPEAT),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_T,o.REPEAT),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MIN_FILTER,o.LINEAR),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MAG_FILTER,o.LINEAR),o.texImage2D(o.TEXTURE_2D,0,o.ALPHA,this.width,this.height,0,o.ALPHA,o.UNSIGNED_BYTE,this.data))}}class It{constructor(n,o,u){this.workerPool=n,this.actors=[],this.currentActor=0,this.id=u;const p=this.workerPool.acquire(u);for(let v=0;v<p.length;v++){const w=new It.Actor(p[v],o,u);w.name=`Worker ${v}`,this.actors.push(w)}if(!this.actors.length)throw new Error("No actors found")}broadcast(n,o,u){a.asyncAll(this.actors,(p,v)=>{p.send(n,o,v)},u=u||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(n=!0){this.actors.forEach(o=>{o.remove()}),this.actors=[],n&&this.workerPool.release(this.id)}}function Gt(d,n,o){const u=function(p,v){if(p)return o(p);if(v){const w=a.pick(a.extend(v,d),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);v.vector_layers&&(w.vectorLayers=v.vector_layers,w.vectorLayerIds=w.vectorLayers.map(E=>E.id)),o(null,w)}};return d.url?a.getJSON(n.transformRequest(d.url,ye.Source),u):a.exported.frame(()=>u(null,d))}It.Actor=a.Actor;class Rt{constructor(n,o){n&&(o?this.setSouthWest(n).setNorthEast(o):Array.isArray(n)&&(n.length===4?this.setSouthWest([n[0],n[1]]).setNorthEast([n[2],n[3]]):this.setSouthWest(n[0]).setNorthEast(n[1])))}setNorthEast(n){return this._ne=n instanceof a.LngLat?new a.LngLat(n.lng,n.lat):a.LngLat.convert(n),this}setSouthWest(n){return this._sw=n instanceof a.LngLat?new a.LngLat(n.lng,n.lat):a.LngLat.convert(n),this}extend(n){const o=this._sw,u=this._ne;let p,v;if(n instanceof a.LngLat)p=n,v=n;else{if(!(n instanceof Rt))return Array.isArray(n)?n.length===4||n.every(Array.isArray)?this.extend(Rt.convert(n)):this.extend(a.LngLat.convert(n)):n&&("lng"in n||"lon"in n)&&"lat"in n?this.extend(a.LngLat.convert(n)):this;if(p=n._sw,v=n._ne,!p||!v)return this}return o||u?(o.lng=Math.min(p.lng,o.lng),o.lat=Math.min(p.lat,o.lat),u.lng=Math.max(v.lng,u.lng),u.lat=Math.max(v.lat,u.lat)):(this._sw=new a.LngLat(p.lng,p.lat),this._ne=new a.LngLat(v.lng,v.lat)),this}getCenter(){return new a.LngLat((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new a.LngLat(this.getWest(),this.getNorth())}getSouthEast(){return new a.LngLat(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(n){const{lng:o,lat:u}=a.LngLat.convert(n);let p=this._sw.lng<=o&&o<=this._ne.lng;return this._sw.lng>this._ne.lng&&(p=this._sw.lng>=o&&o>=this._ne.lng),this._sw.lat<=u&&u<=this._ne.lat&&p}static convert(n){return n instanceof Rt?n:n&&new Rt(n)}static fromLngLat(n,o=0){const u=360*o/40075017,p=u/Math.cos(Math.PI/180*n.lat);return new Rt(new a.LngLat(n.lng-p,n.lat-u),new a.LngLat(n.lng+p,n.lat+u))}}class Ne{constructor(n,o,u){this.bounds=Rt.convert(this.validateBounds(n)),this.minzoom=o||0,this.maxzoom=u||24}validateBounds(n){return Array.isArray(n)&&n.length===4?[Math.max(-180,n[0]),Math.max(-90,n[1]),Math.min(180,n[2]),Math.min(90,n[3])]:[-180,-90,180,90]}contains(n){const o=Math.pow(2,n.z),u=Math.floor(a.mercatorXfromLng(this.bounds.getWest())*o),p=Math.floor(a.mercatorYfromLat(this.bounds.getNorth())*o),v=Math.ceil(a.mercatorXfromLng(this.bounds.getEast())*o),w=Math.ceil(a.mercatorYfromLat(this.bounds.getSouth())*o);return n.x>=u&&n.x<v&&n.y>=p&&n.y<w}}class Ae extends a.Evented{constructor(n,o,u,p){if(super(),this.id=n,this.dispatcher=u,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,a.extend(this,a.pick(o,["url","scheme","tileSize","promoteId"])),this._options=a.extend({type:"vector"},o),this._collectResourceTiming=o.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(p)}load(){this._loaded=!1,this.fire(new a.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=Gt(this._options,this.map._requestManager,(n,o)=>{this._tileJSONRequest=null,this._loaded=!0,this.map.style.sourceCaches[this.id].clearTiles(),n?this.fire(new a.ErrorEvent(n)):o&&(a.extend(this,o),o.bounds&&(this.tileBounds=new Ne(o.bounds,this.minzoom,this.maxzoom)),this.fire(new a.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new a.Event("data",{dataType:"source",sourceDataType:"content"})))})}loaded(){return this._loaded}hasTile(n){return!this.tileBounds||this.tileBounds.contains(n.canonical)}onAdd(n){this.map=n,this.load()}setSourceProperty(n){this._tileJSONRequest&&this._tileJSONRequest.cancel(),n(),this.load()}setTiles(n){return this.setSourceProperty(()=>{this._options.tiles=n}),this}setUrl(n){return this.setSourceProperty(()=>{this.url=n,this._options.url=n}),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}serialize(){return a.extend({},this._options)}loadTile(n,o){const u=n.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),p={request:this.map._requestManager.transformRequest(u,ye.Tile),uid:n.uid,tileID:n.tileID,zoom:n.tileID.overscaledZ,tileSize:this.tileSize*n.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};function v(w,E){return delete n.request,n.aborted?o(null):w&&w.status!==404?o(w):(E&&E.resourceTiming&&(n.resourceTiming=E.resourceTiming),this.map._refreshExpiredTiles&&E&&n.setExpiryData(E),n.loadVectorData(E,this.map.painter),o(null),void(n.reloadCallback&&(this.loadTile(n,n.reloadCallback),n.reloadCallback=null)))}p.request.collectResourceTiming=this._collectResourceTiming,n.actor&&n.state!=="expired"?n.state==="loading"?n.reloadCallback=o:n.request=n.actor.send("reloadTile",p,v.bind(this)):(n.actor=this.dispatcher.getActor(),n.request=n.actor.send("loadTile",p,v.bind(this)))}abortTile(n){n.request&&(n.request.cancel(),delete n.request),n.actor&&n.actor.send("abortTile",{uid:n.uid,type:this.type,source:this.id},void 0)}unloadTile(n){n.unloadVectorData(),n.actor&&n.actor.send("removeTile",{uid:n.uid,type:this.type,source:this.id},void 0)}hasTransition(){return!1}}class tt extends a.Evented{constructor(n,o,u,p){super(),this.id=n,this.dispatcher=u,this.setEventedParent(p),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=a.extend({type:"raster"},o),a.extend(this,a.pick(o,["url","scheme","tileSize"]))}load(){this._loaded=!1,this.fire(new a.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=Gt(this._options,this.map._requestManager,(n,o)=>{this._tileJSONRequest=null,this._loaded=!0,n?this.fire(new a.ErrorEvent(n)):o&&(a.extend(this,o),o.bounds&&(this.tileBounds=new Ne(o.bounds,this.minzoom,this.maxzoom)),this.fire(new a.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new a.Event("data",{dataType:"source",sourceDataType:"content"})))})}loaded(){return this._loaded}onAdd(n){this.map=n,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}serialize(){return a.extend({},this._options)}hasTile(n){return!this.tileBounds||this.tileBounds.contains(n.canonical)}loadTile(n,o){const u=n.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);n.request=Ee.getImage(this.map._requestManager.transformRequest(u,ye.Tile),(p,v,w)=>{if(delete n.request,n.aborted)n.state="unloaded",o(null);else if(p)n.state="errored",o(p);else if(v){this.map._refreshExpiredTiles&&w&&n.setExpiryData(w);const E=this.map.painter.context,C=E.gl;n.texture=this.map.painter.getTileTexture(v.width),n.texture?n.texture.update(v,{useMipmap:!0}):(n.texture=new Se(E,v,C.RGBA,{useMipmap:!0}),n.texture.bind(C.LINEAR,C.CLAMP_TO_EDGE,C.LINEAR_MIPMAP_NEAREST),E.extTextureFilterAnisotropic&&C.texParameterf(C.TEXTURE_2D,E.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,E.extTextureFilterAnisotropicMax)),n.state="loaded",o(null)}},this.map._refreshExpiredTiles)}abortTile(n,o){n.request&&(n.request.cancel(),delete n.request),o()}unloadTile(n,o){n.texture&&this.map.painter.saveTileTexture(n.texture),o()}hasTransition(){return!1}}class Le extends tt{constructor(n,o,u,p){super(n,o,u,p),this.type="raster-dem",this.maxzoom=22,this._options=a.extend({type:"raster-dem"},o),this.encoding=o.encoding||"mapbox"}serialize(){return{type:"raster-dem",url:this.url,tileSize:this.tileSize,tiles:this.tiles,bounds:this.bounds,encoding:this.encoding}}loadTile(n,o){const u=n.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);function p(v,w){v&&(n.state="errored",o(v)),w&&(n.dem=w,n.needsHillshadePrepare=!0,n.needsTerrainPrepare=!0,n.state="loaded",o(null))}n.request=Ee.getImage(this.map._requestManager.transformRequest(u,ye.Tile),function(v,w){if(delete n.request,n.aborted)n.state="unloaded",o(null);else if(v)n.state="errored",o(v);else if(w){this.map._refreshExpiredTiles&&n.setExpiryData(w),delete w.cacheControl,delete w.expires;const E=a.isImageBitmap(w)&&(Tt==null&&(Tt=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&typeof createImageBitmap=="function"),Tt)?w:a.exported.getImageData(w,1),C={uid:n.uid,coord:n.tileID,source:this.id,rawImageData:E,encoding:this.encoding};n.actor&&n.state!=="expired"||(n.actor=this.dispatcher.getActor(),n.actor.send("loadDEMTile",C,p.bind(this)))}}.bind(this),this.map._refreshExpiredTiles),n.neighboringTiles=this._getNeighboringTiles(n.tileID)}_getNeighboringTiles(n){const o=n.canonical,u=Math.pow(2,o.z),p=(o.x-1+u)%u,v=o.x===0?n.wrap-1:n.wrap,w=(o.x+1+u)%u,E=o.x+1===u?n.wrap+1:n.wrap,C={};return C[new a.OverscaledTileID(n.overscaledZ,v,o.z,p,o.y).key]={backfilled:!1},C[new a.OverscaledTileID(n.overscaledZ,E,o.z,w,o.y).key]={backfilled:!1},o.y>0&&(C[new a.OverscaledTileID(n.overscaledZ,v,o.z,p,o.y-1).key]={backfilled:!1},C[new a.OverscaledTileID(n.overscaledZ,n.wrap,o.z,o.x,o.y-1).key]={backfilled:!1},C[new a.OverscaledTileID(n.overscaledZ,E,o.z,w,o.y-1).key]={backfilled:!1}),o.y+1<u&&(C[new a.OverscaledTileID(n.overscaledZ,v,o.z,p,o.y+1).key]={backfilled:!1},C[new a.OverscaledTileID(n.overscaledZ,n.wrap,o.z,o.x,o.y+1).key]={backfilled:!1},C[new a.OverscaledTileID(n.overscaledZ,E,o.z,w,o.y+1).key]={backfilled:!1}),C}unloadTile(n){n.demTexture&&this.map.painter.saveTileTexture(n.demTexture),n.fbo&&(n.fbo.destroy(),delete n.fbo),n.dem&&delete n.dem,delete n.neighboringTiles,n.state="unloaded",n.actor&&n.actor.send("removeDEMTile",{uid:n.uid,source:this.id})}}class He extends a.Evented{constructor(n,o,u,p){super(),this.id=n,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._pendingLoads=0,this.actor=u.getActor(),this.setEventedParent(p),this._data=o.data,this._options=a.extend({},o),this._collectResourceTiming=o.collectResourceTiming,o.maxzoom!==void 0&&(this.maxzoom=o.maxzoom),o.type&&(this.type=o.type),o.attribution&&(this.attribution=o.attribution),this.promoteId=o.promoteId;const v=a.EXTENT/this.tileSize;this.workerOptions=a.extend({source:this.id,cluster:o.cluster||!1,geojsonVtOptions:{buffer:(o.buffer!==void 0?o.buffer:128)*v,tolerance:(o.tolerance!==void 0?o.tolerance:.375)*v,extent:a.EXTENT,maxZoom:this.maxzoom,lineMetrics:o.lineMetrics||!1,generateId:o.generateId||!1},superclusterOptions:{maxZoom:o.clusterMaxZoom!==void 0?o.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,o.clusterMinPoints||2),extent:a.EXTENT,radius:(o.clusterRadius||50)*v,log:!1,generateId:o.generateId||!1},clusterProperties:o.clusterProperties,filter:o.filter},o.workerOptions),typeof this.promoteId=="string"&&(this.workerOptions.promoteId=this.promoteId)}load(){this._updateWorkerData()}onAdd(n){this.map=n,this.load()}setData(n){return this._data=n,this._updateWorkerData(),this}updateData(n){return this._updateWorkerData(n),this}setClusterOptions(n){return this.workerOptions.cluster=n.cluster,n&&(n.clusterRadius!==void 0&&(this.workerOptions.superclusterOptions.radius=n.clusterRadius),n.clusterMaxZoom!==void 0&&(this.workerOptions.superclusterOptions.maxZoom=n.clusterMaxZoom)),this._updateWorkerData(),this}getClusterExpansionZoom(n,o){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:n,source:this.id},o),this}getClusterChildren(n,o){return this.actor.send("geojson.getClusterChildren",{clusterId:n,source:this.id},o),this}getClusterLeaves(n,o,u,p){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:n,limit:o,offset:u},p),this}_updateWorkerData(n){const o=a.extend({},this.workerOptions);n?o.dataDiff=n:typeof this._data=="string"?(o.request=this.map._requestManager.transformRequest(a.exported.resolveURL(this._data),ye.Source),o.request.collectResourceTiming=this._collectResourceTiming):o.data=JSON.stringify(this._data),this._pendingLoads++,this.fire(new a.Event("dataloading",{dataType:"source"})),this.actor.send(`${this.type}.loadData`,o,(u,p)=>{if(this._pendingLoads--,this._removed||p&&p.abandoned)return void this.fire(new a.Event("dataabort",{dataType:"source"}));let v=null;if(p&&p.resourceTiming&&p.resourceTiming[this.id]&&(v=p.resourceTiming[this.id].slice(0)),u)return void this.fire(new a.ErrorEvent(u));const w={dataType:"source"};this._collectResourceTiming&&v&&v.length>0&&a.extend(w,{resourceTiming:v}),this.fire(new a.Event("data",{...w,sourceDataType:"metadata"})),this.fire(new a.Event("data",{...w,sourceDataType:"content"}))})}loaded(){return this._pendingLoads===0}loadTile(n,o){const u=n.actor?"reloadTile":"loadTile";n.actor=this.actor;const p={type:this.type,uid:n.uid,tileID:n.tileID,zoom:n.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};n.request=this.actor.send(u,p,(v,w)=>(delete n.request,n.unloadVectorData(),n.aborted?o(null):v?o(v):(n.loadVectorData(w,this.map.painter,u==="reloadTile"),o(null))))}abortTile(n){n.request&&(n.request.cancel(),delete n.request),n.aborted=!0}unloadTile(n){n.unloadVectorData(),this.actor.send("removeTile",{uid:n.uid,type:this.type,source:this.id})}onRemove(){this._removed=!0,this.actor.send("removeSource",{type:this.type,source:this.id})}serialize(){return a.extend({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}}var wt=a.createLayout([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class K extends a.Evented{constructor(n,o,u,p){super(),this.id=n,this.dispatcher=u,this.coordinates=o.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(p),this.options=o}load(n,o){this._loaded=!1,this.fire(new a.Event("dataloading",{dataType:"source"})),this.url=this.options.url,this._request=Ee.getImage(this.map._requestManager.transformRequest(this.url,ye.Image),(u,p)=>{this._request=null,this._loaded=!0,u?this.fire(new a.ErrorEvent(u)):p&&(this.image=p,n&&(this.coordinates=n),o&&o(),this._finishLoading())})}loaded(){return this._loaded}updateImage(n){return n.url?(this._request&&(this._request.cancel(),this._request=null),this.options.url=n.url,this.load(n.coordinates,()=>{this.texture=null}),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new a.Event("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(n){this.map=n,this.load()}onRemove(){this._request&&(this._request.cancel(),this._request=null)}setCoordinates(n){this.coordinates=n;const o=n.map(a.MercatorCoordinate.fromLngLat);this.tileID=function(p){let v=1/0,w=1/0,E=-1/0,C=-1/0;for(const U of p)v=Math.min(v,U.x),w=Math.min(w,U.y),E=Math.max(E,U.x),C=Math.max(C,U.y);const A=Math.max(E-v,C-w),L=Math.max(0,Math.floor(-Math.log(A)/Math.LN2)),z=Math.pow(2,L);return new a.CanonicalTileID(L,Math.floor((v+E)/2*z),Math.floor((w+C)/2*z))}(o),this.minzoom=this.maxzoom=this.tileID.z;const u=o.map(p=>this.tileID.getTilePoint(p)._round());return this._boundsArray=new a.RasterBoundsArray,this._boundsArray.emplaceBack(u[0].x,u[0].y,0,0),this._boundsArray.emplaceBack(u[1].x,u[1].y,a.EXTENT,0),this._boundsArray.emplaceBack(u[3].x,u[3].y,0,a.EXTENT),this._boundsArray.emplaceBack(u[2].x,u[2].y,a.EXTENT,a.EXTENT),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new a.Event("data",{dataType:"source",sourceDataType:"content"})),this}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const n=this.map.painter.context,o=n.gl;this.boundsBuffer||(this.boundsBuffer=n.createVertexBuffer(this._boundsArray,wt.members)),this.boundsSegments||(this.boundsSegments=a.SegmentVector.simpleSegment(0,0,4,2)),this.texture||(this.texture=new Se(n,this.image,o.RGBA),this.texture.bind(o.LINEAR,o.CLAMP_TO_EDGE));let u=!1;for(const p in this.tiles){const v=this.tiles[p];v.state!=="loaded"&&(v.state="loaded",v.texture=this.texture,u=!0)}u&&this.fire(new a.Event("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}loadTile(n,o){this.tileID&&this.tileID.equals(n.tileID.canonical)?(this.tiles[String(n.tileID.wrap)]=n,n.buckets={},o(null)):(n.state="errored",o(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}class ne extends K{constructor(n,o,u,p){super(n,o,u,p),this.roundZoom=!0,this.type="video",this.options=o}load(){this._loaded=!1;const n=this.options;this.urls=[];for(const o of n.urls)this.urls.push(this.map._requestManager.transformRequest(o,ye.Source).url);a.getVideo(this.urls,(o,u)=>{this._loaded=!0,o?this.fire(new a.ErrorEvent(o)):u&&(this.video=u,this.video.loop=!0,this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(n){if(this.video){const o=this.video.seekable;n<o.start(0)||n>o.end(0)?this.fire(new a.ErrorEvent(new a.ValidationError(`sources.${this.id}`,null,`Playback for this video can be set only between the ${o.start(0)} and ${o.end(0)}-second mark.`))):this.video.currentTime=n}}getVideo(){return this.video}onAdd(n){this.map||(this.map=n,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const n=this.map.painter.context,o=n.gl;this.boundsBuffer||(this.boundsBuffer=n.createVertexBuffer(this._boundsArray,wt.members)),this.boundsSegments||(this.boundsSegments=a.SegmentVector.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(o.LINEAR,o.CLAMP_TO_EDGE),o.texSubImage2D(o.TEXTURE_2D,0,0,0,o.RGBA,o.UNSIGNED_BYTE,this.video)):(this.texture=new Se(n,this.video,o.RGBA),this.texture.bind(o.LINEAR,o.CLAMP_TO_EDGE));let u=!1;for(const p in this.tiles){const v=this.tiles[p];v.state!=="loaded"&&(v.state="loaded",v.texture=this.texture,u=!0)}u&&this.fire(new a.Event("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}}class Z extends K{constructor(n,o,u,p){super(n,o,u,p),o.coordinates?Array.isArray(o.coordinates)&&o.coordinates.length===4&&!o.coordinates.some(v=>!Array.isArray(v)||v.length!==2||v.some(w=>typeof w!="number"))||this.fire(new a.ErrorEvent(new a.ValidationError(`sources.${n}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new a.ErrorEvent(new a.ValidationError(`sources.${n}`,null,'missing required property "coordinates"'))),o.animate&&typeof o.animate!="boolean"&&this.fire(new a.ErrorEvent(new a.ValidationError(`sources.${n}`,null,'optional "animate" property must be a boolean value'))),o.canvas?typeof o.canvas=="string"||o.canvas instanceof HTMLCanvasElement||this.fire(new a.ErrorEvent(new a.ValidationError(`sources.${n}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new a.ErrorEvent(new a.ValidationError(`sources.${n}`,null,'missing required property "canvas"'))),this.options=o,this.animate=o.animate===void 0||o.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new a.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(n){this.map=n,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let n=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,n=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,n=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const o=this.map.painter.context,u=o.gl;this.boundsBuffer||(this.boundsBuffer=o.createVertexBuffer(this._boundsArray,wt.members)),this.boundsSegments||(this.boundsSegments=a.SegmentVector.simpleSegment(0,0,4,2)),this.texture?(n||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new Se(o,this.canvas,u.RGBA,{premultiply:!0});let p=!1;for(const v in this.tiles){const w=this.tiles[v];w.state!=="loaded"&&(w.state="loaded",w.texture=this.texture,p=!0)}p&&this.fire(new a.Event("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const n of[this.canvas.width,this.canvas.height])if(isNaN(n)||n<=0)return!0;return!1}}const ke={vector:Ae,raster:tt,"raster-dem":Le,geojson:He,video:ne,image:K,canvas:Z};function Be(d,n){const o=a.create();return a.translate(o,o,[1,1,0]),a.scale(o,o,[.5*d.width,.5*d.height,1]),a.multiply(o,o,d.calculatePosMatrix(n.toUnwrapped()))}function Re(d,n,o,u,p,v){const w=function(z,U,Q){if(z)for(const H of z){const Y=U[H];if(Y&&Y.source===Q&&Y.type==="fill-extrusion")return!0}else for(const H in U){const Y=U[H];if(Y.source===Q&&Y.type==="fill-extrusion")return!0}return!1}(p&&p.layers,n,d.id),E=v.maxPitchScaleFactor(),C=d.tilesIn(u,E,w);C.sort(Ze);const A=[];for(const z of C)A.push({wrappedTileID:z.tileID.wrapped().key,queryResults:z.tile.queryRenderedFeatures(n,o,d._state,z.queryGeometry,z.cameraQueryGeometry,z.scale,p,v,E,Be(d.transform,z.tileID))});const L=function(z){const U={},Q={};for(const H of z){const Y=H.queryResults,se=H.wrappedTileID,de=Q[se]=Q[se]||{};for(const Pe in Y){const ie=Y[Pe],Te=de[Pe]=de[Pe]||{},De=U[Pe]=U[Pe]||[];for(const Ye of ie)Te[Ye.featureIndex]||(Te[Ye.featureIndex]=!0,De.push(Ye))}}return U}(A);for(const z in L)L[z].forEach(U=>{const Q=U.feature,H=d.getFeatureState(Q.layer["source-layer"],Q.id);Q.source=Q.layer.source,Q.layer["source-layer"]&&(Q.sourceLayer=Q.layer["source-layer"]),Q.state=H});return L}function Ze(d,n){const o=d.tileID,u=n.tileID;return o.overscaledZ-u.overscaledZ||o.canonical.y-u.canonical.y||o.wrap-u.wrap||o.canonical.x-u.canonical.x}class ot{constructor(n,o){this.timeAdded=0,this.fadeEndTime=0,this.tileID=n,this.uid=a.uniqueId(),this.uses=0,this.tileSize=o,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.rtt=[],this.rttCoords={},this.expiredRequestCount=0,this.state="loading"}registerFadeDuration(n){const o=n+this.timeAdded;o<this.fadeEndTime||(this.fadeEndTime=o)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}clearTextures(n){this.demTexture&&n.saveTileTexture(this.demTexture),this.demTexture=null}loadVectorData(n,o,u){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",n){n.featureIndex&&(this.latestFeatureIndex=n.featureIndex,n.rawTileData?(this.latestRawTileData=n.rawTileData,this.latestFeatureIndex.rawTileData=n.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=n.collisionBoxArray,this.buckets=function(p,v){const w={};if(!v)return w;for(const E of p){const C=E.layerIds.map(A=>v.getLayer(A)).filter(Boolean);if(C.length!==0){E.layers=C,E.stateDependentLayerIds&&(E.stateDependentLayers=E.stateDependentLayerIds.map(A=>C.filter(L=>L.id===A)[0]));for(const A of C)w[A.id]=E}}return w}(n.buckets,o.style),this.hasSymbolBuckets=!1;for(const p in this.buckets){const v=this.buckets[p];if(v instanceof a.SymbolBucket){if(this.hasSymbolBuckets=!0,!u)break;v.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const p in this.buckets){const v=this.buckets[p];if(v instanceof a.SymbolBucket&&v.hasRTLText){this.hasRTLText=!0,a.lazyLoadRTLTextPlugin();break}}this.queryPadding=0;for(const p in this.buckets){const v=this.buckets[p];this.queryPadding=Math.max(this.queryPadding,o.style.getLayer(p).queryRadius(v))}n.imageAtlas&&(this.imageAtlas=n.imageAtlas),n.glyphAtlasImage&&(this.glyphAtlasImage=n.glyphAtlasImage)}else this.collisionBoxArray=new a.CollisionBoxArray}unloadVectorData(){for(const n in this.buckets)this.buckets[n].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(n){return this.buckets[n.id]}upload(n){for(const u in this.buckets){const p=this.buckets[u];p.uploadPending()&&p.upload(n)}const o=n.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new Se(n,this.imageAtlas.image,o.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new Se(n,this.glyphAtlasImage,o.ALPHA),this.glyphAtlasImage=null)}prepare(n){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(n,this.imageAtlasTexture)}queryRenderedFeatures(n,o,u,p,v,w,E,C,A,L){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:p,cameraQueryGeometry:v,scale:w,tileSize:this.tileSize,pixelPosMatrix:L,transform:C,params:E,queryPadding:this.queryPadding*A},n,o,u):{}}querySourceFeatures(n,o){const u=this.latestFeatureIndex;if(!u||!u.rawTileData)return;const p=u.loadVTLayers(),v=o&&o.sourceLayer?o.sourceLayer:"",w=p._geojsonTileLayer||p[v];if(!w)return;const E=a.createFilter(o&&o.filter),{z:C,x:A,y:L}=this.tileID.canonical,z={z:C,x:A,y:L};for(let U=0;U<w.length;U++){const Q=w.feature(U);if(E.needGeometry){const se=a.toEvaluationFeature(Q,!0);if(!E.filter(new a.EvaluationParameters(this.tileID.overscaledZ),se,this.tileID.canonical))continue}else if(!E.filter(new a.EvaluationParameters(this.tileID.overscaledZ),Q))continue;const H=u.getId(Q,v),Y=new a.GeoJSONFeature(Q,C,A,L,H);Y.tile=z,n.push(Y)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(n){const o=this.expirationTime;if(n.cacheControl){const u=a.parseCacheControl(n.cacheControl);u["max-age"]&&(this.expirationTime=Date.now()+1e3*u["max-age"])}else n.expires&&(this.expirationTime=new Date(n.expires).getTime());if(this.expirationTime){const u=Date.now();let p=!1;if(this.expirationTime>u)p=!1;else if(o)if(this.expirationTime<o)p=!0;else{const v=this.expirationTime-o;v?this.expirationTime=u+Math.max(v,3e4):p=!0}else p=!0;p?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(n,o){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(n).length===0)return;const u=this.latestFeatureIndex.loadVTLayers();for(const p in this.buckets){if(!o.style.hasLayer(p))continue;const v=this.buckets[p],w=v.layers[0].sourceLayer||"_geojsonTileLayer",E=u[w],C=n[w];if(!E||!C||Object.keys(C).length===0)continue;v.update(C,E,this.imageAtlas&&this.imageAtlas.patternPositions||{});const A=o&&o.style&&o.style.getLayer(p);A&&(this.queryPadding=Math.max(this.queryPadding,A.queryRadius(v)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<a.exported.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(n){this.symbolFadeHoldUntil=a.exported.now()+n}setDependencies(n,o){const u={};for(const p of o)u[p]=!0;this.dependencies[n]=u}hasDependency(n,o){for(const u of n){const p=this.dependencies[u];if(p){for(const v of o)if(p[v])return!0}}return!1}}class ht{constructor(n,o){this.max=n,this.onRemove=o,this.reset()}reset(){for(const n in this.data)for(const o of this.data[n])o.timeout&&clearTimeout(o.timeout),this.onRemove(o.value);return this.data={},this.order=[],this}add(n,o,u){const p=n.wrapped().key;this.data[p]===void 0&&(this.data[p]=[]);const v={value:o,timeout:void 0};if(u!==void 0&&(v.timeout=setTimeout(()=>{this.remove(n,v)},u)),this.data[p].push(v),this.order.push(p),this.order.length>this.max){const w=this._getAndRemoveByKey(this.order[0]);w&&this.onRemove(w)}return this}has(n){return n.wrapped().key in this.data}getAndRemove(n){return this.has(n)?this._getAndRemoveByKey(n.wrapped().key):null}_getAndRemoveByKey(n){const o=this.data[n].shift();return o.timeout&&clearTimeout(o.timeout),this.data[n].length===0&&delete this.data[n],this.order.splice(this.order.indexOf(n),1),o.value}getByKey(n){const o=this.data[n];return o?o[0].value:null}get(n){return this.has(n)?this.data[n.wrapped().key][0].value:null}remove(n,o){if(!this.has(n))return this;const u=n.wrapped().key,p=o===void 0?0:this.data[u].indexOf(o),v=this.data[u][p];return this.data[u].splice(p,1),v.timeout&&clearTimeout(v.timeout),this.data[u].length===0&&delete this.data[u],this.onRemove(v.value),this.order.splice(this.order.indexOf(u),1),this}setMaxSize(n){for(this.max=n;this.order.length>this.max;){const o=this._getAndRemoveByKey(this.order[0]);o&&this.onRemove(o)}return this}filter(n){const o=[];for(const u in this.data)for(const p of this.data[u])n(p.value)||o.push(p);for(const u of o)this.remove(u.value.tileID,u)}}class Je{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(n,o,u){const p=String(o);if(this.stateChanges[n]=this.stateChanges[n]||{},this.stateChanges[n][p]=this.stateChanges[n][p]||{},a.extend(this.stateChanges[n][p],u),this.deletedStates[n]===null){this.deletedStates[n]={};for(const v in this.state[n])v!==p&&(this.deletedStates[n][v]=null)}else if(this.deletedStates[n]&&this.deletedStates[n][p]===null){this.deletedStates[n][p]={};for(const v in this.state[n][p])u[v]||(this.deletedStates[n][p][v]=null)}else for(const v in u)this.deletedStates[n]&&this.deletedStates[n][p]&&this.deletedStates[n][p][v]===null&&delete this.deletedStates[n][p][v]}removeFeatureState(n,o,u){if(this.deletedStates[n]===null)return;const p=String(o);if(this.deletedStates[n]=this.deletedStates[n]||{},u&&o!==void 0)this.deletedStates[n][p]!==null&&(this.deletedStates[n][p]=this.deletedStates[n][p]||{},this.deletedStates[n][p][u]=null);else if(o!==void 0)if(this.stateChanges[n]&&this.stateChanges[n][p])for(u in this.deletedStates[n][p]={},this.stateChanges[n][p])this.deletedStates[n][p][u]=null;else this.deletedStates[n][p]=null;else this.deletedStates[n]=null}getState(n,o){const u=String(o),p=a.extend({},(this.state[n]||{})[u],(this.stateChanges[n]||{})[u]);if(this.deletedStates[n]===null)return{};if(this.deletedStates[n]){const v=this.deletedStates[n][o];if(v===null)return{};for(const w in v)delete p[w]}return p}initializeTileState(n,o){n.setFeatureState(this.state,o)}coalesceChanges(n,o){const u={};for(const p in this.stateChanges){this.state[p]=this.state[p]||{};const v={};for(const w in this.stateChanges[p])this.state[p][w]||(this.state[p][w]={}),a.extend(this.state[p][w],this.stateChanges[p][w]),v[w]=this.state[p][w];u[p]=v}for(const p in this.deletedStates){this.state[p]=this.state[p]||{};const v={};if(this.deletedStates[p]===null)for(const w in this.state[p])v[w]={},this.state[p][w]={};else for(const w in this.deletedStates[p]){if(this.deletedStates[p][w]===null)this.state[p][w]={};else for(const E of Object.keys(this.deletedStates[p][w]))delete this.state[p][w][E];v[w]=this.state[p][w]}u[p]=u[p]||{},a.extend(u[p],v)}if(this.stateChanges={},this.deletedStates={},Object.keys(u).length!==0)for(const p in n)n[p].setFeatureState(u,o)}}class lt extends a.Evented{constructor(n,o,u){super(),this.id=n,this.dispatcher=u,this.on("data",p=>{p.dataType==="source"&&p.sourceDataType==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&p.dataType==="source"&&p.sourceDataType==="content"&&(this.reload(),this.transform&&this.update(this.transform,this.terrain),this._didEmitContent=!0)}),this.on("dataloading",()=>{this._sourceErrored=!1}),this.on("error",()=>{this._sourceErrored=this._source.loaded()}),this._source=function(p,v,w,E){const C=new ke[v.type](p,v,w,E);if(C.id!==p)throw new Error(`Expected Source id to be ${p} instead of ${C.id}`);return a.bindAll(["load","abort","unload","serialize","prepare"],C),C}(n,o,u,this),this._tiles={},this._cache=new ht(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._maxTileCacheZoomLevels=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new Je,this._didEmitContent=!1,this._updated=!1}onAdd(n){this.map=n,this._maxTileCacheSize=n?n._maxTileCacheSize:null,this._maxTileCacheZoomLevels=n?n._maxTileCacheZoomLevels:null,this._source&&this._source.onAdd&&this._source.onAdd(n)}onRemove(n){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(n)}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;if(!(this.used===void 0&&this.usedForTerrain===void 0||this.used||this.usedForTerrain))return!0;if(!this._updated)return!1;for(const n in this._tiles){const o=this._tiles[n];if(o.state!=="loaded"&&o.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const n=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,n&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(n,o){return this._source.loadTile(n,o)}_unloadTile(n){if(this._source.unloadTile)return this._source.unloadTile(n,()=>{})}_abortTile(n){this._source.abortTile&&this._source.abortTile(n,()=>{}),this._source.fire(new a.Event("dataabort",{tile:n,coord:n.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(n){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const o in this._tiles){const u=this._tiles[o];u.upload(n),u.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map(n=>n.tileID).sort(ft).map(n=>n.key)}getRenderableIds(n){const o=[];for(const u in this._tiles)this._isIdRenderable(u,n)&&o.push(this._tiles[u]);return n?o.sort((u,p)=>{const v=u.tileID,w=p.tileID,E=new a.Point(v.canonical.x,v.canonical.y)._rotate(this.transform.angle),C=new a.Point(w.canonical.x,w.canonical.y)._rotate(this.transform.angle);return v.overscaledZ-w.overscaledZ||C.y-E.y||C.x-E.x}).map(u=>u.tileID.key):o.map(u=>u.tileID).sort(ft).map(u=>u.key)}hasRenderableParent(n){const o=this.findLoadedParent(n,0);return!!o&&this._isIdRenderable(o.tileID.key)}_isIdRenderable(n,o){return this._tiles[n]&&this._tiles[n].hasData()&&!this._coveredTiles[n]&&(o||!this._tiles[n].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const n in this._tiles)this._tiles[n].state!=="errored"&&this._reloadTile(n,"reloading")}}_reloadTile(n,o){const u=this._tiles[n];u&&(u.state!=="loading"&&(u.state=o),this._loadTile(u,this._tileLoaded.bind(this,u,n,o)))}_tileLoaded(n,o,u,p){if(p)return n.state="errored",void(p.status!==404?this._source.fire(new a.ErrorEvent(p,{tile:n})):this.update(this.transform,this.terrain));n.timeAdded=a.exported.now(),u==="expired"&&(n.refreshedUponExpiration=!0),this._setTileReloadTimer(o,n),this.getSource().type==="raster-dem"&&n.dem&&this._backfillDEM(n),this._state.initializeTileState(n,this.map?this.map.painter:null),n.aborted||this._source.fire(new a.Event("data",{dataType:"source",tile:n,coord:n.tileID}))}_backfillDEM(n){const o=this.getRenderableIds();for(let p=0;p<o.length;p++){const v=o[p];if(n.neighboringTiles&&n.neighboringTiles[v]){const w=this.getTileByID(v);u(n,w),u(w,n)}}function u(p,v){p.needsHillshadePrepare=!0,p.needsTerrainPrepare=!0;let w=v.tileID.canonical.x-p.tileID.canonical.x;const E=v.tileID.canonical.y-p.tileID.canonical.y,C=Math.pow(2,p.tileID.canonical.z),A=v.tileID.key;w===0&&E===0||Math.abs(E)>1||(Math.abs(w)>1&&(Math.abs(w+C)===1?w+=C:Math.abs(w-C)===1&&(w-=C)),v.dem&&p.dem&&(p.dem.backfillBorder(v.dem,w,E),p.neighboringTiles&&p.neighboringTiles[A]&&(p.neighboringTiles[A].backfilled=!0)))}}getTile(n){return this.getTileByID(n.key)}getTileByID(n){return this._tiles[n]}_retainLoadedChildren(n,o,u,p){for(const v in this._tiles){let w=this._tiles[v];if(p[v]||!w.hasData()||w.tileID.overscaledZ<=o||w.tileID.overscaledZ>u)continue;let E=w.tileID;for(;w&&w.tileID.overscaledZ>o+1;){const A=w.tileID.scaledTo(w.tileID.overscaledZ-1);w=this._tiles[A.key],w&&w.hasData()&&(E=A)}let C=E;for(;C.overscaledZ>o;)if(C=C.scaledTo(C.overscaledZ-1),n[C.key]){p[E.key]=E;break}}}findLoadedParent(n,o){if(n.key in this._loadedParentTiles){const u=this._loadedParentTiles[n.key];return u&&u.tileID.overscaledZ>=o?u:null}for(let u=n.overscaledZ-1;u>=o;u--){const p=n.scaledTo(u),v=this._getLoadedTile(p);if(v)return v}}_getLoadedTile(n){const o=this._tiles[n.key];return o&&o.hasData()?o:this._cache.getByKey(n.wrapped().key)}updateCacheSize(n){const o=Math.ceil(n.width/this._source.tileSize)+1,u=Math.ceil(n.height/this._source.tileSize)+1,p=Math.floor(o*u*(this._maxTileCacheZoomLevels===null?a.config.MAX_TILE_CACHE_ZOOM_LEVELS:this._maxTileCacheZoomLevels)),v=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,p):p;this._cache.setMaxSize(v)}handleWrapJump(n){const o=Math.round((n-(this._prevLng===void 0?n:this._prevLng))/360);if(this._prevLng=n,o){const u={};for(const p in this._tiles){const v=this._tiles[p];v.tileID=v.tileID.unwrapTo(v.tileID.wrap+o),u[v.tileID.key]=v}this._tiles=u;for(const p in this._timers)clearTimeout(this._timers[p]),delete this._timers[p];for(const p in this._tiles)this._setTileReloadTimer(p,this._tiles[p])}}update(n,o){if(this.transform=n,this.terrain=o,!this._sourceLoaded||this._paused)return;let u;this.updateCacheSize(n),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?u=n.getVisibleUnwrappedCoordinates(this._source.tileID).map(L=>new a.OverscaledTileID(L.canonical.z,L.wrap,L.canonical.z,L.canonical.x,L.canonical.y)):(u=n.coveringTiles({tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:o}),this._source.hasTile&&(u=u.filter(L=>this._source.hasTile(L)))):u=[];const p=n.coveringZoomLevel(this._source),v=Math.max(p-lt.maxOverzooming,this._source.minzoom),w=Math.max(p+lt.maxUnderzooming,this._source.minzoom);if(this.usedForTerrain){const L={};for(const z of u)if(z.canonical.z>this._source.minzoom){const U=z.scaledTo(z.canonical.z-1);L[U.key]=U;const Q=z.scaledTo(Math.max(this._source.minzoom,Math.min(z.canonical.z,5)));L[Q.key]=Q}u=u.concat(Object.values(L))}const E=u.length===0&&!this._updated&&this._didEmitContent;this._updated=!0,E&&this.fire(new a.Event("data",{sourceDataType:"idle",dataType:"source",sourceId:this.id}));const C=this._updateRetainedTiles(u,p);if(Mt(this._source.type)){const L={},z={},U=Object.keys(C),Q=a.exported.now();for(const H of U){const Y=C[H],se=this._tiles[H];if(!se||se.fadeEndTime!==0&&se.fadeEndTime<=Q)continue;const de=this.findLoadedParent(Y,v);de&&(this._addTile(de.tileID),L[de.tileID.key]=de.tileID),z[H]=Y}this._retainLoadedChildren(z,p,w,C);for(const H in L)C[H]||(this._coveredTiles[H]=!0,C[H]=L[H]);if(o){const H={},Y={};for(const se of u)this._tiles[se.key].hasData()?H[se.key]=se:Y[se.key]=se;for(const se in Y){const de=Y[se].children(this._source.maxzoom);this._tiles[de[0].key]&&this._tiles[de[1].key]&&this._tiles[de[2].key]&&this._tiles[de[3].key]&&(H[de[0].key]=C[de[0].key]=de[0],H[de[1].key]=C[de[1].key]=de[1],H[de[2].key]=C[de[2].key]=de[2],H[de[3].key]=C[de[3].key]=de[3],delete Y[se])}for(const se in Y){const de=this.findLoadedParent(Y[se],this._source.minzoom);if(de){H[de.tileID.key]=C[de.tileID.key]=de.tileID;for(const Pe in H)H[Pe].isChildOf(de.tileID)&&delete H[Pe]}}for(const se in this._tiles)H[se]||(this._coveredTiles[se]=!0)}}for(const L in C)this._tiles[L].clearFadeHold();const A=a.keysDifference(this._tiles,C);for(const L of A){const z=this._tiles[L];z.hasSymbolBuckets&&!z.holdingForFade()?z.setHoldDuration(this.map._fadeDuration):z.hasSymbolBuckets&&!z.symbolFadeFinished()||this._removeTile(L)}this._updateLoadedParentTileCache()}releaseSymbolFadeTiles(){for(const n in this._tiles)this._tiles[n].holdingForFade()&&this._removeTile(n)}_updateRetainedTiles(n,o){const u={},p={},v=Math.max(o-lt.maxOverzooming,this._source.minzoom),w=Math.max(o+lt.maxUnderzooming,this._source.minzoom),E={};for(const C of n){const A=this._addTile(C);u[C.key]=C,A.hasData()||o<this._source.maxzoom&&(E[C.key]=C)}this._retainLoadedChildren(E,o,w,u);for(const C of n){let A=this._tiles[C.key];if(A.hasData())continue;if(o+1>this._source.maxzoom){const z=C.children(this._source.maxzoom)[0],U=this.getTile(z);if(U&&U.hasData()){u[z.key]=z;continue}}else{const z=C.children(this._source.maxzoom);if(u[z[0].key]&&u[z[1].key]&&u[z[2].key]&&u[z[3].key])continue}let L=A.wasRequested();for(let z=C.overscaledZ-1;z>=v;--z){const U=C.scaledTo(z);if(p[U.key])break;if(p[U.key]=!0,A=this.getTile(U),!A&&L&&(A=this._addTile(U)),A){const Q=A.hasData();if((L||Q)&&(u[U.key]=U),L=A.wasRequested(),Q)break}}}return u}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const n in this._tiles){const o=[];let u,p=this._tiles[n].tileID;for(;p.overscaledZ>0;){if(p.key in this._loadedParentTiles){u=this._loadedParentTiles[p.key];break}o.push(p.key);const v=p.scaledTo(p.overscaledZ-1);if(u=this._getLoadedTile(v),u)break;p=v}for(const v of o)this._loadedParentTiles[v]=u}}_addTile(n){let o=this._tiles[n.key];if(o)return o;o=this._cache.getAndRemove(n),o&&(this._setTileReloadTimer(n.key,o),o.tileID=n,this._state.initializeTileState(o,this.map?this.map.painter:null),this._cacheTimers[n.key]&&(clearTimeout(this._cacheTimers[n.key]),delete this._cacheTimers[n.key],this._setTileReloadTimer(n.key,o)));const u=o;return o||(o=new ot(n,this._source.tileSize*n.overscaleFactor()),this._loadTile(o,this._tileLoaded.bind(this,o,n.key,o.state))),o.uses++,this._tiles[n.key]=o,u||this._source.fire(new a.Event("dataloading",{tile:o,coord:o.tileID,dataType:"source"})),o}_setTileReloadTimer(n,o){n in this._timers&&(clearTimeout(this._timers[n]),delete this._timers[n]);const u=o.getExpiryTimeout();u&&(this._timers[n]=setTimeout(()=>{this._reloadTile(n,"expired"),delete this._timers[n]},u))}_removeTile(n){const o=this._tiles[n];o&&(o.uses--,delete this._tiles[n],this._timers[n]&&(clearTimeout(this._timers[n]),delete this._timers[n]),o.uses>0||(o.hasData()&&o.state!=="reloading"?this._cache.add(o.tileID,o,o.getExpiryTimeout()):(o.aborted=!0,this._abortTile(o),this._unloadTile(o))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const n in this._tiles)this._removeTile(n);this._cache.reset()}tilesIn(n,o,u){const p=[],v=this.transform;if(!v)return p;const w=u?v.getCameraQueryGeometry(n):n,E=n.map(H=>v.pointCoordinate(H,this.terrain)),C=w.map(H=>v.pointCoordinate(H,this.terrain)),A=this.getIds();let L=1/0,z=1/0,U=-1/0,Q=-1/0;for(const H of C)L=Math.min(L,H.x),z=Math.min(z,H.y),U=Math.max(U,H.x),Q=Math.max(Q,H.y);for(let H=0;H<A.length;H++){const Y=this._tiles[A[H]];if(Y.holdingForFade())continue;const se=Y.tileID,de=Math.pow(2,v.zoom-Y.tileID.overscaledZ),Pe=o*Y.queryPadding*a.EXTENT/Y.tileSize/de,ie=[se.getTilePoint(new a.MercatorCoordinate(L,z)),se.getTilePoint(new a.MercatorCoordinate(U,Q))];if(ie[0].x-Pe<a.EXTENT&&ie[0].y-Pe<a.EXTENT&&ie[1].x+Pe>=0&&ie[1].y+Pe>=0){const Te=E.map(Ye=>se.getTilePoint(Ye)),De=C.map(Ye=>se.getTilePoint(Ye));p.push({tile:Y,tileID:se,queryGeometry:Te,cameraQueryGeometry:De,scale:de})}}return p}getVisibleCoordinates(n){const o=this.getRenderableIds(n).map(u=>this._tiles[u].tileID);for(const u of o)u.posMatrix=this.transform.calculatePosMatrix(u.toUnwrapped());return o}hasTransition(){if(this._source.hasTransition())return!0;if(Mt(this._source.type)){const n=a.exported.now();for(const o in this._tiles)if(this._tiles[o].fadeEndTime>=n)return!0}return!1}setFeatureState(n,o,u){this._state.updateState(n=n||"_geojsonTileLayer",o,u)}removeFeatureState(n,o,u){this._state.removeFeatureState(n=n||"_geojsonTileLayer",o,u)}getFeatureState(n,o){return this._state.getState(n=n||"_geojsonTileLayer",o)}setDependencies(n,o,u){const p=this._tiles[n];p&&p.setDependencies(o,u)}reloadTilesForDependencies(n,o){for(const u in this._tiles)this._tiles[u].hasDependency(n,o)&&this._reloadTile(u,"reloading");this._cache.filter(u=>!u.hasDependency(n,o))}}function ft(d,n){const o=Math.abs(2*d.wrap)-+(d.wrap<0),u=Math.abs(2*n.wrap)-+(n.wrap<0);return d.overscaledZ-n.overscaledZ||u-o||n.canonical.y-d.canonical.y||n.canonical.x-d.canonical.x}function Mt(d){return d==="raster"||d==="image"||d==="video"}lt.maxOverzooming=10,lt.maxUnderzooming=3;const xt="mapboxgl_preloaded_worker_pool";class $e{constructor(){this.active={}}acquire(n){if(!this.workers)for(this.workers=[];this.workers.length<$e.workerCount;)this.workers.push(new Worker(a.config.WORKER_URL));return this.active[n]=!0,this.workers.slice()}release(n){delete this.active[n],this.numActive()===0&&(this.workers.forEach(o=>{o.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[xt]}numActive(){return Object.keys(this.active).length}}const en=Math.floor(a.exported.hardwareConcurrency/2);let Wt;function hn(){return Wt||(Wt=new $e),Wt}$e.workerCount=a.isSafari(globalThis)?Math.max(Math.min(en,3),1):1;class Mn{constructor(n,o){this.reset(n,o)}reset(n,o){this.points=n||[],this._distances=[0];for(let u=1;u<this.points.length;u++)this._distances[u]=this._distances[u-1]+this.points[u].dist(this.points[u-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(o||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(n){if(this.points.length===1)return this.points[0];n=a.clamp(n,0,1);let o=1,u=this._distances[o];const p=n*this.paddedLength+this.padding;for(;u<p&&o<this._distances.length;)u=this._distances[++o];const v=o-1,w=this._distances[v],E=u-w,C=E>0?(p-w)/E:0;return this.points[v].mult(1-C).add(this.points[o].mult(C))}}function nt(d,n){let o=!0;return d==="always"||d!=="never"&&n!=="never"||(o=!1),o}class $t{constructor(n,o,u){const p=this.boxCells=[],v=this.circleCells=[];this.xCellCount=Math.ceil(n/u),this.yCellCount=Math.ceil(o/u);for(let w=0;w<this.xCellCount*this.yCellCount;w++)p.push([]),v.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=n,this.height=o,this.xScale=this.xCellCount/n,this.yScale=this.yCellCount/o,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(n,o,u,p,v){this._forEachCell(o,u,p,v,this._insertBoxCell,this.boxUid++),this.boxKeys.push(n),this.bboxes.push(o),this.bboxes.push(u),this.bboxes.push(p),this.bboxes.push(v)}insertCircle(n,o,u,p){this._forEachCell(o-p,u-p,o+p,u+p,this._insertCircleCell,this.circleUid++),this.circleKeys.push(n),this.circles.push(o),this.circles.push(u),this.circles.push(p)}_insertBoxCell(n,o,u,p,v,w){this.boxCells[v].push(w)}_insertCircleCell(n,o,u,p,v,w){this.circleCells[v].push(w)}_query(n,o,u,p,v,w,E){if(u<0||n>this.width||p<0||o>this.height)return[];const C=[];if(n<=0&&o<=0&&this.width<=u&&this.height<=p){if(v)return[{key:null,x1:n,y1:o,x2:u,y2:p}];for(let A=0;A<this.boxKeys.length;A++)C.push({key:this.boxKeys[A],x1:this.bboxes[4*A],y1:this.bboxes[4*A+1],x2:this.bboxes[4*A+2],y2:this.bboxes[4*A+3]});for(let A=0;A<this.circleKeys.length;A++){const L=this.circles[3*A],z=this.circles[3*A+1],U=this.circles[3*A+2];C.push({key:this.circleKeys[A],x1:L-U,y1:z-U,x2:L+U,y2:z+U})}}else this._forEachCell(n,o,u,p,this._queryCell,C,{hitTest:v,overlapMode:w,seenUids:{box:{},circle:{}}},E);return C}query(n,o,u,p){return this._query(n,o,u,p,!1,null)}hitTest(n,o,u,p,v,w){return this._query(n,o,u,p,!0,v,w).length>0}hitTestCircle(n,o,u,p,v){const w=n-u,E=n+u,C=o-u,A=o+u;if(E<0||w>this.width||A<0||C>this.height)return!1;const L=[];return this._forEachCell(w,C,E,A,this._queryCellCircle,L,{hitTest:!0,overlapMode:p,circle:{x:n,y:o,radius:u},seenUids:{box:{},circle:{}}},v),L.length>0}_queryCell(n,o,u,p,v,w,E,C){const{seenUids:A,hitTest:L,overlapMode:z}=E,U=this.boxCells[v];if(U!==null){const H=this.bboxes;for(const Y of U)if(!A.box[Y]){A.box[Y]=!0;const se=4*Y,de=this.boxKeys[Y];if(n<=H[se+2]&&o<=H[se+3]&&u>=H[se+0]&&p>=H[se+1]&&(!C||C(de))&&(!L||!nt(z,de.overlapMode))&&(w.push({key:de,x1:H[se],y1:H[se+1],x2:H[se+2],y2:H[se+3]}),L))return!0}}const Q=this.circleCells[v];if(Q!==null){const H=this.circles;for(const Y of Q)if(!A.circle[Y]){A.circle[Y]=!0;const se=3*Y,de=this.circleKeys[Y];if(this._circleAndRectCollide(H[se],H[se+1],H[se+2],n,o,u,p)&&(!C||C(de))&&(!L||!nt(z,de.overlapMode))){const Pe=H[se],ie=H[se+1],Te=H[se+2];if(w.push({key:de,x1:Pe-Te,y1:ie-Te,x2:Pe+Te,y2:ie+Te}),L)return!0}}}return!1}_queryCellCircle(n,o,u,p,v,w,E,C){const{circle:A,seenUids:L,overlapMode:z}=E,U=this.boxCells[v];if(U!==null){const H=this.bboxes;for(const Y of U)if(!L.box[Y]){L.box[Y]=!0;const se=4*Y,de=this.boxKeys[Y];if(this._circleAndRectCollide(A.x,A.y,A.radius,H[se+0],H[se+1],H[se+2],H[se+3])&&(!C||C(de))&&!nt(z,de.overlapMode))return w.push(!0),!0}}const Q=this.circleCells[v];if(Q!==null){const H=this.circles;for(const Y of Q)if(!L.circle[Y]){L.circle[Y]=!0;const se=3*Y,de=this.circleKeys[Y];if(this._circlesCollide(H[se],H[se+1],H[se+2],A.x,A.y,A.radius)&&(!C||C(de))&&!nt(z,de.overlapMode))return w.push(!0),!0}}}_forEachCell(n,o,u,p,v,w,E,C){const A=this._convertToXCellCoord(n),L=this._convertToYCellCoord(o),z=this._convertToXCellCoord(u),U=this._convertToYCellCoord(p);for(let Q=A;Q<=z;Q++)for(let H=L;H<=U;H++)if(v.call(this,n,o,u,p,this.xCellCount*H+Q,w,E,C))return}_convertToXCellCoord(n){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(n*this.xScale)))}_convertToYCellCoord(n){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(n*this.yScale)))}_circlesCollide(n,o,u,p,v,w){const E=p-n,C=v-o,A=u+w;return A*A>E*E+C*C}_circleAndRectCollide(n,o,u,p,v,w,E){const C=(w-p)/2,A=Math.abs(n-(p+C));if(A>C+u)return!1;const L=(E-v)/2,z=Math.abs(o-(v+L));if(z>L+u)return!1;if(A<=C||z<=L)return!0;const U=A-C,Q=z-L;return U*U+Q*Q<=u*u}}function Nt(d,n,o,u,p){const v=a.create();return n?(a.scale(v,v,[1/p,1/p,1]),o||a.rotateZ(v,v,u.angle)):a.multiply(v,u.labelPlaneMatrix,d),v}function kn(d,n,o,u,p){if(n){const v=a.clone(d);return a.scale(v,v,[p,p,1]),o||a.rotateZ(v,v,-u.angle),v}return u.glCoordMatrix}function dn(d,n,o){let u;o?(u=[d.x,d.y,o(d.x,d.y),1],a.transformMat4(u,u,n)):(u=[d.x,d.y,0,1],oe(u,u,n));const p=u[3];return{point:new a.Point(u[0]/p,u[1]/p),signedDistanceFromCamera:p}}function Lt(d,n){return .5+d/n*.5}function yr(d,n){const o=d[0]/d[3],u=d[1]/d[3];return o>=-n[0]&&o<=n[0]&&u>=-n[1]&&u<=n[1]}function rs(d,n,o,u,p,v,w,E,C,A){const L=u?d.textSizeData:d.iconSizeData,z=a.evaluateSizeForZoom(L,o.transform.zoom),U=[256/o.width*2+1,256/o.height*2+1],Q=u?d.text.dynamicLayoutVertexArray:d.icon.dynamicLayoutVertexArray;Q.clear();const H=d.lineVertexArray,Y=u?d.text.placedSymbolArray:d.icon.placedSymbolArray,se=o.transform.width/o.transform.height;let de=!1;for(let Pe=0;Pe<Y.length;Pe++){const ie=Y.get(Pe);if(ie.hidden||ie.writingMode===a.WritingMode.vertical&&!de){W(ie.numGlyphs,Q);continue}let Te;if(de=!1,A?(Te=[ie.anchorX,ie.anchorY,A(ie.anchorX,ie.anchorY),1],a.transformMat4(Te,Te,n)):(Te=[ie.anchorX,ie.anchorY,0,1],oe(Te,Te,n)),!yr(Te,U)){W(ie.numGlyphs,Q);continue}const De=Lt(o.transform.cameraToCenterDistance,Te[3]),Ye=a.evaluateSizeForFeature(L,z,ie),it=w?Ye/De:Ye*De,ct=new a.Point(ie.anchorX,ie.anchorY),et=dn(ct,p,A).point,bt={projections:{},offsets:{}},Ot=Ti(ie,it,!1,E,n,p,v,d.glyphOffsetArray,H,Q,et,ct,bt,se,C,A);de=Ot.useVertical,(Ot.notEnoughRoom||de||Ot.needsFlipping&&Ti(ie,it,!0,E,n,p,v,d.glyphOffsetArray,H,Q,et,ct,bt,se,C,A).notEnoughRoom)&&W(ie.numGlyphs,Q)}u?d.text.dynamicLayoutVertexBuffer.updateData(Q):d.icon.dynamicLayoutVertexBuffer.updateData(Q)}function kr(d,n,o,u,p,v,w,E,C,A,L,z,U){const Q=E.glyphStartIndex+E.numGlyphs,H=E.lineStartIndex,Y=E.lineStartIndex+E.lineLength,se=n.getoffsetX(E.glyphStartIndex),de=n.getoffsetX(Q-1),Pe=B(d*se,o,u,p,v,w,E.segment,H,Y,C,A,L,z,U);if(!Pe)return null;const ie=B(d*de,o,u,p,v,w,E.segment,H,Y,C,A,L,z,U);return ie?{first:Pe,last:ie}:null}function ss(d,n,o,u){return d===a.WritingMode.horizontal&&Math.abs(o.y-n.y)>Math.abs(o.x-n.x)*u?{useVertical:!0}:(d===a.WritingMode.vertical?n.y<o.y:n.x>o.x)?{needsFlipping:!0}:null}function Ti(d,n,o,u,p,v,w,E,C,A,L,z,U,Q,H,Y){const se=n/24,de=d.lineOffsetX*se,Pe=d.lineOffsetY*se;let ie;if(d.numGlyphs>1){const Te=d.glyphStartIndex+d.numGlyphs,De=d.lineStartIndex,Ye=d.lineStartIndex+d.lineLength,it=kr(se,E,de,Pe,o,L,z,d,C,v,U,H,Y);if(!it)return{notEnoughRoom:!0};const ct=dn(it.first.point,w,Y).point,et=dn(it.last.point,w,Y).point;if(u&&!o){const bt=ss(d.writingMode,ct,et,Q);if(bt)return bt}ie=[it.first];for(let bt=d.glyphStartIndex+1;bt<Te-1;bt++)ie.push(B(se*E.getoffsetX(bt),de,Pe,o,L,z,d.segment,De,Ye,C,v,U,H,Y));ie.push(it.last)}else{if(u&&!o){const De=dn(z,p,Y).point,Ye=d.lineStartIndex+d.segment+1,it=new a.Point(C.getx(Ye),C.gety(Ye)),ct=dn(it,p,Y),et=ct.signedDistanceFromCamera>0?ct.point:Rn(z,it,De,1,p,Y),bt=ss(d.writingMode,De,et,Q);if(bt)return bt}const Te=B(se*E.getoffsetX(d.glyphStartIndex),de,Pe,o,L,z,d.segment,d.lineStartIndex,d.lineStartIndex+d.lineLength,C,v,U,H,Y);if(!Te)return{notEnoughRoom:!0};ie=[Te]}for(const Te of ie)a.addDynamicAttributes(A,Te.point,Te.angle);return{}}function Rn(d,n,o,u,p,v){const w=dn(d.add(d.sub(n)._unit()),p,v).point,E=o.sub(w);return o.add(E._mult(u/E.mag()))}function Uo(d,n){const{projectionCache:o,lineVertexArray:u,labelPlaneMatrix:p,tileAnchorPoint:v,distanceFromAnchor:w,getElevation:E,previousVertex:C,direction:A,absOffsetX:L}=n;if(o.projections[d])return o.projections[d];const z=new a.Point(u.getx(d),u.gety(d)),U=dn(z,p,E);if(U.signedDistanceFromCamera>0)return o.projections[d]=U.point,U.point;const Q=d-A;return Rn(w===0?v:new a.Point(u.getx(Q),u.gety(Q)),z,C,L-w+1,p,E)}function jr(d,n,o){return d._unit()._perp()._mult(n*o)}function te(d,n,o,u,p,v,w,E){const{projectionCache:C,direction:A}=E;if(C.offsets[d])return C.offsets[d];const L=o.add(n);if(d+A<u||d+A>=p)return C.offsets[d]=L,L;const z=Uo(d+A,E),U=jr(z.sub(o),w,A),Q=o.add(U),H=z.add(U);return C.offsets[d]=a.findLineIntersection(v,L,Q,H)||L,C.offsets[d]}function B(d,n,o,u,p,v,w,E,C,A,L,z,U,Q){const H=u?d-n:d+n;let Y=H>0?1:-1,se=0;u&&(Y*=-1,se=Math.PI),Y<0&&(se+=Math.PI);let de,Pe,ie=Y>0?E+w:E+w+1,Te=p,De=p,Ye=0,it=0;const ct=Math.abs(H),et=[];let bt;for(;Ye+it<=ct;){if(ie+=Y,ie<E||ie>=C)return null;Ye+=it,De=Te,Pe=de;const pt={projectionCache:z,lineVertexArray:A,labelPlaneMatrix:L,tileAnchorPoint:v,distanceFromAnchor:Ye,getElevation:Q,previousVertex:De,direction:Y,absOffsetX:ct};if(Te=Uo(ie,pt),o===0)et.push(De),bt=Te.sub(De);else{let Zt;const St=Te.sub(De);Zt=St.mag()===0?jr(Uo(ie+Y,pt).sub(Te),o,Y):jr(St,o,Y),Pe||(Pe=De.add(Zt)),de=te(ie,Zt,Te,E,C,Pe,o,pt),et.push(Pe),bt=de.sub(Pe)}it=bt.mag()}const Ot=bt._mult((ct-Ye)/it)._add(Pe||De),Jt=se+Math.atan2(Te.y-De.y,Te.x-De.x);return et.push(Ot),{point:Ot,angle:U?Jt:0,path:et}}const V=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function W(d,n){for(let o=0;o<d;o++){const u=n.length;n.resize(u+4),n.float32.set(V,3*u)}}function oe(d,n,o){const u=n[0],p=n[1];return d[0]=o[0]*u+o[4]*p+o[12],d[1]=o[1]*u+o[5]*p+o[13],d[3]=o[3]*u+o[7]*p+o[15],d}const le=100;class ge{constructor(n,o=new $t(n.width+200,n.height+200,25),u=new $t(n.width+200,n.height+200,25)){this.transform=n,this.grid=o,this.ignoredGrid=u,this.pitchfactor=Math.cos(n._pitch)*n.cameraToCenterDistance,this.screenRightBoundary=n.width+le,this.screenBottomBoundary=n.height+le,this.gridRightBoundary=n.width+200,this.gridBottomBoundary=n.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(n,o,u,p,v,w){const E=this.projectAndGetPerspectiveRatio(p,n.anchorPointX,n.anchorPointY,w),C=u*E.perspectiveRatio,A=n.x1*C+E.point.x,L=n.y1*C+E.point.y,z=n.x2*C+E.point.x,U=n.y2*C+E.point.y;return!this.isInsideGrid(A,L,z,U)||o!=="always"&&this.grid.hitTest(A,L,z,U,o,v)||E.perspectiveRatio<this.perspectiveRatioCutoff?{box:[],offscreen:!1}:{box:[A,L,z,U],offscreen:this.isOffscreen(A,L,z,U)}}placeCollisionCircles(n,o,u,p,v,w,E,C,A,L,z,U,Q,H){const Y=[],se=new a.Point(o.anchorX,o.anchorY),de=dn(se,w,H),Pe=Lt(this.transform.cameraToCenterDistance,de.signedDistanceFromCamera),ie=(L?v/Pe:v*Pe)/a.ONE_EM,Te=dn(se,E,H).point,De=kr(ie,p,o.lineOffsetX*ie,o.lineOffsetY*ie,!1,Te,se,o,u,E,{projections:{},offsets:{}},!1,H);let Ye=!1,it=!1,ct=!0;if(De){const et=.5*U*Pe+Q,bt=new a.Point(-100,-100),Ot=new a.Point(this.screenRightBoundary,this.screenBottomBoundary),Jt=new Mn,pt=De.first,Zt=De.last;let St=[];for(let vn=pt.path.length-1;vn>=1;vn--)St.push(pt.path[vn]);for(let vn=1;vn<Zt.path.length;vn++)St.push(Zt.path[vn]);const _n=2.5*et;if(C){const vn=St.map(tn=>dn(tn,C,H));St=vn.some(tn=>tn.signedDistanceFromCamera<=0)?[]:vn.map(tn=>tn.point)}let ii=[];if(St.length>0){const vn=St[0].clone(),tn=St[0].clone();for(let Jn=1;Jn<St.length;Jn++)vn.x=Math.min(vn.x,St[Jn].x),vn.y=Math.min(vn.y,St[Jn].y),tn.x=Math.max(tn.x,St[Jn].x),tn.y=Math.max(tn.y,St[Jn].y);ii=vn.x>=bt.x&&tn.x<=Ot.x&&vn.y>=bt.y&&tn.y<=Ot.y?[St]:tn.x<bt.x||vn.x>Ot.x||tn.y<bt.y||vn.y>Ot.y?[]:a.clipLine([St],bt.x,bt.y,Ot.x,Ot.y)}for(const vn of ii){Jt.reset(vn,.25*et);let tn=0;tn=Jt.length<=.5*et?1:Math.ceil(Jt.paddedLength/_n)+1;for(let Jn=0;Jn<tn;Jn++){const $i=Jn/Math.max(tn-1,1),ri=Jt.lerp($i),xi=ri.x+le,rr=ri.y+le;Y.push(xi,rr,et,0);const Dr=xi-et,zr=rr-et,Ui=xi+et,Kr=rr+et;if(ct=ct&&this.isOffscreen(Dr,zr,Ui,Kr),it=it||this.isInsideGrid(Dr,zr,Ui,Kr),n!=="always"&&this.grid.hitTestCircle(xi,rr,et,n,z)&&(Ye=!0,!A))return{circles:[],offscreen:!1,collisionDetected:Ye}}}}return{circles:!A&&Ye||!it||Pe<this.perspectiveRatioCutoff?[]:Y,offscreen:ct,collisionDetected:Ye}}queryRenderedSymbols(n){if(n.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const o=[];let u=1/0,p=1/0,v=-1/0,w=-1/0;for(const L of n){const z=new a.Point(L.x+le,L.y+le);u=Math.min(u,z.x),p=Math.min(p,z.y),v=Math.max(v,z.x),w=Math.max(w,z.y),o.push(z)}const E=this.grid.query(u,p,v,w).concat(this.ignoredGrid.query(u,p,v,w)),C={},A={};for(const L of E){const z=L.key;if(C[z.bucketInstanceId]===void 0&&(C[z.bucketInstanceId]={}),C[z.bucketInstanceId][z.featureIndex])continue;const U=[new a.Point(L.x1,L.y1),new a.Point(L.x2,L.y1),new a.Point(L.x2,L.y2),new a.Point(L.x1,L.y2)];a.polygonIntersectsPolygon(o,U)&&(C[z.bucketInstanceId][z.featureIndex]=!0,A[z.bucketInstanceId]===void 0&&(A[z.bucketInstanceId]=[]),A[z.bucketInstanceId].push(z.featureIndex))}return A}insertCollisionBox(n,o,u,p,v,w){(u?this.ignoredGrid:this.grid).insert({bucketInstanceId:p,featureIndex:v,collisionGroupID:w,overlapMode:o},n[0],n[1],n[2],n[3])}insertCollisionCircles(n,o,u,p,v,w){const E=u?this.ignoredGrid:this.grid,C={bucketInstanceId:p,featureIndex:v,collisionGroupID:w,overlapMode:o};for(let A=0;A<n.length;A+=4)E.insertCircle(C,n[A],n[A+1],n[A+2])}projectAndGetPerspectiveRatio(n,o,u,p){let v;return p?(v=[o,u,p(o,u),1],a.transformMat4(v,v,n)):(v=[o,u,0,1],oe(v,v,n)),{point:new a.Point((v[0]/v[3]+1)/2*this.transform.width+le,(-v[1]/v[3]+1)/2*this.transform.height+le),perspectiveRatio:.5+this.transform.cameraToCenterDistance/v[3]*.5}}isOffscreen(n,o,u,p){return u<le||n>=this.screenRightBoundary||p<le||o>this.screenBottomBoundary}isInsideGrid(n,o,u,p){return u>=0&&n<this.gridRightBoundary&&p>=0&&o<this.gridBottomBoundary}getViewportMatrix(){const n=a.identity([]);return a.translate(n,n,[-100,-100,0]),n}}function he(d,n,o){return n*(a.EXTENT/(d.tileSize*Math.pow(2,o-d.tileID.overscaledZ)))}class ce{constructor(n,o,u,p){this.opacity=n?Math.max(0,Math.min(1,n.opacity+(n.placed?o:-o))):p&&u?1:0,this.placed=u}isHidden(){return this.opacity===0&&!this.placed}}class xe{constructor(n,o,u,p,v){this.text=new ce(n?n.text:null,o,u,v),this.icon=new ce(n?n.icon:null,o,p,v)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class We{constructor(n,o,u){this.text=n,this.icon=o,this.skipFade=u}}class Ke{constructor(){this.invProjMatrix=a.create(),this.viewportMatrix=a.create(),this.circles=[]}}class Xe{constructor(n,o,u,p,v){this.bucketInstanceId=n,this.featureIndex=o,this.sourceLayerIndex=u,this.bucketIndex=p,this.tileID=v}}class Ut{constructor(n){this.crossSourceCollisions=n,this.maxGroupID=0,this.collisionGroups={}}get(n){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[n]){const o=++this.maxGroupID;this.collisionGroups[n]={ID:o,predicate:u=>u.collisionGroupID===o}}return this.collisionGroups[n]}}function Yt(d,n,o,u,p){const{horizontalAlign:v,verticalAlign:w}=a.getAnchorAlignment(d),E=-(v-.5)*n,C=-(w-.5)*o,A=a.evaluateVariableOffset(d,u);return new a.Point(E+A[0]*p,C+A[1]*p)}function Pt(d,n,o,u,p,v){const{x1:w,x2:E,y1:C,y2:A,anchorPointX:L,anchorPointY:z}=d,U=new a.Point(n,o);return u&&U._rotate(p?v:-v),{x1:w+U.x,y1:C+U.y,x2:E+U.x,y2:A+U.y,anchorPointX:L,anchorPointY:z}}class Ft{constructor(n,o,u,p,v){this.transform=n.clone(),this.terrain=o,this.collisionIndex=new ge(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=u,this.retainedQueryData={},this.collisionGroups=new Ut(p),this.collisionCircleArrays={},this.prevPlacement=v,v&&(v.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(n,o,u,p){const v=u.getBucket(o),w=u.latestFeatureIndex;if(!v||!w||o.id!==v.layerIds[0])return;const E=u.collisionBoxArray,C=v.layers[0].layout,A=Math.pow(2,this.transform.zoom-u.tileID.overscaledZ),L=u.tileSize/a.EXTENT,z=this.transform.calculatePosMatrix(u.tileID.toUnwrapped()),U=C.get("text-pitch-alignment")==="map",Q=C.get("text-rotation-alignment")==="map",H=he(u,1,this.transform.zoom),Y=Nt(z,U,Q,this.transform,H);let se=null;if(U){const Pe=kn(z,U,Q,this.transform,H);se=a.multiply([],this.transform.labelPlaneMatrix,Pe)}this.retainedQueryData[v.bucketInstanceId]=new Xe(v.bucketInstanceId,w,v.sourceLayerIndex,v.index,u.tileID);const de={bucket:v,layout:C,posMatrix:z,textLabelPlaneMatrix:Y,labelToScreenMatrix:se,scale:A,textPixelRatio:L,holdingForFade:u.holdingForFade(),collisionBoxArray:E,partiallyEvaluatedTextSize:a.evaluateSizeForZoom(v.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(v.sourceID)};if(p)for(const Pe of v.sortKeyRanges){const{sortKey:ie,symbolInstanceStart:Te,symbolInstanceEnd:De}=Pe;n.push({sortKey:ie,symbolInstanceStart:Te,symbolInstanceEnd:De,parameters:de})}else n.push({symbolInstanceStart:0,symbolInstanceEnd:v.symbolInstances.length,parameters:de})}attemptAnchorPlacement(n,o,u,p,v,w,E,C,A,L,z,U,Q,H,Y,se){const de=[U.textOffset0,U.textOffset1],Pe=Yt(n,u,p,de,v),ie=this.collisionIndex.placeCollisionBox(Pt(o,Pe.x,Pe.y,w,E,this.transform.angle),z,C,A,L.predicate,se);if((!Y||this.collisionIndex.placeCollisionBox(Pt(Y,Pe.x,Pe.y,w,E,this.transform.angle),z,C,A,L.predicate,se).box.length!==0)&&ie.box.length>0){let Te;if(this.prevPlacement&&this.prevPlacement.variableOffsets[U.crossTileID]&&this.prevPlacement.placements[U.crossTileID]&&this.prevPlacement.placements[U.crossTileID].text&&(Te=this.prevPlacement.variableOffsets[U.crossTileID].anchor),U.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[U.crossTileID]={textOffset:de,width:u,height:p,anchor:n,textBoxScale:v,prevAnchor:Te},this.markUsedJustification(Q,n,U,H),Q.allowVerticalPlacement&&(this.markUsedOrientation(Q,H,U),this.placedOrientations[U.crossTileID]=H),{shift:Pe,placedGlyphBoxes:ie}}}placeLayerBucketPart(n,o,u){const{bucket:p,layout:v,posMatrix:w,textLabelPlaneMatrix:E,labelToScreenMatrix:C,textPixelRatio:A,holdingForFade:L,collisionBoxArray:z,partiallyEvaluatedTextSize:U,collisionGroup:Q}=n.parameters,H=v.get("text-optional"),Y=v.get("icon-optional"),se=a.getOverlapMode(v,"text-overlap","text-allow-overlap"),de=se==="always",Pe=a.getOverlapMode(v,"icon-overlap","icon-allow-overlap"),ie=Pe==="always",Te=v.get("text-rotation-alignment")==="map",De=v.get("text-pitch-alignment")==="map",Ye=v.get("icon-text-fit")!=="none",it=v.get("symbol-z-order")==="viewport-y",ct=de&&(ie||!p.hasIconData()||Y),et=ie&&(de||!p.hasTextData()||H);!p.collisionArrays&&z&&p.deserializeCollisionBoxes(z);const bt=this.retainedQueryData[p.bucketInstanceId].tileID,Ot=this.terrain?(pt,Zt)=>this.terrain.getElevation(bt,pt,Zt):null,Jt=(pt,Zt)=>{if(o[pt.crossTileID])return;if(L)return void(this.placements[pt.crossTileID]=new We(!1,!1,!1));let St=!1,_n=!1,ii=!0,vn=null,tn={box:null,offscreen:null},Jn={box:null,offscreen:null},$i=null,ri=null,xi=null,rr=0,Dr=0,zr=0;Zt.textFeatureIndex?rr=Zt.textFeatureIndex:pt.useRuntimeCollisionCircles&&(rr=pt.featureIndex),Zt.verticalTextFeatureIndex&&(Dr=Zt.verticalTextFeatureIndex);const Ui=Zt.textBox;if(Ui){const Di=Cn=>{let mi=a.WritingMode.horizontal;if(p.allowVerticalPlacement&&!Cn&&this.prevPlacement){const wi=this.prevPlacement.placedOrientations[pt.crossTileID];wi&&(this.placedOrientations[pt.crossTileID]=wi,mi=wi,this.markUsedOrientation(p,mi,pt))}return mi},bi=(Cn,mi)=>{if(p.allowVerticalPlacement&&pt.numVerticalGlyphVertices>0&&Zt.verticalTextBox){for(const wi of p.writingModes)if(wi===a.WritingMode.vertical?(tn=mi(),Jn=tn):tn=Cn(),tn&&tn.box&&tn.box.length)break}else tn=Cn()};if(v.get("text-variable-anchor")){let Cn=v.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[pt.crossTileID]){const Tn=this.prevPlacement.variableOffsets[pt.crossTileID];Cn.indexOf(Tn.anchor)>0&&(Cn=Cn.filter(gi=>gi!==Tn.anchor),Cn.unshift(Tn.anchor))}const mi=(Tn,gi,sr)=>{const hl=Tn.x2-Tn.x1,cs=Tn.y2-Tn.y1,bf=pt.textBoxScale,Sh=Ye&&Pe==="never"?gi:null;let On={box:[],offscreen:!1};const Lc=se!=="never"?2*Cn.length:Cn.length;for(let oa=0;oa<Lc;++oa){const us=this.attemptAnchorPlacement(Cn[oa%Cn.length],Tn,hl,cs,bf,Te,De,A,w,Q,oa>=Cn.length?se:"never",pt,p,sr,Sh,Ot);if(us&&(On=us.placedGlyphBoxes,On&&On.box&&On.box.length)){St=!0,vn=us.shift;break}}return On};bi(()=>mi(Ui,Zt.iconBox,a.WritingMode.horizontal),()=>{const Tn=Zt.verticalTextBox;return p.allowVerticalPlacement&&!(tn&&tn.box&&tn.box.length)&&pt.numVerticalGlyphVertices>0&&Tn?mi(Tn,Zt.verticalIconBox,a.WritingMode.vertical):{box:null,offscreen:null}}),tn&&(St=tn.box,ii=tn.offscreen);const wi=Di(tn&&tn.box);if(!St&&this.prevPlacement){const Tn=this.prevPlacement.variableOffsets[pt.crossTileID];Tn&&(this.variableOffsets[pt.crossTileID]=Tn,this.markUsedJustification(p,Tn.anchor,pt,wi))}}else{const Cn=(mi,wi)=>{const Tn=this.collisionIndex.placeCollisionBox(mi,se,A,w,Q.predicate,Ot);return Tn&&Tn.box&&Tn.box.length&&(this.markUsedOrientation(p,wi,pt),this.placedOrientations[pt.crossTileID]=wi),Tn};bi(()=>Cn(Ui,a.WritingMode.horizontal),()=>{const mi=Zt.verticalTextBox;return p.allowVerticalPlacement&&pt.numVerticalGlyphVertices>0&&mi?Cn(mi,a.WritingMode.vertical):{box:null,offscreen:null}}),Di(tn&&tn.box&&tn.box.length)}}if($i=tn,St=$i&&$i.box&&$i.box.length>0,ii=$i&&$i.offscreen,pt.useRuntimeCollisionCircles){const Di=p.text.placedSymbolArray.get(pt.centerJustifiedTextSymbolIndex),bi=a.evaluateSizeForFeature(p.textSizeData,U,Di),Cn=v.get("text-padding");ri=this.collisionIndex.placeCollisionCircles(se,Di,p.lineVertexArray,p.glyphOffsetArray,bi,w,E,C,u,De,Q.predicate,pt.collisionCircleDiameter,Cn,Ot),ri.circles.length&&ri.collisionDetected&&!u&&a.warnOnce("Collisions detected, but collision boxes are not shown"),St=de||ri.circles.length>0&&!ri.collisionDetected,ii=ii&&ri.offscreen}if(Zt.iconFeatureIndex&&(zr=Zt.iconFeatureIndex),Zt.iconBox){const Di=bi=>{const Cn=Ye&&vn?Pt(bi,vn.x,vn.y,Te,De,this.transform.angle):bi;return this.collisionIndex.placeCollisionBox(Cn,Pe,A,w,Q.predicate,Ot)};Jn&&Jn.box&&Jn.box.length&&Zt.verticalIconBox?(xi=Di(Zt.verticalIconBox),_n=xi.box.length>0):(xi=Di(Zt.iconBox),_n=xi.box.length>0),ii=ii&&xi.offscreen}const Kr=H||pt.numHorizontalGlyphVertices===0&&pt.numVerticalGlyphVertices===0,sa=Y||pt.numIconVertices===0;if(Kr||sa?sa?Kr||(_n=_n&&St):St=_n&&St:_n=St=_n&&St,St&&$i&&$i.box&&this.collisionIndex.insertCollisionBox($i.box,se,v.get("text-ignore-placement"),p.bucketInstanceId,Jn&&Jn.box&&Dr?Dr:rr,Q.ID),_n&&xi&&this.collisionIndex.insertCollisionBox(xi.box,Pe,v.get("icon-ignore-placement"),p.bucketInstanceId,zr,Q.ID),ri&&(St&&this.collisionIndex.insertCollisionCircles(ri.circles,se,v.get("text-ignore-placement"),p.bucketInstanceId,rr,Q.ID),u)){const Di=p.bucketInstanceId;let bi=this.collisionCircleArrays[Di];bi===void 0&&(bi=this.collisionCircleArrays[Di]=new Ke);for(let Cn=0;Cn<ri.circles.length;Cn+=4)bi.circles.push(ri.circles[Cn+0]),bi.circles.push(ri.circles[Cn+1]),bi.circles.push(ri.circles[Cn+2]),bi.circles.push(ri.collisionDetected?1:0)}if(pt.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");if(p.bucketInstanceId===0)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[pt.crossTileID]=new We(St||ct,_n||et,ii||p.justReloaded),o[pt.crossTileID]=!0};if(it){if(n.symbolInstanceStart!==0)throw new Error("bucket.bucketInstanceId should be 0");const pt=p.getSortedSymbolIndexes(this.transform.angle);for(let Zt=pt.length-1;Zt>=0;--Zt){const St=pt[Zt];Jt(p.symbolInstances.get(St),p.collisionArrays[St])}}else for(let pt=n.symbolInstanceStart;pt<n.symbolInstanceEnd;pt++)Jt(p.symbolInstances.get(pt),p.collisionArrays[pt]);if(u&&p.bucketInstanceId in this.collisionCircleArrays){const pt=this.collisionCircleArrays[p.bucketInstanceId];a.invert(pt.invProjMatrix,w),pt.viewportMatrix=this.collisionIndex.getViewportMatrix()}p.justReloaded=!1}markUsedJustification(n,o,u,p){let v;v=p===a.WritingMode.vertical?u.verticalPlacedTextSymbolIndex:{left:u.leftJustifiedTextSymbolIndex,center:u.centerJustifiedTextSymbolIndex,right:u.rightJustifiedTextSymbolIndex}[a.getAnchorJustification(o)];const w=[u.leftJustifiedTextSymbolIndex,u.centerJustifiedTextSymbolIndex,u.rightJustifiedTextSymbolIndex,u.verticalPlacedTextSymbolIndex];for(const E of w)E>=0&&(n.text.placedSymbolArray.get(E).crossTileID=v>=0&&E!==v?0:u.crossTileID)}markUsedOrientation(n,o,u){const p=o===a.WritingMode.horizontal||o===a.WritingMode.horizontalOnly?o:0,v=o===a.WritingMode.vertical?o:0,w=[u.leftJustifiedTextSymbolIndex,u.centerJustifiedTextSymbolIndex,u.rightJustifiedTextSymbolIndex];for(const E of w)n.text.placedSymbolArray.get(E).placedOrientation=p;u.verticalPlacedTextSymbolIndex&&(n.text.placedSymbolArray.get(u.verticalPlacedTextSymbolIndex).placedOrientation=v)}commit(n){this.commitTime=n,this.zoomAtLastRecencyCheck=this.transform.zoom;const o=this.prevPlacement;let u=!1;this.prevZoomAdjustment=o?o.zoomAdjustment(this.transform.zoom):0;const p=o?o.symbolFadeChange(n):1,v=o?o.opacities:{},w=o?o.variableOffsets:{},E=o?o.placedOrientations:{};for(const C in this.placements){const A=this.placements[C],L=v[C];L?(this.opacities[C]=new xe(L,p,A.text,A.icon),u=u||A.text!==L.text.placed||A.icon!==L.icon.placed):(this.opacities[C]=new xe(null,p,A.text,A.icon,A.skipFade),u=u||A.text||A.icon)}for(const C in v){const A=v[C];if(!this.opacities[C]){const L=new xe(A,p,!1,!1);L.isHidden()||(this.opacities[C]=L,u=u||A.text.placed||A.icon.placed)}}for(const C in w)this.variableOffsets[C]||!this.opacities[C]||this.opacities[C].isHidden()||(this.variableOffsets[C]=w[C]);for(const C in E)this.placedOrientations[C]||!this.opacities[C]||this.opacities[C].isHidden()||(this.placedOrientations[C]=E[C]);if(o&&o.lastPlacementChangeTime===void 0)throw new Error("Last placement time for previous placement is not defined");u?this.lastPlacementChangeTime=n:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=o?o.lastPlacementChangeTime:n)}updateLayerOpacities(n,o){const u={};for(const p of o){const v=p.getBucket(n);v&&p.latestFeatureIndex&&n.id===v.layerIds[0]&&this.updateBucketOpacities(v,u,p.collisionBoxArray)}}updateBucketOpacities(n,o,u){n.hasTextData()&&(n.text.opacityVertexArray.clear(),n.text.hasVisibleVertices=!1),n.hasIconData()&&(n.icon.opacityVertexArray.clear(),n.icon.hasVisibleVertices=!1),n.hasIconCollisionBoxData()&&n.iconCollisionBox.collisionVertexArray.clear(),n.hasTextCollisionBoxData()&&n.textCollisionBox.collisionVertexArray.clear();const p=n.layers[0].layout,v=new xe(null,0,!1,!1,!0),w=p.get("text-allow-overlap"),E=p.get("icon-allow-overlap"),C=p.get("text-variable-anchor"),A=p.get("text-rotation-alignment")==="map",L=p.get("text-pitch-alignment")==="map",z=p.get("icon-text-fit")!=="none",U=new xe(null,0,w&&(E||!n.hasIconData()||p.get("icon-optional")),E&&(w||!n.hasTextData()||p.get("text-optional")),!0);!n.collisionArrays&&u&&(n.hasIconCollisionBoxData()||n.hasTextCollisionBoxData())&&n.deserializeCollisionBoxes(u);const Q=(H,Y,se)=>{for(let de=0;de<Y/4;de++)H.opacityVertexArray.emplaceBack(se);H.hasVisibleVertices=H.hasVisibleVertices||se!==Ii};for(let H=0;H<n.symbolInstances.length;H++){const Y=n.symbolInstances.get(H),{numHorizontalGlyphVertices:se,numVerticalGlyphVertices:de,crossTileID:Pe}=Y;let ie=this.opacities[Pe];o[Pe]?ie=v:ie||(ie=U,this.opacities[Pe]=ie),o[Pe]=!0;const Te=Y.numIconVertices>0,De=this.placedOrientations[Y.crossTileID],Ye=De===a.WritingMode.vertical,it=De===a.WritingMode.horizontal||De===a.WritingMode.horizontalOnly;if(se>0||de>0){const ct=bs(ie.text);Q(n.text,se,Ye?Ii:ct),Q(n.text,de,it?Ii:ct);const et=ie.text.isHidden();[Y.rightJustifiedTextSymbolIndex,Y.centerJustifiedTextSymbolIndex,Y.leftJustifiedTextSymbolIndex].forEach(Jt=>{Jt>=0&&(n.text.placedSymbolArray.get(Jt).hidden=et||Ye?1:0)}),Y.verticalPlacedTextSymbolIndex>=0&&(n.text.placedSymbolArray.get(Y.verticalPlacedTextSymbolIndex).hidden=et||it?1:0);const bt=this.variableOffsets[Y.crossTileID];bt&&this.markUsedJustification(n,bt.anchor,Y,De);const Ot=this.placedOrientations[Y.crossTileID];Ot&&(this.markUsedJustification(n,"left",Y,Ot),this.markUsedOrientation(n,Ot,Y))}if(Te){const ct=bs(ie.icon),et=!(z&&Y.verticalPlacedIconSymbolIndex&&Ye);Y.placedIconSymbolIndex>=0&&(Q(n.icon,Y.numIconVertices,et?ct:Ii),n.icon.placedSymbolArray.get(Y.placedIconSymbolIndex).hidden=ie.icon.isHidden()),Y.verticalPlacedIconSymbolIndex>=0&&(Q(n.icon,Y.numVerticalIconVertices,et?Ii:ct),n.icon.placedSymbolArray.get(Y.verticalPlacedIconSymbolIndex).hidden=ie.icon.isHidden())}if(n.hasIconCollisionBoxData()||n.hasTextCollisionBoxData()){const ct=n.collisionArrays[H];if(ct){let et=new a.Point(0,0);if(ct.textBox||ct.verticalTextBox){let Ot=!0;if(C){const Jt=this.variableOffsets[Pe];Jt?(et=Yt(Jt.anchor,Jt.width,Jt.height,Jt.textOffset,Jt.textBoxScale),A&&et._rotate(L?this.transform.angle:-this.transform.angle)):Ot=!1}ct.textBox&&Xt(n.textCollisionBox.collisionVertexArray,ie.text.placed,!Ot||Ye,et.x,et.y),ct.verticalTextBox&&Xt(n.textCollisionBox.collisionVertexArray,ie.text.placed,!Ot||it,et.x,et.y)}const bt=!!(!it&&ct.verticalIconBox);ct.iconBox&&Xt(n.iconCollisionBox.collisionVertexArray,ie.icon.placed,bt,z?et.x:0,z?et.y:0),ct.verticalIconBox&&Xt(n.iconCollisionBox.collisionVertexArray,ie.icon.placed,!bt,z?et.x:0,z?et.y:0)}}}if(n.sortFeatures(this.transform.angle),this.retainedQueryData[n.bucketInstanceId]&&(this.retainedQueryData[n.bucketInstanceId].featureSortOrder=n.featureSortOrder),n.hasTextData()&&n.text.opacityVertexBuffer&&n.text.opacityVertexBuffer.updateData(n.text.opacityVertexArray),n.hasIconData()&&n.icon.opacityVertexBuffer&&n.icon.opacityVertexBuffer.updateData(n.icon.opacityVertexArray),n.hasIconCollisionBoxData()&&n.iconCollisionBox.collisionVertexBuffer&&n.iconCollisionBox.collisionVertexBuffer.updateData(n.iconCollisionBox.collisionVertexArray),n.hasTextCollisionBoxData()&&n.textCollisionBox.collisionVertexBuffer&&n.textCollisionBox.collisionVertexBuffer.updateData(n.textCollisionBox.collisionVertexArray),n.text.opacityVertexArray.length!==n.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${n.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${n.text.layoutVertexArray.length}) / 4`);if(n.icon.opacityVertexArray.length!==n.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${n.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${n.icon.layoutVertexArray.length}) / 4`);if(n.bucketInstanceId in this.collisionCircleArrays){const H=this.collisionCircleArrays[n.bucketInstanceId];n.placementInvProjMatrix=H.invProjMatrix,n.placementViewportMatrix=H.viewportMatrix,n.collisionCircleArray=H.circles,delete this.collisionCircleArrays[n.bucketInstanceId]}}symbolFadeChange(n){return this.fadeDuration===0?1:(n-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(n){return Math.max(0,(this.transform.zoom-n)/1.5)}hasTransitions(n){return this.stale||n-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(n,o){const u=this.zoomAtLastRecencyCheck===o?1-this.zoomAdjustment(o):1;return this.zoomAtLastRecencyCheck=o,this.commitTime+this.fadeDuration*u>n}setStale(){this.stale=!0}}function Xt(d,n,o,u,p){d.emplaceBack(n?1:0,o?1:0,u||0,p||0),d.emplaceBack(n?1:0,o?1:0,u||0,p||0),d.emplaceBack(n?1:0,o?1:0,u||0,p||0),d.emplaceBack(n?1:0,o?1:0,u||0,p||0)}const un=Math.pow(2,25),nn=Math.pow(2,24),gn=Math.pow(2,17),zn=Math.pow(2,16),ai=Math.pow(2,9),Ht=Math.pow(2,8),Xn=Math.pow(2,1);function bs(d){if(d.opacity===0&&!d.placed)return 0;if(d.opacity===1&&d.placed)return 4294967295;const n=d.placed?1:0,o=Math.floor(127*d.opacity);return o*un+n*nn+o*gn+n*zn+o*ai+n*Ht+o*Xn+n}const Ii=0;class tr{constructor(n){this._sortAcrossTiles=n.layout.get("symbol-z-order")!=="viewport-y"&&!n.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(n,o,u,p,v){const w=this._bucketParts;for(;this._currentTileIndex<n.length;)if(o.getBucketParts(w,p,n[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,v())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,w.sort((E,C)=>E.sortKey-C.sortKey));this._currentPartIndex<w.length;)if(o.placeLayerBucketPart(w[this._currentPartIndex],this._seenCrossTileIDs,u),this._currentPartIndex++,v())return!0;return!1}}class _r{constructor(n,o,u,p,v,w,E,C){this.placement=new Ft(n,o,w,E,C),this._currentPlacementIndex=u.length-1,this._forceFullPlacement=p,this._showCollisionBoxes=v,this._done=!1}isDone(){return this._done}continuePlacement(n,o,u){const p=a.exported.now(),v=()=>!this._forceFullPlacement&&a.exported.now()-p>2;for(;this._currentPlacementIndex>=0;){const w=o[n[this._currentPlacementIndex]],E=this.placement.collisionIndex.transform.zoom;if(w.type==="symbol"&&(!w.minzoom||w.minzoom<=E)&&(!w.maxzoom||w.maxzoom>E)){if(this._inProgressLayer||(this._inProgressLayer=new tr(w)),this._inProgressLayer.continuePlacement(u[w.source],this.placement,this._showCollisionBoxes,w,v))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(n){return this.placement.commit(n),this.placement}}const ao=512/a.EXTENT/2;class Ia{constructor(n,o,u){this.tileID=n,this.bucketInstanceId=u,this._symbolsByKey={};const p=new Map;for(let v=0;v<o.length;v++){const w=o.get(v),E=w.key,C=p.get(E);C?C.push(w):p.set(E,[w])}for(const[v,w]of p){const E={positions:w.map(C=>({x:Math.floor(C.anchorX*ao),y:Math.floor(C.anchorY*ao)})),crossTileIDs:w.map(C=>C.crossTileID)};if(E.positions.length>128){const C=new a.KDBush(E.positions.length,16,Uint16Array);for(const{x:A,y:L}of E.positions)C.add(A,L);C.finish(),delete E.positions,E.index=C}this._symbolsByKey[v]=E}}getScaledCoordinates(n,o){const{x:u,y:p,z:v}=this.tileID.canonical,{x:w,y:E,z:C}=o.canonical,A=ao/Math.pow(2,C-v),L=(E*a.EXTENT+n.anchorY)*A,z=p*a.EXTENT*ao;return{x:Math.floor((w*a.EXTENT+n.anchorX)*A-u*a.EXTENT*ao),y:Math.floor(L-z)}}findMatches(n,o,u){const p=this.tileID.canonical.z<o.canonical.z?1:Math.pow(2,this.tileID.canonical.z-o.canonical.z);for(let v=0;v<n.length;v++){const w=n.get(v);if(w.crossTileID)continue;const E=this._symbolsByKey[w.key];if(!E)continue;const C=this.getScaledCoordinates(w,o);if(E.index){const A=E.index.range(C.x-p,C.y-p,C.x+p,C.y+p).sort();for(const L of A){const z=E.crossTileIDs[L];if(!u[z]){u[z]=!0,w.crossTileID=z;break}}}else if(E.positions)for(let A=0;A<E.positions.length;A++){const L=E.positions[A],z=E.crossTileIDs[A];if(Math.abs(L.x-C.x)<=p&&Math.abs(L.y-C.y)<=p&&!u[z]){u[z]=!0,w.crossTileID=z;break}}}}getCrossTileIDsLists(){return Object.values(this._symbolsByKey).map(({crossTileIDs:n})=>n)}}class li{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class No{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(n){const o=Math.round((n-this.lng)/360);if(o!==0)for(const u in this.indexes){const p=this.indexes[u],v={};for(const w in p){const E=p[w];E.tileID=E.tileID.unwrapTo(E.tileID.wrap+o),v[E.tileID.key]=E}this.indexes[u]=v}this.lng=n}addBucket(n,o,u){if(this.indexes[n.overscaledZ]&&this.indexes[n.overscaledZ][n.key]){if(this.indexes[n.overscaledZ][n.key].bucketInstanceId===o.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(n.overscaledZ,this.indexes[n.overscaledZ][n.key])}for(let v=0;v<o.symbolInstances.length;v++)o.symbolInstances.get(v).crossTileID=0;this.usedCrossTileIDs[n.overscaledZ]||(this.usedCrossTileIDs[n.overscaledZ]={});const p=this.usedCrossTileIDs[n.overscaledZ];for(const v in this.indexes){const w=this.indexes[v];if(Number(v)>n.overscaledZ)for(const E in w){const C=w[E];C.tileID.isChildOf(n)&&C.findMatches(o.symbolInstances,n,p)}else{const E=w[n.scaledTo(Number(v)).key];E&&E.findMatches(o.symbolInstances,n,p)}}for(let v=0;v<o.symbolInstances.length;v++){const w=o.symbolInstances.get(v);w.crossTileID||(w.crossTileID=u.generate(),p[w.crossTileID]=!0)}return this.indexes[n.overscaledZ]===void 0&&(this.indexes[n.overscaledZ]={}),this.indexes[n.overscaledZ][n.key]=new Ia(n,o.symbolInstances,o.bucketInstanceId),!0}removeBucketCrossTileIDs(n,o){for(const u of o.getCrossTileIDsLists())for(const p of u)delete this.usedCrossTileIDs[n][p]}removeStaleBuckets(n){let o=!1;for(const u in this.indexes){const p=this.indexes[u];for(const v in p)n[p[v].bucketInstanceId]||(this.removeBucketCrossTileIDs(u,p[v]),delete p[v],o=!0)}return o}}class ws{constructor(){this.layerIndexes={},this.crossTileIDs=new li,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(n,o,u){let p=this.layerIndexes[n.id];p===void 0&&(p=this.layerIndexes[n.id]=new No);let v=!1;const w={};p.handleWrapJump(u);for(const E of o){const C=E.getBucket(n);C&&n.id===C.layerIds[0]&&(C.bucketInstanceId||(C.bucketInstanceId=++this.maxBucketInstanceId),p.addBucket(E.tileID,C,this.crossTileIDs)&&(v=!0),w[C.bucketInstanceId]=!0)}return p.removeStaleBuckets(w)&&(v=!0),v}pruneUnusedLayers(n){const o={};n.forEach(u=>{o[u]=!0});for(const u in this.layerIndexes)o[u]||delete this.layerIndexes[u]}}const ti=(d,n)=>a.emitValidationErrors(d,n&&n.filter(o=>o.identifier!=="source.canvas")),Aa=a.pick(a.operations,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setGlyphs","setSprite"]),Mr=a.pick(a.operations,["setCenter","setZoom","setBearing","setPitch"]),Uu=a.emptyStyle();class Ai extends a.Evented{constructor(n,o={}){super(),this.map=n,this.dispatcher=new It(hn(),this,n._getMapId()),this.imageManager=new _e,this.imageManager.setEventedParent(this),this.glyphManager=new je(n._requestManager,o.localIdeographFontFamily),this.lineAtlas=new rt(256,512),this.crossTileSymbolIndex=new ws,this._spritesImagesIds={},this._layers={},this._order=[],this.sourceCaches={},this.zoomHistory=new a.ZoomHistory,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("setReferrer",a.getReferrer());const u=this;this._rtlTextPluginCallback=Ai.registerForPluginStateChange(p=>{u.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:p.pluginStatus,pluginURL:p.pluginURL},(v,w)=>{if(a.triggerPluginCompletionEvent(v),w&&w.every(E=>E))for(const E in u.sourceCaches){const C=u.sourceCaches[E].getSource().type;C!=="vector"&&C!=="geojson"||u.sourceCaches[E].reload()}})}),this.on("data",p=>{if(p.dataType!=="source"||p.sourceDataType!=="metadata")return;const v=this.sourceCaches[p.sourceId];if(!v)return;const w=v.getSource();if(w&&w.vectorLayerIds)for(const E in this._layers){const C=this._layers[E];C.source===w.id&&this._validateLayer(C)}})}loadURL(n,o={},u){this.fire(new a.Event("dataloading",{dataType:"style"})),o.validate=typeof o.validate!="boolean"||o.validate;const p=this.map._requestManager.transformRequest(n,ye.Style);this._request=a.getJSON(p,(v,w)=>{this._request=null,v?this.fire(new a.ErrorEvent(v)):w&&this._load(w,o,u)})}loadJSON(n,o={},u){this.fire(new a.Event("dataloading",{dataType:"style"})),this._request=a.exported.frame(()=>{this._request=null,o.validate=o.validate!==!1,this._load(n,o,u)})}loadEmpty(){this.fire(new a.Event("dataloading",{dataType:"style"})),this._load(Uu,{validate:!1})}_load(n,o,u){const p=o.transformStyle?o.transformStyle(u,n):n;if(!o.validate||!ti(this,a.validateStyle(p))){this._loaded=!0,this.stylesheet=p;for(const v in p.sources)this.addSource(v,p.sources[v],{validate:!1});p.sprite?this._loadSprite(p.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(p.glyphs),this._createLayers(),this.light=new At(this.stylesheet.light),this.map.setTerrain(this.stylesheet.terrain),this.fire(new a.Event("data",{dataType:"style"})),this.fire(new a.Event("style.load"))}}_createLayers(){const n=a.derefLayers(this.stylesheet.layers);this.dispatcher.broadcast("setLayers",n),this._order=n.map(o=>o.id),this._layers={},this._serializedLayers=null;for(const o of n){const u=a.createStyleLayer(o);u.setEventedParent(this,{layer:{id:o.id}}),this._layers[o.id]=u}}_loadSprite(n,o=!1,u=void 0){this.imageManager.setLoaded(!1),this._spriteRequest=function(p,v,w,E){const C=G(p),A=C.length,L=w>1?"@2x":"",z={},U={},Q={};for(const{id:H,url:Y}of C){const se=v.transformRequest(v.normalizeSpriteURL(Y,L,".json"),ye.SpriteJSON),de=`${H}_${se.url}`;z[de]=a.getJSON(se,(Te,De)=>{delete z[de],U[H]=De,pe(E,U,Q,Te,A)});const Pe=v.transformRequest(v.normalizeSpriteURL(Y,L,".png"),ye.SpriteImage),ie=`${H}_${Pe.url}`;z[ie]=Ee.getImage(Pe,(Te,De)=>{delete z[ie],Q[H]=De,pe(E,U,Q,Te,A)})}return{cancel(){for(const H of Object.values(z))H.cancel()}}}(n,this.map._requestManager,this.map.getPixelRatio(),(p,v)=>{if(this._spriteRequest=null,p)this.fire(new a.ErrorEvent(p));else if(v)for(const w in v){this._spritesImagesIds[w]=[];const E=this._spritesImagesIds[w]?this._spritesImagesIds[w].filter(C=>!(C in v)):[];for(const C of E)this.imageManager.removeImage(C),this._changedImages[C]=!0;for(const C in v[w]){const A=w==="default"?C:`${w}:${C}`;this._spritesImagesIds[w].push(A),A in this.imageManager.images?this.imageManager.updateImage(A,v[w][C],!1):this.imageManager.addImage(A,v[w][C]),o&&(this._changedImages[A]=!0)}}this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),o&&(this._changed=!0),this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new a.Event("data",{dataType:"style"})),u&&u(p)})}_unloadSprite(){for(const n of Object.values(this._spritesImagesIds).flat())this.imageManager.removeImage(n),this._changedImages[n]=!0;this._spritesImagesIds={},this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new a.Event("data",{dataType:"style"}))}_validateLayer(n){const o=this.sourceCaches[n.source];if(!o)return;const u=n.sourceLayer;if(!u)return;const p=o.getSource();(p.type==="geojson"||p.vectorLayerIds&&p.vectorLayerIds.indexOf(u)===-1)&&this.fire(new a.ErrorEvent(new Error(`Source layer "${u}" does not exist on source "${p.id}" as specified by style layer "${n.id}".`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const n in this.sourceCaches)if(!this.sourceCaches[n].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeByIds(n){const o=this._serializedAllLayers();if(!n||n.length===0)return Object.values(o);const u=[];for(const p of n)o[p]&&u.push(o[p]);return u}_serializedAllLayers(){let n=this._serializedLayers;if(n)return n;n=this._serializedLayers={};const o=Object.keys(this._layers);for(const u of o){const p=this._layers[u];p.type!=="custom"&&(n[u]=p.serialize())}return n}hasTransitions(){if(this.light&&this.light.hasTransition())return!0;for(const n in this.sourceCaches)if(this.sourceCaches[n].hasTransition())return!0;for(const n in this._layers)if(this._layers[n].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(n){if(!this._loaded)return;const o=this._changed;if(this._changed){const p=Object.keys(this._updatedLayers),v=Object.keys(this._removedLayers);(p.length||v.length)&&this._updateWorkerLayers(p,v);for(const w in this._updatedSources){const E=this._updatedSources[w];if(E==="reload")this._reloadSource(w);else{if(E!=="clear")throw new Error(`Invalid action ${E}`);this._clearSource(w)}}this._updateTilesForChangedImages(),this._updateTilesForChangedGlyphs();for(const w in this._updatedPaintProps)this._layers[w].updateTransitions(n);this.light.updateTransitions(n),this._resetUpdates()}const u={};for(const p in this.sourceCaches){const v=this.sourceCaches[p];u[p]=v.used,v.used=!1}for(const p of this._order){const v=this._layers[p];v.recalculate(n,this._availableImages),!v.isHidden(n.zoom)&&v.source&&(this.sourceCaches[v.source].used=!0)}for(const p in u){const v=this.sourceCaches[p];u[p]!==v.used&&v.fire(new a.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:p}))}this.light.recalculate(n),this.z=n.zoom,o&&this.fire(new a.Event("data",{dataType:"style"}))}_updateTilesForChangedImages(){const n=Object.keys(this._changedImages);if(n.length){for(const o in this.sourceCaches)this.sourceCaches[o].reloadTilesForDependencies(["icons","patterns"],n);this._changedImages={}}}_updateTilesForChangedGlyphs(){if(this._glyphsDidChange){for(const n in this.sourceCaches)this.sourceCaches[n].reloadTilesForDependencies(["glyphs"],[""]);this._glyphsDidChange=!1}}_updateWorkerLayers(n,o){this.dispatcher.broadcast("updateLayers",{layers:this._serializeByIds(n),removedIds:o})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={},this._glyphsDidChange=!1}setState(n,o={}){this._checkLoaded();const u=this.serialize();if(n=o.transformStyle?o.transformStyle(u,n):n,ti(this,a.validateStyle(n)))return!1;(n=a.clone$1(n)).layers=a.derefLayers(n.layers);const p=a.diffStyles(u,n).filter(w=>!(w.command in Mr));if(p.length===0)return!1;const v=p.filter(w=>!(w.command in Aa));if(v.length>0)throw new Error(`Unimplemented: ${v.map(w=>w.command).join(", ")}.`);for(const w of p)w.command!=="setTransition"&&this[w.command].apply(this,w.args);return this.stylesheet=n,!0}addImage(n,o){if(this.getImage(n))return this.fire(new a.ErrorEvent(new Error(`An image named "${n}" already exists.`)));this.imageManager.addImage(n,o),this._afterImageUpdated(n)}updateImage(n,o){this.imageManager.updateImage(n,o)}getImage(n){return this.imageManager.getImage(n)}removeImage(n){if(!this.getImage(n))return this.fire(new a.ErrorEvent(new Error(`An image named "${n}" does not exist.`)));this.imageManager.removeImage(n),this._afterImageUpdated(n)}_afterImageUpdated(n){this._availableImages=this.imageManager.listImages(),this._changedImages[n]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new a.Event("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(n,o,u={}){if(this._checkLoaded(),this.sourceCaches[n]!==void 0)throw new Error(`Source "${n}" already exists.`);if(!o.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(o).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(o.type)>=0&&this._validate(a.validateStyle.source,`sources.${n}`,o,null,u))return;this.map&&this.map._collectResourceTiming&&(o.collectResourceTiming=!0);const p=this.sourceCaches[n]=new lt(n,o,this.dispatcher);p.style=this,p.setEventedParent(this,()=>({isSourceLoaded:p.loaded(),source:p.serialize(),sourceId:n})),p.onAdd(this.map),this._changed=!0}removeSource(n){if(this._checkLoaded(),this.sourceCaches[n]===void 0)throw new Error("There is no source with this ID");for(const u in this._layers)if(this._layers[u].source===n)return this.fire(new a.ErrorEvent(new Error(`Source "${n}" cannot be removed while layer "${u}" is using it.`)));const o=this.sourceCaches[n];delete this.sourceCaches[n],delete this._updatedSources[n],o.fire(new a.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:n})),o.setEventedParent(null),o.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(n,o){if(this._checkLoaded(),this.sourceCaches[n]===void 0)throw new Error(`There is no source with this ID=${n}`);const u=this.sourceCaches[n].getSource();if(u.type!=="geojson")throw new Error(`geojsonSource.type is ${u.type}, which is !== 'geojson`);u.setData(o),this._changed=!0}getSource(n){return this.sourceCaches[n]&&this.sourceCaches[n].getSource()}addLayer(n,o,u={}){this._checkLoaded();const p=n.id;if(this.getLayer(p))return void this.fire(new a.ErrorEvent(new Error(`Layer "${p}" already exists on this map.`)));let v;if(n.type==="custom"){if(ti(this,a.validateCustomStyleLayer(n)))return;v=a.createStyleLayer(n)}else{if(typeof n.source=="object"&&(this.addSource(p,n.source),n=a.clone$1(n),n=a.extend(n,{source:p})),this._validate(a.validateStyle.layer,`layers.${p}`,n,{arrayIndex:-1},u))return;v=a.createStyleLayer(n),this._validateLayer(v),v.setEventedParent(this,{layer:{id:p}})}const w=o?this._order.indexOf(o):this._order.length;if(o&&w===-1)this.fire(new a.ErrorEvent(new Error(`Cannot add layer "${p}" before non-existing layer "${o}".`)));else{if(this._order.splice(w,0,p),this._layerOrderChanged=!0,this._layers[p]=v,this._removedLayers[p]&&v.source&&v.type!=="custom"){const E=this._removedLayers[p];delete this._removedLayers[p],E.type!==v.type?this._updatedSources[v.source]="clear":(this._updatedSources[v.source]="reload",this.sourceCaches[v.source].pause())}this._updateLayer(v),v.onAdd&&v.onAdd(this.map)}}moveLayer(n,o){if(this._checkLoaded(),this._changed=!0,!this._layers[n])return void this.fire(new a.ErrorEvent(new Error(`The layer '${n}' does not exist in the map's style and cannot be moved.`)));if(n===o)return;const u=this._order.indexOf(n);this._order.splice(u,1);const p=o?this._order.indexOf(o):this._order.length;o&&p===-1?this.fire(new a.ErrorEvent(new Error(`Cannot move layer "${n}" before non-existing layer "${o}".`))):(this._order.splice(p,0,n),this._layerOrderChanged=!0)}removeLayer(n){this._checkLoaded();const o=this._layers[n];if(!o)return void this.fire(new a.ErrorEvent(new Error(`Cannot remove non-existing layer "${n}".`)));o.setEventedParent(null);const u=this._order.indexOf(n);this._order.splice(u,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[n]=o,delete this._layers[n],this._serializedLayers&&delete this._serializedLayers[n],delete this._updatedLayers[n],delete this._updatedPaintProps[n],o.onRemove&&o.onRemove(this.map)}getLayer(n){return this._layers[n]}hasLayer(n){return n in this._layers}setLayerZoomRange(n,o,u){this._checkLoaded();const p=this.getLayer(n);p?p.minzoom===o&&p.maxzoom===u||(o!=null&&(p.minzoom=o),u!=null&&(p.maxzoom=u),this._updateLayer(p)):this.fire(new a.ErrorEvent(new Error(`Cannot set the zoom range of non-existing layer "${n}".`)))}setFilter(n,o,u={}){this._checkLoaded();const p=this.getLayer(n);if(p){if(!a.deepEqual(p.filter,o))return o==null?(p.filter=void 0,void this._updateLayer(p)):void(this._validate(a.validateStyle.filter,`layers.${p.id}.filter`,o,null,u)||(p.filter=a.clone$1(o),this._updateLayer(p)))}else this.fire(new a.ErrorEvent(new Error(`Cannot filter non-existing layer "${n}".`)))}getFilter(n){return a.clone$1(this.getLayer(n).filter)}setLayoutProperty(n,o,u,p={}){this._checkLoaded();const v=this.getLayer(n);v?a.deepEqual(v.getLayoutProperty(o),u)||(v.setLayoutProperty(o,u,p),this._updateLayer(v)):this.fire(new a.ErrorEvent(new Error(`Cannot style non-existing layer "${n}".`)))}getLayoutProperty(n,o){const u=this.getLayer(n);if(u)return u.getLayoutProperty(o);this.fire(new a.ErrorEvent(new Error(`Cannot get style of non-existing layer "${n}".`)))}setPaintProperty(n,o,u,p={}){this._checkLoaded();const v=this.getLayer(n);v?a.deepEqual(v.getPaintProperty(o),u)||(v.setPaintProperty(o,u,p)&&this._updateLayer(v),this._changed=!0,this._updatedPaintProps[n]=!0):this.fire(new a.ErrorEvent(new Error(`Cannot style non-existing layer "${n}".`)))}getPaintProperty(n,o){return this.getLayer(n).getPaintProperty(o)}setFeatureState(n,o){this._checkLoaded();const u=n.source,p=n.sourceLayer,v=this.sourceCaches[u];if(v===void 0)return void this.fire(new a.ErrorEvent(new Error(`The source '${u}' does not exist in the map's style.`)));const w=v.getSource().type;w==="geojson"&&p?this.fire(new a.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):w!=="vector"||p?(n.id===void 0&&this.fire(new a.ErrorEvent(new Error("The feature id parameter must be provided."))),v.setFeatureState(p,n.id,o)):this.fire(new a.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(n,o){this._checkLoaded();const u=n.source,p=this.sourceCaches[u];if(p===void 0)return void this.fire(new a.ErrorEvent(new Error(`The source '${u}' does not exist in the map's style.`)));const v=p.getSource().type,w=v==="vector"?n.sourceLayer:void 0;v!=="vector"||w?o&&typeof n.id!="string"&&typeof n.id!="number"?this.fire(new a.ErrorEvent(new Error("A feature id is required to remove its specific state property."))):p.removeFeatureState(w,n.id,o):this.fire(new a.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(n){this._checkLoaded();const o=n.source,u=n.sourceLayer,p=this.sourceCaches[o];if(p!==void 0)return p.getSource().type!=="vector"||u?(n.id===void 0&&this.fire(new a.ErrorEvent(new Error("The feature id parameter must be provided."))),p.getFeatureState(u,n.id)):void this.fire(new a.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new a.ErrorEvent(new Error(`The source '${o}' does not exist in the map's style.`)))}getTransition(){return a.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){const n=a.mapObject(this.sourceCaches,p=>p.serialize()),o=this._serializeByIds(this._order),u=this.stylesheet;return a.filterObject({version:u.version,name:u.name,metadata:u.metadata,light:u.light,center:u.center,zoom:u.zoom,bearing:u.bearing,pitch:u.pitch,sprite:u.sprite,glyphs:u.glyphs,transition:u.transition,sources:n,layers:o},p=>p!==void 0)}_updateLayer(n){this._updatedLayers[n.id]=!0,n.source&&!this._updatedSources[n.source]&&this.sourceCaches[n.source].getSource().type!=="raster"&&(this._updatedSources[n.source]="reload",this.sourceCaches[n.source].pause()),this._serializedLayers=null,this._changed=!0}_flattenAndSortRenderedFeatures(n){const o=w=>this._layers[w].type==="fill-extrusion",u={},p=[];for(let w=this._order.length-1;w>=0;w--){const E=this._order[w];if(o(E)){u[E]=w;for(const C of n){const A=C[E];if(A)for(const L of A)p.push(L)}}}p.sort((w,E)=>E.intersectionZ-w.intersectionZ);const v=[];for(let w=this._order.length-1;w>=0;w--){const E=this._order[w];if(o(E))for(let C=p.length-1;C>=0;C--){const A=p[C].feature;if(u[A.layer.id]<w)break;v.push(A),p.pop()}else for(const C of n){const A=C[E];if(A)for(const L of A)v.push(L.feature)}}return v}queryRenderedFeatures(n,o,u){o&&o.filter&&this._validate(a.validateStyle.filter,"queryRenderedFeatures.filter",o.filter,null,o);const p={};if(o&&o.layers){if(!Array.isArray(o.layers))return this.fire(new a.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(const E of o.layers){const C=this._layers[E];if(!C)return this.fire(new a.ErrorEvent(new Error(`The layer '${E}' does not exist in the map's style and cannot be queried for features.`))),[];p[C.source]=!0}}const v=[];o.availableImages=this._availableImages;const w=this._serializedAllLayers();for(const E in this.sourceCaches)o.layers&&!p[E]||v.push(Re(this.sourceCaches[E],this._layers,w,n,o,u));return this.placement&&v.push(function(E,C,A,L,z,U,Q){const H={},Y=U.queryRenderedSymbols(L),se=[];for(const de of Object.keys(Y).map(Number))se.push(Q[de]);se.sort(Ze);for(const de of se){const Pe=de.featureIndex.lookupSymbolFeatures(Y[de.bucketInstanceId],C,de.bucketIndex,de.sourceLayerIndex,z.filter,z.layers,z.availableImages,E);for(const ie in Pe){const Te=H[ie]=H[ie]||[],De=Pe[ie];De.sort((Ye,it)=>{const ct=de.featureSortOrder;if(ct){const et=ct.indexOf(Ye.featureIndex);return ct.indexOf(it.featureIndex)-et}return it.featureIndex-Ye.featureIndex});for(const Ye of De)Te.push(Ye)}}for(const de in H)H[de].forEach(Pe=>{const ie=Pe.feature,Te=A[E[de].source].getFeatureState(ie.layer["source-layer"],ie.id);ie.source=ie.layer.source,ie.layer["source-layer"]&&(ie.sourceLayer=ie.layer["source-layer"]),ie.state=Te});return H}(this._layers,w,this.sourceCaches,n,o,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(v)}querySourceFeatures(n,o){o&&o.filter&&this._validate(a.validateStyle.filter,"querySourceFeatures.filter",o.filter,null,o);const u=this.sourceCaches[n];return u?function(p,v){const w=p.getRenderableIds().map(A=>p.getTileByID(A)),E=[],C={};for(let A=0;A<w.length;A++){const L=w[A],z=L.tileID.canonical.key;C[z]||(C[z]=!0,L.querySourceFeatures(E,v))}return E}(u,o):[]}addSourceType(n,o,u){return Ai.getSourceType(n)?u(new Error(`A source type called "${n}" already exists.`)):(Ai.setSourceType(n,o),o.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:n,url:o.workerSourceURL},u):u(null,null))}getLight(){return this.light.getLight()}setLight(n,o={}){this._checkLoaded();const u=this.light.getLight();let p=!1;for(const w in n)if(!a.deepEqual(n[w],u[w])){p=!0;break}if(!p)return;const v={now:a.exported.now(),transition:a.extend({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(n,o),this.light.updateTransitions(v)}_validate(n,o,u,p,v={}){return(!v||v.validate!==!1)&&ti(this,n.call(a.validateStyle,a.extend({key:o,style:this.serialize(),value:u,styleSpec:a.v8Spec},p)))}_remove(n=!0){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),a.evented.off("pluginStateChange",this._rtlTextPluginCallback);for(const o in this._layers)this._layers[o].setEventedParent(null);for(const o in this.sourceCaches){const u=this.sourceCaches[o];u.setEventedParent(null),u.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove(n)}_clearSource(n){this.sourceCaches[n].clearTiles()}_reloadSource(n){this.sourceCaches[n].resume(),this.sourceCaches[n].reload()}_updateSources(n){for(const o in this.sourceCaches)this.sourceCaches[o].update(n,this.map.terrain)}_generateCollisionBoxes(){for(const n in this.sourceCaches)this._reloadSource(n)}_updatePlacement(n,o,u,p,v=!1){let w=!1,E=!1;const C={};for(const A of this._order){const L=this._layers[A];if(L.type!=="symbol")continue;if(!C[L.source]){const U=this.sourceCaches[L.source];C[L.source]=U.getRenderableIds(!0).map(Q=>U.getTileByID(Q)).sort((Q,H)=>H.tileID.overscaledZ-Q.tileID.overscaledZ||(Q.tileID.isLessThan(H.tileID)?-1:1))}const z=this.crossTileSymbolIndex.addLayer(L,C[L.source],n.center.lng);w=w||z}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((v=v||this._layerOrderChanged||u===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(a.exported.now(),n.zoom))&&(this.pauseablePlacement=new _r(n,this.map.terrain,this._order,v,o,u,p,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,C),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(a.exported.now()),E=!0),w&&this.pauseablePlacement.placement.setStale()),E||w)for(const A of this._order){const L=this._layers[A];L.type==="symbol"&&this.placement.updateLayerOpacities(L,C[L.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(a.exported.now())}_releaseSymbolFadeTiles(){for(const n in this.sourceCaches)this.sourceCaches[n].releaseSymbolFadeTiles()}getImages(n,o,u){this.imageManager.getImages(o.icons,u),this._updateTilesForChangedImages();const p=this.sourceCaches[o.source];p&&p.setDependencies(o.tileID.key,o.type,o.icons)}getGlyphs(n,o,u){this.glyphManager.getGlyphs(o.stacks,u);const p=this.sourceCaches[o.source];p&&p.setDependencies(o.tileID.key,o.type,[""])}getResource(n,o,u){return a.makeRequest(o,u)}getGlyphsUrl(){return this.stylesheet.glyphs||null}setGlyphs(n,o={}){this._checkLoaded(),n&&this._validate(a.validateStyle.glyphs,"glyphs",n,null,o)||(this._glyphsDidChange=!0,this.stylesheet.glyphs=n,this.glyphManager.entries={},this.glyphManager.setURL(n))}addSprite(n,o,u={},p){this._checkLoaded();const v=[{id:n,url:o}],w=[...G(this.stylesheet.sprite),...v];this._validate(a.validateStyle.sprite,"sprite",w,null,u)||(this.stylesheet.sprite=w,this._loadSprite(v,!0,p))}removeSprite(n){this._checkLoaded();const o=G(this.stylesheet.sprite);if(o.find(u=>u.id===n)){if(this._spritesImagesIds[n])for(const u of this._spritesImagesIds[n])this.imageManager.removeImage(u),this._changedImages[u]=!0;o.splice(o.findIndex(u=>u.id===n),1),this.stylesheet.sprite=o.length>0?o:void 0,delete this._spritesImagesIds[n],this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new a.Event("data",{dataType:"style"}))}else this.fire(new a.ErrorEvent(new Error(`Sprite "${n}" doesn't exists on this map.`)))}getSprite(){return G(this.stylesheet.sprite)}setSprite(n,o={},u){this._checkLoaded(),n&&this._validate(a.validateStyle.sprite,"sprite",n,null,o)||(this.stylesheet.sprite=n,n?this._loadSprite(n,!0,u):(this._unloadSprite(),u&&u(null)))}}Ai.getSourceType=function(d){return ke[d]},Ai.setSourceType=function(d,n){ke[d]=n},Ai.registerForPluginStateChange=a.registerForPluginStateChange;var Jl=a.createLayout([{name:"a_pos",type:"Int16",components:2}]),Pa="attribute vec3 a_pos3d;uniform mat4 u_matrix;uniform float u_ele_delta;varying vec2 v_texture_pos;varying float v_depth;void main() {float extent=8192.0;float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/extent;gl_Position=u_matrix*vec4(a_pos3d.xy,get_elevation(a_pos3d.xy)-ele_delta,1.0);v_depth=gl_Position.z/gl_Position.w;}";const Ss={prelude:En(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}
#ifdef TERRAIN3D
uniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;
#endif
const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {
#ifdef TERRAIN3D
highp float d=unpack(texture2D(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));
#else
return 1.0;
#endif
}float calculate_visibility(vec4 pos) {
#ifdef TERRAIN3D
vec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;
#else
return 1.0;
#endif
}float ele(vec2 pos) {
#ifdef TERRAIN3D
vec4 rgb=(texture2D(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;
#else
return 0.0;
#endif
}float get_elevation(vec2 pos) {
#ifdef TERRAIN3D
vec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return elevation*u_terrain_exaggeration;
#else
return 0.0;
#endif
}`),background:En(`uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),backgroundPattern:En(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:En(`varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);float ele=get_elevation(circle_center);v_visibility=calculate_visibility(u_matrix*vec4(circle_center,ele,1.0));if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,ele,1);} else {gl_Position=u_matrix*vec4(circle_center,ele,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),clippingMask:En("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:En(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}`),heatmapTexture:En(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:En("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,get_elevation(a_pos),1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:En("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:En("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,get_elevation(a_pos),1);}"),fill:En(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_FragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);}`),fillOutline:En(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillOutlinePattern:En(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillPattern:En(`#ifdef GL_ES
precision highp float;
#endif
uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),fillExtrusion:En(`varying vec4 v_color;void main() {gl_FragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),fillExtrusionPattern:En(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),hillshadePrepare:En(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:En(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;
#define PI 3.141592653589793
void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),line:En(`uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),lineGradient:En(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),linePattern:En(`#ifdef GL_ES
precision highp float;
#endif
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),lineSDF:En(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),raster:En(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),symbolIcon:En(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0),z,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}`),symbolSDF:En(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset),z,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),symbolTextAndIcon:En(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),z,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`),terrain:En("uniform sampler2D u_texture;varying vec2 v_texture_pos;void main() {gl_FragColor=texture2D(u_texture,v_texture_pos);}",Pa),terrainDepth:En("varying float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {gl_FragColor=pack(v_depth);}",Pa),terrainCoords:En("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;varying vec2 v_texture_pos;void main() {vec4 rgba=texture2D(u_texture,v_texture_pos);gl_FragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}",Pa)};function En(d,n){const o=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,u=n.match(/attribute ([\w]+) ([\w]+)/g),p=d.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),v=n.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),w=v?v.concat(p):p,E={};return{fragmentSource:d=d.replace(o,(C,A,L,z,U)=>(E[U]=!0,A==="define"?`
#ifndef HAS_UNIFORM_u_${U}
varying ${L} ${z} ${U};
#else
uniform ${L} ${z} u_${U};
#endif
`:`
#ifdef HAS_UNIFORM_u_${U}
    ${L} ${z} ${U} = u_${U};
#endif
`)),vertexSource:n=n.replace(o,(C,A,L,z,U)=>{const Q=z==="float"?"vec2":"vec4",H=U.match(/color/)?"color":Q;return E[U]?A==="define"?`
#ifndef HAS_UNIFORM_u_${U}
uniform lowp float u_${U}_t;
attribute ${L} ${Q} a_${U};
varying ${L} ${z} ${U};
#else
uniform ${L} ${z} u_${U};
#endif
`:H==="vec4"?`
#ifndef HAS_UNIFORM_u_${U}
    ${U} = a_${U};
#else
    ${L} ${z} ${U} = u_${U};
#endif
`:`
#ifndef HAS_UNIFORM_u_${U}
    ${U} = unpack_mix_${H}(a_${U}, u_${U}_t);
#else
    ${L} ${z} ${U} = u_${U};
#endif
`:A==="define"?`
#ifndef HAS_UNIFORM_u_${U}
uniform lowp float u_${U}_t;
attribute ${L} ${Q} a_${U};
#else
uniform ${L} ${z} u_${U};
#endif
`:H==="vec4"?`
#ifndef HAS_UNIFORM_u_${U}
    ${L} ${z} ${U} = a_${U};
#else
    ${L} ${z} ${U} = u_${U};
#endif
`:`
#ifndef HAS_UNIFORM_u_${U}
    ${L} ${z} ${U} = unpack_mix_${H}(a_${U}, u_${U}_t);
#else
    ${L} ${z} ${U} = u_${U};
#endif
`}),staticAttributes:u,staticUniforms:w}}class Cs{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(n,o,u,p,v,w,E,C,A){this.context=n;let L=this.boundPaintVertexBuffers.length!==p.length;for(let z=0;!L&&z<p.length;z++)this.boundPaintVertexBuffers[z]!==p[z]&&(L=!0);!this.vao||this.boundProgram!==o||this.boundLayoutVertexBuffer!==u||L||this.boundIndexBuffer!==v||this.boundVertexOffset!==w||this.boundDynamicVertexBuffer!==E||this.boundDynamicVertexBuffer2!==C||this.boundDynamicVertexBuffer3!==A?this.freshBind(o,u,p,v,w,E,C,A):(n.bindVertexArray.set(this.vao),E&&E.bind(),v&&v.dynamicDraw&&v.bind(),C&&C.bind(),A&&A.bind())}freshBind(n,o,u,p,v,w,E,C){const A=n.numAttributes,L=this.context,z=L.gl;this.vao&&this.destroy(),this.vao=L.createVertexArray(),L.bindVertexArray.set(this.vao),this.boundProgram=n,this.boundLayoutVertexBuffer=o,this.boundPaintVertexBuffers=u,this.boundIndexBuffer=p,this.boundVertexOffset=v,this.boundDynamicVertexBuffer=w,this.boundDynamicVertexBuffer2=E,this.boundDynamicVertexBuffer3=C,o.enableAttributes(z,n);for(const U of u)U.enableAttributes(z,n);w&&w.enableAttributes(z,n),E&&E.enableAttributes(z,n),C&&C.enableAttributes(z,n),o.bind(),o.setVertexAttribPointers(z,n,v);for(const U of u)U.bind(),U.setVertexAttribPointers(z,n,v);w&&(w.bind(),w.setVertexAttribPointers(z,n,v)),p&&p.bind(),E&&(E.bind(),E.setVertexAttribPointers(z,n,v)),C&&(C.bind(),C.setVertexAttribPointers(z,n,v)),L.currentNumAttributes=A}destroy(){this.vao&&(this.context.deleteVertexArray(this.vao),this.vao=null)}}function jo(d){const n=[];for(let o=0;o<d.length;o++){if(d[o]===null)continue;const u=d[o].split(" ");n.push(u.pop())}return n}class ka{constructor(n,o,u,p,v,w,E){const C=n.gl;this.program=C.createProgram();const A=jo(u.staticAttributes),L=p?p.getBinderAttributes():[],z=A.concat(L),U=Ss.prelude.staticUniforms?jo(Ss.prelude.staticUniforms):[],Q=u.staticUniforms?jo(u.staticUniforms):[],H=p?p.getBinderUniforms():[],Y=U.concat(Q).concat(H),se=[];for(const it of Y)se.indexOf(it)<0&&se.push(it);const de=p?p.defines():[];w&&de.push("#define OVERDRAW_INSPECTOR;"),E&&de.push("#define TERRAIN3D;");const Pe=de.concat(Ss.prelude.fragmentSource,u.fragmentSource).join(`
`),ie=de.concat(Ss.prelude.vertexSource,u.vertexSource).join(`
`),Te=C.createShader(C.FRAGMENT_SHADER);if(C.isContextLost())return void(this.failedToCreate=!0);C.shaderSource(Te,Pe),C.compileShader(Te),C.attachShader(this.program,Te);const De=C.createShader(C.VERTEX_SHADER);if(C.isContextLost())return void(this.failedToCreate=!0);C.shaderSource(De,ie),C.compileShader(De),C.attachShader(this.program,De),this.attributes={};const Ye={};this.numAttributes=z.length;for(let it=0;it<this.numAttributes;it++)z[it]&&(C.bindAttribLocation(this.program,it,z[it]),this.attributes[z[it]]=it);C.linkProgram(this.program),C.deleteShader(De),C.deleteShader(Te);for(let it=0;it<se.length;it++){const ct=se[it];if(ct&&!Ye[ct]){const et=C.getUniformLocation(this.program,ct);et&&(Ye[ct]=et)}}this.fixedUniforms=v(n,Ye),this.terrainUniforms=((it,ct)=>({u_depth:new a.Uniform1i(it,ct.u_depth),u_terrain:new a.Uniform1i(it,ct.u_terrain),u_terrain_dim:new a.Uniform1f(it,ct.u_terrain_dim),u_terrain_matrix:new a.UniformMatrix4f(it,ct.u_terrain_matrix),u_terrain_unpack:new a.Uniform4f(it,ct.u_terrain_unpack),u_terrain_exaggeration:new a.Uniform1f(it,ct.u_terrain_exaggeration)}))(n,Ye),this.binderUniforms=p?p.getUniforms(n,Ye):[]}draw(n,o,u,p,v,w,E,C,A,L,z,U,Q,H,Y,se,de,Pe){const ie=n.gl;if(this.failedToCreate)return;if(n.program.set(this.program),n.setDepthMode(u),n.setStencilMode(p),n.setColorMode(v),n.setCullFace(w),C){n.activeTexture.set(ie.TEXTURE2),ie.bindTexture(ie.TEXTURE_2D,C.depthTexture),n.activeTexture.set(ie.TEXTURE3),ie.bindTexture(ie.TEXTURE_2D,C.texture);for(const De in this.terrainUniforms)this.terrainUniforms[De].set(C[De])}for(const De in this.fixedUniforms)this.fixedUniforms[De].set(E[De]);Y&&Y.setUniforms(n,this.binderUniforms,Q,{zoom:H});let Te=0;switch(o){case ie.LINES:Te=2;break;case ie.TRIANGLES:Te=3;break;case ie.LINE_STRIP:Te=1}for(const De of U.get()){const Ye=De.vaos||(De.vaos={});(Ye[A]||(Ye[A]=new Cs)).bind(n,this,L,Y?Y.getPaintVertexBuffers():[],z,De.vertexOffset,se,de,Pe),ie.drawElements(o,De.primitiveLength*Te,ie.UNSIGNED_SHORT,De.primitiveOffset*Te*2)}}}function Nu(d,n,o){const u=1/he(o,1,n.transform.tileZoom),p=Math.pow(2,o.tileID.overscaledZ),v=o.tileSize*Math.pow(2,n.transform.tileZoom)/p,w=v*(o.tileID.canonical.x+o.tileID.wrap*p),E=v*o.tileID.canonical.y;return{u_image:0,u_texsize:o.imageAtlasTexture.size,u_scale:[u,d.fromScale,d.toScale],u_fade:d.t,u_pixel_coord_upper:[w>>16,E>>16],u_pixel_coord_lower:[65535&w,65535&E]}}const ju=(d,n,o,u)=>{const p=n.style.light,v=p.properties.get("position"),w=[v.x,v.y,v.z],E=function(){var A=new a.ARRAY_TYPE(9);return a.ARRAY_TYPE!=Float32Array&&(A[1]=0,A[2]=0,A[3]=0,A[5]=0,A[6]=0,A[7]=0),A[0]=1,A[4]=1,A[8]=1,A}();p.properties.get("anchor")==="viewport"&&function(A,L){var z=Math.sin(L),U=Math.cos(L);A[0]=U,A[1]=z,A[2]=0,A[3]=-z,A[4]=U,A[5]=0,A[6]=0,A[7]=0,A[8]=1}(E,-n.transform.angle),function(A,L,z){var U=L[0],Q=L[1],H=L[2];A[0]=U*z[0]+Q*z[3]+H*z[6],A[1]=U*z[1]+Q*z[4]+H*z[7],A[2]=U*z[2]+Q*z[5]+H*z[8]}(w,w,E);const C=p.properties.get("color");return{u_matrix:d,u_lightpos:w,u_lightintensity:p.properties.get("intensity"),u_lightcolor:[C.r,C.g,C.b],u_vertical_gradient:+o,u_opacity:u}},Ql=(d,n,o,u,p,v,w)=>a.extend(ju(d,n,o,u),Nu(v,n,w),{u_height_factor:-Math.pow(2,p.overscaledZ)/w.tileSize/8}),qu=d=>({u_matrix:d}),ec=(d,n,o,u)=>a.extend(qu(d),Nu(o,n,u)),rf=(d,n)=>({u_matrix:d,u_world:n}),Zu=(d,n,o,u,p)=>a.extend(ec(d,n,o,u),{u_world:p}),sf=(d,n,o,u)=>{const p=d.transform;let v,w;if(u.paint.get("circle-pitch-alignment")==="map"){const E=he(o,1,p.zoom);v=!0,w=[E,E]}else v=!1,w=p.pixelsToGLUnits;return{u_camera_to_center_distance:p.cameraToCenterDistance,u_scale_with_map:+(u.paint.get("circle-pitch-scale")==="map"),u_matrix:d.translatePosMatrix(n.posMatrix,o,u.paint.get("circle-translate"),u.paint.get("circle-translate-anchor")),u_pitch_with_map:+v,u_device_pixel_ratio:d.pixelRatio,u_extrude_scale:w}},tc=(d,n,o)=>{const u=he(o,1,n.zoom),p=Math.pow(2,n.zoom-o.tileID.overscaledZ),v=o.tileID.overscaleFactor();return{u_matrix:d,u_camera_to_center_distance:n.cameraToCenterDistance,u_pixels_to_tile_units:u,u_extrude_scale:[n.pixelsToGLUnits[0]/(u*p),n.pixelsToGLUnits[1]/(u*p)],u_overscale_factor:v}},nc=(d,n,o=1)=>({u_matrix:d,u_color:n,u_overlay:0,u_overlay_scale:o}),ic=d=>({u_matrix:d}),Gu=(d,n,o,u)=>({u_matrix:d,u_extrude_scale:he(n,1,o),u_intensity:u});function Wu(d,n){const o=Math.pow(2,n.canonical.z),u=n.canonical.y;return[new a.MercatorCoordinate(0,u/o).toLngLat().lat,new a.MercatorCoordinate(0,(u+1)/o).toLngLat().lat]}const os=(d,n,o,u)=>{const p=d.transform;return{u_matrix:lo(d,n,o,u),u_ratio:1/he(n,1,p.zoom),u_device_pixel_ratio:d.pixelRatio,u_units_to_pixels:[1/p.pixelsToGLUnits[0],1/p.pixelsToGLUnits[1]]}},Ma=(d,n,o,u,p)=>a.extend(os(d,n,o,p),{u_image:0,u_image_height:u}),vr=(d,n,o,u,p)=>{const v=d.transform,w=qo(n,v);return{u_matrix:lo(d,n,o,p),u_texsize:n.imageAtlasTexture.size,u_ratio:1/he(n,1,v.zoom),u_device_pixel_ratio:d.pixelRatio,u_image:0,u_scale:[w,u.fromScale,u.toScale],u_fade:u.t,u_units_to_pixels:[1/v.pixelsToGLUnits[0],1/v.pixelsToGLUnits[1]]}},Da=(d,n,o,u,p,v)=>{const w=d.lineAtlas,E=qo(n,d.transform),C=o.layout.get("line-cap")==="round",A=w.getDash(u.from,C),L=w.getDash(u.to,C),z=A.width*p.fromScale,U=L.width*p.toScale;return a.extend(os(d,n,o,v),{u_patternscale_a:[E/z,-A.height/2],u_patternscale_b:[E/U,-L.height/2],u_sdfgamma:w.width/(256*Math.min(z,U)*d.pixelRatio)/2,u_image:0,u_tex_y_a:A.y,u_tex_y_b:L.y,u_mix:p.t})};function qo(d,n){return 1/he(d,1,n.tileZoom)}function lo(d,n,o,u){return d.translatePosMatrix(u?u.posMatrix:n.tileID.posMatrix,n,o.paint.get("line-translate"),o.paint.get("line-translate-anchor"))}const za=(d,n,o,u,p)=>{return{u_matrix:d,u_tl_parent:n,u_scale_parent:o,u_buffer_scale:1,u_fade_t:u.mix,u_opacity:u.opacity*p.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:p.paint.get("raster-brightness-min"),u_brightness_high:p.paint.get("raster-brightness-max"),u_saturation_factor:(w=p.paint.get("raster-saturation"),w>0?1-1/(1.001-w):-w),u_contrast_factor:(v=p.paint.get("raster-contrast"),v>0?1/(1-v):1+v),u_spin_weights:La(p.paint.get("raster-hue-rotate"))};var v,w};function La(d){d*=Math.PI/180;const n=Math.sin(d),o=Math.cos(d);return[(2*o+1)/3,(-Math.sqrt(3)*n-o+1)/3,(Math.sqrt(3)*n-o+1)/3]}const co=(d,n,o,u,p,v,w,E,C,A)=>{const L=p.transform;return{u_is_size_zoom_constant:+(d==="constant"||d==="source"),u_is_size_feature_constant:+(d==="constant"||d==="camera"),u_size_t:n?n.uSizeT:0,u_size:n?n.uSize:0,u_camera_to_center_distance:L.cameraToCenterDistance,u_pitch:L.pitch/360*2*Math.PI,u_rotate_symbol:+o,u_aspect_ratio:L.width/L.height,u_fade_change:p.options.fadeDuration?p.symbolFadeChange:1,u_matrix:v,u_label_plane_matrix:w,u_coord_matrix:E,u_is_text:+C,u_pitch_with_map:+u,u_texsize:A,u_texture:0}},uo=(d,n,o,u,p,v,w,E,C,A,L)=>{const z=p.transform;return a.extend(co(d,n,o,u,p,v,w,E,C,A),{u_gamma_scale:u?Math.cos(z._pitch)*z.cameraToCenterDistance:1,u_device_pixel_ratio:p.pixelRatio,u_is_halo:+L})},Ra=(d,n,o,u,p,v,w,E,C,A)=>a.extend(uo(d,n,o,u,p,v,w,E,!0,C,!0),{u_texsize_icon:A,u_texture_icon:1}),nr=(d,n,o)=>({u_matrix:d,u_opacity:n,u_color:o}),ir=(d,n,o,u,p,v)=>a.extend(function(w,E,C,A){const L=C.imageManager.getPattern(w.from.toString()),z=C.imageManager.getPattern(w.to.toString()),{width:U,height:Q}=C.imageManager.getPixelSize(),H=Math.pow(2,A.tileID.overscaledZ),Y=A.tileSize*Math.pow(2,C.transform.tileZoom)/H,se=Y*(A.tileID.canonical.x+A.tileID.wrap*H),de=Y*A.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:L.tl,u_pattern_br_a:L.br,u_pattern_tl_b:z.tl,u_pattern_br_b:z.br,u_texsize:[U,Q],u_mix:E.t,u_pattern_size_a:L.displaySize,u_pattern_size_b:z.displaySize,u_scale_a:E.fromScale,u_scale_b:E.toScale,u_tile_units_to_pixels:1/he(A,1,C.transform.tileZoom),u_pixel_coord_upper:[se>>16,de>>16],u_pixel_coord_lower:[65535&se,65535&de]}}(u,v,o,p),{u_matrix:d,u_opacity:n}),rc={fillExtrusion:(d,n)=>({u_matrix:new a.UniformMatrix4f(d,n.u_matrix),u_lightpos:new a.Uniform3f(d,n.u_lightpos),u_lightintensity:new a.Uniform1f(d,n.u_lightintensity),u_lightcolor:new a.Uniform3f(d,n.u_lightcolor),u_vertical_gradient:new a.Uniform1f(d,n.u_vertical_gradient),u_opacity:new a.Uniform1f(d,n.u_opacity)}),fillExtrusionPattern:(d,n)=>({u_matrix:new a.UniformMatrix4f(d,n.u_matrix),u_lightpos:new a.Uniform3f(d,n.u_lightpos),u_lightintensity:new a.Uniform1f(d,n.u_lightintensity),u_lightcolor:new a.Uniform3f(d,n.u_lightcolor),u_vertical_gradient:new a.Uniform1f(d,n.u_vertical_gradient),u_height_factor:new a.Uniform1f(d,n.u_height_factor),u_image:new a.Uniform1i(d,n.u_image),u_texsize:new a.Uniform2f(d,n.u_texsize),u_pixel_coord_upper:new a.Uniform2f(d,n.u_pixel_coord_upper),u_pixel_coord_lower:new a.Uniform2f(d,n.u_pixel_coord_lower),u_scale:new a.Uniform3f(d,n.u_scale),u_fade:new a.Uniform1f(d,n.u_fade),u_opacity:new a.Uniform1f(d,n.u_opacity)}),fill:(d,n)=>({u_matrix:new a.UniformMatrix4f(d,n.u_matrix)}),fillPattern:(d,n)=>({u_matrix:new a.UniformMatrix4f(d,n.u_matrix),u_image:new a.Uniform1i(d,n.u_image),u_texsize:new a.Uniform2f(d,n.u_texsize),u_pixel_coord_upper:new a.Uniform2f(d,n.u_pixel_coord_upper),u_pixel_coord_lower:new a.Uniform2f(d,n.u_pixel_coord_lower),u_scale:new a.Uniform3f(d,n.u_scale),u_fade:new a.Uniform1f(d,n.u_fade)}),fillOutline:(d,n)=>({u_matrix:new a.UniformMatrix4f(d,n.u_matrix),u_world:new a.Uniform2f(d,n.u_world)}),fillOutlinePattern:(d,n)=>({u_matrix:new a.UniformMatrix4f(d,n.u_matrix),u_world:new a.Uniform2f(d,n.u_world),u_image:new a.Uniform1i(d,n.u_image),u_texsize:new a.Uniform2f(d,n.u_texsize),u_pixel_coord_upper:new a.Uniform2f(d,n.u_pixel_coord_upper),u_pixel_coord_lower:new a.Uniform2f(d,n.u_pixel_coord_lower),u_scale:new a.Uniform3f(d,n.u_scale),u_fade:new a.Uniform1f(d,n.u_fade)}),circle:(d,n)=>({u_camera_to_center_distance:new a.Uniform1f(d,n.u_camera_to_center_distance),u_scale_with_map:new a.Uniform1i(d,n.u_scale_with_map),u_pitch_with_map:new a.Uniform1i(d,n.u_pitch_with_map),u_extrude_scale:new a.Uniform2f(d,n.u_extrude_scale),u_device_pixel_ratio:new a.Uniform1f(d,n.u_device_pixel_ratio),u_matrix:new a.UniformMatrix4f(d,n.u_matrix)}),collisionBox:(d,n)=>({u_matrix:new a.UniformMatrix4f(d,n.u_matrix),u_camera_to_center_distance:new a.Uniform1f(d,n.u_camera_to_center_distance),u_pixels_to_tile_units:new a.Uniform1f(d,n.u_pixels_to_tile_units),u_extrude_scale:new a.Uniform2f(d,n.u_extrude_scale),u_overscale_factor:new a.Uniform1f(d,n.u_overscale_factor)}),collisionCircle:(d,n)=>({u_matrix:new a.UniformMatrix4f(d,n.u_matrix),u_inv_matrix:new a.UniformMatrix4f(d,n.u_inv_matrix),u_camera_to_center_distance:new a.Uniform1f(d,n.u_camera_to_center_distance),u_viewport_size:new a.Uniform2f(d,n.u_viewport_size)}),debug:(d,n)=>({u_color:new a.UniformColor(d,n.u_color),u_matrix:new a.UniformMatrix4f(d,n.u_matrix),u_overlay:new a.Uniform1i(d,n.u_overlay),u_overlay_scale:new a.Uniform1f(d,n.u_overlay_scale)}),clippingMask:(d,n)=>({u_matrix:new a.UniformMatrix4f(d,n.u_matrix)}),heatmap:(d,n)=>({u_extrude_scale:new a.Uniform1f(d,n.u_extrude_scale),u_intensity:new a.Uniform1f(d,n.u_intensity),u_matrix:new a.UniformMatrix4f(d,n.u_matrix)}),heatmapTexture:(d,n)=>({u_matrix:new a.UniformMatrix4f(d,n.u_matrix),u_world:new a.Uniform2f(d,n.u_world),u_image:new a.Uniform1i(d,n.u_image),u_color_ramp:new a.Uniform1i(d,n.u_color_ramp),u_opacity:new a.Uniform1f(d,n.u_opacity)}),hillshade:(d,n)=>({u_matrix:new a.UniformMatrix4f(d,n.u_matrix),u_image:new a.Uniform1i(d,n.u_image),u_latrange:new a.Uniform2f(d,n.u_latrange),u_light:new a.Uniform2f(d,n.u_light),u_shadow:new a.UniformColor(d,n.u_shadow),u_highlight:new a.UniformColor(d,n.u_highlight),u_accent:new a.UniformColor(d,n.u_accent)}),hillshadePrepare:(d,n)=>({u_matrix:new a.UniformMatrix4f(d,n.u_matrix),u_image:new a.Uniform1i(d,n.u_image),u_dimension:new a.Uniform2f(d,n.u_dimension),u_zoom:new a.Uniform1f(d,n.u_zoom),u_unpack:new a.Uniform4f(d,n.u_unpack)}),line:(d,n)=>({u_matrix:new a.UniformMatrix4f(d,n.u_matrix),u_ratio:new a.Uniform1f(d,n.u_ratio),u_device_pixel_ratio:new a.Uniform1f(d,n.u_device_pixel_ratio),u_units_to_pixels:new a.Uniform2f(d,n.u_units_to_pixels)}),lineGradient:(d,n)=>({u_matrix:new a.UniformMatrix4f(d,n.u_matrix),u_ratio:new a.Uniform1f(d,n.u_ratio),u_device_pixel_ratio:new a.Uniform1f(d,n.u_device_pixel_ratio),u_units_to_pixels:new a.Uniform2f(d,n.u_units_to_pixels),u_image:new a.Uniform1i(d,n.u_image),u_image_height:new a.Uniform1f(d,n.u_image_height)}),linePattern:(d,n)=>({u_matrix:new a.UniformMatrix4f(d,n.u_matrix),u_texsize:new a.Uniform2f(d,n.u_texsize),u_ratio:new a.Uniform1f(d,n.u_ratio),u_device_pixel_ratio:new a.Uniform1f(d,n.u_device_pixel_ratio),u_image:new a.Uniform1i(d,n.u_image),u_units_to_pixels:new a.Uniform2f(d,n.u_units_to_pixels),u_scale:new a.Uniform3f(d,n.u_scale),u_fade:new a.Uniform1f(d,n.u_fade)}),lineSDF:(d,n)=>({u_matrix:new a.UniformMatrix4f(d,n.u_matrix),u_ratio:new a.Uniform1f(d,n.u_ratio),u_device_pixel_ratio:new a.Uniform1f(d,n.u_device_pixel_ratio),u_units_to_pixels:new a.Uniform2f(d,n.u_units_to_pixels),u_patternscale_a:new a.Uniform2f(d,n.u_patternscale_a),u_patternscale_b:new a.Uniform2f(d,n.u_patternscale_b),u_sdfgamma:new a.Uniform1f(d,n.u_sdfgamma),u_image:new a.Uniform1i(d,n.u_image),u_tex_y_a:new a.Uniform1f(d,n.u_tex_y_a),u_tex_y_b:new a.Uniform1f(d,n.u_tex_y_b),u_mix:new a.Uniform1f(d,n.u_mix)}),raster:(d,n)=>({u_matrix:new a.UniformMatrix4f(d,n.u_matrix),u_tl_parent:new a.Uniform2f(d,n.u_tl_parent),u_scale_parent:new a.Uniform1f(d,n.u_scale_parent),u_buffer_scale:new a.Uniform1f(d,n.u_buffer_scale),u_fade_t:new a.Uniform1f(d,n.u_fade_t),u_opacity:new a.Uniform1f(d,n.u_opacity),u_image0:new a.Uniform1i(d,n.u_image0),u_image1:new a.Uniform1i(d,n.u_image1),u_brightness_low:new a.Uniform1f(d,n.u_brightness_low),u_brightness_high:new a.Uniform1f(d,n.u_brightness_high),u_saturation_factor:new a.Uniform1f(d,n.u_saturation_factor),u_contrast_factor:new a.Uniform1f(d,n.u_contrast_factor),u_spin_weights:new a.Uniform3f(d,n.u_spin_weights)}),symbolIcon:(d,n)=>({u_is_size_zoom_constant:new a.Uniform1i(d,n.u_is_size_zoom_constant),u_is_size_feature_constant:new a.Uniform1i(d,n.u_is_size_feature_constant),u_size_t:new a.Uniform1f(d,n.u_size_t),u_size:new a.Uniform1f(d,n.u_size),u_camera_to_center_distance:new a.Uniform1f(d,n.u_camera_to_center_distance),u_pitch:new a.Uniform1f(d,n.u_pitch),u_rotate_symbol:new a.Uniform1i(d,n.u_rotate_symbol),u_aspect_ratio:new a.Uniform1f(d,n.u_aspect_ratio),u_fade_change:new a.Uniform1f(d,n.u_fade_change),u_matrix:new a.UniformMatrix4f(d,n.u_matrix),u_label_plane_matrix:new a.UniformMatrix4f(d,n.u_label_plane_matrix),u_coord_matrix:new a.UniformMatrix4f(d,n.u_coord_matrix),u_is_text:new a.Uniform1i(d,n.u_is_text),u_pitch_with_map:new a.Uniform1i(d,n.u_pitch_with_map),u_texsize:new a.Uniform2f(d,n.u_texsize),u_texture:new a.Uniform1i(d,n.u_texture)}),symbolSDF:(d,n)=>({u_is_size_zoom_constant:new a.Uniform1i(d,n.u_is_size_zoom_constant),u_is_size_feature_constant:new a.Uniform1i(d,n.u_is_size_feature_constant),u_size_t:new a.Uniform1f(d,n.u_size_t),u_size:new a.Uniform1f(d,n.u_size),u_camera_to_center_distance:new a.Uniform1f(d,n.u_camera_to_center_distance),u_pitch:new a.Uniform1f(d,n.u_pitch),u_rotate_symbol:new a.Uniform1i(d,n.u_rotate_symbol),u_aspect_ratio:new a.Uniform1f(d,n.u_aspect_ratio),u_fade_change:new a.Uniform1f(d,n.u_fade_change),u_matrix:new a.UniformMatrix4f(d,n.u_matrix),u_label_plane_matrix:new a.UniformMatrix4f(d,n.u_label_plane_matrix),u_coord_matrix:new a.UniformMatrix4f(d,n.u_coord_matrix),u_is_text:new a.Uniform1i(d,n.u_is_text),u_pitch_with_map:new a.Uniform1i(d,n.u_pitch_with_map),u_texsize:new a.Uniform2f(d,n.u_texsize),u_texture:new a.Uniform1i(d,n.u_texture),u_gamma_scale:new a.Uniform1f(d,n.u_gamma_scale),u_device_pixel_ratio:new a.Uniform1f(d,n.u_device_pixel_ratio),u_is_halo:new a.Uniform1i(d,n.u_is_halo)}),symbolTextAndIcon:(d,n)=>({u_is_size_zoom_constant:new a.Uniform1i(d,n.u_is_size_zoom_constant),u_is_size_feature_constant:new a.Uniform1i(d,n.u_is_size_feature_constant),u_size_t:new a.Uniform1f(d,n.u_size_t),u_size:new a.Uniform1f(d,n.u_size),u_camera_to_center_distance:new a.Uniform1f(d,n.u_camera_to_center_distance),u_pitch:new a.Uniform1f(d,n.u_pitch),u_rotate_symbol:new a.Uniform1i(d,n.u_rotate_symbol),u_aspect_ratio:new a.Uniform1f(d,n.u_aspect_ratio),u_fade_change:new a.Uniform1f(d,n.u_fade_change),u_matrix:new a.UniformMatrix4f(d,n.u_matrix),u_label_plane_matrix:new a.UniformMatrix4f(d,n.u_label_plane_matrix),u_coord_matrix:new a.UniformMatrix4f(d,n.u_coord_matrix),u_is_text:new a.Uniform1i(d,n.u_is_text),u_pitch_with_map:new a.Uniform1i(d,n.u_pitch_with_map),u_texsize:new a.Uniform2f(d,n.u_texsize),u_texsize_icon:new a.Uniform2f(d,n.u_texsize_icon),u_texture:new a.Uniform1i(d,n.u_texture),u_texture_icon:new a.Uniform1i(d,n.u_texture_icon),u_gamma_scale:new a.Uniform1f(d,n.u_gamma_scale),u_device_pixel_ratio:new a.Uniform1f(d,n.u_device_pixel_ratio),u_is_halo:new a.Uniform1i(d,n.u_is_halo)}),background:(d,n)=>({u_matrix:new a.UniformMatrix4f(d,n.u_matrix),u_opacity:new a.Uniform1f(d,n.u_opacity),u_color:new a.UniformColor(d,n.u_color)}),backgroundPattern:(d,n)=>({u_matrix:new a.UniformMatrix4f(d,n.u_matrix),u_opacity:new a.Uniform1f(d,n.u_opacity),u_image:new a.Uniform1i(d,n.u_image),u_pattern_tl_a:new a.Uniform2f(d,n.u_pattern_tl_a),u_pattern_br_a:new a.Uniform2f(d,n.u_pattern_br_a),u_pattern_tl_b:new a.Uniform2f(d,n.u_pattern_tl_b),u_pattern_br_b:new a.Uniform2f(d,n.u_pattern_br_b),u_texsize:new a.Uniform2f(d,n.u_texsize),u_mix:new a.Uniform1f(d,n.u_mix),u_pattern_size_a:new a.Uniform2f(d,n.u_pattern_size_a),u_pattern_size_b:new a.Uniform2f(d,n.u_pattern_size_b),u_scale_a:new a.Uniform1f(d,n.u_scale_a),u_scale_b:new a.Uniform1f(d,n.u_scale_b),u_pixel_coord_upper:new a.Uniform2f(d,n.u_pixel_coord_upper),u_pixel_coord_lower:new a.Uniform2f(d,n.u_pixel_coord_lower),u_tile_units_to_pixels:new a.Uniform1f(d,n.u_tile_units_to_pixels)}),terrain:(d,n)=>({u_matrix:new a.UniformMatrix4f(d,n.u_matrix),u_texture:new a.Uniform1i(d,n.u_texture),u_ele_delta:new a.Uniform1f(d,n.u_ele_delta)}),terrainDepth:(d,n)=>({u_matrix:new a.UniformMatrix4f(d,n.u_matrix),u_ele_delta:new a.Uniform1f(d,n.u_ele_delta)}),terrainCoords:(d,n)=>({u_matrix:new a.UniformMatrix4f(d,n.u_matrix),u_texture:new a.Uniform1i(d,n.u_texture),u_terrain_coords_id:new a.Uniform1f(d,n.u_terrain_coords_id),u_ele_delta:new a.Uniform1f(d,n.u_ele_delta)})};class Ba{constructor(n,o,u){this.context=n;const p=n.gl;this.buffer=p.createBuffer(),this.dynamicDraw=!!u,this.context.unbindVAO(),n.bindElementBuffer.set(this.buffer),p.bufferData(p.ELEMENT_ARRAY_BUFFER,o.arrayBuffer,this.dynamicDraw?p.DYNAMIC_DRAW:p.STATIC_DRAW),this.dynamicDraw||delete o.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(n){const o=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),o.bufferSubData(o.ELEMENT_ARRAY_BUFFER,0,n.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const Fa={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class sc{constructor(n,o,u,p){this.length=o.length,this.attributes=u,this.itemSize=o.bytesPerElement,this.dynamicDraw=p,this.context=n;const v=n.gl;this.buffer=v.createBuffer(),n.bindVertexBuffer.set(this.buffer),v.bufferData(v.ARRAY_BUFFER,o.arrayBuffer,this.dynamicDraw?v.DYNAMIC_DRAW:v.STATIC_DRAW),this.dynamicDraw||delete o.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(n){if(n.length!==this.length)throw new Error(`Length of new data is ${n.length}, which doesn't match current length of ${this.length}`);const o=this.context.gl;this.bind(),o.bufferSubData(o.ARRAY_BUFFER,0,n.arrayBuffer)}enableAttributes(n,o){for(let u=0;u<this.attributes.length;u++){const p=o.attributes[this.attributes[u].name];p!==void 0&&n.enableVertexAttribArray(p)}}setVertexAttribPointers(n,o,u){for(let p=0;p<this.attributes.length;p++){const v=this.attributes[p],w=o.attributes[v.name];w!==void 0&&n.vertexAttribPointer(w,v.components,n[Fa[v.type]],!1,this.itemSize,v.offset+this.itemSize*(u||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const Zo=new WeakMap;function Vs(d){if(Zo.has(d))return Zo.get(d);{const n=d.getParameter(d.VERSION).startsWith("WebGL 2.0");return Zo.set(d,n),n}}class yn{constructor(n){this.gl=n.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(n){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class oc extends yn{getDefault(){return a.Color.transparent}set(n){const o=this.current;(n.r!==o.r||n.g!==o.g||n.b!==o.b||n.a!==o.a||this.dirty)&&(this.gl.clearColor(n.r,n.g,n.b,n.a),this.current=n,this.dirty=!1)}}class Oa extends yn{getDefault(){return 1}set(n){(n!==this.current||this.dirty)&&(this.gl.clearDepth(n),this.current=n,this.dirty=!1)}}class Hu extends yn{getDefault(){return 0}set(n){(n!==this.current||this.dirty)&&(this.gl.clearStencil(n),this.current=n,this.dirty=!1)}}class Xu extends yn{getDefault(){return[!0,!0,!0,!0]}set(n){const o=this.current;(n[0]!==o[0]||n[1]!==o[1]||n[2]!==o[2]||n[3]!==o[3]||this.dirty)&&(this.gl.colorMask(n[0],n[1],n[2],n[3]),this.current=n,this.dirty=!1)}}class ho extends yn{getDefault(){return!0}set(n){(n!==this.current||this.dirty)&&(this.gl.depthMask(n),this.current=n,this.dirty=!1)}}class of extends yn{getDefault(){return 255}set(n){(n!==this.current||this.dirty)&&(this.gl.stencilMask(n),this.current=n,this.dirty=!1)}}class af extends yn{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(n){const o=this.current;(n.func!==o.func||n.ref!==o.ref||n.mask!==o.mask||this.dirty)&&(this.gl.stencilFunc(n.func,n.ref,n.mask),this.current=n,this.dirty=!1)}}class lf extends yn{getDefault(){const n=this.gl;return[n.KEEP,n.KEEP,n.KEEP]}set(n){const o=this.current;(n[0]!==o[0]||n[1]!==o[1]||n[2]!==o[2]||this.dirty)&&(this.gl.stencilOp(n[0],n[1],n[2]),this.current=n,this.dirty=!1)}}class cf extends yn{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;const o=this.gl;n?o.enable(o.STENCIL_TEST):o.disable(o.STENCIL_TEST),this.current=n,this.dirty=!1}}class uf extends yn{getDefault(){return[0,1]}set(n){const o=this.current;(n[0]!==o[0]||n[1]!==o[1]||this.dirty)&&(this.gl.depthRange(n[0],n[1]),this.current=n,this.dirty=!1)}}class hf extends yn{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;const o=this.gl;n?o.enable(o.DEPTH_TEST):o.disable(o.DEPTH_TEST),this.current=n,this.dirty=!1}}class ac extends yn{getDefault(){return this.gl.LESS}set(n){(n!==this.current||this.dirty)&&(this.gl.depthFunc(n),this.current=n,this.dirty=!1)}}class Va extends yn{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;const o=this.gl;n?o.enable(o.BLEND):o.disable(o.BLEND),this.current=n,this.dirty=!1}}class lc extends yn{getDefault(){const n=this.gl;return[n.ONE,n.ZERO]}set(n){const o=this.current;(n[0]!==o[0]||n[1]!==o[1]||this.dirty)&&(this.gl.blendFunc(n[0],n[1]),this.current=n,this.dirty=!1)}}class cc extends yn{getDefault(){return a.Color.transparent}set(n){const o=this.current;(n.r!==o.r||n.g!==o.g||n.b!==o.b||n.a!==o.a||this.dirty)&&(this.gl.blendColor(n.r,n.g,n.b,n.a),this.current=n,this.dirty=!1)}}class fo extends yn{getDefault(){return this.gl.FUNC_ADD}set(n){(n!==this.current||this.dirty)&&(this.gl.blendEquation(n),this.current=n,this.dirty=!1)}}class Ku extends yn{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;const o=this.gl;n?o.enable(o.CULL_FACE):o.disable(o.CULL_FACE),this.current=n,this.dirty=!1}}class Yu extends yn{getDefault(){return this.gl.BACK}set(n){(n!==this.current||this.dirty)&&(this.gl.cullFace(n),this.current=n,this.dirty=!1)}}class uc extends yn{getDefault(){return this.gl.CCW}set(n){(n!==this.current||this.dirty)&&(this.gl.frontFace(n),this.current=n,this.dirty=!1)}}class $s extends yn{getDefault(){return null}set(n){(n!==this.current||this.dirty)&&(this.gl.useProgram(n),this.current=n,this.dirty=!1)}}class Ju extends yn{getDefault(){return this.gl.TEXTURE0}set(n){(n!==this.current||this.dirty)&&(this.gl.activeTexture(n),this.current=n,this.dirty=!1)}}class po extends yn{getDefault(){const n=this.gl;return[0,0,n.drawingBufferWidth,n.drawingBufferHeight]}set(n){const o=this.current;(n[0]!==o[0]||n[1]!==o[1]||n[2]!==o[2]||n[3]!==o[3]||this.dirty)&&(this.gl.viewport(n[0],n[1],n[2],n[3]),this.current=n,this.dirty=!1)}}class mo extends yn{getDefault(){return null}set(n){if(n===this.current&&!this.dirty)return;const o=this.gl;o.bindFramebuffer(o.FRAMEBUFFER,n),this.current=n,this.dirty=!1}}class Qu extends yn{getDefault(){return null}set(n){if(n===this.current&&!this.dirty)return;const o=this.gl;o.bindRenderbuffer(o.RENDERBUFFER,n),this.current=n,this.dirty=!1}}class hc extends yn{getDefault(){return null}set(n){if(n===this.current&&!this.dirty)return;const o=this.gl;o.bindTexture(o.TEXTURE_2D,n),this.current=n,this.dirty=!1}}class An extends yn{getDefault(){return null}set(n){if(n===this.current&&!this.dirty)return;const o=this.gl;o.bindBuffer(o.ARRAY_BUFFER,n),this.current=n,this.dirty=!1}}class $a extends yn{getDefault(){return null}set(n){const o=this.gl;o.bindBuffer(o.ELEMENT_ARRAY_BUFFER,n),this.current=n,this.dirty=!1}}class df extends yn{getDefault(){return null}set(n){var o;if(n===this.current&&!this.dirty)return;const u=this.gl;Vs(u)?u.bindVertexArray(n):(o=u.getExtension("OES_vertex_array_object"))===null||o===void 0||o.bindVertexArrayOES(n),this.current=n,this.dirty=!1}}class eh extends yn{getDefault(){return 4}set(n){if(n===this.current&&!this.dirty)return;const o=this.gl;o.pixelStorei(o.UNPACK_ALIGNMENT,n),this.current=n,this.dirty=!1}}class Go extends yn{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;const o=this.gl;o.pixelStorei(o.UNPACK_PREMULTIPLY_ALPHA_WEBGL,n),this.current=n,this.dirty=!1}}class ff extends yn{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;const o=this.gl;o.pixelStorei(o.UNPACK_FLIP_Y_WEBGL,n),this.current=n,this.dirty=!1}}class dc extends yn{constructor(n,o){super(n),this.context=n,this.parent=o}getDefault(){return null}}class th extends dc{setDirty(){this.dirty=!0}set(n){if(n===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const o=this.gl;o.framebufferTexture2D(o.FRAMEBUFFER,o.COLOR_ATTACHMENT0,o.TEXTURE_2D,n,0),this.current=n,this.dirty=!1}}class pf extends dc{set(n){if(n===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const o=this.gl;o.framebufferRenderbuffer(o.FRAMEBUFFER,o.DEPTH_ATTACHMENT,o.RENDERBUFFER,n),this.current=n,this.dirty=!1}}class fc extends dc{set(n){if(n===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const o=this.gl;o.framebufferRenderbuffer(o.FRAMEBUFFER,o.DEPTH_STENCIL_ATTACHMENT,o.RENDERBUFFER,n),this.current=n,this.dirty=!1}}class Ua{constructor(n,o,u,p,v){this.context=n,this.width=o,this.height=u;const w=n.gl,E=this.framebuffer=w.createFramebuffer();if(this.colorAttachment=new th(n,E),p)this.depthAttachment=v?new fc(n,E):new pf(n,E);else if(v)throw new Error("Stencil cannot be setted without depth");if(w.checkFramebufferStatus(w.FRAMEBUFFER)!==w.FRAMEBUFFER_COMPLETE)throw new Error("Framebuffer is not complete")}destroy(){const n=this.context.gl,o=this.colorAttachment.get();if(o&&n.deleteTexture(o),this.depthAttachment){const u=this.depthAttachment.get();u&&n.deleteRenderbuffer(u)}n.deleteFramebuffer(this.framebuffer)}}class Gn{constructor(n,o,u){this.blendFunction=n,this.blendColor=o,this.mask=u}}Gn.Replace=[1,0],Gn.disabled=new Gn(Gn.Replace,a.Color.transparent,[!1,!1,!1,!1]),Gn.unblended=new Gn(Gn.Replace,a.Color.transparent,[!0,!0,!0,!0]),Gn.alphaBlended=new Gn([1,771],a.Color.transparent,[!0,!0,!0,!0]);class pc{constructor(n){var o,u;if(this.gl=n,this.clearColor=new oc(this),this.clearDepth=new Oa(this),this.clearStencil=new Hu(this),this.colorMask=new Xu(this),this.depthMask=new ho(this),this.stencilMask=new of(this),this.stencilFunc=new af(this),this.stencilOp=new lf(this),this.stencilTest=new cf(this),this.depthRange=new uf(this),this.depthTest=new hf(this),this.depthFunc=new ac(this),this.blend=new Va(this),this.blendFunc=new lc(this),this.blendColor=new cc(this),this.blendEquation=new fo(this),this.cullFace=new Ku(this),this.cullFaceSide=new Yu(this),this.frontFace=new uc(this),this.program=new $s(this),this.activeTexture=new Ju(this),this.viewport=new po(this),this.bindFramebuffer=new mo(this),this.bindRenderbuffer=new Qu(this),this.bindTexture=new hc(this),this.bindVertexBuffer=new An(this),this.bindElementBuffer=new $a(this),this.bindVertexArray=new df(this),this.pixelStoreUnpack=new eh(this),this.pixelStoreUnpackPremultiplyAlpha=new Go(this),this.pixelStoreUnpackFlipY=new ff(this),this.extTextureFilterAnisotropic=n.getExtension("EXT_texture_filter_anisotropic")||n.getExtension("MOZ_EXT_texture_filter_anisotropic")||n.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=n.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.maxTextureSize=n.getParameter(n.MAX_TEXTURE_SIZE),Vs(n)){this.HALF_FLOAT=n.HALF_FLOAT;const p=n.getExtension("EXT_color_buffer_half_float");this.RGBA16F=(o=n.RGBA16F)!==null&&o!==void 0?o:p==null?void 0:p.RGBA16F_EXT,this.RGB16F=(u=n.RGB16F)!==null&&u!==void 0?u:p==null?void 0:p.RGB16F_EXT,n.getExtension("EXT_color_buffer_float")}else{n.getExtension("EXT_color_buffer_half_float"),n.getExtension("OES_texture_half_float_linear");const p=n.getExtension("OES_texture_half_float");this.HALF_FLOAT=p==null?void 0:p.HALF_FLOAT_OES}}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArray.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(n,o){return new Ba(this,n,o)}createVertexBuffer(n,o,u){return new sc(this,n,o,u)}createRenderbuffer(n,o,u){const p=this.gl,v=p.createRenderbuffer();return this.bindRenderbuffer.set(v),p.renderbufferStorage(p.RENDERBUFFER,n,o,u),this.bindRenderbuffer.set(null),v}createFramebuffer(n,o,u,p){return new Ua(this,n,o,u,p)}clear({color:n,depth:o,stencil:u}){const p=this.gl;let v=0;n&&(v|=p.COLOR_BUFFER_BIT,this.clearColor.set(n),this.colorMask.set([!0,!0,!0,!0])),o!==void 0&&(v|=p.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(o),this.depthMask.set(!0)),u!==void 0&&(v|=p.STENCIL_BUFFER_BIT,this.clearStencil.set(u),this.stencilMask.set(255)),p.clear(v)}setCullFace(n){n.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(n.mode),this.frontFace.set(n.frontFace))}setDepthMode(n){n.func!==this.gl.ALWAYS||n.mask?(this.depthTest.set(!0),this.depthFunc.set(n.func),this.depthMask.set(n.mask),this.depthRange.set(n.range)):this.depthTest.set(!1)}setStencilMode(n){n.test.func!==this.gl.ALWAYS||n.mask?(this.stencilTest.set(!0),this.stencilMask.set(n.mask),this.stencilOp.set([n.fail,n.depthFail,n.pass]),this.stencilFunc.set({func:n.test.func,ref:n.ref,mask:n.test.mask})):this.stencilTest.set(!1)}setColorMode(n){a.deepEqual(n.blendFunction,Gn.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(n.blendFunction),this.blendColor.set(n.blendColor)),this.colorMask.set(n.mask)}createVertexArray(){var n;return Vs(this.gl)?this.gl.createVertexArray():(n=this.gl.getExtension("OES_vertex_array_object"))===null||n===void 0?void 0:n.createVertexArrayOES()}deleteVertexArray(n){var o;return Vs(this.gl)?this.gl.deleteVertexArray(n):(o=this.gl.getExtension("OES_vertex_array_object"))===null||o===void 0?void 0:o.deleteVertexArrayOES(n)}unbindVAO(){this.bindVertexArray.set(null)}}class cn{constructor(n,o,u){this.func=n,this.mask=o,this.range=u}}cn.ReadOnly=!1,cn.ReadWrite=!0,cn.disabled=new cn(519,cn.ReadOnly,[0,1]);const Na=7680;class Bn{constructor(n,o,u,p,v,w){this.test=n,this.ref=o,this.mask=u,this.fail=p,this.depthFail=v,this.pass=w}}Bn.disabled=new Bn({func:519,mask:0},0,0,Na,Na,Na);class Ln{constructor(n,o,u){this.enable=n,this.mode=o,this.frontFace=u}}let go;function nh(d,n,o,u,p,v,w){const E=d.context,C=E.gl,A=d.useProgram("collisionBox"),L=[];let z=0,U=0;for(let ie=0;ie<u.length;ie++){const Te=u[ie],De=n.getTile(Te),Ye=De.getBucket(o);if(!Ye)continue;let it=Te.posMatrix;p[0]===0&&p[1]===0||(it=d.translatePosMatrix(Te.posMatrix,De,p,v));const ct=w?Ye.textCollisionBox:Ye.iconCollisionBox,et=Ye.collisionCircleArray;if(et.length>0){const bt=a.create(),Ot=it;a.mul(bt,Ye.placementInvProjMatrix,d.transform.glCoordMatrix),a.mul(bt,bt,Ye.placementViewportMatrix),L.push({circleArray:et,circleOffset:U,transform:Ot,invTransform:bt,coord:Te}),z+=et.length/4,U=z}ct&&A.draw(E,C.LINES,cn.disabled,Bn.disabled,d.colorModeForRenderPass(),Ln.disabled,tc(it,d.transform,De),d.style.map.terrain&&d.style.map.terrain.getTerrainData(Te),o.id,ct.layoutVertexBuffer,ct.indexBuffer,ct.segments,null,d.transform.zoom,null,null,ct.collisionVertexBuffer)}if(!w||!L.length)return;const Q=d.useProgram("collisionCircle"),H=new a.CollisionCircleLayoutArray;H.resize(4*z),H._trim();let Y=0;for(const ie of L)for(let Te=0;Te<ie.circleArray.length/4;Te++){const De=4*Te,Ye=ie.circleArray[De+0],it=ie.circleArray[De+1],ct=ie.circleArray[De+2],et=ie.circleArray[De+3];H.emplace(Y++,Ye,it,ct,et,0),H.emplace(Y++,Ye,it,ct,et,1),H.emplace(Y++,Ye,it,ct,et,2),H.emplace(Y++,Ye,it,ct,et,3)}(!go||go.length<2*z)&&(go=function(ie){const Te=2*ie,De=new a.QuadTriangleArray;De.resize(Te),De._trim();for(let Ye=0;Ye<Te;Ye++){const it=6*Ye;De.uint16[it+0]=4*Ye+0,De.uint16[it+1]=4*Ye+1,De.uint16[it+2]=4*Ye+2,De.uint16[it+3]=4*Ye+2,De.uint16[it+4]=4*Ye+3,De.uint16[it+5]=4*Ye+0}return De}(z));const se=E.createIndexBuffer(go,!0),de=E.createVertexBuffer(H,a.collisionCircleLayout.members,!0);for(const ie of L){const Te={u_matrix:ie.transform,u_inv_matrix:ie.invTransform,u_camera_to_center_distance:(Pe=d.transform).cameraToCenterDistance,u_viewport_size:[Pe.width,Pe.height]};Q.draw(E,C.TRIANGLES,cn.disabled,Bn.disabled,d.colorModeForRenderPass(),Ln.disabled,Te,d.style.map.terrain&&d.style.map.terrain.getTerrainData(ie.coord),o.id,de,se,a.SegmentVector.simpleSegment(0,2*ie.circleOffset,ie.circleArray.length,ie.circleArray.length/2),null,d.transform.zoom,null,null,null)}var Pe;de.destroy(),se.destroy()}Ln.disabled=new Ln(!1,1029,2305),Ln.backCCW=new Ln(!0,1029,2305);const mc=a.identity(new Float32Array(16));function mf(d,n,o,u,p,v){const{horizontalAlign:w,verticalAlign:E}=a.getAnchorAlignment(d),C=-(w-.5)*n,A=-(E-.5)*o,L=a.evaluateVariableOffset(d,u);return new a.Point((C/p+L[0])*v,(A/p+L[1])*v)}function ih(d,n,o,u,p,v,w,E,C,A,L){const z=d.text.placedSymbolArray,U=d.text.dynamicLayoutVertexArray,Q=d.icon.dynamicLayoutVertexArray,H={};U.clear();for(let Y=0;Y<z.length;Y++){const se=z.get(Y),de=se.hidden||!se.crossTileID||d.allowVerticalPlacement&&!se.placedOrientation?null:u[se.crossTileID];if(de){const Pe=new a.Point(se.anchorX,se.anchorY),ie=dn(Pe,o?w:v,L),Te=Lt(p.cameraToCenterDistance,ie.signedDistanceFromCamera);let De=a.evaluateSizeForFeature(d.textSizeData,C,se)*Te/a.ONE_EM;o&&(De*=d.tilePixelRatio/E);const{width:Ye,height:it,anchor:ct,textOffset:et,textBoxScale:bt}=de,Ot=mf(ct,Ye,it,et,bt,De),Jt=o?dn(Pe.add(Ot),v,L).point:ie.point.add(n?Ot.rotate(-p.angle):Ot),pt=d.allowVerticalPlacement&&se.placedOrientation===a.WritingMode.vertical?Math.PI/2:0;for(let Zt=0;Zt<se.numGlyphs;Zt++)a.addDynamicAttributes(U,Jt,pt);A&&se.associatedIconIndex>=0&&(H[se.associatedIconIndex]={shiftedAnchor:Jt,angle:pt})}else W(se.numGlyphs,U)}if(A){Q.clear();const Y=d.icon.placedSymbolArray;for(let se=0;se<Y.length;se++){const de=Y.get(se);if(de.hidden)W(de.numGlyphs,Q);else{const Pe=H[se];if(Pe)for(let ie=0;ie<de.numGlyphs;ie++)a.addDynamicAttributes(Q,Pe.shiftedAnchor,Pe.angle);else W(de.numGlyphs,Q)}}d.icon.dynamicLayoutVertexBuffer.updateData(Q)}d.text.dynamicLayoutVertexBuffer.updateData(U)}function ja(d,n,o){return o.iconsInText&&n?"symbolTextAndIcon":d?"symbolSDF":"symbolIcon"}function qa(d,n,o,u,p,v,w,E,C,A,L,z){const U=d.context,Q=U.gl,H=d.transform,Y=E==="map",se=C==="map",de=E!=="viewport"&&o.layout.get("symbol-placement")!=="point",Pe=Y&&!se&&!de,ie=!o.layout.get("symbol-sort-key").isConstant();let Te=!1;const De=d.depthModeForSublayer(0,cn.ReadOnly),Ye=o.layout.get("text-variable-anchor"),it=[];for(const ct of u){const et=n.getTile(ct),bt=et.getBucket(o);if(!bt)continue;const Ot=p?bt.text:bt.icon;if(!Ot||!Ot.segments.get().length||!Ot.hasVisibleVertices)continue;const Jt=Ot.programConfigurations.get(o.id),pt=p||bt.sdfIcons,Zt=p?bt.textSizeData:bt.iconSizeData,St=se||H.pitch!==0,_n=d.useProgram(ja(pt,p,bt),Jt),ii=a.evaluateSizeForZoom(Zt,H.zoom),vn=d.style.map.terrain&&d.style.map.terrain.getTerrainData(ct);let tn,Jn,$i,ri,xi=[0,0],rr=null;if(p)Jn=et.glyphAtlasTexture,$i=Q.LINEAR,tn=et.glyphAtlasTexture.size,bt.iconsInText&&(xi=et.imageAtlasTexture.size,rr=et.imageAtlasTexture,ri=St||d.options.rotating||d.options.zooming||Zt.kind==="composite"||Zt.kind==="camera"?Q.LINEAR:Q.NEAREST);else{const gi=o.layout.get("icon-size").constantOr(0)!==1||bt.iconsNeedLinear;Jn=et.imageAtlasTexture,$i=pt||d.options.rotating||d.options.zooming||gi||St?Q.LINEAR:Q.NEAREST,tn=et.imageAtlasTexture.size}const Dr=he(et,1,d.transform.zoom),zr=Nt(ct.posMatrix,se,Y,d.transform,Dr),Ui=kn(ct.posMatrix,se,Y,d.transform,Dr),Kr=Ye&&bt.hasTextData(),sa=o.layout.get("icon-text-fit")!=="none"&&Kr&&bt.hasIconData();if(de){const gi=d.style.map.terrain?(hl,cs)=>d.style.map.terrain.getElevation(ct,hl,cs):null,sr=o.layout.get("text-rotation-alignment")==="map";rs(bt,ct.posMatrix,d,p,zr,Ui,se,A,sr,gi)}const Di=d.translatePosMatrix(ct.posMatrix,et,v,w),bi=de||p&&Ye||sa?mc:zr,Cn=d.translatePosMatrix(Ui,et,v,w,!0),mi=pt&&o.paint.get(p?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let wi;wi=pt?bt.iconsInText?Ra(Zt.kind,ii,Pe,se,d,Di,bi,Cn,tn,xi):uo(Zt.kind,ii,Pe,se,d,Di,bi,Cn,p,tn,!0):co(Zt.kind,ii,Pe,se,d,Di,bi,Cn,p,tn);const Tn={program:_n,buffers:Ot,uniformValues:wi,atlasTexture:Jn,atlasTextureIcon:rr,atlasInterpolation:$i,atlasInterpolationIcon:ri,isSDF:pt,hasHalo:mi};if(ie&&bt.canOverlap){Te=!0;const gi=Ot.segments.get();for(const sr of gi)it.push({segments:new a.SegmentVector([sr]),sortKey:sr.sortKey,state:Tn,terrainData:vn})}else it.push({segments:Ot.segments,sortKey:0,state:Tn,terrainData:vn})}Te&&it.sort((ct,et)=>ct.sortKey-et.sortKey);for(const ct of it){const et=ct.state;if(U.activeTexture.set(Q.TEXTURE0),et.atlasTexture.bind(et.atlasInterpolation,Q.CLAMP_TO_EDGE),et.atlasTextureIcon&&(U.activeTexture.set(Q.TEXTURE1),et.atlasTextureIcon&&et.atlasTextureIcon.bind(et.atlasInterpolationIcon,Q.CLAMP_TO_EDGE)),et.isSDF){const bt=et.uniformValues;et.hasHalo&&(bt.u_is_halo=1,gc(et.buffers,ct.segments,o,d,et.program,De,L,z,bt,ct.terrainData)),bt.u_is_halo=0}gc(et.buffers,ct.segments,o,d,et.program,De,L,z,et.uniformValues,ct.terrainData)}}function gc(d,n,o,u,p,v,w,E,C,A){const L=u.context;p.draw(L,L.gl.TRIANGLES,v,w,E,Ln.disabled,C,A,o.id,d.layoutVertexBuffer,d.indexBuffer,n,o.paint,u.transform.zoom,d.programConfigurations.get(o.id),d.dynamicLayoutVertexBuffer,d.opacityVertexBuffer)}function yc(d,n,o,u,p){if(!o||!u||!u.imageAtlas)return;const v=u.imageAtlas.patternPositions;let w=v[o.to.toString()],E=v[o.from.toString()];if(!w||!E){const C=p.getPaintProperty(n);w=v[C],E=v[C]}w&&E&&d.setConstantPatternPositions(w,E)}function Wo(d,n,o,u,p,v,w){const E=d.context.gl,C="fill-pattern",A=o.paint.get(C),L=A&&A.constantOr(1),z=o.getCrossfadeParameters();let U,Q,H,Y,se;w?(Q=L&&!o.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",U=E.LINES):(Q=L?"fillPattern":"fill",U=E.TRIANGLES);const de=A.constantOr(null);for(const Pe of u){const ie=n.getTile(Pe);if(L&&!ie.patternsLoaded())continue;const Te=ie.getBucket(o);if(!Te)continue;const De=Te.programConfigurations.get(o.id),Ye=d.useProgram(Q,De),it=d.style.map.terrain&&d.style.map.terrain.getTerrainData(Pe);L&&(d.context.activeTexture.set(E.TEXTURE0),ie.imageAtlasTexture.bind(E.LINEAR,E.CLAMP_TO_EDGE),De.updatePaintBuffers(z)),yc(De,C,de,ie,o);const ct=it?Pe:null,et=d.translatePosMatrix(ct?ct.posMatrix:Pe.posMatrix,ie,o.paint.get("fill-translate"),o.paint.get("fill-translate-anchor"));if(w){Y=Te.indexBuffer2,se=Te.segments2;const bt=[E.drawingBufferWidth,E.drawingBufferHeight];H=Q==="fillOutlinePattern"&&L?Zu(et,d,z,ie,bt):rf(et,bt)}else Y=Te.indexBuffer,se=Te.segments,H=L?ec(et,d,z,ie):qu(et);Ye.draw(d.context,U,p,d.stencilModeForClipping(Pe),v,Ln.disabled,H,it,o.id,Te.layoutVertexBuffer,Y,se,o.paint,d.transform.zoom,De)}}function Ho(d,n,o,u,p,v,w){const E=d.context,C=E.gl,A="fill-extrusion-pattern",L=o.paint.get(A),z=L.constantOr(1),U=o.getCrossfadeParameters(),Q=o.paint.get("fill-extrusion-opacity"),H=L.constantOr(null);for(const Y of u){const se=n.getTile(Y),de=se.getBucket(o);if(!de)continue;const Pe=d.style.map.terrain&&d.style.map.terrain.getTerrainData(Y),ie=de.programConfigurations.get(o.id),Te=d.useProgram(z?"fillExtrusionPattern":"fillExtrusion",ie);z&&(d.context.activeTexture.set(C.TEXTURE0),se.imageAtlasTexture.bind(C.LINEAR,C.CLAMP_TO_EDGE),ie.updatePaintBuffers(U)),yc(ie,A,H,se,o);const De=d.translatePosMatrix(Y.posMatrix,se,o.paint.get("fill-extrusion-translate"),o.paint.get("fill-extrusion-translate-anchor")),Ye=o.paint.get("fill-extrusion-vertical-gradient"),it=z?Ql(De,d,Ye,Q,Y,U,se):ju(De,d,Ye,Q);Te.draw(E,E.gl.TRIANGLES,p,v,w,Ln.backCCW,it,Pe,o.id,de.layoutVertexBuffer,de.indexBuffer,de.segments,o.paint,d.transform.zoom,ie,d.style.map.terrain&&de.centroidVertexBuffer)}}function gf(d,n,o,u,p,v,w){const E=d.context,C=E.gl,A=o.fbo;if(!A)return;const L=d.useProgram("hillshade"),z=d.style.map.terrain&&d.style.map.terrain.getTerrainData(n);E.activeTexture.set(C.TEXTURE0),C.bindTexture(C.TEXTURE_2D,A.colorAttachment.get()),L.draw(E,C.TRIANGLES,p,v,w,Ln.disabled,((U,Q,H,Y)=>{const se=H.paint.get("hillshade-shadow-color"),de=H.paint.get("hillshade-highlight-color"),Pe=H.paint.get("hillshade-accent-color");let ie=H.paint.get("hillshade-illumination-direction")*(Math.PI/180);H.paint.get("hillshade-illumination-anchor")==="viewport"&&(ie-=U.transform.angle);const Te=!U.options.moving;return{u_matrix:Y?Y.posMatrix:U.transform.calculatePosMatrix(Q.tileID.toUnwrapped(),Te),u_image:0,u_latrange:Wu(0,Q.tileID),u_light:[H.paint.get("hillshade-exaggeration"),ie],u_shadow:se,u_highlight:de,u_accent:Pe}})(d,o,u,z?n:null),z,u.id,d.rasterBoundsBuffer,d.quadTriangleIndexBuffer,d.rasterBoundsSegments)}function rh(d,n,o,u,p,v){const w=d.context,E=w.gl,C=n.dem;if(C&&C.data){const A=C.dim,L=C.stride,z=C.getPixels();if(w.activeTexture.set(E.TEXTURE1),w.pixelStoreUnpackPremultiplyAlpha.set(!1),n.demTexture=n.demTexture||d.getTileTexture(L),n.demTexture){const Q=n.demTexture;Q.update(z,{premultiply:!1}),Q.bind(E.NEAREST,E.CLAMP_TO_EDGE)}else n.demTexture=new Se(w,z,E.RGBA,{premultiply:!1}),n.demTexture.bind(E.NEAREST,E.CLAMP_TO_EDGE);w.activeTexture.set(E.TEXTURE0);let U=n.fbo;if(!U){const Q=new Se(w,{width:A,height:A,data:null},E.RGBA);Q.bind(E.LINEAR,E.CLAMP_TO_EDGE),U=n.fbo=w.createFramebuffer(A,A,!0,!1),U.colorAttachment.set(Q.texture)}w.bindFramebuffer.set(U.framebuffer),w.viewport.set([0,0,A,A]),d.useProgram("hillshadePrepare").draw(w,E.TRIANGLES,u,p,v,Ln.disabled,((Q,H)=>{const Y=H.stride,se=a.create();return a.ortho(se,0,a.EXTENT,-a.EXTENT,0,0,1),a.translate(se,se,[0,-a.EXTENT,0]),{u_matrix:se,u_image:1,u_dimension:[Y,Y],u_zoom:Q.overscaledZ,u_unpack:H.getUnpackVector()}})(n.tileID,C),null,o.id,d.rasterBoundsBuffer,d.quadTriangleIndexBuffer,d.rasterBoundsSegments),n.needsHillshadePrepare=!1}}function ni(d,n,o,u,p,v){const w=u.paint.get("raster-fade-duration");if(!v&&w>0){const E=a.exported.now(),C=(E-d.timeAdded)/w,A=n?(E-n.timeAdded)/w:-1,L=o.getSource(),z=p.coveringZoomLevel({tileSize:L.tileSize,roundZoom:L.roundZoom}),U=!n||Math.abs(n.tileID.overscaledZ-z)>Math.abs(d.tileID.overscaledZ-z),Q=U&&d.refreshedUponExpiration?1:a.clamp(U?C:1-A,0,1);return d.refreshedUponExpiration&&C>=1&&(d.refreshedUponExpiration=!1),n?{opacity:1,mix:1-Q}:{opacity:Q,mix:0}}return{opacity:1,mix:0}}const Us=new a.Color(1,0,0,1),xr=new a.Color(0,1,0,1),sh=new a.Color(0,0,1,1),_c=new a.Color(1,0,1,1),oh=new a.Color(0,1,1,1);function Ns(d,n,o,u){yo(d,0,n+o/2,d.transform.width,o,u)}function Xo(d,n,o,u){yo(d,n-o/2,0,o,d.transform.height,u)}function yo(d,n,o,u,p,v){const w=d.context,E=w.gl;E.enable(E.SCISSOR_TEST),E.scissor(n*d.pixelRatio,o*d.pixelRatio,u*d.pixelRatio,p*d.pixelRatio),w.clear({color:v}),E.disable(E.SCISSOR_TEST)}function ah(d,n,o){const u=d.context,p=u.gl,v=o.posMatrix,w=d.useProgram("debug"),E=cn.disabled,C=Bn.disabled,A=d.colorModeForRenderPass(),L="$debug",z=d.style.map.terrain&&d.style.map.terrain.getTerrainData(o);u.activeTexture.set(p.TEXTURE0);const U=n.getTileByID(o.key).latestRawTileData,Q=Math.floor((U&&U.byteLength||0)/1024),H=n.getTile(o).tileSize,Y=512/Math.min(H,512)*(o.overscaledZ/d.transform.zoom)*.5;let se=o.canonical.toString();o.overscaledZ!==o.canonical.z&&(se+=` => ${o.overscaledZ}`),function(de,Pe){de.initDebugOverlayCanvas();const ie=de.debugOverlayCanvas,Te=de.context.gl,De=de.debugOverlayCanvas.getContext("2d");De.clearRect(0,0,ie.width,ie.height),De.shadowColor="white",De.shadowBlur=2,De.lineWidth=1.5,De.strokeStyle="white",De.textBaseline="top",De.font="bold 36px Open Sans, sans-serif",De.fillText(Pe,5,5),De.strokeText(Pe,5,5),de.debugOverlayTexture.update(ie),de.debugOverlayTexture.bind(Te.LINEAR,Te.CLAMP_TO_EDGE)}(d,`${se} ${Q}kB`),w.draw(u,p.TRIANGLES,E,C,Gn.alphaBlended,Ln.disabled,nc(v,a.Color.transparent,Y),null,L,d.debugBuffer,d.quadTriangleIndexBuffer,d.debugSegments),w.draw(u,p.LINE_STRIP,E,C,A,Ln.disabled,nc(v,a.Color.red),z,L,d.debugBuffer,d.tileBorderIndexBuffer,d.debugSegments)}function vc(d,n,o){const u=d.context,p=u.gl,v=d.colorModeForRenderPass(),w=new cn(p.LEQUAL,cn.ReadWrite,d.depthRangeFor3D),E=d.useProgram("terrain"),C=n.getTerrainMesh();u.bindFramebuffer.set(null),u.viewport.set([0,0,d.width,d.height]);for(const A of o){const L=d.renderToTexture.getTexture(A),z=n.getTerrainData(A.tileID);u.activeTexture.set(p.TEXTURE0),p.bindTexture(p.TEXTURE_2D,L.texture);const U={u_matrix:d.transform.calculatePosMatrix(A.tileID.toUnwrapped()),u_texture:0,u_ele_delta:n.getMeshFrameDelta(d.transform.zoom)};E.draw(u,p.TRIANGLES,w,Bn.disabled,v,Ln.backCCW,U,z,"terrain",C.vertexBuffer,C.indexBuffer,C.segments)}}const xc={symbol:function(d,n,o,u,p){if(d.renderPass!=="translucent")return;const v=Bn.disabled,w=d.colorModeForRenderPass();o.layout.get("text-variable-anchor")&&function(E,C,A,L,z,U,Q){const H=C.transform,Y=z==="map",se=U==="map";for(const de of E){const Pe=L.getTile(de),ie=Pe.getBucket(A);if(!ie||!ie.text||!ie.text.segments.get().length)continue;const Te=a.evaluateSizeForZoom(ie.textSizeData,H.zoom),De=he(Pe,1,C.transform.zoom),Ye=Nt(de.posMatrix,se,Y,C.transform,De),it=A.layout.get("icon-text-fit")!=="none"&&ie.hasIconData();if(Te){const ct=Math.pow(2,H.zoom-Pe.tileID.overscaledZ);ih(ie,Y,se,Q,H,Ye,de.posMatrix,ct,Te,it,C.style.map.terrain?(et,bt)=>C.style.map.terrain.getElevation(de,et,bt):null)}}}(u,d,o,n,o.layout.get("text-rotation-alignment"),o.layout.get("text-pitch-alignment"),p),o.paint.get("icon-opacity").constantOr(1)!==0&&qa(d,n,o,u,!1,o.paint.get("icon-translate"),o.paint.get("icon-translate-anchor"),o.layout.get("icon-rotation-alignment"),o.layout.get("icon-pitch-alignment"),o.layout.get("icon-keep-upright"),v,w),o.paint.get("text-opacity").constantOr(1)!==0&&qa(d,n,o,u,!0,o.paint.get("text-translate"),o.paint.get("text-translate-anchor"),o.layout.get("text-rotation-alignment"),o.layout.get("text-pitch-alignment"),o.layout.get("text-keep-upright"),v,w),n.map.showCollisionBoxes&&(nh(d,n,o,u,o.paint.get("text-translate"),o.paint.get("text-translate-anchor"),!0),nh(d,n,o,u,o.paint.get("icon-translate"),o.paint.get("icon-translate-anchor"),!1))},circle:function(d,n,o,u){if(d.renderPass!=="translucent")return;const p=o.paint.get("circle-opacity"),v=o.paint.get("circle-stroke-width"),w=o.paint.get("circle-stroke-opacity"),E=!o.layout.get("circle-sort-key").isConstant();if(p.constantOr(1)===0&&(v.constantOr(1)===0||w.constantOr(1)===0))return;const C=d.context,A=C.gl,L=d.depthModeForSublayer(0,cn.ReadOnly),z=Bn.disabled,U=d.colorModeForRenderPass(),Q=[];for(let H=0;H<u.length;H++){const Y=u[H],se=n.getTile(Y),de=se.getBucket(o);if(!de)continue;const Pe=de.programConfigurations.get(o.id),ie=d.useProgram("circle",Pe),Te=de.layoutVertexBuffer,De=de.indexBuffer,Ye=d.style.map.terrain&&d.style.map.terrain.getTerrainData(Y),it={programConfiguration:Pe,program:ie,layoutVertexBuffer:Te,indexBuffer:De,uniformValues:sf(d,Y,se,o),terrainData:Ye};if(E){const ct=de.segments.get();for(const et of ct)Q.push({segments:new a.SegmentVector([et]),sortKey:et.sortKey,state:it})}else Q.push({segments:de.segments,sortKey:0,state:it})}E&&Q.sort((H,Y)=>H.sortKey-Y.sortKey);for(const H of Q){const{programConfiguration:Y,program:se,layoutVertexBuffer:de,indexBuffer:Pe,uniformValues:ie,terrainData:Te}=H.state;se.draw(C,A.TRIANGLES,L,z,U,Ln.disabled,ie,Te,o.id,de,Pe,H.segments,o.paint,d.transform.zoom,Y)}},heatmap:function(d,n,o,u){if(o.paint.get("heatmap-opacity")!==0)if(d.renderPass==="offscreen"){const p=d.context,v=p.gl,w=Bn.disabled,E=new Gn([v.ONE,v.ONE],a.Color.transparent,[!0,!0,!0,!0]);(function(C,A,L){const z=C.gl;C.activeTexture.set(z.TEXTURE1),C.viewport.set([0,0,A.width/4,A.height/4]);let U=L.heatmapFbo;if(U)z.bindTexture(z.TEXTURE_2D,U.colorAttachment.get()),C.bindFramebuffer.set(U.framebuffer);else{const Q=z.createTexture();z.bindTexture(z.TEXTURE_2D,Q),z.texParameteri(z.TEXTURE_2D,z.TEXTURE_WRAP_S,z.CLAMP_TO_EDGE),z.texParameteri(z.TEXTURE_2D,z.TEXTURE_WRAP_T,z.CLAMP_TO_EDGE),z.texParameteri(z.TEXTURE_2D,z.TEXTURE_MIN_FILTER,z.LINEAR),z.texParameteri(z.TEXTURE_2D,z.TEXTURE_MAG_FILTER,z.LINEAR),U=L.heatmapFbo=C.createFramebuffer(A.width/4,A.height/4,!1,!1),function(H,Y,se,de){var Pe,ie;const Te=H.gl,De=(Pe=H.HALF_FLOAT)!==null&&Pe!==void 0?Pe:Te.UNSIGNED_BYTE,Ye=(ie=H.RGBA16F)!==null&&ie!==void 0?ie:Te.RGBA;Te.texImage2D(Te.TEXTURE_2D,0,Ye,Y.width/4,Y.height/4,0,Te.RGBA,De,null),de.colorAttachment.set(se)}(C,A,Q,U)}})(p,d,o),p.clear({color:a.Color.transparent});for(let C=0;C<u.length;C++){const A=u[C];if(n.hasRenderableParent(A))continue;const L=n.getTile(A),z=L.getBucket(o);if(!z)continue;const U=z.programConfigurations.get(o.id),Q=d.useProgram("heatmap",U),{zoom:H}=d.transform;Q.draw(p,v.TRIANGLES,cn.disabled,w,E,Ln.disabled,Gu(A.posMatrix,L,H,o.paint.get("heatmap-intensity")),null,o.id,z.layoutVertexBuffer,z.indexBuffer,z.segments,o.paint,d.transform.zoom,U)}p.viewport.set([0,0,d.width,d.height])}else d.renderPass==="translucent"&&(d.context.setColorMode(d.colorModeForRenderPass()),function(p,v){const w=p.context,E=w.gl,C=v.heatmapFbo;if(!C)return;w.activeTexture.set(E.TEXTURE0),E.bindTexture(E.TEXTURE_2D,C.colorAttachment.get()),w.activeTexture.set(E.TEXTURE1);let A=v.colorRampTexture;A||(A=v.colorRampTexture=new Se(w,v.colorRamp,E.RGBA)),A.bind(E.LINEAR,E.CLAMP_TO_EDGE),p.useProgram("heatmapTexture").draw(w,E.TRIANGLES,cn.disabled,Bn.disabled,p.colorModeForRenderPass(),Ln.disabled,((L,z,U,Q)=>{const H=a.create();a.ortho(H,0,L.width,L.height,0,0,1);const Y=L.context.gl;return{u_matrix:H,u_world:[Y.drawingBufferWidth,Y.drawingBufferHeight],u_image:0,u_color_ramp:1,u_opacity:z.paint.get("heatmap-opacity")}})(p,v),null,v.id,p.viewportBuffer,p.quadTriangleIndexBuffer,p.viewportSegments,v.paint,p.transform.zoom)}(d,o))},line:function(d,n,o,u){if(d.renderPass!=="translucent")return;const p=o.paint.get("line-opacity"),v=o.paint.get("line-width");if(p.constantOr(1)===0||v.constantOr(1)===0)return;const w=d.depthModeForSublayer(0,cn.ReadOnly),E=d.colorModeForRenderPass(),C=o.paint.get("line-dasharray"),A=o.paint.get("line-pattern"),L=A.constantOr(1),z=o.paint.get("line-gradient"),U=o.getCrossfadeParameters(),Q=L?"linePattern":C?"lineSDF":z?"lineGradient":"line",H=d.context,Y=H.gl;let se=!0;for(const de of u){const Pe=n.getTile(de);if(L&&!Pe.patternsLoaded())continue;const ie=Pe.getBucket(o);if(!ie)continue;const Te=ie.programConfigurations.get(o.id),De=d.context.program.get(),Ye=d.useProgram(Q,Te),it=se||Ye.program!==De,ct=d.style.map.terrain&&d.style.map.terrain.getTerrainData(de),et=A.constantOr(null);if(et&&Pe.imageAtlas){const Jt=Pe.imageAtlas,pt=Jt.patternPositions[et.to.toString()],Zt=Jt.patternPositions[et.from.toString()];pt&&Zt&&Te.setConstantPatternPositions(pt,Zt)}const bt=ct?de:null,Ot=L?vr(d,Pe,o,U,bt):C?Da(d,Pe,o,C,U,bt):z?Ma(d,Pe,o,ie.lineClipsArray.length,bt):os(d,Pe,o,bt);if(L)H.activeTexture.set(Y.TEXTURE0),Pe.imageAtlasTexture.bind(Y.LINEAR,Y.CLAMP_TO_EDGE),Te.updatePaintBuffers(U);else if(C&&(it||d.lineAtlas.dirty))H.activeTexture.set(Y.TEXTURE0),d.lineAtlas.bind(H);else if(z){const Jt=ie.gradients[o.id];let pt=Jt.texture;if(o.gradientVersion!==Jt.version){let Zt=256;if(o.stepInterpolant){const St=n.getSource().maxzoom,_n=de.canonical.z===St?Math.ceil(1<<d.transform.maxZoom-de.canonical.z):1;Zt=a.clamp(a.nextPowerOfTwo(ie.maxLineLength/a.EXTENT*1024*_n),256,H.maxTextureSize)}Jt.gradient=a.renderColorRamp({expression:o.gradientExpression(),evaluationKey:"lineProgress",resolution:Zt,image:Jt.gradient||void 0,clips:ie.lineClipsArray}),Jt.texture?Jt.texture.update(Jt.gradient):Jt.texture=new Se(H,Jt.gradient,Y.RGBA),Jt.version=o.gradientVersion,pt=Jt.texture}H.activeTexture.set(Y.TEXTURE0),pt.bind(o.stepInterpolant?Y.NEAREST:Y.LINEAR,Y.CLAMP_TO_EDGE)}Ye.draw(H,Y.TRIANGLES,w,d.stencilModeForClipping(de),E,Ln.disabled,Ot,ct,o.id,ie.layoutVertexBuffer,ie.indexBuffer,ie.segments,o.paint,d.transform.zoom,Te,ie.layoutVertexBuffer2),se=!1}},fill:function(d,n,o,u){const p=o.paint.get("fill-color"),v=o.paint.get("fill-opacity");if(v.constantOr(1)===0)return;const w=d.colorModeForRenderPass(),E=o.paint.get("fill-pattern"),C=d.opaquePassEnabledForLayer()&&!E.constantOr(1)&&p.constantOr(a.Color.transparent).a===1&&v.constantOr(0)===1?"opaque":"translucent";if(d.renderPass===C){const A=d.depthModeForSublayer(1,d.renderPass==="opaque"?cn.ReadWrite:cn.ReadOnly);Wo(d,n,o,u,A,w,!1)}if(d.renderPass==="translucent"&&o.paint.get("fill-antialias")){const A=d.depthModeForSublayer(o.getPaintProperty("fill-outline-color")?2:0,cn.ReadOnly);Wo(d,n,o,u,A,w,!0)}},"fill-extrusion":function(d,n,o,u){const p=o.paint.get("fill-extrusion-opacity");if(p!==0&&d.renderPass==="translucent"){const v=new cn(d.context.gl.LEQUAL,cn.ReadWrite,d.depthRangeFor3D);if(p!==1||o.paint.get("fill-extrusion-pattern").constantOr(1))Ho(d,n,o,u,v,Bn.disabled,Gn.disabled),Ho(d,n,o,u,v,d.stencilModeFor3D(),d.colorModeForRenderPass());else{const w=d.colorModeForRenderPass();Ho(d,n,o,u,v,Bn.disabled,w)}}},hillshade:function(d,n,o,u){if(d.renderPass!=="offscreen"&&d.renderPass!=="translucent")return;const p=d.context,v=d.depthModeForSublayer(0,cn.ReadOnly),w=d.colorModeForRenderPass(),[E,C]=d.renderPass==="translucent"?d.stencilConfigForOverlap(u):[{},u];for(const A of C){const L=n.getTile(A);L.needsHillshadePrepare!==void 0&&L.needsHillshadePrepare&&d.renderPass==="offscreen"?rh(d,L,o,v,Bn.disabled,w):d.renderPass==="translucent"&&gf(d,A,L,o,v,E[A.overscaledZ],w)}p.viewport.set([0,0,d.width,d.height])},raster:function(d,n,o,u){if(d.renderPass!=="translucent"||o.paint.get("raster-opacity")===0||!u.length)return;const p=d.context,v=p.gl,w=n.getSource(),E=d.useProgram("raster"),C=d.colorModeForRenderPass(),[A,L]=w instanceof K?[{},u]:d.stencilConfigForOverlap(u),z=L[L.length-1].overscaledZ,U=!d.options.moving;for(const Q of L){const H=d.depthModeForSublayer(Q.overscaledZ-z,o.paint.get("raster-opacity")===1?cn.ReadWrite:cn.ReadOnly,v.LESS),Y=n.getTile(Q);Y.registerFadeDuration(o.paint.get("raster-fade-duration"));const se=n.findLoadedParent(Q,0),de=ni(Y,se,n,o,d.transform,d.style.map.terrain);let Pe,ie;const Te=o.paint.get("raster-resampling")==="nearest"?v.NEAREST:v.LINEAR;p.activeTexture.set(v.TEXTURE0),Y.texture.bind(Te,v.CLAMP_TO_EDGE,v.LINEAR_MIPMAP_NEAREST),p.activeTexture.set(v.TEXTURE1),se?(se.texture.bind(Te,v.CLAMP_TO_EDGE,v.LINEAR_MIPMAP_NEAREST),Pe=Math.pow(2,se.tileID.overscaledZ-Y.tileID.overscaledZ),ie=[Y.tileID.canonical.x*Pe%1,Y.tileID.canonical.y*Pe%1]):Y.texture.bind(Te,v.CLAMP_TO_EDGE,v.LINEAR_MIPMAP_NEAREST);const De=d.style.map.terrain&&d.style.map.terrain.getTerrainData(Q),Ye=De?Q:null,it=Ye?Ye.posMatrix:d.transform.calculatePosMatrix(Q.toUnwrapped(),U),ct=za(it,ie||[0,0],Pe||1,de,o);w instanceof K?E.draw(p,v.TRIANGLES,H,Bn.disabled,C,Ln.disabled,ct,De,o.id,w.boundsBuffer,d.quadTriangleIndexBuffer,w.boundsSegments):E.draw(p,v.TRIANGLES,H,A[Q.overscaledZ],C,Ln.disabled,ct,De,o.id,d.rasterBoundsBuffer,d.quadTriangleIndexBuffer,d.rasterBoundsSegments)}},background:function(d,n,o,u){const p=o.paint.get("background-color"),v=o.paint.get("background-opacity");if(v===0)return;const w=d.context,E=w.gl,C=d.transform,A=C.tileSize,L=o.paint.get("background-pattern");if(d.isPatternMissing(L))return;const z=!L&&p.a===1&&v===1&&d.opaquePassEnabledForLayer()?"opaque":"translucent";if(d.renderPass!==z)return;const U=Bn.disabled,Q=d.depthModeForSublayer(0,z==="opaque"?cn.ReadWrite:cn.ReadOnly),H=d.colorModeForRenderPass(),Y=d.useProgram(L?"backgroundPattern":"background"),se=u||C.coveringTiles({tileSize:A,terrain:d.style.map.terrain});L&&(w.activeTexture.set(E.TEXTURE0),d.imageManager.bind(d.context));const de=o.getCrossfadeParameters();for(const Pe of se){const ie=u?Pe.posMatrix:d.transform.calculatePosMatrix(Pe.toUnwrapped()),Te=L?ir(ie,v,d,L,{tileID:Pe,tileSize:A},de):nr(ie,v,p),De=d.style.map.terrain&&d.style.map.terrain.getTerrainData(Pe);Y.draw(w,E.TRIANGLES,Q,U,H,Ln.disabled,Te,De,o.id,d.tileExtentBuffer,d.quadTriangleIndexBuffer,d.tileExtentSegments)}},debug:function(d,n,o){for(let u=0;u<o.length;u++)ah(d,n,o[u])},custom:function(d,n,o){const u=d.context,p=o.implementation;if(d.renderPass==="offscreen"){const v=p.prerender;v&&(d.setCustomLayerDefaults(),u.setColorMode(d.colorModeForRenderPass()),v.call(p,u.gl,d.transform.customLayerMatrix()),u.setDirty(),d.setBaseState())}else if(d.renderPass==="translucent"){d.setCustomLayerDefaults(),u.setColorMode(d.colorModeForRenderPass()),u.setStencilMode(Bn.disabled);const v=p.renderingMode==="3d"?new cn(d.context.gl.LEQUAL,cn.ReadWrite,d.depthRangeFor3D):d.depthModeForSublayer(0,cn.ReadOnly);u.setDepthMode(v),p.render(u.gl,d.transform.customLayerMatrix()),u.setDirty(),d.setBaseState(),u.bindFramebuffer.set(null)}}};class lh{constructor(n,o){this.context=new pc(n),this.transform=o,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:a.create(),renderTime:0},this.setup(),this.numSublayers=lt.maxUnderzooming+lt.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new ws}resize(n,o,u){if(this.width=n*u,this.height=o*u,this.pixelRatio=u,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const p of this.style._order)this.style._layers[p].resize()}setup(){const n=this.context,o=new a.PosArray;o.emplaceBack(0,0),o.emplaceBack(a.EXTENT,0),o.emplaceBack(0,a.EXTENT),o.emplaceBack(a.EXTENT,a.EXTENT),this.tileExtentBuffer=n.createVertexBuffer(o,Jl.members),this.tileExtentSegments=a.SegmentVector.simpleSegment(0,0,4,2);const u=new a.PosArray;u.emplaceBack(0,0),u.emplaceBack(a.EXTENT,0),u.emplaceBack(0,a.EXTENT),u.emplaceBack(a.EXTENT,a.EXTENT),this.debugBuffer=n.createVertexBuffer(u,Jl.members),this.debugSegments=a.SegmentVector.simpleSegment(0,0,4,5);const p=new a.RasterBoundsArray;p.emplaceBack(0,0,0,0),p.emplaceBack(a.EXTENT,0,a.EXTENT,0),p.emplaceBack(0,a.EXTENT,0,a.EXTENT),p.emplaceBack(a.EXTENT,a.EXTENT,a.EXTENT,a.EXTENT),this.rasterBoundsBuffer=n.createVertexBuffer(p,wt.members),this.rasterBoundsSegments=a.SegmentVector.simpleSegment(0,0,4,2);const v=new a.PosArray;v.emplaceBack(0,0),v.emplaceBack(1,0),v.emplaceBack(0,1),v.emplaceBack(1,1),this.viewportBuffer=n.createVertexBuffer(v,Jl.members),this.viewportSegments=a.SegmentVector.simpleSegment(0,0,4,2);const w=new a.LineStripIndexArray;w.emplaceBack(0),w.emplaceBack(1),w.emplaceBack(3),w.emplaceBack(2),w.emplaceBack(0),this.tileBorderIndexBuffer=n.createIndexBuffer(w);const E=new a.TriangleIndexArray;E.emplaceBack(0,1,2),E.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=n.createIndexBuffer(E);const C=this.context.gl;this.stencilClearMode=new Bn({func:C.ALWAYS,mask:0},0,255,C.ZERO,C.ZERO,C.ZERO)}clearStencil(){const n=this.context,o=n.gl;this.nextStencilID=1,this.currentStencilSource=void 0;const u=a.create();a.ortho(u,0,this.width,this.height,0,0,1),a.scale(u,u,[o.drawingBufferWidth,o.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(n,o.TRIANGLES,cn.disabled,this.stencilClearMode,Gn.disabled,Ln.disabled,ic(u),null,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(n,o){if(this.currentStencilSource===n.source||!n.isTileClipped()||!o||!o.length)return;this.currentStencilSource=n.source;const u=this.context,p=u.gl;this.nextStencilID+o.length>256&&this.clearStencil(),u.setColorMode(Gn.disabled),u.setDepthMode(cn.disabled);const v=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const w of o){const E=this._tileClippingMaskIDs[w.key]=this.nextStencilID++,C=this.style.map.terrain&&this.style.map.terrain.getTerrainData(w);v.draw(u,p.TRIANGLES,cn.disabled,new Bn({func:p.ALWAYS,mask:0},E,255,p.KEEP,p.KEEP,p.REPLACE),Gn.disabled,Ln.disabled,ic(w.posMatrix),C,"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const n=this.nextStencilID++,o=this.context.gl;return new Bn({func:o.NOTEQUAL,mask:255},n,255,o.KEEP,o.KEEP,o.REPLACE)}stencilModeForClipping(n){const o=this.context.gl;return new Bn({func:o.EQUAL,mask:255},this._tileClippingMaskIDs[n.key],0,o.KEEP,o.KEEP,o.REPLACE)}stencilConfigForOverlap(n){const o=this.context.gl,u=n.sort((w,E)=>E.overscaledZ-w.overscaledZ),p=u[u.length-1].overscaledZ,v=u[0].overscaledZ-p+1;if(v>1){this.currentStencilSource=void 0,this.nextStencilID+v>256&&this.clearStencil();const w={};for(let E=0;E<v;E++)w[E+p]=new Bn({func:o.GEQUAL,mask:255},E+this.nextStencilID,255,o.KEEP,o.KEEP,o.REPLACE);return this.nextStencilID+=v,[w,u]}return[{[p]:Bn.disabled},u]}colorModeForRenderPass(){const n=this.context.gl;return this._showOverdrawInspector?new Gn([n.CONSTANT_COLOR,n.ONE],new a.Color(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?Gn.unblended:Gn.alphaBlended}depthModeForSublayer(n,o,u){if(!this.opaquePassEnabledForLayer())return cn.disabled;const p=1-((1+this.currentLayer)*this.numSublayers+n)*this.depthEpsilon;return new cn(u||this.context.gl.LEQUAL,o,[p,p])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(n,o){this.style=n,this.options=o,this.lineAtlas=n.lineAtlas,this.imageManager=n.imageManager,this.glyphManager=n.glyphManager,this.symbolFadeChange=n.placement.symbolFadeChange(a.exported.now()),this.imageManager.beginFrame();const u=this.style._order,p=this.style.sourceCaches,v={},w={},E={};for(const C in p){const A=p[C];A.used&&A.prepare(this.context),v[C]=A.getVisibleCoordinates(),w[C]=v[C].slice().reverse(),E[C]=A.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let C=0;C<u.length;C++)if(this.style._layers[u[C]].is3D()){this.opaquePassCutoff=C;break}if(this.renderToTexture){this.renderToTexture.prepareForRender(this.style,this.transform.zoom),this.opaquePassCutoff=0;const C=this.style.map.terrain.sourceCache.tilesAfterTime(this.terrainFacilitator.renderTime);(this.terrainFacilitator.dirty||!a.equals(this.terrainFacilitator.matrix,this.transform.projMatrix)||C.length)&&(a.copy(this.terrainFacilitator.matrix,this.transform.projMatrix),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,function(A,L){const z=A.context,U=z.gl,Q=Gn.unblended,H=new cn(U.LEQUAL,cn.ReadWrite,[0,1]),Y=L.getTerrainMesh(),se=L.sourceCache.getRenderableTiles(),de=A.useProgram("terrainDepth");z.bindFramebuffer.set(L.getFramebuffer("depth").framebuffer),z.viewport.set([0,0,A.width/devicePixelRatio,A.height/devicePixelRatio]),z.clear({color:a.Color.transparent,depth:1});for(const Pe of se){const ie=L.getTerrainData(Pe.tileID),Te={u_matrix:A.transform.calculatePosMatrix(Pe.tileID.toUnwrapped()),u_ele_delta:L.getMeshFrameDelta(A.transform.zoom)};de.draw(z,U.TRIANGLES,H,Bn.disabled,Q,Ln.backCCW,Te,ie,"terrain",Y.vertexBuffer,Y.indexBuffer,Y.segments)}z.bindFramebuffer.set(null),z.viewport.set([0,0,A.width,A.height])}(this,this.style.map.terrain),function(A,L){const z=A.context,U=z.gl,Q=Gn.unblended,H=new cn(U.LEQUAL,cn.ReadWrite,[0,1]),Y=L.getTerrainMesh(),se=L.getCoordsTexture(),de=L.sourceCache.getRenderableTiles(),Pe=A.useProgram("terrainCoords");z.bindFramebuffer.set(L.getFramebuffer("coords").framebuffer),z.viewport.set([0,0,A.width/devicePixelRatio,A.height/devicePixelRatio]),z.clear({color:a.Color.transparent,depth:1}),L.coordsIndex=[];for(const ie of de){const Te=L.getTerrainData(ie.tileID);z.activeTexture.set(U.TEXTURE0),U.bindTexture(U.TEXTURE_2D,se.texture);const De={u_matrix:A.transform.calculatePosMatrix(ie.tileID.toUnwrapped()),u_terrain_coords_id:(255-L.coordsIndex.length)/255,u_texture:0,u_ele_delta:L.getMeshFrameDelta(A.transform.zoom)};Pe.draw(z,U.TRIANGLES,H,Bn.disabled,Q,Ln.backCCW,De,Te,"terrain",Y.vertexBuffer,Y.indexBuffer,Y.segments),L.coordsIndex.push(ie.tileID.key)}z.bindFramebuffer.set(null),z.viewport.set([0,0,A.width,A.height])}(this,this.style.map.terrain))}this.renderPass="offscreen";for(const C of u){const A=this.style._layers[C];if(!A.hasOffscreenPass()||A.isHidden(this.transform.zoom))continue;const L=w[A.source];(A.type==="custom"||L.length)&&this.renderLayer(this,p[A.source],A,L)}if(this.context.bindFramebuffer.set(null),this.context.clear({color:o.showOverdrawInspector?a.Color.black:a.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=o.showOverdrawInspector,this.depthRangeFor3D=[0,1-(n._order.length+2)*this.numSublayers*this.depthEpsilon],!this.renderToTexture)for(this.renderPass="opaque",this.currentLayer=u.length-1;this.currentLayer>=0;this.currentLayer--){const C=this.style._layers[u[this.currentLayer]],A=p[C.source],L=v[C.source];this._renderTileClippingMasks(C,L),this.renderLayer(this,A,C,L)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<u.length;this.currentLayer++){const C=this.style._layers[u[this.currentLayer]],A=p[C.source];if(this.renderToTexture&&this.renderToTexture.renderLayer(C))continue;const L=(C.type==="symbol"?E:w)[C.source];this._renderTileClippingMasks(C,v[C.source]),this.renderLayer(this,A,C,L)}if(this.options.showTileBoundaries){const C=function(A,L){let z=null;const U=Object.values(A._layers).flatMap(se=>se.source&&!se.isHidden(L)?[A.sourceCaches[se.source]]:[]),Q=U.filter(se=>se.getSource().type==="vector"),H=U.filter(se=>se.getSource().type!=="vector"),Y=se=>{(!z||z.getSource().maxzoom<se.getSource().maxzoom)&&(z=se)};return Q.forEach(se=>Y(se)),z||H.forEach(se=>Y(se)),z}(this.style,this.transform.zoom);C&&xc.debug(this,C,C.getVisibleCoordinates())}this.options.showPadding&&function(C){const A=C.transform.padding;Ns(C,C.transform.height-(A.top||0),3,Us),Ns(C,A.bottom||0,3,xr),Xo(C,A.left||0,3,sh),Xo(C,C.transform.width-(A.right||0),3,_c);const L=C.transform.centerPoint;(function(z,U,Q,H){yo(z,U-1,Q-10,2,20,H),yo(z,U-10,Q-1,20,2,H)})(C,L.x,C.transform.height-L.y,oh)}(this),this.context.setDefault()}renderLayer(n,o,u,p){u.isHidden(this.transform.zoom)||(u.type==="background"||u.type==="custom"||(p||[]).length)&&(this.id=u.id,xc[u.type](n,o,u,p,this.style.placement.variableOffsets))}translatePosMatrix(n,o,u,p,v){if(!u[0]&&!u[1])return n;const w=v?p==="map"?this.transform.angle:0:p==="viewport"?-this.transform.angle:0;if(w){const A=Math.sin(w),L=Math.cos(w);u=[u[0]*L-u[1]*A,u[0]*A+u[1]*L]}const E=[v?u[0]:he(o,u[0],this.transform.zoom),v?u[1]:he(o,u[1],this.transform.zoom),0],C=new Float32Array(16);return a.translate(C,n,E),C}saveTileTexture(n){const o=this._tileTextures[n.size[0]];o?o.push(n):this._tileTextures[n.size[0]]=[n]}getTileTexture(n){const o=this._tileTextures[n];return o&&o.length>0?o.pop():null}isPatternMissing(n){if(!n)return!1;if(!n.from||!n.to)return!0;const o=this.imageManager.getPattern(n.from.toString()),u=this.imageManager.getPattern(n.to.toString());return!o||!u}useProgram(n,o){this.cache=this.cache||{};const u=n+(o?o.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"")+(this.style.map.terrain?"/terrain":"");return this.cache[u]||(this.cache[u]=new ka(this.context,n,Ss[n],o,rc[n],this._showOverdrawInspector,this.style.map.terrain)),this.cache[u]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const n=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(n.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new Se(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}}class Za{constructor(n,o){this.points=n,this.planes=o}static fromInvProjectionMatrix(n,o,u){const p=Math.pow(2,u),v=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(E=>{const C=1/(E=a.transformMat4([],E,n))[3]/o*p;return a.mul$1(E,E,[C,C,1/E[3],C])}),w=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(E=>{const C=function(U,Q){var H=Q[0],Y=Q[1],se=Q[2],de=H*H+Y*Y+se*se;return de>0&&(de=1/Math.sqrt(de)),U[0]=Q[0]*de,U[1]=Q[1]*de,U[2]=Q[2]*de,U}([],function(U,Q,H){var Y=Q[0],se=Q[1],de=Q[2],Pe=H[0],ie=H[1],Te=H[2];return U[0]=se*Te-de*ie,U[1]=de*Pe-Y*Te,U[2]=Y*ie-se*Pe,U}([],ze([],v[E[0]],v[E[1]]),ze([],v[E[2]],v[E[1]]))),A=-((L=C)[0]*(z=v[E[1]])[0]+L[1]*z[1]+L[2]*z[2]);var L,z;return C.concat(A)});return new Za(v,w)}}class qr{constructor(n,o){this.min=n,this.max=o,this.center=function(u,p,v){return u[0]=.5*p[0],u[1]=.5*p[1],u[2]=.5*p[2],u}([],function(u,p,v){return u[0]=p[0]+v[0],u[1]=p[1]+v[1],u[2]=p[2]+v[2],u}([],this.min,this.max))}quadrant(n){const o=[n%2==0,n<2],u=Qe(this.min),p=Qe(this.max);for(let v=0;v<o.length;v++)u[v]=o[v]?this.min[v]:this.center[v],p[v]=o[v]?this.center[v]:this.max[v];return p[2]=this.max[2],new qr(u,p)}distanceX(n){return Math.max(Math.min(this.max[0],n[0]),this.min[0])-n[0]}distanceY(n){return Math.max(Math.min(this.max[1],n[1]),this.min[1])-n[1]}intersects(n){const o=[[this.min[0],this.min[1],this.min[2],1],[this.max[0],this.min[1],this.min[2],1],[this.max[0],this.max[1],this.min[2],1],[this.min[0],this.max[1],this.min[2],1],[this.min[0],this.min[1],this.max[2],1],[this.max[0],this.min[1],this.max[2],1],[this.max[0],this.max[1],this.max[2],1],[this.min[0],this.max[1],this.max[2],1]];let u=!0;for(let p=0;p<n.planes.length;p++){const v=n.planes[p];let w=0;for(let E=0;E<o.length;E++)a.dot(v,o[E])>=0&&w++;if(w===0)return 0;w!==o.length&&(u=!1)}if(u)return 2;for(let p=0;p<3;p++){let v=Number.MAX_VALUE,w=-Number.MAX_VALUE;for(let E=0;E<n.points.length;E++){const C=n.points[E][p]-this.min[p];v=Math.min(v,C),w=Math.max(w,C)}if(w<0||v>this.max[p]-this.min[p])return 0}return 1}}class Ga{constructor(n=0,o=0,u=0,p=0){if(isNaN(n)||n<0||isNaN(o)||o<0||isNaN(u)||u<0||isNaN(p)||p<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=n,this.bottom=o,this.left=u,this.right=p}interpolate(n,o,u){return o.top!=null&&n.top!=null&&(this.top=a.interpolate.number(n.top,o.top,u)),o.bottom!=null&&n.bottom!=null&&(this.bottom=a.interpolate.number(n.bottom,o.bottom,u)),o.left!=null&&n.left!=null&&(this.left=a.interpolate.number(n.left,o.left,u)),o.right!=null&&n.right!=null&&(this.right=a.interpolate.number(n.right,o.right,u)),this}getCenter(n,o){const u=a.clamp((this.left+n-this.right)/2,0,n),p=a.clamp((this.top+o-this.bottom)/2,0,o);return new a.Point(u,p)}equals(n){return this.top===n.top&&this.bottom===n.bottom&&this.left===n.left&&this.right===n.right}clone(){return new Ga(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}class Wa{constructor(n,o,u,p,v){this.tileSize=512,this.maxValidLatitude=85.051129,this.freezeElevation=!1,this._renderWorldCopies=v===void 0||!!v,this._minZoom=n||0,this._maxZoom=o||22,this._minPitch=u??0,this._maxPitch=p??60,this.setMaxBounds(),this.width=0,this.height=0,this._center=new a.LngLat(0,0),this._elevation=0,this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new Ga,this._posMatrixCache={},this._alignedPosMatrixCache={}}clone(){const n=new Wa(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return n.apply(this),n}apply(n){this.tileSize=n.tileSize,this.latRange=n.latRange,this.width=n.width,this.height=n.height,this._center=n._center,this._elevation=n._elevation,this.zoom=n.zoom,this.angle=n.angle,this._fov=n._fov,this._pitch=n._pitch,this._unmodified=n._unmodified,this._edgeInsets=n._edgeInsets.clone(),this._calcMatrices()}get minZoom(){return this._minZoom}set minZoom(n){this._minZoom!==n&&(this._minZoom=n,this.zoom=Math.max(this.zoom,n))}get maxZoom(){return this._maxZoom}set maxZoom(n){this._maxZoom!==n&&(this._maxZoom=n,this.zoom=Math.min(this.zoom,n))}get minPitch(){return this._minPitch}set minPitch(n){this._minPitch!==n&&(this._minPitch=n,this.pitch=Math.max(this.pitch,n))}get maxPitch(){return this._maxPitch}set maxPitch(n){this._maxPitch!==n&&(this._maxPitch=n,this.pitch=Math.min(this.pitch,n))}get renderWorldCopies(){return this._renderWorldCopies}set renderWorldCopies(n){n===void 0?n=!0:n===null&&(n=!1),this._renderWorldCopies=n}get worldSize(){return this.tileSize*this.scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new a.Point(this.width,this.height)}get bearing(){return-this.angle/Math.PI*180}set bearing(n){const o=-a.wrap(n,-180,180)*Math.PI/180;this.angle!==o&&(this._unmodified=!1,this.angle=o,this._calcMatrices(),this.rotationMatrix=function(){var u=new a.ARRAY_TYPE(4);return a.ARRAY_TYPE!=Float32Array&&(u[1]=0,u[2]=0),u[0]=1,u[3]=1,u}(),function(u,p,v){var w=p[0],E=p[1],C=p[2],A=p[3],L=Math.sin(v),z=Math.cos(v);u[0]=w*z+C*L,u[1]=E*z+A*L,u[2]=w*-L+C*z,u[3]=E*-L+A*z}(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(n){const o=a.clamp(n,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==o&&(this._unmodified=!1,this._pitch=o,this._calcMatrices())}get fov(){return this._fov/Math.PI*180}set fov(n){n=Math.max(.01,Math.min(60,n)),this._fov!==n&&(this._unmodified=!1,this._fov=n/180*Math.PI,this._calcMatrices())}get zoom(){return this._zoom}set zoom(n){const o=Math.min(Math.max(n,this.minZoom),this.maxZoom);this._zoom!==o&&(this._unmodified=!1,this._zoom=o,this.tileZoom=Math.max(0,Math.floor(o)),this.scale=this.zoomScale(o),this._constrain(),this._calcMatrices())}get center(){return this._center}set center(n){n.lat===this._center.lat&&n.lng===this._center.lng||(this._unmodified=!1,this._center=n,this._constrain(),this._calcMatrices())}get elevation(){return this._elevation}set elevation(n){n!==this._elevation&&(this._elevation=n,this._constrain(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}set padding(n){this._edgeInsets.equals(n)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,n,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}isPaddingEqual(n){return this._edgeInsets.equals(n)}interpolatePadding(n,o,u){this._unmodified=!1,this._edgeInsets.interpolate(n,o,u),this._constrain(),this._calcMatrices()}coveringZoomLevel(n){const o=(n.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/n.tileSize));return Math.max(0,o)}getVisibleUnwrappedCoordinates(n){const o=[new a.UnwrappedTileID(0,n)];if(this._renderWorldCopies){const u=this.pointCoordinate(new a.Point(0,0)),p=this.pointCoordinate(new a.Point(this.width,0)),v=this.pointCoordinate(new a.Point(this.width,this.height)),w=this.pointCoordinate(new a.Point(0,this.height)),E=Math.floor(Math.min(u.x,p.x,v.x,w.x)),C=Math.floor(Math.max(u.x,p.x,v.x,w.x)),A=1;for(let L=E-A;L<=C+A;L++)L!==0&&o.push(new a.UnwrappedTileID(L,n))}return o}coveringTiles(n){var o,u;let p=this.coveringZoomLevel(n);const v=p;if(n.minzoom!==void 0&&p<n.minzoom)return[];n.maxzoom!==void 0&&p>n.maxzoom&&(p=n.maxzoom);const w=this.pointCoordinate(this.getCameraPoint()),E=a.MercatorCoordinate.fromLngLat(this.center),C=Math.pow(2,p),A=[C*w.x,C*w.y,0],L=[C*E.x,C*E.y,0],z=Za.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,p);let U=n.minzoom||0;!n.terrain&&this.pitch<=60&&this._edgeInsets.top<.1&&(U=p);const Q=n.terrain?2/Math.min(this.tileSize,n.tileSize)*this.tileSize:3,H=ie=>({aabb:new qr([ie*C,0,0],[(ie+1)*C,C,0]),zoom:0,x:0,y:0,wrap:ie,fullyVisible:!1}),Y=[],se=[],de=p,Pe=n.reparseOverscaled?v:p;if(this._renderWorldCopies)for(let ie=1;ie<=3;ie++)Y.push(H(-ie)),Y.push(H(ie));for(Y.push(H(0));Y.length>0;){const ie=Y.pop(),Te=ie.x,De=ie.y;let Ye=ie.fullyVisible;if(!Ye){const Ot=ie.aabb.intersects(z);if(Ot===0)continue;Ye=Ot===2}const it=n.terrain?A:L,ct=ie.aabb.distanceX(it),et=ie.aabb.distanceY(it),bt=Math.max(Math.abs(ct),Math.abs(et));if(ie.zoom===de||bt>Q+(1<<de-ie.zoom)-2&&ie.zoom>=U){const Ot=de-ie.zoom,Jt=A[0]-.5-(Te<<Ot),pt=A[1]-.5-(De<<Ot);se.push({tileID:new a.OverscaledTileID(ie.zoom===de?Pe:ie.zoom,ie.wrap,ie.zoom,Te,De),distanceSq:j([L[0]-.5-Te,L[1]-.5-De]),tileDistanceToCamera:Math.sqrt(Jt*Jt+pt*pt)})}else for(let Ot=0;Ot<4;Ot++){const Jt=(Te<<1)+Ot%2,pt=(De<<1)+(Ot>>1),Zt=ie.zoom+1;let St=ie.aabb.quadrant(Ot);if(n.terrain){const _n=new a.OverscaledTileID(Zt,ie.wrap,Zt,Jt,pt),ii=n.terrain.getMinMaxElevation(_n),vn=(o=ii.minElevation)!==null&&o!==void 0?o:this.elevation,tn=(u=ii.maxElevation)!==null&&u!==void 0?u:this.elevation;St=new qr([St.min[0],St.min[1],vn],[St.max[0],St.max[1],tn])}Y.push({aabb:St,zoom:Zt,x:Jt,y:pt,wrap:ie.wrap,fullyVisible:Ye})}}return se.sort((ie,Te)=>ie.distanceSq-Te.distanceSq).map(ie=>ie.tileID)}resize(n,o){this.width=n,this.height=o,this.pixelsToGLUnits=[2/n,-2/o],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(n){return Math.pow(2,n)}scaleZoom(n){return Math.log(n)/Math.LN2}project(n){const o=a.clamp(n.lat,-this.maxValidLatitude,this.maxValidLatitude);return new a.Point(a.mercatorXfromLng(n.lng)*this.worldSize,a.mercatorYfromLat(o)*this.worldSize)}unproject(n){return new a.MercatorCoordinate(n.x/this.worldSize,n.y/this.worldSize).toLngLat()}get point(){return this.project(this.center)}updateElevation(n){this.freezeElevation||(this.elevation=n?this.getElevation(this._center,n):0)}getElevation(n,o){const u=a.MercatorCoordinate.fromLngLat(n.wrap()),p=(1<<this.tileZoom)*a.EXTENT,v=u.x*p,w=u.y*p,E=Math.floor(v/a.EXTENT),C=Math.floor(w/a.EXTENT),A=new a.OverscaledTileID(this.tileZoom,0,this.tileZoom,E,C);return o.getElevation(A,v%a.EXTENT,w%a.EXTENT,a.EXTENT)}getCameraPosition(){return{lngLat:this.pointLocation(this.getCameraPoint()),altitude:Math.cos(this._pitch)*this.cameraToCenterDistance/this._pixelPerMeter+this.elevation}}recalculateZoom(n){const o=this.pointLocation(this.centerPoint,n),u=this.getElevation(o,n);if(!(this.elevation-u))return;const p=this.getCameraPosition(),v=a.MercatorCoordinate.fromLngLat(p.lngLat,p.altitude),w=a.MercatorCoordinate.fromLngLat(o,u),E=v.x-w.x,C=v.y-w.y,A=v.z-w.z,L=Math.sqrt(E*E+C*C+A*A),z=this.scaleZoom(this.cameraToCenterDistance/L/this.tileSize);this._elevation=u,this._center=o,this.zoom=z}setLocationAtPoint(n,o){const u=this.pointCoordinate(o),p=this.pointCoordinate(this.centerPoint),v=this.locationCoordinate(n),w=new a.MercatorCoordinate(v.x-(u.x-p.x),v.y-(u.y-p.y));this.center=this.coordinateLocation(w),this._renderWorldCopies&&(this.center=this.center.wrap())}locationPoint(n,o){return o?this.coordinatePoint(this.locationCoordinate(n),this.getElevation(n,o),this.pixelMatrix3D):this.coordinatePoint(this.locationCoordinate(n))}pointLocation(n,o){return this.coordinateLocation(this.pointCoordinate(n,o))}locationCoordinate(n){return a.MercatorCoordinate.fromLngLat(n)}coordinateLocation(n){return n&&n.toLngLat()}pointCoordinate(n,o){if(o){const U=o.pointCoordinate(n);if(U!=null)return U}const u=[n.x,n.y,0,1],p=[n.x,n.y,1,1];a.transformMat4(u,u,this.pixelMatrixInverse),a.transformMat4(p,p,this.pixelMatrixInverse);const v=u[3],w=p[3],E=u[1]/v,C=p[1]/w,A=u[2]/v,L=p[2]/w,z=A===L?0:(0-A)/(L-A);return new a.MercatorCoordinate(a.interpolate.number(u[0]/v,p[0]/w,z)/this.worldSize,a.interpolate.number(E,C,z)/this.worldSize)}coordinatePoint(n,o=0,u=this.pixelMatrix){const p=[n.x*this.worldSize,n.y*this.worldSize,o,1];return a.transformMat4(p,p,u),new a.Point(p[0]/p[3],p[1]/p[3])}getBounds(){const n=Math.max(0,this.height/2-this.getHorizon());return new Rt().extend(this.pointLocation(new a.Point(0,n))).extend(this.pointLocation(new a.Point(this.width,n))).extend(this.pointLocation(new a.Point(this.width,this.height))).extend(this.pointLocation(new a.Point(0,this.height)))}getMaxBounds(){return this.latRange&&this.latRange.length===2&&this.lngRange&&this.lngRange.length===2?new Rt([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null}getHorizon(){return Math.tan(Math.PI/2-this._pitch)*this.cameraToCenterDistance*.85}setMaxBounds(n){n?(this.lngRange=[n.getWest(),n.getEast()],this.latRange=[n.getSouth(),n.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])}calculatePosMatrix(n,o=!1){const u=n.key,p=o?this._alignedPosMatrixCache:this._posMatrixCache;if(p[u])return p[u];const v=n.canonical,w=this.worldSize/this.zoomScale(v.z),E=v.x+Math.pow(2,v.z)*n.wrap,C=a.identity(new Float64Array(16));return a.translate(C,C,[E*w,v.y*w,0]),a.scale(C,C,[w/a.EXTENT,w/a.EXTENT,1]),a.multiply(C,o?this.alignedProjMatrix:this.projMatrix,C),p[u]=new Float32Array(C),p[u]}customLayerMatrix(){return this.mercatorMatrix.slice()}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;let n,o,u,p,v=-90,w=90,E=-180,C=180;const A=this.size,L=this._unmodified;if(this.latRange){const Q=this.latRange;v=a.mercatorYfromLat(Q[1])*this.worldSize,w=a.mercatorYfromLat(Q[0])*this.worldSize,n=w-v<A.y?A.y/(w-v):0}if(this.lngRange){const Q=this.lngRange;E=a.wrap(a.mercatorXfromLng(Q[0])*this.worldSize,0,this.worldSize),C=a.wrap(a.mercatorXfromLng(Q[1])*this.worldSize,0,this.worldSize),C<E&&(C+=this.worldSize),o=C-E<A.x?A.x/(C-E):0}const z=this.point,U=Math.max(o||0,n||0);if(U)return this.center=this.unproject(new a.Point(o?(C+E)/2:z.x,n?(w+v)/2:z.y)),this.zoom+=this.scaleZoom(U),this._unmodified=L,void(this._constraining=!1);if(this.latRange){const Q=z.y,H=A.y/2;Q-H<v&&(p=v+H),Q+H>w&&(p=w-H)}if(this.lngRange){const Q=(E+C)/2,H=a.wrap(z.x,Q-this.worldSize/2,Q+this.worldSize/2),Y=A.x/2;H-Y<E&&(u=E+Y),H+Y>C&&(u=C-Y)}u===void 0&&p===void 0||(this.center=this.unproject(new a.Point(u!==void 0?u:z.x,p!==void 0?p:z.y)).wrap()),this._unmodified=L,this._constraining=!1}_calcMatrices(){if(!this.height)return;const n=this.centerOffset,o=this.point.x,u=this.point.y;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height,this._pixelPerMeter=a.mercatorZfromAltitude(1,this.center.lat)*this.worldSize;let p=a.identity(new Float64Array(16));a.scale(p,p,[this.width/2,-this.height/2,1]),a.translate(p,p,[1,-1,0]),this.labelPlaneMatrix=p,p=a.identity(new Float64Array(16)),a.scale(p,p,[1,-1,1]),a.translate(p,p,[-1,-1,0]),a.scale(p,p,[2/this.width,2/this.height,1]),this.glCoordMatrix=p,this.cameraToSeaLevelDistance=this.cameraToCenterDistance+this._elevation*this._pixelPerMeter/Math.cos(this._pitch);const v=this._elevation<0?this.cameraToCenterDistance:this.cameraToSeaLevelDistance,w=Math.PI/2+this._pitch,E=this._fov*(.5+n.y/this.height),C=Math.sin(E)*v/Math.sin(a.clamp(Math.PI-w-E,.01,Math.PI-.01)),A=this.getHorizon(),L=2*Math.atan(A/this.cameraToCenterDistance)*(.5+n.y/(2*A)),z=Math.sin(L)*v/Math.sin(a.clamp(Math.PI-w-L,.01,Math.PI-.01)),U=Math.min(C,z),Q=1.01*(Math.cos(Math.PI/2-this._pitch)*U+v),H=this.height/50;p=new Float64Array(16),a.perspective(p,this._fov,this.width/this.height,H,Q),p[8]=2*-n.x/this.width,p[9]=2*n.y/this.height,a.scale(p,p,[1,-1,1]),a.translate(p,p,[0,0,-this.cameraToCenterDistance]),a.rotateX(p,p,this._pitch),a.rotateZ(p,p,this.angle),a.translate(p,p,[-o,-u,0]),this.mercatorMatrix=a.scale([],p,[this.worldSize,this.worldSize,this.worldSize]),a.scale(p,p,[1,1,this._pixelPerMeter]),this.pixelMatrix=a.multiply(new Float64Array(16),this.labelPlaneMatrix,p),a.translate(p,p,[0,0,-this.elevation]),this.projMatrix=p,this.invProjMatrix=a.invert([],p),this.pixelMatrix3D=a.multiply(new Float64Array(16),this.labelPlaneMatrix,p);const Y=this.width%2/2,se=this.height%2/2,de=Math.cos(this.angle),Pe=Math.sin(this.angle),ie=o-Math.round(o)+de*Y+Pe*se,Te=u-Math.round(u)+de*se+Pe*Y,De=new Float64Array(p);if(a.translate(De,De,[ie>.5?ie-1:ie,Te>.5?Te-1:Te,0]),this.alignedProjMatrix=De,p=a.invert(new Float64Array(16),this.pixelMatrix),!p)throw new Error("failed to invert matrix");this.pixelMatrixInverse=p,this._posMatrixCache={},this._alignedPosMatrixCache={}}maxPitchScaleFactor(){if(!this.pixelMatrixInverse)return 1;const n=this.pointCoordinate(new a.Point(0,0)),o=[n.x*this.worldSize,n.y*this.worldSize,0,1];return a.transformMat4(o,o,this.pixelMatrix)[3]/this.cameraToCenterDistance}getCameraPoint(){const n=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new a.Point(0,n))}getCameraQueryGeometry(n){const o=this.getCameraPoint();if(n.length===1)return[n[0],o];{let u=o.x,p=o.y,v=o.x,w=o.y;for(const E of n)u=Math.min(u,E.x),p=Math.min(p,E.y),v=Math.max(v,E.x),w=Math.max(w,E.y);return[new a.Point(u,p),new a.Point(v,p),new a.Point(v,w),new a.Point(u,w),new a.Point(u,p)]}}}class ch{constructor(n){this._hashName=n&&encodeURIComponent(n),a.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=function(o,u){let p=!1,v=null;const w=()=>{v=null,p&&(o(),v=setTimeout(w,300),p=!1)};return()=>(p=!0,v||w(),v)}(this._updateHashUnthrottled.bind(this))}addTo(n){return this._map=n,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this}getHashString(n){const o=this._map.getCenter(),u=Math.round(100*this._map.getZoom())/100,p=Math.ceil((u*Math.LN2+Math.log(512/360/.5))/Math.LN10),v=Math.pow(10,p),w=Math.round(o.lng*v)/v,E=Math.round(o.lat*v)/v,C=this._map.getBearing(),A=this._map.getPitch();let L="";if(L+=n?`/${w}/${E}/${u}`:`${u}/${E}/${w}`,(C||A)&&(L+="/"+Math.round(10*C)/10),A&&(L+=`/${Math.round(A)}`),this._hashName){const z=this._hashName;let U=!1;const Q=window.location.hash.slice(1).split("&").map(H=>{const Y=H.split("=")[0];return Y===z?(U=!0,`${Y}=${L}`):H}).filter(H=>H);return U||Q.push(`${z}=${L}`),`#${Q.join("&")}`}return`#${L}`}_getCurrentHash(){const n=window.location.hash.replace("#","");if(this._hashName){let o;return n.split("&").map(u=>u.split("=")).forEach(u=>{u[0]===this._hashName&&(o=u)}),(o&&o[1]||"").split("/")}return n.split("/")}_onHashChange(){const n=this._getCurrentHash();if(n.length>=3&&!n.some(o=>isNaN(o))){const o=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(n[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+n[2],+n[1]],zoom:+n[0],bearing:o,pitch:+(n[4]||0)}),!0}return!1}_updateHashUnthrottled(){const n=window.location.href.replace(/(#.+)?$/,this.getHashString());try{window.history.replaceState(window.history.state,null,n)}catch{}}}const Ko={linearity:.3,easing:a.bezier(0,0,.3,1)},uh=a.extend({deceleration:2500,maxSpeed:1400},Ko),hh=a.extend({deceleration:20,maxSpeed:1400},Ko),Yo=a.extend({deceleration:1e3,maxSpeed:360},Ko),dh=a.extend({deceleration:1e3,maxSpeed:90},Ko);class Zr{constructor(n){this._map=n,this.clear()}clear(){this._inertiaBuffer=[]}record(n){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:a.exported.now(),settings:n})}_drainInertiaBuffer(){const n=this._inertiaBuffer,o=a.exported.now();for(;n.length>0&&o-n[0].time>160;)n.shift()}_onMoveEnd(n){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const o={zoom:0,bearing:0,pitch:0,pan:new a.Point(0,0),pinchAround:void 0,around:void 0};for(const{settings:v}of this._inertiaBuffer)o.zoom+=v.zoomDelta||0,o.bearing+=v.bearingDelta||0,o.pitch+=v.pitchDelta||0,v.panDelta&&o.pan._add(v.panDelta),v.around&&(o.around=v.around),v.pinchAround&&(o.pinchAround=v.pinchAround);const u=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,p={};if(o.pan.mag()){const v=Jo(o.pan.mag(),u,a.extend({},uh,n||{}));p.offset=o.pan.mult(v.amount/o.pan.mag()),p.center=this._map.transform.center,br(p,v)}if(o.zoom){const v=Jo(o.zoom,u,hh);p.zoom=this._map.transform.zoom+v.amount,br(p,v)}if(o.bearing){const v=Jo(o.bearing,u,Yo);p.bearing=this._map.transform.bearing+a.clamp(v.amount,-179,179),br(p,v)}if(o.pitch){const v=Jo(o.pitch,u,dh);p.pitch=this._map.transform.pitch+v.amount,br(p,v)}if(p.zoom||p.bearing){const v=o.pinchAround===void 0?o.around:o.pinchAround;p.around=v?this._map.unproject(v):this._map.getCenter()}return this.clear(),a.extend(p,{noMoveStart:!0})}}function br(d,n){(!d.duration||d.duration<n.duration)&&(d.duration=n.duration,d.easing=n.easing)}function Jo(d,n,o){const{maxSpeed:u,linearity:p,deceleration:v}=o,w=a.clamp(d*p/(n/1e3),-u,u),E=Math.abs(w)/(v*p);return{easing:o.easing,duration:1e3*E,amount:w*(E/2)}}class ci extends a.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(n,o,u,p={}){const v=T.mousePos(o.getCanvasContainer(),u),w=o.unproject(v);super(n,a.extend({point:v,lngLat:w,originalEvent:u},p)),this._defaultPrevented=!1,this.target=o}}class Es extends a.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(n,o,u){const p=n==="touchend"?u.changedTouches:u.touches,v=T.touchPos(o.getCanvasContainer(),p),w=v.map(C=>o.unproject(C)),E=v.reduce((C,A,L,z)=>C.add(A.div(z.length)),new a.Point(0,0));super(n,{points:v,point:E,lngLats:w,lngLat:o.unproject(E),originalEvent:u}),this._defaultPrevented=!1}}class yf extends a.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(n,o,u){super(n,{originalEvent:u}),this._defaultPrevented=!1}}class _f{constructor(n,o){this._map=n,this._clickTolerance=o.clickTolerance}reset(){delete this._mousedownPos}wheel(n){return this._firePreventable(new yf(n.type,this._map,n))}mousedown(n,o){return this._mousedownPos=o,this._firePreventable(new ci(n.type,this._map,n))}mouseup(n){this._map.fire(new ci(n.type,this._map,n))}click(n,o){this._mousedownPos&&this._mousedownPos.dist(o)>=this._clickTolerance||this._map.fire(new ci(n.type,this._map,n))}dblclick(n){return this._firePreventable(new ci(n.type,this._map,n))}mouseover(n){this._map.fire(new ci(n.type,this._map,n))}mouseout(n){this._map.fire(new ci(n.type,this._map,n))}touchstart(n){return this._firePreventable(new Es(n.type,this._map,n))}touchmove(n){this._map.fire(new Es(n.type,this._map,n))}touchend(n){this._map.fire(new Es(n.type,this._map,n))}touchcancel(n){this._map.fire(new Es(n.type,this._map,n))}_firePreventable(n){if(this._map.fire(n),n.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class vf{constructor(n){this._map=n}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(n){this._map.fire(new ci(n.type,this._map,n))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new ci("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(n){this._delayContextMenu?this._contextMenuEvent=n:this._ignoreContextMenu||this._map.fire(new ci(n.type,this._map,n)),this._map.listens("contextmenu")&&n.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class _o{constructor(n){this._map=n}get transform(){return this._map._requestedCameraState||this._map.transform}get center(){return{lng:this.transform.center.lng,lat:this.transform.center.lat}}get zoom(){return this.transform.zoom}get pitch(){return this.transform.pitch}get bearing(){return this.transform.bearing}unproject(n){return this.transform.pointLocation(a.Point.convert(n),this._map.terrain)}}class Qo{constructor(n,o){this._map=n,this._tr=new _o(n),this._el=n.getCanvasContainer(),this._container=n.getContainer(),this._clickTolerance=o.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(n,o){this.isEnabled()&&n.shiftKey&&n.button===0&&(T.disableDrag(),this._startPos=this._lastPos=o,this._active=!0)}mousemoveWindow(n,o){if(!this._active)return;const u=o;if(this._lastPos.equals(u)||!this._box&&u.dist(this._startPos)<this._clickTolerance)return;const p=this._startPos;this._lastPos=u,this._box||(this._box=T.create("div","maplibregl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair"),this._fireEvent("boxzoomstart",n));const v=Math.min(p.x,u.x),w=Math.max(p.x,u.x),E=Math.min(p.y,u.y),C=Math.max(p.y,u.y);T.setTransform(this._box,`translate(${v}px,${E}px)`),this._box.style.width=w-v+"px",this._box.style.height=C-E+"px"}mouseupWindow(n,o){if(!this._active||n.button!==0)return;const u=this._startPos,p=o;if(this.reset(),T.suppressClick(),u.x!==p.x||u.y!==p.y)return this._map.fire(new a.Event("boxzoomend",{originalEvent:n})),{cameraAnimation:v=>v.fitScreenCoordinates(u,p,this._tr.bearing,{linear:!0})};this._fireEvent("boxzoomcancel",n)}keydown(n){this._active&&n.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",n))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair"),this._box&&(T.remove(this._box),this._box=null),T.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(n,o){return this._map.fire(new a.Event(n,{originalEvent:o}))}}function Gr(d,n){if(d.length!==n.length)throw new Error(`The number of touches and points are not equal - touches ${d.length}, points ${n.length}`);const o={};for(let u=0;u<d.length;u++)o[d[u].identifier]=n[u];return o}class Et{constructor(n){this.reset(),this.numTouches=n.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(n,o,u){(this.centroid||u.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=n.timeStamp),u.length===this.numTouches&&(this.centroid=function(p){const v=new a.Point(0,0);for(const w of p)v._add(w);return v.div(p.length)}(o),this.touches=Gr(u,o)))}touchmove(n,o,u){if(this.aborted||!this.centroid)return;const p=Gr(u,o);for(const v in this.touches){const w=p[v];(!w||w.dist(this.touches[v])>30)&&(this.aborted=!0)}}touchend(n,o,u){if((!this.centroid||n.timeStamp-this.startTime>500)&&(this.aborted=!0),u.length===0){const p=!this.aborted&&this.centroid;if(this.reset(),p)return p}}}class Ha{constructor(n){this.singleTap=new Et(n),this.numTaps=n.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(n,o,u){this.singleTap.touchstart(n,o,u)}touchmove(n,o,u){this.singleTap.touchmove(n,o,u)}touchend(n,o,u){const p=this.singleTap.touchend(n,o,u);if(p){const v=n.timeStamp-this.lastTime<500,w=!this.lastTap||this.lastTap.dist(p)<30;if(v&&w||this.reset(),this.count++,this.lastTime=n.timeStamp,this.lastTap=p,this.count===this.numTaps)return this.reset(),p}}}class ea{constructor(n){this._tr=new _o(n),this._zoomIn=new Ha({numTouches:1,numTaps:2}),this._zoomOut=new Ha({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(n,o,u){this._zoomIn.touchstart(n,o,u),this._zoomOut.touchstart(n,o,u)}touchmove(n,o,u){this._zoomIn.touchmove(n,o,u),this._zoomOut.touchmove(n,o,u)}touchend(n,o,u){const p=this._zoomIn.touchend(n,o,u),v=this._zoomOut.touchend(n,o,u),w=this._tr;return p?(this._active=!0,n.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:E=>E.easeTo({duration:300,zoom:w.zoom+1,around:w.unproject(p)},{originalEvent:n})}):v?(this._active=!0,n.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:E=>E.easeTo({duration:300,zoom:w.zoom-1,around:w.unproject(v)},{originalEvent:n})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class as{constructor(n){this._enabled=!!n.enable,this._moveStateManager=n.moveStateManager,this._clickTolerance=n.clickTolerance||1,this._moveFunction=n.move,this._activateOnStart=!!n.activateOnStart,n.assignEvents(this),this.reset()}reset(n){this._active=!1,this._moved=!1,delete this._lastPoint,this._moveStateManager.endMove(n)}_move(...n){const o=this._moveFunction(...n);if(o.bearingDelta||o.pitchDelta||o.around||o.panDelta)return this._active=!0,o}dragStart(n,o){this.isEnabled()&&!this._lastPoint&&this._moveStateManager.isValidStartEvent(n)&&(this._moveStateManager.startMove(n),this._lastPoint=o.length?o[0]:o,this._activateOnStart&&this._lastPoint&&(this._active=!0))}dragMove(n,o){if(!this.isEnabled())return;const u=this._lastPoint;if(!u)return;if(n.preventDefault(),!this._moveStateManager.isValidMoveEvent(n))return void this.reset(n);const p=o.length?o[0]:o;return!this._moved&&p.dist(u)<this._clickTolerance?void 0:(this._moved=!0,this._lastPoint=p,this._move(u,p))}dragEnd(n){this.isEnabled()&&this._lastPoint&&this._moveStateManager.isValidEndEvent(n)&&(this._moved&&T.suppressClick(),this.reset(n))}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}getClickTolerance(){return this._clickTolerance}}const fh={0:1,2:2};class yt{constructor(n){this._correctEvent=n.checkCorrectEvent}startMove(n){const o=T.mouseButton(n);this._eventButton=o}endMove(n){delete this._eventButton}isValidStartEvent(n){return this._correctEvent(n)}isValidMoveEvent(n){return!function(o,u){const p=fh[u];return o.buttons===void 0||(o.buttons&p)!==p}(n,this._eventButton)}isValidEndEvent(n){return T.mouseButton(n)===this._eventButton}}class Xa{constructor(){this._firstTouch=void 0}_isOneFingerTouch(n){return n.targetTouches.length===1}_isSameTouchEvent(n){return n.targetTouches[0].identifier===this._firstTouch}startMove(n){this._firstTouch=n.targetTouches[0].identifier}endMove(n){delete this._firstTouch}isValidStartEvent(n){return this._isOneFingerTouch(n)}isValidMoveEvent(n){return this._isOneFingerTouch(n)&&this._isSameTouchEvent(n)}isValidEndEvent(n){return this._isOneFingerTouch(n)&&this._isSameTouchEvent(n)}}const bc=d=>{d.mousedown=d.dragStart,d.mousemoveWindow=d.dragMove,d.mouseup=d.dragEnd,d.contextmenu=function(n){n.preventDefault()}},ph=({enable:d,clickTolerance:n,bearingDegreesPerPixelMoved:o=.8})=>{const u=new yt({checkCorrectEvent:p=>T.mouseButton(p)===0&&p.ctrlKey||T.mouseButton(p)===2});return new as({clickTolerance:n,move:(p,v)=>({bearingDelta:(v.x-p.x)*o}),moveStateManager:u,enable:d,assignEvents:bc})},Ka=({enable:d,clickTolerance:n,pitchDegreesPerPixelMoved:o=-.5})=>{const u=new yt({checkCorrectEvent:p=>T.mouseButton(p)===0&&p.ctrlKey||T.mouseButton(p)===2});return new as({clickTolerance:n,move:(p,v)=>({pitchDelta:(v.y-p.y)*o}),moveStateManager:u,enable:d,assignEvents:bc})};class mh{constructor(n,o){this._minTouches=n.cooperativeGestures?2:1,this._clickTolerance=n.clickTolerance||1,this._map=o,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new a.Point(0,0),setTimeout(()=>{this._cancelCooperativeMessage=!1},200)}touchstart(n,o,u){return this._calculateTransform(n,o,u)}touchmove(n,o,u){if(this._map._cooperativeGestures&&(this._minTouches===2&&u.length<2&&!this._cancelCooperativeMessage?this._map._onCooperativeGesture(n,!1,u.length):this._cancelCooperativeMessage||(this._cancelCooperativeMessage=!0)),this._active&&!(u.length<this._minTouches))return n.preventDefault(),this._calculateTransform(n,o,u)}touchend(n,o,u){this._calculateTransform(n,o,u),this._active&&u.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(n,o,u){u.length>0&&(this._active=!0);const p=Gr(u,o),v=new a.Point(0,0),w=new a.Point(0,0);let E=0;for(const A in p){const L=p[A],z=this._touches[A];z&&(v._add(L),w._add(L.sub(z)),E++,p[A]=L)}if(this._touches=p,E<this._minTouches||!w.mag())return;const C=w.div(E);return this._sum._add(C),this._sum.mag()<this._clickTolerance?void 0:{around:v.div(E),panDelta:C}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Ya{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}_start(n){}_move(n,o,u){return{}}touchstart(n,o,u){this._firstTwoTouches||u.length<2||(this._firstTwoTouches=[u[0].identifier,u[1].identifier],this._start([o[0],o[1]]))}touchmove(n,o,u){if(!this._firstTwoTouches)return;n.preventDefault();const[p,v]=this._firstTwoTouches,w=Ja(u,o,p),E=Ja(u,o,v);if(!w||!E)return;const C=this._aroundCenter?null:w.add(E).div(2);return this._move([w,E],C,n)}touchend(n,o,u){if(!this._firstTwoTouches)return;const[p,v]=this._firstTwoTouches,w=Ja(u,o,p),E=Ja(u,o,v);w&&E||(this._active&&T.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(n){this._enabled=!0,this._aroundCenter=!!n&&n.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function Ja(d,n,o){for(let u=0;u<d.length;u++)if(d[u].identifier===o)return n[u]}function gh(d,n){return Math.log(d/n)/Math.LN2}class wc extends Ya{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(n){this._startDistance=this._distance=n[0].dist(n[1])}_move(n,o){const u=this._distance;if(this._distance=n[0].dist(n[1]),this._active||!(Math.abs(gh(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:gh(this._distance,u),pinchAround:o}}}function Qa(d,n){return 180*d.angleWith(n)/Math.PI}class Sc extends Ya{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(n){this._startVector=this._vector=n[0].sub(n[1]),this._minDiameter=n[0].dist(n[1])}_move(n,o){const u=this._vector;if(this._vector=n[0].sub(n[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:Qa(this._vector,u),pinchAround:o}}_isBelowThreshold(n){this._minDiameter=Math.min(this._minDiameter,n.mag());const o=25/(Math.PI*this._minDiameter)*360,u=Qa(n,this._startVector);return Math.abs(u)<o}}function ta(d){return Math.abs(d.y)>Math.abs(d.x)}class Hi extends Ya{constructor(n){super(),this._map=n}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(n,o,u){super.touchstart(n,o,u),this._currentTouchCount=u.length}_start(n){this._lastPoints=n,ta(n[0].sub(n[1]))&&(this._valid=!1)}_move(n,o,u){if(this._map._cooperativeGestures&&this._currentTouchCount<3)return;const p=n[0].sub(this._lastPoints[0]),v=n[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(p,v,u.timeStamp),this._valid?(this._lastPoints=n,this._active=!0,{pitchDelta:(p.y+v.y)/2*-.5}):void 0}gestureBeginsVertically(n,o,u){if(this._valid!==void 0)return this._valid;const p=n.mag()>=2,v=o.mag()>=2;if(!p&&!v)return;if(!p||!v)return this._firstMove===void 0&&(this._firstMove=u),u-this._firstMove<100&&void 0;const w=n.y>0==o.y>0;return ta(n)&&ta(o)&&w}}const Ts={panStep:100,bearingStep:15,pitchStep:10};class yh{constructor(n){this._tr=new _o(n);const o=Ts;this._panStep=o.panStep,this._bearingStep=o.bearingStep,this._pitchStep=o.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(n){if(n.altKey||n.ctrlKey||n.metaKey)return;let o=0,u=0,p=0,v=0,w=0;switch(n.keyCode){case 61:case 107:case 171:case 187:o=1;break;case 189:case 109:case 173:o=-1;break;case 37:n.shiftKey?u=-1:(n.preventDefault(),v=-1);break;case 39:n.shiftKey?u=1:(n.preventDefault(),v=1);break;case 38:n.shiftKey?p=1:(n.preventDefault(),w=-1);break;case 40:n.shiftKey?p=-1:(n.preventDefault(),w=1);break;default:return}return this._rotationDisabled&&(u=0,p=0),{cameraAnimation:E=>{const C=this._tr;E.easeTo({duration:300,easeId:"keyboardHandler",easing:Cc,zoom:o?Math.round(C.zoom)+o*(n.shiftKey?2:1):C.zoom,bearing:C.bearing+u*this._bearingStep,pitch:C.pitch+p*this._pitchStep,offset:[-v*this._panStep,-w*this._panStep],center:C.center},{originalEvent:n})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function Cc(d){return d*(2-d)}const el=4.000244140625;class Ec{constructor(n,o){this._map=n,this._tr=new _o(n),this._el=n.getCanvasContainer(),this._handler=o,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222,a.bindAll(["_onTimeout"],this)}setZoomRate(n){this._defaultZoomRate=n}setWheelZoomRate(n){this._wheelZoomRate=n}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(n){this.isEnabled()||(this._enabled=!0,this._aroundCenter=n&&n.around==="center")}disable(){this.isEnabled()&&(this._enabled=!1)}wheel(n){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!n[this._map._metaKey])return;n.preventDefault()}let o=n.deltaMode===WheelEvent.DOM_DELTA_LINE?40*n.deltaY:n.deltaY;const u=a.exported.now(),p=u-(this._lastWheelEventTime||0);this._lastWheelEventTime=u,o!==0&&o%el==0?this._type="wheel":o!==0&&Math.abs(o)<4?this._type="trackpad":p>400?(this._type=null,this._lastValue=o,this._timeout=setTimeout(this._onTimeout,40,n)):this._type||(this._type=Math.abs(p*o)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,o+=this._lastValue)),n.shiftKey&&o&&(o/=4),this._type&&(this._lastWheelEvent=n,this._delta-=o,this._active||this._start(n)),n.preventDefault()}_onTimeout(n){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(n)}_start(n){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const o=T.mousePos(this._el,n),u=this._tr;this._around=a.LngLat.convert(this._aroundCenter?u.center:u.unproject(o)),this._aroundPoint=u.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const n=this._tr.transform;if(this._delta!==0){const E=this._type==="wheel"&&Math.abs(this._delta)>el?this._wheelZoomRate:this._defaultZoomRate;let C=2/(1+Math.exp(-Math.abs(this._delta*E)));this._delta<0&&C!==0&&(C=1/C);const A=typeof this._targetZoom=="number"?n.zoomScale(this._targetZoom):n.scale;this._targetZoom=Math.min(n.maxZoom,Math.max(n.minZoom,n.scaleZoom(A*C))),this._type==="wheel"&&(this._startZoom=n.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}const o=typeof this._targetZoom=="number"?this._targetZoom:n.zoom,u=this._startZoom,p=this._easing;let v,w=!1;if(this._type==="wheel"&&u&&p){const E=Math.min((a.exported.now()-this._lastWheelEventTime)/200,1),C=p(E);v=a.interpolate.number(u,o,C),E<1?this._frameId||(this._frameId=!0):w=!0}else v=o,w=!0;return this._active=!0,w&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!w,zoomDelta:v-n.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(n){let o=a.ease;if(this._prevEase){const u=this._prevEase,p=(a.exported.now()-u.start)/u.duration,v=u.easing(p+.01)-u.easing(p),w=.27/Math.sqrt(v*v+1e-4)*.01,E=Math.sqrt(.0729-w*w);o=a.bezier(w,E,.25,1)}return this._prevEase={start:a.exported.now(),duration:n,easing:o},o}reset(){this._active=!1}}class _h{constructor(n,o){this._clickZoom=n,this._tapZoom=o}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class wr{constructor(n){this._tr=new _o(n),this.reset()}reset(){this._active=!1}dblclick(n,o){return n.preventDefault(),{cameraAnimation:u=>{u.easeTo({duration:300,zoom:this._tr.zoom+(n.shiftKey?-1:1),around:this._tr.unproject(o)},{originalEvent:n})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Un{constructor(){this._tap=new Ha({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,this._tap.reset()}touchstart(n,o,u){this._swipePoint||(this._tapTime&&n.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?u.length>0&&(this._swipePoint=o[0],this._swipeTouch=u[0].identifier):this._tap.touchstart(n,o,u))}touchmove(n,o,u){if(this._tapTime){if(this._swipePoint){if(u[0].identifier!==this._swipeTouch)return;const p=o[0],v=p.y-this._swipePoint.y;return this._swipePoint=p,n.preventDefault(),this._active=!0,{zoomDelta:v/128}}}else this._tap.touchmove(n,o,u)}touchend(n,o,u){this._tapTime?this._swipePoint&&u.length===0&&this.reset():this._tap.touchend(n,o,u)&&(this._tapTime=n.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class tl{constructor(n,o,u){this._el=n,this._mousePan=o,this._touchPan=u}enable(n){this._inertiaOptions=n||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class Tc{constructor(n,o,u){this._pitchWithRotate=n.pitchWithRotate,this._mouseRotate=o,this._mousePitch=u}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class vh{constructor(n,o,u,p){this._el=n,this._touchZoom=o,this._touchRotate=u,this._tapDragZoom=p,this._rotationDisabled=!1,this._enabled=!0}enable(n){this._touchZoom.enable(n),this._rotationDisabled||this._touchRotate.enable(n),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const na=d=>d.zoom||d.drag||d.pitch||d.rotate;class xh extends a.Event{}function Ic(d){return d.panDelta&&d.panDelta.mag()||d.zoomDelta||d.bearingDelta||d.pitchDelta}class Wr{constructor(n,o){this._map=n,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Zr(n),this._bearingSnap=o.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(o),a.bindAll(["handleEvent","handleWindowEvent"],this);const u=this._el;this._listeners=[[u,"touchstart",{passive:!0}],[u,"touchmove",{passive:!1}],[u,"touchend",void 0],[u,"touchcancel",void 0],[u,"mousedown",void 0],[u,"mousemove",void 0],[u,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[u,"mouseover",void 0],[u,"mouseout",void 0],[u,"dblclick",void 0],[u,"click",void 0],[u,"keydown",{capture:!1}],[u,"keyup",void 0],[u,"wheel",{passive:!1}],[u,"contextmenu",void 0],[window,"blur",void 0]];for(const[p,v,w]of this._listeners)T.addEventListener(p,v,p===document?this.handleWindowEvent:this.handleEvent,w)}destroy(){for(const[n,o,u]of this._listeners)T.removeEventListener(n,o,n===document?this.handleWindowEvent:this.handleEvent,u)}_addDefaultHandlers(n){const o=this._map,u=o.getCanvasContainer();this._add("mapEvent",new _f(o,n));const p=o.boxZoom=new Qo(o,n);this._add("boxZoom",p);const v=new ea(o),w=new wr(o);o.doubleClickZoom=new _h(w,v),this._add("tapZoom",v),this._add("clickZoom",w);const E=new Un;this._add("tapDragZoom",E);const C=o.touchPitch=new Hi(o);this._add("touchPitch",C);const A=ph(n),L=Ka(n);o.dragRotate=new Tc(n,A,L),this._add("mouseRotate",A,["mousePitch"]),this._add("mousePitch",L,["mouseRotate"]);const z=(({enable:de,clickTolerance:Pe})=>{const ie=new yt({checkCorrectEvent:Te=>T.mouseButton(Te)===0&&!Te.ctrlKey});return new as({clickTolerance:Pe,move:(Te,De)=>({around:De,panDelta:De.sub(Te)}),activateOnStart:!0,moveStateManager:ie,enable:de,assignEvents:bc})})(n),U=new mh(n,o);o.dragPan=new tl(u,z,U),this._add("mousePan",z),this._add("touchPan",U,["touchZoom","touchRotate"]);const Q=new Sc,H=new wc;o.touchZoomRotate=new vh(u,H,Q,E),this._add("touchRotate",Q,["touchPan","touchZoom"]),this._add("touchZoom",H,["touchPan","touchRotate"]);const Y=o.scrollZoom=new Ec(o,this);this._add("scrollZoom",Y,["mousePan"]);const se=o.keyboard=new yh(o);this._add("keyboard",se),this._add("blockableMapEvent",new vf(o));for(const de of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])n.interactive&&n[de]&&o[de].enable(n[de])}_add(n,o,u){this._handlers.push({handlerName:n,handler:o,allowed:u}),this._handlersById[n]=o}stop(n){if(!this._updatingCamera){for(const{handler:o}of this._handlers)o.reset();this._inertia.clear(),this._fireEvents({},{},n),this._changes=[]}}isActive(){for(const{handler:n}of this._handlers)if(n.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!na(this._eventsInProgress)||this.isZooming()}_blockedByActive(n,o,u){for(const p in n)if(p!==u&&(!o||o.indexOf(p)<0))return!0;return!1}handleWindowEvent(n){this.handleEvent(n,`${n.type}Window`)}_getMapTouches(n){const o=[];for(const u of n)this._el.contains(u.target)&&o.push(u);return o}handleEvent(n,o){if(n.type==="blur")return void this.stop(!0);this._updatingCamera=!0;const u=n.type==="renderFrame"?void 0:n,p={needsRenderFrame:!1},v={},w={},E=n.touches,C=E?this._getMapTouches(E):void 0,A=C?T.touchPos(this._el,C):T.mousePos(this._el,n);for(const{handlerName:U,handler:Q,allowed:H}of this._handlers){if(!Q.isEnabled())continue;let Y;this._blockedByActive(w,H,U)?Q.reset():Q[o||n.type]&&(Y=Q[o||n.type](n,A,C),this.mergeHandlerResult(p,v,Y,U,u),Y&&Y.needsRenderFrame&&this._triggerRenderFrame()),(Y||Q.isActive())&&(w[U]=Q)}const L={};for(const U in this._previousActiveHandlers)w[U]||(L[U]=u);this._previousActiveHandlers=w,(Object.keys(L).length||Ic(p))&&(this._changes.push([p,v,L]),this._triggerRenderFrame()),(Object.keys(w).length||Ic(p))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:z}=p;z&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],z(this._map))}mergeHandlerResult(n,o,u,p,v){if(!u)return;a.extend(n,u);const w={handlerName:p,originalEvent:u.originalEvent||v};u.zoomDelta!==void 0&&(o.zoom=w),u.panDelta!==void 0&&(o.drag=w),u.pitchDelta!==void 0&&(o.pitch=w),u.bearingDelta!==void 0&&(o.rotate=w)}_applyChanges(){const n={},o={},u={};for(const[p,v,w]of this._changes)p.panDelta&&(n.panDelta=(n.panDelta||new a.Point(0,0))._add(p.panDelta)),p.zoomDelta&&(n.zoomDelta=(n.zoomDelta||0)+p.zoomDelta),p.bearingDelta&&(n.bearingDelta=(n.bearingDelta||0)+p.bearingDelta),p.pitchDelta&&(n.pitchDelta=(n.pitchDelta||0)+p.pitchDelta),p.around!==void 0&&(n.around=p.around),p.pinchAround!==void 0&&(n.pinchAround=p.pinchAround),p.noInertia&&(n.noInertia=p.noInertia),a.extend(o,v),a.extend(u,w);this._updateMapTransform(n,o,u),this._changes=[]}_updateMapTransform(n,o,u){const p=this._map,v=p._getTransformForUpdate(),w=p.terrain;if(!(Ic(n)||w&&this._terrainMovement))return this._fireEvents(o,u,!0);let{panDelta:E,zoomDelta:C,bearingDelta:A,pitchDelta:L,around:z,pinchAround:U}=n;U!==void 0&&(z=U),p._stop(!0),z=z||p.transform.centerPoint;const Q=v.pointLocation(E?z.sub(E):z);A&&(v.bearing+=A),L&&(v.pitch+=L),C&&(v.zoom+=C),w?this._terrainMovement||!o.drag&&!o.zoom?o.drag&&this._terrainMovement?v.center=v.pointLocation(v.centerPoint.sub(E)):v.setLocationAtPoint(Q,z):(this._terrainMovement=!0,v.freezeElevation=!0,v.setLocationAtPoint(Q,z),this._map.once("moveend",()=>{v.freezeElevation=!1,this._terrainMovement=!1,v.recalculateZoom(p.terrain)})):v.setLocationAtPoint(Q,z),p._applyUpdatedTransform(v),this._map._update(),n.noInertia||this._inertia.record(n),this._fireEvents(o,u,!0)}_fireEvents(n,o,u){const p=na(this._eventsInProgress),v=na(n),w={};for(const L in n){const{originalEvent:z}=n[L];this._eventsInProgress[L]||(w[`${L}start`]=z),this._eventsInProgress[L]=n[L]}!p&&v&&this._fireEvent("movestart",v.originalEvent);for(const L in w)this._fireEvent(L,w[L]);v&&this._fireEvent("move",v.originalEvent);for(const L in n){const{originalEvent:z}=n[L];this._fireEvent(L,z)}const E={};let C;for(const L in this._eventsInProgress){const{handlerName:z,originalEvent:U}=this._eventsInProgress[L];this._handlersById[z].isActive()||(delete this._eventsInProgress[L],C=o[z]||U,E[`${L}end`]=C)}for(const L in E)this._fireEvent(L,E[L]);const A=na(this._eventsInProgress);if(u&&(p||v)&&!A){this._updatingCamera=!0;const L=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),z=U=>U!==0&&-this._bearingSnap<U&&U<this._bearingSnap;L?(z(L.bearing||this._map.getBearing())&&(L.bearing=0),L.freezeElevation=!0,this._map.easeTo(L,{originalEvent:C})):(this._map.fire(new a.Event("moveend",{originalEvent:C})),z(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(n,o){this._map.fire(new a.Event(n,o?{originalEvent:o}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(n=>{delete this._frameId,this.handleEvent(new xh("renderFrame",{timeStamp:n})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}const nl={extend:(d,...n)=>a.extend(d,...n),run(d){d()},logToElement(d,n=!1,o="log"){const u=window.document.getElementById(o);u&&(n&&(u.innerHTML=""),u.innerHTML+=`<br>${d}`)}};class zt extends a.Evented{constructor(n,o){super(),this._moving=!1,this._zooming=!1,this.transform=n,this._bearingSnap=o.bearingSnap,a.bindAll(["_renderFrameCallback"],this),this.on("moveend",()=>{delete this._requestedCameraState})}getCenter(){return new a.LngLat(this.transform.center.lng,this.transform.center.lat)}setCenter(n,o){return this.jumpTo({center:n},o)}panBy(n,o,u){return n=a.Point.convert(n).mult(-1),this.panTo(this.transform.center,a.extend({offset:n},o),u)}panTo(n,o,u){return this.easeTo(a.extend({center:n},o),u)}getZoom(){return this.transform.zoom}setZoom(n,o){return this.jumpTo({zoom:n},o),this}zoomTo(n,o,u){return this.easeTo(a.extend({zoom:n},o),u)}zoomIn(n,o){return this.zoomTo(this.getZoom()+1,n,o),this}zoomOut(n,o){return this.zoomTo(this.getZoom()-1,n,o),this}getBearing(){return this.transform.bearing}setBearing(n,o){return this.jumpTo({bearing:n},o),this}getPadding(){return this.transform.padding}setPadding(n,o){return this.jumpTo({padding:n},o),this}rotateTo(n,o,u){return this.easeTo(a.extend({bearing:n},o),u)}resetNorth(n,o){return this.rotateTo(0,a.extend({duration:1e3},n),o),this}resetNorthPitch(n,o){return this.easeTo(a.extend({bearing:0,pitch:0,duration:1e3},n),o),this}snapToNorth(n,o){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(n,o):this}getPitch(){return this.transform.pitch}setPitch(n,o){return this.jumpTo({pitch:n},o),this}cameraForBounds(n,o){n=Rt.convert(n);const u=o&&o.bearing||0;return this._cameraForBoxAndBearing(n.getNorthWest(),n.getSouthEast(),u,o)}_cameraForBoxAndBearing(n,o,u,p){const v={top:0,bottom:0,right:0,left:0};if(typeof(p=a.extend({padding:v,offset:[0,0],maxZoom:this.transform.maxZoom},p)).padding=="number"){const De=p.padding;p.padding={top:De,bottom:De,right:De,left:De}}p.padding=a.extend(v,p.padding);const w=this.transform,E=w.padding,C=w.project(a.LngLat.convert(n)),A=w.project(a.LngLat.convert(o)),L=C.rotate(-u*Math.PI/180),z=A.rotate(-u*Math.PI/180),U=new a.Point(Math.max(L.x,z.x),Math.max(L.y,z.y)),Q=new a.Point(Math.min(L.x,z.x),Math.min(L.y,z.y)),H=U.sub(Q),Y=(w.width-(E.left+E.right+p.padding.left+p.padding.right))/H.x,se=(w.height-(E.top+E.bottom+p.padding.top+p.padding.bottom))/H.y;if(se<0||Y<0)return void a.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.");const de=Math.min(w.scaleZoom(w.scale*Math.min(Y,se)),p.maxZoom),Pe=a.Point.convert(p.offset),ie=new a.Point((p.padding.left-p.padding.right)/2,(p.padding.top-p.padding.bottom)/2).rotate(u*Math.PI/180),Te=Pe.add(ie).mult(w.scale/w.zoomScale(de));return{center:w.unproject(C.add(A).div(2).sub(Te)),zoom:de,bearing:u}}fitBounds(n,o,u){return this._fitInternal(this.cameraForBounds(n,o),o,u)}fitScreenCoordinates(n,o,u,p,v){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(a.Point.convert(n)),this.transform.pointLocation(a.Point.convert(o)),u,p),p,v)}_fitInternal(n,o,u){return n?(delete(o=a.extend(n,o)).padding,o.linear?this.easeTo(o,u):this.flyTo(o,u)):this}jumpTo(n,o){this.stop();const u=this._getTransformForUpdate();let p=!1,v=!1,w=!1;return"zoom"in n&&u.zoom!==+n.zoom&&(p=!0,u.zoom=+n.zoom),n.center!==void 0&&(u.center=a.LngLat.convert(n.center)),"bearing"in n&&u.bearing!==+n.bearing&&(v=!0,u.bearing=+n.bearing),"pitch"in n&&u.pitch!==+n.pitch&&(w=!0,u.pitch=+n.pitch),n.padding==null||u.isPaddingEqual(n.padding)||(u.padding=n.padding),this._applyUpdatedTransform(u),this.fire(new a.Event("movestart",o)).fire(new a.Event("move",o)),p&&this.fire(new a.Event("zoomstart",o)).fire(new a.Event("zoom",o)).fire(new a.Event("zoomend",o)),v&&this.fire(new a.Event("rotatestart",o)).fire(new a.Event("rotate",o)).fire(new a.Event("rotateend",o)),w&&this.fire(new a.Event("pitchstart",o)).fire(new a.Event("pitch",o)).fire(new a.Event("pitchend",o)),this.fire(new a.Event("moveend",o))}calculateCameraOptionsFromTo(n,o,u,p=0){const v=a.MercatorCoordinate.fromLngLat(n,o),w=a.MercatorCoordinate.fromLngLat(u,p),E=w.x-v.x,C=w.y-v.y,A=w.z-v.z,L=Math.hypot(E,C,A);if(L===0)throw new Error("Can't calculate camera options with same From and To");const z=Math.hypot(E,C),U=this.transform.scaleZoom(this.transform.cameraToCenterDistance/L/this.transform.tileSize),Q=180*Math.atan2(E,-C)/Math.PI;let H=180*Math.acos(z/L)/Math.PI;return H=A<0?90-H:90+H,{center:w.toLngLat(),zoom:U,pitch:H,bearing:Q}}easeTo(n,o){this._stop(!1,n.easeId),((n=a.extend({offset:[0,0],duration:500,easing:a.ease},n)).animate===!1||!n.essential&&a.exported.prefersReducedMotion)&&(n.duration=0);const u=this._getTransformForUpdate(),p=this.getZoom(),v=this.getBearing(),w=this.getPitch(),E=this.getPadding(),C="zoom"in n?+n.zoom:p,A="bearing"in n?this._normalizeBearing(n.bearing,v):v,L="pitch"in n?+n.pitch:w,z="padding"in n?n.padding:u.padding,U=a.Point.convert(n.offset);let Q=u.centerPoint.add(U);const H=u.pointLocation(Q),Y=a.LngLat.convert(n.center||H);this._normalizeCenter(Y);const se=u.project(H),de=u.project(Y).sub(se),Pe=u.zoomScale(C-p);let ie,Te;n.around&&(ie=a.LngLat.convert(n.around),Te=u.locationPoint(ie));const De={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||C!==p,this._rotating=this._rotating||v!==A,this._pitching=this._pitching||L!==w,this._padding=!u.isPaddingEqual(z),this._easeId=n.easeId,this._prepareEase(o,n.noMoveStart,De),this.terrain&&this._prepareElevation(Y),this._ease(Ye=>{if(this._zooming&&(u.zoom=a.interpolate.number(p,C,Ye)),this._rotating&&(u.bearing=a.interpolate.number(v,A,Ye)),this._pitching&&(u.pitch=a.interpolate.number(w,L,Ye)),this._padding&&(u.interpolatePadding(E,z,Ye),Q=u.centerPoint.add(U)),this.terrain&&!n.freezeElevation&&this._updateElevation(Ye),ie)u.setLocationAtPoint(ie,Te);else{const it=u.zoomScale(u.zoom-p),ct=C>p?Math.min(2,Pe):Math.max(.5,Pe),et=Math.pow(ct,1-Ye),bt=u.unproject(se.add(de.mult(Ye*et)).mult(it));u.setLocationAtPoint(u.renderWorldCopies?bt.wrap():bt,Q)}this._applyUpdatedTransform(u),this._fireMoveEvents(o)},Ye=>{this.terrain&&this._finalizeElevation(),this._afterEase(o,Ye)},n),this}_prepareEase(n,o,u={}){this._moving=!0,o||u.moving||this.fire(new a.Event("movestart",n)),this._zooming&&!u.zooming&&this.fire(new a.Event("zoomstart",n)),this._rotating&&!u.rotating&&this.fire(new a.Event("rotatestart",n)),this._pitching&&!u.pitching&&this.fire(new a.Event("pitchstart",n))}_prepareElevation(n){this._elevationCenter=n,this._elevationStart=this.transform.elevation,this._elevationTarget=this.transform.getElevation(n,this.terrain),this.transform.freezeElevation=!0}_updateElevation(n){const o=this.transform.getElevation(this._elevationCenter,this.terrain);if(n<1&&o!==this._elevationTarget){const u=this._elevationTarget-this._elevationStart;this._elevationStart+=n*(u-(o-(u*n+this._elevationStart))/(1-n)),this._elevationTarget=o}this.transform.elevation=a.interpolate.number(this._elevationStart,this._elevationTarget,n)}_finalizeElevation(){this.transform.freezeElevation=!1,this.transform.recalculateZoom(this.terrain)}_getTransformForUpdate(){return this.transformCameraUpdate?(this._requestedCameraState||(this._requestedCameraState=this.transform.clone()),this._requestedCameraState):this.transform}_applyUpdatedTransform(n){if(!this.transformCameraUpdate)return;const o=n.clone(),{center:u,zoom:p,pitch:v,bearing:w,elevation:E}=this.transformCameraUpdate(o);u&&(o.center=u),p!==void 0&&(o.zoom=p),v!==void 0&&(o.pitch=v),w!==void 0&&(o.bearing=w),E!==void 0&&(o.elevation=E),this.transform.apply(o)}_fireMoveEvents(n){this.fire(new a.Event("move",n)),this._zooming&&this.fire(new a.Event("zoom",n)),this._rotating&&this.fire(new a.Event("rotate",n)),this._pitching&&this.fire(new a.Event("pitch",n))}_afterEase(n,o){if(this._easeId&&o&&this._easeId===o)return;delete this._easeId;const u=this._zooming,p=this._rotating,v=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,u&&this.fire(new a.Event("zoomend",n)),p&&this.fire(new a.Event("rotateend",n)),v&&this.fire(new a.Event("pitchend",n)),this.fire(new a.Event("moveend",n))}flyTo(n,o){if(!n.essential&&a.exported.prefersReducedMotion){const St=a.pick(n,["center","zoom","bearing","pitch","around"]);return this.jumpTo(St,o)}this.stop(),n=a.extend({offset:[0,0],speed:1.2,curve:1.42,easing:a.ease},n);const u=this._getTransformForUpdate(),p=this.getZoom(),v=this.getBearing(),w=this.getPitch(),E=this.getPadding(),C="zoom"in n?a.clamp(+n.zoom,u.minZoom,u.maxZoom):p,A="bearing"in n?this._normalizeBearing(n.bearing,v):v,L="pitch"in n?+n.pitch:w,z="padding"in n?n.padding:u.padding,U=u.zoomScale(C-p),Q=a.Point.convert(n.offset);let H=u.centerPoint.add(Q);const Y=u.pointLocation(H),se=a.LngLat.convert(n.center||Y);this._normalizeCenter(se);const de=u.project(Y),Pe=u.project(se).sub(de);let ie=n.curve;const Te=Math.max(u.width,u.height),De=Te/U,Ye=Pe.mag();if("minZoom"in n){const St=a.clamp(Math.min(n.minZoom,p,C),u.minZoom,u.maxZoom),_n=Te/u.zoomScale(St-p);ie=Math.sqrt(_n/Ye*2)}const it=ie*ie;function ct(St){const _n=(De*De-Te*Te+(St?-1:1)*it*it*Ye*Ye)/(2*(St?De:Te)*it*Ye);return Math.log(Math.sqrt(_n*_n+1)-_n)}function et(St){return(Math.exp(St)-Math.exp(-St))/2}function bt(St){return(Math.exp(St)+Math.exp(-St))/2}const Ot=ct(0);let Jt=function(St){return bt(Ot)/bt(Ot+ie*St)},pt=function(St){return Te*((bt(Ot)*(et(_n=Ot+ie*St)/bt(_n))-et(Ot))/it)/Ye;var _n},Zt=(ct(1)-Ot)/ie;if(Math.abs(Ye)<1e-6||!isFinite(Zt)){if(Math.abs(Te-De)<1e-6)return this.easeTo(n,o);const St=De<Te?-1:1;Zt=Math.abs(Math.log(De/Te))/ie,pt=function(){return 0},Jt=function(_n){return Math.exp(St*ie*_n)}}return n.duration="duration"in n?+n.duration:1e3*Zt/("screenSpeed"in n?+n.screenSpeed/ie:+n.speed),n.maxDuration&&n.duration>n.maxDuration&&(n.duration=0),this._zooming=!0,this._rotating=v!==A,this._pitching=L!==w,this._padding=!u.isPaddingEqual(z),this._prepareEase(o,!1),this.terrain&&this._prepareElevation(se),this._ease(St=>{const _n=St*Zt,ii=1/Jt(_n);u.zoom=St===1?C:p+u.scaleZoom(ii),this._rotating&&(u.bearing=a.interpolate.number(v,A,St)),this._pitching&&(u.pitch=a.interpolate.number(w,L,St)),this._padding&&(u.interpolatePadding(E,z,St),H=u.centerPoint.add(Q)),this.terrain&&!n.freezeElevation&&this._updateElevation(St);const vn=St===1?se:u.unproject(de.add(Pe.mult(pt(_n))).mult(ii));u.setLocationAtPoint(u.renderWorldCopies?vn.wrap():vn,H),this._applyUpdatedTransform(u),this._fireMoveEvents(o)},()=>{this.terrain&&this._finalizeElevation(),this._afterEase(o)},n),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(n,o){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const u=this._onEaseEnd;delete this._onEaseEnd,u.call(this,o)}if(!n){const u=this.handlers;u&&u.stop(!1)}return this}_ease(n,o,u){u.animate===!1||u.duration===0?(n(1),o()):(this._easeStart=a.exported.now(),this._easeOptions=u,this._onEaseFrame=n,this._onEaseEnd=o,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const n=Math.min((a.exported.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(n)),n<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(n,o){n=a.wrap(n,-180,180);const u=Math.abs(n-o);return Math.abs(n-360-o)<u&&(n-=360),Math.abs(n+360-o)<u&&(n+=360),n}_normalizeCenter(n){const o=this.transform;if(!o.renderWorldCopies||o.lngRange)return;const u=n.lng-o.center.lng;n.lng+=u>180?-360:u<-180?360:0}queryTerrainElevation(n){return this.terrain?this.transform.getElevation(a.LngLat.convert(n),this.terrain)-this.transform.elevation:null}}class qt{constructor(n={}){this.options=n,a.bindAll(["_toggleAttribution","_updateData","_updateCompact","_updateCompactMinimize"],this)}getDefaultPosition(){return"bottom-right"}onAdd(n){return this._map=n,this._compact=this.options&&this.options.compact,this._container=T.create("details","maplibregl-ctrl maplibregl-ctrl-attrib"),this._compactButton=T.create("summary","maplibregl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=T.create("div","maplibregl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){T.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(n,o){const u=this._map._getUIString(`AttributionControl.${o}`);n.title=u,n.setAttribute("aria-label",u)}_toggleAttribution(){this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show")):(this._container.classList.add("maplibregl-compact-show"),this._container.removeAttribute("open")))}_updateData(n){!n||n.sourceDataType!=="metadata"&&n.sourceDataType!=="visibility"&&n.dataType!=="style"&&n.type!=="terrain"||this._updateAttributions()}_updateAttributions(){if(!this._map.style)return;let n=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?n=n.concat(this.options.customAttribution.map(p=>typeof p!="string"?"":p)):typeof this.options.customAttribution=="string"&&n.push(this.options.customAttribution)),this._map.style.stylesheet){const p=this._map.style.stylesheet;this.styleOwner=p.owner,this.styleId=p.id}const o=this._map.style.sourceCaches;for(const p in o){const v=o[p];if(v.used||v.usedForTerrain){const w=v.getSource();w.attribution&&n.indexOf(w.attribution)<0&&n.push(w.attribution)}}n=n.filter(p=>String(p).trim()),n.sort((p,v)=>p.length-v.length),n=n.filter((p,v)=>{for(let w=v+1;w<n.length;w++)if(n[w].indexOf(p)>=0)return!1;return!0});const u=n.join(" | ");u!==this._attribHTML&&(this._attribHTML=u,n.length?(this._innerContainer.innerHTML=u,this._container.classList.remove("maplibregl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty"),this._updateCompact(),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact===!1?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","maplibregl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show"))}_updateCompactMinimize(){this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show")}}class ia{constructor(n={}){this.options=n,a.bindAll(["_updateCompact"],this)}getDefaultPosition(){return"bottom-left"}onAdd(n){this._map=n,this._compact=this.options&&this.options.compact,this._container=T.create("div","maplibregl-ctrl");const o=T.create("a","maplibregl-ctrl-logo");return o.target="_blank",o.rel="noopener nofollow",o.href="https://maplibre.org/",o.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),o.setAttribute("rel","noopener nofollow"),this._container.appendChild(o),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){T.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}_updateCompact(){const n=this._container.children;if(n.length){const o=n[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact!==!1&&o.classList.add("maplibregl-compact"):o.classList.remove("maplibregl-compact")}}}class Ac{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(n){const o=++this._id;return this._queue.push({callback:n,id:o,cancelled:!1}),o}remove(n){const o=this._currentlyRunning,u=o?this._queue.concat(o):this._queue;for(const p of u)if(p.id===n)return void(p.cancelled=!0)}run(n=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");const o=this._currentlyRunning=this._queue;this._queue=[];for(const u of o)if(!u.cancelled&&(u.callback(n),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}const Pc={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","TerrainControl.enableTerrain":"Enable terrain","TerrainControl.disableTerrain":"Disable terrain"};var Xi=a.createLayout([{name:"a_pos3d",type:"Int16",components:3}]);class bh extends a.Evented{constructor(n){super(),this.sourceCache=n,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.deltaZoom=1,n.usedForTerrain=!0,n.tileSize=this.tileSize*2**this.deltaZoom}destruct(){this.sourceCache.usedForTerrain=!1,this.sourceCache.tileSize=null}update(n,o){this.sourceCache.update(n,o),this._renderableTilesKeys=[];const u={};for(const p of n.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:o}))u[p.key]=!0,this._renderableTilesKeys.push(p.key),this._tiles[p.key]||(p.posMatrix=new Float64Array(16),a.ortho(p.posMatrix,0,a.EXTENT,0,a.EXTENT,0,1),this._tiles[p.key]=new ot(p,this.tileSize));for(const p in this._tiles)u[p]||delete this._tiles[p]}freeRtt(n){for(const o in this._tiles){const u=this._tiles[o];(!n||u.tileID.equals(n)||u.tileID.isChildOf(n)||n.isChildOf(u.tileID))&&(u.rtt=[])}}getRenderableTiles(){return this._renderableTilesKeys.map(n=>this.getTileByID(n))}getTileByID(n){return this._tiles[n]}getTerrainCoords(n){const o={};for(const u of this._renderableTilesKeys){const p=this._tiles[u].tileID;if(p.canonical.equals(n.canonical)){const v=n.clone();v.posMatrix=new Float64Array(16),a.ortho(v.posMatrix,0,a.EXTENT,0,a.EXTENT,0,1),o[u]=v}else if(p.canonical.isChildOf(n.canonical)){const v=n.clone();v.posMatrix=new Float64Array(16);const w=p.canonical.z-n.canonical.z,E=p.canonical.x-(p.canonical.x>>w<<w),C=p.canonical.y-(p.canonical.y>>w<<w),A=a.EXTENT>>w;a.ortho(v.posMatrix,0,A,0,A,0,1),a.translate(v.posMatrix,v.posMatrix,[-E*A,-C*A,0]),o[u]=v}else if(n.canonical.isChildOf(p.canonical)){const v=n.clone();v.posMatrix=new Float64Array(16);const w=n.canonical.z-p.canonical.z,E=n.canonical.x-(n.canonical.x>>w<<w),C=n.canonical.y-(n.canonical.y>>w<<w),A=a.EXTENT>>w;a.ortho(v.posMatrix,0,a.EXTENT,0,a.EXTENT,0,1),a.translate(v.posMatrix,v.posMatrix,[E*A,C*A,0]),a.scale(v.posMatrix,v.posMatrix,[1/2**w,1/2**w,0]),o[u]=v}}return o}getSourceTile(n,o){const u=this.sourceCache._source;let p=n.overscaledZ-this.deltaZoom;if(p>u.maxzoom&&(p=u.maxzoom),p<u.minzoom)return null;this._sourceTileCache[n.key]||(this._sourceTileCache[n.key]=n.scaledTo(p).key);let v=this.sourceCache.getTileByID(this._sourceTileCache[n.key]);if((!v||!v.dem)&&o)for(;p>=u.minzoom&&(!v||!v.dem);)v=this.sourceCache.getTileByID(n.scaledTo(p--).key);return v}tilesAfterTime(n=Date.now()){return Object.values(this._tiles).filter(o=>o.timeAdded>=n)}}class Hr{constructor(n,o,u){this.painter=n,this.sourceCache=new bh(o),this.options=u,this.exaggeration=typeof u.exaggeration=="number"?u.exaggeration:1,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024}getDEMElevation(n,o,u,p=a.EXTENT){if(!(o>=0&&o<p&&u>=0&&u<p))return 0;let v=0;const w=this.getTerrainData(n);if(w.tile&&w.tile.dem){const E=function(H,Y,se){var de=Y[0],Pe=Y[1];return H[0]=se[0]*de+se[4]*Pe+se[12],H[1]=se[1]*de+se[5]*Pe+se[13],H}([],[o/p*a.EXTENT,u/p*a.EXTENT],w.u_terrain_matrix),C=[E[0]*w.tile.dem.dim,E[1]*w.tile.dem.dim],A=[Math.floor(C[0]),Math.floor(C[1])],L=w.tile.dem.get(A[0],A[1]),z=w.tile.dem.get(A[0],A[1]+1),U=w.tile.dem.get(A[0]+1,A[1]),Q=w.tile.dem.get(A[0]+1,A[1]+1);v=a.interpolate.number(a.interpolate.number(L,z,C[0]-A[0]),a.interpolate.number(U,Q,C[0]-A[0]),C[1]-A[1])}return v}getElevation(n,o,u,p=a.EXTENT){return this.getDEMElevation(n,o,u,p)*this.exaggeration}getTerrainData(n){if(!this._emptyDemTexture){const p=this.painter.context,v=new a.RGBAImage({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new Se(p,v,p.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new Se(p,new a.RGBAImage({width:1,height:1}),p.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(p.gl.NEAREST,p.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=a.identity([])}const o=this.sourceCache.getSourceTile(n,!0);if(o&&o.dem&&(!o.demTexture||o.needsTerrainPrepare)){const p=this.painter.context;o.demTexture=this.painter.getTileTexture(o.dem.stride),o.demTexture?o.demTexture.update(o.dem.getPixels(),{premultiply:!1}):o.demTexture=new Se(p,o.dem.getPixels(),p.gl.RGBA,{premultiply:!1}),o.demTexture.bind(p.gl.NEAREST,p.gl.CLAMP_TO_EDGE),o.needsTerrainPrepare=!1}const u=o&&o+o.tileID.key+n.key;if(u&&!this._demMatrixCache[u]){const p=this.sourceCache.sourceCache._source.maxzoom;let v=n.canonical.z-o.tileID.canonical.z;n.overscaledZ>n.canonical.z&&(n.canonical.z>=p?v=n.canonical.z-p:a.warnOnce("cannot calculate elevation if elevation maxzoom > source.maxzoom"));const w=n.canonical.x-(n.canonical.x>>v<<v),E=n.canonical.y-(n.canonical.y>>v<<v),C=a.fromScaling(new Float64Array(16),[1/(a.EXTENT<<v),1/(a.EXTENT<<v),0]);a.translate(C,C,[w*a.EXTENT,E*a.EXTENT,0]),this._demMatrixCache[n.key]={matrix:C,coord:n}}return{u_depth:2,u_terrain:3,u_terrain_dim:o&&o.dem&&o.dem.dim||1,u_terrain_matrix:u?this._demMatrixCache[n.key].matrix:this._emptyDemMatrix,u_terrain_unpack:o&&o.dem&&o.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_exaggeration:this.exaggeration,texture:(o&&o.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:o}}getFramebuffer(n){const o=this.painter,u=o.width/devicePixelRatio,p=o.height/devicePixelRatio;return!this._fbo||this._fbo.width===u&&this._fbo.height===p||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new Se(o.context,{width:u,height:p,data:null},o.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(o.context.gl.NEAREST,o.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new Se(o.context,{width:u,height:p,data:null},o.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(o.context.gl.NEAREST,o.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=o.context.createFramebuffer(u,p,!0,!1),this._fbo.depthAttachment.set(o.context.createRenderbuffer(o.context.gl.DEPTH_COMPONENT16,u,p))),this._fbo.colorAttachment.set(n==="coords"?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){const n=this.painter.context;if(this._coordsTexture)return this._coordsTexture;const o=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let v=0,w=0;v<this._coordsTextureSize;v++)for(let E=0;E<this._coordsTextureSize;E++,w+=4)o[w+0]=255&E,o[w+1]=255&v,o[w+2]=E>>8<<4|v>>8,o[w+3]=0;const u=new a.RGBAImage({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(o.buffer)),p=new Se(n,u,n.gl.RGBA,{premultiply:!1});return p.bind(n.gl.NEAREST,n.gl.CLAMP_TO_EDGE),this._coordsTexture=p,p}pointCoordinate(n){const o=new Uint8Array(4),u=this.painter.context,p=u.gl;u.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),p.readPixels(n.x,this.painter.height/devicePixelRatio-n.y-1,1,1,p.RGBA,p.UNSIGNED_BYTE,o),u.bindFramebuffer.set(null);const v=o[0]+(o[2]>>4<<8),w=o[1]+((15&o[2])<<8),E=this.coordsIndex[255-o[3]],C=E&&this.sourceCache.getTileByID(E);if(!C)return null;const A=this._coordsTextureSize,L=(1<<C.tileID.canonical.z)*A;return new a.MercatorCoordinate((C.tileID.canonical.x*A+v)/L,(C.tileID.canonical.y*A+w)/L,this.getElevation(C.tileID,v,w,A))}getTerrainMesh(){if(this._mesh)return this._mesh;const n=this.painter.context,o=new a.Pos3dArray,u=new a.TriangleIndexArray,p=this.meshSize,v=a.EXTENT/p,w=p*p;for(let z=0;z<=p;z++)for(let U=0;U<=p;U++)o.emplaceBack(U*v,z*v,0);for(let z=0;z<w;z+=p+1)for(let U=0;U<p;U++)u.emplaceBack(U+z,p+U+z+1,p+U+z+2),u.emplaceBack(U+z,p+U+z+2,U+z+1);const E=o.length,C=E+2*(p+1);for(const z of[0,1])for(let U=0;U<=p;U++)for(const Q of[0,1])o.emplaceBack(U*v,z*a.EXTENT,Q);for(let z=0;z<2*p;z+=2)u.emplaceBack(C+z,C+z+1,C+z+3),u.emplaceBack(C+z,C+z+3,C+z+2),u.emplaceBack(E+z,E+z+3,E+z+1),u.emplaceBack(E+z,E+z+2,E+z+3);const A=o.length,L=A+2*(p+1);for(const z of[0,1])for(let U=0;U<=p;U++)for(const Q of[0,1])o.emplaceBack(z*a.EXTENT,U*v,Q);for(let z=0;z<2*p;z+=2)u.emplaceBack(A+z,A+z+1,A+z+3),u.emplaceBack(A+z,A+z+3,A+z+2),u.emplaceBack(L+z,L+z+3,L+z+1),u.emplaceBack(L+z,L+z+2,L+z+3);return this._mesh={indexBuffer:n.createIndexBuffer(u),vertexBuffer:n.createVertexBuffer(o,Xi.members),segments:a.SegmentVector.simpleSegment(0,0,o.length,u.length)},this._mesh}getMeshFrameDelta(n){return 2*Math.PI*a.earthRadius/Math.pow(2,n)/5}getMinMaxElevation(n){const o=this.getTerrainData(n).tile,u={minElevation:null,maxElevation:null};return o&&o.dem&&(u.minElevation=o.dem.min*this.exaggeration,u.maxElevation=o.dem.max*this.exaggeration),u}}class xf{constructor(n,o,u){this._context=n,this._size=o,this._tileSize=u,this._objects=[],this._recentlyUsed=[],this._stamp=0}destruct(){for(const n of this._objects)n.texture.destroy(),n.fbo.destroy()}_createObject(n){const o=this._context.createFramebuffer(this._tileSize,this._tileSize,!0,!0),u=new Se(this._context,{width:this._tileSize,height:this._tileSize,data:null},this._context.gl.RGBA);return u.bind(this._context.gl.LINEAR,this._context.gl.CLAMP_TO_EDGE),o.depthAttachment.set(this._context.createRenderbuffer(this._context.gl.DEPTH_STENCIL,this._tileSize,this._tileSize)),o.colorAttachment.set(u.texture),{id:n,fbo:o,texture:u,stamp:-1,inUse:!1}}getObjectForId(n){return this._objects[n]}useObject(n){n.inUse=!0,this._recentlyUsed=this._recentlyUsed.filter(o=>n.id!==o),this._recentlyUsed.push(n.id)}stampObject(n){n.stamp=++this._stamp}getOrCreateFreeObject(){for(const o of this._recentlyUsed)if(!this._objects[o].inUse)return this._objects[o];if(this._objects.length>=this._size)throw new Error("No free RenderPool available, call freeAllObjects() required!");const n=this._createObject(this._objects.length);return this._objects.push(n),n}freeObject(n){n.inUse=!1}freeAllObjects(){for(const n of this._objects)this.freeObject(n)}isFull(){return!(this._objects.length<this._size)&&this._objects.some(n=>!n.inUse)===!1}}const ls={background:!0,fill:!0,line:!0,raster:!0,hillshade:!0};class Yn{constructor(n,o){this.painter=n,this.terrain=o,this.pool=new xf(n.context,30,o.sourceCache.tileSize*o.qualityFactor)}destruct(){this.pool.destruct()}getTexture(n){return this.pool.getObjectForId(n.rtt[this._stacks.length-1].id).texture}prepareForRender(n,o){this._stacks=[],this._prevType=null,this._rttTiles=[],this._renderableTiles=this.terrain.sourceCache.getRenderableTiles(),this._renderableLayerIds=n._order.filter(u=>!n._layers[u].isHidden(o)),this._coordsDescendingInv={};for(const u in n.sourceCaches){this._coordsDescendingInv[u]={};const p=n.sourceCaches[u].getVisibleCoordinates();for(const v of p){const w=this.terrain.sourceCache.getTerrainCoords(v);for(const E in w)this._coordsDescendingInv[u][E]||(this._coordsDescendingInv[u][E]=[]),this._coordsDescendingInv[u][E].push(w[E])}}this._coordsDescendingInvStr={};for(const u of n._order){const p=n._layers[u],v=p.source;if(ls[p.type]&&!this._coordsDescendingInvStr[v]){this._coordsDescendingInvStr[v]={};for(const w in this._coordsDescendingInv[v])this._coordsDescendingInvStr[v][w]=this._coordsDescendingInv[v][w].map(E=>E.key).sort().join()}}for(const u of this._renderableTiles)for(const p in this._coordsDescendingInvStr){const v=this._coordsDescendingInvStr[p][u.tileID.key];v&&v!==u.rttCoords[p]&&(u.rtt=[])}}renderLayer(n){if(n.isHidden(this.painter.transform.zoom))return!1;const o=n.type,u=this.painter,p=this._renderableLayerIds[this._renderableLayerIds.length-1]===n.id;if(ls[o]&&(this._prevType&&ls[this._prevType]||this._stacks.push([]),this._prevType=o,this._stacks[this._stacks.length-1].push(n.id),!p))return!0;if(ls[this._prevType]||ls[o]&&p){this._prevType=o;const v=this._stacks.length-1,w=this._stacks[v]||[];for(const E of this._renderableTiles){if(this.pool.isFull()&&(vc(this.painter,this.terrain,this._rttTiles),this._rttTiles=[],this.pool.freeAllObjects()),this._rttTiles.push(E),E.rtt[v]){const A=this.pool.getObjectForId(E.rtt[v].id);if(A.stamp===E.rtt[v].stamp){this.pool.useObject(A);continue}}const C=this.pool.getOrCreateFreeObject();this.pool.useObject(C),this.pool.stampObject(C),E.rtt[v]={id:C.id,stamp:C.stamp},u.context.bindFramebuffer.set(C.fbo.framebuffer),u.context.clear({color:a.Color.transparent,stencil:0}),u.currentStencilSource=void 0;for(let A=0;A<w.length;A++){const L=u.style._layers[w[A]],z=L.source?this._coordsDescendingInv[L.source][E.tileID.key]:[E.tileID];u.context.viewport.set([0,0,C.fbo.width,C.fbo.height]),u._renderTileClippingMasks(L,z),u.renderLayer(u,u.style.sourceCaches[L.source],L,z),L.source&&(E.rttCoords[L.source]=this._coordsDescendingInvStr[L.source][E.tileID.key])}}return vc(this.painter,this.terrain,this._rttTiles),this._rttTiles=[],this.pool.freeAllObjects(),ls[o]}return!1}}const ui=I,wh={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:void 0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,maplibreLogo:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,maxTileCacheZoomLevels:a.config.MAX_TILE_CACHE_ZOOM_LEVELS,localIdeographFontFamily:"sans-serif",transformRequest:null,transformCameraUpdate:null,fadeDuration:300,crossSourceCollisions:!0,validateStyle:!0},vo=d=>{d.touchstart=d.dragStart,d.touchmoveWindow=d.dragMove,d.touchend=d.dragEnd},il={showCompass:!0,showZoom:!0,visualizePitch:!1};class kc{constructor(n,o,u=!1){this._clickTolerance=10;const p=n.dragRotate._mouseRotate.getClickTolerance(),v=n.dragRotate._mousePitch.getClickTolerance();this.element=o,this.mouseRotate=ph({clickTolerance:p,enable:!0}),this.touchRotate=(({enable:w,clickTolerance:E,bearingDegreesPerPixelMoved:C=.8})=>{const A=new Xa;return new as({clickTolerance:E,move:(L,z)=>({bearingDelta:(z.x-L.x)*C}),moveStateManager:A,enable:w,assignEvents:vo})})({clickTolerance:p,enable:!0}),this.map=n,u&&(this.mousePitch=Ka({clickTolerance:v,enable:!0}),this.touchPitch=(({enable:w,clickTolerance:E,pitchDegreesPerPixelMoved:C=-.5})=>{const A=new Xa;return new as({clickTolerance:E,move:(L,z)=>({pitchDelta:(z.y-L.y)*C}),moveStateManager:A,enable:w,assignEvents:vo})})({clickTolerance:v,enable:!0})),a.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),T.addEventListener(o,"mousedown",this.mousedown),T.addEventListener(o,"touchstart",this.touchstart,{passive:!1}),T.addEventListener(o,"touchcancel",this.reset)}startMouse(n,o){this.mouseRotate.dragStart(n,o),this.mousePitch&&this.mousePitch.dragStart(n,o),T.disableDrag()}startTouch(n,o){this.touchRotate.dragStart(n,o),this.touchPitch&&this.touchPitch.dragStart(n,o),T.disableDrag()}moveMouse(n,o){const u=this.map,{bearingDelta:p}=this.mouseRotate.dragMove(n,o)||{};if(p&&u.setBearing(u.getBearing()+p),this.mousePitch){const{pitchDelta:v}=this.mousePitch.dragMove(n,o)||{};v&&u.setPitch(u.getPitch()+v)}}moveTouch(n,o){const u=this.map,{bearingDelta:p}=this.touchRotate.dragMove(n,o)||{};if(p&&u.setBearing(u.getBearing()+p),this.touchPitch){const{pitchDelta:v}=this.touchPitch.dragMove(n,o)||{};v&&u.setPitch(u.getPitch()+v)}}off(){const n=this.element;T.removeEventListener(n,"mousedown",this.mousedown),T.removeEventListener(n,"touchstart",this.touchstart,{passive:!1}),T.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),T.removeEventListener(window,"touchend",this.touchend),T.removeEventListener(n,"touchcancel",this.reset),this.offTemp()}offTemp(){T.enableDrag(),T.removeEventListener(window,"mousemove",this.mousemove),T.removeEventListener(window,"mouseup",this.mouseup),T.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),T.removeEventListener(window,"touchend",this.touchend)}mousedown(n){this.startMouse(a.extend({},n,{ctrlKey:!0,preventDefault:()=>n.preventDefault()}),T.mousePos(this.element,n)),T.addEventListener(window,"mousemove",this.mousemove),T.addEventListener(window,"mouseup",this.mouseup)}mousemove(n){this.moveMouse(n,T.mousePos(this.element,n))}mouseup(n){this.mouseRotate.dragEnd(n),this.mousePitch&&this.mousePitch.dragEnd(n),this.offTemp()}touchstart(n){n.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=T.touchPos(this.element,n.targetTouches)[0],this.startTouch(n,this._startPos),T.addEventListener(window,"touchmove",this.touchmove,{passive:!1}),T.addEventListener(window,"touchend",this.touchend))}touchmove(n){n.targetTouches.length!==1?this.reset():(this._lastPos=T.touchPos(this.element,n.targetTouches)[0],this.moveTouch(n,this._lastPos))}touchend(n){n.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),delete this._startPos,delete this._lastPos,this.offTemp()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),this.touchRotate.reset(),this.touchPitch&&this.touchPitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}let Xr;function rl(d,n,o){if(d=new a.LngLat(d.lng,d.lat),n){const u=new a.LngLat(d.lng-360,d.lat),p=new a.LngLat(d.lng+360,d.lat),v=o.locationPoint(d).distSqr(n);o.locationPoint(u).distSqr(n)<v?d=u:o.locationPoint(p).distSqr(n)<v&&(d=p)}for(;Math.abs(d.lng-o.center.lng)>180;){const u=o.locationPoint(d);if(u.x>=0&&u.y>=0&&u.x<=o.width&&u.y<=o.height)break;d.lng>o.center.lng?d.lng-=360:d.lng+=360}return d}const js={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function sl(d,n,o){const u=d.classList;for(const p in js)u.remove(`maplibregl-${o}-anchor-${p}`);u.add(`maplibregl-${o}-anchor-${n}`)}class ra extends a.Evented{constructor(n,o){if(super(),(n instanceof HTMLElement||o)&&(n=a.extend({element:n},o)),a.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress"],this),this._anchor=n&&n.anchor||"center",this._color=n&&n.color||"#3FB1CE",this._scale=n&&n.scale||1,this._draggable=n&&n.draggable||!1,this._clickTolerance=n&&n.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=n&&n.rotation||0,this._rotationAlignment=n&&n.rotationAlignment||"auto",this._pitchAlignment=n&&n.pitchAlignment&&n.pitchAlignment!=="auto"?n.pitchAlignment:this._rotationAlignment,n&&n.element)this._element=n.element,this._offset=a.Point.convert(n&&n.offset||[0,0]);else{this._defaultMarker=!0,this._element=T.create("div"),this._element.setAttribute("aria-label","Map marker");const u=T.createNS("http://www.w3.org/2000/svg","svg"),p=41,v=27;u.setAttributeNS(null,"display","block"),u.setAttributeNS(null,"height",`${p}px`),u.setAttributeNS(null,"width",`${v}px`),u.setAttributeNS(null,"viewBox",`0 0 ${v} ${p}`);const w=T.createNS("http://www.w3.org/2000/svg","g");w.setAttributeNS(null,"stroke","none"),w.setAttributeNS(null,"stroke-width","1"),w.setAttributeNS(null,"fill","none"),w.setAttributeNS(null,"fill-rule","evenodd");const E=T.createNS("http://www.w3.org/2000/svg","g");E.setAttributeNS(null,"fill-rule","nonzero");const C=T.createNS("http://www.w3.org/2000/svg","g");C.setAttributeNS(null,"transform","translate(3.0, 29.0)"),C.setAttributeNS(null,"fill","#000000");const A=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const Pe of A){const ie=T.createNS("http://www.w3.org/2000/svg","ellipse");ie.setAttributeNS(null,"opacity","0.04"),ie.setAttributeNS(null,"cx","10.5"),ie.setAttributeNS(null,"cy","5.80029008"),ie.setAttributeNS(null,"rx",Pe.rx),ie.setAttributeNS(null,"ry",Pe.ry),C.appendChild(ie)}const L=T.createNS("http://www.w3.org/2000/svg","g");L.setAttributeNS(null,"fill",this._color);const z=T.createNS("http://www.w3.org/2000/svg","path");z.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),L.appendChild(z);const U=T.createNS("http://www.w3.org/2000/svg","g");U.setAttributeNS(null,"opacity","0.25"),U.setAttributeNS(null,"fill","#000000");const Q=T.createNS("http://www.w3.org/2000/svg","path");Q.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),U.appendChild(Q);const H=T.createNS("http://www.w3.org/2000/svg","g");H.setAttributeNS(null,"transform","translate(6.0, 7.0)"),H.setAttributeNS(null,"fill","#FFFFFF");const Y=T.createNS("http://www.w3.org/2000/svg","g");Y.setAttributeNS(null,"transform","translate(8.0, 8.0)");const se=T.createNS("http://www.w3.org/2000/svg","circle");se.setAttributeNS(null,"fill","#000000"),se.setAttributeNS(null,"opacity","0.25"),se.setAttributeNS(null,"cx","5.5"),se.setAttributeNS(null,"cy","5.5"),se.setAttributeNS(null,"r","5.4999962");const de=T.createNS("http://www.w3.org/2000/svg","circle");de.setAttributeNS(null,"fill","#FFFFFF"),de.setAttributeNS(null,"cx","5.5"),de.setAttributeNS(null,"cy","5.5"),de.setAttributeNS(null,"r","5.4999962"),Y.appendChild(se),Y.appendChild(de),E.appendChild(C),E.appendChild(L),E.appendChild(U),E.appendChild(H),E.appendChild(Y),u.appendChild(E),u.setAttributeNS(null,"height",p*this._scale+"px"),u.setAttributeNS(null,"width",v*this._scale+"px"),this._element.appendChild(u),this._offset=a.Point.convert(n&&n.offset||[0,-14])}this._element.classList.add("maplibregl-marker"),this._element.addEventListener("dragstart",u=>{u.preventDefault()}),this._element.addEventListener("mousedown",u=>{u.preventDefault()}),sl(this._element,this._anchor,"marker"),this._popup=null}addTo(n){return this.remove(),this._map=n,n.getCanvasContainer().appendChild(this._element),n.on("move",this._update),n.on("moveend",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),T.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(n){return this._lngLat=a.LngLat.convert(n),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(n){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),n){if(!("offset"in n.options)){const p=Math.sqrt(Math.pow(13.5,2)/2);n.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[p,-1*(38.1-13.5+p)],"bottom-right":[-p,-1*(38.1-13.5+p)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=n,this._lngLat&&this._popup.setLngLat(this._lngLat),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}_onKeyPress(n){const o=n.code,u=n.charCode||n.keyCode;o!=="Space"&&o!=="Enter"&&u!==32&&u!==13||this.togglePopup()}_onMapClick(n){const o=n.originalEvent.target,u=this._element;this._popup&&(o===u||u.contains(o))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const n=this._popup;return n?(n.isOpen()?n.remove():n.addTo(this._map),this):this}_update(n){if(!this._map)return;this._map.transform.renderWorldCopies&&(this._lngLat=rl(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._offset);let o="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?o=`rotateZ(${this._rotation}deg)`:this._rotationAlignment==="map"&&(o=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let u="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?u="rotateX(0deg)":this._pitchAlignment==="map"&&(u=`rotateX(${this._map.getPitch()}deg)`),n&&n.type!=="moveend"||(this._pos=this._pos.round()),T.setTransform(this._element,`${js[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${u} ${o}`),this._map.terrain&&!this._opacityTimeout&&(this._opacityTimeout=setTimeout(()=>{const p=this._map.unproject(this._pos),v=40075016686e-3*Math.abs(Math.cos(this._lngLat.lat*Math.PI/180))/Math.pow(2,this._map.transform.tileZoom+8);this._element.style.opacity=p.distanceTo(this._lngLat)>20*v?"0.2":"1.0",this._opacityTimeout=null},100))}getOffset(){return this._offset}setOffset(n){return this._offset=a.Point.convert(n),this._update(),this}_onMove(n){if(!this._isDragging){const o=this._clickTolerance||this._map._clickTolerance;this._isDragging=n.point.dist(this._pointerdownPos)>=o}this._isDragging&&(this._pos=n.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new a.Event("dragstart"))),this.fire(new a.Event("drag")))}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new a.Event("dragend")),this._state="inactive"}_addDragHandler(n){this._element.contains(n.originalEvent.target)&&(n.preventDefault(),this._positionDelta=n.point.sub(this._pos).add(this._offset),this._pointerdownPos=n.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))}setDraggable(n){return this._draggable=!!n,this._map&&(n?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(n){return this._rotation=n||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(n){return this._rotationAlignment=n||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(n){return this._pitchAlignment=n&&n!=="auto"?n:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}}const Mc={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let xo=0,qs=!1;const Dc={maxWidth:100,unit:"metric"};function ol(d,n,o){const u=o&&o.maxWidth||100,p=d._container.clientHeight/2,v=d.unproject([0,p]),w=d.unproject([u,p]),E=v.distanceTo(w);if(o&&o.unit==="imperial"){const C=3.2808*E;C>5280?Zs(n,u,C/5280,d._getUIString("ScaleControl.Miles")):Zs(n,u,C,d._getUIString("ScaleControl.Feet"))}else o&&o.unit==="nautical"?Zs(n,u,E/1852,d._getUIString("ScaleControl.NauticalMiles")):E>=1e3?Zs(n,u,E/1e3,d._getUIString("ScaleControl.Kilometers")):Zs(n,u,E,d._getUIString("ScaleControl.Meters"))}function Zs(d,n,o,u){const p=function(v){const w=Math.pow(10,`${Math.floor(v)}`.length-1);let E=v/w;return E=E>=10?10:E>=5?5:E>=3?3:E>=2?2:E>=1?1:function(C){const A=Math.pow(10,Math.ceil(-Math.log(C)/Math.LN10));return Math.round(C*A)/A}(E),w*E}(o);d.style.width=n*(p/o)+"px",d.innerHTML=`${p}&nbsp;${u}`}const al={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},zc=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function ll(d){if(d){if(typeof d=="number"){const n=Math.round(Math.sqrt(.5*Math.pow(d,2)));return{center:new a.Point(0,0),top:new a.Point(0,d),"top-left":new a.Point(n,n),"top-right":new a.Point(-n,n),bottom:new a.Point(0,-d),"bottom-left":new a.Point(n,-n),"bottom-right":new a.Point(-n,-n),left:new a.Point(d,0),right:new a.Point(-d,0)}}if(d instanceof a.Point||Array.isArray(d)){const n=a.Point.convert(d);return{center:n,top:n,"top-left":n,"top-right":n,bottom:n,"bottom-left":n,"bottom-right":n,left:n,right:n}}return{center:a.Point.convert(d.center||[0,0]),top:a.Point.convert(d.top||[0,0]),"top-left":a.Point.convert(d["top-left"]||[0,0]),"top-right":a.Point.convert(d["top-right"]||[0,0]),bottom:a.Point.convert(d.bottom||[0,0]),"bottom-left":a.Point.convert(d["bottom-left"]||[0,0]),"bottom-right":a.Point.convert(d["bottom-right"]||[0,0]),left:a.Point.convert(d.left||[0,0]),right:a.Point.convert(d.right||[0,0])}}return ll(new a.Point(0,0))}const cl=I,ul={setRTLTextPlugin:a.setRTLTextPlugin,getRTLTextPluginStatus:a.getRTLTextPluginStatus,Map:class extends zt{constructor(d){var n;if(a.PerformanceUtils.mark(a.PerformanceMarkers.create),(d=a.extend({},wh,d)).minZoom!=null&&d.maxZoom!=null&&d.minZoom>d.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(d.minPitch!=null&&d.maxPitch!=null&&d.minPitch>d.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(d.minPitch!=null&&d.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(d.maxPitch!=null&&d.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(super(new Wa(d.minZoom,d.maxZoom,d.minPitch,d.maxPitch,d.renderWorldCopies),{bearingSnap:d.bearingSnap}),this._interactive=d.interactive,this._cooperativeGestures=d.cooperativeGestures,this._metaKey=navigator.platform.indexOf("Mac")===0?"metaKey":"ctrlKey",this._maxTileCacheSize=d.maxTileCacheSize,this._maxTileCacheZoomLevels=d.maxTileCacheZoomLevels,this._failIfMajorPerformanceCaveat=d.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=d.preserveDrawingBuffer,this._antialias=d.antialias,this._trackResize=d.trackResize,this._bearingSnap=d.bearingSnap,this._refreshExpiredTiles=d.refreshExpiredTiles,this._fadeDuration=d.fadeDuration,this._crossSourceCollisions=d.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=d.collectResourceTiming,this._renderTaskQueue=new Ac,this._controls=[],this._mapId=a.uniqueId(),this._locale=a.extend({},Pc,d.locale),this._clickTolerance=d.clickTolerance,this._pixelRatio=(n=d.pixelRatio)!==null&&n!==void 0?n:devicePixelRatio,this.transformCameraUpdate=d.transformCameraUpdate,this._imageQueueHandle=Ee.addThrottleControl(()=>this.isMoving()),this._requestManager=new be(d.transformRequest),typeof d.container=="string"){if(this._container=document.getElementById(d.container),!this._container)throw new Error(`Container '${d.container}' not found.`)}else{if(!(d.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=d.container}if(d.maxBounds&&this.setMaxBounds(d.maxBounds),a.bindAll(["_onWindowOnline","_onMapScroll","_cooperativeGesturesOnWheel","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),this.on("terrain",()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)}),this.once("idle",()=>{this._idleTriggered=!0}),typeof window<"u"){addEventListener("online",this._onWindowOnline,!1);let o=!1;this._resizeObserver=new ResizeObserver(u=>{o?this._trackResize&&this.resize(u)._update():o=!0}),this._resizeObserver.observe(this._container)}this.handlers=new Wr(this,d),this._cooperativeGestures&&this._setupCooperativeGestures(),this._hash=d.hash&&new ch(typeof d.hash=="string"&&d.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:d.center,zoom:d.zoom,bearing:d.bearing,pitch:d.pitch}),d.bounds&&(this.resize(),this.fitBounds(d.bounds,a.extend({},d.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=d.localIdeographFontFamily,this._validateStyle=d.validateStyle,d.style&&this.setStyle(d.style,{localIdeographFontFamily:d.localIdeographFontFamily}),d.attributionControl&&this.addControl(new qt({customAttribution:d.customAttribution})),d.maplibreLogo&&this.addControl(new ia,d.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",o=>{this._update(o.dataType==="style"),this.fire(new a.Event(`${o.dataType}data`,o))}),this.on("dataloading",o=>{this.fire(new a.Event(`${o.dataType}dataloading`,o))}),this.on("dataabort",o=>{this.fire(new a.Event("sourcedataabort",o))})}_getMapId(){return this._mapId}addControl(d,n){if(n===void 0&&(n=d.getDefaultPosition?d.getDefaultPosition():"top-right"),!d||!d.onAdd)return this.fire(new a.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const o=d.onAdd(this);this._controls.push(d);const u=this._controlPositions[n];return n.indexOf("bottom")!==-1?u.insertBefore(o,u.firstChild):u.appendChild(o),this}removeControl(d){if(!d||!d.onRemove)return this.fire(new a.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const n=this._controls.indexOf(d);return n>-1&&this._controls.splice(n,1),d.onRemove(this),this}hasControl(d){return this._controls.indexOf(d)>-1}calculateCameraOptionsFromTo(d,n,o,u){return u==null&&this.terrain&&(u=this.transform.getElevation(o,this.terrain)),super.calculateCameraOptionsFromTo(d,n,o,u)}resize(d){var n;const o=this._containerDimensions(),u=o[0],p=o[1];this._resizeCanvas(u,p,this.getPixelRatio()),this.transform.resize(u,p),(n=this._requestedCameraState)===null||n===void 0||n.resize(u,p),this.painter.resize(u,p,this.getPixelRatio());const v=!this._moving;return v&&(this.stop(),this.fire(new a.Event("movestart",d)).fire(new a.Event("move",d))),this.fire(new a.Event("resize",d)),v&&this.fire(new a.Event("moveend",d)),this}getPixelRatio(){return this._pixelRatio}setPixelRatio(d){const[n,o]=this._containerDimensions();this._pixelRatio=d,this._resizeCanvas(n,o,d),this.painter.resize(n,o,d)}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(d){return this.transform.setMaxBounds(Rt.convert(d)),this._update()}setMinZoom(d){if((d=d??-2)>=-2&&d<=this.transform.maxZoom)return this.transform.minZoom=d,this._update(),this.getZoom()<d&&this.setZoom(d),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(d){if((d=d??22)>=this.transform.minZoom)return this.transform.maxZoom=d,this._update(),this.getZoom()>d&&this.setZoom(d),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(d){if((d=d??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(d>=0&&d<=this.transform.maxPitch)return this.transform.minPitch=d,this._update(),this.getPitch()<d&&this.setPitch(d),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(d){if((d=d??60)>85)throw new Error("maxPitch must be less than or equal to 85");if(d>=this.transform.minPitch)return this.transform.maxPitch=d,this._update(),this.getPitch()>d&&this.setPitch(d),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(d){return this.transform.renderWorldCopies=d,this._update()}getCooperativeGestures(){return this._cooperativeGestures}setCooperativeGestures(d){return this._cooperativeGestures=d,this._cooperativeGestures?this._setupCooperativeGestures():this._destroyCooperativeGestures(),this}project(d){return this.transform.locationPoint(a.LngLat.convert(d),this.style&&this.terrain)}unproject(d){return this.transform.pointLocation(a.Point.convert(d),this.terrain)}isMoving(){var d;return this._moving||((d=this.handlers)===null||d===void 0?void 0:d.isMoving())}isZooming(){var d;return this._zooming||((d=this.handlers)===null||d===void 0?void 0:d.isZooming())}isRotating(){var d;return this._rotating||((d=this.handlers)===null||d===void 0?void 0:d.isRotating())}_createDelegatedListener(d,n,o){if(d==="mouseenter"||d==="mouseover"){let u=!1;return{layer:n,listener:o,delegates:{mousemove:v=>{const w=this.getLayer(n)?this.queryRenderedFeatures(v.point,{layers:[n]}):[];w.length?u||(u=!0,o.call(this,new ci(d,this,v.originalEvent,{features:w}))):u=!1},mouseout:()=>{u=!1}}}}if(d==="mouseleave"||d==="mouseout"){let u=!1;return{layer:n,listener:o,delegates:{mousemove:w=>{(this.getLayer(n)?this.queryRenderedFeatures(w.point,{layers:[n]}):[]).length?u=!0:u&&(u=!1,o.call(this,new ci(d,this,w.originalEvent)))},mouseout:w=>{u&&(u=!1,o.call(this,new ci(d,this,w.originalEvent)))}}}}{const u=p=>{const v=this.getLayer(n)?this.queryRenderedFeatures(p.point,{layers:[n]}):[];v.length&&(p.features=v,o.call(this,p),delete p.features)};return{layer:n,listener:o,delegates:{[d]:u}}}}on(d,n,o){if(o===void 0)return super.on(d,n);const u=this._createDelegatedListener(d,n,o);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[d]=this._delegatedListeners[d]||[],this._delegatedListeners[d].push(u);for(const p in u.delegates)this.on(p,u.delegates[p]);return this}once(d,n,o){if(o===void 0)return super.once(d,n);const u=this._createDelegatedListener(d,n,o);for(const p in u.delegates)this.once(p,u.delegates[p]);return this}off(d,n,o){return o===void 0?super.off(d,n):(this._delegatedListeners&&this._delegatedListeners[d]&&(u=>{const p=this._delegatedListeners[d];for(let v=0;v<p.length;v++){const w=p[v];if(w.layer===n&&w.listener===o){for(const E in w.delegates)this.off(E,w.delegates[E]);return p.splice(v,1),this}}})(),this)}queryRenderedFeatures(d,n){if(!this.style)return[];let o;const u=d instanceof a.Point||Array.isArray(d),p=u?d:[[0,0],[this.transform.width,this.transform.height]];if(n=n||(u?{}:d)||{},p instanceof a.Point||typeof p[0]=="number")o=[a.Point.convert(p)];else{const v=a.Point.convert(p[0]),w=a.Point.convert(p[1]);o=[v,new a.Point(w.x,v.y),w,new a.Point(v.x,w.y),v]}return this.style.queryRenderedFeatures(o,n,this.transform)}querySourceFeatures(d,n){return this.style.querySourceFeatures(d,n)}setStyle(d,n){return(n=a.extend({},{localIdeographFontFamily:this._localIdeographFontFamily,validate:this._validateStyle},n)).diff!==!1&&n.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&d?(this._diffStyle(d,n),this):(this._localIdeographFontFamily=n.localIdeographFontFamily,this._updateStyle(d,n))}setTransformRequest(d){return this._requestManager.setTransformRequest(d),this}_getUIString(d){const n=this._locale[d];if(n==null)throw new Error(`Missing UI string '${d}'`);return n}_updateStyle(d,n){if(n.transformStyle&&this.style&&!this.style._loaded)return void this.style.once("style.load",()=>this._updateStyle(d,n));const o=this.style&&n.transformStyle?this.style.serialize():void 0;return this.style&&(this.style.setEventedParent(null),this.style._remove(!d)),d?(this.style=new Ai(this,n||{}),this.style.setEventedParent(this,{style:this.style}),typeof d=="string"?this.style.loadURL(d,n,o):this.style.loadJSON(d,n,o),this):(delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new Ai(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(d,n){if(typeof d=="string"){const o=this._requestManager.transformRequest(d,ye.Style);a.getJSON(o,(u,p)=>{u?this.fire(new a.ErrorEvent(u)):p&&this._updateDiff(p,n)})}else typeof d=="object"&&this._updateDiff(d,n)}_updateDiff(d,n){try{this.style.setState(d,n)&&this._update(!0)}catch(o){a.warnOnce(`Unable to perform style diff: ${o.message||o.error||o}.  Rebuilding the style from scratch.`),this._updateStyle(d,n)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():a.warnOnce("There is no style added to the map.")}addSource(d,n){return this._lazyInitEmptyStyle(),this.style.addSource(d,n),this._update(!0)}isSourceLoaded(d){const n=this.style&&this.style.sourceCaches[d];if(n!==void 0)return n.loaded();this.fire(new a.ErrorEvent(new Error(`There is no source with ID '${d}'`)))}setTerrain(d){if(this.style._checkLoaded(),this._terrainDataCallback&&this.style.off("data",this._terrainDataCallback),d){const n=this.style.sourceCaches[d.source];if(!n)throw new Error(`cannot load terrain, because there exists no source with ID: ${d.source}`);for(const o in this.style._layers){const u=this.style._layers[o];u.type==="hillshade"&&u.source===d.source&&a.warnOnce("You are using the same source for a hillshade layer and for 3D terrain. Please consider using two separate sources to improve rendering quality.")}this.terrain=new Hr(this.painter,n,d),this.painter.renderToTexture=new Yn(this.painter,this.terrain),this.transform.updateElevation(this.terrain),this._terrainDataCallback=o=>{o.dataType==="style"?this.terrain.sourceCache.freeRtt():o.dataType==="source"&&o.tile&&(o.sourceId===d.source&&this.transform.updateElevation(this.terrain),this.terrain.sourceCache.freeRtt(o.tile.tileID))},this.style.on("data",this._terrainDataCallback)}else this.terrain&&this.terrain.sourceCache.destruct(),this.terrain=null,this.painter.renderToTexture&&this.painter.renderToTexture.destruct(),this.painter.renderToTexture=null,this.transform.updateElevation(this.terrain);return this.fire(new a.Event("terrain",{terrain:d})),this}getTerrain(){return this.terrain&&this.terrain.options}areTilesLoaded(){const d=this.style&&this.style.sourceCaches;for(const n in d){const o=d[n]._tiles;for(const u in o){const p=o[u];if(p.state!=="loaded"&&p.state!=="errored")return!1}}return!0}addSourceType(d,n,o){return this._lazyInitEmptyStyle(),this.style.addSourceType(d,n,o)}removeSource(d){return this.style.removeSource(d),this._update(!0)}getSource(d){return this.style.getSource(d)}addImage(d,n,{pixelRatio:o=1,sdf:u=!1,stretchX:p,stretchY:v,content:w}={}){if(this._lazyInitEmptyStyle(),n instanceof HTMLImageElement||a.isImageBitmap(n)){const{width:E,height:C,data:A}=a.exported.getImageData(n);this.style.addImage(d,{data:new a.RGBAImage({width:E,height:C},A),pixelRatio:o,stretchX:p,stretchY:v,content:w,sdf:u,version:0})}else{if(n.width===void 0||n.height===void 0)return this.fire(new a.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:E,height:C,data:A}=n,L=n;this.style.addImage(d,{data:new a.RGBAImage({width:E,height:C},new Uint8Array(A)),pixelRatio:o,stretchX:p,stretchY:v,content:w,sdf:u,version:0,userImage:L}),L.onAdd&&L.onAdd(this,d)}}}updateImage(d,n){const o=this.style.getImage(d);if(!o)return this.fire(new a.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const u=n instanceof HTMLImageElement||a.isImageBitmap(n)?a.exported.getImageData(n):n,{width:p,height:v,data:w}=u;if(p===void 0||v===void 0)return this.fire(new a.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(p!==o.data.width||v!==o.data.height)return this.fire(new a.ErrorEvent(new Error("The width and height of the updated image must be that same as the previous version of the image")));const E=!(n instanceof HTMLImageElement||a.isImageBitmap(n));o.data.replace(w,E),this.style.updateImage(d,o)}getImage(d){return this.style.getImage(d)}hasImage(d){return d?!!this.style.getImage(d):(this.fire(new a.ErrorEvent(new Error("Missing required image id"))),!1)}removeImage(d){this.style.removeImage(d)}loadImage(d,n){Ee.getImage(this._requestManager.transformRequest(d,ye.Image),n)}listImages(){return this.style.listImages()}addLayer(d,n){return this._lazyInitEmptyStyle(),this.style.addLayer(d,n),this._update(!0)}moveLayer(d,n){return this.style.moveLayer(d,n),this._update(!0)}removeLayer(d){return this.style.removeLayer(d),this._update(!0)}getLayer(d){return this.style.getLayer(d)}setLayerZoomRange(d,n,o){return this.style.setLayerZoomRange(d,n,o),this._update(!0)}setFilter(d,n,o={}){return this.style.setFilter(d,n,o),this._update(!0)}getFilter(d){return this.style.getFilter(d)}setPaintProperty(d,n,o,u={}){return this.style.setPaintProperty(d,n,o,u),this._update(!0)}getPaintProperty(d,n){return this.style.getPaintProperty(d,n)}setLayoutProperty(d,n,o,u={}){return this.style.setLayoutProperty(d,n,o,u),this._update(!0)}getLayoutProperty(d,n){return this.style.getLayoutProperty(d,n)}setGlyphs(d,n={}){return this._lazyInitEmptyStyle(),this.style.setGlyphs(d,n),this._update(!0)}getGlyphs(){return this.style.getGlyphsUrl()}addSprite(d,n,o={}){return this._lazyInitEmptyStyle(),this.style.addSprite(d,n,o,u=>{u||this._update(!0)}),this}removeSprite(d){return this._lazyInitEmptyStyle(),this.style.removeSprite(d),this._update(!0)}getSprite(){return this.style.getSprite()}setSprite(d,n={}){return this._lazyInitEmptyStyle(),this.style.setSprite(d,n,o=>{o||this._update(!0)}),this}setLight(d,n={}){return this._lazyInitEmptyStyle(),this.style.setLight(d,n),this._update(!0)}getLight(){return this.style.getLight()}setFeatureState(d,n){return this.style.setFeatureState(d,n),this._update()}removeFeatureState(d,n){return this.style.removeFeatureState(d,n),this._update()}getFeatureState(d){return this.style.getFeatureState(d)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let d=0,n=0;return this._container&&(d=this._container.clientWidth||400,n=this._container.clientHeight||300),[d,n]}_setupContainer(){const d=this._container;d.classList.add("maplibregl-map");const n=this._canvasContainer=T.create("div","maplibregl-canvas-container",d);this._interactive&&n.classList.add("maplibregl-interactive"),this._canvas=T.create("canvas","maplibregl-canvas",n),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map"),this._canvas.setAttribute("role","region");const o=this._containerDimensions();this._resizeCanvas(o[0],o[1],this.getPixelRatio());const u=this._controlContainer=T.create("div","maplibregl-control-container",d),p=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(v=>{p[v]=T.create("div",`maplibregl-ctrl-${v} `,u)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_cooperativeGesturesOnWheel(d){this._onCooperativeGesture(d,d[this._metaKey],1)}_setupCooperativeGestures(){this._cooperativeGesturesScreen=T.create("div","maplibregl-cooperative-gesture-screen",this._container);let d=typeof this._cooperativeGestures!="boolean"&&this._cooperativeGestures.windowsHelpText?this._cooperativeGestures.windowsHelpText:"Use Ctrl + scroll to zoom the map";navigator.platform.indexOf("Mac")===0&&(d=typeof this._cooperativeGestures!="boolean"&&this._cooperativeGestures.macHelpText?this._cooperativeGestures.macHelpText:"Use ⌘ + scroll to zoom the map"),this._cooperativeGesturesScreen.innerHTML=`
            <div class="maplibregl-desktop-message">${d}</div>
            <div class="maplibregl-mobile-message">${typeof this._cooperativeGestures!="boolean"&&this._cooperativeGestures.mobileHelpText?this._cooperativeGestures.mobileHelpText:"Use two fingers to move the map"}</div>
        `,this._canvasContainer.addEventListener("wheel",this._cooperativeGesturesOnWheel,!1),this._canvasContainer.classList.add("maplibregl-cooperative-gestures")}_destroyCooperativeGestures(){T.remove(this._cooperativeGesturesScreen),this._canvasContainer.removeEventListener("wheel",this._cooperativeGesturesOnWheel,!1),this._canvasContainer.classList.remove("maplibregl-cooperative-gestures")}_resizeCanvas(d,n,o){this._canvas.width=o*d,this._canvas.height=o*n,this._canvas.style.width=`${d}px`,this._canvas.style.height=`${n}px`}_setupPainter(){const d={alpha:!0,stencil:!0,depth:!0,failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1};let n=null;this._canvas.addEventListener("webglcontextcreationerror",u=>{n={requestedAttributes:d},u&&(n.statusMessage=u.statusMessage,n.type=u.type)},{once:!0});const o=this._canvas.getContext("webgl2",d)||this._canvas.getContext("webgl",d);if(!o){const u="Failed to initialize WebGL";throw n?(n.message=u,new Error(JSON.stringify(n))):new Error(u)}this.painter=new lh(o,this.transform),M.testSupport(o)}_contextLost(d){d.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new a.Event("webglcontextlost",{originalEvent:d}))}_contextRestored(d){this._setupPainter(),this.resize(),this._update(),this.fire(new a.Event("webglcontextrestored",{originalEvent:d}))}_onMapScroll(d){if(d.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}_onCooperativeGesture(d,n,o){return!n&&o<2&&(this._cooperativeGesturesScreen.classList.add("maplibregl-show"),setTimeout(()=>{this._cooperativeGesturesScreen.classList.remove("maplibregl-show")},100)),!1}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(d){return this.style&&this.style._loaded?(this._styleDirty=this._styleDirty||d,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(d){return this._update(),this._renderTaskQueue.add(d)}_cancelRenderFrame(d){this._renderTaskQueue.remove(d)}_render(d){const n=this._idleTriggered?this._fadeDuration:0;if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(d),this._removed)return;let o=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;const p=this.transform.zoom,v=a.exported.now();this.style.zoomHistory.update(p,v);const w=new a.EvaluationParameters(p,{now:v,fadeDuration:n,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),E=w.crossFadingFactor();E===1&&E===this._crossFadingFactor||(o=!0,this._crossFadingFactor=E),this.style.update(w)}this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.terrain&&this.terrain.sourceCache.update(this.transform,this.terrain),this.transform.updateElevation(this.terrain),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,n,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:n,showPadding:this.showPadding}),this.fire(new a.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,a.PerformanceUtils.mark(a.PerformanceMarkers.load),this.fire(new a.Event("load"))),this.style&&(this.style.hasTransitions()||o)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles();const u=this._sourcesDirty||this._styleDirty||this._placementDirty;return u||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new a.Event("idle")),!this._loaded||this._fullyLoaded||u||(this._fullyLoaded=!0,a.PerformanceUtils.mark(a.PerformanceMarkers.fullLoad)),this}redraw(){return this.style&&(this._frame&&(this._frame.cancel(),this._frame=null),this._render(0)),this}remove(){var d;this._hash&&this._hash.remove();for(const o of this._controls)o.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof window<"u"&&removeEventListener("online",this._onWindowOnline,!1),Ee.removeThrottleControl(this._imageQueueHandle),(d=this._resizeObserver)===null||d===void 0||d.disconnect();const n=this.painter.context.gl.getExtension("WEBGL_lose_context");n&&n.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),T.remove(this._canvasContainer),T.remove(this._controlContainer),this._cooperativeGestures&&this._destroyCooperativeGestures(),this._container.classList.remove("maplibregl-map"),a.PerformanceUtils.clearMetrics(),this._removed=!0,this.fire(new a.Event("remove"))}triggerRepaint(){this.style&&!this._frame&&(this._frame=a.exported.frame(d=>{a.PerformanceUtils.frame(d),this._frame=null,this._render(d)}))}_onWindowOnline(){this._update()}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(d){this._showTileBoundaries!==d&&(this._showTileBoundaries=d,this._update())}get showPadding(){return!!this._showPadding}set showPadding(d){this._showPadding!==d&&(this._showPadding=d,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(d){this._showCollisionBoxes!==d&&(this._showCollisionBoxes=d,d?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(d){this._showOverdrawInspector!==d&&(this._showOverdrawInspector=d,this._update())}get repaint(){return!!this._repaint}set repaint(d){this._repaint!==d&&(this._repaint=d,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(d){this._vertices=d,this._update()}get version(){return ui}getCameraTargetElevation(){return this.transform.elevation}},NavigationControl:class{constructor(d){this.options=a.extend({},il,d),this._container=T.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._container.addEventListener("contextmenu",n=>n.preventDefault()),this.options.showZoom&&(a.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in",n=>this._map.zoomIn({},{originalEvent:n})),T.create("span","maplibregl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out",n=>this._map.zoomOut({},{originalEvent:n})),T.create("span","maplibregl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(a.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("maplibregl-ctrl-compass",n=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:n}):this._map.resetNorth({},{originalEvent:n})}),this._compassIcon=T.create("span","maplibregl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){const d=this._map.getZoom(),n=d===this._map.getMaxZoom(),o=d===this._map.getMinZoom();this._zoomInButton.disabled=n,this._zoomOutButton.disabled=o,this._zoomInButton.setAttribute("aria-disabled",n.toString()),this._zoomOutButton.setAttribute("aria-disabled",o.toString())}_rotateCompassArrow(){const d=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${this._map.transform.angle*(180/Math.PI)}deg)`:`rotate(${this._map.transform.angle*(180/Math.PI)}deg)`;this._compassIcon.style.transform=d}onAdd(d){return this._map=d,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new kc(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){T.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(d,n){const o=T.create("button",d,this._container);return o.type="button",o.addEventListener("click",n),o}_setButtonTitle(d,n){const o=this._map._getUIString(`NavigationControl.${n}`);d.title=o,d.setAttribute("aria-label",o)}},GeolocateControl:class extends a.Evented{constructor(d){super(),this.options=a.extend({},Mc,d),a.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker"],this)}onAdd(d){return this._map=d,this._container=T.create("div","maplibregl-ctrl maplibregl-ctrl-group"),function(n,o=!1){Xr===void 0||o?window.navigator.permissions!==void 0?window.navigator.permissions.query({name:"geolocation"}).then(u=>{Xr=u.state!=="denied",n(Xr)}).catch(()=>{Xr=!!window.navigator.geolocation,n(Xr)}):(Xr=!!window.navigator.geolocation,n(Xr)):n(Xr)}(this._setupUI),this._container}onRemove(){this._geolocationWatchID!==void 0&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),T.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,xo=0,qs=!1}_isOutOfMapMaxBounds(d){const n=this._map.getMaxBounds(),o=d.coords;return n&&(o.longitude<n.getWest()||o.longitude>n.getEast()||o.latitude<n.getSouth()||o.latitude>n.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_onSuccess(d){if(this._map){if(this._isOutOfMapMaxBounds(d))return this._setErrorState(),this.fire(new a.Event("outofmaxbounds",d)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=d,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(d),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(d),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale"),this.fire(new a.Event("geolocate",d)),this._finish()}}_updateCamera(d){const n=new a.LngLat(d.coords.longitude,d.coords.latitude),o=d.coords.accuracy,u=this._map.getBearing(),p=a.extend({bearing:u},this.options.fitBoundsOptions),v=Rt.fromLngLat(n,o);this._map.fitBounds(v,p,{geolocateSource:!0})}_updateMarker(d){if(d){const n=new a.LngLat(d.coords.longitude,d.coords.latitude);this._accuracyCircleMarker.setLngLat(n).addTo(this._map),this._userLocationDotMarker.setLngLat(n).addTo(this._map),this._accuracy=d.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const d=this._map.getBounds(),n=d.getSouthEast(),o=d.getNorthEast(),u=n.distanceTo(o),p=Math.ceil(this._accuracy/(u/this._map._container.clientHeight)*2);this._circleElement.style.width=`${p}px`,this._circleElement.style.height=`${p}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_onError(d){if(this._map){if(this.options.trackUserLocation)if(d.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const n=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=n,this._geolocateButton.setAttribute("aria-label",n),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(d.code===3&&qs)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale"),this.fire(new a.Event("error",d)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(d){if(this._map){if(this._container.addEventListener("contextmenu",n=>n.preventDefault()),this._geolocateButton=T.create("button","maplibregl-ctrl-geolocate",this._container),T.create("span","maplibregl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",d===!1){a.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");const n=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=n,this._geolocateButton.setAttribute("aria-label",n)}else{const n=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=n,this._geolocateButton.setAttribute("aria-label",n)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=T.create("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new ra(this._dotElement),this._circleElement=T.create("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new ra({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",n=>{n.geolocateSource||this._watchState!=="ACTIVE_LOCK"||n.originalEvent&&n.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new a.Event("trackuserlocationend")))})}}trigger(){if(!this._setup)return a.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new a.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":xo--,qs=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this.fire(new a.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new a.Event("trackuserlocationstart"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let d;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),xo++,xo>1?(d={maximumAge:6e5,timeout:0},qs=!0):(d=this.options.positionOptions,qs=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,d)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:qt,LogoControl:ia,ScaleControl:class{constructor(d){this.options=a.extend({},Dc,d),a.bindAll(["_onMove","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_onMove(){ol(this._map,this._container,this.options)}onAdd(d){return this._map=d,this._container=T.create("div","maplibregl-ctrl maplibregl-ctrl-scale",d.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){T.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}setUnit(d){this.options.unit=d,ol(this._map,this._container,this.options)}},FullscreenControl:class extends a.Evented{constructor(d={}){super(),this._onFullscreenChange=()=>{(window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement)===this._container!==this._fullscreen&&this._handleFullscreenChange()},this._onClickFullscreen=()=>{this._isFullscreen()?this._exitFullscreen():this._requestFullscreen()},this._fullscreen=!1,d&&d.container&&(d.container instanceof HTMLElement?this._container=d.container:a.warnOnce("Full screen control 'container' must be a DOM element.")),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(d){return this._map=d,this._container||(this._container=this._map.getContainer()),this._controlContainer=T.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),this._controlContainer}onRemove(){T.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._onFullscreenChange)}_setupUI(){const d=this._fullscreenButton=T.create("button","maplibregl-ctrl-fullscreen",this._controlContainer);T.create("span","maplibregl-ctrl-icon",d).setAttribute("aria-hidden","true"),d.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._onFullscreenChange)}_updateTitle(){const d=this._getTitle();this._fullscreenButton.setAttribute("aria-label",d),this._fullscreenButton.title=d}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_handleFullscreenChange(){this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._updateTitle(),this._fullscreen?(this.fire(new a.Event("fullscreenstart")),this._map._cooperativeGestures&&(this._prevCooperativeGestures=this._map._cooperativeGestures,this._map.setCooperativeGestures())):(this.fire(new a.Event("fullscreenend")),this._prevCooperativeGestures&&(this._map.setCooperativeGestures(this._prevCooperativeGestures),delete this._prevCooperativeGestures))}_exitFullscreen(){window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen?window.document.webkitCancelFullScreen():this._togglePseudoFullScreen()}_requestFullscreen(){this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen?this._container.webkitRequestFullscreen():this._togglePseudoFullScreen()}_togglePseudoFullScreen(){this._container.classList.toggle("maplibregl-pseudo-fullscreen"),this._handleFullscreenChange(),this._map.resize()}},TerrainControl:class{constructor(d){this.options=d,a.bindAll(["_toggleTerrain","_updateTerrainIcon"],this)}onAdd(d){return this._map=d,this._container=T.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=T.create("button","maplibregl-ctrl-terrain",this._container),T.create("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){T.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}_toggleTerrain(){this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()}_updateTerrainIcon(){this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.disableTerrain")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.enableTerrain"))}},Popup:class extends a.Evented{constructor(d){super(),this.options=a.extend(Object.create(al),d),a.bindAll(["_update","_onClose","remove","_onMouseMove","_onMouseUp","_onDrag"],this)}addTo(d){return this._map&&this.remove(),this._map=d,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")):this._map.on("move",this._update),this.fire(new a.Event("open")),this}isOpen(){return!!this._map}remove(){return this._content&&T.remove(this._content),this._container&&(T.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),delete this._map),this.fire(new a.Event("close")),this}getLngLat(){return this._lngLat}setLngLat(d){return this._lngLat=a.LngLat.convert(d),this._pos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")),this}getElement(){return this._container}setText(d){return this.setDOMContent(document.createTextNode(d))}setHTML(d){const n=document.createDocumentFragment(),o=document.createElement("body");let u;for(o.innerHTML=d;u=o.firstChild,u;)n.appendChild(u);return this.setDOMContent(n)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(d){return this.options.maxWidth=d,this._update(),this}setDOMContent(d){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=T.create("div","maplibregl-popup-content",this._container);return this._content.appendChild(d),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(d){this._container&&this._container.classList.add(d)}removeClassName(d){this._container&&this._container.classList.remove(d)}setOffset(d){return this.options.offset=d,this._update(),this}toggleClassName(d){if(this._container)return this._container.classList.toggle(d)}_createCloseButton(){this.options.closeButton&&(this._closeButton=T.create("button","maplibregl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_onMouseUp(d){this._update(d.point)}_onMouseMove(d){this._update(d.point)}_onDrag(d){this._update(d.point)}_update(d){if(!this._map||!this._lngLat&&!this._trackPointer||!this._content||(this._container||(this._container=T.create("div","maplibregl-popup",this._map.getContainer()),this._tip=T.create("div","maplibregl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className&&this.options.className.split(" ").forEach(v=>this._container.classList.add(v)),this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer")),this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=rl(this._lngLat,this._pos,this._map.transform)),this._trackPointer&&!d))return;const n=this._pos=this._trackPointer&&d?d:this._map.project(this._lngLat);let o=this.options.anchor;const u=ll(this.options.offset);if(!o){const v=this._container.offsetWidth,w=this._container.offsetHeight;let E;E=n.y+u.bottom.y<w?["top"]:n.y>this._map.transform.height-w?["bottom"]:[],n.x<v/2?E.push("left"):n.x>this._map.transform.width-v/2&&E.push("right"),o=E.length===0?"bottom":E.join("-")}const p=n.add(u[o]).round();T.setTransform(this._container,`${js[o]} translate(${p.x}px,${p.y}px)`),sl(this._container,o,"popup")}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const d=this._container.querySelector(zc);d&&d.focus()}_onClose(){this.remove()}},Marker:ra,Style:Ai,LngLat:a.LngLat,LngLatBounds:Rt,Point:a.Point,MercatorCoordinate:a.MercatorCoordinate,Evented:a.Evented,AJAXError:a.AJAXError,config:a.config,CanvasSource:Z,GeoJSONSource:He,ImageSource:K,RasterDEMTileSource:Le,RasterTileSource:tt,VectorTileSource:Ae,VideoSource:ne,prewarm:function(){hn().acquire(xt)},clearPrewarmedResources:function(){const d=Wt;d&&(d.isPreloaded()&&d.numActive()===1?(d.release(xt),Wt=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get version(){return cl},get workerCount(){return $e.workerCount},set workerCount(d){$e.workerCount=d},get maxParallelImageRequests(){return a.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(d){a.config.MAX_PARALLEL_IMAGE_REQUESTS=d},get workerUrl(){return a.config.WORKER_URL},set workerUrl(d){a.config.WORKER_URL=d},addProtocol(d,n){a.config.REGISTERED_PROTOCOLS[d]=n},removeProtocol(d){delete a.config.REGISTERED_PROTOCOLS[d]}};return nl.extend(ul,{isSafari:a.isSafari,getPerformanceMetrics:a.PerformanceUtils.getPerformanceMetrics}),ul});var x=m;return x})})(A0);var dT=A0.exports;const au=hT(dT);class _v{static getGeoJSON(){const s=[];return Array.prototype.forEach.call(Ei().filteredAssociationsWithoutMapFilter,l=>{s.push({id:l.id,properties:{id:l.id,name:l.name,country:l.country},geometry:{type:"Point",coordinates:[l.coords.y,l.coords.x]}})}),{type:"FeatureCollection",features:s}}static getBounds(s){const l=s.map(h=>h.geometry.coordinates);return l.reduce((h,m)=>h.extend(m),new au.LngLatBounds(l[0],l[0]))}}class fT{constructor(){Wn(this,"_map");Wn(this,"_container")}onAdd(s){this._map=s,this._container=document.createElement("div"),this._container.className="maplibregl-ctrl maplibregl-ctrl-group";const l=document.createElement("button");l.className="maplibregl-ctrl-zoom-extent";const h=document.createElement("span");return h.className="maplibregl-ctrl-icon",l.appendChild(h),this._container.appendChild(l),this._container.addEventListener("click",()=>{oi().triggerZoomReset=!oi().triggerZoomReset}),this._container}onRemove(){this._container.parentNode.removeChild(this._container),this._map=void 0}}var pT=Object.defineProperty,mT=Object.getOwnPropertyDescriptor,$o=(e,s,l,h)=>{for(var m=h>1?void 0:h?mT(s,l):s,_=e.length-1,x;_>=0;_--)(x=e[_])&&(m=(h?x(s,l,m):x(m))||m);return h&&m&&pT(s,l,m),m};let Bs=class extends mr{constructor(){super(...arguments);Wn(this,"map",null);Wn(this,"geojsonData",null);Wn(this,"defaultZoomExtent",null);Wn(this,"layers",{ASSOC:"association",ASSOC_CLUSTER:"association-cluster",ASSOC_CLUSTER_COUNT:"association-cluster-count",ASSOC_CLUSTER_BG:"association-cluster-bg",UNCLUSTERED_POINT:"unclustered-point"})}async mounted(){this.map=new au.Map({container:"map",style:"https://api.maptiler.com/maps/dataviz/style.json?key=0tupl15DKhXOvwp27x8c",center:[0,0],zoom:1}),this.setMapPadding(),this.map.dragRotate.disable(),this.map.touchZoomRotate.disableRotation();var l=new au.NavigationControl({showCompass:!1});this.map.addControl(l,"top-right"),this.map.addControl(new fT);const h=document.querySelector("body");h!==null&&this.map.addControl(new au.FullscreenControl({container:h})),this.initMapSyncFilter()}get filterPin(){return["case",["in",["get","id"],["literal",[this.hoveredAssociationId,this.activeAssociationId].filter(l=>l)]],"marker-active","marker"]}updatePins(){this.map.getLayer(this.layers.UNCLUSTERED_POINT)!==void 0&&this.map.setLayoutProperty(this.layers.UNCLUSTERED_POINT,"icon-image",this.filterPin)}activeAssociationIdWatcher(){this.activeAssociation!==null&&this.zoomToAssociation(this.activeAssociation),this.updatePins()}hoveredAssociationIdWatcher(){this.updatePins()}infoPanelWatcher(){this.setMapPadding()}associationsWatcher(){this.updateOscMap()}zoomResetWatcher(){this.fitBounds(!0)}filteredAssociationsWithoutMapFilterWatcher(l,h){l!==h&&(jn().isMapSynced?this.setMapFilter():this.fitBounds())}filteredAssociationsWatcher(){this.addOscSource()}get isInfoPanelShown(){return oi().isInfoPanelShown}get associations(){return Ei().associations}get filteredAssociations(){return Ei().filteredAssociations}get filteredAssociationsWithoutMapFilter(){return Ei().filteredAssociationsWithoutMapFilter}get filteredAssociationsId(){return this.filteredAssociations.map(l=>l.id)}get activeAssociationId(){return Ei().activeAssociationId}get hoveredAssociationId(){return Ei().hoveredAssociationId}get activeAssociation(){return Ei().activeAssociation}get triggerZoomReset(){return oi().triggerZoomReset}get padding(){return{top:30,bottom:30,left:30,right:(this.isInfoPanelShown?360:0)+30}}get geojson(){return _v.getGeoJSON()}setMapPadding(){this.map.easeTo({padding:this.padding,duration:300})}async setMapFilter(){if(this.map.getLayer(this.layers.UNCLUSTERED_POINT)!==void 0){const l=this.map.queryRenderedFeatures({layers:[this.layers.UNCLUSTERED_POINT,this.layers.ASSOC_CLUSTER]}),h=this.map.getSource(this.layers.ASSOC);let m=[];await l.forEach(async _=>{const x=_.properties.cluster_id,a=_.properties.point_count;x!==void 0?await h.getClusterLeaves(x,a,0,(I,T)=>{if(T!==void 0){let M=T.map(k=>k.id);m.push(...M)}}):await m.push(_.id)}),setTimeout(()=>jn().mapShownAssociations=m,200)}}initMapSyncFilter(){this.map.on("moveend",async()=>{await this.setMapFilter()})}initMap(){this.updateOscMap()}updateOscMap(){this.addOscSource(),this.addOscLayer(),this.addClusterClickEvent(),this.addTooltipOnHover(),this.updateAssociationOnClick(),this.fitBounds()}addOscSource(){let l=this.geojson;this.map.getSource(this.layers.ASSOC)?this.map.getSource(this.layers.ASSOC).setData(this.geojson):this.map.addSource(this.layers.ASSOC,{type:"geojson",data:l,cluster:!0,clusterMaxZoom:11,clusterRadius:50,attribution:'Developped by <b><a href="https://cartong.org" target="_blank">CartONG</a></b>'})}addOscLayer(){this.map.getLayer(this.layers.ASSOC)===void 0&&(this.map.addLayer({id:this.layers.ASSOC_CLUSTER_BG,type:"circle",source:this.layers.ASSOC,filter:["has","point_count"],paint:{"circle-color":"#558B2F","circle-radius":40,"circle-opacity":.15}}),this.map.addLayer({id:this.layers.ASSOC_CLUSTER,type:"circle",source:this.layers.ASSOC,filter:["has","point_count"],paint:{"circle-color":"#558B2F","circle-radius":20}}),this.map.addLayer({id:this.layers.ASSOC_CLUSTER_COUNT,type:"symbol",source:this.layers.ASSOC,filter:["has","point_count"],layout:{"text-field":"{point_count_abbreviated}","text-size":12,"text-font":["Open Sans Bold","Arial Unicode MS Bold"]},paint:{"text-color":"#fff"}}),this.map.loadImage("./img/pins/pin_active.png",(l,h)=>{if(l)throw l;this.map.addImage("marker-active",h)}),this.map.loadImage("./img/pins/pin_orange.png",(l,h)=>{if(l)throw l;this.map.addImage("marker",h),this.map.addLayer({id:this.layers.UNCLUSTERED_POINT,type:"symbol",source:this.layers.ASSOC,filter:["!",["has","point_count"]],layout:{"icon-image":this.filterPin,"icon-allow-overlap":!0}})}))}updateAssociationOnClick(){this.map.on("click",this.layers.UNCLUSTERED_POINT,l=>{Ei().activeAssociationId=l.features[0].properties.id})}addClusterClickEvent(){this.map.on("click",this.layers.ASSOC_CLUSTER,l=>{const h=this.map.queryRenderedFeatures(l.point,{layers:[this.layers.ASSOC_CLUSTER]}),m=h[0].properties.cluster_id;this.map.getSource(this.layers.ASSOC).getClusterExpansionZoom(m,(_,x)=>{_||this.map.easeTo({center:h[0].geometry.coordinates,zoom:x})})}),this.map.on("mouseenter",this.layers.ASSOC_CLUSTER,l=>{this.map.getCanvas().style.cursor="pointer"}),this.map.on("mouseleave",this.layers.ASSOC_CLUSTER,()=>{this.map.getCanvas().style.cursor=""})}zoomToAssociation(l){const h=this.map.getZoom(),m=12;this.map.flyTo({center:[l.coords.y,l.coords.x],zoom:h<m?m:h,padding:this.padding,bearing:0,speed:3,curve:1,easing:function(_){return _},essential:!0})}addTooltipOnHover(){const l=new au.Popup({closeButton:!1,closeOnClick:!1});this.map.on("mouseenter",this.layers.UNCLUSTERED_POINT,h=>{this.map.getCanvas().style.cursor="pointer";for(var m=h.features[0].geometry.coordinates.slice(),_=h.features[0].properties.name;Math.abs(h.lngLat.lng-m[0])>180;)m[0]+=h.lngLat.lng>m[0]?360:-360;const x=`<h3>${_}</h3><span>Cliquez pour plus d'informations</span>`;l.setLngLat(m).setHTML(x).addTo(this.map),l.addClassName("show"),Ei().hoveredAssociationId=h.features[0].properties.id}),this.map.on("mouseleave",this.layers.UNCLUSTERED_POINT,()=>{this.map.getCanvas().style.cursor="",l.removeClassName("show"),Ei().hoveredAssociationId=null})}fitBounds(l=!1){let h=this.geojson.features;if(h.length){const m=_v.getBounds(h);this.defaultZoomExtent===null&&(this.defaultZoomExtent=m),this.map.fitBounds(l?this.defaultZoomExtent:m,{padding:30})}}};$o([xs("activeAssociationId")],Bs.prototype,"activeAssociationIdWatcher",1);$o([xs("hoveredAssociationId")],Bs.prototype,"hoveredAssociationIdWatcher",1);$o([xs("isInfoPanelShown")],Bs.prototype,"infoPanelWatcher",1);$o([xs("associations")],Bs.prototype,"associationsWatcher",1);$o([xs("triggerZoomReset")],Bs.prototype,"zoomResetWatcher",1);$o([xs("filteredAssociationsWithoutMapFilter")],Bs.prototype,"filteredAssociationsWithoutMapFilterWatcher",1);$o([xs("filteredAssociations",{deep:!0})],Bs.prototype,"filteredAssociationsWatcher",1);Bs=$o([pr({})],Bs);const gr=(e,s)=>{const l=e.__vccOpts||e;for(const[h,m]of s)l[h]=m;return l},gT={id:"map"};function yT(e,s,l,h,m,_){return an(),fn("div",gT)}const _T=gr(Bs,[["render",yT]]);var vT=Object.defineProperty,xT=Object.getOwnPropertyDescriptor,Ea=(e,s,l,h)=>{for(var m=h>1?void 0:h?xT(s,l):s,_=e.length-1,x;_>=0;_--)(x=e[_])&&(m=(h?x(s,l,m):x(m))||m);return h&&m&&vT(s,l,m),m};let no=class extends mr{constructor(){super(...arguments);Wn(this,"label");Wn(this,"fill");Wn(this,"toggled");Wn(this,"uppercase");Wn(this,"small");Wn(this,"icon")}get iconUrl(){return"./img/icons/"+this.icon+".svg"}};Ea([Pr({default:"Button label"})],no.prototype,"label",2);Ea([Pr({default:!1})],no.prototype,"fill",2);Ea([Pr({default:null})],no.prototype,"toggled",2);Ea([Pr({default:!1})],no.prototype,"uppercase",2);Ea([Pr({default:!1})],no.prototype,"small",2);Ea([Pr({default:null})],no.prototype,"icon",2);no=Ea([pr({})],no);const bT=["uppercase","fill","small","toggled"],wT=["src","alt"];function ST(e,s,l,h,m,_){return an(),fn("button",{class:"Button",uppercase:e.uppercase,fill:e.fill,small:e.small,toggled:e.toggled},[e.icon!==null?(an(),fn("img",{key:0,src:e.iconUrl,alt:e.icon},null,8,wT)):Zi("",!0),jt("span",null,Pi(e.label),1)],8,bT)}const Vu=gr(no,[["render",ST]]);var CT=Object.defineProperty,ET=Object.getOwnPropertyDescriptor,k0=(e,s,l,h)=>{for(var m=h>1?void 0:h?ET(s,l):s,_=e.length-1,x;_>=0;_--)(x=e[_])&&(m=(h?x(s,l,m):x(m))||m);return h&&m&&CT(s,l,m),m};let bd=class extends mr{constructor(){super(...arguments);Wn(this,"label");Wn(this,"copying",!1)}get iconUrl(){return"./img/icons/"+(this.copying?"done":"mdi-content-copy")+".svg"}copyToClipboard(){const l=this;function h(m){l.copying=!0,setTimeout(()=>l.copying=!1,1500),m.clipboardData.setData("text/html",l.label),m.clipboardData.setData("text/plain",l.label),m.preventDefault()}document.addEventListener("copy",h),document.execCommand("copy"),document.removeEventListener("copy",h)}};k0([Pr({default:""})],bd.prototype,"label",2);bd=k0([pr({})],bd);const TT={class:"CopyToClipboard"},IT=["src"];function AT(e,s,l,h,m,_){return an(),fn("div",TT,[jt("span",null,Pi(e.label),1),jt("img",{src:e.iconUrl,alt:"Copier",onClick:s[0]||(s[0]=(...x)=>e.copyToClipboard&&e.copyToClipboard(...x))},null,8,IT)])}const PT=gr(bd,[["render",AT]]);var kT=Object.defineProperty,MT=Object.getOwnPropertyDescriptor,M0=(e,s,l,h)=>{for(var m=h>1?void 0:h?MT(s,l):s,_=e.length-1,x;_>=0;_--)(x=e[_])&&(m=(h?x(s,l,m):x(m))||m);return h&&m&&kT(s,l,m),m};let wd=class extends mr{associationWatcher(){this.association!==null&&(oi().isInfoPanelShown=!0)}get isInfoPanelShown(){return oi().isInfoPanelShown}get association(){return Ei().activeAssociation}getIconUrl(s){return"./img/icons/"+s+".svg"}getThematic(s){return jn().getThematicName(s)}closeInfoPanel(){oi().isInfoPanelShown=!1,setTimeout(()=>Ei().activeAssociationId=null,300)}};M0([xs("association")],wd.prototype,"associationWatcher",1);wd=M0([pr({components:{CopyToClipboard:PT}})],wd);const DT=["shown"],zT=["src"],LT={class:"InfoPanel__head"},RT=["href"],BT=["src"],FT={key:0,class:"InfoPanel__email"},OT={key:0,class:"InfoPanel__otherEmailCtn"},VT={class:"InfoPanel__otherEmail"},$T={class:"InfoPanel__scrollableCtn"},UT={class:"InfoPanel__statusCtn"},NT={key:0},jT={class:"InfoPanel__statusRow"},qT={key:0,class:"InfoPanel__creationDate"},ZT={key:1,class:"InfoPanel__cost"},GT=["src"],WT=jt("span",{class:"InfoPanel__costTooltip"},"Budget moyen (fonctionnement et activités) au cours des 10 dernières années",-1),HT=jt("div",{class:"InfoPanel__divider"},null,-1),XT={class:"InfoPanel__descCtn"},KT={key:0,class:"InfoPanel__descItem"},YT=jt("h2",null,"Territoires d’intervention",-1),JT={key:1,class:"InfoPanel__descItem"},QT=jt("h2",null,"Liens et dialogue avec des institutions",-1),eI={key:2,class:"InfoPanel__descItem"},tI=jt("h2",null,"Thématiques d’intervention",-1),nI=jt("div",{class:"InfoPanel__divider"},null,-1),iI={key:0,class:"InfoPanel__location"},rI=["src"],sI={key:1,class:"InfoPanel__updatedAt"};function oI(e,s,l,h,m,_){const x=Gi("CopyToClipboard");return e.association!=null?(an(),fn("div",{key:0,class:"InfoPanel",shown:e.isInfoPanelShown&&e.association!=null},[jt("img",{class:"InfoPanel__closeIcon",src:e.getIconUrl("mdi-window-close-white"),alt:"Fermer le panneau",onClick:s[0]||(s[0]=(...a)=>e.closeInfoPanel&&e.closeInfoPanel(...a))},null,8,zT),jt("div",LT,[jt("h1",null,Pi(e.association.name),1),e.association.websiteUrl?(an(),fn("a",{key:0,href:e.association.websiteUrl,target:"_blank"},[Su(Pi(e.association.websiteUrl)+" ",1),jt("img",{src:e.getIconUrl("mdi-open-in-new"),alt:"Nouvel onglet"},null,8,BT)],8,RT)):Zi("",!0)]),e.association.emails&&e.association.emails.length&&e.association.emails[0]!=""?(an(),fn("div",FT,[ae(x,{label:e.association.emails[0]},null,8,["label"]),e.association.emails.length>1?(an(),fn("div",OT,[(an(!0),fn(mn,null,Dl(e.association.emails.slice(1),a=>(an(),fn("span",VT,Pi(a),1))),256))])):Zi("",!0)])):Zi("",!0),jt("div",$T,[jt("div",UT,[e.association.status?(an(),fn("h2",NT,Pi(e.association.status),1)):Zi("",!0),jt("div",jT,[e.association.year?(an(),fn("span",qT,"Créée en "+Pi(e.association.year),1)):Zi("",!0),e.association.budget?(an(),fn("span",ZT,[Su(Pi(e.association.budget)+" ",1),jt("img",{src:e.getIconUrl("mdi-information-variant-circle-outline-white"),alt:"Localisation icon"},null,8,GT),WT])):Zi("",!0)])]),HT,jt("div",XT,[e.association.intervention?(an(),fn("div",KT,[YT,jt("span",null,Pi(e.association.intervention),1)])):Zi("",!0),e.association.dialog?(an(),fn("div",JT,[QT,jt("span",null,Pi(e.association.dialog),1)])):Zi("",!0),e.association.thematics.length?(an(),fn("div",eI,[tI,jt("ul",null,[(an(!0),fn(mn,null,Dl(e.association.thematics,(a,I)=>(an(),fn("li",{key:I},Pi(e.getThematic(a)),1))),128))])])):Zi("",!0)]),nI,e.association.adress?(an(),fn("div",iI,[jt("img",{src:e.getIconUrl("map-marker"),alt:"Localisation icon"},null,8,rI),jt("span",null,Pi(e.association.adress),1)])):Zi("",!0),e.association.updatedAt?(an(),fn("div",sI,"Mise à jour "+Pi(e.association.updatedAt),1)):Zi("",!0)])],8,DT)):Zi("",!0)}const aI=gr(wd,[["render",oI]]);var lI=Object.defineProperty,cI=Object.getOwnPropertyDescriptor,uI=(e,s,l,h)=>{for(var m=h>1?void 0:h?cI(s,l):s,_=e.length-1,x;_>=0;_--)(x=e[_])&&(m=(h?x(s,l,m):x(m))||m);return h&&m&&lI(s,l,m),m};let rm=class extends mr{openInfoPanel(){oi().isInfoPanelShown=!0}openRedirectionModal(){oi().isRedirectionModalShown=!0}get isInfoPanelShown(){return oi().isInfoPanelShown}};rm=uI([pr({components:{Map:_T,Button:Vu,InfoPanel:aI}})],rm);const hI=["info-panel-shown"];function dI(e,s,l,h,m,_){const x=Gi("InfoPanel"),a=Gi("Map"),I=Gi("Button");return an(),fn("div",{class:"OSCMap","info-panel-shown":e.isInfoPanelShown},[ae(x),ae(a),ae(I,{label:"Renseigner une association",class:"OSCMap__newAssocBtn",uppercase:!0,icon:"mdi-add",fill:!0,onClick:e.openRedirectionModal},null,8,["onClick"])],8,hI)}const fI=gr(rm,[["render",dI]]);var pI=Object.defineProperty,mI=Object.getOwnPropertyDescriptor,og=(e,s,l,h)=>{for(var m=h>1?void 0:h?mI(s,l):s,_=e.length-1,x;_>=0;_--)(x=e[_])&&(m=(h?x(s,l,m):x(m))||m);return h&&m&&pI(s,l,m),m};let Iu=class extends mr{constructor(){super(...arguments);Wn(this,"index");Wn(this,"association")}get activeAssociationId(){return Ei().activeAssociationId}get isActive(){return this.activeAssociationId===this.association.id}updateActiveAssociation(l){l===this.activeAssociationId?(oi().isInfoPanelShown=!1,setTimeout(()=>Ei().activeAssociationId=null,300)):Ei().activeAssociationId=l}updateHoveredAssociation(l){Ei().hoveredAssociationId=l}};og([Pr({default:0})],Iu.prototype,"index",2);og([Pr({default:{}})],Iu.prototype,"association",2);Iu=og([pr({})],Iu);const gI=["active"];function yI(e,s,l,h,m,_){return e.association!==void 0?(an(),fn("div",{key:0,class:"AssociationListItem",active:e.isActive,onClick:s[0]||(s[0]=x=>e.updateActiveAssociation(e.association.id)),onMouseover:s[1]||(s[1]=x=>e.updateHoveredAssociation(e.association.id)),onMouseleave:s[2]||(s[2]=x=>e.updateHoveredAssociation(null))},Pi(e.association.name),41,gI)):Zi("",!0)}const _I=gr(Iu,[["render",yI]]);var vI=Object.defineProperty,xI=Object.getOwnPropertyDescriptor,ag=(e,s,l,h)=>{for(var m=h>1?void 0:h?xI(s,l):s,_=e.length-1,x;_>=0;_--)(x=e[_])&&(m=(h?x(s,l,m):x(m))||m);return h&&m&&vI(s,l,m),m};let Au=class extends mr{constructor(){super(...arguments);Wn(this,"associationlist")}get associations(){return Ei().filteredAssociations}associationsWatcher(){this.associationlist&&(this.associationlist.scrollTop=0)}};ag([KE],Au.prototype,"associationlist",2);ag([xs("associations")],Au.prototype,"associationsWatcher",1);Au=ag([pr({components:{AssociationListItem:_I}})],Au);const bI={class:"AssociationList",ref:"associationlist"};function wI(e,s,l,h,m,_){const x=Gi("AssociationListItem");return an(),fn("div",bI,[(an(!0),fn(mn,null,Dl(e.associations,(a,I)=>(an(),jd(x,{association:a,key:I,index:I},null,8,["association","index"]))),128))],512)}const SI=gr(Au,[["render",wI]]);var CI=Object.defineProperty,EI=Object.getOwnPropertyDescriptor,D0=(e,s,l,h)=>{for(var m=h>1?void 0:h?EI(s,l):s,_=e.length-1,x;_>=0;_--)(x=e[_])&&(m=(h?x(s,l,m):x(m))||m);return h&&m&&CI(s,l,m),m};let Sd=class extends mr{constructor(){super(...arguments);Wn(this,"placeholder")}get filterStore(){return jn()}updateSearch(l){jn().search=l.target.value}};D0([Pr({default:"Rechercher une association"})],Sd.prototype,"placeholder",2);Sd=D0([pr({})],Sd);const TI=["placeholder"];function II(e,s,l,h,m,_){return Ur((an(),fn("input",{class:"InputSearch",type:"search",placeholder:e.placeholder,onKeyup:s[0]||(s[0]=(...x)=>e.updateSearch&&e.updateSearch(...x)),"onUpdate:modelValue":s[1]||(s[1]=x=>e.filterStore.search=x)},null,40,TI)),[[rC,e.filterStore.search]])}const AI=gr(Sd,[["render",II]]);var PI=Object.defineProperty,kI=Object.getOwnPropertyDescriptor,MI=(e,s,l,h)=>{for(var m=h>1?void 0:h?kI(s,l):s,_=e.length-1,x;_>=0;_--)(x=e[_])&&(m=(h?x(s,l,m):x(m))||m);return h&&m&&PI(s,l,m),m};let sm=class extends mr{get associations(){return Ei().associations}get filteredAssociations(){return Ei().filteredAssociations}get associationsCount(){return this.associations.length}get filteredAssociationsCount(){return this.filteredAssociations.length}get associationsCountLabel(){return this.filteredAssociationsCount+" association"+(this.filteredAssociationsCount>1?"s":"")+" sur "+this.associationsCount}get logoPath(){return"./img/logo-crpm.svg"}get isFiltersBarShown(){return oi().isFiltersBarShown}get isMapSynced(){return jn().isMapSynced}get filterStore(){return jn()}get toggleFiltersLabel(){return this.isFiltersBarShown?"Masquer":"Filtrer"}get toggleFiltersIcon(){return this.isFiltersBarShown?"mdi-window-close":"mdi-filter-variant"}toggleFiltersBar(){oi().isFiltersBarShown=!this.isFiltersBarShown}openAboutModal(){oi().isAboutModalShown=!0}};sm=MI([pr({components:{AssociationList:SI,Button:Vu,InputSearch:AI}})],sm);function lg(e){return Xm(()=>{const s=[],l={};return e.value.background&&(H_(e.value.background)?l.backgroundColor=e.value.background:s.push(`bg-${e.value.background}`)),e.value.text&&(H_(e.value.text)?(l.color=e.value.text,l.caretColor=e.value.text):s.push(`text-${e.value.text}`)),{colorClasses:s,colorStyles:l}})}function Fs(e,s){const l=we(()=>({text:qn(e)?e.value:s?e[s]:null})),{colorClasses:h,colorStyles:m}=lg(l);return{textColorClasses:h,textColorStyles:m}}function Pu(e,s){const l=we(()=>({background:qn(e)?e.value:s?e[s]:null})),{colorClasses:h,colorStyles:m}=lg(l);return{backgroundColorClasses:h,backgroundColorStyles:m}}const DI=["x-small","small","default","large","x-large"],Kd=Bt({size:{type:[String,Number],default:"default"}},"size");function Yd(e){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Vo();return Xm(()=>{let l,h;return pd(DI,e.size)?l=`${s}--size-${e.size}`:e.size&&(h={width:pn(e.size),height:pn(e.size)}),{sizeClasses:l,sizeStyles:h}})}const Os=Bt({tag:{type:String,default:"div"}},"tag"),zI=Bt({color:String,start:Boolean,end:Boolean,icon:_i,...ei(),...Kd(),...Os({tag:"i"}),...Ar()},"VIcon"),$r=Sn()({name:"VIcon",props:zI(),setup(e,s){let{attrs:l,slots:h}=s;const m=Kt(),{themeClasses:_}=is(e),{iconData:x}=eE(we(()=>m.value||e.icon)),{sizeClasses:a}=Yd(e),{textColorClasses:I,textColorStyles:T}=Fs(xn(e,"color"));return $n(()=>{var k,F;const M=(k=h.default)==null?void 0:k.call(h);return M&&(m.value=(F=r0(M).filter(q=>q.type===Bu&&q.children&&typeof q.children=="string")[0])==null?void 0:F.children),ae(x.value.component,{tag:e.tag,icon:x.value.icon,class:["v-icon","notranslate",_.value,a.value,I.value,{"v-icon--clickable":!!l.onClick,"v-icon--start":e.start,"v-icon--end":e.end},e.class],style:[a.value?void 0:{fontSize:pn(e.size),height:pn(e.size),width:pn(e.size)},T.value,e.style],role:l.onClick?"button":void 0,"aria-hidden":!l.onClick},{default:()=>[M]})}),{}}});function z0(e){const{t:s}=Hd();function l(h){let{name:m}=h;const _={prepend:"prependAction",prependInner:"prependAction",append:"appendAction",appendInner:"appendAction",clear:"clear"}[m],x=e[`onClick:${m}`],a=x&&_?s(`$vuetify.input.${_}`,e.label??""):void 0;return ae($r,{icon:e[`${m}Icon`],"aria-label":a,onClick:x},null)}return{InputIcon:l}}const LI=Bt({disabled:Boolean,group:Boolean,hideOnLeave:Boolean,leaveAbsolute:Boolean,mode:String,origin:String},"transition");function Nr(e,s,l){return Sn()({name:e,props:LI({mode:l,origin:s}),setup(h,m){let{slots:_}=m;const x={onBeforeEnter(a){h.origin&&(a.style.transformOrigin=h.origin)},onLeave(a){if(h.leaveAbsolute){const{offsetTop:I,offsetLeft:T,offsetWidth:M,offsetHeight:k}=a;a._transitionInitialStyles={position:a.style.position,top:a.style.top,left:a.style.left,width:a.style.width,height:a.style.height},a.style.position="absolute",a.style.top=`${I}px`,a.style.left=`${T}px`,a.style.width=`${M}px`,a.style.height=`${k}px`}h.hideOnLeave&&a.style.setProperty("display","none","important")},onAfterLeave(a){if(h.leaveAbsolute&&(a!=null&&a._transitionInitialStyles)){const{position:I,top:T,left:M,width:k,height:F}=a._transitionInitialStyles;delete a._transitionInitialStyles,a.style.position=I||"",a.style.top=T||"",a.style.left=M||"",a.style.width=k||"",a.style.height=F||""}}};return()=>{const a=h.group?JS:to;return Oo(a,{name:h.disabled?"":e,css:!h.disabled,...h.group?void 0:{mode:h.mode},...h.disabled?{}:x},_.default)}}})}function L0(e,s){let l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"in-out";return Sn()({name:e,props:{mode:{type:String,default:l},disabled:Boolean},setup(h,m){let{slots:_}=m;return()=>Oo(to,{name:h.disabled?"":e,css:!h.disabled,...h.disabled?{}:s},_.default)}})}function R0(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";const l=(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1)?"width":"height",h=ns(`offset-${l}`);return{onBeforeEnter(x){x._parent=x.parentNode,x._initialStyle={transition:x.style.transition,overflow:x.style.overflow,[l]:x.style[l]}},onEnter(x){const a=x._initialStyle;x.style.setProperty("transition","none","important"),x.style.overflow="hidden";const I=`${x[h]}px`;x.style[l]="0",x.offsetHeight,x.style.transition=a.transition,e&&x._parent&&x._parent.classList.add(e),requestAnimationFrame(()=>{x.style[l]=I})},onAfterEnter:_,onEnterCancelled:_,onLeave(x){x._initialStyle={transition:"",overflow:x.style.overflow,[l]:x.style[l]},x.style.overflow="hidden",x.style[l]=`${x[h]}px`,x.offsetHeight,requestAnimationFrame(()=>x.style[l]="0")},onAfterLeave:m,onLeaveCancelled:m};function m(x){e&&x._parent&&x._parent.classList.remove(e),_(x)}function _(x){const a=x._initialStyle[l];x.style.overflow=x._initialStyle.overflow,a!=null&&(x.style[l]=a),delete x._initialStyle}}const RI=Bt({target:Object},"v-dialog-transition"),B0=Sn()({name:"VDialogTransition",props:RI(),setup(e,s){let{slots:l}=s;const h={onBeforeEnter(m){m.style.pointerEvents="none",m.style.visibility="hidden"},async onEnter(m,_){var F;await new Promise(q=>requestAnimationFrame(q)),await new Promise(q=>requestAnimationFrame(q)),m.style.visibility="";const{x,y:a,sx:I,sy:T,speed:M}=xv(e.target,m),k=Al(m,[{transform:`translate(${x}px, ${a}px) scale(${I}, ${T})`,opacity:0},{}],{duration:225*M,easing:OC});(F=vv(m))==null||F.forEach(q=>{Al(q,[{opacity:0},{opacity:0,offset:.33},{}],{duration:225*2*M,easing:yd})}),k.finished.then(()=>_())},onAfterEnter(m){m.style.removeProperty("pointer-events")},onBeforeLeave(m){m.style.pointerEvents="none"},async onLeave(m,_){var F;await new Promise(q=>requestAnimationFrame(q));const{x,y:a,sx:I,sy:T,speed:M}=xv(e.target,m);Al(m,[{},{transform:`translate(${x}px, ${a}px) scale(${I}, ${T})`,opacity:0}],{duration:125*M,easing:VC}).finished.then(()=>_()),(F=vv(m))==null||F.forEach(q=>{Al(q,[{},{opacity:0,offset:.2},{opacity:0}],{duration:125*2*M,easing:yd})})},onAfterLeave(m){m.style.removeProperty("pointer-events")}};return()=>e.target?ae(to,In({name:"dialog-transition"},h,{css:!1}),l):ae(to,{name:"dialog-transition"},l)}});function vv(e){var l;const s=(l=e.querySelector(":scope > .v-card, :scope > .v-sheet, :scope > .v-list"))==null?void 0:l.children;return s&&[...s]}function xv(e,s){const l=e.getBoundingClientRect(),h=Ym(s),[m,_]=getComputedStyle(s).transformOrigin.split(" ").map(ye=>parseFloat(ye)),[x,a]=getComputedStyle(s).getPropertyValue("--v-overlay-anchor-origin").split(" ");let I=l.left+l.width/2;x==="left"||a==="left"?I-=l.width/2:(x==="right"||a==="right")&&(I+=l.width/2);let T=l.top+l.height/2;x==="top"||a==="top"?T-=l.height/2:(x==="bottom"||a==="bottom")&&(T+=l.height/2);const M=l.width/h.width,k=l.height/h.height,F=Math.max(1,M,k),q=M/F||0,X=k/F||0,re=h.width*h.height/(window.innerWidth*window.innerHeight),me=re>.12?Math.min(1.5,(re-.12)*10+1):1;return{x:I-(m+h.left),y:T-(_+h.top),sx:q,sy:X,speed:me}}Nr("fab-transition","center center","out-in");Nr("dialog-bottom-transition");Nr("dialog-top-transition");Nr("fade-transition");Nr("scale-transition");Nr("scroll-x-transition");Nr("scroll-x-reverse-transition");Nr("scroll-y-transition");Nr("scroll-y-reverse-transition");Nr("slide-x-transition");Nr("slide-x-reverse-transition");const F0=Nr("slide-y-transition");Nr("slide-y-reverse-transition");const BI=L0("expand-transition",R0()),O0=L0("expand-x-transition",R0("",!0)),Wl=Bt({transition:{type:[Boolean,String,Object],default:"fade-transition",validator:e=>e!==!0}},"transition"),zo=(e,s)=>{let{slots:l}=s;const{transition:h,disabled:m,..._}=e,{component:x=to,...a}=typeof h=="object"?h:{};return Oo(x,In(typeof h=="string"?{name:m?"":h}:a,_,{disabled:m}),l)},FI=Bt({active:Boolean,color:String,messages:{type:[Array,String],default:()=>[]},...ei(),...Wl({transition:{component:F0,leaveAbsolute:!0,group:!0}})},"VMessages"),OI=Sn()({name:"VMessages",props:FI(),setup(e,s){let{slots:l}=s;const h=we(()=>Ls(e.messages)),{textColorClasses:m,textColorStyles:_}=Fs(we(()=>e.color));return $n(()=>ae(zo,{transition:e.transition,tag:"div",class:["v-messages",m.value,e.class],style:[_.value,e.style],role:"alert","aria-live":"polite"},{default:()=>[e.active&&h.value.map((x,a)=>ae("div",{class:"v-messages__message",key:`${a}-${h.value}`},[l.message?l.message({message:x}):x]))]})),{}}}),VI=[null,"default","comfortable","compact"],Hl=Bt({density:{type:String,default:"default",validator:e=>VI.includes(e)}},"density");function Xl(e){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Vo();return{densityClasses:we(()=>`${s}--density-${e.density}`)}}const V0=Bt({focused:Boolean,"onUpdate:focused":Rs()},"focus");function cg(e){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Vo();const l=fi(e,"focused"),h=we(()=>({[`${s}--focused`]:l.value}));function m(){l.value=!0}function _(){l.value=!1}return{focusClasses:h,isFocused:l,focus:m,blur:_}}const $I=Symbol.for("vuetify:form");function ug(){return Zn($I,null)}const UI=Bt({disabled:{type:Boolean,default:null},error:Boolean,errorMessages:{type:[Array,String],default:()=>[]},maxErrors:{type:[Number,String],default:1},name:String,label:String,readonly:{type:Boolean,default:null},rules:{type:Array,default:()=>[]},modelValue:null,validateOn:String,validationValue:null,...V0()},"validation");function NI(e){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Vo(),l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:vs();const h=fi(e,"modelValue"),m=we(()=>e.validationValue===void 0?h.value:e.validationValue),_=ug(),x=Kt([]),a=bn(!0),I=we(()=>!!(Ls(h.value===""?null:h.value).length||Ls(m.value===""?null:m.value).length)),T=we(()=>!!(e.disabled??(_==null?void 0:_.isDisabled.value))),M=we(()=>!!(e.readonly??(_==null?void 0:_.isReadonly.value))),k=we(()=>e.errorMessages.length?Ls(e.errorMessages).slice(0,Math.max(0,+e.maxErrors)):x.value),F=we(()=>{let Oe=(e.validateOn??(_==null?void 0:_.validateOn.value))||"input";Oe==="lazy"&&(Oe="input lazy");const Qe=new Set((Oe==null?void 0:Oe.split(" "))??[]);return{blur:Qe.has("blur")||Qe.has("input"),input:Qe.has("input"),submit:Qe.has("submit"),lazy:Qe.has("lazy")}}),q=we(()=>e.error||e.errorMessages.length?!1:e.rules.length?a.value?x.value.length||F.value.lazy?null:!0:!x.value.length:!0),X=bn(!1),re=we(()=>({[`${s}--error`]:q.value===!1,[`${s}--dirty`]:I.value,[`${s}--disabled`]:T.value,[`${s}--readonly`]:M.value})),me=we(()=>e.name??Wi(l));Fm(()=>{_==null||_.register({id:me.value,validate:be,reset:ye,resetValidation:Ee})}),oo(()=>{_==null||_.unregister(me.value)}),Ca(async()=>{F.value.lazy||await be(!0),_==null||_.update(me.value,q.value,k.value)}),Sa(()=>F.value.input,()=>{wn(m,()=>{if(m.value!=null)be();else if(e.focused){const Oe=wn(()=>e.focused,Qe=>{Qe||be(),Oe()})}})}),Sa(()=>F.value.blur,()=>{wn(()=>e.focused,Oe=>{Oe||be()})}),wn(q,()=>{_==null||_.update(me.value,q.value,k.value)});function ye(){h.value=null,er(Ee)}function Ee(){a.value=!0,F.value.lazy?x.value=[]:be(!0)}async function be(){let Oe=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const Qe=[];X.value=!0;for(const Ue of e.rules){if(Qe.length>=+(e.maxErrors??1))break;const j=await(typeof Ue=="function"?Ue:()=>Ue)(m.value);if(j!==!0){if(j!==!1&&typeof j!="string"){console.warn(`${j} is not a valid value. Rule functions must return boolean true or a string.`);continue}Qe.push(j||"")}}return x.value=Qe,X.value=!1,a.value=Oe,x.value}return{errorMessages:k,isDirty:I,isDisabled:T,isReadonly:M,isPristine:a,isValid:q,isValidating:X,reset:ye,resetValidation:Ee,validate:be,validationClasses:re}}const hg=Bt({id:String,appendIcon:_i,centerAffix:{type:Boolean,default:!0},prependIcon:_i,hideDetails:[Boolean,String],hint:String,persistentHint:Boolean,messages:{type:[Array,String],default:()=>[]},direction:{type:String,default:"horizontal",validator:e=>["horizontal","vertical"].includes(e)},"onClick:prepend":Rs(),"onClick:append":Rs(),...ei(),...Hl(),...UI()},"VInput"),Cd=Sn()({name:"VInput",props:{...hg()},emits:{"update:modelValue":e=>!0},setup(e,s){let{attrs:l,slots:h,emit:m}=s;const{densityClasses:_}=Xl(e),{rtlClasses:x}=Gl(),{InputIcon:a}=z0(e),I=vs(),T=we(()=>e.id||`input-${I}`),M=we(()=>`${T.value}-messages`),{errorMessages:k,isDirty:F,isDisabled:q,isReadonly:X,isPristine:re,isValid:me,isValidating:ye,reset:Ee,resetValidation:be,validate:Oe,validationClasses:Qe}=NI(e,"v-input",T),Ue=we(()=>({id:T,messagesId:M,isDirty:F,isDisabled:q,isReadonly:X,isPristine:re,isValid:me,isValidating:ye,reset:Ee,resetValidation:be,validate:Oe})),ze=we(()=>{var j;return(j=e.errorMessages)!=null&&j.length||!re.value&&k.value.length?k.value:e.hint&&(e.persistentHint||e.focused)?e.hint:e.messages});return $n(()=>{var Ce,_e,Fe,ut;const j=!!(h.prepend||e.prependIcon),G=!!(h.append||e.appendIcon),pe=ze.value.length>0,Se=!e.hideDetails||e.hideDetails==="auto"&&(pe||!!h.details);return ae("div",{class:["v-input",`v-input--${e.direction}`,{"v-input--center-affix":e.centerAffix},_.value,x.value,Qe.value,e.class],style:e.style},[j&&ae("div",{key:"prepend",class:"v-input__prepend"},[(Ce=h.prepend)==null?void 0:Ce.call(h,Ue.value),e.prependIcon&&ae(a,{key:"prepend-icon",name:"prepend"},null)]),h.default&&ae("div",{class:"v-input__control"},[(_e=h.default)==null?void 0:_e.call(h,Ue.value)]),G&&ae("div",{key:"append",class:"v-input__append"},[e.appendIcon&&ae(a,{key:"append-icon",name:"append"},null),(Fe=h.append)==null?void 0:Fe.call(h,Ue.value)]),Se&&ae("div",{class:"v-input__details"},[ae(OI,{id:M.value,active:pe,messages:ze.value},{message:h.message}),(ut=h.details)==null?void 0:ut.call(h,Ue.value)])])}),{reset:Ee,resetValidation:be,validate:Oe}}});function $0(e,s){const l=Kt(),h=bn(!1);if(eg){const m=new IntersectionObserver(_=>{e==null||e(_,m),h.value=!!_.find(x=>x.isIntersecting)},s);oo(()=>{m.disconnect()}),wn(l,(_,x)=>{x&&(m.unobserve(x),h.value=!1),_&&m.observe(_)},{flush:"post"})}return{intersectionRef:l,isIntersecting:h}}const jI=Bt({bgColor:String,color:String,indeterminate:[Boolean,String],modelValue:{type:[Number,String],default:0},rotate:{type:[Number,String],default:0},width:{type:[Number,String],default:4},...ei(),...Kd(),...Os({tag:"div"}),...Ar()},"VProgressCircular"),qI=Sn()({name:"VProgressCircular",props:jI(),setup(e,s){let{slots:l}=s;const h=20,m=2*Math.PI*h,_=Kt(),{themeClasses:x}=is(e),{sizeClasses:a,sizeStyles:I}=Yd(e),{textColorClasses:T,textColorStyles:M}=Fs(xn(e,"color")),{textColorClasses:k,textColorStyles:F}=Fs(xn(e,"bgColor")),{intersectionRef:q,isIntersecting:X}=$0(),{resizeRef:re,contentRect:me}=b0(),ye=we(()=>Math.max(0,Math.min(100,parseFloat(e.modelValue)))),Ee=we(()=>Number(e.width)),be=we(()=>I.value?Number(e.size):me.value?me.value.width:Math.max(Ee.value,32)),Oe=we(()=>h/(1-Ee.value/be.value)*2),Qe=we(()=>Ee.value/be.value*Oe.value),Ue=we(()=>pn((100-ye.value)/100*m));return ro(()=>{q.value=_.value,re.value=_.value}),$n(()=>ae(e.tag,{ref:_,class:["v-progress-circular",{"v-progress-circular--indeterminate":!!e.indeterminate,"v-progress-circular--visible":X.value,"v-progress-circular--disable-shrink":e.indeterminate==="disable-shrink"},x.value,a.value,T.value,e.class],style:[I.value,M.value,e.style],role:"progressbar","aria-valuemin":"0","aria-valuemax":"100","aria-valuenow":e.indeterminate?void 0:ye.value},{default:()=>[ae("svg",{style:{transform:`rotate(calc(-90deg + ${Number(e.rotate)}deg))`},xmlns:"http://www.w3.org/2000/svg",viewBox:`0 0 ${Oe.value} ${Oe.value}`},[ae("circle",{class:["v-progress-circular__underlay",k.value],style:F.value,fill:"transparent",cx:"50%",cy:"50%",r:h,"stroke-width":Qe.value,"stroke-dasharray":m,"stroke-dashoffset":0},null),ae("circle",{class:"v-progress-circular__overlay",fill:"transparent",cx:"50%",cy:"50%",r:h,"stroke-width":Qe.value,"stroke-dasharray":m,"stroke-dashoffset":Ue.value},null)]),l.default&&ae("div",{class:"v-progress-circular__content"},[l.default({value:ye.value})])]})),{}}});const ZI=Bt({text:String,clickable:Boolean,...ei(),...Ar()},"VLabel"),U0=Sn()({name:"VLabel",props:ZI(),setup(e,s){let{slots:l}=s;return $n(()=>{var h;return ae("label",{class:["v-label",{"v-label--clickable":e.clickable},e.class],style:e.style},[e.text,(h=l.default)==null?void 0:h.call(l)])}),{}}});const N0=Symbol.for("vuetify:selection-control-group"),j0=Bt({color:String,disabled:Boolean,defaultsTarget:String,error:Boolean,id:String,inline:Boolean,falseIcon:_i,trueIcon:_i,ripple:{type:Boolean,default:!0},multiple:{type:Boolean,default:null},name:String,readonly:Boolean,modelValue:null,type:String,valueComparator:{type:Function,default:ql},...ei(),...Hl(),...Ar()},"SelectionControlGroup"),GI=Bt({...j0({defaultsTarget:"VSelectionControl"})},"VSelectionControlGroup");Sn()({name:"VSelectionControlGroup",props:GI(),emits:{"update:modelValue":e=>!0},setup(e,s){let{slots:l}=s;const h=fi(e,"modelValue"),m=vs(),_=we(()=>e.id||`v-selection-control-group-${m}`),x=we(()=>e.name||_.value),a=new Set;return Qi(N0,{modelValue:h,forceUpdate:()=>{a.forEach(I=>I())},onForceUpdate:I=>{a.add(I),Tr(()=>{a.delete(I)})}}),Ou({[e.defaultsTarget]:{color:xn(e,"color"),disabled:xn(e,"disabled"),density:xn(e,"density"),error:xn(e,"error"),inline:xn(e,"inline"),modelValue:h,multiple:we(()=>!!e.multiple||e.multiple==null&&Array.isArray(h.value)),name:x,falseIcon:xn(e,"falseIcon"),trueIcon:xn(e,"trueIcon"),readonly:xn(e,"readonly"),ripple:xn(e,"ripple"),type:xn(e,"type"),valueComparator:xn(e,"valueComparator")}}),$n(()=>{var I;return ae("div",{class:["v-selection-control-group",{"v-selection-control-group--inline":e.inline},e.class],style:e.style,role:e.type==="radio"?"radiogroup":void 0},[(I=l.default)==null?void 0:I.call(l)])}),{}}});const om=Symbol("rippleStop"),WI=80;function bv(e,s){e.style.transform=s,e.style.webkitTransform=s}function am(e){return e.constructor.name==="TouchEvent"}function q0(e){return e.constructor.name==="KeyboardEvent"}const HI=function(e,s){var k;let l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},h=0,m=0;if(!q0(e)){const F=s.getBoundingClientRect(),q=am(e)?e.touches[e.touches.length-1]:e;h=q.clientX-F.left,m=q.clientY-F.top}let _=0,x=.3;(k=s._ripple)!=null&&k.circle?(x=.15,_=s.clientWidth/2,_=l.center?_:_+Math.sqrt((h-_)**2+(m-_)**2)/4):_=Math.sqrt(s.clientWidth**2+s.clientHeight**2)/2;const a=`${(s.clientWidth-_*2)/2}px`,I=`${(s.clientHeight-_*2)/2}px`,T=l.center?a:`${h-_}px`,M=l.center?I:`${m-_}px`;return{radius:_,scale:x,x:T,y:M,centerX:a,centerY:I}},Ed={show(e,s){var q;let l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(!((q=s==null?void 0:s._ripple)!=null&&q.enabled))return;const h=document.createElement("span"),m=document.createElement("span");h.appendChild(m),h.className="v-ripple__container",l.class&&(h.className+=` ${l.class}`);const{radius:_,scale:x,x:a,y:I,centerX:T,centerY:M}=HI(e,s,l),k=`${_*2}px`;m.className="v-ripple__animation",m.style.width=k,m.style.height=k,s.appendChild(h);const F=window.getComputedStyle(s);F&&F.position==="static"&&(s.style.position="relative",s.dataset.previousPosition="static"),m.classList.add("v-ripple__animation--enter"),m.classList.add("v-ripple__animation--visible"),bv(m,`translate(${a}, ${I}) scale3d(${x},${x},${x})`),m.dataset.activated=String(performance.now()),setTimeout(()=>{m.classList.remove("v-ripple__animation--enter"),m.classList.add("v-ripple__animation--in"),bv(m,`translate(${T}, ${M}) scale3d(1,1,1)`)},0)},hide(e){var _;if(!((_=e==null?void 0:e._ripple)!=null&&_.enabled))return;const s=e.getElementsByClassName("v-ripple__animation");if(s.length===0)return;const l=s[s.length-1];if(l.dataset.isHiding)return;l.dataset.isHiding="true";const h=performance.now()-Number(l.dataset.activated),m=Math.max(250-h,0);setTimeout(()=>{l.classList.remove("v-ripple__animation--in"),l.classList.add("v-ripple__animation--out"),setTimeout(()=>{var a;e.getElementsByClassName("v-ripple__animation").length===1&&e.dataset.previousPosition&&(e.style.position=e.dataset.previousPosition,delete e.dataset.previousPosition),((a=l.parentNode)==null?void 0:a.parentNode)===e&&e.removeChild(l.parentNode)},300)},m)}};function Z0(e){return typeof e>"u"||!!e}function ku(e){const s={},l=e.currentTarget;if(!(!(l!=null&&l._ripple)||l._ripple.touched||e[om])){if(e[om]=!0,am(e))l._ripple.touched=!0,l._ripple.isTouch=!0;else if(l._ripple.isTouch)return;if(s.center=l._ripple.centered||q0(e),l._ripple.class&&(s.class=l._ripple.class),am(e)){if(l._ripple.showTimerCommit)return;l._ripple.showTimerCommit=()=>{Ed.show(e,l,s)},l._ripple.showTimer=window.setTimeout(()=>{var h;(h=l==null?void 0:l._ripple)!=null&&h.showTimerCommit&&(l._ripple.showTimerCommit(),l._ripple.showTimerCommit=null)},WI)}else Ed.show(e,l,s)}}function wv(e){e[om]=!0}function Vr(e){const s=e.currentTarget;if(s!=null&&s._ripple){if(window.clearTimeout(s._ripple.showTimer),e.type==="touchend"&&s._ripple.showTimerCommit){s._ripple.showTimerCommit(),s._ripple.showTimerCommit=null,s._ripple.showTimer=window.setTimeout(()=>{Vr(e)});return}window.setTimeout(()=>{s._ripple&&(s._ripple.touched=!1)}),Ed.hide(s)}}function G0(e){const s=e.currentTarget;s!=null&&s._ripple&&(s._ripple.showTimerCommit&&(s._ripple.showTimerCommit=null),window.clearTimeout(s._ripple.showTimer))}let Mu=!1;function W0(e){!Mu&&(e.keyCode===U_.enter||e.keyCode===U_.space)&&(Mu=!0,ku(e))}function H0(e){Mu=!1,Vr(e)}function X0(e){Mu&&(Mu=!1,Vr(e))}function K0(e,s,l){const{value:h,modifiers:m}=s,_=Z0(h);if(_||Ed.hide(e),e._ripple=e._ripple??{},e._ripple.enabled=_,e._ripple.centered=m.center,e._ripple.circle=m.circle,Xp(h)&&h.class&&(e._ripple.class=h.class),_&&!l){if(m.stop){e.addEventListener("touchstart",wv,{passive:!0}),e.addEventListener("mousedown",wv);return}e.addEventListener("touchstart",ku,{passive:!0}),e.addEventListener("touchend",Vr,{passive:!0}),e.addEventListener("touchmove",G0,{passive:!0}),e.addEventListener("touchcancel",Vr),e.addEventListener("mousedown",ku),e.addEventListener("mouseup",Vr),e.addEventListener("mouseleave",Vr),e.addEventListener("keydown",W0),e.addEventListener("keyup",H0),e.addEventListener("blur",X0),e.addEventListener("dragstart",Vr,{passive:!0})}else!_&&l&&Y0(e)}function Y0(e){e.removeEventListener("mousedown",ku),e.removeEventListener("touchstart",ku),e.removeEventListener("touchend",Vr),e.removeEventListener("touchmove",G0),e.removeEventListener("touchcancel",Vr),e.removeEventListener("mouseup",Vr),e.removeEventListener("mouseleave",Vr),e.removeEventListener("keydown",W0),e.removeEventListener("keyup",H0),e.removeEventListener("dragstart",Vr),e.removeEventListener("blur",X0)}function XI(e,s){K0(e,s,!1)}function KI(e){delete e._ripple,Y0(e)}function YI(e,s){if(s.value===s.oldValue)return;const l=Z0(s.oldValue);K0(e,s,l)}const dg={mounted:XI,unmounted:KI,updated:YI},fg=Bt({label:String,trueValue:null,falseValue:null,value:null,...ei(),...j0()},"VSelectionControl");function JI(e){const s=Zn(N0,void 0),{densityClasses:l}=Xl(e),h=fi(e,"modelValue"),m=we(()=>e.trueValue!==void 0?e.trueValue:e.value!==void 0?e.value:!0),_=we(()=>e.falseValue!==void 0?e.falseValue:!1),x=we(()=>!!e.multiple||e.multiple==null&&Array.isArray(h.value)),a=we({get(){const k=s?s.modelValue.value:h.value;return x.value?k.some(F=>e.valueComparator(F,m.value)):e.valueComparator(k,m.value)},set(k){if(e.readonly)return;const F=k?m.value:_.value;let q=F;x.value&&(q=k?[...Ls(h.value),F]:Ls(h.value).filter(X=>!e.valueComparator(X,m.value))),s?s.modelValue.value=q:h.value=q}}),{textColorClasses:I,textColorStyles:T}=Fs(we(()=>a.value&&!e.error&&!e.disabled?e.color:void 0)),M=we(()=>a.value?e.trueIcon:e.falseIcon);return{group:s,densityClasses:l,trueValue:m,falseValue:_,model:a,textColorClasses:I,textColorStyles:T,icon:M}}const lm=Sn()({name:"VSelectionControl",directives:{Ripple:dg},inheritAttrs:!1,props:fg(),emits:{"update:modelValue":e=>!0},setup(e,s){let{attrs:l,slots:h}=s;const{group:m,densityClasses:_,icon:x,model:a,textColorClasses:I,textColorStyles:T,trueValue:M}=JI(e),k=vs(),F=we(()=>e.id||`input-${k}`),q=bn(!1),X=bn(!1),re=Kt();m==null||m.onForceUpdate(()=>{re.value&&(re.value.checked=a.value)});function me(be){q.value=!0,(!Qp||Qp&&be.target.matches(":focus-visible"))&&(X.value=!0)}function ye(){q.value=!1,X.value=!1}function Ee(be){e.readonly&&m&&er(()=>m.forceUpdate()),a.value=be.target.checked}return $n(()=>{var Ue,ze;const be=h.label?h.label({label:e.label,props:{for:F.value}}):e.label,[Oe,Qe]=Hm(l);return ae("div",In({class:["v-selection-control",{"v-selection-control--dirty":a.value,"v-selection-control--disabled":e.disabled,"v-selection-control--error":e.error,"v-selection-control--focused":q.value,"v-selection-control--focus-visible":X.value,"v-selection-control--inline":e.inline},_.value,e.class]},Oe,{style:e.style}),[ae("div",{class:["v-selection-control__wrapper",I.value],style:T.value},[(Ue=h.default)==null?void 0:Ue.call(h),Ur(ae("div",{class:["v-selection-control__input"]},[x.value&&ae($r,{key:"icon",icon:x.value},null),ae("input",In({ref:re,checked:a.value,disabled:e.disabled,id:F.value,onBlur:ye,onFocus:me,onInput:Ee,"aria-disabled":e.readonly,type:e.type,value:M.value,name:e.name,"aria-checked":e.type==="checkbox"?a.value:void 0},Qe),null),(ze=h.input)==null?void 0:ze.call(h,{model:a,textColorClasses:I,textColorStyles:T,props:{onFocus:me,onBlur:ye,id:F.value}})]),[[wa("ripple"),e.ripple&&[!e.disabled&&!e.readonly,null,["center","circle"]]]])]),be&&ae(U0,{for:F.value,clickable:!0},{default:()=>[be]})])}),{isFocused:q,input:re}}});const Sv={center:"center",top:"bottom",bottom:"top",left:"right",right:"left"},QI=Bt({location:String},"location");function eA(e){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,l=arguments.length>2?arguments[2]:void 0;const{isRtl:h}=Gl();return{locationStyles:we(()=>{if(!e.location)return{};const{side:_,align:x}=Jp(e.location.split(" ").length>1?e.location:`${e.location} center`,h.value);function a(T){return l?l(T):0}const I={};return _!=="center"&&(s?I[Sv[_]]=`calc(100% - ${a(_)}px)`:I[_]=0),x!=="center"?s?I[Sv[x]]=`calc(100% - ${a(x)}px)`:I[x]=0:(_==="center"?I.top=I.left="50%":I[{top:"left",bottom:"left",left:"top",right:"top"}[_]]="50%",I.transform={top:"translateX(-50%)",bottom:"translateX(-50%)",left:"translateY(-50%)",right:"translateY(-50%)",center:"translate(-50%, -50%)"}[_]),I})}}const Kl=Bt({rounded:{type:[Boolean,Number,String],default:void 0}},"rounded");function Yl(e){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Vo();return{roundedClasses:we(()=>{const h=qn(e)?e.value:e.rounded,m=[];if(h===!0||h==="")m.push(`${s}--rounded`);else if(typeof h=="string"||h===0)for(const _ of String(h).split(" "))m.push(`rounded-${_}`);return m})}}const tA=Bt({absolute:Boolean,active:{type:Boolean,default:!0},bgColor:String,bgOpacity:[Number,String],bufferValue:{type:[Number,String],default:0},clickable:Boolean,color:String,height:{type:[Number,String],default:4},indeterminate:Boolean,max:{type:[Number,String],default:100},modelValue:{type:[Number,String],default:0},reverse:Boolean,stream:Boolean,striped:Boolean,roundedBar:Boolean,...ei(),...QI({location:"top"}),...Kl(),...Os(),...Ar()},"VProgressLinear"),nA=Sn()({name:"VProgressLinear",props:tA(),emits:{"update:modelValue":e=>!0},setup(e,s){let{slots:l}=s;const h=fi(e,"modelValue"),{isRtl:m,rtlClasses:_}=Gl(),{themeClasses:x}=is(e),{locationStyles:a}=eA(e),{textColorClasses:I,textColorStyles:T}=Fs(e,"color"),{backgroundColorClasses:M,backgroundColorStyles:k}=Pu(we(()=>e.bgColor||e.color)),{backgroundColorClasses:F,backgroundColorStyles:q}=Pu(e,"color"),{roundedClasses:X}=Yl(e),{intersectionRef:re,isIntersecting:me}=$0(),ye=we(()=>parseInt(e.max,10)),Ee=we(()=>parseInt(e.height,10)),be=we(()=>parseFloat(e.bufferValue)/ye.value*100),Oe=we(()=>parseFloat(h.value)/ye.value*100),Qe=we(()=>m.value!==e.reverse),Ue=we(()=>e.indeterminate?"fade-transition":"slide-x-transition"),ze=we(()=>e.bgOpacity==null?e.bgOpacity:parseFloat(e.bgOpacity));function j(G){if(!re.value)return;const{left:pe,right:Se,width:Ce}=re.value.getBoundingClientRect(),_e=Qe.value?Ce-G.clientX+(Se-Ce):G.clientX-pe;h.value=Math.round(_e/Ce*ye.value)}return $n(()=>ae(e.tag,{ref:re,class:["v-progress-linear",{"v-progress-linear--absolute":e.absolute,"v-progress-linear--active":e.active&&me.value,"v-progress-linear--reverse":Qe.value,"v-progress-linear--rounded":e.rounded,"v-progress-linear--rounded-bar":e.roundedBar,"v-progress-linear--striped":e.striped},X.value,x.value,_.value,e.class],style:[{bottom:e.location==="bottom"?0:void 0,top:e.location==="top"?0:void 0,height:e.active?pn(Ee.value):0,"--v-progress-linear-height":pn(Ee.value),...a.value},e.style],role:"progressbar","aria-hidden":e.active?"false":"true","aria-valuemin":"0","aria-valuemax":e.max,"aria-valuenow":e.indeterminate?void 0:Oe.value,onClick:e.clickable&&j},{default:()=>[e.stream&&ae("div",{key:"stream",class:["v-progress-linear__stream",I.value],style:{...T.value,[Qe.value?"left":"right"]:pn(-Ee.value),borderTop:`${pn(Ee.value/2)} dotted`,opacity:ze.value,top:`calc(50% - ${pn(Ee.value/4)})`,width:pn(100-be.value,"%"),"--v-progress-linear-stream-to":pn(Ee.value*(Qe.value?1:-1))}},null),ae("div",{class:["v-progress-linear__background",M.value],style:[k.value,{opacity:ze.value,width:pn(e.stream?be.value:100,"%")}]},null),ae(to,{name:Ue.value},{default:()=>[e.indeterminate?ae("div",{class:"v-progress-linear__indeterminate"},[["long","short"].map(G=>ae("div",{key:G,class:["v-progress-linear__indeterminate",G,F.value],style:q.value},null))]):ae("div",{class:["v-progress-linear__determinate",F.value],style:[q.value,{width:pn(Oe.value,"%")}]},null)]}),l.default&&ae("div",{class:"v-progress-linear__content"},[l.default({value:Oe.value,buffer:be.value})])]})),{}}}),iA=Bt({loading:[Boolean,String]},"loader");function J0(e){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Vo();return{loaderClasses:we(()=>({[`${s}--loading`]:e.loading}))}}function Q0(e,s){var h;let{slots:l}=s;return ae("div",{class:`${e.name}__loader`},[((h=l.default)==null?void 0:h.call(l,{color:e.color,isActive:e.active}))||ae(nA,{active:e.active,color:e.color,height:"2",indeterminate:!0},null)])}const rA=Bt({indeterminate:Boolean,inset:Boolean,flat:Boolean,loading:{type:[Boolean,String],default:!1},...hg(),...fg()},"VSwitch"),sA=Sn()({name:"VSwitch",inheritAttrs:!1,props:rA(),emits:{"update:focused":e=>!0,"update:modelValue":()=>!0,"update:indeterminate":e=>!0},setup(e,s){let{attrs:l,slots:h}=s;const m=fi(e,"indeterminate"),_=fi(e,"modelValue"),{loaderClasses:x}=J0(e),{isFocused:a,focus:I,blur:T}=cg(e),M=we(()=>typeof e.loading=="string"&&e.loading!==""?e.loading:e.color),k=vs(),F=we(()=>e.id||`switch-${k}`);function q(){m.value&&(m.value=!1)}return $n(()=>{const[X,re]=Hm(l),[me,ye]=Cd.filterProps(e),[Ee,be]=lm.filterProps(e),Oe=Kt();function Qe(Ue){var ze,j;Ue.stopPropagation(),Ue.preventDefault(),(j=(ze=Oe.value)==null?void 0:ze.input)==null||j.click()}return ae(Cd,In({class:["v-switch",{"v-switch--inset":e.inset},{"v-switch--indeterminate":m.value},x.value,e.class],style:e.style},X,me,{id:F.value,focused:a.value}),{...h,default:Ue=>{let{id:ze,messagesId:j,isDisabled:G,isReadonly:pe,isValid:Se}=Ue;return ae(lm,In({ref:Oe},Ee,{modelValue:_.value,"onUpdate:modelValue":[Ce=>_.value=Ce,q],id:ze.value,"aria-describedby":j.value,type:"checkbox","aria-checked":m.value?"mixed":void 0,disabled:G.value,readonly:pe.value,onFocus:I,onBlur:T},re),{...h,default:()=>ae("div",{class:"v-switch__track",onClick:Qe},null),input:Ce=>{let{textColorClasses:_e,textColorStyles:Fe}=Ce;return ae("div",{class:["v-switch__thumb",_e.value],style:Fe.value},[e.loading&&ae(Q0,{name:"v-switch",active:!0,color:Se.value===!1?void 0:M.value},{default:ut=>h.loader?h.loader(ut):ae(qI,{active:ut.isActive,color:ut.color,indeterminate:!0,size:"16",width:"2"},null)})])}})}})}),{}}}),oA={class:"AssociationBar"},aA={class:"AssociationBar__ctn AssociationBar__ctn--top"},lA={class:"AssociationBar__head"},cA={class:"AssociationBar__count"},uA={class:"AssociationBar__ctn AssociationBar__ctn--bottom"},hA=jt("div",{class:"AssociationBar__divider"},null,-1),dA=["src"];function fA(e,s,l,h,m,_){const x=Gi("Button"),a=Gi("InputSearch"),I=Gi("AssociationList");return an(),fn("div",oA,[jt("div",aA,[jt("div",lA,[jt("h3",cA,Pi(e.associationsCountLabel),1),ae(x,{onClick:e.toggleFiltersBar,class:"AssociationBar__toggleFiltersBtn",label:e.toggleFiltersLabel,uppercase:!0,small:!0,toggled:e.isFiltersBarShown,icon:e.toggleFiltersIcon},null,8,["onClick","label","toggled","icon"])]),ae(a),ae(I),ae(sA,{class:Ld("AssociationBar__switchMap"+(e.isMapSynced?" active":"")),label:"Synchroniser avec la carte",inset:"","hide-details":"auto",modelValue:e.filterStore.isMapSynced,"onUpdate:modelValue":s[0]||(s[0]=T=>e.filterStore.isMapSynced=T)},null,8,["class","modelValue"])]),jt("div",uA,[hA,jt("img",{src:e.logoPath,alt:"Logo CRPM",class:"AssociationBar__crpmLogo"},null,8,dA),ae(x,{onClick:e.openAboutModal,class:"AssociationBar__aboutBtn",label:"À propos du projet",uppercase:!0,icon:"mdi-information-variant-circle-outline"},null,8,["onClick"])])])}const pA=gr(sm,[["render",fA]]);var mA=Object.defineProperty,gA=Object.getOwnPropertyDescriptor,Ta=(e,s,l,h)=>{for(var m=h>1?void 0:h?gA(s,l):s,_=e.length-1,x;_>=0;_--)(x=e[_])&&(m=(h?x(s,l,m):x(m))||m);return h&&m&&mA(s,l,m),m};let io=class extends mr{constructor(){super(...arguments);Wn(this,"selected",[]);Wn(this,"label");Wn(this,"data");Wn(this,"reset")}selectedWatcher(){this.onSelected()}resetWatcher(){this.selected=[]}onSelected(){return this.selected}};Ta([Pr({default:"Button label"})],io.prototype,"label",2);Ta([Pr({default:[]})],io.prototype,"data",2);Ta([Pr({default:!1})],io.prototype,"reset",2);Ta([xs("selected")],io.prototype,"selectedWatcher",1);Ta([xs("reset")],io.prototype,"resetWatcher",1);Ta([nT()],io.prototype,"onSelected",1);io=Ta([pr({})],io);const yA=Bt({indeterminate:Boolean,indeterminateIcon:{type:_i,default:"$checkboxIndeterminate"},...fg({falseIcon:"$checkboxOff",trueIcon:"$checkboxOn"})},"VCheckboxBtn"),eb=Sn()({name:"VCheckboxBtn",props:yA(),emits:{"update:modelValue":e=>!0,"update:indeterminate":e=>!0},setup(e,s){let{slots:l}=s;const h=fi(e,"indeterminate"),m=fi(e,"modelValue");function _(I){h.value&&(h.value=!1)}const x=we(()=>h.value?e.indeterminateIcon:e.falseIcon),a=we(()=>h.value?e.indeterminateIcon:e.trueIcon);return $n(()=>ae(lm,In(e,{modelValue:m.value,"onUpdate:modelValue":[I=>m.value=I,_],class:["v-checkbox-btn",e.class],style:e.style,type:"checkbox",falseIcon:x.value,trueIcon:a.value,"aria-checked":h.value?"mixed":void 0}),l)),{}}});const Jd=Bt({height:[Number,String],maxHeight:[Number,String],maxWidth:[Number,String],minHeight:[Number,String],minWidth:[Number,String],width:[Number,String]},"dimension");function Qd(e){return{dimensionStyles:we(()=>({height:pn(e.height),maxHeight:pn(e.maxHeight),maxWidth:pn(e.maxWidth),minHeight:pn(e.minHeight),minWidth:pn(e.minWidth),width:pn(e.width)}))}}function _A(e){return{aspectStyles:we(()=>{const s=Number(e.aspectRatio);return s?{paddingBottom:String(1/s*100)+"%"}:void 0})}}const tb=Bt({aspectRatio:[String,Number],contentClass:String,inline:Boolean,...ei(),...Jd()},"VResponsive"),Cv=Sn()({name:"VResponsive",props:tb(),setup(e,s){let{slots:l}=s;const{aspectStyles:h}=_A(e),{dimensionStyles:m}=Qd(e);return $n(()=>{var _;return ae("div",{class:["v-responsive",{"v-responsive--inline":e.inline},e.class],style:[m.value,e.style]},[ae("div",{class:"v-responsive__sizer",style:h.value},null),(_=l.additional)==null?void 0:_.call(l),l.default&&ae("div",{class:["v-responsive__content",e.contentClass]},[l.default()])])}),{}}});function vA(e,s){if(!eg)return;const l=s.modifiers||{},h=s.value,{handler:m,options:_}=typeof h=="object"?h:{handler:h,options:{}},x=new IntersectionObserver(function(){var k;let a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],I=arguments.length>1?arguments[1]:void 0;const T=(k=e._observe)==null?void 0:k[s.instance.$.uid];if(!T)return;const M=a.some(F=>F.isIntersecting);m&&(!l.quiet||T.init)&&(!l.once||M||T.init)&&m(M,a,I),M&&l.once?nb(e,s):T.init=!0},_);e._observe=Object(e._observe),e._observe[s.instance.$.uid]={init:!1,observer:x},x.observe(e)}function nb(e,s){var h;const l=(h=e._observe)==null?void 0:h[s.instance.$.uid];l&&(l.observer.unobserve(e),delete e._observe[s.instance.$.uid])}const xA={mounted:vA,unmounted:nb},ib=xA,bA=Bt({alt:String,cover:Boolean,eager:Boolean,gradient:String,lazySrc:String,options:{type:Object,default:()=>({root:void 0,rootMargin:void 0,threshold:void 0})},sizes:String,src:{type:[String,Object],default:""},srcset:String,...tb(),...ei(),...Wl()},"VImg"),wA=Sn()({name:"VImg",directives:{intersect:ib},props:bA(),emits:{loadstart:e=>!0,load:e=>!0,error:e=>!0},setup(e,s){let{emit:l,slots:h}=s;const m=bn(""),_=Kt(),x=bn(e.eager?"loading":"idle"),a=bn(),I=bn(),T=we(()=>e.src&&typeof e.src=="object"?{src:e.src.src,srcset:e.srcset||e.src.srcset,lazySrc:e.lazySrc||e.src.lazySrc,aspect:Number(e.aspectRatio||e.src.aspect||0)}:{src:e.src,srcset:e.srcset,lazySrc:e.lazySrc,aspect:Number(e.aspectRatio||0)}),M=we(()=>T.value.aspect||a.value/I.value||0);wn(()=>e.src,()=>{k(x.value!=="idle")}),wn(M,(j,G)=>{!j&&G&&_.value&&me(_.value)}),Fm(()=>k());function k(j){if(!(e.eager&&j)&&!(eg&&!j&&!e.eager)){if(x.value="loading",T.value.lazySrc){const G=new Image;G.src=T.value.lazySrc,me(G,null)}T.value.src&&er(()=>{var G,pe;if(l("loadstart",((G=_.value)==null?void 0:G.currentSrc)||T.value.src),(pe=_.value)!=null&&pe.complete){if(_.value.naturalWidth||q(),x.value==="error")return;M.value||me(_.value,null),F()}else M.value||me(_.value),X()})}}function F(){var j;X(),x.value="loaded",l("load",((j=_.value)==null?void 0:j.currentSrc)||T.value.src)}function q(){var j;x.value="error",l("error",((j=_.value)==null?void 0:j.currentSrc)||T.value.src)}function X(){const j=_.value;j&&(m.value=j.currentSrc||j.src)}let re=-1;function me(j){let G=arguments.length>1&&arguments[1]!==void 0?arguments[1]:100;const pe=()=>{clearTimeout(re);const{naturalHeight:Se,naturalWidth:Ce}=j;Se||Ce?(a.value=Ce,I.value=Se):!j.complete&&x.value==="loading"&&G!=null?re=window.setTimeout(pe,G):(j.currentSrc.endsWith(".svg")||j.currentSrc.startsWith("data:image/svg+xml"))&&(a.value=1,I.value=1)};pe()}const ye=we(()=>({"v-img__img--cover":e.cover,"v-img__img--contain":!e.cover})),Ee=()=>{var pe;if(!T.value.src||x.value==="idle")return null;const j=ae("img",{class:["v-img__img",ye.value],src:T.value.src,srcset:T.value.srcset,alt:e.alt,sizes:e.sizes,ref:_,onLoad:F,onError:q},null),G=(pe=h.sources)==null?void 0:pe.call(h);return ae(zo,{transition:e.transition,appear:!0},{default:()=>[Ur(G?ae("picture",{class:"v-img__picture"},[G,j]):j,[[jl,x.value==="loaded"]])]})},be=()=>ae(zo,{transition:e.transition},{default:()=>[T.value.lazySrc&&x.value!=="loaded"&&ae("img",{class:["v-img__img","v-img__img--preload",ye.value],src:T.value.lazySrc,alt:e.alt},null)]}),Oe=()=>h.placeholder?ae(zo,{transition:e.transition,appear:!0},{default:()=>[(x.value==="loading"||x.value==="error"&&!h.error)&&ae("div",{class:"v-img__placeholder"},[h.placeholder()])]}):null,Qe=()=>h.error?ae(zo,{transition:e.transition,appear:!0},{default:()=>[x.value==="error"&&ae("div",{class:"v-img__error"},[h.error()])]}):null,Ue=()=>e.gradient?ae("div",{class:"v-img__gradient",style:{backgroundImage:`linear-gradient(${e.gradient})`}},null):null,ze=bn(!1);{const j=wn(M,G=>{G&&(requestAnimationFrame(()=>{requestAnimationFrame(()=>{ze.value=!0})}),j())})}return $n(()=>{const[j]=Cv.filterProps(e);return Ur(ae(Cv,In({class:["v-img",{"v-img--booting":!ze.value},e.class],style:e.style},j,{aspectRatio:M.value,"aria-label":e.alt,role:e.alt?"img":void 0}),{additional:()=>ae(mn,null,[ae(Ee,null,null),ae(be,null,null),ae(Ue,null,null),ae(Oe,null,null),ae(Qe,null,null)]),default:h.default}),[[wa("intersect"),{handler:k,options:e.options},null,{once:!0}]])}),{currentSrc:m,image:_,state:x,naturalWidth:a,naturalHeight:I}}}),SA=["elevated","flat","tonal","outlined","text","plain"];function pg(e,s){return ae(mn,null,[e&&ae("span",{key:"overlay",class:`${s}__overlay`},null),ae("span",{key:"underlay",class:`${s}__underlay`},null)])}const $u=Bt({color:String,variant:{type:String,default:"elevated",validator:e=>SA.includes(e)}},"variant");function mg(e){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Vo();const l=we(()=>{const{variant:_}=Wi(e);return`${s}--variant-${_}`}),{colorClasses:h,colorStyles:m}=lg(we(()=>{const{variant:_,color:x}=Wi(e);return{[["elevated","flat"].includes(_)?"background":"text"]:x}}));return{colorClasses:h,colorStyles:m,variantClasses:l}}const CA=Bt({start:Boolean,end:Boolean,icon:_i,image:String,...ei(),...Hl(),...Kl(),...Kd(),...Os(),...Ar(),...$u({variant:"flat"})},"VAvatar"),Td=Sn()({name:"VAvatar",props:CA(),setup(e,s){let{slots:l}=s;const{themeClasses:h}=is(e),{colorClasses:m,colorStyles:_,variantClasses:x}=mg(e),{densityClasses:a}=Xl(e),{roundedClasses:I}=Yl(e),{sizeClasses:T,sizeStyles:M}=Yd(e);return $n(()=>ae(e.tag,{class:["v-avatar",{"v-avatar--start":e.start,"v-avatar--end":e.end},h.value,m.value,a.value,I.value,T.value,x.value,e.class],style:[_.value,M.value,e.style]},{default:()=>{var k;return[e.image?ae(wA,{key:"image",src:e.image,alt:"",cover:!0},null):e.icon?ae($r,{key:"icon",icon:e.icon},null):(k=l.default)==null?void 0:k.call(l),pg(!1,"v-avatar")]}})),{}}});const EA=Bt({modelValue:{type:null,default:void 0},multiple:Boolean,mandatory:[Boolean,String],max:Number,selectedClass:String,disabled:Boolean},"group"),TA=Bt({value:null,disabled:Boolean,selectedClass:String},"group-item");function IA(e,s){let l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const h=fr("useGroupItem");if(!h)throw new Error("[Vuetify] useGroupItem composable must be used inside a component setup function");const m=vs();Qi(Symbol.for(`${s.description}:id`),m);const _=Zn(s,null);if(!_){if(!l)return _;throw new Error(`[Vuetify] Could not find useGroup injection with symbol ${s.description}`)}const x=xn(e,"value"),a=we(()=>_.disabled.value||e.disabled);_.register({id:m,value:x,disabled:a},h),oo(()=>{_.unregister(m)});const I=we(()=>_.isSelected(m)),T=we(()=>I.value&&[_.selectedClass.value,e.selectedClass]);return wn(I,M=>{h.emit("group:selected",{value:M})}),{id:m,isSelected:I,toggle:()=>_.select(m,!I.value),select:M=>_.select(m,M),selectedClass:T,value:x,disabled:a,group:_}}function AA(e,s){let l=!1;const h=Oi([]),m=fi(e,"modelValue",[],F=>F==null?[]:rb(h,Ls(F)),F=>{const q=kA(h,F);return e.multiple?q:q[0]}),_=fr("useGroup");function x(F,q){const X=F,re=Symbol.for(`${s.description}:id`),ye=du(re,_==null?void 0:_.vnode).indexOf(q);ye>-1?h.splice(ye,0,X):h.push(X)}function a(F){if(l)return;I();const q=h.findIndex(X=>X.id===F);h.splice(q,1)}function I(){const F=h.find(q=>!q.disabled);F&&e.mandatory==="force"&&!m.value.length&&(m.value=[F.id])}Ca(()=>{I()}),oo(()=>{l=!0});function T(F,q){const X=h.find(re=>re.id===F);if(!(q&&(X!=null&&X.disabled)))if(e.multiple){const re=m.value.slice(),me=re.findIndex(Ee=>Ee===F),ye=~me;if(q=q??!ye,ye&&e.mandatory&&re.length<=1||!ye&&e.max!=null&&re.length+1>e.max)return;me<0&&q?re.push(F):me>=0&&!q&&re.splice(me,1),m.value=re}else{const re=m.value.includes(F);if(e.mandatory&&re)return;m.value=q??!re?[F]:[]}}function M(F){if(e.multiple,m.value.length){const q=m.value[0],X=h.findIndex(ye=>ye.id===q);let re=(X+F)%h.length,me=h[re];for(;me.disabled&&re!==X;)re=(re+F)%h.length,me=h[re];if(me.disabled)return;m.value=[h[re].id]}else{const q=h.find(X=>!X.disabled);q&&(m.value=[q.id])}}const k={register:x,unregister:a,selected:m,select:T,disabled:xn(e,"disabled"),prev:()=>M(h.length-1),next:()=>M(1),isSelected:F=>m.value.includes(F),selectedClass:we(()=>e.selectedClass),items:we(()=>h),getItemIndex:F=>PA(h,F)};return Qi(s,k),k}function PA(e,s){const l=rb(e,[s]);return l.length?e.findIndex(h=>h.id===l[0]):-1}function rb(e,s){const l=[];return s.forEach(h=>{const m=e.find(x=>ql(h,x.value)),_=e[h];(m==null?void 0:m.value)!=null?l.push(m.id):_!=null&&l.push(_.id)}),l}function kA(e,s){const l=[];return s.forEach(h=>{const m=e.findIndex(_=>_.id===h);if(~m){const _=e[m];l.push(_.value!=null?_.value:m)}}),l}const sb=Symbol.for("vuetify:v-chip-group"),MA=Bt({column:Boolean,filter:Boolean,valueComparator:{type:Function,default:ql},...ei(),...EA({selectedClass:"v-chip--selected"}),...Os(),...Ar(),...$u({variant:"tonal"})},"VChipGroup");Sn()({name:"VChipGroup",props:MA(),emits:{"update:modelValue":e=>!0},setup(e,s){let{slots:l}=s;const{themeClasses:h}=is(e),{isSelected:m,select:_,next:x,prev:a,selected:I}=AA(e,sb);return Ou({VChip:{color:xn(e,"color"),disabled:xn(e,"disabled"),filter:xn(e,"filter"),variant:xn(e,"variant")}}),$n(()=>ae(e.tag,{class:["v-chip-group",{"v-chip-group--column":e.column},h.value,e.class],style:e.style},{default:()=>{var T;return[(T=l.default)==null?void 0:T.call(l,{isSelected:m,select:_,next:x,prev:a,selected:I.value})]}})),{}}});const DA=Bt({defaults:Object,disabled:Boolean,reset:[Number,String],root:[Boolean,String],scoped:Boolean},"VDefaultsProvider"),zs=Sn(!1)({name:"VDefaultsProvider",props:DA(),setup(e,s){let{slots:l}=s;const{defaults:h,disabled:m,reset:_,root:x,scoped:a}=Fd(e);return Ou(h,{reset:_,root:x,scoped:a,disabled:m}),()=>{var I;return(I=l.default)==null?void 0:I.call(l)}}}),gg=Bt({border:[Boolean,Number,String]},"border");function yg(e){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Vo();return{borderClasses:we(()=>{const h=qn(e)?e.value:e.border,m=[];if(h===!0||h==="")m.push(`${s}--border`);else if(typeof h=="string"||h===0)for(const _ of String(h).split(" "))m.push(`border-${_}`);return m})}}const _g=Bt({elevation:{type:[Number,String],validator(e){const s=parseInt(e);return!isNaN(s)&&s>=0&&s<=24}}},"elevation");function vg(e){return{elevationClasses:we(()=>{const l=qn(e)?e.value:e.elevation,h=[];return l==null||h.push(`elevation-${l}`),h})}}function zA(){var e,s;return(s=(e=fr("useRouter"))==null?void 0:e.proxy)==null?void 0:s.$router}function ob(e,s){const l=X2("RouterLink"),h=we(()=>!!(e.href||e.to)),m=we(()=>(h==null?void 0:h.value)||j_(s,"click")||j_(e,"click"));if(typeof l=="string")return{isLink:h,isClickable:m,href:xn(e,"href")};const _=e.to?l.useLink(e):void 0;return{isLink:h,isClickable:m,route:_==null?void 0:_.route,navigate:_==null?void 0:_.navigate,isActive:_&&we(()=>{var x,a;return e.exact?(x=_.isExactActive)==null?void 0:x.value:(a=_.isActive)==null?void 0:a.value}),href:we(()=>e.to?_==null?void 0:_.route.value.href:e.href)}}const ab=Bt({href:String,replace:Boolean,to:[String,Object],exact:Boolean},"router");let Cp=!1;function LA(e,s){let l=!1,h,m;Mi&&(er(()=>{window.addEventListener("popstate",_),h=e==null?void 0:e.beforeEach((x,a,I)=>{Cp?l?s(I):I():setTimeout(()=>l?s(I):I()),Cp=!0}),m=e==null?void 0:e.afterEach(()=>{Cp=!1})}),Tr(()=>{window.removeEventListener("popstate",_),h==null||h(),m==null||m()}));function _(x){var a;(a=x.state)!=null&&a.replaced||(l=!0,setTimeout(()=>l=!1))}}const RA=Bt({activeClass:String,appendAvatar:String,appendIcon:_i,closable:Boolean,closeIcon:{type:_i,default:"$delete"},closeLabel:{type:String,default:"$vuetify.close"},draggable:Boolean,filter:Boolean,filterIcon:{type:String,default:"$complete"},label:Boolean,link:{type:Boolean,default:void 0},pill:Boolean,prependAvatar:String,prependIcon:_i,ripple:{type:[Boolean,Object],default:!0},text:String,modelValue:{type:Boolean,default:!0},onClick:Rs(),onClickOnce:Rs(),...gg(),...ei(),...Hl(),..._g(),...TA(),...Kl(),...ab(),...Kd(),...Os({tag:"span"}),...Ar(),...$u({variant:"tonal"})},"VChip"),lb=Sn()({name:"VChip",directives:{Ripple:dg},props:RA(),emits:{"click:close":e=>!0,"update:modelValue":e=>!0,"group:selected":e=>!0,click:e=>!0},setup(e,s){let{attrs:l,emit:h,slots:m}=s;const{t:_}=Hd(),{borderClasses:x}=yg(e),{colorClasses:a,colorStyles:I,variantClasses:T}=mg(e),{densityClasses:M}=Xl(e),{elevationClasses:k}=vg(e),{roundedClasses:F}=Yl(e),{sizeClasses:q}=Yd(e),{themeClasses:X}=is(e),re=fi(e,"modelValue"),me=IA(e,sb,!1),ye=ob(e,l),Ee=we(()=>e.link!==!1&&ye.isLink.value),be=we(()=>!e.disabled&&e.link!==!1&&(!!me||e.link||ye.isClickable.value)),Oe=we(()=>({"aria-label":_(e.closeLabel),onClick(ze){re.value=!1,h("click:close",ze)}}));function Qe(ze){var j;h("click",ze),be.value&&((j=ye.navigate)==null||j.call(ye,ze),me==null||me.toggle())}function Ue(ze){(ze.key==="Enter"||ze.key===" ")&&(ze.preventDefault(),Qe(ze))}return()=>{const ze=ye.isLink.value?"a":e.tag,j=!!(e.appendIcon||e.appendAvatar),G=!!(j||m.append),pe=!!(m.close||e.closable),Se=!!(m.filter||e.filter)&&me,Ce=!!(e.prependIcon||e.prependAvatar),_e=!!(Ce||m.prepend),Fe=!me||me.isSelected.value;return re.value&&Ur(ae(ze,{class:["v-chip",{"v-chip--disabled":e.disabled,"v-chip--label":e.label,"v-chip--link":be.value,"v-chip--filter":Se,"v-chip--pill":e.pill},X.value,x.value,Fe?a.value:void 0,M.value,k.value,F.value,q.value,T.value,me==null?void 0:me.selectedClass.value,e.class],style:[Fe?I.value:void 0,e.style],disabled:e.disabled||void 0,draggable:e.draggable,href:ye.href.value,tabindex:be.value?0:void 0,onClick:Qe,onKeydown:be.value&&!Ee.value&&Ue},{default:()=>{var ut;return[pg(be.value,"v-chip"),Se&&ae(O0,{key:"filter"},{default:()=>[Ur(ae("div",{class:"v-chip__filter"},[m.filter?Ur(ae(zs,{key:"filter-defaults",disabled:!e.filterIcon,defaults:{VIcon:{icon:e.filterIcon}}},null),[[wa("slot"),m.filter,"default"]]):ae($r,{key:"filter-icon",icon:e.filterIcon},null)]),[[jl,me.isSelected.value]])]}),_e&&ae("div",{key:"prepend",class:"v-chip__prepend"},[m.prepend?ae(zs,{key:"prepend-defaults",disabled:!Ce,defaults:{VAvatar:{image:e.prependAvatar,start:!0},VIcon:{icon:e.prependIcon,start:!0}}},m.prepend):ae(mn,null,[e.prependIcon&&ae($r,{key:"prepend-icon",icon:e.prependIcon,start:!0},null),e.prependAvatar&&ae(Td,{key:"prepend-avatar",image:e.prependAvatar,start:!0},null)])]),ae("div",{class:"v-chip__content"},[((ut=m.default)==null?void 0:ut.call(m,{isSelected:me==null?void 0:me.isSelected.value,selectedClass:me==null?void 0:me.selectedClass.value,select:me==null?void 0:me.select,toggle:me==null?void 0:me.toggle,value:me==null?void 0:me.value.value,disabled:e.disabled}))??e.text]),G&&ae("div",{key:"append",class:"v-chip__append"},[m.append?ae(zs,{key:"append-defaults",disabled:!j,defaults:{VAvatar:{end:!0,image:e.appendAvatar},VIcon:{end:!0,icon:e.appendIcon}}},m.append):ae(mn,null,[e.appendIcon&&ae($r,{key:"append-icon",end:!0,icon:e.appendIcon},null),e.appendAvatar&&ae(Td,{key:"append-avatar",end:!0,image:e.appendAvatar},null)])]),pe&&ae("div",In({key:"close",class:"v-chip__close"},Oe.value),[m.close?ae(zs,{key:"close-defaults",defaults:{VIcon:{icon:e.closeIcon,size:"x-small"}}},m.close):ae($r,{key:"close-icon",icon:e.closeIcon,size:"x-small"},null)])]}}),[[wa("ripple"),be.value&&e.ripple,null]])}}});const cm=Symbol.for("vuetify:list");function cb(){const e=Zn(cm,{hasPrepend:bn(!1),updateHasPrepend:()=>null}),s={hasPrepend:bn(!1),updateHasPrepend:l=>{l&&(s.hasPrepend.value=l)}};return Qi(cm,s),e}function ub(){return Zn(cm,null)}const BA={open:e=>{let{id:s,value:l,opened:h,parents:m}=e;if(l){const _=new Set;_.add(s);let x=m.get(s);for(;x!=null;)_.add(x),x=m.get(x);return _}else return h.delete(s),h},select:()=>null},hb={open:e=>{let{id:s,value:l,opened:h,parents:m}=e;if(l){let _=m.get(s);for(h.add(s);_!=null&&_!==s;)h.add(_),_=m.get(_);return h}else h.delete(s);return h},select:()=>null},FA={open:hb.open,select:e=>{let{id:s,value:l,opened:h,parents:m}=e;if(!l)return h;const _=[];let x=m.get(s);for(;x!=null;)_.push(x),x=m.get(x);return new Set(_)}},xg=e=>{const s={select:l=>{let{id:h,value:m,selected:_}=l;if(h=rn(h),e&&!m){const x=Array.from(_.entries()).reduce((a,I)=>{let[T,M]=I;return M==="on"?[...a,T]:a},[]);if(x.length===1&&x[0]===h)return _}return _.set(h,m?"on":"off"),_},in:(l,h,m)=>{let _=new Map;for(const x of l||[])_=s.select({id:x,value:!0,selected:new Map(_),children:h,parents:m});return _},out:l=>{const h=[];for(const[m,_]of l.entries())_==="on"&&h.push(m);return h}};return s},db=e=>{const s=xg(e);return{select:h=>{let{selected:m,id:_,...x}=h;_=rn(_);const a=m.has(_)?new Map([[_,m.get(_)]]):new Map;return s.select({...x,id:_,selected:a})},in:(h,m,_)=>{let x=new Map;return h!=null&&h.length&&(x=s.in(h.slice(0,1),m,_)),x},out:(h,m,_)=>s.out(h,m,_)}},OA=e=>{const s=xg(e);return{select:h=>{let{id:m,selected:_,children:x,...a}=h;return m=rn(m),x.has(m)?_:s.select({id:m,selected:_,children:x,...a})},in:s.in,out:s.out}},VA=e=>{const s=db(e);return{select:h=>{let{id:m,selected:_,children:x,...a}=h;return m=rn(m),x.has(m)?_:s.select({id:m,selected:_,children:x,...a})},in:s.in,out:s.out}},$A=e=>{const s={select:l=>{let{id:h,value:m,selected:_,children:x,parents:a}=l;h=rn(h);const I=new Map(_),T=[h];for(;T.length;){const k=T.shift();_.set(k,m?"on":"off"),x.has(k)&&T.push(...x.get(k))}let M=a.get(h);for(;M;){const k=x.get(M),F=k.every(X=>_.get(X)==="on"),q=k.every(X=>!_.has(X)||_.get(X)==="off");_.set(M,F?"on":q?"off":"indeterminate"),M=a.get(M)}return e&&!m&&Array.from(_.entries()).reduce((F,q)=>{let[X,re]=q;return re==="on"?[...F,X]:F},[]).length===0?I:_},in:(l,h,m)=>{let _=new Map;for(const x of l||[])_=s.select({id:x,value:!0,selected:new Map(_),children:h,parents:m});return _},out:(l,h)=>{const m=[];for(const[_,x]of l.entries())x==="on"&&!h.has(_)&&m.push(_);return m}};return s},Du=Symbol.for("vuetify:nested"),fb={id:bn(),root:{register:()=>null,unregister:()=>null,parents:Kt(new Map),children:Kt(new Map),open:()=>null,openOnSelect:()=>null,select:()=>null,opened:Kt(new Set),selected:Kt(new Map),selectedValues:Kt([])}},UA=Bt({selectStrategy:[String,Function],openStrategy:[String,Object],opened:Array,selected:Array,mandatory:Boolean},"nested"),NA=e=>{let s=!1;const l=Kt(new Map),h=Kt(new Map),m=fi(e,"opened",e.opened,k=>new Set(k),k=>[...k.values()]),_=we(()=>{if(typeof e.selectStrategy=="object")return e.selectStrategy;switch(e.selectStrategy){case"single-leaf":return VA(e.mandatory);case"leaf":return OA(e.mandatory);case"independent":return xg(e.mandatory);case"single-independent":return db(e.mandatory);case"classic":default:return $A(e.mandatory)}}),x=we(()=>{if(typeof e.openStrategy=="object")return e.openStrategy;switch(e.openStrategy){case"list":return FA;case"single":return BA;case"multiple":default:return hb}}),a=fi(e,"selected",e.selected,k=>_.value.in(k,l.value,h.value),k=>_.value.out(k,l.value,h.value));oo(()=>{s=!0});function I(k){const F=[];let q=k;for(;q!=null;)F.unshift(q),q=h.value.get(q);return F}const T=fr("nested"),M={id:bn(),root:{opened:m,selected:a,selectedValues:we(()=>{const k=[];for(const[F,q]of a.value.entries())q==="on"&&k.push(F);return k}),register:(k,F,q)=>{F&&k!==F&&h.value.set(k,F),q&&l.value.set(k,[]),F!=null&&l.value.set(F,[...l.value.get(F)||[],k])},unregister:k=>{if(s)return;l.value.delete(k);const F=h.value.get(k);if(F){const q=l.value.get(F)??[];l.value.set(F,q.filter(X=>X!==k))}h.value.delete(k),m.value.delete(k)},open:(k,F,q)=>{T.emit("click:open",{id:k,value:F,path:I(k),event:q});const X=x.value.open({id:k,value:F,opened:new Set(m.value),children:l.value,parents:h.value,event:q});X&&(m.value=X)},openOnSelect:(k,F,q)=>{const X=x.value.select({id:k,value:F,selected:new Map(a.value),opened:new Set(m.value),children:l.value,parents:h.value,event:q});X&&(m.value=X)},select:(k,F,q)=>{T.emit("click:select",{id:k,value:F,path:I(k),event:q});const X=_.value.select({id:k,value:F,selected:new Map(a.value),children:l.value,parents:h.value,event:q});X&&(a.value=X),M.root.openOnSelect(k,F,q)},children:l,parents:h}};return Qi(Du,M),M.root},pb=(e,s)=>{const l=Zn(Du,fb),h=Symbol(vs()),m=we(()=>e.value!==void 0?e.value:h),_={...l,id:m,open:(x,a)=>l.root.open(m.value,x,a),openOnSelect:(x,a)=>l.root.openOnSelect(m.value,x,a),isOpen:we(()=>l.root.opened.value.has(m.value)),parent:we(()=>l.root.parents.value.get(m.value)),select:(x,a)=>l.root.select(m.value,x,a),isSelected:we(()=>l.root.selected.value.get(rn(m.value))==="on"),isIndeterminate:we(()=>l.root.selected.value.get(m.value)==="indeterminate"),isLeaf:we(()=>!l.root.children.value.get(m.value)),isGroupActivator:l.isGroupActivator};return!l.isGroupActivator&&l.root.register(m.value,l.id.value,s),oo(()=>{!l.isGroupActivator&&l.root.unregister(m.value)}),s&&Qi(Du,_),_},jA=()=>{const e=Zn(Du,fb);Qi(Du,{...e,isGroupActivator:!0})};function qA(){const e=bn(!1);return Ca(()=>{window.requestAnimationFrame(()=>{e.value=!0})}),{ssrBootStyles:we(()=>e.value?void 0:{transition:"none !important"}),isBooted:Ru(e)}}const ZA=Zl({name:"VListGroupActivator",setup(e,s){let{slots:l}=s;return jA(),()=>{var h;return(h=l.default)==null?void 0:h.call(l)}}}),GA=Bt({activeColor:String,baseColor:String,color:String,collapseIcon:{type:_i,default:"$collapse"},expandIcon:{type:_i,default:"$expand"},prependIcon:_i,appendIcon:_i,fluid:Boolean,subgroup:Boolean,title:String,value:null,...ei(),...Os()},"VListGroup"),Ev=Sn()({name:"VListGroup",props:GA(),setup(e,s){let{slots:l}=s;const{isOpen:h,open:m,id:_}=pb(xn(e,"value"),!0),x=we(()=>`v-list-group--id-${String(_.value)}`),a=ub(),{isBooted:I}=qA();function T(q){m(!h.value,q)}const M=we(()=>({onClick:T,class:"v-list-group__header",id:x.value})),k=we(()=>h.value?e.collapseIcon:e.expandIcon),F=we(()=>({VListItem:{active:h.value,activeColor:e.activeColor,baseColor:e.baseColor,color:e.color,prependIcon:e.prependIcon||e.subgroup&&k.value,appendIcon:e.appendIcon||!e.subgroup&&k.value,title:e.title,value:e.value}}));return $n(()=>ae(e.tag,{class:["v-list-group",{"v-list-group--prepend":a==null?void 0:a.hasPrepend.value,"v-list-group--fluid":e.fluid,"v-list-group--subgroup":e.subgroup,"v-list-group--open":h.value},e.class],style:e.style},{default:()=>[l.activator&&ae(zs,{defaults:F.value},{default:()=>[ae(ZA,null,{default:()=>[l.activator({props:M.value,isOpen:h.value})]})]}),ae(zo,{transition:{component:BI},disabled:!I.value},{default:()=>{var q;return[Ur(ae("div",{class:"v-list-group__items",role:"group","aria-labelledby":x.value},[(q=l.default)==null?void 0:q.call(l)]),[[jl,h.value]])]}})]})),{}}});const WA=h0("v-list-item-subtitle"),HA=h0("v-list-item-title"),XA=Bt({active:{type:Boolean,default:void 0},activeClass:String,activeColor:String,appendAvatar:String,appendIcon:_i,baseColor:String,disabled:Boolean,lines:String,link:{type:Boolean,default:void 0},nav:Boolean,prependAvatar:String,prependIcon:_i,ripple:{type:[Boolean,Object],default:!0},subtitle:[String,Number,Boolean],title:[String,Number,Boolean],value:null,onClick:Rs(),onClickOnce:Rs(),...gg(),...ei(),...Hl(),...Jd(),..._g(),...Kl(),...ab(),...Os(),...Ar(),...$u({variant:"text"})},"VListItem"),Bl=Sn()({name:"VListItem",directives:{Ripple:dg},props:XA(),emits:{click:e=>!0},setup(e,s){let{attrs:l,slots:h,emit:m}=s;const _=ob(e,l),x=we(()=>e.value===void 0?_.href.value:e.value),{select:a,isSelected:I,isIndeterminate:T,isGroupActivator:M,root:k,parent:F,openOnSelect:q}=pb(x,!1),X=ub(),re=we(()=>{var Ve;return e.active!==!1&&(e.active||((Ve=_.isActive)==null?void 0:Ve.value)||I.value)}),me=we(()=>e.link!==!1&&_.isLink.value),ye=we(()=>!e.disabled&&e.link!==!1&&(e.link||_.isClickable.value||e.value!=null&&!!X)),Ee=we(()=>e.rounded||e.nav),be=we(()=>e.color??e.activeColor),Oe=we(()=>({color:re.value?be.value??e.baseColor:e.baseColor,variant:e.variant}));wn(()=>{var Ve;return(Ve=_.isActive)==null?void 0:Ve.value},Ve=>{Ve&&F.value!=null&&k.open(F.value,!0),Ve&&q(Ve)},{immediate:!0});const{themeClasses:Qe}=is(e),{borderClasses:Ue}=yg(e),{colorClasses:ze,colorStyles:j,variantClasses:G}=mg(Oe),{densityClasses:pe}=Xl(e),{dimensionStyles:Se}=Qd(e),{elevationClasses:Ce}=vg(e),{roundedClasses:_e}=Yl(Ee),Fe=we(()=>e.lines?`v-list-item--${e.lines}-line`:void 0),ut=we(()=>({isActive:re.value,select:a,isSelected:I.value,isIndeterminate:T.value}));function at(Ve){var Ge;m("click",Ve),!(M||!ye.value)&&((Ge=_.navigate)==null||Ge.call(_,Ve),e.value!=null&&a(!I.value,Ve))}function je(Ve){(Ve.key==="Enter"||Ve.key===" ")&&(Ve.preventDefault(),at(Ve))}return $n(()=>{const Ve=me.value?"a":e.tag,Ge=h.title||e.title,Tt=h.subtitle||e.subtitle,At=!!(e.appendAvatar||e.appendIcon),rt=!!(At||h.append),It=!!(e.prependAvatar||e.prependIcon),Gt=!!(It||h.prepend);return X==null||X.updateHasPrepend(Gt),e.activeColor&&CC("active-color",["color","base-color"]),Ur(ae(Ve,{class:["v-list-item",{"v-list-item--active":re.value,"v-list-item--disabled":e.disabled,"v-list-item--link":ye.value,"v-list-item--nav":e.nav,"v-list-item--prepend":!Gt&&(X==null?void 0:X.hasPrepend.value),[`${e.activeClass}`]:e.activeClass&&re.value},Qe.value,Ue.value,ze.value,pe.value,Ce.value,Fe.value,_e.value,G.value,e.class],style:[j.value,Se.value,e.style],href:_.href.value,tabindex:ye.value?X?-2:0:void 0,onClick:at,onKeydown:ye.value&&!me.value&&je},{default:()=>{var Rt;return[pg(ye.value||re.value,"v-list-item"),Gt&&ae("div",{key:"prepend",class:"v-list-item__prepend"},[h.prepend?ae(zs,{key:"prepend-defaults",disabled:!It,defaults:{VAvatar:{density:e.density,image:e.prependAvatar},VIcon:{density:e.density,icon:e.prependIcon},VListItemAction:{start:!0}}},{default:()=>{var Ne;return[(Ne=h.prepend)==null?void 0:Ne.call(h,ut.value)]}}):ae(mn,null,[e.prependAvatar&&ae(Td,{key:"prepend-avatar",density:e.density,image:e.prependAvatar},null),e.prependIcon&&ae($r,{key:"prepend-icon",density:e.density,icon:e.prependIcon},null)])]),ae("div",{class:"v-list-item__content","data-no-activator":""},[Ge&&ae(HA,{key:"title"},{default:()=>{var Ne;return[((Ne=h.title)==null?void 0:Ne.call(h,{title:e.title}))??e.title]}}),Tt&&ae(WA,{key:"subtitle"},{default:()=>{var Ne;return[((Ne=h.subtitle)==null?void 0:Ne.call(h,{subtitle:e.subtitle}))??e.subtitle]}}),(Rt=h.default)==null?void 0:Rt.call(h,ut.value)]),rt&&ae("div",{key:"append",class:"v-list-item__append"},[h.append?ae(zs,{key:"append-defaults",disabled:!At,defaults:{VAvatar:{density:e.density,image:e.appendAvatar},VIcon:{density:e.density,icon:e.appendIcon},VListItemAction:{end:!0}}},{default:()=>{var Ne;return[(Ne=h.append)==null?void 0:Ne.call(h,ut.value)]}}):ae(mn,null,[e.appendIcon&&ae($r,{key:"append-icon",density:e.density,icon:e.appendIcon},null),e.appendAvatar&&ae(Td,{key:"append-avatar",density:e.density,image:e.appendAvatar},null)])])]}}),[[wa("ripple"),ye.value&&e.ripple]])}),{}}}),KA=Bt({color:String,inset:Boolean,sticky:Boolean,title:String,...ei(),...Os()},"VListSubheader"),YA=Sn()({name:"VListSubheader",props:KA(),setup(e,s){let{slots:l}=s;const{textColorClasses:h,textColorStyles:m}=Fs(xn(e,"color"));return $n(()=>{const _=!!(l.default||e.title);return ae(e.tag,{class:["v-list-subheader",{"v-list-subheader--inset":e.inset,"v-list-subheader--sticky":e.sticky},h.value,e.class],style:[{textColorStyles:m},e.style]},{default:()=>{var x;return[_&&ae("div",{class:"v-list-subheader__text"},[((x=l.default)==null?void 0:x.call(l))??e.title])]}})}),{}}});const JA=Bt({color:String,inset:Boolean,length:[Number,String],thickness:[Number,String],vertical:Boolean,...ei(),...Ar()},"VDivider"),QA=Sn()({name:"VDivider",props:JA(),setup(e,s){let{attrs:l}=s;const{themeClasses:h}=is(e),{textColorClasses:m,textColorStyles:_}=Fs(xn(e,"color")),x=we(()=>{const a={};return e.length&&(a[e.vertical?"maxHeight":"maxWidth"]=pn(e.length)),e.thickness&&(a[e.vertical?"borderRightWidth":"borderTopWidth"]=pn(e.thickness)),a});return $n(()=>ae("hr",{class:[{"v-divider":!0,"v-divider--inset":e.inset,"v-divider--vertical":e.vertical},h.value,m.value,e.class],style:[x.value,_.value,e.style],"aria-orientation":!l.role||l.role==="separator"?e.vertical?"vertical":"horizontal":void 0,role:`${l.role||"separator"}`},null)),{}}}),eP=Bt({items:Array},"VListChildren"),mb=Sn()({name:"VListChildren",props:eP(),setup(e,s){let{slots:l}=s;return cb(),()=>{var h,m;return((h=l.default)==null?void 0:h.call(l))??((m=e.items)==null?void 0:m.map(_=>{var q,X;let{children:x,props:a,type:I,raw:T}=_;if(I==="divider")return((q=l.divider)==null?void 0:q.call(l,{props:a}))??ae(QA,a,null);if(I==="subheader")return((X=l.subheader)==null?void 0:X.call(l,{props:a}))??ae(YA,a,null);const M={subtitle:l.subtitle?re=>{var me;return(me=l.subtitle)==null?void 0:me.call(l,{...re,item:T})}:void 0,prepend:l.prepend?re=>{var me;return(me=l.prepend)==null?void 0:me.call(l,{...re,item:T})}:void 0,append:l.append?re=>{var me;return(me=l.append)==null?void 0:me.call(l,{...re,item:T})}:void 0,title:l.title?re=>{var me;return(me=l.title)==null?void 0:me.call(l,{...re,item:T})}:void 0},[k,F]=Ev.filterProps(a);return x?ae(Ev,In({value:a==null?void 0:a.value},k),{activator:re=>{let{props:me}=re;return l.header?l.header({props:{...a,...me}}):ae(Bl,In(a,me),M)},default:()=>ae(mb,{items:x},l)}):l.item?l.item({props:a}):ae(Bl,a,M)}))}}}),gb=Bt({items:{type:Array,default:()=>[]},itemTitle:{type:[String,Array,Function],default:"title"},itemValue:{type:[String,Array,Function],default:"value"},itemChildren:{type:[Boolean,String,Array,Function],default:"children"},itemProps:{type:[Boolean,String,Array,Function],default:"props"},returnObject:Boolean},"list-items");function yb(e,s){const l=Ds(s,e.itemTitle,s),h=e.returnObject?s:Ds(s,e.itemValue,l),m=Ds(s,e.itemChildren),_=e.itemProps===!0?typeof s=="object"&&s!=null&&!Array.isArray(s)?"children"in s?Fu(s,["children"])[1]:s:void 0:Ds(s,e.itemProps),x={title:l,value:h,..._};return{title:String(x.title??""),value:x.value,props:x,children:Array.isArray(m)?_b(e,m):void 0,raw:s}}function _b(e,s){const l=[];for(const h of s)l.push(yb(e,h));return l}function vb(e){const s=we(()=>_b(e,e.items));return tP(s,l=>yb(e,l))}function tP(e,s){function l(m){return m.filter(_=>_!==null||e.value.some(x=>x.value===null)).map(_=>e.value.find(a=>ql(_,a.value))??s(_))}function h(m){return m.map(_=>{let{value:x}=_;return x})}return{items:e,transformIn:l,transformOut:h}}function nP(e){return typeof e=="string"||typeof e=="number"||typeof e=="boolean"}function iP(e,s){const l=Ds(s,e.itemType,"item"),h=nP(s)?s:Ds(s,e.itemTitle),m=Ds(s,e.itemValue,void 0),_=Ds(s,e.itemChildren),x=e.itemProps===!0?Fu(s,["children"])[1]:Ds(s,e.itemProps),a={title:h,value:m,...x};return{type:l,title:a.title,value:a.value,props:a,children:l==="item"&&_?xb(e,_):void 0,raw:s}}function xb(e,s){const l=[];for(const h of s)l.push(iP(e,h));return l}function rP(e){return{items:we(()=>xb(e,e.items))}}const sP=Bt({baseColor:String,activeColor:String,activeClass:String,bgColor:String,disabled:Boolean,lines:{type:[Boolean,String],default:"one"},nav:Boolean,...UA({selectStrategy:"single-leaf",openStrategy:"list"}),...gg(),...ei(),...Hl(),...Jd(),..._g(),itemType:{type:String,default:"type"},...gb(),...Kl(),...Os(),...Ar(),...$u({variant:"text"})},"VList"),bb=Sn()({name:"VList",props:sP(),emits:{"update:selected":e=>!0,"update:opened":e=>!0,"click:open":e=>!0,"click:select":e=>!0},setup(e,s){let{slots:l}=s;const{items:h}=rP(e),{themeClasses:m}=is(e),{backgroundColorClasses:_,backgroundColorStyles:x}=Pu(xn(e,"bgColor")),{borderClasses:a}=yg(e),{densityClasses:I}=Xl(e),{dimensionStyles:T}=Qd(e),{elevationClasses:M}=vg(e),{roundedClasses:k}=Yl(e),{open:F,select:q}=NA(e),X=we(()=>e.lines?`v-list--${e.lines}-line`:void 0),re=xn(e,"activeColor"),me=xn(e,"baseColor"),ye=xn(e,"color");cb(),Ou({VListGroup:{activeColor:re,baseColor:me,color:ye},VListItem:{activeClass:xn(e,"activeClass"),activeColor:re,baseColor:me,color:ye,density:xn(e,"density"),disabled:xn(e,"disabled"),lines:xn(e,"lines"),nav:xn(e,"nav"),variant:xn(e,"variant")}});const Ee=bn(!1),be=Kt();function Oe(G){Ee.value=!0}function Qe(G){Ee.value=!1}function Ue(G){var pe;!Ee.value&&!(G.relatedTarget&&((pe=be.value)!=null&&pe.contains(G.relatedTarget)))&&j()}function ze(G){if(be.value){if(G.key==="ArrowDown")j("next");else if(G.key==="ArrowUp")j("prev");else if(G.key==="Home")j("first");else if(G.key==="End")j("last");else return;G.preventDefault()}}function j(G){if(be.value)return md(be.value,G)}return $n(()=>ae(e.tag,{ref:be,class:["v-list",{"v-list--disabled":e.disabled,"v-list--nav":e.nav},m.value,_.value,a.value,I.value,M.value,X.value,k.value,e.class],style:[x.value,T.value,e.style],tabindex:e.disabled||Ee.value?-1:0,role:"listbox","aria-activedescendant":void 0,onFocusin:Oe,onFocusout:Qe,onFocus:Ue,onKeydown:ze},{default:()=>[ae(mb,{items:h.value},l)]})),{open:F,select:q,focus:j}}});function Ep(e,s){return{x:e.x+s.x,y:e.y+s.y}}function oP(e,s){return{x:e.x-s.x,y:e.y-s.y}}function Tv(e,s){if(e.side==="top"||e.side==="bottom"){const{side:l,align:h}=e,m=h==="left"?0:h==="center"?s.width/2:h==="right"?s.width:h,_=l==="top"?0:l==="bottom"?s.height:l;return Ep({x:m,y:_},s)}else if(e.side==="left"||e.side==="right"){const{side:l,align:h}=e,m=l==="left"?0:l==="right"?s.width:l,_=h==="top"?0:h==="center"?s.height/2:h==="bottom"?s.height:h;return Ep({x:m,y:_},s)}return Ep({x:s.width/2,y:s.height/2},s)}const wb={static:cP,connected:hP},aP=Bt({locationStrategy:{type:[String,Function],default:"static",validator:e=>typeof e=="function"||e in wb},location:{type:String,default:"bottom"},origin:{type:String,default:"auto"},offset:[Number,String,Array]},"VOverlay-location-strategies");function lP(e,s){const l=Kt({}),h=Kt();Mi&&(Sa(()=>!!(s.isActive.value&&e.locationStrategy),_=>{var x,a;wn(()=>e.locationStrategy,_),Tr(()=>{h.value=void 0}),typeof e.locationStrategy=="function"?h.value=(x=e.locationStrategy(s,e,l))==null?void 0:x.updateLocation:h.value=(a=wb[e.locationStrategy](s,e,l))==null?void 0:a.updateLocation}),window.addEventListener("resize",m,{passive:!0}),Tr(()=>{window.removeEventListener("resize",m),h.value=void 0}));function m(_){var x;(x=h.value)==null||x.call(h,_)}return{contentStyles:l,updateLocation:h}}function cP(){}function uP(e,s){const l=Ym(e);return s?l.x+=parseFloat(e.style.right||0):l.x-=parseFloat(e.style.left||0),l.y-=parseFloat(e.style.top||0),l}function hP(e,s,l){jC(e.activatorEl.value)&&Object.assign(l.value,{position:"fixed",top:0,[e.isRtl.value?"right":"left"]:0});const{preferredAnchor:m,preferredOrigin:_}=Xm(()=>{const X=Jp(s.location,e.isRtl.value),re=s.origin==="overlap"?X:s.origin==="auto"?bp(X):Jp(s.origin,e.isRtl.value);return X.side===re.side&&X.align===wp(re).align?{preferredAnchor:Z_(X),preferredOrigin:Z_(re)}:{preferredAnchor:X,preferredOrigin:re}}),[x,a,I,T]=["minWidth","minHeight","maxWidth","maxHeight"].map(X=>we(()=>{const re=parseFloat(s[X]);return isNaN(re)?1/0:re})),M=we(()=>{if(Array.isArray(s.offset))return s.offset;if(typeof s.offset=="string"){const X=s.offset.split(" ").map(parseFloat);return X.length<2&&X.push(0),X}return typeof s.offset=="number"?[s.offset,0]:[0,0]});let k=!1;const F=new ResizeObserver(()=>{k&&q()});wn([e.activatorEl,e.contentEl],(X,re)=>{let[me,ye]=X,[Ee,be]=re;Ee&&F.unobserve(Ee),me&&F.observe(me),be&&F.unobserve(be),ye&&F.observe(ye)},{immediate:!0}),Tr(()=>{F.disconnect()});function q(){if(k=!1,requestAnimationFrame(()=>{requestAnimationFrame(()=>k=!0)}),!e.activatorEl.value||!e.contentEl.value)return;const X=e.activatorEl.value.getBoundingClientRect(),re=uP(e.contentEl.value,e.isRtl.value),me=_d(e.contentEl.value),ye=12;me.length||(me.push(document.documentElement),e.contentEl.value.style.top&&e.contentEl.value.style.left||(re.x-=parseFloat(document.documentElement.style.getPropertyValue("--v-body-scroll-x")||0),re.y-=parseFloat(document.documentElement.style.getPropertyValue("--v-body-scroll-y")||0)));const Ee=me.reduce((Se,Ce)=>{const _e=Ce.getBoundingClientRect(),Fe=new zl({x:Ce===document.documentElement?0:_e.x,y:Ce===document.documentElement?0:_e.y,width:Ce.clientWidth,height:Ce.clientHeight});return Se?new zl({x:Math.max(Se.left,Fe.left),y:Math.max(Se.top,Fe.top),width:Math.min(Se.right,Fe.right)-Math.max(Se.left,Fe.left),height:Math.min(Se.bottom,Fe.bottom)-Math.max(Se.top,Fe.top)}):Fe},void 0);Ee.x+=ye,Ee.y+=ye,Ee.width-=ye*2,Ee.height-=ye*2;let be={anchor:m.value,origin:_.value};function Oe(Se){const Ce=new zl(re),_e=Tv(Se.anchor,X),Fe=Tv(Se.origin,Ce);let{x:ut,y:at}=oP(_e,Fe);switch(Se.anchor.side){case"top":at-=M.value[0];break;case"bottom":at+=M.value[0];break;case"left":ut-=M.value[0];break;case"right":ut+=M.value[0];break}switch(Se.anchor.align){case"top":at-=M.value[1];break;case"bottom":at+=M.value[1];break;case"left":ut-=M.value[1];break;case"right":ut+=M.value[1];break}return Ce.x+=ut,Ce.y+=at,Ce.width=Math.min(Ce.width,I.value),Ce.height=Math.min(Ce.height,T.value),{overflows:W_(Ce,Ee),x:ut,y:at}}let Qe=0,Ue=0;const ze={x:0,y:0},j={x:!1,y:!1};let G=-1;for(;!(G++>10);){const{x:Se,y:Ce,overflows:_e}=Oe(be);Qe+=Se,Ue+=Ce,re.x+=Se,re.y+=Ce;{const Fe=G_(be.anchor),ut=_e.x.before||_e.x.after,at=_e.y.before||_e.y.after;let je=!1;if(["x","y"].forEach(Ve=>{if(Ve==="x"&&ut&&!j.x||Ve==="y"&&at&&!j.y){const Ge={anchor:{...be.anchor},origin:{...be.origin}},Tt=Ve==="x"?Fe==="y"?wp:bp:Fe==="y"?bp:wp;Ge.anchor=Tt(Ge.anchor),Ge.origin=Tt(Ge.origin);const{overflows:At}=Oe(Ge);(At[Ve].before<=_e[Ve].before&&At[Ve].after<=_e[Ve].after||At[Ve].before+At[Ve].after<(_e[Ve].before+_e[Ve].after)/2)&&(be=Ge,je=j[Ve]=!0)}}),je)continue}_e.x.before&&(Qe+=_e.x.before,re.x+=_e.x.before),_e.x.after&&(Qe-=_e.x.after,re.x-=_e.x.after),_e.y.before&&(Ue+=_e.y.before,re.y+=_e.y.before),_e.y.after&&(Ue-=_e.y.after,re.y-=_e.y.after);{const Fe=W_(re,Ee);ze.x=Ee.width-Fe.x.before-Fe.x.after,ze.y=Ee.height-Fe.y.before-Fe.y.after,Qe+=Fe.x.before,re.x+=Fe.x.before,Ue+=Fe.y.before,re.y+=Fe.y.before}break}const pe=G_(be.anchor);return Object.assign(l.value,{"--v-overlay-anchor-origin":`${be.anchor.side} ${be.anchor.align}`,transformOrigin:`${be.origin.side} ${be.origin.align}`,top:pn(Tp(Ue)),left:e.isRtl.value?void 0:pn(Tp(Qe)),right:e.isRtl.value?pn(Tp(-Qe)):void 0,minWidth:pn(pe==="y"?Math.min(x.value,X.width):x.value),maxWidth:pn(Iv(Yp(ze.x,x.value===1/0?0:x.value,I.value))),maxHeight:pn(Iv(Yp(ze.y,a.value===1/0?0:a.value,T.value)))}),{available:ze,contentBox:re}}return wn(()=>[m.value,_.value,s.offset,s.minWidth,s.minHeight,s.maxWidth,s.maxHeight],()=>q()),er(()=>{const X=q();if(!X)return;const{available:re,contentBox:me}=X;me.height>re.y&&requestAnimationFrame(()=>{q(),requestAnimationFrame(()=>{q()})})}),{updateLocation:q}}function Tp(e){return Math.round(e*devicePixelRatio)/devicePixelRatio}function Iv(e){return Math.ceil(e*devicePixelRatio)/devicePixelRatio}let um=!0;const Id=[];function dP(e){!um||Id.length?(Id.push(e),hm()):(um=!1,e(),hm())}let Av=-1;function hm(){cancelAnimationFrame(Av),Av=requestAnimationFrame(()=>{const e=Id.shift();e&&e(),Id.length?hm():um=!0})}const ld={none:null,close:mP,block:gP,reposition:yP},fP=Bt({scrollStrategy:{type:[String,Function],default:"block",validator:e=>typeof e=="function"||e in ld}},"VOverlay-scroll-strategies");function pP(e,s){if(!Mi)return;let l;ro(async()=>{l==null||l.stop(),s.isActive.value&&e.scrollStrategy&&(l=Lu(),await er(),l.active&&l.run(()=>{var h;typeof e.scrollStrategy=="function"?e.scrollStrategy(s,e,l):(h=ld[e.scrollStrategy])==null||h.call(ld,s,e,l)}))}),Tr(()=>{l==null||l.stop()})}function mP(e){function s(l){e.isActive.value=!1}Sb(e.activatorEl.value??e.contentEl.value,s)}function gP(e,s){var x;const l=(x=e.root.value)==null?void 0:x.offsetParent,h=[...new Set([..._d(e.activatorEl.value,s.contained?l:void 0),..._d(e.contentEl.value,s.contained?l:void 0)])].filter(a=>!a.classList.contains("v-overlay-scroll-blocked")),m=window.innerWidth-document.documentElement.offsetWidth,_=(a=>Qm(a)&&a)(l||document.documentElement);_&&e.root.value.classList.add("v-overlay--scroll-blocked"),h.forEach((a,I)=>{a.style.setProperty("--v-body-scroll-x",pn(-a.scrollLeft)),a.style.setProperty("--v-body-scroll-y",pn(-a.scrollTop)),a.style.setProperty("--v-scrollbar-offset",pn(m)),a.classList.add("v-overlay-scroll-blocked")}),Tr(()=>{h.forEach((a,I)=>{const T=parseFloat(a.style.getPropertyValue("--v-body-scroll-x")),M=parseFloat(a.style.getPropertyValue("--v-body-scroll-y"));a.style.removeProperty("--v-body-scroll-x"),a.style.removeProperty("--v-body-scroll-y"),a.style.removeProperty("--v-scrollbar-offset"),a.classList.remove("v-overlay-scroll-blocked"),a.scrollLeft=-T,a.scrollTop=-M}),_&&e.root.value.classList.remove("v-overlay--scroll-blocked")})}function yP(e,s,l){let h=!1,m=-1,_=-1;function x(a){dP(()=>{var M,k;const I=performance.now();(k=(M=e.updateLocation).value)==null||k.call(M,a),h=(performance.now()-I)/(1e3/60)>2})}_=(typeof requestIdleCallback>"u"?a=>a():requestIdleCallback)(()=>{l.run(()=>{Sb(e.activatorEl.value??e.contentEl.value,a=>{h?(cancelAnimationFrame(m),m=requestAnimationFrame(()=>{m=requestAnimationFrame(()=>{x(a)})})):x(a)})})}),Tr(()=>{typeof cancelIdleCallback<"u"&&cancelIdleCallback(_),cancelAnimationFrame(m)})}function Sb(e,s){const l=[document,..._d(e)];l.forEach(h=>{h.addEventListener("scroll",s,{passive:!0})}),Tr(()=>{l.forEach(h=>{h.removeEventListener("scroll",s)})})}const dm=Symbol.for("vuetify:v-menu"),_P=Bt({closeDelay:[Number,String],openDelay:[Number,String]},"delay");function vP(e,s){const l={},h=m=>()=>{if(!Mi)return Promise.resolve(!0);const _=m==="openDelay";return l.closeDelay&&window.clearTimeout(l.closeDelay),delete l.closeDelay,l.openDelay&&window.clearTimeout(l.openDelay),delete l.openDelay,new Promise(x=>{const a=parseInt(e[m]??0,10);l[m]=window.setTimeout(()=>{s==null||s(_),x(_)},a)})};return{runCloseDelay:h("closeDelay"),runOpenDelay:h("openDelay")}}const xP=Bt({activator:[String,Object],activatorProps:{type:Object,default:()=>({})},openOnClick:{type:Boolean,default:void 0},openOnHover:Boolean,openOnFocus:{type:Boolean,default:void 0},closeOnContentClick:Boolean,..._P()},"VOverlay-activator");function bP(e,s){let{isActive:l,isTop:h}=s;const m=Kt();let _=!1,x=!1,a=!0;const I=we(()=>e.openOnFocus||e.openOnFocus==null&&e.openOnHover),T=we(()=>e.openOnClick||e.openOnClick==null&&!e.openOnHover&&!I.value),{runOpenDelay:M,runCloseDelay:k}=vP(e,be=>{be===(e.openOnHover&&_||I.value&&x)&&!(e.openOnHover&&l.value&&!h.value)&&(l.value!==be&&(a=!0),l.value=be)}),F={onClick:be=>{be.stopPropagation(),m.value=be.currentTarget||be.target,l.value=!l.value},onMouseenter:be=>{var Oe;(Oe=be.sourceCapabilities)!=null&&Oe.firesTouchEvents||(_=!0,m.value=be.currentTarget||be.target,M())},onMouseleave:be=>{_=!1,k()},onFocus:be=>{Qp&&!be.target.matches(":focus-visible")||(x=!0,be.stopPropagation(),m.value=be.currentTarget||be.target,M())},onBlur:be=>{x=!1,be.stopPropagation(),k()}},q=we(()=>{const be={};return T.value&&(be.onClick=F.onClick),e.openOnHover&&(be.onMouseenter=F.onMouseenter,be.onMouseleave=F.onMouseleave),I.value&&(be.onFocus=F.onFocus,be.onBlur=F.onBlur),be}),X=we(()=>{const be={};if(e.openOnHover&&(be.onMouseenter=()=>{_=!0,M()},be.onMouseleave=()=>{_=!1,k()}),I.value&&(be.onFocusin=()=>{x=!0,M()},be.onFocusout=()=>{x=!1,k()}),e.closeOnContentClick){const Oe=Zn(dm,null);be.onClick=()=>{l.value=!1,Oe==null||Oe.closeParents()}}return be}),re=we(()=>{const be={};return e.openOnHover&&(be.onMouseenter=()=>{a&&(_=!0,a=!1,M())},be.onMouseleave=()=>{_=!1,k()}),be});wn(h,be=>{be&&(e.openOnHover&&!_&&(!I.value||!x)||I.value&&!x&&(!e.openOnHover||!_))&&(l.value=!1)});const me=Kt();ro(()=>{me.value&&er(()=>{m.value=Kp(me.value)})});const ye=fr("useActivator");let Ee;return wn(()=>!!e.activator,be=>{be&&Mi?(Ee=Lu(),Ee.run(()=>{wP(e,ye,{activatorEl:m,activatorEvents:q})})):Ee&&Ee.stop()},{flush:"post",immediate:!0}),Tr(()=>{Ee==null||Ee.stop()}),{activatorEl:m,activatorRef:me,activatorEvents:q,contentEvents:X,scrimEvents:re}}function wP(e,s,l){let{activatorEl:h,activatorEvents:m}=l;wn(()=>e.activator,(I,T)=>{if(T&&I!==T){const M=a(T);M&&x(M)}I&&er(()=>_())},{immediate:!0}),wn(()=>e.activatorProps,()=>{_()}),Tr(()=>{x()});function _(){let I=arguments.length>0&&arguments[0]!==void 0?arguments[0]:a(),T=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e.activatorProps;I&&wC(I,In(m.value,T))}function x(){let I=arguments.length>0&&arguments[0]!==void 0?arguments[0]:a(),T=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e.activatorProps;I&&SC(I,In(m.value,T))}function a(){var M,k;let I=arguments.length>0&&arguments[0]!==void 0?arguments[0]:e.activator,T;if(I)if(I==="parent"){let F=(k=(M=s==null?void 0:s.proxy)==null?void 0:M.$el)==null?void 0:k.parentNode;for(;F.hasAttribute("data-no-activator");)F=F.parentNode;T=F}else typeof I=="string"?T=document.querySelector(I):"$el"in I?T=I.$el:T=I;return h.value=(T==null?void 0:T.nodeType)===Node.ELEMENT_NODE?T:null,h.value}}function SP(){if(!Mi)return bn(!1);const{ssr:e}=XC();if(e){const s=bn(!1);return Ca(()=>{s.value=!0}),s}else return bn(!0)}const CP=Bt({eager:Boolean},"lazy");function EP(e,s){const l=bn(!1),h=we(()=>l.value||e.eager||s.value);wn(s,()=>l.value=!0);function m(){e.eager||(l.value=!1)}return{isBooted:l,hasContent:h,onAfterLeave:m}}function Cb(){const s=fr("useScopeId").vnode.scopeId;return{scopeId:s?{[s]:""}:void 0}}const Pv=Symbol.for("vuetify:stack"),iu=Oi([]);function TP(e,s,l){const h=fr("useStack"),m=!l,_=Zn(Pv,void 0),x=Oi({activeChildren:new Set});Qi(Pv,x);const a=bn(+s.value);Sa(e,()=>{var k;const M=(k=iu.at(-1))==null?void 0:k[1];a.value=M?M+10:+s.value,m&&iu.push([h.uid,a.value]),_==null||_.activeChildren.add(h.uid),Tr(()=>{if(m){const F=rn(iu).findIndex(q=>q[0]===h.uid);iu.splice(F,1)}_==null||_.activeChildren.delete(h.uid)})});const I=bn(!0);m&&ro(()=>{var k;const M=((k=iu.at(-1))==null?void 0:k[0])===h.uid;setTimeout(()=>I.value=M)});const T=we(()=>!x.activeChildren.size);return{globalTop:Ru(I),localTop:T,stackStyles:we(()=>({zIndex:a.value}))}}function IP(e){return{teleportTarget:we(()=>{const l=e.value;if(l===!0||!Mi)return;const h=l===!1?document.body:typeof l=="string"?document.querySelector(l):l;if(h==null)return;let m=h.querySelector(":scope > .v-overlay-container");return m||(m=document.createElement("div"),m.className="v-overlay-container",h.appendChild(m)),m})}}function AP(){return!0}function Eb(e,s,l){if(!e||Tb(e,l)===!1)return!1;const h=d0(s);if(typeof ShadowRoot<"u"&&h instanceof ShadowRoot&&h.host===e.target)return!1;const m=(typeof l.value=="object"&&l.value.include||(()=>[]))();return m.push(s),!m.some(_=>_==null?void 0:_.contains(e.target))}function Tb(e,s){return(typeof s.value=="object"&&s.value.closeConditional||AP)(e)}function PP(e,s,l){const h=typeof l.value=="function"?l.value:l.value.handler;s._clickOutside.lastMousedownWasOutside&&Eb(e,s,l)&&setTimeout(()=>{Tb(e,l)&&h&&h(e)},0)}function kv(e,s){const l=d0(e);s(document),typeof ShadowRoot<"u"&&l instanceof ShadowRoot&&s(l)}const kP={mounted(e,s){const l=m=>PP(m,e,s),h=m=>{e._clickOutside.lastMousedownWasOutside=Eb(m,e,s)};kv(e,m=>{m.addEventListener("click",l,!0),m.addEventListener("mousedown",h,!0)}),e._clickOutside||(e._clickOutside={lastMousedownWasOutside:!1}),e._clickOutside[s.instance.$.uid]={onClick:l,onMousedown:h}},unmounted(e,s){e._clickOutside&&(kv(e,l=>{var _;if(!l||!((_=e._clickOutside)!=null&&_[s.instance.$.uid]))return;const{onClick:h,onMousedown:m}=e._clickOutside[s.instance.$.uid];l.removeEventListener("click",h,!0),l.removeEventListener("mousedown",m,!0)}),delete e._clickOutside[s.instance.$.uid])}};function MP(e){const{modelValue:s,color:l,...h}=e;return ae(to,{name:"fade-transition",appear:!0},{default:()=>[e.modelValue&&ae("div",In({class:["v-overlay__scrim",e.color.backgroundColorClasses.value],style:e.color.backgroundColorStyles.value},h),null)]})}const Ib=Bt({absolute:Boolean,attach:[Boolean,String,Object],closeOnBack:{type:Boolean,default:!0},contained:Boolean,contentClass:null,contentProps:null,disabled:Boolean,noClickAnimation:Boolean,modelValue:Boolean,persistent:Boolean,scrim:{type:[Boolean,String],default:!0},zIndex:{type:[Number,String],default:2e3},...xP(),...ei(),...Jd(),...CP(),...aP(),...fP(),...Ar(),...Wl()},"VOverlay"),Mv=Sn()({name:"VOverlay",directives:{ClickOutside:kP},inheritAttrs:!1,props:{_disableGlobalStack:Boolean,...Ib()},emits:{"click:outside":e=>!0,"update:modelValue":e=>!0,afterLeave:()=>!0},setup(e,s){let{slots:l,attrs:h,emit:m}=s;const _=fi(e,"modelValue"),x=we({get:()=>_.value,set:Ge=>{Ge&&e.disabled||(_.value=Ge)}}),{teleportTarget:a}=IP(we(()=>e.attach||e.contained)),{themeClasses:I}=is(e),{rtlClasses:T,isRtl:M}=Gl(),{hasContent:k,onAfterLeave:F}=EP(e,x),q=Pu(we(()=>typeof e.scrim=="string"?e.scrim:null)),{globalTop:X,localTop:re,stackStyles:me}=TP(x,xn(e,"zIndex"),e._disableGlobalStack),{activatorEl:ye,activatorRef:Ee,activatorEvents:be,contentEvents:Oe,scrimEvents:Qe}=bP(e,{isActive:x,isTop:re}),{dimensionStyles:Ue}=Qd(e),ze=SP(),{scopeId:j}=Cb();wn(()=>e.disabled,Ge=>{Ge&&(x.value=!1)});const G=Kt(),pe=Kt(),{contentStyles:Se,updateLocation:Ce}=lP(e,{isRtl:M,contentEl:pe,activatorEl:ye,isActive:x});pP(e,{root:G,contentEl:pe,activatorEl:ye,isActive:x,updateLocation:Ce});function _e(Ge){m("click:outside",Ge),e.persistent?Ve():x.value=!1}function Fe(){return x.value&&X.value}Mi&&wn(x,Ge=>{Ge?window.addEventListener("keydown",ut):window.removeEventListener("keydown",ut)},{immediate:!0});function ut(Ge){var Tt,At;Ge.key==="Escape"&&X.value&&(e.persistent?Ve():(x.value=!1,(Tt=pe.value)!=null&&Tt.contains(document.activeElement)&&((At=ye.value)==null||At.focus())))}const at=zA();Sa(()=>e.closeOnBack,()=>{LA(at,Ge=>{X.value&&x.value?(Ge(!1),e.persistent?Ve():x.value=!1):Ge()})});const je=Kt();wn(()=>x.value&&(e.absolute||e.contained)&&a.value==null,Ge=>{if(Ge){const Tt=$C(G.value);Tt&&Tt!==document.scrollingElement&&(je.value=Tt.scrollTop)}});function Ve(){e.noClickAnimation||pe.value&&Al(pe.value,[{transformOrigin:"center"},{transform:"scale(1.03)"},{transformOrigin:"center"}],{duration:150,easing:yd})}return $n(()=>{var Ge;return ae(mn,null,[(Ge=l.activator)==null?void 0:Ge.call(l,{isActive:x.value,props:In({ref:Ee},be.value,e.activatorProps)}),ze.value&&ae(gS,{disabled:!a.value,to:a.value},{default:()=>[k.value&&ae("div",In({class:["v-overlay",{"v-overlay--absolute":e.absolute||e.contained,"v-overlay--active":x.value,"v-overlay--contained":e.contained},I.value,T.value,e.class],style:[me.value,{top:pn(je.value)},e.style],ref:G},j,h),[ae(MP,In({color:q,modelValue:x.value&&!!e.scrim},Qe.value),null),ae(zo,{appear:!0,persisted:!0,transition:e.transition,target:ye.value,onAfterLeave:()=>{F(),m("afterLeave")}},{default:()=>{var Tt;return[Ur(ae("div",In({ref:pe,class:["v-overlay__content",e.contentClass],style:[Ue.value,Se.value]},Oe.value,e.contentProps),[(Tt=l.default)==null?void 0:Tt.call(l,{isActive:x})]),[[jl,x.value],[wa("click-outside"),{handler:_e,closeConditional:Fe,include:()=>[ye.value]}]])]}})])]})])}),{activatorEl:ye,animateClick:Ve,contentEl:pe,globalTop:X,localTop:re,updateLocation:Ce}}}),Ip=Symbol("Forwarded refs");function Ap(e,s){let l=e;for(;l;){const h=Reflect.getOwnPropertyDescriptor(l,s);if(h)return h;l=Object.getPrototypeOf(l)}}function ef(e){for(var s=arguments.length,l=new Array(s>1?s-1:0),h=1;h<s;h++)l[h-1]=arguments[h];return e[Ip]=l,new Proxy(e,{get(m,_){if(Reflect.has(m,_))return Reflect.get(m,_);if(!(typeof _=="symbol"||_.startsWith("__"))){for(const x of l)if(x.value&&Reflect.has(x.value,_)){const a=Reflect.get(x.value,_);return typeof a=="function"?a.bind(x.value):a}}},has(m,_){if(Reflect.has(m,_))return!0;if(typeof _=="symbol"||_.startsWith("__"))return!1;for(const x of l)if(x.value&&Reflect.has(x.value,_))return!0;return!1},getOwnPropertyDescriptor(m,_){var a;const x=Reflect.getOwnPropertyDescriptor(m,_);if(x)return x;if(!(typeof _=="symbol"||_.startsWith("__"))){for(const I of l){if(!I.value)continue;const T=Ap(I.value,_)??("_"in I.value?Ap((a=I.value._)==null?void 0:a.setupState,_):void 0);if(T)return T}for(const I of l){const T=I.value&&I.value[Ip];if(!T)continue;const M=T.slice();for(;M.length;){const k=M.shift(),F=Ap(k.value,_);if(F)return F;const q=k.value&&k.value[Ip];q&&M.push(...q)}}}}})}const DP=Bt({id:String,...Wm(Ib({closeDelay:250,closeOnContentClick:!0,locationStrategy:"connected",openDelay:300,scrim:!1,scrollStrategy:"reposition",transition:{component:B0}}),["absolute"])},"VMenu"),Ab=Sn()({name:"VMenu",props:DP(),emits:{"update:modelValue":e=>!0},setup(e,s){let{slots:l}=s;const h=fi(e,"modelValue"),{scopeId:m}=Cb(),_=vs(),x=we(()=>e.id||`v-menu-${_}`),a=Kt(),I=Zn(dm,null),T=bn(0);Qi(dm,{register(){++T.value},unregister(){--T.value},closeParents(){setTimeout(()=>{T.value||(h.value=!1,I==null||I.closeParents())},40)}}),wn(h,X=>{X?I==null||I.register():I==null||I.unregister()});function M(){I==null||I.closeParents()}function k(X){var re,me;e.disabled||X.key==="Tab"&&(h.value=!1,(me=(re=a.value)==null?void 0:re.activatorEl)==null||me.focus())}function F(X){var me;if(e.disabled)return;const re=(me=a.value)==null?void 0:me.contentEl;re&&h.value?X.key==="ArrowDown"?(X.preventDefault(),md(re,"next")):X.key==="ArrowUp"&&(X.preventDefault(),md(re,"prev")):["ArrowDown","ArrowUp"].includes(X.key)&&(h.value=!0,X.preventDefault(),setTimeout(()=>setTimeout(()=>F(X))))}const q=we(()=>In({"aria-haspopup":"menu","aria-expanded":String(h.value),"aria-owns":x.value,onKeydown:F},e.activatorProps));return $n(()=>{const[X]=Mv.filterProps(e);return ae(Mv,In({ref:a,class:["v-menu",e.class],style:e.style},X,{modelValue:h.value,"onUpdate:modelValue":re=>h.value=re,absolute:!0,activatorProps:q.value,"onClick:outside":M,onKeydown:k},m),{activator:l.activator,default:function(){for(var re=arguments.length,me=new Array(re),ye=0;ye<re;ye++)me[ye]=arguments[ye];return ae(zs,{root:"VMenu"},{default:()=>{var Ee;return[(Ee=l.default)==null?void 0:Ee.call(l,...me)]}})}})}),ef({id:x,ΨopenChildren:T},a)}});const zP=Bt({active:Boolean,max:[Number,String],value:{type:[Number,String],default:0},...ei(),...Wl({transition:{component:F0}})},"VCounter"),LP=Sn()({name:"VCounter",functional:!0,props:zP(),setup(e,s){let{slots:l}=s;const h=we(()=>e.max?`${e.value} / ${e.max}`:String(e.value));return $n(()=>ae(zo,{transition:e.transition},{default:()=>[Ur(ae("div",{class:["v-counter",e.class],style:e.style},[l.default?l.default({counter:h.value,max:e.max,value:e.value}):h.value]),[[jl,e.active]])]})),{}}});const RP=Bt({floating:Boolean,...ei()},"VFieldLabel"),td=Sn()({name:"VFieldLabel",props:RP(),setup(e,s){let{slots:l}=s;return $n(()=>ae(U0,{class:["v-field-label",{"v-field-label--floating":e.floating},e.class],style:e.style,"aria-hidden":e.floating||void 0},l)),{}}}),BP=["underlined","outlined","filled","solo","solo-inverted","solo-filled","plain"],Pb=Bt({appendInnerIcon:_i,bgColor:String,clearable:Boolean,clearIcon:{type:_i,default:"$clear"},active:Boolean,centerAffix:{type:Boolean,default:void 0},color:String,baseColor:String,dirty:Boolean,disabled:{type:Boolean,default:null},error:Boolean,flat:Boolean,label:String,persistentClear:Boolean,prependInnerIcon:_i,reverse:Boolean,singleLine:Boolean,variant:{type:String,default:"filled",validator:e=>BP.includes(e)},"onClick:clear":Rs(),"onClick:appendInner":Rs(),"onClick:prependInner":Rs(),...ei(),...iA(),...Kl(),...Ar()},"VField"),kb=Sn()({name:"VField",inheritAttrs:!1,props:{id:String,...V0(),...Pb()},emits:{"update:focused":e=>!0,"update:modelValue":e=>!0},setup(e,s){let{attrs:l,emit:h,slots:m}=s;const{themeClasses:_}=is(e),{loaderClasses:x}=J0(e),{focusClasses:a,isFocused:I,focus:T,blur:M}=cg(e),{InputIcon:k}=z0(e),{roundedClasses:F}=Yl(e),{rtlClasses:q}=Gl(),X=we(()=>e.dirty||e.active),re=we(()=>!e.singleLine&&!!(e.label||m.label)),me=vs(),ye=we(()=>e.id||`input-${me}`),Ee=we(()=>`${ye.value}-messages`),be=Kt(),Oe=Kt(),Qe=Kt(),Ue=we(()=>["plain","underlined"].includes(e.variant)),{backgroundColorClasses:ze,backgroundColorStyles:j}=Pu(xn(e,"bgColor")),{textColorClasses:G,textColorStyles:pe}=Fs(we(()=>e.error||e.disabled?void 0:X.value&&I.value?e.color:e.baseColor));wn(X,_e=>{if(re.value){const Fe=be.value.$el,ut=Oe.value.$el;requestAnimationFrame(()=>{const at=Ym(Fe),je=ut.getBoundingClientRect(),Ve=je.x-at.x,Ge=je.y-at.y-(at.height/2-je.height/2),Tt=je.width/.75,At=Math.abs(Tt-at.width)>1?{maxWidth:pn(Tt)}:void 0,rt=getComputedStyle(Fe),It=getComputedStyle(ut),Gt=parseFloat(rt.transitionDuration)*1e3||150,Rt=parseFloat(It.getPropertyValue("--v-field-label-scale")),Ne=It.getPropertyValue("color");Fe.style.visibility="visible",ut.style.visibility="hidden",Al(Fe,{transform:`translate(${Ve}px, ${Ge}px) scale(${Rt})`,color:Ne,...At},{duration:Gt,easing:yd,direction:_e?"normal":"reverse"}).finished.then(()=>{Fe.style.removeProperty("visibility"),ut.style.removeProperty("visibility")})})}},{flush:"post"});const Se=we(()=>({isActive:X,isFocused:I,controlRef:Qe,blur:M,focus:T}));function Ce(_e){_e.target!==document.activeElement&&_e.preventDefault()}return $n(()=>{var Ve,Ge,Tt;const _e=e.variant==="outlined",Fe=m["prepend-inner"]||e.prependInnerIcon,ut=!!(e.clearable||m.clear),at=!!(m["append-inner"]||e.appendInnerIcon||ut),je=m.label?m.label({...Se.value,label:e.label,props:{for:ye.value}}):e.label;return ae("div",In({class:["v-field",{"v-field--active":X.value,"v-field--appended":at,"v-field--center-affix":e.centerAffix??!Ue.value,"v-field--disabled":e.disabled,"v-field--dirty":e.dirty,"v-field--error":e.error,"v-field--flat":e.flat,"v-field--has-background":!!e.bgColor,"v-field--persistent-clear":e.persistentClear,"v-field--prepended":Fe,"v-field--reverse":e.reverse,"v-field--single-line":e.singleLine,"v-field--no-label":!je,[`v-field--variant-${e.variant}`]:!0},_.value,ze.value,a.value,x.value,F.value,q.value,e.class],style:[j.value,pe.value,e.style],onClick:Ce},l),[ae("div",{class:"v-field__overlay"},null),ae(Q0,{name:"v-field",active:!!e.loading,color:e.error?"error":e.color},{default:m.loader}),Fe&&ae("div",{key:"prepend",class:"v-field__prepend-inner"},[e.prependInnerIcon&&ae(k,{key:"prepend-icon",name:"prependInner"},null),(Ve=m["prepend-inner"])==null?void 0:Ve.call(m,Se.value)]),ae("div",{class:"v-field__field","data-no-activator":""},[["filled","solo","solo-inverted","solo-filled"].includes(e.variant)&&re.value&&ae(td,{key:"floating-label",ref:Oe,class:[G.value],floating:!0,for:ye.value},{default:()=>[je]}),ae(td,{ref:be,for:ye.value},{default:()=>[je]}),(Ge=m.default)==null?void 0:Ge.call(m,{...Se.value,props:{id:ye.value,class:"v-field__input","aria-describedby":Ee.value},focus:T,blur:M})]),ut&&ae(O0,{key:"clear"},{default:()=>[Ur(ae("div",{class:"v-field__clearable",onMousedown:At=>{At.preventDefault(),At.stopPropagation()}},[m.clear?m.clear():ae(k,{name:"clear"},null)]),[[jl,e.dirty]])]}),at&&ae("div",{key:"append",class:"v-field__append-inner"},[(Tt=m["append-inner"])==null?void 0:Tt.call(m,Se.value),e.appendInnerIcon&&ae(k,{key:"append-icon",name:"appendInner"},null)]),ae("div",{class:["v-field__outline",G.value]},[_e&&ae(mn,null,[ae("div",{class:"v-field__outline__start"},null),re.value&&ae("div",{class:"v-field__outline__notch"},[ae(td,{ref:Oe,floating:!0,for:ye.value},{default:()=>[je]})]),ae("div",{class:"v-field__outline__end"},null)]),Ue.value&&re.value&&ae(td,{ref:Oe,floating:!0,for:ye.value},{default:()=>[je]})])])}),{controlRef:Qe}}});function FP(e){const s=Object.keys(kb.props).filter(l=>!Km(l)&&l!=="class"&&l!=="style");return Fu(e,s)}const OP=["color","file","time","date","datetime-local","week","month"],bg=Bt({autofocus:Boolean,counter:[Boolean,Number,String],counterValue:Function,prefix:String,placeholder:String,persistentPlaceholder:Boolean,persistentCounter:Boolean,suffix:String,type:{type:String,default:"text"},modelModifiers:Object,...hg(),...Pb()},"VTextField"),Ad=Sn()({name:"VTextField",directives:{Intersect:ib},inheritAttrs:!1,props:bg(),emits:{"click:control":e=>!0,"mousedown:control":e=>!0,"update:focused":e=>!0,"update:modelValue":e=>!0},setup(e,s){let{attrs:l,emit:h,slots:m}=s;const _=fi(e,"modelValue"),{isFocused:x,focus:a,blur:I}=cg(e),T=we(()=>typeof e.counterValue=="function"?e.counterValue(_.value):(_.value??"").toString().length),M=we(()=>{if(l.maxlength)return l.maxlength;if(!(!e.counter||typeof e.counter!="number"&&typeof e.counter!="string"))return e.counter}),k=we(()=>["plain","underlined"].includes(e.variant));function F(Ue,ze){var j,G;!e.autofocus||!Ue||(G=(j=ze[0].target)==null?void 0:j.focus)==null||G.call(j)}const q=Kt(),X=Kt(),re=Kt(),me=we(()=>OP.includes(e.type)||e.persistentPlaceholder||x.value||e.active);function ye(){var Ue;re.value!==document.activeElement&&((Ue=re.value)==null||Ue.focus()),x.value||a()}function Ee(Ue){h("mousedown:control",Ue),Ue.target!==re.value&&(ye(),Ue.preventDefault())}function be(Ue){ye(),h("click:control",Ue)}function Oe(Ue){Ue.stopPropagation(),ye(),er(()=>{_.value=null,_C(e["onClick:clear"],Ue)})}function Qe(Ue){var j;const ze=Ue.target;if(_.value=ze.value,(j=e.modelModifiers)!=null&&j.trim&&["text","search","password","tel","url"].includes(e.type)){const G=[ze.selectionStart,ze.selectionEnd];er(()=>{ze.selectionStart=G[0],ze.selectionEnd=G[1]})}}return $n(()=>{const Ue=!!(m.counter||e.counter||e.counterValue),ze=!!(Ue||m.details),[j,G]=Hm(l),[{modelValue:pe,...Se}]=Cd.filterProps(e),[Ce]=FP(e);return ae(Cd,In({ref:q,modelValue:_.value,"onUpdate:modelValue":_e=>_.value=_e,class:["v-text-field",{"v-text-field--prefixed":e.prefix,"v-text-field--suffixed":e.suffix,"v-text-field--plain-underlined":["plain","underlined"].includes(e.variant)},e.class],style:e.style},j,Se,{centerAffix:!k.value,focused:x.value}),{...m,default:_e=>{let{id:Fe,isDisabled:ut,isDirty:at,isReadonly:je,isValid:Ve}=_e;return ae(kb,In({ref:X,onMousedown:Ee,onClick:be,"onClick:clear":Oe,"onClick:prependInner":e["onClick:prependInner"],"onClick:appendInner":e["onClick:appendInner"],role:"textbox"},Ce,{id:Fe.value,active:me.value||at.value,dirty:at.value||e.dirty,disabled:ut.value,focused:x.value,error:Ve.value===!1}),{...m,default:Ge=>{let{props:{class:Tt,...At}}=Ge;const rt=Ur(ae("input",In({ref:re,value:_.value,onInput:Qe,autofocus:e.autofocus,readonly:je.value,disabled:ut.value,name:e.name,placeholder:e.placeholder,size:1,type:e.type,onFocus:ye,onBlur:I},At,G),null),[[wa("intersect"),{handler:F},null,{once:!0}]]);return ae(mn,null,[e.prefix&&ae("span",{class:"v-text-field__prefix"},[e.prefix]),ae("div",{class:Tt,"data-no-activator":""},[m.default?ae(mn,null,[m.default(),rt]):eo(rt)]),e.suffix&&ae("span",{class:"v-text-field__suffix"},[e.suffix])])}})},details:ze?_e=>{var Fe;return ae(mn,null,[(Fe=m.details)==null?void 0:Fe.call(m,_e),Ue&&ae(mn,null,[ae("span",null,null),ae(LP,{active:e.persistentCounter||x.value,value:T.value,max:M.value},m.counter)])])}:void 0})}),ef({},q,X,re)}}),Mb=Bt({chips:Boolean,closableChips:Boolean,eager:Boolean,hideNoData:Boolean,hideSelected:Boolean,menu:Boolean,menuIcon:{type:_i,default:"$dropdown"},menuProps:{type:Object},multiple:Boolean,noDataText:{type:String,default:"$vuetify.noDataText"},openOnClear:Boolean,valueComparator:{type:Function,default:ql},...gb({itemChildren:!1})},"Select"),VP=Bt({...Mb(),...Wm(bg({modelValue:null}),["validationValue","dirty","appendInnerIcon"]),...Wl({transition:{component:B0}})},"VSelect");Sn()({name:"VSelect",props:VP(),emits:{"update:focused":e=>!0,"update:modelValue":e=>!0,"update:menu":e=>!0},setup(e,s){let{slots:l}=s;const{t:h}=Hd(),m=Kt(),_=Kt(),x=fi(e,"menu"),a=we({get:()=>x.value,set:_e=>{var Fe;x.value&&!_e&&((Fe=_.value)!=null&&Fe.ΨopenChildren)||(x.value=_e)}}),{items:I,transformIn:T,transformOut:M}=vb(e),k=fi(e,"modelValue",[],_e=>T(_e===null?[null]:Ls(_e)),_e=>{const Fe=M(_e);return e.multiple?Fe:Fe[0]??null}),F=ug(),q=we(()=>k.value.map(_e=>I.value.find(Fe=>e.valueComparator(Fe.value,_e.value))||_e)),X=we(()=>q.value.map(_e=>_e.props.value)),re=bn(!1);let me="",ye;const Ee=we(()=>e.hideSelected?I.value.filter(_e=>!q.value.some(Fe=>Fe===_e)):I.value),be=we(()=>e.hideNoData&&!I.value.length||e.readonly||(F==null?void 0:F.isReadonly.value)),Oe=Kt();function Qe(_e){e.openOnClear&&(a.value=!0)}function Ue(){be.value||(a.value=!a.value)}function ze(_e){var Ve,Ge;if(e.readonly||F!=null&&F.isReadonly.value)return;["Enter"," ","ArrowDown","ArrowUp","Home","End"].includes(_e.key)&&_e.preventDefault(),["Enter","ArrowDown"," "].includes(_e.key)&&(a.value=!0),["Escape","Tab"].includes(_e.key)&&(a.value=!1),_e.key==="Home"?(Ve=Oe.value)==null||Ve.focus("first"):_e.key==="End"&&((Ge=Oe.value)==null||Ge.focus("last"));const Fe=1e3;function ut(Tt){const At=Tt.key.length===1,rt=!Tt.ctrlKey&&!Tt.metaKey&&!Tt.altKey;return At&&rt}if(e.multiple||!ut(_e))return;const at=performance.now();at-ye>Fe&&(me=""),me+=_e.key.toLowerCase(),ye=at;const je=I.value.find(Tt=>Tt.title.toLowerCase().startsWith(me));je!==void 0&&(k.value=[je])}function j(_e){var Fe;_e.key==="Tab"&&((Fe=m.value)==null||Fe.focus())}function G(_e){if(e.multiple){const Fe=X.value.findIndex(ut=>e.valueComparator(ut,_e.value));if(Fe===-1)k.value=[...k.value,_e];else{const ut=[...k.value];ut.splice(Fe,1),k.value=ut}}else k.value=[_e],a.value=!1}function pe(_e){var Fe;(Fe=Oe.value)!=null&&Fe.$el.contains(_e.relatedTarget)||(a.value=!1)}function Se(){var _e;re.value&&((_e=m.value)==null||_e.focus())}function Ce(_e){re.value=!0}return $n(()=>{const _e=!!(e.chips||l.chip),Fe=!!(!e.hideNoData||Ee.value.length||l["prepend-item"]||l["append-item"]||l["no-data"]),ut=k.value.length>0,[at]=Ad.filterProps(e),je=ut||!re.value&&e.label&&!e.persistentPlaceholder?void 0:e.placeholder;return ae(Ad,In({ref:m},at,{modelValue:k.value.map(Ve=>Ve.props.value).join(", "),"onUpdate:modelValue":Ve=>{Ve==null&&(k.value=[])},focused:re.value,"onUpdate:focused":Ve=>re.value=Ve,validationValue:k.externalValue,dirty:ut,class:["v-select",{"v-select--active-menu":a.value,"v-select--chips":!!e.chips,[`v-select--${e.multiple?"multiple":"single"}`]:!0,"v-select--selected":k.value.length,"v-select--selection-slot":!!l.selection},e.class],style:e.style,readonly:!0,placeholder:je,"onClick:clear":Qe,"onMousedown:control":Ue,onBlur:pe,onKeydown:ze}),{...l,default:()=>ae(mn,null,[ae(Ab,In({ref:_,modelValue:a.value,"onUpdate:modelValue":Ve=>a.value=Ve,activator:"parent",contentClass:"v-select__content",disabled:be.value,eager:e.eager,maxHeight:310,openOnClick:!1,closeOnContentClick:!1,transition:e.transition,onAfterLeave:Se},e.menuProps),{default:()=>[Fe&&ae(bb,{ref:Oe,selected:X.value,selectStrategy:e.multiple?"independent":"single-independent",onMousedown:Ve=>Ve.preventDefault(),onKeydown:j,onFocusin:Ce,tabindex:"-1"},{default:()=>{var Ve,Ge,Tt;return[(Ve=l["prepend-item"])==null?void 0:Ve.call(l),!Ee.value.length&&!e.hideNoData&&(((Ge=l["no-data"])==null?void 0:Ge.call(l))??ae(Bl,{title:h(e.noDataText)},null)),Ee.value.map((At,rt)=>{var Gt;const It=In(At.props,{key:rt,onClick:()=>G(At)});return((Gt=l.item)==null?void 0:Gt.call(l,{item:At,index:rt,props:It}))??ae(Bl,It,{prepend:Rt=>{let{isSelected:Ne}=Rt;return ae(mn,null,[e.multiple&&!e.hideSelected?ae(eb,{key:At.value,modelValue:Ne,ripple:!1,tabindex:"-1"},null):void 0,At.props.prependIcon&&ae($r,{icon:At.props.prependIcon},null)])}})}),(Tt=l["append-item"])==null?void 0:Tt.call(l)]}})]}),q.value.map((Ve,Ge)=>{var rt;function Tt(It){It.stopPropagation(),It.preventDefault(),G(Ve)}const At={"onClick:close":Tt,onMousedown(It){It.preventDefault(),It.stopPropagation()},modelValue:!0,"onUpdate:modelValue":void 0};return ae("div",{key:Ve.value,class:"v-select__selection"},[_e?l.chip?ae(zs,{key:"chip-defaults",defaults:{VChip:{closable:e.closableChips,size:"small",text:Ve.title}}},{default:()=>{var It;return[(It=l.chip)==null?void 0:It.call(l,{item:Ve,index:Ge,props:At})]}}):ae(lb,In({key:"chip",closable:e.closableChips,size:"small",text:Ve.title},At),null):((rt=l.selection)==null?void 0:rt.call(l,{item:Ve,index:Ge}))??ae("span",{class:"v-select__selection-text"},[Ve.title,e.multiple&&Ge<q.value.length-1&&ae("span",{class:"v-select__selection-comma"},[Su(",")])])])})]),"append-inner":function(){var At;for(var Ve=arguments.length,Ge=new Array(Ve),Tt=0;Tt<Ve;Tt++)Ge[Tt]=arguments[Tt];return ae(mn,null,[(At=l["append-inner"])==null?void 0:At.call(l,...Ge),e.menuIcon?ae($r,{class:"v-select__menu-icon",icon:e.menuIcon},null):void 0])}})}),ef({isFocused:re,menu:a,select:G},m)}});const $P=(e,s,l)=>e==null||s==null?-1:e.toString().toLocaleLowerCase().indexOf(s.toString().toLocaleLowerCase()),UP=Bt({customFilter:Function,customKeyFilter:Object,filterKeys:[Array,String],filterMode:{type:String,default:"intersection"},noFilter:Boolean},"filter");function NP(e,s,l){var a;const h=[],m=(l==null?void 0:l.default)??$P,_=l!=null&&l.filterKeys?Ls(l.filterKeys):!1,x=Object.keys((l==null?void 0:l.customKeyFilter)??{}).length;if(!(e!=null&&e.length))return h;e:for(let I=0;I<e.length;I++){const T=e[I],M={},k={};let F=-1;if(s&&!(l!=null&&l.noFilter)){if(typeof T=="object"){const re=_||Object.keys(T);for(const me of re){const ye=Ds(T,me,T),Ee=(a=l==null?void 0:l.customKeyFilter)==null?void 0:a[me];if(F=Ee?Ee(ye,s,T):m(ye,s,T),F!==-1&&F!==!1)Ee?M[me]=F:k[me]=F;else if((l==null?void 0:l.filterMode)==="every")continue e}}else F=m(T,s,T),F!==-1&&F!==!1&&(k.title=F);const q=Object.keys(k).length,X=Object.keys(M).length;if(!q&&!X||(l==null?void 0:l.filterMode)==="union"&&X!==x&&!q||(l==null?void 0:l.filterMode)==="intersection"&&(X!==x||!q))continue}h.push({index:I,matches:{...k,...M}})}return h}function jP(e,s,l,h){const m=we(()=>typeof(l==null?void 0:l.value)!="string"&&typeof(l==null?void 0:l.value)!="number"?"":String(l.value)),_=Kt([]),x=Kt(new Map),a=we(()=>h!=null&&h.transform?Wi(s).map(h==null?void 0:h.transform):Wi(s));ro(()=>{_.value=[],x.value=new Map;const T=NP(a.value,m.value,{customKeyFilter:e.customKeyFilter,default:e.customFilter,filterKeys:e.filterKeys,filterMode:e.filterMode,noFilter:e.noFilter}),M=Wi(s);T.forEach(k=>{let{index:F,matches:q}=k;const X=M[F];_.value.push(X),x.value.set(X.value,q)})});function I(T){return x.value.get(T.value)}return{filteredItems:_,filteredMatches:x,getMatches:I}}function qP(e,s,l){if(s==null)return e;if(Array.isArray(s))throw new Error("Multiple matches is not implemented");return typeof s=="number"&&~s?ae(mn,null,[ae("span",{class:"v-autocomplete__unmask"},[e.substr(0,s)]),ae("span",{class:"v-autocomplete__mask"},[e.substr(s,l)]),ae("span",{class:"v-autocomplete__unmask"},[e.substr(s+l)])]):e}const ZP=Bt({autoSelectFirst:{type:[Boolean,String]},search:String,...UP({filterKeys:["title"]}),...Mb(),...Wm(bg({modelValue:null}),["validationValue","dirty","appendInnerIcon"]),...Wl({transition:!1})},"VAutocomplete"),GP=Sn()({name:"VAutocomplete",props:ZP(),emits:{"update:focused":e=>!0,"update:search":e=>!0,"update:modelValue":e=>!0,"update:menu":e=>!0},setup(e,s){let{slots:l}=s;const{t:h}=Hd(),m=Kt(),_=bn(!1),x=bn(!0),a=Kt(!1),I=Kt(),T=fi(e,"menu"),M=we({get:()=>T.value,set:Ne=>{var Ae;T.value&&!Ne&&((Ae=I.value)!=null&&Ae.ΨopenChildren)||(T.value=Ne)}}),k=bn(-1),F=we(()=>{var Ne;return(Ne=m.value)==null?void 0:Ne.color}),{items:q,transformIn:X,transformOut:re}=vb(e),{textColorClasses:me,textColorStyles:ye}=Fs(F),Ee=fi(e,"search",""),be=fi(e,"modelValue",[],Ne=>X(Ne===null?[null]:Ls(Ne)),Ne=>{const Ae=re(Ne);return e.multiple?Ae:Ae[0]??null}),Oe=ug(),{filteredItems:Qe,getMatches:Ue}=jP(e,q,we(()=>x.value?void 0:Ee.value)),ze=we(()=>be.value.map(Ne=>q.value.find(Ae=>e.valueComparator(Ae.value,Ne.value))||Ne)),j=we(()=>e.hideSelected?Qe.value.filter(Ne=>!ze.value.some(Ae=>Ae.value===Ne.value)):Qe.value),G=we(()=>ze.value.map(Ne=>Ne.props.value)),pe=we(()=>ze.value[k.value]),Se=we(()=>{var Ae;return(e.autoSelectFirst===!0||e.autoSelectFirst==="exact"&&Ee.value===((Ae=j.value[0])==null?void 0:Ae.title))&&j.value.length>0&&!x.value&&!a.value}),Ce=we(()=>e.hideNoData&&!q.value.length||e.readonly||(Oe==null?void 0:Oe.isReadonly.value)),_e=Kt();function Fe(Ne){e.openOnClear&&(M.value=!0),Ee.value=""}function ut(){Ce.value||(M.value=!0)}function at(Ne){Ce.value||(_.value&&(Ne.preventDefault(),Ne.stopPropagation()),M.value=!M.value)}function je(Ne){var Le,He,wt;if(e.readonly||Oe!=null&&Oe.isReadonly.value)return;const Ae=m.value.selectionStart,tt=G.value.length;if((k.value>-1||["Enter","ArrowDown","ArrowUp"].includes(Ne.key))&&Ne.preventDefault(),["Enter","ArrowDown"].includes(Ne.key)&&(M.value=!0),["Escape"].includes(Ne.key)&&(M.value=!1),["Enter","Escape","Tab"].includes(Ne.key)&&(Se.value&&["Enter","Tab"].includes(Ne.key)&&Rt(Qe.value[0]),x.value=!0),Ne.key==="ArrowDown"&&Se.value&&((Le=_e.value)==null||Le.focus("next")),!!e.multiple){if(["Backspace","Delete"].includes(Ne.key)){if(k.value<0){Ne.key==="Backspace"&&!Ee.value&&(k.value=tt-1);return}const K=k.value;pe.value&&Rt(pe.value),k.value=K>=tt-1?tt-2:K}if(Ne.key==="ArrowLeft"){if(k.value<0&&Ae>0)return;const K=k.value>-1?k.value-1:tt-1;ze.value[K]?k.value=K:(k.value=-1,m.value.setSelectionRange((He=Ee.value)==null?void 0:He.length,(wt=Ee.value)==null?void 0:wt.length))}if(Ne.key==="ArrowRight"){if(k.value<0)return;const K=k.value+1;ze.value[K]?k.value=K:(k.value=-1,m.value.setSelectionRange(0,0))}}}function Ve(Ne){var Ae;Ne.key==="Tab"&&((Ae=m.value)==null||Ae.focus())}function Ge(Ne){Ee.value=Ne.target.value}function Tt(){var Ne;_.value&&(x.value=!0,(Ne=m.value)==null||Ne.focus())}function At(Ne){_.value=!0,setTimeout(()=>{a.value=!0})}function rt(Ne){a.value=!1}function It(Ne){(Ne==null||Ne===""&&!e.multiple)&&(be.value=[])}const Gt=bn(!1);function Rt(Ne){if(e.multiple){const Ae=G.value.findIndex(tt=>e.valueComparator(tt,Ne.value));if(Ae===-1)be.value=[...be.value,Ne];else{const tt=[...be.value];tt.splice(Ae,1),be.value=tt}}else be.value=[Ne],Gt.value=!0,Ee.value=Ne.title,M.value=!1,x.value=!0,er(()=>Gt.value=!1)}return wn(_,(Ne,Ae)=>{var tt;Ne!==Ae&&(Ne?(Gt.value=!0,Ee.value=e.multiple?"":String(((tt=ze.value.at(-1))==null?void 0:tt.props.title)??""),x.value=!0,er(()=>Gt.value=!1)):(!e.multiple&&!Ee.value?be.value=[]:Se.value&&!a.value&&!ze.value.some(Le=>{let{value:He}=Le;return He===j.value[0].value})&&Rt(j.value[0]),M.value=!1,Ee.value="",k.value=-1))}),wn(Ee,Ne=>{!_.value||Gt.value||(Ne&&(M.value=!0),x.value=!Ne)}),$n(()=>{const Ne=!!(e.chips||l.chip),Ae=!!(!e.hideNoData||j.value.length||l["prepend-item"]||l["append-item"]||l["no-data"]),tt=be.value.length>0,[Le]=Ad.filterProps(e);return ae(Ad,In({ref:m},Le,{modelValue:Ee.value,"onUpdate:modelValue":It,focused:_.value,"onUpdate:focused":He=>_.value=He,validationValue:be.externalValue,dirty:tt,onInput:Ge,class:["v-autocomplete",`v-autocomplete--${e.multiple?"multiple":"single"}`,{"v-autocomplete--active-menu":M.value,"v-autocomplete--chips":!!e.chips,"v-autocomplete--selection-slot":!!l.selection,"v-autocomplete--selecting-index":k.value>-1},e.class],style:e.style,readonly:e.readonly,placeholder:tt?void 0:e.placeholder,"onClick:clear":Fe,"onMousedown:control":ut,onKeydown:je}),{...l,default:()=>ae(mn,null,[ae(Ab,In({ref:I,modelValue:M.value,"onUpdate:modelValue":He=>M.value=He,activator:"parent",contentClass:"v-autocomplete__content",disabled:Ce.value,eager:e.eager,maxHeight:310,openOnClick:!1,closeOnContentClick:!1,transition:e.transition,onAfterLeave:Tt},e.menuProps),{default:()=>[Ae&&ae(bb,{ref:_e,selected:G.value,selectStrategy:e.multiple?"independent":"single-independent",onMousedown:He=>He.preventDefault(),onKeydown:Ve,onFocusin:At,onFocusout:rt,tabindex:"-1"},{default:()=>{var He,wt,K;return[(He=l["prepend-item"])==null?void 0:He.call(l),!j.value.length&&!e.hideNoData&&(((wt=l["no-data"])==null?void 0:wt.call(l))??ae(Bl,{title:h(e.noDataText)},null)),j.value.map((ne,Z)=>{var Be;const ke=In(ne.props,{key:Z,active:Se.value&&Z===0?!0:void 0,onClick:()=>Rt(ne)});return((Be=l.item)==null?void 0:Be.call(l,{item:ne,index:Z,props:ke}))??ae(Bl,ke,{prepend:Re=>{let{isSelected:Ze}=Re;return ae(mn,null,[e.multiple&&!e.hideSelected?ae(eb,{key:ne.value,modelValue:Ze,ripple:!1,tabindex:"-1"},null):void 0,ne.props.prependIcon&&ae($r,{icon:ne.props.prependIcon},null)])},title:()=>{var Re,Ze;return x.value?ne.title:qP(ne.title,(Re=Ue(ne))==null?void 0:Re.title,((Ze=Ee.value)==null?void 0:Ze.length)??0)}})}),(K=l["append-item"])==null?void 0:K.call(l)]}})]}),ze.value.map((He,wt)=>{var Z;function K(ke){ke.stopPropagation(),ke.preventDefault(),Rt(He)}const ne={"onClick:close":K,onMousedown(ke){ke.preventDefault(),ke.stopPropagation()},modelValue:!0,"onUpdate:modelValue":void 0};return ae("div",{key:He.value,class:["v-autocomplete__selection",wt===k.value&&["v-autocomplete__selection--selected",me.value]],style:wt===k.value?ye.value:{}},[Ne?l.chip?ae(zs,{key:"chip-defaults",defaults:{VChip:{closable:e.closableChips,size:"small",text:He.title}}},{default:()=>{var ke;return[(ke=l.chip)==null?void 0:ke.call(l,{item:He,index:wt,props:ne})]}}):ae(lb,In({key:"chip",closable:e.closableChips,size:"small",text:He.title},ne),null):((Z=l.selection)==null?void 0:Z.call(l,{item:He,index:wt}))??ae("span",{class:"v-autocomplete__selection-text"},[He.title,e.multiple&&wt<ze.value.length-1&&ae("span",{class:"v-autocomplete__selection-comma"},[Su(",")])])])})]),"append-inner":function(){var ne;for(var He=arguments.length,wt=new Array(He),K=0;K<He;K++)wt[K]=arguments[K];return ae(mn,null,[(ne=l["append-inner"])==null?void 0:ne.call(l,...wt),e.menuIcon?ae($r,{class:"v-autocomplete__menu-icon",icon:e.menuIcon,onMousedown:at,onClick:xC},null):void 0])}})}),ef({isFocused:_,isPristine:x,menu:M,search:Ee,filteredItems:Qe,select:Rt},m)}}),WP={class:"AutocompleteFilter"};function HP(e,s,l,h,m,_){return an(),fn("div",WP,[jt("label",null,Pi(e.label),1),ae(GP,{modelValue:e.selected,"onUpdate:modelValue":s[0]||(s[0]=x=>e.selected=x),items:e.data,"item-value":"value","item-title":"label",id:"autocomplete",rounded:"xl",placeholder:"Sélectionner...",variant:"outlined",multiple:"","return-object":""},null,8,["modelValue","items"])])}const XP=gr(io,[["render",HP]]);var KP=Object.defineProperty,YP=Object.getOwnPropertyDescriptor,JP=(e,s,l,h)=>{for(var m=h>1?void 0:h?YP(s,l):s,_=e.length-1,x;_>=0;_--)(x=e[_])&&(m=(h?x(s,l,m):x(m))||m);return h&&m&&KP(s,l,m),m};let fm=class extends mr{get isShown(){return oi().isFiltersBarShown}get filterStore(){return jn()}get countriesData(){return jn().countries.map(s=>({label:s,value:s}))}get thematicsData(){return jn().thematics.map(s=>({label:s.label,value:s.value}))}get resetTrigger(){return jn().resetTrigger}resetFilters(){jn().countriesFilter=[],jn().thematicsFilter=[],jn().resetTrigger=!this.resetTrigger,jn().search=""}updateCountries(s){jn().countriesFilter=s}updateThematics(s){jn().thematicsFilter=s}};fm=JP([pr({components:{AutocompleteFilter:XP,Button:Vu}})],fm);const QP=["shown"],ek={class:"FiltersBar__filtersCtn"};function tk(e,s,l,h,m,_){const x=Gi("Button"),a=Gi("AutocompleteFilter");return e.isShown?(an(),fn("div",{key:0,class:"FiltersBar",shown:e.isShown},[ae(x,{label:"Réinitialiser",uppercase:"true",small:"true",class:"FiltersBar__resetBtn",onClick:e.resetFilters},null,8,["onClick"]),jt("div",ek,[ae(a,{label:"Pays",reset:e.resetTrigger,data:e.countriesData,onOnSelected:s[0]||(s[0]=I=>e.updateCountries(I.map(T=>T.value)))},null,8,["reset","data"]),ae(a,{label:"Thématique",reset:e.resetTrigger,data:e.thematicsData,onOnSelected:s[1]||(s[1]=I=>e.updateThematics(I.map(T=>T.value)))},null,8,["reset","data"])])],8,QP)):Zi("",!0)}const nk=gr(fm,[["render",tk]]);var ik=Object.defineProperty,rk=Object.getOwnPropertyDescriptor,Db=(e,s,l,h)=>{for(var m=h>1?void 0:h?rk(s,l):s,_=e.length-1,x;_>=0;_--)(x=e[_])&&(m=(h?x(s,l,m):x(m))||m);return h&&m&&ik(s,l,m),m};let Pd=class extends mr{constructor(){super(...arguments);Wn(this,"downloadReport")}};Db([Pr({default:"Button label"})],Pd.prototype,"downloadReport",2);Pd=Db([pr({})],Pd);const sk=["href"],ok={class:"DownloadReportItem__name"},ak=["src"];function lk(e,s,l,h,m,_){return an(),fn("a",{class:"DownloadReportItem",href:"./reports/"+e.downloadReport.filename,download:""},[jt("h3",ok,Pi(e.downloadReport.name),1),jt("img",{src:"./img/icons/mdi-download-circle-outline-grey.svg",alt:"Download icon"},null,8,ak)],8,sk)}const ck=gr(Pd,[["render",lk]]);var uk=Object.defineProperty,hk=Object.getOwnPropertyDescriptor,dk=(e,s,l,h)=>{for(var m=h>1?void 0:h?hk(s,l):s,_=e.length-1,x;_>=0;_--)(x=e[_])&&(m=(h?x(s,l,m):x(m))||m);return h&&m&&uk(s,l,m),m};let pm=class extends mr{constructor(){super(...arguments);Wn(this,"actors",[{category:"Coordination du projet",partners:[{name:"FORIM",logo:"forim.png",link:"https://forim.net/"}]},{category:"Comité de pilotage du projet",partners:[{name:"GRDR",logo:"grdr.svg",link:"https://grdr.org/"},{name:"LOUJNA",logo:"loujna.png",link:"http://loujna-tounkaranke.org/"}]},{category:"Financé par",partners:[{name:"AFD",logo:"afd.svg",link:"https://www.afd.fr/"},{name:"Expertise France",logo:"expertise_france.svg",link:"https://www.expertisefrance.fr/"}]}])}get isAboutModalShown(){return oi().isAboutModalShown}get isDownloadShown(){return oi().isDownloadShown}get downloadReports(){return oi().downloadReports}close(){oi().isAboutModalShown=!1,setTimeout(()=>oi().isDownloadShown=!1,300)}toggleIsDownloadShown(){oi().isDownloadShown=!this.isDownloadShown}};pm=dk([pr({components:{Button:Vu,DownloadReportItem:ck}})],pm);const fk=["open"],pk={class:"AboutModal__head"},mk={key:0,class:"AboutModal__content"},gk={class:"AboutModal__downloadsCtn"},yk={key:1,class:"AboutModal__content"},_k=jt("div",{class:"AboutModal__ctn AboutModal__ctn--right"},[jt("div",{class:"AboutModal__titles"},[jt("h2",null,"Coopération régionale des politiques migratoires"),jt("h3",null,"Composante 2 : Société civile :« Améliorer le dialogue entre OSC et pouvoirs publics pour des politiques migratoires justes et pertinentes en Afrique »")]),jt("div",{class:"AboutModal__contentDesc"},[jt("p",null,"Financé par l’AFD, Expertise France a lancé en juin 2020 le programme « Coopération Régionale des Politiques Migratoires » qui vise à renforcer le dialogue entre 7 pays africains sur les politiques nationales en matière de migration (Tunisie, Maroc, Sénégal, Mali, Côte d’Ivoire, Guinée et Cameroun)."),jt("p",null,"La Composante 1 du programme, entend développer, via des points focaux dans les ministères en charge des enjeux migrations dans chaque pays, les capacités de suivi des autorités et l’élaboration de nouveaux indicateurs, ainsi que le partage de pratiques."),jt("p",{class:"bold"},"La composante 2 du programme se concentre quant à elle sur les organisations de la société civile et ambitionne de créer et pérenniser des mécanismes de dialogue entre les OSC et les autorités nationales et régionales sur les politiques migratoires.")])],-1),vk={class:"AboutModal__ctn AboutModal__ctn--left"},xk={class:"AboutModal__partnersCtn"},bk=["href"],wk=["src","alt"],Sk={class:"AboutModal__footer"};function Ck(e,s,l,h,m,_){const x=Gi("Button"),a=Gi("DownloadReportItem");return an(),fn("dialog",{class:"AboutModal",open:e.isAboutModalShown},[jt("div",pk,[jt("h1",null,Pi(e.isDownloadShown?"Téléchargements":"À propos du projet"),1),ae(x,{label:e.isDownloadShown?"À propos":"Téléchargements",uppercase:!0,icon:e.isDownloadShown?"mdi-information-variant-circle-outline":"mdi-download-circle-outline",onClick:s[0]||(s[0]=I=>e.toggleIsDownloadShown())},null,8,["label","icon"])]),e.isDownloadShown?(an(),fn("div",mk,[jt("div",gk,[(an(!0),fn(mn,null,Dl(e.downloadReports,(I,T)=>(an(),jd(a,{downloadReport:I,key:T},null,8,["downloadReport"]))),128))])])):Zi("",!0),e.isDownloadShown?Zi("",!0):(an(),fn("div",yk,[_k,jt("div",vk,[(an(!0),fn(mn,null,Dl(e.actors,(I,T)=>(an(),fn("div",{class:"AboutModal__actorsCtn",key:T},[jt("h3",null,Pi(I.category),1),jt("div",xk,[(an(!0),fn(mn,null,Dl(I.partners,(M,k)=>(an(),fn("a",{href:M.link,target:"_blank",rel:"noopener noreferrer",key:k},[jt("img",{src:"./img/logos/"+M.logo,alt:M.name+" logo",loading:"lazy"},null,8,wk)],8,bk))),128))])]))),128))])])),jt("div",Sk,[jt("button",{onClick:s[1]||(s[1]=I=>e.close())},"Fermer")])],8,fk)}const Ek=gr(pm,[["render",Ck]]);var Tk=Object.defineProperty,Ik=Object.getOwnPropertyDescriptor,Ak=(e,s,l,h)=>{for(var m=h>1?void 0:h?Ik(s,l):s,_=e.length-1,x;_>=0;_--)(x=e[_])&&(m=(h?x(s,l,m):x(m))||m);return h&&m&&Tk(s,l,m),m};let mm=class extends mr{get isRedirectionModalShown(){return oi().isRedirectionModalShown}close(){oi().isRedirectionModalShown=!1}};mm=Ak([pr({components:{Button:Vu}})],mm);const Pk=["open"],kk=jt("div",{class:"Modal__head"},[jt("h1",null,"Renseigner une association")],-1),Mk=jt("div",{class:"Modal__content"},[jt("p",null,"Si vous souhaitez signaler une nouvelle association ou mettre à jour les informations affichées sur la carte, merci de remplir le questionnaire en ligne. Veillez à bien renseigner le numéro de téléphone et l’adresse électronique : nous vous recontacterons avant la mise en ligne des informations.")],-1),Dk={class:"Modal__footer"},zk=jt("a",{href:"https://ee.kobotoolbox.org/x/1a1GtPyH",target:"_blank"},"Accéder",-1);function Lk(e,s,l,h,m,_){return an(),fn("dialog",{class:"Modal",open:e.isRedirectionModalShown},[kk,Mk,jt("div",Dk,[jt("button",{onClick:s[0]||(s[0]=x=>e.close())},"Annuler"),zk])],8,Pk)}const Rk=gr(mm,[["render",Lk]]);var zb={exports:{}};/* @license
Papa Parse
v5.4.1
https://github.com/mholt/PapaParse
License: MIT
*/(function(e,s){(function(l,h){e.exports=h()})(I0,function l(){var h=typeof self<"u"?self:typeof window<"u"?window:h!==void 0?h:{},m=!h.document&&!!h.postMessage,_=h.IS_PAPA_WORKER||!1,x={},a=0,I={parse:function(j,G){var pe=(G=G||{}).dynamicTyping||!1;if(ze(pe)&&(G.dynamicTypingFunction=pe,pe={}),G.dynamicTyping=pe,G.transform=!!ze(G.transform)&&G.transform,G.worker&&I.WORKERS_SUPPORTED){var Se=function(){if(!I.WORKERS_SUPPORTED)return!1;var _e=(ut=h.URL||h.webkitURL||null,at=l.toString(),I.BLOB_URL||(I.BLOB_URL=ut.createObjectURL(new Blob(["var global = (function() { if (typeof self !== 'undefined') { return self; } if (typeof window !== 'undefined') { return window; } if (typeof global !== 'undefined') { return global; } return {}; })(); global.IS_PAPA_WORKER=true; ","(",at,")();"],{type:"text/javascript"})))),Fe=new h.Worker(_e),ut,at;return Fe.onmessage=Ee,Fe.id=a++,x[Fe.id]=Fe}();return Se.userStep=G.step,Se.userChunk=G.chunk,Se.userComplete=G.complete,Se.userError=G.error,G.step=ze(G.step),G.chunk=ze(G.chunk),G.complete=ze(G.complete),G.error=ze(G.error),delete G.worker,void Se.postMessage({input:j,config:G,workerId:Se.id})}var Ce=null;return I.NODE_STREAM_INPUT,typeof j=="string"?(j=function(_e){return _e.charCodeAt(0)===65279?_e.slice(1):_e}(j),Ce=G.download?new k(G):new q(G)):j.readable===!0&&ze(j.read)&&ze(j.on)?Ce=new X(G):(h.File&&j instanceof File||j instanceof Object)&&(Ce=new F(G)),Ce.stream(j)},unparse:function(j,G){var pe=!1,Se=!0,Ce=",",_e=`\r
`,Fe='"',ut=Fe+Fe,at=!1,je=null,Ve=!1;(function(){if(typeof G=="object"){if(typeof G.delimiter!="string"||I.BAD_DELIMITERS.filter(function(rt){return G.delimiter.indexOf(rt)!==-1}).length||(Ce=G.delimiter),(typeof G.quotes=="boolean"||typeof G.quotes=="function"||Array.isArray(G.quotes))&&(pe=G.quotes),typeof G.skipEmptyLines!="boolean"&&typeof G.skipEmptyLines!="string"||(at=G.skipEmptyLines),typeof G.newline=="string"&&(_e=G.newline),typeof G.quoteChar=="string"&&(Fe=G.quoteChar),typeof G.header=="boolean"&&(Se=G.header),Array.isArray(G.columns)){if(G.columns.length===0)throw new Error("Option columns is empty");je=G.columns}G.escapeChar!==void 0&&(ut=G.escapeChar+Fe),(typeof G.escapeFormulae=="boolean"||G.escapeFormulae instanceof RegExp)&&(Ve=G.escapeFormulae instanceof RegExp?G.escapeFormulae:/^[=+\-@\t\r].*$/)}})();var Ge=new RegExp(me(Fe),"g");if(typeof j=="string"&&(j=JSON.parse(j)),Array.isArray(j)){if(!j.length||Array.isArray(j[0]))return Tt(null,j,at);if(typeof j[0]=="object")return Tt(je||Object.keys(j[0]),j,at)}else if(typeof j=="object")return typeof j.data=="string"&&(j.data=JSON.parse(j.data)),Array.isArray(j.data)&&(j.fields||(j.fields=j.meta&&j.meta.fields||je),j.fields||(j.fields=Array.isArray(j.data[0])?j.fields:typeof j.data[0]=="object"?Object.keys(j.data[0]):[]),Array.isArray(j.data[0])||typeof j.data[0]=="object"||(j.data=[j.data])),Tt(j.fields||[],j.data||[],at);throw new Error("Unable to serialize unrecognized input");function Tt(rt,It,Gt){var Rt="";typeof rt=="string"&&(rt=JSON.parse(rt)),typeof It=="string"&&(It=JSON.parse(It));var Ne=Array.isArray(rt)&&0<rt.length,Ae=!Array.isArray(It[0]);if(Ne&&Se){for(var tt=0;tt<rt.length;tt++)0<tt&&(Rt+=Ce),Rt+=At(rt[tt],tt);0<It.length&&(Rt+=_e)}for(var Le=0;Le<It.length;Le++){var He=Ne?rt.length:It[Le].length,wt=!1,K=Ne?Object.keys(It[Le]).length===0:It[Le].length===0;if(Gt&&!Ne&&(wt=Gt==="greedy"?It[Le].join("").trim()==="":It[Le].length===1&&It[Le][0].length===0),Gt==="greedy"&&Ne){for(var ne=[],Z=0;Z<He;Z++){var ke=Ae?rt[Z]:Z;ne.push(It[Le][ke])}wt=ne.join("").trim()===""}if(!wt){for(var Be=0;Be<He;Be++){0<Be&&!K&&(Rt+=Ce);var Re=Ne&&Ae?rt[Be]:Be;Rt+=At(It[Le][Re],Be)}Le<It.length-1&&(!Gt||0<He&&!K)&&(Rt+=_e)}}return Rt}function At(rt,It){if(rt==null)return"";if(rt.constructor===Date)return JSON.stringify(rt).slice(1,25);var Gt=!1;Ve&&typeof rt=="string"&&Ve.test(rt)&&(rt="'"+rt,Gt=!0);var Rt=rt.toString().replace(Ge,ut);return(Gt=Gt||pe===!0||typeof pe=="function"&&pe(rt,It)||Array.isArray(pe)&&pe[It]||function(Ne,Ae){for(var tt=0;tt<Ae.length;tt++)if(-1<Ne.indexOf(Ae[tt]))return!0;return!1}(Rt,I.BAD_DELIMITERS)||-1<Rt.indexOf(Ce)||Rt.charAt(0)===" "||Rt.charAt(Rt.length-1)===" ")?Fe+Rt+Fe:Rt}}};if(I.RECORD_SEP=String.fromCharCode(30),I.UNIT_SEP=String.fromCharCode(31),I.BYTE_ORDER_MARK="\uFEFF",I.BAD_DELIMITERS=["\r",`
`,'"',I.BYTE_ORDER_MARK],I.WORKERS_SUPPORTED=!m&&!!h.Worker,I.NODE_STREAM_INPUT=1,I.LocalChunkSize=10485760,I.RemoteChunkSize=5242880,I.DefaultDelimiter=",",I.Parser=ye,I.ParserHandle=re,I.NetworkStreamer=k,I.FileStreamer=F,I.StringStreamer=q,I.ReadableStreamStreamer=X,h.jQuery){var T=h.jQuery;T.fn.parse=function(j){var G=j.config||{},pe=[];return this.each(function(_e){if(!(T(this).prop("tagName").toUpperCase()==="INPUT"&&T(this).attr("type").toLowerCase()==="file"&&h.FileReader)||!this.files||this.files.length===0)return!0;for(var Fe=0;Fe<this.files.length;Fe++)pe.push({file:this.files[Fe],inputElem:this,instanceConfig:T.extend({},G)})}),Se(),this;function Se(){if(pe.length!==0){var _e,Fe,ut,at,je=pe[0];if(ze(j.before)){var Ve=j.before(je.file,je.inputElem);if(typeof Ve=="object"){if(Ve.action==="abort")return _e="AbortError",Fe=je.file,ut=je.inputElem,at=Ve.reason,void(ze(j.error)&&j.error({name:_e},Fe,ut,at));if(Ve.action==="skip")return void Ce();typeof Ve.config=="object"&&(je.instanceConfig=T.extend(je.instanceConfig,Ve.config))}else if(Ve==="skip")return void Ce()}var Ge=je.instanceConfig.complete;je.instanceConfig.complete=function(Tt){ze(Ge)&&Ge(Tt,je.file,je.inputElem),Ce()},I.parse(je.file,je.instanceConfig)}else ze(j.complete)&&j.complete()}function Ce(){pe.splice(0,1),Se()}}}function M(j){this._handle=null,this._finished=!1,this._completed=!1,this._halted=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},function(G){var pe=Qe(G);pe.chunkSize=parseInt(pe.chunkSize),G.step||G.chunk||(pe.chunkSize=null),this._handle=new re(pe),(this._handle.streamer=this)._config=pe}.call(this,j),this.parseChunk=function(G,pe){if(this.isFirstChunk&&ze(this._config.beforeFirstChunk)){var Se=this._config.beforeFirstChunk(G);Se!==void 0&&(G=Se)}this.isFirstChunk=!1,this._halted=!1;var Ce=this._partialLine+G;this._partialLine="";var _e=this._handle.parse(Ce,this._baseIndex,!this._finished);if(!this._handle.paused()&&!this._handle.aborted()){var Fe=_e.meta.cursor;this._finished||(this._partialLine=Ce.substring(Fe-this._baseIndex),this._baseIndex=Fe),_e&&_e.data&&(this._rowCount+=_e.data.length);var ut=this._finished||this._config.preview&&this._rowCount>=this._config.preview;if(_)h.postMessage({results:_e,workerId:I.WORKER_ID,finished:ut});else if(ze(this._config.chunk)&&!pe){if(this._config.chunk(_e,this._handle),this._handle.paused()||this._handle.aborted())return void(this._halted=!0);_e=void 0,this._completeResults=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(_e.data),this._completeResults.errors=this._completeResults.errors.concat(_e.errors),this._completeResults.meta=_e.meta),this._completed||!ut||!ze(this._config.complete)||_e&&_e.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),ut||_e&&_e.meta.paused||this._nextChunk(),_e}this._halted=!0},this._sendError=function(G){ze(this._config.error)?this._config.error(G):_&&this._config.error&&h.postMessage({workerId:I.WORKER_ID,error:G,finished:!1})}}function k(j){var G;(j=j||{}).chunkSize||(j.chunkSize=I.RemoteChunkSize),M.call(this,j),this._nextChunk=m?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(pe){this._input=pe,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(G=new XMLHttpRequest,this._config.withCredentials&&(G.withCredentials=this._config.withCredentials),m||(G.onload=Ue(this._chunkLoaded,this),G.onerror=Ue(this._chunkError,this)),G.open(this._config.downloadRequestBody?"POST":"GET",this._input,!m),this._config.downloadRequestHeaders){var pe=this._config.downloadRequestHeaders;for(var Se in pe)G.setRequestHeader(Se,pe[Se])}if(this._config.chunkSize){var Ce=this._start+this._config.chunkSize-1;G.setRequestHeader("Range","bytes="+this._start+"-"+Ce)}try{G.send(this._config.downloadRequestBody)}catch(_e){this._chunkError(_e.message)}m&&G.status===0&&this._chunkError()}},this._chunkLoaded=function(){G.readyState===4&&(G.status<200||400<=G.status?this._chunkError():(this._start+=this._config.chunkSize?this._config.chunkSize:G.responseText.length,this._finished=!this._config.chunkSize||this._start>=function(pe){var Se=pe.getResponseHeader("Content-Range");return Se===null?-1:parseInt(Se.substring(Se.lastIndexOf("/")+1))}(G),this.parseChunk(G.responseText)))},this._chunkError=function(pe){var Se=G.statusText||pe;this._sendError(new Error(Se))}}function F(j){var G,pe;(j=j||{}).chunkSize||(j.chunkSize=I.LocalChunkSize),M.call(this,j);var Se=typeof FileReader<"u";this.stream=function(Ce){this._input=Ce,pe=Ce.slice||Ce.webkitSlice||Ce.mozSlice,Se?((G=new FileReader).onload=Ue(this._chunkLoaded,this),G.onerror=Ue(this._chunkError,this)):G=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var Ce=this._input;if(this._config.chunkSize){var _e=Math.min(this._start+this._config.chunkSize,this._input.size);Ce=pe.call(Ce,this._start,_e)}var Fe=G.readAsText(Ce,this._config.encoding);Se||this._chunkLoaded({target:{result:Fe}})},this._chunkLoaded=function(Ce){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(Ce.target.result)},this._chunkError=function(){this._sendError(G.error)}}function q(j){var G;M.call(this,j=j||{}),this.stream=function(pe){return G=pe,this._nextChunk()},this._nextChunk=function(){if(!this._finished){var pe,Se=this._config.chunkSize;return Se?(pe=G.substring(0,Se),G=G.substring(Se)):(pe=G,G=""),this._finished=!G,this.parseChunk(pe)}}}function X(j){M.call(this,j=j||{});var G=[],pe=!0,Se=!1;this.pause=function(){M.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){M.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(Ce){this._input=Ce,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){Se&&G.length===1&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),G.length?this.parseChunk(G.shift()):pe=!0},this._streamData=Ue(function(Ce){try{G.push(typeof Ce=="string"?Ce:Ce.toString(this._config.encoding)),pe&&(pe=!1,this._checkIsFinished(),this.parseChunk(G.shift()))}catch(_e){this._streamError(_e)}},this),this._streamError=Ue(function(Ce){this._streamCleanUp(),this._sendError(Ce)},this),this._streamEnd=Ue(function(){this._streamCleanUp(),Se=!0,this._streamData("")},this),this._streamCleanUp=Ue(function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)},this)}function re(j){var G,pe,Se,Ce=Math.pow(2,53),_e=-Ce,Fe=/^\s*-?(\d+\.?|\.\d+|\d+\.\d+)([eE][-+]?\d+)?\s*$/,ut=/^((\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z)))$/,at=this,je=0,Ve=0,Ge=!1,Tt=!1,At=[],rt={data:[],errors:[],meta:{}};if(ze(j.step)){var It=j.step;j.step=function(Le){if(rt=Le,Ne())Rt();else{if(Rt(),rt.data.length===0)return;je+=Le.data.length,j.preview&&je>j.preview?pe.abort():(rt.data=rt.data[0],It(rt,at))}}}function Gt(Le){return j.skipEmptyLines==="greedy"?Le.join("").trim()==="":Le.length===1&&Le[0].length===0}function Rt(){return rt&&Se&&(tt("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+I.DefaultDelimiter+"'"),Se=!1),j.skipEmptyLines&&(rt.data=rt.data.filter(function(Le){return!Gt(Le)})),Ne()&&function(){if(!rt)return;function Le(wt,K){ze(j.transformHeader)&&(wt=j.transformHeader(wt,K)),At.push(wt)}if(Array.isArray(rt.data[0])){for(var He=0;Ne()&&He<rt.data.length;He++)rt.data[He].forEach(Le);rt.data.splice(0,1)}else rt.data.forEach(Le)}(),function(){if(!rt||!j.header&&!j.dynamicTyping&&!j.transform)return rt;function Le(wt,K){var ne,Z=j.header?{}:[];for(ne=0;ne<wt.length;ne++){var ke=ne,Be=wt[ne];j.header&&(ke=ne>=At.length?"__parsed_extra":At[ne]),j.transform&&(Be=j.transform(Be,ke)),Be=Ae(ke,Be),ke==="__parsed_extra"?(Z[ke]=Z[ke]||[],Z[ke].push(Be)):Z[ke]=Be}return j.header&&(ne>At.length?tt("FieldMismatch","TooManyFields","Too many fields: expected "+At.length+" fields but parsed "+ne,Ve+K):ne<At.length&&tt("FieldMismatch","TooFewFields","Too few fields: expected "+At.length+" fields but parsed "+ne,Ve+K)),Z}var He=1;return!rt.data.length||Array.isArray(rt.data[0])?(rt.data=rt.data.map(Le),He=rt.data.length):rt.data=Le(rt.data,0),j.header&&rt.meta&&(rt.meta.fields=At),Ve+=He,rt}()}function Ne(){return j.header&&At.length===0}function Ae(Le,He){return wt=Le,j.dynamicTypingFunction&&j.dynamicTyping[wt]===void 0&&(j.dynamicTyping[wt]=j.dynamicTypingFunction(wt)),(j.dynamicTyping[wt]||j.dynamicTyping)===!0?He==="true"||He==="TRUE"||He!=="false"&&He!=="FALSE"&&(function(K){if(Fe.test(K)){var ne=parseFloat(K);if(_e<ne&&ne<Ce)return!0}return!1}(He)?parseFloat(He):ut.test(He)?new Date(He):He===""?null:He):He;var wt}function tt(Le,He,wt,K){var ne={type:Le,code:He,message:wt};K!==void 0&&(ne.row=K),rt.errors.push(ne)}this.parse=function(Le,He,wt){var K=j.quoteChar||'"';if(j.newline||(j.newline=function(ke,Be){ke=ke.substring(0,1048576);var Re=new RegExp(me(Be)+"([^]*?)"+me(Be),"gm"),Ze=(ke=ke.replace(Re,"")).split("\r"),ot=ke.split(`
`),ht=1<ot.length&&ot[0].length<Ze[0].length;if(Ze.length===1||ht)return`
`;for(var Je=0,lt=0;lt<Ze.length;lt++)Ze[lt][0]===`
`&&Je++;return Je>=Ze.length/2?`\r
`:"\r"}(Le,K)),Se=!1,j.delimiter)ze(j.delimiter)&&(j.delimiter=j.delimiter(Le),rt.meta.delimiter=j.delimiter);else{var ne=function(ke,Be,Re,Ze,ot){var ht,Je,lt,ft;ot=ot||[",","	","|",";",I.RECORD_SEP,I.UNIT_SEP];for(var Mt=0;Mt<ot.length;Mt++){var xt=ot[Mt],$e=0,en=0,Wt=0;lt=void 0;for(var hn=new ye({comments:Ze,delimiter:xt,newline:Be,preview:10}).parse(ke),Mn=0;Mn<hn.data.length;Mn++)if(Re&&Gt(hn.data[Mn]))Wt++;else{var nt=hn.data[Mn].length;en+=nt,lt!==void 0?0<nt&&($e+=Math.abs(nt-lt),lt=nt):lt=nt}0<hn.data.length&&(en/=hn.data.length-Wt),(Je===void 0||$e<=Je)&&(ft===void 0||ft<en)&&1.99<en&&(Je=$e,ht=xt,ft=en)}return{successful:!!(j.delimiter=ht),bestDelimiter:ht}}(Le,j.newline,j.skipEmptyLines,j.comments,j.delimitersToGuess);ne.successful?j.delimiter=ne.bestDelimiter:(Se=!0,j.delimiter=I.DefaultDelimiter),rt.meta.delimiter=j.delimiter}var Z=Qe(j);return j.preview&&j.header&&Z.preview++,G=Le,pe=new ye(Z),rt=pe.parse(G,He,wt),Rt(),Ge?{meta:{paused:!0}}:rt||{meta:{paused:!1}}},this.paused=function(){return Ge},this.pause=function(){Ge=!0,pe.abort(),G=ze(j.chunk)?"":G.substring(pe.getCharIndex())},this.resume=function(){at.streamer._halted?(Ge=!1,at.streamer.parseChunk(G,!0)):setTimeout(at.resume,3)},this.aborted=function(){return Tt},this.abort=function(){Tt=!0,pe.abort(),rt.meta.aborted=!0,ze(j.complete)&&j.complete(rt),G=""}}function me(j){return j.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function ye(j){var G,pe=(j=j||{}).delimiter,Se=j.newline,Ce=j.comments,_e=j.step,Fe=j.preview,ut=j.fastMode,at=G=j.quoteChar===void 0||j.quoteChar===null?'"':j.quoteChar;if(j.escapeChar!==void 0&&(at=j.escapeChar),(typeof pe!="string"||-1<I.BAD_DELIMITERS.indexOf(pe))&&(pe=","),Ce===pe)throw new Error("Comment character same as delimiter");Ce===!0?Ce="#":(typeof Ce!="string"||-1<I.BAD_DELIMITERS.indexOf(Ce))&&(Ce=!1),Se!==`
`&&Se!=="\r"&&Se!==`\r
`&&(Se=`
`);var je=0,Ve=!1;this.parse=function(Ge,Tt,At){if(typeof Ge!="string")throw new Error("Input must be a string");var rt=Ge.length,It=pe.length,Gt=Se.length,Rt=Ce.length,Ne=ze(_e),Ae=[],tt=[],Le=[],He=je=0;if(!Ge)return $t();if(j.header&&!Tt){var wt=Ge.split(Se)[0].split(pe),K=[],ne={},Z=!1;for(var ke in wt){var Be=wt[ke];ze(j.transformHeader)&&(Be=j.transformHeader(Be,ke));var Re=Be,Ze=ne[Be]||0;for(0<Ze&&(Z=!0,Re=Be+"_"+Ze),ne[Be]=Ze+1;K.includes(Re);)Re=Re+"_"+Ze;K.push(Re)}if(Z){var ot=Ge.split(Se);ot[0]=K.join(pe),Ge=ot.join(Se)}}if(ut||ut!==!1&&Ge.indexOf(G)===-1){for(var ht=Ge.split(Se),Je=0;Je<ht.length;Je++){if(Le=ht[Je],je+=Le.length,Je!==ht.length-1)je+=Se.length;else if(At)return $t();if(!Ce||Le.substring(0,Rt)!==Ce){if(Ne){if(Ae=[],Wt(Le.split(pe)),Nt(),Ve)return $t()}else Wt(Le.split(pe));if(Fe&&Fe<=Je)return Ae=Ae.slice(0,Fe),$t(!0)}}return $t()}for(var lt=Ge.indexOf(pe,je),ft=Ge.indexOf(Se,je),Mt=new RegExp(me(at)+me(G),"g"),xt=Ge.indexOf(G,je);;)if(Ge[je]!==G)if(Ce&&Le.length===0&&Ge.substring(je,je+Rt)===Ce){if(ft===-1)return $t();je=ft+Gt,ft=Ge.indexOf(Se,je),lt=Ge.indexOf(pe,je)}else if(lt!==-1&&(lt<ft||ft===-1))Le.push(Ge.substring(je,lt)),je=lt+It,lt=Ge.indexOf(pe,je);else{if(ft===-1)break;if(Le.push(Ge.substring(je,ft)),nt(ft+Gt),Ne&&(Nt(),Ve))return $t();if(Fe&&Ae.length>=Fe)return $t(!0)}else for(xt=je,je++;;){if((xt=Ge.indexOf(G,xt+1))===-1)return At||tt.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:Ae.length,index:je}),Mn();if(xt===rt-1)return Mn(Ge.substring(je,xt).replace(Mt,G));if(G!==at||Ge[xt+1]!==at){if(G===at||xt===0||Ge[xt-1]!==at){lt!==-1&&lt<xt+1&&(lt=Ge.indexOf(pe,xt+1)),ft!==-1&&ft<xt+1&&(ft=Ge.indexOf(Se,xt+1));var $e=hn(ft===-1?lt:Math.min(lt,ft));if(Ge.substr(xt+1+$e,It)===pe){Le.push(Ge.substring(je,xt).replace(Mt,G)),Ge[je=xt+1+$e+It]!==G&&(xt=Ge.indexOf(G,je)),lt=Ge.indexOf(pe,je),ft=Ge.indexOf(Se,je);break}var en=hn(ft);if(Ge.substring(xt+1+en,xt+1+en+Gt)===Se){if(Le.push(Ge.substring(je,xt).replace(Mt,G)),nt(xt+1+en+Gt),lt=Ge.indexOf(pe,je),xt=Ge.indexOf(G,je),Ne&&(Nt(),Ve))return $t();if(Fe&&Ae.length>=Fe)return $t(!0);break}tt.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:Ae.length,index:je}),xt++}}else xt++}return Mn();function Wt(kn){Ae.push(kn),He=je}function hn(kn){var dn=0;if(kn!==-1){var Lt=Ge.substring(xt+1,kn);Lt&&Lt.trim()===""&&(dn=Lt.length)}return dn}function Mn(kn){return At||(kn===void 0&&(kn=Ge.substring(je)),Le.push(kn),je=rt,Wt(Le),Ne&&Nt()),$t()}function nt(kn){je=kn,Wt(Le),Le=[],ft=Ge.indexOf(Se,je)}function $t(kn){return{data:Ae,errors:tt,meta:{delimiter:pe,linebreak:Se,aborted:Ve,truncated:!!kn,cursor:He+(Tt||0)}}}function Nt(){_e($t()),Ae=[],tt=[]}},this.abort=function(){Ve=!0},this.getCharIndex=function(){return je}}function Ee(j){var G=j.data,pe=x[G.workerId],Se=!1;if(G.error)pe.userError(G.error,G.file);else if(G.results&&G.results.data){var Ce={abort:function(){Se=!0,be(G.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:Oe,resume:Oe};if(ze(pe.userStep)){for(var _e=0;_e<G.results.data.length&&(pe.userStep({data:G.results.data[_e],errors:G.results.errors,meta:G.results.meta},Ce),!Se);_e++);delete G.results}else ze(pe.userChunk)&&(pe.userChunk(G.results,Ce,G.file),delete G.results)}G.finished&&!Se&&be(G.workerId,G.results)}function be(j,G){var pe=x[j];ze(pe.userComplete)&&pe.userComplete(G),pe.terminate(),delete x[j]}function Oe(){throw new Error("Not implemented.")}function Qe(j){if(typeof j!="object"||j===null)return j;var G=Array.isArray(j)?[]:{};for(var pe in j)G[pe]=Qe(j[pe]);return G}function Ue(j,G){return function(){j.apply(G,arguments)}}function ze(j){return typeof j=="function"}return _&&(h.onmessage=function(j){var G=j.data;if(I.WORKER_ID===void 0&&G&&(I.WORKER_ID=G.workerId),typeof G.input=="string")h.postMessage({workerId:I.WORKER_ID,results:I.parse(G.input,G.config),finished:!0});else if(h.File&&G.input instanceof File||G.input instanceof Object){var pe=I.parse(G.input,G.config);pe&&h.postMessage({workerId:I.WORKER_ID,results:pe,finished:!0})}}),(k.prototype=Object.create(M.prototype)).constructor=k,(F.prototype=Object.create(M.prototype)).constructor=F,(q.prototype=Object.create(q.prototype)).constructor=q,(X.prototype=Object.create(M.prototype)).constructor=X,I})})(zb);var Bk=zb.exports;class Lb{static async parseFile(s){return new Promise((l,h)=>{Bk.parse(s,{header:!0,delimiter:",",download:!0,skipEmptyLines:!0,complete(m){l(m.data)},error(m){h(m)}})})}static async readAssociationDb(){return(await this.parseFile(this.associationDbFileName)).map((l,h)=>{let m=jn().thematics.map(_=>l[_.value]==="x"?_.value:null);return{id:h,updatedAt:l.maj??null,country:l.pays??null,coords:{x:parseFloat(l.coordo_x.replace(",","."))??null,y:parseFloat(l.coordo_y.replace(",","."))??null},name:l.nom??null,adress:l.adresse??null,indic:l.indic??null,tel:l.numero??null,telOther:l.autre_numero??null,emails:l.email.split(";").map(_=>_.trim())??[],websiteUrl:l.internet??null,status:l.statut??null,year:l.annee??null,budget:l.budget??null,dialog:l.dialogue??null,intervention:l.intervention??null,thematics:m.filter(_=>_!=null)}})}}Wn(Lb,"associationDbFileName","https://docs.google.com/spreadsheets/d/e/2PACX-1vSvwjGskDe6C81X_mESVjkXUHQCzDWcYE-dsUXADsmOf8xbS7zg_fZn-xoztj4-3g/pub?gid=766950911&single=true&output=csv");var Fk=Object.defineProperty,Ok=Object.getOwnPropertyDescriptor,Vk=(e,s,l,h)=>{for(var m=h>1?void 0:h?Ok(s,l):s,_=e.length-1,x;_>=0;_--)(x=e[_])&&(m=(h?x(s,l,m):x(m))||m);return h&&m&&Fk(s,l,m),m};let gm=class extends mr{async mounted(){const s=await Lb.readAssociationDb();Ei().associations=s,jn().countries=[...new Set(s.map(l=>l.country))].sort()}};gm=Vk([pr({components:{OSCMap:fI,AssociationBar:pA,FiltersBar:nk,AboutModal:Ek,RedirectionConfirmModal:Rk}})],gm);const $k=Bt({...ei(),...BE({fullHeight:!0}),...Ar()},"VApp"),Uk=Sn()({name:"VApp",props:$k(),setup(e,s){let{slots:l}=s;const h=is(e),{layoutClasses:m,layoutStyles:_,getLayoutItem:x,items:a,layoutRef:I}=OE(e),{rtlClasses:T}=Gl();return $n(()=>{var M;return ae("div",{ref:I,class:["v-application",h.themeClasses.value,m.value,T.value,e.class],style:[_.value,e.style]},[ae("div",{class:"v-application__wrap"},[(M=l.default)==null?void 0:M.call(l)])])}),{getLayoutItem:x,items:a,theme:h}}}),Nk={class:"App__ctn App__ctn--right"};function jk(e,s,l,h,m,_){const x=Gi("AssociationBar"),a=Gi("FiltersBar"),I=Gi("OSCMap"),T=Gi("AboutModal"),M=Gi("RedirectionConfirmModal");return an(),jd(Uk,{class:"App"},{default:Cx(()=>[ae(x,{class:"App__ctn App__ctn--left"}),jt("div",Nk,[ae(a),ae(I)]),ae(T),ae(M)]),_:1})}const qk=gr(gm,[["render",jk]]);/*!
  * vue-router v4.2.2
  * (c) 2023 Eduardo San Martin Morote
  * @license MIT
  */const Il=typeof window<"u";function Zk(e){return e.__esModule||e[Symbol.toStringTag]==="Module"}const Fn=Object.assign;function Pp(e,s){const l={};for(const h in s){const m=s[h];l[h]=_s(m)?m.map(e):e(m)}return l}const fu=()=>{},_s=Array.isArray,Gk=/\/$/,Wk=e=>e.replace(Gk,"");function kp(e,s,l="/"){let h,m={},_="",x="";const a=s.indexOf("#");let I=s.indexOf("?");return a<I&&a>=0&&(I=-1),I>-1&&(h=s.slice(0,I),_=s.slice(I+1,a>-1?a:s.length),m=e(_)),a>-1&&(h=h||s.slice(0,a),x=s.slice(a,s.length)),h=Yk(h??s,l),{fullPath:h+(_&&"?")+_+x,path:h,query:m,hash:x}}function Hk(e,s){const l=s.query?e(s.query):"";return s.path+(l&&"?")+l+(s.hash||"")}function Dv(e,s){return!s||!e.toLowerCase().startsWith(s.toLowerCase())?e:e.slice(s.length)||"/"}function Xk(e,s,l){const h=s.matched.length-1,m=l.matched.length-1;return h>-1&&h===m&&Fl(s.matched[h],l.matched[m])&&Rb(s.params,l.params)&&e(s.query)===e(l.query)&&s.hash===l.hash}function Fl(e,s){return(e.aliasOf||e)===(s.aliasOf||s)}function Rb(e,s){if(Object.keys(e).length!==Object.keys(s).length)return!1;for(const l in e)if(!Kk(e[l],s[l]))return!1;return!0}function Kk(e,s){return _s(e)?zv(e,s):_s(s)?zv(s,e):e===s}function zv(e,s){return _s(s)?e.length===s.length&&e.every((l,h)=>l===s[h]):e.length===1&&e[0]===s}function Yk(e,s){if(e.startsWith("/"))return e;if(!e)return s;const l=s.split("/"),h=e.split("/"),m=h[h.length-1];(m===".."||m===".")&&h.push("");let _=l.length-1,x,a;for(x=0;x<h.length;x++)if(a=h[x],a!==".")if(a==="..")_>1&&_--;else break;return l.slice(0,_).join("/")+"/"+h.slice(x-(x===h.length?1:0)).join("/")}var zu;(function(e){e.pop="pop",e.push="push"})(zu||(zu={}));var pu;(function(e){e.back="back",e.forward="forward",e.unknown=""})(pu||(pu={}));function Jk(e){if(!e)if(Il){const s=document.querySelector("base");e=s&&s.getAttribute("href")||"/",e=e.replace(/^\w+:\/\/[^\/]+/,"")}else e="/";return e[0]!=="/"&&e[0]!=="#"&&(e="/"+e),Wk(e)}const Qk=/^[^#]+#/;function eM(e,s){return e.replace(Qk,"#")+s}function tM(e,s){const l=document.documentElement.getBoundingClientRect(),h=e.getBoundingClientRect();return{behavior:s.behavior,left:h.left-l.left-(s.left||0),top:h.top-l.top-(s.top||0)}}const tf=()=>({left:window.pageXOffset,top:window.pageYOffset});function nM(e){let s;if("el"in e){const l=e.el,h=typeof l=="string"&&l.startsWith("#"),m=typeof l=="string"?h?document.getElementById(l.slice(1)):document.querySelector(l):l;if(!m)return;s=tM(m,e)}else s=e;"scrollBehavior"in document.documentElement.style?window.scrollTo(s):window.scrollTo(s.left!=null?s.left:window.pageXOffset,s.top!=null?s.top:window.pageYOffset)}function Lv(e,s){return(history.state?history.state.position-s:-1)+e}const ym=new Map;function iM(e,s){ym.set(e,s)}function rM(e){const s=ym.get(e);return ym.delete(e),s}let sM=()=>location.protocol+"//"+location.host;function Bb(e,s){const{pathname:l,search:h,hash:m}=s,_=e.indexOf("#");if(_>-1){let a=m.includes(e.slice(_))?e.slice(_).length:1,I=m.slice(a);return I[0]!=="/"&&(I="/"+I),Dv(I,"")}return Dv(l,e)+h+m}function oM(e,s,l,h){let m=[],_=[],x=null;const a=({state:F})=>{const q=Bb(e,location),X=l.value,re=s.value;let me=0;if(F){if(l.value=q,s.value=F,x&&x===X){x=null;return}me=re?F.position-re.position:0}else h(q);m.forEach(ye=>{ye(l.value,X,{delta:me,type:zu.pop,direction:me?me>0?pu.forward:pu.back:pu.unknown})})};function I(){x=l.value}function T(F){m.push(F);const q=()=>{const X=m.indexOf(F);X>-1&&m.splice(X,1)};return _.push(q),q}function M(){const{history:F}=window;F.state&&F.replaceState(Fn({},F.state,{scroll:tf()}),"")}function k(){for(const F of _)F();_=[],window.removeEventListener("popstate",a),window.removeEventListener("beforeunload",M)}return window.addEventListener("popstate",a),window.addEventListener("beforeunload",M,{passive:!0}),{pauseListeners:I,listen:T,destroy:k}}function Rv(e,s,l,h=!1,m=!1){return{back:e,current:s,forward:l,replaced:h,position:window.history.length,scroll:m?tf():null}}function aM(e){const{history:s,location:l}=window,h={value:Bb(e,l)},m={value:s.state};m.value||_(h.value,{back:null,current:h.value,forward:null,position:s.length-1,replaced:!0,scroll:null},!0);function _(I,T,M){const k=e.indexOf("#"),F=k>-1?(l.host&&document.querySelector("base")?e:e.slice(k))+I:sM()+e+I;try{s[M?"replaceState":"pushState"](T,"",F),m.value=T}catch(q){console.error(q),l[M?"replace":"assign"](F)}}function x(I,T){const M=Fn({},s.state,Rv(m.value.back,I,m.value.forward,!0),T,{position:m.value.position});_(I,M,!0),h.value=I}function a(I,T){const M=Fn({},m.value,s.state,{forward:I,scroll:tf()});_(M.current,M,!0);const k=Fn({},Rv(h.value,I,null),{position:M.position+1},T);_(I,k,!1),h.value=I}return{location:h,state:m,push:a,replace:x}}function lM(e){e=Jk(e);const s=aM(e),l=oM(e,s.state,s.location,s.replace);function h(_,x=!0){x||l.pauseListeners(),history.go(_)}const m=Fn({location:"",base:e,go:h,createHref:eM.bind(null,e)},s,l);return Object.defineProperty(m,"location",{enumerable:!0,get:()=>s.location.value}),Object.defineProperty(m,"state",{enumerable:!0,get:()=>s.state.value}),m}function cM(e){return typeof e=="string"||e&&typeof e=="object"}function Fb(e){return typeof e=="string"||typeof e=="symbol"}const Ao={path:"/",name:void 0,params:{},query:{},hash:"",fullPath:"/",matched:[],meta:{},redirectedFrom:void 0},Ob=Symbol("");var Bv;(function(e){e[e.aborted=4]="aborted",e[e.cancelled=8]="cancelled",e[e.duplicated=16]="duplicated"})(Bv||(Bv={}));function Ol(e,s){return Fn(new Error,{type:e,[Ob]:!0},s)}function Ks(e,s){return e instanceof Error&&Ob in e&&(s==null||!!(e.type&s))}const Fv="[^/]+?",uM={sensitive:!1,strict:!1,start:!0,end:!0},hM=/[.+*?^${}()[\]/\\]/g;function dM(e,s){const l=Fn({},uM,s),h=[];let m=l.start?"^":"";const _=[];for(const T of e){const M=T.length?[]:[90];l.strict&&!T.length&&(m+="/");for(let k=0;k<T.length;k++){const F=T[k];let q=40+(l.sensitive?.25:0);if(F.type===0)k||(m+="/"),m+=F.value.replace(hM,"\\$&"),q+=40;else if(F.type===1){const{value:X,repeatable:re,optional:me,regexp:ye}=F;_.push({name:X,repeatable:re,optional:me});const Ee=ye||Fv;if(Ee!==Fv){q+=10;try{new RegExp(`(${Ee})`)}catch(Oe){throw new Error(`Invalid custom RegExp for param "${X}" (${Ee}): `+Oe.message)}}let be=re?`((?:${Ee})(?:/(?:${Ee}))*)`:`(${Ee})`;k||(be=me&&T.length<2?`(?:/${be})`:"/"+be),me&&(be+="?"),m+=be,q+=20,me&&(q+=-8),re&&(q+=-20),Ee===".*"&&(q+=-50)}M.push(q)}h.push(M)}if(l.strict&&l.end){const T=h.length-1;h[T][h[T].length-1]+=.7000000000000001}l.strict||(m+="/?"),l.end?m+="$":l.strict&&(m+="(?:/|$)");const x=new RegExp(m,l.sensitive?"":"i");function a(T){const M=T.match(x),k={};if(!M)return null;for(let F=1;F<M.length;F++){const q=M[F]||"",X=_[F-1];k[X.name]=q&&X.repeatable?q.split("/"):q}return k}function I(T){let M="",k=!1;for(const F of e){(!k||!M.endsWith("/"))&&(M+="/"),k=!1;for(const q of F)if(q.type===0)M+=q.value;else if(q.type===1){const{value:X,repeatable:re,optional:me}=q,ye=X in T?T[X]:"";if(_s(ye)&&!re)throw new Error(`Provided param "${X}" is an array but it is not repeatable (* or + modifiers)`);const Ee=_s(ye)?ye.join("/"):ye;if(!Ee)if(me)F.length<2&&(M.endsWith("/")?M=M.slice(0,-1):k=!0);else throw new Error(`Missing required param "${X}"`);M+=Ee}}return M||"/"}return{re:x,score:h,keys:_,parse:a,stringify:I}}function fM(e,s){let l=0;for(;l<e.length&&l<s.length;){const h=s[l]-e[l];if(h)return h;l++}return e.length<s.length?e.length===1&&e[0]===40+40?-1:1:e.length>s.length?s.length===1&&s[0]===40+40?1:-1:0}function pM(e,s){let l=0;const h=e.score,m=s.score;for(;l<h.length&&l<m.length;){const _=fM(h[l],m[l]);if(_)return _;l++}if(Math.abs(m.length-h.length)===1){if(Ov(h))return 1;if(Ov(m))return-1}return m.length-h.length}function Ov(e){const s=e[e.length-1];return e.length>0&&s[s.length-1]<0}const mM={type:0,value:""},gM=/[a-zA-Z0-9_]/;function yM(e){if(!e)return[[]];if(e==="/")return[[mM]];if(!e.startsWith("/"))throw new Error(`Invalid path "${e}"`);function s(q){throw new Error(`ERR (${l})/"${T}": ${q}`)}let l=0,h=l;const m=[];let _;function x(){_&&m.push(_),_=[]}let a=0,I,T="",M="";function k(){T&&(l===0?_.push({type:0,value:T}):l===1||l===2||l===3?(_.length>1&&(I==="*"||I==="+")&&s(`A repeatable param (${T}) must be alone in its segment. eg: '/:ids+.`),_.push({type:1,value:T,regexp:M,repeatable:I==="*"||I==="+",optional:I==="*"||I==="?"})):s("Invalid state to consume buffer"),T="")}function F(){T+=I}for(;a<e.length;){if(I=e[a++],I==="\\"&&l!==2){h=l,l=4;continue}switch(l){case 0:I==="/"?(T&&k(),x()):I===":"?(k(),l=1):F();break;case 4:F(),l=h;break;case 1:I==="("?l=2:gM.test(I)?F():(k(),l=0,I!=="*"&&I!=="?"&&I!=="+"&&a--);break;case 2:I===")"?M[M.length-1]=="\\"?M=M.slice(0,-1)+I:l=3:M+=I;break;case 3:k(),l=0,I!=="*"&&I!=="?"&&I!=="+"&&a--,M="";break;default:s("Unknown state");break}}return l===2&&s(`Unfinished custom RegExp for param "${T}"`),k(),x(),m}function _M(e,s,l){const h=dM(yM(e.path),l),m=Fn(h,{record:e,parent:s,children:[],alias:[]});return s&&!m.record.aliasOf==!s.record.aliasOf&&s.children.push(m),m}function vM(e,s){const l=[],h=new Map;s=Uv({strict:!1,end:!0,sensitive:!1},s);function m(M){return h.get(M)}function _(M,k,F){const q=!F,X=xM(M);X.aliasOf=F&&F.record;const re=Uv(s,M),me=[X];if("alias"in M){const be=typeof M.alias=="string"?[M.alias]:M.alias;for(const Oe of be)me.push(Fn({},X,{components:F?F.record.components:X.components,path:Oe,aliasOf:F?F.record:X}))}let ye,Ee;for(const be of me){const{path:Oe}=be;if(k&&Oe[0]!=="/"){const Qe=k.record.path,Ue=Qe[Qe.length-1]==="/"?"":"/";be.path=k.record.path+(Oe&&Ue+Oe)}if(ye=_M(be,k,re),F?F.alias.push(ye):(Ee=Ee||ye,Ee!==ye&&Ee.alias.push(ye),q&&M.name&&!$v(ye)&&x(M.name)),X.children){const Qe=X.children;for(let Ue=0;Ue<Qe.length;Ue++)_(Qe[Ue],ye,F&&F.children[Ue])}F=F||ye,(ye.record.components&&Object.keys(ye.record.components).length||ye.record.name||ye.record.redirect)&&I(ye)}return Ee?()=>{x(Ee)}:fu}function x(M){if(Fb(M)){const k=h.get(M);k&&(h.delete(M),l.splice(l.indexOf(k),1),k.children.forEach(x),k.alias.forEach(x))}else{const k=l.indexOf(M);k>-1&&(l.splice(k,1),M.record.name&&h.delete(M.record.name),M.children.forEach(x),M.alias.forEach(x))}}function a(){return l}function I(M){let k=0;for(;k<l.length&&pM(M,l[k])>=0&&(M.record.path!==l[k].record.path||!Vb(M,l[k]));)k++;l.splice(k,0,M),M.record.name&&!$v(M)&&h.set(M.record.name,M)}function T(M,k){let F,q={},X,re;if("name"in M&&M.name){if(F=h.get(M.name),!F)throw Ol(1,{location:M});re=F.record.name,q=Fn(Vv(k.params,F.keys.filter(Ee=>!Ee.optional).map(Ee=>Ee.name)),M.params&&Vv(M.params,F.keys.map(Ee=>Ee.name))),X=F.stringify(q)}else if("path"in M)X=M.path,F=l.find(Ee=>Ee.re.test(X)),F&&(q=F.parse(X),re=F.record.name);else{if(F=k.name?h.get(k.name):l.find(Ee=>Ee.re.test(k.path)),!F)throw Ol(1,{location:M,currentLocation:k});re=F.record.name,q=Fn({},k.params,M.params),X=F.stringify(q)}const me=[];let ye=F;for(;ye;)me.unshift(ye.record),ye=ye.parent;return{name:re,path:X,params:q,matched:me,meta:wM(me)}}return e.forEach(M=>_(M)),{addRoute:_,resolve:T,removeRoute:x,getRoutes:a,getRecordMatcher:m}}function Vv(e,s){const l={};for(const h of s)h in e&&(l[h]=e[h]);return l}function xM(e){return{path:e.path,redirect:e.redirect,name:e.name,meta:e.meta||{},aliasOf:void 0,beforeEnter:e.beforeEnter,props:bM(e),children:e.children||[],instances:{},leaveGuards:new Set,updateGuards:new Set,enterCallbacks:{},components:"components"in e?e.components||null:e.component&&{default:e.component}}}function bM(e){const s={},l=e.props||!1;if("component"in e)s.default=l;else for(const h in e.components)s[h]=typeof l=="boolean"?l:l[h];return s}function $v(e){for(;e;){if(e.record.aliasOf)return!0;e=e.parent}return!1}function wM(e){return e.reduce((s,l)=>Fn(s,l.meta),{})}function Uv(e,s){const l={};for(const h in e)l[h]=h in s?s[h]:e[h];return l}function Vb(e,s){return s.children.some(l=>l===e||Vb(e,l))}const $b=/#/g,SM=/&/g,CM=/\//g,EM=/=/g,TM=/\?/g,Ub=/\+/g,IM=/%5B/g,AM=/%5D/g,Nb=/%5E/g,PM=/%60/g,jb=/%7B/g,kM=/%7C/g,qb=/%7D/g,MM=/%20/g;function wg(e){return encodeURI(""+e).replace(kM,"|").replace(IM,"[").replace(AM,"]")}function DM(e){return wg(e).replace(jb,"{").replace(qb,"}").replace(Nb,"^")}function _m(e){return wg(e).replace(Ub,"%2B").replace(MM,"+").replace($b,"%23").replace(SM,"%26").replace(PM,"`").replace(jb,"{").replace(qb,"}").replace(Nb,"^")}function zM(e){return _m(e).replace(EM,"%3D")}function LM(e){return wg(e).replace($b,"%23").replace(TM,"%3F")}function RM(e){return e==null?"":LM(e).replace(CM,"%2F")}function kd(e){try{return decodeURIComponent(""+e)}catch{}return""+e}function BM(e){const s={};if(e===""||e==="?")return s;const h=(e[0]==="?"?e.slice(1):e).split("&");for(let m=0;m<h.length;++m){const _=h[m].replace(Ub," "),x=_.indexOf("="),a=kd(x<0?_:_.slice(0,x)),I=x<0?null:kd(_.slice(x+1));if(a in s){let T=s[a];_s(T)||(T=s[a]=[T]),T.push(I)}else s[a]=I}return s}function Nv(e){let s="";for(let l in e){const h=e[l];if(l=zM(l),h==null){h!==void 0&&(s+=(s.length?"&":"")+l);continue}(_s(h)?h.map(_=>_&&_m(_)):[h&&_m(h)]).forEach(_=>{_!==void 0&&(s+=(s.length?"&":"")+l,_!=null&&(s+="="+_))})}return s}function FM(e){const s={};for(const l in e){const h=e[l];h!==void 0&&(s[l]=_s(h)?h.map(m=>m==null?null:""+m):h==null?h:""+h)}return s}const OM=Symbol(""),jv=Symbol(""),Sg=Symbol(""),Zb=Symbol(""),vm=Symbol("");function ru(){let e=[];function s(h){return e.push(h),()=>{const m=e.indexOf(h);m>-1&&e.splice(m,1)}}function l(){e=[]}return{add:s,list:()=>e,reset:l}}function Do(e,s,l,h,m){const _=h&&(h.enterCallbacks[m]=h.enterCallbacks[m]||[]);return()=>new Promise((x,a)=>{const I=k=>{k===!1?a(Ol(4,{from:l,to:s})):k instanceof Error?a(k):cM(k)?a(Ol(2,{from:s,to:k})):(_&&h.enterCallbacks[m]===_&&typeof k=="function"&&_.push(k),x())},T=e.call(h&&h.instances[m],s,l,I);let M=Promise.resolve(T);e.length<3&&(M=M.then(I)),M.catch(k=>a(k))})}function Mp(e,s,l,h){const m=[];for(const _ of e)for(const x in _.components){let a=_.components[x];if(!(s!=="beforeRouteEnter"&&!_.instances[x]))if(VM(a)){const T=(a.__vccOpts||a)[s];T&&m.push(Do(T,l,h,_,x))}else{let I=a();m.push(()=>I.then(T=>{if(!T)return Promise.reject(new Error(`Couldn't resolve component "${x}" at "${_.path}"`));const M=Zk(T)?T.default:T;_.components[x]=M;const F=(M.__vccOpts||M)[s];return F&&Do(F,l,h,_,x)()}))}}return m}function VM(e){return typeof e=="object"||"displayName"in e||"props"in e||"__vccOpts"in e}function qv(e){const s=Zn(Sg),l=Zn(Zb),h=we(()=>s.resolve(Wi(e.to))),m=we(()=>{const{matched:I}=h.value,{length:T}=I,M=I[T-1],k=l.matched;if(!M||!k.length)return-1;const F=k.findIndex(Fl.bind(null,M));if(F>-1)return F;const q=Zv(I[T-2]);return T>1&&Zv(M)===q&&k[k.length-1].path!==q?k.findIndex(Fl.bind(null,I[T-2])):F}),_=we(()=>m.value>-1&&jM(l.params,h.value.params)),x=we(()=>m.value>-1&&m.value===l.matched.length-1&&Rb(l.params,h.value.params));function a(I={}){return NM(I)?s[Wi(e.replace)?"replace":"push"](Wi(e.to)).catch(fu):Promise.resolve()}return{route:h,href:we(()=>h.value.href),isActive:_,isExactActive:x,navigate:a}}const $M=$d({name:"RouterLink",compatConfig:{MODE:3},props:{to:{type:[String,Object],required:!0},replace:Boolean,activeClass:String,exactActiveClass:String,custom:Boolean,ariaCurrentValue:{type:String,default:"page"}},useLink:qv,setup(e,{slots:s}){const l=Oi(qv(e)),{options:h}=Zn(Sg),m=we(()=>({[Gv(e.activeClass,h.linkActiveClass,"router-link-active")]:l.isActive,[Gv(e.exactActiveClass,h.linkExactActiveClass,"router-link-exact-active")]:l.isExactActive}));return()=>{const _=s.default&&s.default(l);return e.custom?_:Oo("a",{"aria-current":l.isExactActive?e.ariaCurrentValue:null,href:l.href,onClick:l.navigate,class:m.value},_)}}}),UM=$M;function NM(e){if(!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)&&!e.defaultPrevented&&!(e.button!==void 0&&e.button!==0)){if(e.currentTarget&&e.currentTarget.getAttribute){const s=e.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(s))return}return e.preventDefault&&e.preventDefault(),!0}}function jM(e,s){for(const l in s){const h=s[l],m=e[l];if(typeof h=="string"){if(h!==m)return!1}else if(!_s(m)||m.length!==h.length||h.some((_,x)=>_!==m[x]))return!1}return!0}function Zv(e){return e?e.aliasOf?e.aliasOf.path:e.path:""}const Gv=(e,s,l)=>e??s??l,qM=$d({name:"RouterView",inheritAttrs:!1,props:{name:{type:String,default:"default"},route:Object},compatConfig:{MODE:3},setup(e,{attrs:s,slots:l}){const h=Zn(vm),m=we(()=>e.route||h.value),_=Zn(jv,0),x=we(()=>{let T=Wi(_);const{matched:M}=m.value;let k;for(;(k=M[T])&&!k.components;)T++;return T}),a=we(()=>m.value.matched[x.value]);Qi(jv,we(()=>x.value+1)),Qi(OM,a),Qi(vm,m);const I=Kt();return wn(()=>[I.value,a.value,e.name],([T,M,k],[F,q,X])=>{M&&(M.instances[k]=T,q&&q!==M&&T&&T===F&&(M.leaveGuards.size||(M.leaveGuards=q.leaveGuards),M.updateGuards.size||(M.updateGuards=q.updateGuards))),T&&M&&(!q||!Fl(M,q)||!F)&&(M.enterCallbacks[k]||[]).forEach(re=>re(T))},{flush:"post"}),()=>{const T=m.value,M=e.name,k=a.value,F=k&&k.components[M];if(!F)return Wv(l.default,{Component:F,route:T});const q=k.props[M],X=q?q===!0?T.params:typeof q=="function"?q(T):q:null,me=Oo(F,Fn({},X,s,{onVnodeUnmounted:ye=>{ye.component.isUnmounted&&(k.instances[M]=null)},ref:I}));return Wv(l.default,{Component:me,route:T})||me}}});function Wv(e,s){if(!e)return null;const l=e(s);return l.length===1?l[0]:l}const ZM=qM;function GM(e){const s=vM(e.routes,e),l=e.parseQuery||BM,h=e.stringifyQuery||Nv,m=e.history,_=ru(),x=ru(),a=ru(),I=bn(Ao);let T=Ao;Il&&e.scrollBehavior&&"scrollRestoration"in history&&(history.scrollRestoration="manual");const M=Pp.bind(null,Ae=>""+Ae),k=Pp.bind(null,RM),F=Pp.bind(null,kd);function q(Ae,tt){let Le,He;return Fb(Ae)?(Le=s.getRecordMatcher(Ae),He=tt):He=Ae,s.addRoute(He,Le)}function X(Ae){const tt=s.getRecordMatcher(Ae);tt&&s.removeRoute(tt)}function re(){return s.getRoutes().map(Ae=>Ae.record)}function me(Ae){return!!s.getRecordMatcher(Ae)}function ye(Ae,tt){if(tt=Fn({},tt||I.value),typeof Ae=="string"){const Z=kp(l,Ae,tt.path),ke=s.resolve({path:Z.path},tt),Be=m.createHref(Z.fullPath);return Fn(Z,ke,{params:F(ke.params),hash:kd(Z.hash),redirectedFrom:void 0,href:Be})}let Le;if("path"in Ae)Le=Fn({},Ae,{path:kp(l,Ae.path,tt.path).path});else{const Z=Fn({},Ae.params);for(const ke in Z)Z[ke]==null&&delete Z[ke];Le=Fn({},Ae,{params:k(Z)}),tt.params=k(tt.params)}const He=s.resolve(Le,tt),wt=Ae.hash||"";He.params=M(F(He.params));const K=Hk(h,Fn({},Ae,{hash:DM(wt),path:He.path})),ne=m.createHref(K);return Fn({fullPath:K,hash:wt,query:h===Nv?FM(Ae.query):Ae.query||{}},He,{redirectedFrom:void 0,href:ne})}function Ee(Ae){return typeof Ae=="string"?kp(l,Ae,I.value.path):Fn({},Ae)}function be(Ae,tt){if(T!==Ae)return Ol(8,{from:tt,to:Ae})}function Oe(Ae){return ze(Ae)}function Qe(Ae){return Oe(Fn(Ee(Ae),{replace:!0}))}function Ue(Ae){const tt=Ae.matched[Ae.matched.length-1];if(tt&&tt.redirect){const{redirect:Le}=tt;let He=typeof Le=="function"?Le(Ae):Le;return typeof He=="string"&&(He=He.includes("?")||He.includes("#")?He=Ee(He):{path:He},He.params={}),Fn({query:Ae.query,hash:Ae.hash,params:"path"in He?{}:Ae.params},He)}}function ze(Ae,tt){const Le=T=ye(Ae),He=I.value,wt=Ae.state,K=Ae.force,ne=Ae.replace===!0,Z=Ue(Le);if(Z)return ze(Fn(Ee(Z),{state:typeof Z=="object"?Fn({},wt,Z.state):wt,force:K,replace:ne}),tt||Le);const ke=Le;ke.redirectedFrom=tt;let Be;return!K&&Xk(h,He,Le)&&(Be=Ol(16,{to:ke,from:He}),At(He,He,!0,!1)),(Be?Promise.resolve(Be):pe(ke,He)).catch(Re=>Ks(Re)?Ks(Re,2)?Re:Tt(Re):Ve(Re,ke,He)).then(Re=>{if(Re){if(Ks(Re,2))return ze(Fn({replace:ne},Ee(Re.to),{state:typeof Re.to=="object"?Fn({},wt,Re.to.state):wt,force:K}),tt||ke)}else Re=Ce(ke,He,!0,ne,wt);return Se(ke,He,Re),Re})}function j(Ae,tt){const Le=be(Ae,tt);return Le?Promise.reject(Le):Promise.resolve()}function G(Ae){const tt=Gt.values().next().value;return tt&&typeof tt.runWithContext=="function"?tt.runWithContext(Ae):Ae()}function pe(Ae,tt){let Le;const[He,wt,K]=WM(Ae,tt);Le=Mp(He.reverse(),"beforeRouteLeave",Ae,tt);for(const Z of He)Z.leaveGuards.forEach(ke=>{Le.push(Do(ke,Ae,tt))});const ne=j.bind(null,Ae,tt);return Le.push(ne),Ne(Le).then(()=>{Le=[];for(const Z of _.list())Le.push(Do(Z,Ae,tt));return Le.push(ne),Ne(Le)}).then(()=>{Le=Mp(wt,"beforeRouteUpdate",Ae,tt);for(const Z of wt)Z.updateGuards.forEach(ke=>{Le.push(Do(ke,Ae,tt))});return Le.push(ne),Ne(Le)}).then(()=>{Le=[];for(const Z of Ae.matched)if(Z.beforeEnter&&!tt.matched.includes(Z))if(_s(Z.beforeEnter))for(const ke of Z.beforeEnter)Le.push(Do(ke,Ae,tt));else Le.push(Do(Z.beforeEnter,Ae,tt));return Le.push(ne),Ne(Le)}).then(()=>(Ae.matched.forEach(Z=>Z.enterCallbacks={}),Le=Mp(K,"beforeRouteEnter",Ae,tt),Le.push(ne),Ne(Le))).then(()=>{Le=[];for(const Z of x.list())Le.push(Do(Z,Ae,tt));return Le.push(ne),Ne(Le)}).catch(Z=>Ks(Z,8)?Z:Promise.reject(Z))}function Se(Ae,tt,Le){for(const He of a.list())G(()=>He(Ae,tt,Le))}function Ce(Ae,tt,Le,He,wt){const K=be(Ae,tt);if(K)return K;const ne=tt===Ao,Z=Il?history.state:{};Le&&(He||ne?m.replace(Ae.fullPath,Fn({scroll:ne&&Z&&Z.scroll},wt)):m.push(Ae.fullPath,wt)),I.value=Ae,At(Ae,tt,Le,ne),Tt()}let _e;function Fe(){_e||(_e=m.listen((Ae,tt,Le)=>{if(!Rt.listening)return;const He=ye(Ae),wt=Ue(He);if(wt){ze(Fn(wt,{replace:!0}),He).catch(fu);return}T=He;const K=I.value;Il&&iM(Lv(K.fullPath,Le.delta),tf()),pe(He,K).catch(ne=>Ks(ne,12)?ne:Ks(ne,2)?(ze(ne.to,He).then(Z=>{Ks(Z,20)&&!Le.delta&&Le.type===zu.pop&&m.go(-1,!1)}).catch(fu),Promise.reject()):(Le.delta&&m.go(-Le.delta,!1),Ve(ne,He,K))).then(ne=>{ne=ne||Ce(He,K,!1),ne&&(Le.delta&&!Ks(ne,8)?m.go(-Le.delta,!1):Le.type===zu.pop&&Ks(ne,20)&&m.go(-1,!1)),Se(He,K,ne)}).catch(fu)}))}let ut=ru(),at=ru(),je;function Ve(Ae,tt,Le){Tt(Ae);const He=at.list();return He.length?He.forEach(wt=>wt(Ae,tt,Le)):console.error(Ae),Promise.reject(Ae)}function Ge(){return je&&I.value!==Ao?Promise.resolve():new Promise((Ae,tt)=>{ut.add([Ae,tt])})}function Tt(Ae){return je||(je=!Ae,Fe(),ut.list().forEach(([tt,Le])=>Ae?Le(Ae):tt()),ut.reset()),Ae}function At(Ae,tt,Le,He){const{scrollBehavior:wt}=e;if(!Il||!wt)return Promise.resolve();const K=!Le&&rM(Lv(Ae.fullPath,0))||(He||!Le)&&history.state&&history.state.scroll||null;return er().then(()=>wt(Ae,tt,K)).then(ne=>ne&&nM(ne)).catch(ne=>Ve(ne,Ae,tt))}const rt=Ae=>m.go(Ae);let It;const Gt=new Set,Rt={currentRoute:I,listening:!0,addRoute:q,removeRoute:X,hasRoute:me,getRoutes:re,resolve:ye,options:e,push:Oe,replace:Qe,go:rt,back:()=>rt(-1),forward:()=>rt(1),beforeEach:_.add,beforeResolve:x.add,afterEach:a.add,onError:at.add,isReady:Ge,install(Ae){const tt=this;Ae.component("RouterLink",UM),Ae.component("RouterView",ZM),Ae.config.globalProperties.$router=tt,Object.defineProperty(Ae.config.globalProperties,"$route",{enumerable:!0,get:()=>Wi(I)}),Il&&!It&&I.value===Ao&&(It=!0,Oe(m.location).catch(wt=>{}));const Le={};for(const wt in Ao)Le[wt]=we(()=>I.value[wt]);Ae.provide(Sg,tt),Ae.provide(Zb,Oi(Le)),Ae.provide(vm,I);const He=Ae.unmount;Gt.add(Ae),Ae.unmount=function(){Gt.delete(Ae),Gt.size<1&&(T=Ao,_e&&_e(),_e=null,I.value=Ao,It=!1,je=!1),He()}}};function Ne(Ae){return Ae.reduce((tt,Le)=>tt.then(()=>G(Le)),Promise.resolve())}return Rt}function WM(e,s){const l=[],h=[],m=[],_=Math.max(s.matched.length,e.matched.length);for(let x=0;x<_;x++){const a=s.matched[x];a&&(e.matched.find(T=>Fl(T,a))?h.push(a):l.push(a));const I=e.matched[x];I&&(s.matched.find(T=>Fl(T,I))||m.push(I))}return[l,h,m]}const HM=GM({history:lM("./"),routes:[]}),nf=aC(qk);nf.use($E);nf.use(uC());nf.use(HM);nf.mount("#app");
