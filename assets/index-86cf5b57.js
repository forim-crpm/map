var ck=Object.defineProperty;var uk=(e,t,i)=>t in e?ck(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i;var hk=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports);var Qn=(e,t,i)=>(uk(e,typeof t!="symbol"?t+"":t,i),i);var Z$=hk((uV,mC)=>{(function(){try{var e=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},t=new Error().stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="530450b5-2ac5-40ce-9783-a9d829c51805",e._sentryDebugIdIdentifier="sentry-dbid-530450b5-2ac5-40ce-9783-a9d829c51805")}catch{}})();(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const c of document.querySelectorAll('link[rel="modulepreload"]'))a(c);new MutationObserver(c=>{for(const d of c)if(d.type==="childList")for(const m of d.addedNodes)m.tagName==="LINK"&&m.rel==="modulepreload"&&a(m)}).observe(document,{childList:!0,subtree:!0});function i(c){const d={};return c.integrity&&(d.integrity=c.integrity),c.referrerPolicy&&(d.referrerPolicy=c.referrerPolicy),c.crossOrigin==="use-credentials"?d.credentials="include":c.crossOrigin==="anonymous"?d.credentials="omit":d.credentials="same-origin",d}function a(c){if(c.ep)return;c.ep=!0;const d=i(c);fetch(c.href,d)}})();function Vy(e,t){const i=Object.create(null),a=e.split(",");for(let c=0;c<a.length;c++)i[a[c]]=!0;return t?c=>!!i[c.toLowerCase()]:c=>!!i[c]}const ai={},qc=[],Vs=()=>{},dk=()=>!1,fk=/^on[^a-z]/,em=e=>fk.test(e),jy=e=>e.startsWith("onUpdate:"),Di=Object.assign,Gy=(e,t)=>{const i=e.indexOf(t);i>-1&&e.splice(i,1)},pk=Object.prototype.hasOwnProperty,An=(e,t)=>pk.call(e,t),en=Array.isArray,Hc=e=>tm(e)==="[object Map]",Zw=e=>tm(e)==="[object Set]",hn=e=>typeof e=="function",Ii=e=>typeof e=="string",qy=e=>typeof e=="symbol",ti=e=>e!==null&&typeof e=="object",Ww=e=>ti(e)&&hn(e.then)&&hn(e.catch),Yw=Object.prototype.toString,tm=e=>Yw.call(e),mk=e=>tm(e).slice(8,-1),Xw=e=>tm(e)==="[object Object]",Hy=e=>Ii(e)&&e!=="NaN"&&e[0]!=="-"&&""+parseInt(e,10)===e,cp=Vy(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),nm=e=>{const t=Object.create(null);return i=>t[i]||(t[i]=e(i))},gk=/-(\w)/g,Ts=nm(e=>e.replace(gk,(t,i)=>i?i.toUpperCase():"")),_k=/\B([A-Z])/g,hu=nm(e=>e.replace(_k,"-$1").toLowerCase()),du=nm(e=>e.charAt(0).toUpperCase()+e.slice(1)),Xg=nm(e=>e?`on${du(e)}`:""),Wh=(e,t)=>!Object.is(e,t),up=(e,t)=>{for(let i=0;i<e.length;i++)e[i](t)},bp=(e,t,i)=>{Object.defineProperty(e,t,{configurable:!0,enumerable:!1,value:i})},E_=e=>{const t=parseFloat(e);return isNaN(t)?e:t},yk=e=>{const t=Ii(e)?Number(e):NaN;return isNaN(t)?e:t};let Xx;const T_=()=>Xx||(Xx=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function Zy(e){if(en(e)){const t={};for(let i=0;i<e.length;i++){const a=e[i],c=Ii(a)?wk(a):Zy(a);if(c)for(const d in c)t[d]=c[d]}return t}else{if(Ii(e))return e;if(ti(e))return e}}const vk=/;(?![^(]*\))/g,xk=/:([^]+)/,bk=/\/\*[^]*?\*\//g;function wk(e){const t={};return e.replace(bk,"").split(vk).forEach(i=>{if(i){const a=i.split(xk);a.length>1&&(t[a[0].trim()]=a[1].trim())}}),t}function im(e){let t="";if(Ii(e))t=e;else if(en(e))for(let i=0;i<e.length;i++){const a=im(e[i]);a&&(t+=a+" ")}else if(ti(e))for(const i in e)e[i]&&(t+=i+" ");return t.trim()}const Sk="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",Ek=Vy(Sk);function Kw(e){return!!e||e===""}const ji=e=>Ii(e)?e:e==null?"":en(e)||ti(e)&&(e.toString===Yw||!hn(e.toString))?JSON.stringify(e,Jw,2):String(e),Jw=(e,t)=>t&&t.__v_isRef?Jw(e,t.value):Hc(t)?{[`Map(${t.size})`]:[...t.entries()].reduce((i,[a,c])=>(i[`${a} =>`]=c,i),{})}:Zw(t)?{[`Set(${t.size})`]:[...t.values()]}:ti(t)&&!en(t)&&!Xw(t)?String(t):t;let cs;class Qw{constructor(t=!1){this.detached=t,this._active=!0,this.effects=[],this.cleanups=[],this.parent=cs,!t&&cs&&(this.index=(cs.scopes||(cs.scopes=[])).push(this)-1)}get active(){return this._active}run(t){if(this._active){const i=cs;try{return cs=this,t()}finally{cs=i}}}on(){cs=this}off(){cs=this.parent}stop(t){if(this._active){let i,a;for(i=0,a=this.effects.length;i<a;i++)this.effects[i].stop();for(i=0,a=this.cleanups.length;i<a;i++)this.cleanups[i]();if(this.scopes)for(i=0,a=this.scopes.length;i<a;i++)this.scopes[i].stop(!0);if(!this.detached&&this.parent&&!t){const c=this.parent.scopes.pop();c&&c!==this&&(this.parent.scopes[this.index]=c,c.index=this.index)}this.parent=void 0,this._active=!1}}}function bd(e){return new Qw(e)}function Tk(e,t=cs){t&&t.active&&t.effects.push(e)}function eS(){return cs}function Jr(e){cs&&cs.cleanups.push(e)}const Wy=e=>{const t=new Set(e);return t.w=0,t.n=0,t},tS=e=>(e.w&jo)>0,nS=e=>(e.n&jo)>0,Ck=({deps:e})=>{if(e.length)for(let t=0;t<e.length;t++)e[t].w|=jo},Ik=e=>{const{deps:t}=e;if(t.length){let i=0;for(let a=0;a<t.length;a++){const c=t[a];tS(c)&&!nS(c)?c.delete(e):t[i++]=c,c.w&=~jo,c.n&=~jo}t.length=i}},wp=new WeakMap;let Ph=0,jo=1;const C_=30;let Us;const Al=Symbol(""),I_=Symbol("");class Yy{constructor(t,i=null,a){this.fn=t,this.scheduler=i,this.active=!0,this.deps=[],this.parent=void 0,Tk(this,a)}run(){if(!this.active)return this.fn();let t=Us,i=No;for(;t;){if(t===this)return;t=t.parent}try{return this.parent=Us,Us=this,No=!0,jo=1<<++Ph,Ph<=C_?Ck(this):Kx(this),this.fn()}finally{Ph<=C_&&Ik(this),jo=1<<--Ph,Us=this.parent,No=i,this.parent=void 0,this.deferStop&&this.stop()}}stop(){Us===this?this.deferStop=!0:this.active&&(Kx(this),this.onStop&&this.onStop(),this.active=!1)}}function Kx(e){const{deps:t}=e;if(t.length){for(let i=0;i<t.length;i++)t[i].delete(e);t.length=0}}let No=!0;const iS=[];function fu(){iS.push(No),No=!1}function pu(){const e=iS.pop();No=e===void 0?!0:e}function Qr(e,t,i){if(No&&Us){let a=wp.get(e);a||wp.set(e,a=new Map);let c=a.get(i);c||a.set(i,c=Wy()),rS(c)}}function rS(e,t){let i=!1;Ph<=C_?nS(e)||(e.n|=jo,i=!tS(e)):i=!e.has(Us),i&&(e.add(Us),Us.deps.push(e))}function Za(e,t,i,a,c,d){const m=wp.get(e);if(!m)return;let l=[];if(t==="clear")l=[...m.values()];else if(i==="length"&&en(e)){const b=Number(a);m.forEach((w,C)=>{(C==="length"||C>=b)&&l.push(w)})}else switch(i!==void 0&&l.push(m.get(i)),t){case"add":en(e)?Hy(i)&&l.push(m.get("length")):(l.push(m.get(Al)),Hc(e)&&l.push(m.get(I_)));break;case"delete":en(e)||(l.push(m.get(Al)),Hc(e)&&l.push(m.get(I_)));break;case"set":Hc(e)&&l.push(m.get(Al));break}if(l.length===1)l[0]&&k_(l[0]);else{const b=[];for(const w of l)w&&b.push(...w);k_(Wy(b))}}function k_(e,t){const i=en(e)?e:[...e];for(const a of i)a.computed&&Jx(a);for(const a of i)a.computed||Jx(a)}function Jx(e,t){(e!==Us||e.allowRecurse)&&(e.scheduler?e.scheduler():e.run())}function kk(e,t){var i;return(i=wp.get(e))==null?void 0:i.get(t)}const Ak=Vy("__proto__,__v_isRef,__isVue"),sS=new Set(Object.getOwnPropertyNames(Symbol).filter(e=>e!=="arguments"&&e!=="caller").map(e=>Symbol[e]).filter(qy)),Pk=Xy(),Rk=Xy(!1,!0),Mk=Xy(!0),Qx=Dk();function Dk(){const e={};return["includes","indexOf","lastIndexOf"].forEach(t=>{e[t]=function(...i){const a=an(this);for(let d=0,m=this.length;d<m;d++)Qr(a,"get",d+"");const c=a[t](...i);return c===-1||c===!1?a[t](...i.map(an)):c}}),["push","pop","shift","unshift","splice"].forEach(t=>{e[t]=function(...i){fu();const a=an(this)[t].apply(this,i);return pu(),a}}),e}function Lk(e){const t=an(this);return Qr(t,"has",e),t.hasOwnProperty(e)}function Xy(e=!1,t=!1){return function(a,c,d){if(c==="__v_isReactive")return!e;if(c==="__v_isReadonly")return e;if(c==="__v_isShallow")return t;if(c==="__v_raw"&&d===(e?t?Xk:uS:t?cS:lS).get(a))return a;const m=en(a);if(!e){if(m&&An(Qx,c))return Reflect.get(Qx,c,d);if(c==="hasOwnProperty")return Lk}const l=Reflect.get(a,c,d);return(qy(c)?sS.has(c):Ak(c))||(e||Qr(a,"get",c),t)?l:Kn(l)?m&&Hy(c)?l:l.value:ti(l)?e?wd(l):er(l):l}}const zk=aS(),Ok=aS(!0);function aS(e=!1){return function(i,a,c,d){let m=i[a];if(Kc(m)&&Kn(m)&&!Kn(c))return!1;if(!e&&(!Sp(c)&&!Kc(c)&&(m=an(m),c=an(c)),!en(i)&&Kn(m)&&!Kn(c)))return m.value=c,!0;const l=en(i)&&Hy(a)?Number(a)<i.length:An(i,a),b=Reflect.set(i,a,c,d);return i===an(d)&&(l?Wh(c,m)&&Za(i,"set",a,c):Za(i,"add",a,c)),b}}function Bk(e,t){const i=An(e,t);e[t];const a=Reflect.deleteProperty(e,t);return a&&i&&Za(e,"delete",t,void 0),a}function Fk(e,t){const i=Reflect.has(e,t);return(!qy(t)||!sS.has(t))&&Qr(e,"has",t),i}function Nk(e){return Qr(e,"iterate",en(e)?"length":Al),Reflect.ownKeys(e)}const oS={get:Pk,set:zk,deleteProperty:Bk,has:Fk,ownKeys:Nk},Uk={get:Mk,set(e,t){return!0},deleteProperty(e,t){return!0}},$k=Di({},oS,{get:Rk,set:Ok}),Ky=e=>e,rm=e=>Reflect.getPrototypeOf(e);function Bf(e,t,i=!1,a=!1){e=e.__v_raw;const c=an(e),d=an(t);i||(t!==d&&Qr(c,"get",t),Qr(c,"get",d));const{has:m}=rm(c),l=a?Ky:i?ev:Yh;if(m.call(c,t))return l(e.get(t));if(m.call(c,d))return l(e.get(d));e!==c&&e.get(t)}function Ff(e,t=!1){const i=this.__v_raw,a=an(i),c=an(e);return t||(e!==c&&Qr(a,"has",e),Qr(a,"has",c)),e===c?i.has(e):i.has(e)||i.has(c)}function Nf(e,t=!1){return e=e.__v_raw,!t&&Qr(an(e),"iterate",Al),Reflect.get(e,"size",e)}function eb(e){e=an(e);const t=an(this);return rm(t).has.call(t,e)||(t.add(e),Za(t,"add",e,e)),this}function tb(e,t){t=an(t);const i=an(this),{has:a,get:c}=rm(i);let d=a.call(i,e);d||(e=an(e),d=a.call(i,e));const m=c.call(i,e);return i.set(e,t),d?Wh(t,m)&&Za(i,"set",e,t):Za(i,"add",e,t),this}function nb(e){const t=an(this),{has:i,get:a}=rm(t);let c=i.call(t,e);c||(e=an(e),c=i.call(t,e)),a&&a.call(t,e);const d=t.delete(e);return c&&Za(t,"delete",e,void 0),d}function ib(){const e=an(this),t=e.size!==0,i=e.clear();return t&&Za(e,"clear",void 0,void 0),i}function Uf(e,t){return function(a,c){const d=this,m=d.__v_raw,l=an(m),b=t?Ky:e?ev:Yh;return!e&&Qr(l,"iterate",Al),m.forEach((w,C)=>a.call(c,b(w),b(C),d))}}function $f(e,t,i){return function(...a){const c=this.__v_raw,d=an(c),m=Hc(d),l=e==="entries"||e===Symbol.iterator&&m,b=e==="keys"&&m,w=c[e](...a),C=i?Ky:t?ev:Yh;return!t&&Qr(d,"iterate",b?I_:Al),{next(){const{value:k,done:M}=w.next();return M?{value:k,done:M}:{value:l?[C(k[0]),C(k[1])]:C(k),done:M}},[Symbol.iterator](){return this}}}}function To(e){return function(...t){return e==="delete"?!1:this}}function Vk(){const e={get(d){return Bf(this,d)},get size(){return Nf(this)},has:Ff,add:eb,set:tb,delete:nb,clear:ib,forEach:Uf(!1,!1)},t={get(d){return Bf(this,d,!1,!0)},get size(){return Nf(this)},has:Ff,add:eb,set:tb,delete:nb,clear:ib,forEach:Uf(!1,!0)},i={get(d){return Bf(this,d,!0)},get size(){return Nf(this,!0)},has(d){return Ff.call(this,d,!0)},add:To("add"),set:To("set"),delete:To("delete"),clear:To("clear"),forEach:Uf(!0,!1)},a={get(d){return Bf(this,d,!0,!0)},get size(){return Nf(this,!0)},has(d){return Ff.call(this,d,!0)},add:To("add"),set:To("set"),delete:To("delete"),clear:To("clear"),forEach:Uf(!0,!0)};return["keys","values","entries",Symbol.iterator].forEach(d=>{e[d]=$f(d,!1,!1),i[d]=$f(d,!0,!1),t[d]=$f(d,!1,!0),a[d]=$f(d,!0,!0)}),[e,i,t,a]}const[jk,Gk,qk,Hk]=Vk();function Jy(e,t){const i=t?e?Hk:qk:e?Gk:jk;return(a,c,d)=>c==="__v_isReactive"?!e:c==="__v_isReadonly"?e:c==="__v_raw"?a:Reflect.get(An(i,c)&&c in a?i:a,c,d)}const Zk={get:Jy(!1,!1)},Wk={get:Jy(!1,!0)},Yk={get:Jy(!0,!1)},lS=new WeakMap,cS=new WeakMap,uS=new WeakMap,Xk=new WeakMap;function Kk(e){switch(e){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function Jk(e){return e.__v_skip||!Object.isExtensible(e)?0:Kk(mk(e))}function er(e){return Kc(e)?e:Qy(e,!1,oS,Zk,lS)}function Qk(e){return Qy(e,!1,$k,Wk,cS)}function wd(e){return Qy(e,!0,Uk,Yk,uS)}function Qy(e,t,i,a,c){if(!ti(e)||e.__v_raw&&!(t&&e.__v_isReactive))return e;const d=c.get(e);if(d)return d;const m=Jk(e);if(m===0)return e;const l=new Proxy(e,m===2?a:i);return c.set(e,l),l}function Uo(e){return Kc(e)?Uo(e.__v_raw):!!(e&&e.__v_isReactive)}function Kc(e){return!!(e&&e.__v_isReadonly)}function Sp(e){return!!(e&&e.__v_isShallow)}function hS(e){return Uo(e)||Kc(e)}function an(e){const t=e&&e.__v_raw;return t?an(t):e}function sm(e){return bp(e,"__v_skip",!0),e}const Yh=e=>ti(e)?er(e):e,ev=e=>ti(e)?wd(e):e;function dS(e){No&&Us&&(e=an(e),rS(e.dep||(e.dep=Wy())))}function fS(e,t){e=an(e);const i=e.dep;i&&k_(i)}function Kn(e){return!!(e&&e.__v_isRef===!0)}function Jt(e){return pS(e,!1)}function wn(e){return pS(e,!0)}function pS(e,t){return Kn(e)?e:new eA(e,t)}class eA{constructor(t,i){this.__v_isShallow=i,this.dep=void 0,this.__v_isRef=!0,this._rawValue=i?t:an(t),this._value=i?t:Yh(t)}get value(){return dS(this),this._value}set value(t){const i=this.__v_isShallow||Sp(t)||Kc(t);t=i?t:an(t),Wh(t,this._rawValue)&&(this._rawValue=t,this._value=i?t:Yh(t),fS(this))}}function hr(e){return Kn(e)?e.value:e}const tA={get:(e,t,i)=>hr(Reflect.get(e,t,i)),set:(e,t,i,a)=>{const c=e[t];return Kn(c)&&!Kn(i)?(c.value=i,!0):Reflect.set(e,t,i,a)}};function mS(e){return Uo(e)?e:new Proxy(e,tA)}function am(e){const t=en(e)?new Array(e.length):{};for(const i in e)t[i]=gS(e,i);return t}class nA{constructor(t,i,a){this._object=t,this._key=i,this._defaultValue=a,this.__v_isRef=!0}get value(){const t=this._object[this._key];return t===void 0?this._defaultValue:t}set value(t){this._object[this._key]=t}get dep(){return kk(an(this._object),this._key)}}class iA{constructor(t){this._getter=t,this.__v_isRef=!0,this.__v_isReadonly=!0}get value(){return this._getter()}}function bn(e,t,i){return Kn(e)?e:hn(e)?new iA(e):ti(e)&&arguments.length>1?gS(e,t,i):Jt(e)}function gS(e,t,i){const a=e[t];return Kn(a)?a:new nA(e,t,i)}class rA{constructor(t,i,a,c){this._setter=i,this.dep=void 0,this.__v_isRef=!0,this.__v_isReadonly=!1,this._dirty=!0,this.effect=new Yy(t,()=>{this._dirty||(this._dirty=!0,fS(this))}),this.effect.computed=this,this.effect.active=this._cacheable=!c,this.__v_isReadonly=a}get value(){const t=an(this);return dS(t),(t._dirty||!t._cacheable)&&(t._dirty=!1,t._value=t.effect.run()),t._value}set value(t){this._setter(t)}}function sA(e,t,i=!1){let a,c;const d=hn(e);return d?(a=e,c=Vs):(a=e.get,c=e.set),new rA(a,c,d||!c,i)}function $o(e,t,i,a){let c;try{c=a?e(...a):e()}catch(d){om(d,t,i)}return c}function Es(e,t,i,a){if(hn(e)){const d=$o(e,t,i,a);return d&&Ww(d)&&d.catch(m=>{om(m,t,i)}),d}const c=[];for(let d=0;d<e.length;d++)c.push(Es(e[d],t,i,a));return c}function om(e,t,i,a=!0){const c=t?t.vnode:null;if(t){let d=t.parent;const m=t.proxy,l=i;for(;d;){const w=d.ec;if(w){for(let C=0;C<w.length;C++)if(w[C](e,m,l)===!1)return}d=d.parent}const b=t.appContext.config.errorHandler;if(b){$o(b,null,10,[e,m,l]);return}}aA(e,i,c,a)}function aA(e,t,i,a=!0){console.error(e)}let Xh=!1,A_=!1;const wr=[];let fa=0;const Zc=[];let ja=null,Sl=0;const _S=Promise.resolve();let tv=null;function Er(e){const t=tv||_S;return e?t.then(this?e.bind(this):e):t}function oA(e){let t=fa+1,i=wr.length;for(;t<i;){const a=t+i>>>1;Kh(wr[a])<e?t=a+1:i=a}return t}function nv(e){(!wr.length||!wr.includes(e,Xh&&e.allowRecurse?fa+1:fa))&&(e.id==null?wr.push(e):wr.splice(oA(e.id),0,e),yS())}function yS(){!Xh&&!A_&&(A_=!0,tv=_S.then(xS))}function lA(e){const t=wr.indexOf(e);t>fa&&wr.splice(t,1)}function cA(e){en(e)?Zc.push(...e):(!ja||!ja.includes(e,e.allowRecurse?Sl+1:Sl))&&Zc.push(e),yS()}function rb(e,t=Xh?fa+1:0){for(;t<wr.length;t++){const i=wr[t];i&&i.pre&&(wr.splice(t,1),t--,i())}}function vS(e){if(Zc.length){const t=[...new Set(Zc)];if(Zc.length=0,ja){ja.push(...t);return}for(ja=t,ja.sort((i,a)=>Kh(i)-Kh(a)),Sl=0;Sl<ja.length;Sl++)ja[Sl]();ja=null,Sl=0}}const Kh=e=>e.id==null?1/0:e.id,uA=(e,t)=>{const i=Kh(e)-Kh(t);if(i===0){if(e.pre&&!t.pre)return-1;if(t.pre&&!e.pre)return 1}return i};function xS(e){A_=!1,Xh=!0,wr.sort(uA);const t=Vs;try{for(fa=0;fa<wr.length;fa++){const i=wr[fa];i&&i.active!==!1&&$o(i,null,14)}}finally{fa=0,wr.length=0,vS(),Xh=!1,tv=null,(wr.length||Zc.length)&&xS()}}function hA(e,t,...i){if(e.isUnmounted)return;const a=e.vnode.props||ai;let c=i;const d=t.startsWith("update:"),m=d&&t.slice(7);if(m&&m in a){const C=`${m==="modelValue"?"model":m}Modifiers`,{number:k,trim:M}=a[C]||ai;M&&(c=i.map(O=>Ii(O)?O.trim():O)),k&&(c=i.map(E_))}let l,b=a[l=Xg(t)]||a[l=Xg(Ts(t))];!b&&d&&(b=a[l=Xg(hu(t))]),b&&Es(b,e,6,c);const w=a[l+"Once"];if(w){if(!e.emitted)e.emitted={};else if(e.emitted[l])return;e.emitted[l]=!0,Es(w,e,6,c)}}function bS(e,t,i=!1){const a=t.emitsCache,c=a.get(e);if(c!==void 0)return c;const d=e.emits;let m={},l=!1;if(!hn(e)){const b=w=>{const C=bS(w,t,!0);C&&(l=!0,Di(m,C))};!i&&t.mixins.length&&t.mixins.forEach(b),e.extends&&b(e.extends),e.mixins&&e.mixins.forEach(b)}return!d&&!l?(ti(e)&&a.set(e,null),null):(en(d)?d.forEach(b=>m[b]=null):Di(m,d),ti(e)&&a.set(e,m),m)}function lm(e,t){return!e||!em(t)?!1:(t=t.slice(2).replace(/Once$/,""),An(e,t[0].toLowerCase()+t.slice(1))||An(e,hu(t))||An(e,t))}let Kr=null,wS=null;function Ep(e){const t=Kr;return Kr=e,wS=e&&e.type.__scopeId||null,t}function SS(e,t=Kr,i){if(!t||e._n)return e;const a=(...c)=>{a._d&&_b(-1);const d=Ep(t);let m;try{m=e(...c)}finally{Ep(d),a._d&&_b(1)}return m};return a._n=!0,a._c=!0,a._d=!0,a}function Kg(e){const{type:t,vnode:i,proxy:a,withProxy:c,props:d,propsOptions:[m],slots:l,attrs:b,emit:w,render:C,renderCache:k,data:M,setupState:O,ctx:j,inheritAttrs:W}=e;let le,he;const be=Ep(e);try{if(i.shapeFlag&4){const Pe=c||a;le=ha(C.call(Pe,Pe,k,d,O,M,j)),he=b}else{const Pe=t;le=ha(Pe.length>1?Pe(d,{attrs:b,slots:l,emit:w}):Pe(d,null)),he=t.props?b:dA(b)}}catch(Pe){Bh.length=0,om(Pe,e,1),le=ue(js)}let ge=le;if(he&&W!==!1){const Pe=Object.keys(he),{shapeFlag:Ue}=ge;Pe.length&&Ue&7&&(m&&Pe.some(jy)&&(he=fA(he,m)),ge=Wa(ge,he))}return i.dirs&&(ge=Wa(ge),ge.dirs=ge.dirs?ge.dirs.concat(i.dirs):i.dirs),i.transition&&(ge.transition=i.transition),le=ge,Ep(be),le}const dA=e=>{let t;for(const i in e)(i==="class"||i==="style"||em(i))&&((t||(t={}))[i]=e[i]);return t},fA=(e,t)=>{const i={};for(const a in e)(!jy(a)||!(a.slice(9)in t))&&(i[a]=e[a]);return i};function pA(e,t,i){const{props:a,children:c,component:d}=e,{props:m,children:l,patchFlag:b}=t,w=d.emitsOptions;if(t.dirs||t.transition)return!0;if(i&&b>=0){if(b&1024)return!0;if(b&16)return a?sb(a,m,w):!!m;if(b&8){const C=t.dynamicProps;for(let k=0;k<C.length;k++){const M=C[k];if(m[M]!==a[M]&&!lm(w,M))return!0}}}else return(c||l)&&(!l||!l.$stable)?!0:a===m?!1:a?m?sb(a,m,w):!0:!!m;return!1}function sb(e,t,i){const a=Object.keys(t);if(a.length!==Object.keys(e).length)return!0;for(let c=0;c<a.length;c++){const d=a[c];if(t[d]!==e[d]&&!lm(i,d))return!0}return!1}function mA({vnode:e,parent:t},i){for(;t&&t.subTree===e;)(e=t.vnode).el=i,t=t.parent}const gA=e=>e.__isSuspense;function _A(e,t){t&&t.pendingBranch?en(e)?t.effects.push(...e):t.effects.push(e):cA(e)}function eo(e,t){return iv(e,null,t)}const Vf={};function Sn(e,t,i){return iv(e,t,i)}function iv(e,t,{immediate:i,deep:a,flush:c,onTrack:d,onTrigger:m}=ai){var l;const b=eS()===((l=qi)==null?void 0:l.scope)?qi:null;let w,C=!1,k=!1;if(Kn(e)?(w=()=>e.value,C=Sp(e)):Uo(e)?(w=()=>e,a=!0):en(e)?(k=!0,C=e.some(Pe=>Uo(Pe)||Sp(Pe)),w=()=>e.map(Pe=>{if(Kn(Pe))return Pe.value;if(Uo(Pe))return Cl(Pe);if(hn(Pe))return $o(Pe,b,2)})):hn(e)?t?w=()=>$o(e,b,2):w=()=>{if(!(b&&b.isUnmounted))return M&&M(),Es(e,b,3,[O])}:w=Vs,t&&a){const Pe=w;w=()=>Cl(Pe())}let M,O=Pe=>{M=be.onStop=()=>{$o(Pe,b,4)}},j;if(nd)if(O=Vs,t?i&&Es(t,b,3,[w(),k?[]:void 0,O]):w(),c==="sync"){const Pe=hP();j=Pe.__watcherHandles||(Pe.__watcherHandles=[])}else return Vs;let W=k?new Array(e.length).fill(Vf):Vf;const le=()=>{if(be.active)if(t){const Pe=be.run();(a||C||(k?Pe.some((Ue,Oe)=>Wh(Ue,W[Oe])):Wh(Pe,W)))&&(M&&M(),Es(t,b,3,[Pe,W===Vf?void 0:k&&W[0]===Vf?[]:W,O]),W=Pe)}else be.run()};le.allowRecurse=!!t;let he;c==="sync"?he=le:c==="post"?he=()=>Xr(le,b&&b.suspense):(le.pre=!0,b&&(le.id=b.uid),he=()=>nv(le));const be=new Yy(w,he);t?i?le():W=be.run():c==="post"?Xr(be.run.bind(be),b&&b.suspense):be.run();const ge=()=>{be.stop(),b&&b.scope&&Gy(b.scope.effects,be)};return j&&j.push(ge),ge}function yA(e,t,i){const a=this.proxy,c=Ii(e)?e.includes(".")?ES(a,e):()=>a[e]:e.bind(a,a);let d;hn(t)?d=t:(d=t.handler,i=t);const m=qi;Jc(this);const l=iv(c,d.bind(a),i);return m?Jc(m):Pl(),l}function ES(e,t){const i=t.split(".");return()=>{let a=e;for(let c=0;c<i.length&&a;c++)a=a[i[c]];return a}}function Cl(e,t){if(!ti(e)||e.__v_skip||(t=t||new Set,t.has(e)))return e;if(t.add(e),Kn(e))Cl(e.value,t);else if(en(e))for(let i=0;i<e.length;i++)Cl(e[i],t);else if(Zw(e)||Hc(e))e.forEach(i=>{Cl(i,t)});else if(Xw(e))for(const i in e)Cl(e[i],t);return e}function ps(e,t){const i=Kr;if(i===null)return e;const a=pm(i)||i.proxy,c=e.dirs||(e.dirs=[]);for(let d=0;d<t.length;d++){let[m,l,b,w=ai]=t[d];m&&(hn(m)&&(m={mounted:m,updated:m}),m.deep&&Cl(l),c.push({dir:m,instance:a,value:l,oldValue:void 0,arg:b,modifiers:w}))}return e}function vl(e,t,i,a){const c=e.dirs,d=t&&t.dirs;for(let m=0;m<c.length;m++){const l=c[m];d&&(l.oldValue=d[m].value);let b=l.dir[a];b&&(fu(),Es(b,i,8,[e.el,l,e,t]),pu())}}function TS(){const e={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return Fl(()=>{e.isMounted=!0}),no(()=>{e.isUnmounting=!0}),e}const bs=[Function,Array],CS={mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:bs,onEnter:bs,onAfterEnter:bs,onEnterCancelled:bs,onBeforeLeave:bs,onLeave:bs,onAfterLeave:bs,onLeaveCancelled:bs,onBeforeAppear:bs,onAppear:bs,onAfterAppear:bs,onAppearCancelled:bs},vA={name:"BaseTransition",props:CS,setup(e,{slots:t}){const i=dv(),a=TS();let c;return()=>{const d=t.default&&rv(t.default(),!0);if(!d||!d.length)return;let m=d[0];if(d.length>1){for(const W of d)if(W.type!==js){m=W;break}}const l=an(e),{mode:b}=l;if(a.isLeaving)return Jg(m);const w=ab(m);if(!w)return Jg(m);const C=Jh(w,l,a,i);Qh(w,C);const k=i.subTree,M=k&&ab(k);let O=!1;const{getTransitionKey:j}=w.type;if(j){const W=j();c===void 0?c=W:W!==c&&(c=W,O=!0)}if(M&&M.type!==js&&(!El(w,M)||O)){const W=Jh(M,l,a,i);if(Qh(M,W),b==="out-in")return a.isLeaving=!0,W.afterLeave=()=>{a.isLeaving=!1,i.update.active!==!1&&i.update()},Jg(m);b==="in-out"&&w.type!==js&&(W.delayLeave=(le,he,be)=>{const ge=IS(a,M);ge[String(M.key)]=M,le._leaveCb=()=>{he(),le._leaveCb=void 0,delete C.delayedLeave},C.delayedLeave=be})}return m}}},xA=vA;function IS(e,t){const{leavingVNodes:i}=e;let a=i.get(t.type);return a||(a=Object.create(null),i.set(t.type,a)),a}function Jh(e,t,i,a){const{appear:c,mode:d,persisted:m=!1,onBeforeEnter:l,onEnter:b,onAfterEnter:w,onEnterCancelled:C,onBeforeLeave:k,onLeave:M,onAfterLeave:O,onLeaveCancelled:j,onBeforeAppear:W,onAppear:le,onAfterAppear:he,onAppearCancelled:be}=t,ge=String(e.key),Pe=IS(i,e),Ue=(V,Z)=>{V&&Es(V,a,9,Z)},Oe=(V,Z)=>{const ae=Z[1];Ue(V,Z),en(V)?V.every(ke=>ke.length<=1)&&ae():V.length<=1&&ae()},Te={mode:d,persisted:m,beforeEnter(V){let Z=l;if(!i.isMounted)if(c)Z=W||l;else return;V._leaveCb&&V._leaveCb(!0);const ae=Pe[ge];ae&&El(e,ae)&&ae.el._leaveCb&&ae.el._leaveCb(),Ue(Z,[V])},enter(V){let Z=b,ae=w,ke=C;if(!i.isMounted)if(c)Z=le||b,ae=he||w,ke=be||C;else return;let _e=!1;const oe=V._enterCb=Re=>{_e||(_e=!0,Re?Ue(ke,[V]):Ue(ae,[V]),Te.delayedLeave&&Te.delayedLeave(),V._enterCb=void 0)};Z?Oe(Z,[V,oe]):oe()},leave(V,Z){const ae=String(e.key);if(V._enterCb&&V._enterCb(!0),i.isUnmounting)return Z();Ue(k,[V]);let ke=!1;const _e=V._leaveCb=oe=>{ke||(ke=!0,Z(),oe?Ue(j,[V]):Ue(O,[V]),V._leaveCb=void 0,Pe[ae]===e&&delete Pe[ae])};Pe[ae]=e,M?Oe(M,[V,_e]):_e()},clone(V){return Jh(V,t,i,a)}};return Te}function Jg(e){if(um(e))return e=Wa(e),e.children=null,e}function ab(e){return um(e)?e.children?e.children[0]:void 0:e}function Qh(e,t){e.shapeFlag&6&&e.component?Qh(e.component.subTree,t):e.shapeFlag&128?(e.ssContent.transition=t.clone(e.ssContent),e.ssFallback.transition=t.clone(e.ssFallback)):e.transition=t}function rv(e,t=!1,i){let a=[],c=0;for(let d=0;d<e.length;d++){let m=e[d];const l=i==null?m.key:String(i)+String(m.key!=null?m.key:d);m.type===yn?(m.patchFlag&128&&c++,a=a.concat(rv(m.children,t,l))):(t||m.type!==js)&&a.push(l!=null?Wa(m,{key:l}):m)}if(c>1)for(let d=0;d<a.length;d++)a[d].patchFlag=-2;return a}function cm(e,t){return hn(e)?(()=>Di({name:e.name},t,{setup:e}))():e}const hp=e=>!!e.type.__asyncLoader,um=e=>e.type.__isKeepAlive;function bA(e,t){kS(e,"a",t)}function wA(e,t){kS(e,"da",t)}function kS(e,t,i=qi){const a=e.__wdc||(e.__wdc=()=>{let c=i;for(;c;){if(c.isDeactivated)return;c=c.parent}return e()});if(hm(t,a,i),i){let c=i.parent;for(;c&&c.parent;)um(c.parent.vnode)&&SA(a,t,i,c),c=c.parent}}function SA(e,t,i,a){const c=hm(t,e,a,!0);PS(()=>{Gy(a[t],c)},i)}function hm(e,t,i=qi,a=!1){if(i){const c=i[e]||(i[e]=[]),d=t.__weh||(t.__weh=(...m)=>{if(i.isUnmounted)return;fu(),Jc(i);const l=Es(t,i,e,m);return Pl(),pu(),l});return a?c.unshift(d):c.push(d),d}}const to=e=>(t,i=qi)=>(!nd||e==="sp")&&hm(e,(...a)=>t(...a),i),sv=to("bm"),Fl=to("m"),EA=to("bu"),AS=to("u"),no=to("bum"),PS=to("um"),TA=to("sp"),CA=to("rtg"),IA=to("rtc");function kA(e,t=qi){hm("ec",e,t)}const av="components",AA="directives";function cr(e,t){return ov(av,e,!0,t)||e}const RS=Symbol.for("v-ndc");function PA(e){return Ii(e)?ov(av,e,!1)||e:e||RS}function Ll(e){return ov(AA,e)}function ov(e,t,i=!0,a=!1){const c=Kr||qi;if(c){const d=c.type;if(e===av){const l=lP(d,!1);if(l&&(l===t||l===Ts(t)||l===du(Ts(t))))return d}const m=ob(c[e]||d[e],t)||ob(c.appContext[e],t);return!m&&a?d:m}}function ob(e,t){return e&&(e[t]||e[Ts(t)]||e[du(Ts(t))])}function Wc(e,t,i,a){let c;const d=i&&i[a];if(en(e)||Ii(e)){c=new Array(e.length);for(let m=0,l=e.length;m<l;m++)c[m]=t(e[m],m,void 0,d&&d[m])}else if(typeof e=="number"){c=new Array(e);for(let m=0;m<e;m++)c[m]=t(m+1,m,void 0,d&&d[m])}else if(ti(e))if(e[Symbol.iterator])c=Array.from(e,(m,l)=>t(m,l,void 0,d&&d[l]));else{const m=Object.keys(e);c=new Array(m.length);for(let l=0,b=m.length;l<b;l++){const w=m[l];c[l]=t(e[w],w,l,d&&d[l])}}else c=[];return i&&(i[a]=c),c}const P_=e=>e?VS(e)?pm(e)||e.proxy:P_(e.parent):null,zh=Di(Object.create(null),{$:e=>e,$el:e=>e.vnode.el,$data:e=>e.data,$props:e=>e.props,$attrs:e=>e.attrs,$slots:e=>e.slots,$refs:e=>e.refs,$parent:e=>P_(e.parent),$root:e=>P_(e.root),$emit:e=>e.emit,$options:e=>lv(e),$forceUpdate:e=>e.f||(e.f=()=>nv(e.update)),$nextTick:e=>e.n||(e.n=Er.bind(e.proxy)),$watch:e=>yA.bind(e)}),Qg=(e,t)=>e!==ai&&!e.__isScriptSetup&&An(e,t),RA={get({_:e},t){const{ctx:i,setupState:a,data:c,props:d,accessCache:m,type:l,appContext:b}=e;let w;if(t[0]!=="$"){const O=m[t];if(O!==void 0)switch(O){case 1:return a[t];case 2:return c[t];case 4:return i[t];case 3:return d[t]}else{if(Qg(a,t))return m[t]=1,a[t];if(c!==ai&&An(c,t))return m[t]=2,c[t];if((w=e.propsOptions[0])&&An(w,t))return m[t]=3,d[t];if(i!==ai&&An(i,t))return m[t]=4,i[t];R_&&(m[t]=0)}}const C=zh[t];let k,M;if(C)return t==="$attrs"&&Qr(e,"get",t),C(e);if((k=l.__cssModules)&&(k=k[t]))return k;if(i!==ai&&An(i,t))return m[t]=4,i[t];if(M=b.config.globalProperties,An(M,t))return M[t]},set({_:e},t,i){const{data:a,setupState:c,ctx:d}=e;return Qg(c,t)?(c[t]=i,!0):a!==ai&&An(a,t)?(a[t]=i,!0):An(e.props,t)||t[0]==="$"&&t.slice(1)in e?!1:(d[t]=i,!0)},has({_:{data:e,setupState:t,accessCache:i,ctx:a,appContext:c,propsOptions:d}},m){let l;return!!i[m]||e!==ai&&An(e,m)||Qg(t,m)||(l=d[0])&&An(l,m)||An(a,m)||An(zh,m)||An(c.config.globalProperties,m)},defineProperty(e,t,i){return i.get!=null?e._.accessCache[t]=0:An(i,"value")&&this.set(e,t,i.value,null),Reflect.defineProperty(e,t,i)}};function lb(e){return en(e)?e.reduce((t,i)=>(t[i]=null,t),{}):e}let R_=!0;function MA(e){const t=lv(e),i=e.proxy,a=e.ctx;R_=!1,t.beforeCreate&&cb(t.beforeCreate,e,"bc");const{data:c,computed:d,methods:m,watch:l,provide:b,inject:w,created:C,beforeMount:k,mounted:M,beforeUpdate:O,updated:j,activated:W,deactivated:le,beforeDestroy:he,beforeUnmount:be,destroyed:ge,unmounted:Pe,render:Ue,renderTracked:Oe,renderTriggered:Te,errorCaptured:V,serverPrefetch:Z,expose:ae,inheritAttrs:ke,components:_e,directives:oe,filters:Re}=t;if(w&&DA(w,a,null),m)for(const qe in m){const je=m[qe];hn(je)&&(a[qe]=je.bind(i))}if(c){const qe=c.call(i,i);ti(qe)&&(e.data=er(qe))}if(R_=!0,d)for(const qe in d){const je=d[qe],Ze=hn(je)?je.bind(i,i):hn(je.get)?je.get.bind(i,i):Vs,kt=!hn(je)&&hn(je.set)?je.set.bind(i):Vs,Et=Ie({get:Ze,set:kt});Object.defineProperty(a,qe,{enumerable:!0,configurable:!0,get:()=>Et.value,set:rt=>Et.value=rt})}if(l)for(const qe in l)MS(l[qe],a,i,qe);if(b){const qe=hn(b)?b.call(i):b;Reflect.ownKeys(qe).forEach(je=>{Sr(je,qe[je])})}C&&cb(C,e,"c");function Qe(qe,je){en(je)?je.forEach(Ze=>qe(Ze.bind(i))):je&&qe(je.bind(i))}if(Qe(sv,k),Qe(Fl,M),Qe(EA,O),Qe(AS,j),Qe(bA,W),Qe(wA,le),Qe(kA,V),Qe(IA,Oe),Qe(CA,Te),Qe(no,be),Qe(PS,Pe),Qe(TA,Z),en(ae))if(ae.length){const qe=e.exposed||(e.exposed={});ae.forEach(je=>{Object.defineProperty(qe,je,{get:()=>i[je],set:Ze=>i[je]=Ze})})}else e.exposed||(e.exposed={});Ue&&e.render===Vs&&(e.render=Ue),ke!=null&&(e.inheritAttrs=ke),_e&&(e.components=_e),oe&&(e.directives=oe)}function DA(e,t,i=Vs){en(e)&&(e=M_(e));for(const a in e){const c=e[a];let d;ti(c)?"default"in c?d=Jn(c.from||a,c.default,!0):d=Jn(c.from||a):d=Jn(c),Kn(d)?Object.defineProperty(t,a,{enumerable:!0,configurable:!0,get:()=>d.value,set:m=>d.value=m}):t[a]=d}}function cb(e,t,i){Es(en(e)?e.map(a=>a.bind(t.proxy)):e.bind(t.proxy),t,i)}function MS(e,t,i,a){const c=a.includes(".")?ES(i,a):()=>i[a];if(Ii(e)){const d=t[e];hn(d)&&Sn(c,d)}else if(hn(e))Sn(c,e.bind(i));else if(ti(e))if(en(e))e.forEach(d=>MS(d,t,i,a));else{const d=hn(e.handler)?e.handler.bind(i):t[e.handler];hn(d)&&Sn(c,d,e)}}function lv(e){const t=e.type,{mixins:i,extends:a}=t,{mixins:c,optionsCache:d,config:{optionMergeStrategies:m}}=e.appContext,l=d.get(t);let b;return l?b=l:!c.length&&!i&&!a?b=t:(b={},c.length&&c.forEach(w=>Tp(b,w,m,!0)),Tp(b,t,m)),ti(t)&&d.set(t,b),b}function Tp(e,t,i,a=!1){const{mixins:c,extends:d}=t;d&&Tp(e,d,i,!0),c&&c.forEach(m=>Tp(e,m,i,!0));for(const m in t)if(!(a&&m==="expose")){const l=LA[m]||i&&i[m];e[m]=l?l(e[m],t[m]):t[m]}return e}const LA={data:ub,props:hb,emits:hb,methods:Rh,computed:Rh,beforeCreate:zr,created:zr,beforeMount:zr,mounted:zr,beforeUpdate:zr,updated:zr,beforeDestroy:zr,beforeUnmount:zr,destroyed:zr,unmounted:zr,activated:zr,deactivated:zr,errorCaptured:zr,serverPrefetch:zr,components:Rh,directives:Rh,watch:OA,provide:ub,inject:zA};function ub(e,t){return t?e?function(){return Di(hn(e)?e.call(this,this):e,hn(t)?t.call(this,this):t)}:t:e}function zA(e,t){return Rh(M_(e),M_(t))}function M_(e){if(en(e)){const t={};for(let i=0;i<e.length;i++)t[e[i]]=e[i];return t}return e}function zr(e,t){return e?[...new Set([].concat(e,t))]:t}function Rh(e,t){return e?Di(Object.create(null),e,t):t}function hb(e,t){return e?en(e)&&en(t)?[...new Set([...e,...t])]:Di(Object.create(null),lb(e),lb(t??{})):t}function OA(e,t){if(!e)return t;if(!t)return e;const i=Di(Object.create(null),e);for(const a in t)i[a]=zr(e[a],t[a]);return i}function DS(){return{app:null,config:{isNativeTag:dk,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let BA=0;function FA(e,t){return function(a,c=null){hn(a)||(a=Di({},a)),c!=null&&!ti(c)&&(c=null);const d=DS(),m=new Set;let l=!1;const b=d.app={_uid:BA++,_component:a,_props:c,_container:null,_context:d,_instance:null,version:dP,get config(){return d.config},set config(w){},use(w,...C){return m.has(w)||(w&&hn(w.install)?(m.add(w),w.install(b,...C)):hn(w)&&(m.add(w),w(b,...C))),b},mixin(w){return d.mixins.includes(w)||d.mixins.push(w),b},component(w,C){return C?(d.components[w]=C,b):d.components[w]},directive(w,C){return C?(d.directives[w]=C,b):d.directives[w]},mount(w,C,k){if(!l){const M=ue(a,c);return M.appContext=d,C&&t?t(M,w):e(M,w,k),l=!0,b._container=w,w.__vue_app__=b,pm(M.component)||M.component.proxy}},unmount(){l&&(e(null,b._container),delete b._container.__vue_app__)},provide(w,C){return d.provides[w]=C,b},runWithContext(w){ed=b;try{return w()}finally{ed=null}}};return b}}let ed=null;function Sr(e,t){if(qi){let i=qi.provides;const a=qi.parent&&qi.parent.provides;a===i&&(i=qi.provides=Object.create(a)),i[e]=t}}function Jn(e,t,i=!1){const a=qi||Kr;if(a||ed){const c=a?a.parent==null?a.vnode.appContext&&a.vnode.appContext.provides:a.parent.provides:ed._context.provides;if(c&&e in c)return c[e];if(arguments.length>1)return i&&hn(t)?t.call(a&&a.proxy):t}}function NA(){return!!(qi||Kr||ed)}function UA(e,t,i,a=!1){const c={},d={};bp(d,fm,1),e.propsDefaults=Object.create(null),LS(e,t,c,d);for(const m in e.propsOptions[0])m in c||(c[m]=void 0);i?e.props=a?c:Qk(c):e.type.props?e.props=c:e.props=d,e.attrs=d}function $A(e,t,i,a){const{props:c,attrs:d,vnode:{patchFlag:m}}=e,l=an(c),[b]=e.propsOptions;let w=!1;if((a||m>0)&&!(m&16)){if(m&8){const C=e.vnode.dynamicProps;for(let k=0;k<C.length;k++){let M=C[k];if(lm(e.emitsOptions,M))continue;const O=t[M];if(b)if(An(d,M))O!==d[M]&&(d[M]=O,w=!0);else{const j=Ts(M);c[j]=D_(b,l,j,O,e,!1)}else O!==d[M]&&(d[M]=O,w=!0)}}}else{LS(e,t,c,d)&&(w=!0);let C;for(const k in l)(!t||!An(t,k)&&((C=hu(k))===k||!An(t,C)))&&(b?i&&(i[k]!==void 0||i[C]!==void 0)&&(c[k]=D_(b,l,k,void 0,e,!0)):delete c[k]);if(d!==l)for(const k in d)(!t||!An(t,k))&&(delete d[k],w=!0)}w&&Za(e,"set","$attrs")}function LS(e,t,i,a){const[c,d]=e.propsOptions;let m=!1,l;if(t)for(let b in t){if(cp(b))continue;const w=t[b];let C;c&&An(c,C=Ts(b))?!d||!d.includes(C)?i[C]=w:(l||(l={}))[C]=w:lm(e.emitsOptions,b)||(!(b in a)||w!==a[b])&&(a[b]=w,m=!0)}if(d){const b=an(i),w=l||ai;for(let C=0;C<d.length;C++){const k=d[C];i[k]=D_(c,b,k,w[k],e,!An(w,k))}}return m}function D_(e,t,i,a,c,d){const m=e[i];if(m!=null){const l=An(m,"default");if(l&&a===void 0){const b=m.default;if(m.type!==Function&&!m.skipFactory&&hn(b)){const{propsDefaults:w}=c;i in w?a=w[i]:(Jc(c),a=w[i]=b.call(null,t),Pl())}else a=b}m[0]&&(d&&!l?a=!1:m[1]&&(a===""||a===hu(i))&&(a=!0))}return a}function zS(e,t,i=!1){const a=t.propsCache,c=a.get(e);if(c)return c;const d=e.props,m={},l=[];let b=!1;if(!hn(e)){const C=k=>{b=!0;const[M,O]=zS(k,t,!0);Di(m,M),O&&l.push(...O)};!i&&t.mixins.length&&t.mixins.forEach(C),e.extends&&C(e.extends),e.mixins&&e.mixins.forEach(C)}if(!d&&!b)return ti(e)&&a.set(e,qc),qc;if(en(d))for(let C=0;C<d.length;C++){const k=Ts(d[C]);db(k)&&(m[k]=ai)}else if(d)for(const C in d){const k=Ts(C);if(db(k)){const M=d[C],O=m[k]=en(M)||hn(M)?{type:M}:Di({},M);if(O){const j=mb(Boolean,O.type),W=mb(String,O.type);O[0]=j>-1,O[1]=W<0||j<W,(j>-1||An(O,"default"))&&l.push(k)}}}const w=[m,l];return ti(e)&&a.set(e,w),w}function db(e){return e[0]!=="$"}function fb(e){const t=e&&e.toString().match(/^\s*(function|class) (\w+)/);return t?t[2]:e===null?"null":""}function pb(e,t){return fb(e)===fb(t)}function mb(e,t){return en(t)?t.findIndex(i=>pb(i,e)):hn(t)&&pb(t,e)?0:-1}const OS=e=>e[0]==="_"||e==="$stable",cv=e=>en(e)?e.map(ha):[ha(e)],VA=(e,t,i)=>{if(t._n)return t;const a=SS((...c)=>cv(t(...c)),i);return a._c=!1,a},BS=(e,t,i)=>{const a=e._ctx;for(const c in e){if(OS(c))continue;const d=e[c];if(hn(d))t[c]=VA(c,d,a);else if(d!=null){const m=cv(d);t[c]=()=>m}}},FS=(e,t)=>{const i=cv(t);e.slots.default=()=>i},jA=(e,t)=>{if(e.vnode.shapeFlag&32){const i=t._;i?(e.slots=an(t),bp(t,"_",i)):BS(t,e.slots={})}else e.slots={},t&&FS(e,t);bp(e.slots,fm,1)},GA=(e,t,i)=>{const{vnode:a,slots:c}=e;let d=!0,m=ai;if(a.shapeFlag&32){const l=t._;l?i&&l===1?d=!1:(Di(c,t),!i&&l===1&&delete c._):(d=!t.$stable,BS(t,c)),m=t}else t&&(FS(e,t),m={default:1});if(d)for(const l in c)!OS(l)&&!(l in m)&&delete c[l]};function L_(e,t,i,a,c=!1){if(en(e)){e.forEach((M,O)=>L_(M,t&&(en(t)?t[O]:t),i,a,c));return}if(hp(a)&&!c)return;const d=a.shapeFlag&4?pm(a.component)||a.component.proxy:a.el,m=c?null:d,{i:l,r:b}=e,w=t&&t.r,C=l.refs===ai?l.refs={}:l.refs,k=l.setupState;if(w!=null&&w!==b&&(Ii(w)?(C[w]=null,An(k,w)&&(k[w]=null)):Kn(w)&&(w.value=null)),hn(b))$o(b,l,12,[m,C]);else{const M=Ii(b),O=Kn(b);if(M||O){const j=()=>{if(e.f){const W=M?An(k,b)?k[b]:C[b]:b.value;c?en(W)&&Gy(W,d):en(W)?W.includes(d)||W.push(d):M?(C[b]=[d],An(k,b)&&(k[b]=C[b])):(b.value=[d],e.k&&(C[e.k]=b.value))}else M?(C[b]=m,An(k,b)&&(k[b]=m)):O&&(b.value=m,e.k&&(C[e.k]=m))};m?(j.id=-1,Xr(j,i)):j()}}}const Xr=_A;function qA(e){return HA(e)}function HA(e,t){const i=T_();i.__VUE__=!0;const{insert:a,remove:c,patchProp:d,createElement:m,createText:l,createComment:b,setText:w,setElementText:C,parentNode:k,nextSibling:M,setScopeId:O=Vs,insertStaticContent:j}=e,W=(X,U,ye,Le=null,De=null,Ve=null,ht=!1,ct=null,pt=!!U.dynamicChildren)=>{if(X===U)return;X&&!El(X,U)&&(Le=xe(X),rt(X,De,Ve,!0),X=null),U.patchFlag===-2&&(pt=!1,U.dynamicChildren=null);const{type:it,ref:ut,shapeFlag:yt}=U;switch(it){case Sd:le(X,U,ye,Le);break;case js:he(X,U,ye,Le);break;case e_:X==null&&be(U,ye,Le,ht);break;case yn:_e(X,U,ye,Le,De,Ve,ht,ct,pt);break;default:yt&1?Ue(X,U,ye,Le,De,Ve,ht,ct,pt):yt&6?oe(X,U,ye,Le,De,Ve,ht,ct,pt):(yt&64||yt&128)&&it.process(X,U,ye,Le,De,Ve,ht,ct,pt,Fe)}ut!=null&&De&&L_(ut,X&&X.ref,Ve,U||X,!U)},le=(X,U,ye,Le)=>{if(X==null)a(U.el=l(U.children),ye,Le);else{const De=U.el=X.el;U.children!==X.children&&w(De,U.children)}},he=(X,U,ye,Le)=>{X==null?a(U.el=b(U.children||""),ye,Le):U.el=X.el},be=(X,U,ye,Le)=>{[X.el,X.anchor]=j(X.children,U,ye,Le,X.el,X.anchor)},ge=({el:X,anchor:U},ye,Le)=>{let De;for(;X&&X!==U;)De=M(X),a(X,ye,Le),X=De;a(U,ye,Le)},Pe=({el:X,anchor:U})=>{let ye;for(;X&&X!==U;)ye=M(X),c(X),X=ye;c(U)},Ue=(X,U,ye,Le,De,Ve,ht,ct,pt)=>{ht=ht||U.type==="svg",X==null?Oe(U,ye,Le,De,Ve,ht,ct,pt):Z(X,U,De,Ve,ht,ct,pt)},Oe=(X,U,ye,Le,De,Ve,ht,ct)=>{let pt,it;const{type:ut,props:yt,shapeFlag:Lt,transition:Be,dirs:jt}=X;if(pt=X.el=m(X.type,Ve,yt&&yt.is,yt),Lt&8?C(pt,X.children):Lt&16&&V(X.children,pt,null,Le,De,Ve&&ut!=="foreignObject",ht,ct),jt&&vl(X,null,Le,"created"),Te(pt,X,X.scopeId,ht,Le),yt){for(const tn in yt)tn!=="value"&&!cp(tn)&&d(pt,tn,null,yt[tn],Ve,X.children,Le,De,He);"value"in yt&&d(pt,"value",null,yt.value),(it=yt.onVnodeBeforeMount)&&la(it,Le,X)}jt&&vl(X,null,Le,"beforeMount");const Xt=(!De||De&&!De.pendingBranch)&&Be&&!Be.persisted;Xt&&Be.beforeEnter(pt),a(pt,U,ye),((it=yt&&yt.onVnodeMounted)||Xt||jt)&&Xr(()=>{it&&la(it,Le,X),Xt&&Be.enter(pt),jt&&vl(X,null,Le,"mounted")},De)},Te=(X,U,ye,Le,De)=>{if(ye&&O(X,ye),Le)for(let Ve=0;Ve<Le.length;Ve++)O(X,Le[Ve]);if(De){let Ve=De.subTree;if(U===Ve){const ht=De.vnode;Te(X,ht,ht.scopeId,ht.slotScopeIds,De.parent)}}},V=(X,U,ye,Le,De,Ve,ht,ct,pt=0)=>{for(let it=pt;it<X.length;it++){const ut=X[it]=ct?Po(X[it]):ha(X[it]);W(null,ut,U,ye,Le,De,Ve,ht,ct)}},Z=(X,U,ye,Le,De,Ve,ht)=>{const ct=U.el=X.el;let{patchFlag:pt,dynamicChildren:it,dirs:ut}=U;pt|=X.patchFlag&16;const yt=X.props||ai,Lt=U.props||ai;let Be;ye&&xl(ye,!1),(Be=Lt.onVnodeBeforeUpdate)&&la(Be,ye,U,X),ut&&vl(U,X,ye,"beforeUpdate"),ye&&xl(ye,!0);const jt=De&&U.type!=="foreignObject";if(it?ae(X.dynamicChildren,it,ct,ye,Le,jt,Ve):ht||je(X,U,ct,null,ye,Le,jt,Ve,!1),pt>0){if(pt&16)ke(ct,U,yt,Lt,ye,Le,De);else if(pt&2&&yt.class!==Lt.class&&d(ct,"class",null,Lt.class,De),pt&4&&d(ct,"style",yt.style,Lt.style,De),pt&8){const Xt=U.dynamicProps;for(let tn=0;tn<Xt.length;tn++){const fn=Xt[tn],st=yt[fn],Ft=Lt[fn];(Ft!==st||fn==="value")&&d(ct,fn,st,Ft,De,X.children,ye,Le,He)}}pt&1&&X.children!==U.children&&C(ct,U.children)}else!ht&&it==null&&ke(ct,U,yt,Lt,ye,Le,De);((Be=Lt.onVnodeUpdated)||ut)&&Xr(()=>{Be&&la(Be,ye,U,X),ut&&vl(U,X,ye,"updated")},Le)},ae=(X,U,ye,Le,De,Ve,ht)=>{for(let ct=0;ct<U.length;ct++){const pt=X[ct],it=U[ct],ut=pt.el&&(pt.type===yn||!El(pt,it)||pt.shapeFlag&70)?k(pt.el):ye;W(pt,it,ut,null,Le,De,Ve,ht,!0)}},ke=(X,U,ye,Le,De,Ve,ht)=>{if(ye!==Le){if(ye!==ai)for(const ct in ye)!cp(ct)&&!(ct in Le)&&d(X,ct,ye[ct],null,ht,U.children,De,Ve,He);for(const ct in Le){if(cp(ct))continue;const pt=Le[ct],it=ye[ct];pt!==it&&ct!=="value"&&d(X,ct,it,pt,ht,U.children,De,Ve,He)}"value"in Le&&d(X,"value",ye.value,Le.value)}},_e=(X,U,ye,Le,De,Ve,ht,ct,pt)=>{const it=U.el=X?X.el:l(""),ut=U.anchor=X?X.anchor:l("");let{patchFlag:yt,dynamicChildren:Lt,slotScopeIds:Be}=U;Be&&(ct=ct?ct.concat(Be):Be),X==null?(a(it,ye,Le),a(ut,ye,Le),V(U.children,ye,ut,De,Ve,ht,ct,pt)):yt>0&&yt&64&&Lt&&X.dynamicChildren?(ae(X.dynamicChildren,Lt,ye,De,Ve,ht,ct),(U.key!=null||De&&U===De.subTree)&&uv(X,U,!0)):je(X,U,ye,ut,De,Ve,ht,ct,pt)},oe=(X,U,ye,Le,De,Ve,ht,ct,pt)=>{U.slotScopeIds=ct,X==null?U.shapeFlag&512?De.ctx.activate(U,ye,Le,ht,pt):Re(U,ye,Le,De,Ve,ht,pt):nt(X,U,pt)},Re=(X,U,ye,Le,De,Ve,ht)=>{const ct=X.component=iP(X,Le,De);if(um(X)&&(ct.ctx.renderer=Fe),rP(ct),ct.asyncDep){if(De&&De.registerDep(ct,Qe),!X.el){const pt=ct.subTree=ue(js);he(null,pt,U,ye)}return}Qe(ct,X,U,ye,De,Ve,ht)},nt=(X,U,ye)=>{const Le=U.component=X.component;if(pA(X,U,ye))if(Le.asyncDep&&!Le.asyncResolved){qe(Le,U,ye);return}else Le.next=U,lA(Le.update),Le.update();else U.el=X.el,Le.vnode=U},Qe=(X,U,ye,Le,De,Ve,ht)=>{const ct=()=>{if(X.isMounted){let{next:ut,bu:yt,u:Lt,parent:Be,vnode:jt}=X,Xt=ut,tn;xl(X,!1),ut?(ut.el=jt.el,qe(X,ut,ht)):ut=jt,yt&&up(yt),(tn=ut.props&&ut.props.onVnodeBeforeUpdate)&&la(tn,Be,ut,jt),xl(X,!0);const fn=Kg(X),st=X.subTree;X.subTree=fn,W(st,fn,k(st.el),xe(st),X,De,Ve),ut.el=fn.el,Xt===null&&mA(X,fn.el),Lt&&Xr(Lt,De),(tn=ut.props&&ut.props.onVnodeUpdated)&&Xr(()=>la(tn,Be,ut,jt),De)}else{let ut;const{el:yt,props:Lt}=U,{bm:Be,m:jt,parent:Xt}=X,tn=hp(U);if(xl(X,!1),Be&&up(Be),!tn&&(ut=Lt&&Lt.onVnodeBeforeMount)&&la(ut,Xt,U),xl(X,!0),yt&&ft){const fn=()=>{X.subTree=Kg(X),ft(yt,X.subTree,X,De,null)};tn?U.type.__asyncLoader().then(()=>!X.isUnmounted&&fn()):fn()}else{const fn=X.subTree=Kg(X);W(null,fn,ye,Le,X,De,Ve),U.el=fn.el}if(jt&&Xr(jt,De),!tn&&(ut=Lt&&Lt.onVnodeMounted)){const fn=U;Xr(()=>la(ut,Xt,fn),De)}(U.shapeFlag&256||Xt&&hp(Xt.vnode)&&Xt.vnode.shapeFlag&256)&&X.a&&Xr(X.a,De),X.isMounted=!0,U=ye=Le=null}},pt=X.effect=new Yy(ct,()=>nv(it),X.scope),it=X.update=()=>pt.run();it.id=X.uid,xl(X,!0),it()},qe=(X,U,ye)=>{U.component=X;const Le=X.vnode.props;X.vnode=U,X.next=null,$A(X,U.props,Le,ye),GA(X,U.children,ye),fu(),rb(),pu()},je=(X,U,ye,Le,De,Ve,ht,ct,pt=!1)=>{const it=X&&X.children,ut=X?X.shapeFlag:0,yt=U.children,{patchFlag:Lt,shapeFlag:Be}=U;if(Lt>0){if(Lt&128){kt(it,yt,ye,Le,De,Ve,ht,ct,pt);return}else if(Lt&256){Ze(it,yt,ye,Le,De,Ve,ht,ct,pt);return}}Be&8?(ut&16&&He(it,De,Ve),yt!==it&&C(ye,yt)):ut&16?Be&16?kt(it,yt,ye,Le,De,Ve,ht,ct,pt):He(it,De,Ve,!0):(ut&8&&C(ye,""),Be&16&&V(yt,ye,Le,De,Ve,ht,ct,pt))},Ze=(X,U,ye,Le,De,Ve,ht,ct,pt)=>{X=X||qc,U=U||qc;const it=X.length,ut=U.length,yt=Math.min(it,ut);let Lt;for(Lt=0;Lt<yt;Lt++){const Be=U[Lt]=pt?Po(U[Lt]):ha(U[Lt]);W(X[Lt],Be,ye,null,De,Ve,ht,ct,pt)}it>ut?He(X,De,Ve,!0,!1,yt):V(U,ye,Le,De,Ve,ht,ct,pt,yt)},kt=(X,U,ye,Le,De,Ve,ht,ct,pt)=>{let it=0;const ut=U.length;let yt=X.length-1,Lt=ut-1;for(;it<=yt&&it<=Lt;){const Be=X[it],jt=U[it]=pt?Po(U[it]):ha(U[it]);if(El(Be,jt))W(Be,jt,ye,null,De,Ve,ht,ct,pt);else break;it++}for(;it<=yt&&it<=Lt;){const Be=X[yt],jt=U[Lt]=pt?Po(U[Lt]):ha(U[Lt]);if(El(Be,jt))W(Be,jt,ye,null,De,Ve,ht,ct,pt);else break;yt--,Lt--}if(it>yt){if(it<=Lt){const Be=Lt+1,jt=Be<ut?U[Be].el:Le;for(;it<=Lt;)W(null,U[it]=pt?Po(U[it]):ha(U[it]),ye,jt,De,Ve,ht,ct,pt),it++}}else if(it>Lt)for(;it<=yt;)rt(X[it],De,Ve,!0),it++;else{const Be=it,jt=it,Xt=new Map;for(it=jt;it<=Lt;it++){const It=U[it]=pt?Po(U[it]):ha(U[it]);It.key!=null&&Xt.set(It.key,it)}let tn,fn=0;const st=Lt-jt+1;let Ft=!1,Nt=0;const On=new Array(st);for(it=0;it<st;it++)On[it]=0;for(it=Be;it<=yt;it++){const It=X[it];if(fn>=st){rt(It,De,Ve,!0);continue}let Hn;if(It.key!=null)Hn=Xt.get(It.key);else for(tn=jt;tn<=Lt;tn++)if(On[tn-jt]===0&&El(It,U[tn])){Hn=tn;break}Hn===void 0?rt(It,De,Ve,!0):(On[Hn-jt]=it+1,Hn>=Nt?Nt=Hn:Ft=!0,W(It,U[Hn],ye,null,De,Ve,ht,ct,pt),fn++)}const qn=Ft?ZA(On):qc;for(tn=qn.length-1,it=st-1;it>=0;it--){const It=jt+it,Hn=U[It],Tr=It+1<ut?U[It+1].el:Le;On[it]===0?W(null,Hn,ye,Tr,De,Ve,ht,ct,pt):Ft&&(tn<0||it!==qn[tn]?Et(Hn,ye,Tr,2):tn--)}}},Et=(X,U,ye,Le,De=null)=>{const{el:Ve,type:ht,transition:ct,children:pt,shapeFlag:it}=X;if(it&6){Et(X.component.subTree,U,ye,Le);return}if(it&128){X.suspense.move(U,ye,Le);return}if(it&64){ht.move(X,U,ye,Fe);return}if(ht===yn){a(Ve,U,ye);for(let yt=0;yt<pt.length;yt++)Et(pt[yt],U,ye,Le);a(X.anchor,U,ye);return}if(ht===e_){ge(X,U,ye);return}if(Le!==2&&it&1&&ct)if(Le===0)ct.beforeEnter(Ve),a(Ve,U,ye),Xr(()=>ct.enter(Ve),De);else{const{leave:yt,delayLeave:Lt,afterLeave:Be}=ct,jt=()=>a(Ve,U,ye),Xt=()=>{yt(Ve,()=>{jt(),Be&&Be()})};Lt?Lt(Ve,jt,Xt):Xt()}else a(Ve,U,ye)},rt=(X,U,ye,Le=!1,De=!1)=>{const{type:Ve,props:ht,ref:ct,children:pt,dynamicChildren:it,shapeFlag:ut,patchFlag:yt,dirs:Lt}=X;if(ct!=null&&L_(ct,null,ye,X,!0),ut&256){U.ctx.deactivate(X);return}const Be=ut&1&&Lt,jt=!hp(X);let Xt;if(jt&&(Xt=ht&&ht.onVnodeBeforeUnmount)&&la(Xt,U,X),ut&6)Wt(X.component,ye,Le);else{if(ut&128){X.suspense.unmount(ye,Le);return}Be&&vl(X,null,U,"beforeUnmount"),ut&64?X.type.remove(X,U,ye,De,Fe,Le):it&&(Ve!==yn||yt>0&&yt&64)?He(it,U,ye,!1,!0):(Ve===yn&&yt&384||!De&&ut&16)&&He(pt,U,ye),Le&&At(X)}(jt&&(Xt=ht&&ht.onVnodeUnmounted)||Be)&&Xr(()=>{Xt&&la(Xt,U,X),Be&&vl(X,null,U,"unmounted")},ye)},At=X=>{const{type:U,el:ye,anchor:Le,transition:De}=X;if(U===yn){Pt(ye,Le);return}if(U===e_){Pe(X);return}const Ve=()=>{c(ye),De&&!De.persisted&&De.afterLeave&&De.afterLeave()};if(X.shapeFlag&1&&De&&!De.persisted){const{leave:ht,delayLeave:ct}=De,pt=()=>ht(ye,Ve);ct?ct(X.el,Ve,pt):pt()}else Ve()},Pt=(X,U)=>{let ye;for(;X!==U;)ye=M(X),c(X),X=ye;c(U)},Wt=(X,U,ye)=>{const{bum:Le,scope:De,update:Ve,subTree:ht,um:ct}=X;Le&&up(Le),De.stop(),Ve&&(Ve.active=!1,rt(ht,X,U,ye)),ct&&Xr(ct,U),Xr(()=>{X.isUnmounted=!0},U),U&&U.pendingBranch&&!U.isUnmounted&&X.asyncDep&&!X.asyncResolved&&X.suspenseId===U.pendingId&&(U.deps--,U.deps===0&&U.resolve())},He=(X,U,ye,Le=!1,De=!1,Ve=0)=>{for(let ht=Ve;ht<X.length;ht++)rt(X[ht],U,ye,Le,De)},xe=X=>X.shapeFlag&6?xe(X.component.subTree):X.shapeFlag&128?X.suspense.next():M(X.anchor||X.el),Ke=(X,U,ye)=>{X==null?U._vnode&&rt(U._vnode,null,null,!0):W(U._vnode||null,X,U,null,null,null,ye),rb(),vS(),U._vnode=X},Fe={p:W,um:rt,m:Et,r:At,mt:Re,mc:V,pc:je,pbc:ae,n:xe,o:e};let Ge,ft;return t&&([Ge,ft]=t(Fe)),{render:Ke,hydrate:Ge,createApp:FA(Ke,Ge)}}function xl({effect:e,update:t},i){e.allowRecurse=t.allowRecurse=i}function uv(e,t,i=!1){const a=e.children,c=t.children;if(en(a)&&en(c))for(let d=0;d<a.length;d++){const m=a[d];let l=c[d];l.shapeFlag&1&&!l.dynamicChildren&&((l.patchFlag<=0||l.patchFlag===32)&&(l=c[d]=Po(c[d]),l.el=m.el),i||uv(m,l)),l.type===Sd&&(l.el=m.el)}}function ZA(e){const t=e.slice(),i=[0];let a,c,d,m,l;const b=e.length;for(a=0;a<b;a++){const w=e[a];if(w!==0){if(c=i[i.length-1],e[c]<w){t[a]=c,i.push(a);continue}for(d=0,m=i.length-1;d<m;)l=d+m>>1,e[i[l]]<w?d=l+1:m=l;w<e[i[d]]&&(d>0&&(t[a]=i[d-1]),i[d]=a)}}for(d=i.length,m=i[d-1];d-- >0;)i[d]=m,m=t[m];return i}const WA=e=>e.__isTeleport,Oh=e=>e&&(e.disabled||e.disabled===""),gb=e=>typeof SVGElement<"u"&&e instanceof SVGElement,z_=(e,t)=>{const i=e&&e.to;return Ii(i)?t?t(i):null:i},YA={__isTeleport:!0,process(e,t,i,a,c,d,m,l,b,w){const{mc:C,pc:k,pbc:M,o:{insert:O,querySelector:j,createText:W,createComment:le}}=w,he=Oh(t.props);let{shapeFlag:be,children:ge,dynamicChildren:Pe}=t;if(e==null){const Ue=t.el=W(""),Oe=t.anchor=W("");O(Ue,i,a),O(Oe,i,a);const Te=t.target=z_(t.props,j),V=t.targetAnchor=W("");Te&&(O(V,Te),m=m||gb(Te));const Z=(ae,ke)=>{be&16&&C(ge,ae,ke,c,d,m,l,b)};he?Z(i,Oe):Te&&Z(Te,V)}else{t.el=e.el;const Ue=t.anchor=e.anchor,Oe=t.target=e.target,Te=t.targetAnchor=e.targetAnchor,V=Oh(e.props),Z=V?i:Oe,ae=V?Ue:Te;if(m=m||gb(Oe),Pe?(M(e.dynamicChildren,Pe,Z,c,d,m,l),uv(e,t,!0)):b||k(e,t,Z,ae,c,d,m,l,!1),he)V||jf(t,i,Ue,w,1);else if((t.props&&t.props.to)!==(e.props&&e.props.to)){const ke=t.target=z_(t.props,j);ke&&jf(t,ke,null,w,0)}else V&&jf(t,Oe,Te,w,1)}NS(t)},remove(e,t,i,a,{um:c,o:{remove:d}},m){const{shapeFlag:l,children:b,anchor:w,targetAnchor:C,target:k,props:M}=e;if(k&&d(C),(m||!Oh(M))&&(d(w),l&16))for(let O=0;O<b.length;O++){const j=b[O];c(j,t,i,!0,!!j.dynamicChildren)}},move:jf,hydrate:XA};function jf(e,t,i,{o:{insert:a},m:c},d=2){d===0&&a(e.targetAnchor,t,i);const{el:m,anchor:l,shapeFlag:b,children:w,props:C}=e,k=d===2;if(k&&a(m,t,i),(!k||Oh(C))&&b&16)for(let M=0;M<w.length;M++)c(w[M],t,i,2);k&&a(l,t,i)}function XA(e,t,i,a,c,d,{o:{nextSibling:m,parentNode:l,querySelector:b}},w){const C=t.target=z_(t.props,b);if(C){const k=C._lpa||C.firstChild;if(t.shapeFlag&16)if(Oh(t.props))t.anchor=w(m(e),t,l(e),i,a,c,d),t.targetAnchor=k;else{t.anchor=m(e);let M=k;for(;M;)if(M=m(M),M&&M.nodeType===8&&M.data==="teleport anchor"){t.targetAnchor=M,C._lpa=t.targetAnchor&&m(t.targetAnchor);break}w(k,t,C,i,a,c,d)}NS(t)}return t.anchor&&m(t.anchor)}const KA=YA;function NS(e){const t=e.ctx;if(t&&t.ut){let i=e.children[0].el;for(;i!==e.targetAnchor;)i.nodeType===1&&i.setAttribute("data-v-owner",t.uid),i=i.nextSibling;t.ut()}}const yn=Symbol.for("v-fgt"),Sd=Symbol.for("v-txt"),js=Symbol.for("v-cmt"),e_=Symbol.for("v-stc"),Bh=[];let $s=null;function un(e=!1){Bh.push($s=e?null:[])}function JA(){Bh.pop(),$s=Bh[Bh.length-1]||null}let td=1;function _b(e){td+=e}function US(e){return e.dynamicChildren=td>0?$s||qc:null,JA(),td>0&&$s&&$s.push(e),e}function mn(e,t,i,a,c,d){return US(Bt(e,t,i,a,c,d,!0))}function dm(e,t,i,a,c){return US(ue(e,t,i,a,c,!0))}function O_(e){return e?e.__v_isVNode===!0:!1}function El(e,t){return e.type===t.type&&e.key===t.key}const fm="__vInternal",$S=({key:e})=>e??null,dp=({ref:e,ref_key:t,ref_for:i})=>(typeof e=="number"&&(e=""+e),e!=null?Ii(e)||Kn(e)||hn(e)?{i:Kr,r:e,k:t,f:!!i}:e:null);function Bt(e,t=null,i=null,a=0,c=null,d=e===yn?0:1,m=!1,l=!1){const b={__v_isVNode:!0,__v_skip:!0,type:e,props:t,key:t&&$S(t),ref:t&&dp(t),scopeId:wS,slotScopeIds:null,children:i,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetAnchor:null,staticCount:0,shapeFlag:d,patchFlag:a,dynamicProps:c,dynamicChildren:null,appContext:null,ctx:Kr};return l?(hv(b,i),d&128&&e.normalize(b)):i&&(b.shapeFlag|=Ii(i)?8:16),td>0&&!m&&$s&&(b.patchFlag>0||d&6)&&b.patchFlag!==32&&$s.push(b),b}const ue=QA;function QA(e,t=null,i=null,a=0,c=null,d=!1){if((!e||e===RS)&&(e=js),O_(e)){const l=Wa(e,t,!0);return i&&hv(l,i),td>0&&!d&&$s&&(l.shapeFlag&6?$s[$s.indexOf(e)]=l:$s.push(l)),l.patchFlag|=-2,l}if(cP(e)&&(e=e.__vccOpts),t){t=eP(t);let{class:l,style:b}=t;l&&!Ii(l)&&(t.class=im(l)),ti(b)&&(hS(b)&&!en(b)&&(b=Di({},b)),t.style=Zy(b))}const m=Ii(e)?1:gA(e)?128:WA(e)?64:ti(e)?4:hn(e)?2:0;return Bt(e,t,i,a,c,m,d,!0)}function eP(e){return e?hS(e)||fm in e?Di({},e):e:null}function Wa(e,t,i=!1){const{props:a,ref:c,patchFlag:d,children:m}=e,l=t?kn(a||{},t):a;return{__v_isVNode:!0,__v_skip:!0,type:e.type,props:l,key:l&&$S(l),ref:t&&t.ref?i&&c?en(c)?c.concat(dp(t)):[c,dp(t)]:dp(t):c,scopeId:e.scopeId,slotScopeIds:e.slotScopeIds,children:m,target:e.target,targetAnchor:e.targetAnchor,staticCount:e.staticCount,shapeFlag:e.shapeFlag,patchFlag:t&&e.type!==yn?d===-1?16:d|16:d,dynamicProps:e.dynamicProps,dynamicChildren:e.dynamicChildren,appContext:e.appContext,dirs:e.dirs,transition:e.transition,component:e.component,suspense:e.suspense,ssContent:e.ssContent&&Wa(e.ssContent),ssFallback:e.ssFallback&&Wa(e.ssFallback),el:e.el,anchor:e.anchor,ctx:e.ctx,ce:e.ce}}function Vo(e=" ",t=0){return ue(Sd,null,e,t)}function or(e="",t=!1){return t?(un(),dm(js,null,e)):ue(js,null,e)}function ha(e){return e==null||typeof e=="boolean"?ue(js):en(e)?ue(yn,null,e.slice()):typeof e=="object"?Po(e):ue(Sd,null,String(e))}function Po(e){return e.el===null&&e.patchFlag!==-1||e.memo?e:Wa(e)}function hv(e,t){let i=0;const{shapeFlag:a}=e;if(t==null)t=null;else if(en(t))i=16;else if(typeof t=="object")if(a&65){const c=t.default;c&&(c._c&&(c._d=!1),hv(e,c()),c._c&&(c._d=!0));return}else{i=32;const c=t._;!c&&!(fm in t)?t._ctx=Kr:c===3&&Kr&&(Kr.slots._===1?t._=1:(t._=2,e.patchFlag|=1024))}else hn(t)?(t={default:t,_ctx:Kr},i=32):(t=String(t),a&64?(i=16,t=[Vo(t)]):i=8);e.children=t,e.shapeFlag|=i}function kn(...e){const t={};for(let i=0;i<e.length;i++){const a=e[i];for(const c in a)if(c==="class")t.class!==a.class&&(t.class=im([t.class,a.class]));else if(c==="style")t.style=Zy([t.style,a.style]);else if(em(c)){const d=t[c],m=a[c];m&&d!==m&&!(en(d)&&d.includes(m))&&(t[c]=d?[].concat(d,m):m)}else c!==""&&(t[c]=a[c])}return t}function la(e,t,i,a=null){Es(e,t,7,[i,a])}const tP=DS();let nP=0;function iP(e,t,i){const a=e.type,c=(t?t.appContext:e.appContext)||tP,d={uid:nP++,vnode:e,type:a,parent:t,appContext:c,root:null,next:null,subTree:null,effect:null,update:null,scope:new Qw(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:t?t.provides:Object.create(c.provides),accessCache:null,renderCache:[],components:null,directives:null,propsOptions:zS(a,c),emitsOptions:bS(a,c),emit:null,emitted:null,propsDefaults:ai,inheritAttrs:a.inheritAttrs,ctx:ai,data:ai,props:ai,attrs:ai,slots:ai,refs:ai,setupState:ai,setupContext:null,attrsProxy:null,slotsProxy:null,suspense:i,suspenseId:i?i.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return d.ctx={_:d},d.root=t?t.root:d,d.emit=hA.bind(null,d),e.ce&&e.ce(d),d}let qi=null;const dv=()=>qi||Kr;let fv,Dc,yb="__VUE_INSTANCE_SETTERS__";(Dc=T_()[yb])||(Dc=T_()[yb]=[]),Dc.push(e=>qi=e),fv=e=>{Dc.length>1?Dc.forEach(t=>t(e)):Dc[0](e)};const Jc=e=>{fv(e),e.scope.on()},Pl=()=>{qi&&qi.scope.off(),fv(null)};function VS(e){return e.vnode.shapeFlag&4}let nd=!1;function rP(e,t=!1){nd=t;const{props:i,children:a}=e.vnode,c=VS(e);UA(e,i,c,t),jA(e,a);const d=c?sP(e,t):void 0;return nd=!1,d}function sP(e,t){const i=e.type;e.accessCache=Object.create(null),e.proxy=sm(new Proxy(e.ctx,RA));const{setup:a}=i;if(a){const c=e.setupContext=a.length>1?oP(e):null;Jc(e),fu();const d=$o(a,e,0,[e.props,c]);if(pu(),Pl(),Ww(d)){if(d.then(Pl,Pl),t)return d.then(m=>{vb(e,m,t)}).catch(m=>{om(m,e,0)});e.asyncDep=d}else vb(e,d,t)}else jS(e,t)}function vb(e,t,i){hn(t)?e.type.__ssrInlineRender?e.ssrRender=t:e.render=t:ti(t)&&(e.setupState=mS(t)),jS(e,i)}let xb;function jS(e,t,i){const a=e.type;if(!e.render){if(!t&&xb&&!a.render){const c=a.template||lv(e).template;if(c){const{isCustomElement:d,compilerOptions:m}=e.appContext.config,{delimiters:l,compilerOptions:b}=a,w=Di(Di({isCustomElement:d,delimiters:l},m),b);a.render=xb(c,w)}}e.render=a.render||Vs}Jc(e),fu(),MA(e),pu(),Pl()}function aP(e){return e.attrsProxy||(e.attrsProxy=new Proxy(e.attrs,{get(t,i){return Qr(e,"get","$attrs"),t[i]}}))}function oP(e){const t=i=>{e.exposed=i||{}};return{get attrs(){return aP(e)},slots:e.slots,emit:e.emit,expose:t}}function pm(e){if(e.exposed)return e.exposeProxy||(e.exposeProxy=new Proxy(mS(sm(e.exposed)),{get(t,i){if(i in t)return t[i];if(i in zh)return zh[i](e)},has(t,i){return i in t||i in zh}}))}function lP(e,t=!0){return hn(e)?e.displayName||e.name:e.name||t&&e.__name}function cP(e){return hn(e)&&"__vccOpts"in e}const Ie=(e,t)=>sA(e,t,nd);function Wo(e,t,i){const a=arguments.length;return a===2?ti(t)&&!en(t)?O_(t)?ue(e,null,[t]):ue(e,t):ue(e,null,t):(a>3?i=Array.prototype.slice.call(arguments,2):a===3&&O_(i)&&(i=[i]),ue(e,t,i))}const uP=Symbol.for("v-scx"),hP=()=>Jn(uP),dP="3.3.4",fP="http://www.w3.org/2000/svg",Tl=typeof document<"u"?document:null,bb=Tl&&Tl.createElement("template"),pP={insert:(e,t,i)=>{t.insertBefore(e,i||null)},remove:e=>{const t=e.parentNode;t&&t.removeChild(e)},createElement:(e,t,i,a)=>{const c=t?Tl.createElementNS(fP,e):Tl.createElement(e,i?{is:i}:void 0);return e==="select"&&a&&a.multiple!=null&&c.setAttribute("multiple",a.multiple),c},createText:e=>Tl.createTextNode(e),createComment:e=>Tl.createComment(e),setText:(e,t)=>{e.nodeValue=t},setElementText:(e,t)=>{e.textContent=t},parentNode:e=>e.parentNode,nextSibling:e=>e.nextSibling,querySelector:e=>Tl.querySelector(e),setScopeId(e,t){e.setAttribute(t,"")},insertStaticContent(e,t,i,a,c,d){const m=i?i.previousSibling:t.lastChild;if(c&&(c===d||c.nextSibling))for(;t.insertBefore(c.cloneNode(!0),i),!(c===d||!(c=c.nextSibling)););else{bb.innerHTML=a?`<svg>${e}</svg>`:e;const l=bb.content;if(a){const b=l.firstChild;for(;b.firstChild;)l.appendChild(b.firstChild);l.removeChild(b)}t.insertBefore(l,i)}return[m?m.nextSibling:t.firstChild,i?i.previousSibling:t.lastChild]}};function mP(e,t,i){const a=e._vtc;a&&(t=(t?[t,...a]:[...a]).join(" ")),t==null?e.removeAttribute("class"):i?e.setAttribute("class",t):e.className=t}function gP(e,t,i){const a=e.style,c=Ii(i);if(i&&!c){if(t&&!Ii(t))for(const d in t)i[d]==null&&B_(a,d,"");for(const d in i)B_(a,d,i[d])}else{const d=a.display;c?t!==i&&(a.cssText=i):t&&e.removeAttribute("style"),"_vod"in e&&(a.display=d)}}const wb=/\s*!important$/;function B_(e,t,i){if(en(i))i.forEach(a=>B_(e,t,a));else if(i==null&&(i=""),t.startsWith("--"))e.setProperty(t,i);else{const a=_P(e,t);wb.test(i)?e.setProperty(hu(a),i.replace(wb,""),"important"):e[a]=i}}const Sb=["Webkit","Moz","ms"],t_={};function _P(e,t){const i=t_[t];if(i)return i;let a=Ts(t);if(a!=="filter"&&a in e)return t_[t]=a;a=du(a);for(let c=0;c<Sb.length;c++){const d=Sb[c]+a;if(d in e)return t_[t]=d}return t}const Eb="http://www.w3.org/1999/xlink";function yP(e,t,i,a,c){if(a&&t.startsWith("xlink:"))i==null?e.removeAttributeNS(Eb,t.slice(6,t.length)):e.setAttributeNS(Eb,t,i);else{const d=Ek(t);i==null||d&&!Kw(i)?e.removeAttribute(t):e.setAttribute(t,d?"":i)}}function vP(e,t,i,a,c,d,m){if(t==="innerHTML"||t==="textContent"){a&&m(a,c,d),e[t]=i??"";return}const l=e.tagName;if(t==="value"&&l!=="PROGRESS"&&!l.includes("-")){e._value=i;const w=l==="OPTION"?e.getAttribute("value"):e.value,C=i??"";w!==C&&(e.value=C),i==null&&e.removeAttribute(t);return}let b=!1;if(i===""||i==null){const w=typeof e[t];w==="boolean"?i=Kw(i):i==null&&w==="string"?(i="",b=!0):w==="number"&&(i=0,b=!0)}try{e[t]=i}catch{}b&&e.removeAttribute(t)}function Nc(e,t,i,a){e.addEventListener(t,i,a)}function xP(e,t,i,a){e.removeEventListener(t,i,a)}function bP(e,t,i,a,c=null){const d=e._vei||(e._vei={}),m=d[t];if(a&&m)m.value=a;else{const[l,b]=wP(t);if(a){const w=d[t]=TP(a,c);Nc(e,l,w,b)}else m&&(xP(e,l,m,b),d[t]=void 0)}}const Tb=/(?:Once|Passive|Capture)$/;function wP(e){let t;if(Tb.test(e)){t={};let a;for(;a=e.match(Tb);)e=e.slice(0,e.length-a[0].length),t[a[0].toLowerCase()]=!0}return[e[2]===":"?e.slice(3):hu(e.slice(2)),t]}let n_=0;const SP=Promise.resolve(),EP=()=>n_||(SP.then(()=>n_=0),n_=Date.now());function TP(e,t){const i=a=>{if(!a._vts)a._vts=Date.now();else if(a._vts<=i.attached)return;Es(CP(a,i.value),t,5,[a])};return i.value=e,i.attached=EP(),i}function CP(e,t){if(en(t)){const i=e.stopImmediatePropagation;return e.stopImmediatePropagation=()=>{i.call(e),e._stopped=!0},t.map(a=>c=>!c._stopped&&a&&a(c))}else return t}const Cb=/^on[a-z]/,IP=(e,t,i,a,c=!1,d,m,l,b)=>{t==="class"?mP(e,a,c):t==="style"?gP(e,i,a):em(t)?jy(t)||bP(e,t,i,a,m):(t[0]==="."?(t=t.slice(1),!0):t[0]==="^"?(t=t.slice(1),!1):kP(e,t,a,c))?vP(e,t,a,d,m,l,b):(t==="true-value"?e._trueValue=a:t==="false-value"&&(e._falseValue=a),yP(e,t,a,c))};function kP(e,t,i,a){return a?!!(t==="innerHTML"||t==="textContent"||t in e&&Cb.test(t)&&hn(i)):t==="spellcheck"||t==="draggable"||t==="translate"||t==="form"||t==="list"&&e.tagName==="INPUT"||t==="type"&&e.tagName==="TEXTAREA"||Cb.test(t)&&Ii(i)?!1:t in e}const Co="transition",Eh="animation",Ya=(e,{slots:t})=>Wo(xA,qS(e),t);Ya.displayName="Transition";const GS={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String},AP=Ya.props=Di({},CS,GS),bl=(e,t=[])=>{en(e)?e.forEach(i=>i(...t)):e&&e(...t)},Ib=e=>e?en(e)?e.some(t=>t.length>1):e.length>1:!1;function qS(e){const t={};for(const _e in e)_e in GS||(t[_e]=e[_e]);if(e.css===!1)return t;const{name:i="v",type:a,duration:c,enterFromClass:d=`${i}-enter-from`,enterActiveClass:m=`${i}-enter-active`,enterToClass:l=`${i}-enter-to`,appearFromClass:b=d,appearActiveClass:w=m,appearToClass:C=l,leaveFromClass:k=`${i}-leave-from`,leaveActiveClass:M=`${i}-leave-active`,leaveToClass:O=`${i}-leave-to`}=e,j=PP(c),W=j&&j[0],le=j&&j[1],{onBeforeEnter:he,onEnter:be,onEnterCancelled:ge,onLeave:Pe,onLeaveCancelled:Ue,onBeforeAppear:Oe=he,onAppear:Te=be,onAppearCancelled:V=ge}=t,Z=(_e,oe,Re)=>{ko(_e,oe?C:l),ko(_e,oe?w:m),Re&&Re()},ae=(_e,oe)=>{_e._isLeaving=!1,ko(_e,k),ko(_e,O),ko(_e,M),oe&&oe()},ke=_e=>(oe,Re)=>{const nt=_e?Te:be,Qe=()=>Z(oe,_e,Re);bl(nt,[oe,Qe]),kb(()=>{ko(oe,_e?b:d),Va(oe,_e?C:l),Ib(nt)||Ab(oe,a,W,Qe)})};return Di(t,{onBeforeEnter(_e){bl(he,[_e]),Va(_e,d),Va(_e,m)},onBeforeAppear(_e){bl(Oe,[_e]),Va(_e,b),Va(_e,w)},onEnter:ke(!1),onAppear:ke(!0),onLeave(_e,oe){_e._isLeaving=!0;const Re=()=>ae(_e,oe);Va(_e,k),ZS(),Va(_e,M),kb(()=>{_e._isLeaving&&(ko(_e,k),Va(_e,O),Ib(Pe)||Ab(_e,a,le,Re))}),bl(Pe,[_e,Re])},onEnterCancelled(_e){Z(_e,!1),bl(ge,[_e])},onAppearCancelled(_e){Z(_e,!0),bl(V,[_e])},onLeaveCancelled(_e){ae(_e),bl(Ue,[_e])}})}function PP(e){if(e==null)return null;if(ti(e))return[i_(e.enter),i_(e.leave)];{const t=i_(e);return[t,t]}}function i_(e){return yk(e)}function Va(e,t){t.split(/\s+/).forEach(i=>i&&e.classList.add(i)),(e._vtc||(e._vtc=new Set)).add(t)}function ko(e,t){t.split(/\s+/).forEach(a=>a&&e.classList.remove(a));const{_vtc:i}=e;i&&(i.delete(t),i.size||(e._vtc=void 0))}function kb(e){requestAnimationFrame(()=>{requestAnimationFrame(e)})}let RP=0;function Ab(e,t,i,a){const c=e._endId=++RP,d=()=>{c===e._endId&&a()};if(i)return setTimeout(d,i);const{type:m,timeout:l,propCount:b}=HS(e,t);if(!m)return a();const w=m+"end";let C=0;const k=()=>{e.removeEventListener(w,M),d()},M=O=>{O.target===e&&++C>=b&&k()};setTimeout(()=>{C<b&&k()},l+1),e.addEventListener(w,M)}function HS(e,t){const i=window.getComputedStyle(e),a=j=>(i[j]||"").split(", "),c=a(`${Co}Delay`),d=a(`${Co}Duration`),m=Pb(c,d),l=a(`${Eh}Delay`),b=a(`${Eh}Duration`),w=Pb(l,b);let C=null,k=0,M=0;t===Co?m>0&&(C=Co,k=m,M=d.length):t===Eh?w>0&&(C=Eh,k=w,M=b.length):(k=Math.max(m,w),C=k>0?m>w?Co:Eh:null,M=C?C===Co?d.length:b.length:0);const O=C===Co&&/\b(transform|all)(,|$)/.test(a(`${Co}Property`).toString());return{type:C,timeout:k,propCount:M,hasTransform:O}}function Pb(e,t){for(;e.length<t.length;)e=e.concat(e);return Math.max(...t.map((i,a)=>Rb(i)+Rb(e[a])))}function Rb(e){return Number(e.slice(0,-1).replace(",","."))*1e3}function ZS(){return document.body.offsetHeight}const WS=new WeakMap,YS=new WeakMap,XS={name:"TransitionGroup",props:Di({},AP,{tag:String,moveClass:String}),setup(e,{slots:t}){const i=dv(),a=TS();let c,d;return AS(()=>{if(!c.length)return;const m=e.moveClass||`${e.name||"v"}-move`;if(!BP(c[0].el,i.vnode.el,m))return;c.forEach(LP),c.forEach(zP);const l=c.filter(OP);ZS(),l.forEach(b=>{const w=b.el,C=w.style;Va(w,m),C.transform=C.webkitTransform=C.transitionDuration="";const k=w._moveCb=M=>{M&&M.target!==w||(!M||/transform$/.test(M.propertyName))&&(w.removeEventListener("transitionend",k),w._moveCb=null,ko(w,m))};w.addEventListener("transitionend",k)})}),()=>{const m=an(e),l=qS(m);let b=m.tag||yn;c=d,d=t.default?rv(t.default()):[];for(let w=0;w<d.length;w++){const C=d[w];C.key!=null&&Qh(C,Jh(C,l,a,i))}if(c)for(let w=0;w<c.length;w++){const C=c[w];Qh(C,Jh(C,l,a,i)),WS.set(C,C.el.getBoundingClientRect())}return ue(b,null,d)}}},MP=e=>delete e.mode;XS.props;const DP=XS;function LP(e){const t=e.el;t._moveCb&&t._moveCb(),t._enterCb&&t._enterCb()}function zP(e){YS.set(e,e.el.getBoundingClientRect())}function OP(e){const t=WS.get(e),i=YS.get(e),a=t.left-i.left,c=t.top-i.top;if(a||c){const d=e.el.style;return d.transform=d.webkitTransform=`translate(${a}px,${c}px)`,d.transitionDuration="0s",e}}function BP(e,t,i){const a=e.cloneNode();e._vtc&&e._vtc.forEach(m=>{m.split(/\s+/).forEach(l=>l&&a.classList.remove(l))}),i.split(/\s+/).forEach(m=>m&&a.classList.add(m)),a.style.display="none";const c=t.nodeType===1?t:t.parentNode;c.appendChild(a);const{hasTransform:d}=HS(a);return c.removeChild(a),d}const Mb=e=>{const t=e.props["onUpdate:modelValue"]||!1;return en(t)?i=>up(t,i):t};function FP(e){e.target.composing=!0}function Db(e){const t=e.target;t.composing&&(t.composing=!1,t.dispatchEvent(new Event("input")))}const NP={created(e,{modifiers:{lazy:t,trim:i,number:a}},c){e._assign=Mb(c);const d=a||c.props&&c.props.type==="number";Nc(e,t?"change":"input",m=>{if(m.target.composing)return;let l=e.value;i&&(l=l.trim()),d&&(l=E_(l)),e._assign(l)}),i&&Nc(e,"change",()=>{e.value=e.value.trim()}),t||(Nc(e,"compositionstart",FP),Nc(e,"compositionend",Db),Nc(e,"change",Db))},mounted(e,{value:t}){e.value=t??""},beforeUpdate(e,{value:t,modifiers:{lazy:i,trim:a,number:c}},d){if(e._assign=Mb(d),e.composing||document.activeElement===e&&e.type!=="range"&&(i||a&&e.value.trim()===t||(c||e.type==="number")&&E_(e.value)===t))return;const m=t??"";e.value!==m&&(e.value=m)}},mu={beforeMount(e,{value:t},{transition:i}){e._vod=e.style.display==="none"?"":e.style.display,i&&t?i.beforeEnter(e):Th(e,t)},mounted(e,{value:t},{transition:i}){i&&t&&i.enter(e)},updated(e,{value:t,oldValue:i},{transition:a}){!t!=!i&&(a?t?(a.beforeEnter(e),Th(e,!0),a.enter(e)):a.leave(e,()=>{Th(e,!1)}):Th(e,t))},beforeUnmount(e,{value:t}){Th(e,t)}};function Th(e,t){e.style.display=t?e._vod:"none"}const UP=Di({patchProp:IP},pP);let Lb;function $P(){return Lb||(Lb=qA(UP))}const VP=(...e)=>{const t=$P().createApp(...e),{mount:i}=t;return t.mount=a=>{const c=jP(a);if(!c)return;const d=t._component;!hn(d)&&!d.render&&!d.template&&(d.template=c.innerHTML),c.innerHTML="";const m=i(c,!1,c instanceof SVGElement);return c instanceof Element&&(c.removeAttribute("v-cloak"),c.setAttribute("data-v-app","")),m},t};function jP(e){return Ii(e)?document.querySelector(e):e}var GP=!1;/*!
  * pinia v2.1.4
  * (c) 2023 Eduardo San Martin Morote
  * @license MIT
  */let KS;const mm=e=>KS=e,JS=Symbol();function F_(e){return e&&typeof e=="object"&&Object.prototype.toString.call(e)==="[object Object]"&&typeof e.toJSON!="function"}var Fh;(function(e){e.direct="direct",e.patchObject="patch object",e.patchFunction="patch function"})(Fh||(Fh={}));function qP(){const e=bd(!0),t=e.run(()=>Jt({}));let i=[],a=[];const c=sm({install(d){mm(c),c._a=d,d.provide(JS,c),d.config.globalProperties.$pinia=c,a.forEach(m=>i.push(m)),a=[]},use(d){return!this._a&&!GP?a.push(d):i.push(d),this},_p:i,_a:null,_e:e,_s:new Map,state:t});return c}const QS=()=>{};function zb(e,t,i,a=QS){e.push(t);const c=()=>{const d=e.indexOf(t);d>-1&&(e.splice(d,1),a())};return!i&&eS()&&Jr(c),c}function Lc(e,...t){e.slice().forEach(i=>{i(...t)})}const HP=e=>e();function N_(e,t){e instanceof Map&&t instanceof Map&&t.forEach((i,a)=>e.set(a,i)),e instanceof Set&&t instanceof Set&&t.forEach(e.add,e);for(const i in t){if(!t.hasOwnProperty(i))continue;const a=t[i],c=e[i];F_(c)&&F_(a)&&e.hasOwnProperty(i)&&!Kn(a)&&!Uo(a)?e[i]=N_(c,a):e[i]=a}return e}const ZP=Symbol();function WP(e){return!F_(e)||!e.hasOwnProperty(ZP)}const{assign:Ao}=Object;function YP(e){return!!(Kn(e)&&e.effect)}function XP(e,t,i,a){const{state:c,actions:d,getters:m}=t,l=i.state.value[e];let b;function w(){l||(i.state.value[e]=c?c():{});const C=am(i.state.value[e]);return Ao(C,d,Object.keys(m||{}).reduce((k,M)=>(k[M]=sm(Ie(()=>{mm(i);const O=i._s.get(e);return m[M].call(O,O)})),k),{}))}return b=eE(e,w,t,i,a,!0),b}function eE(e,t,i={},a,c,d){let m;const l=Ao({actions:{}},i),b={deep:!0};let w,C,k=[],M=[],O;const j=a.state.value[e];!d&&!j&&(a.state.value[e]={}),Jt({});let W;function le(V){let Z;w=C=!1,typeof V=="function"?(V(a.state.value[e]),Z={type:Fh.patchFunction,storeId:e,events:O}):(N_(a.state.value[e],V),Z={type:Fh.patchObject,payload:V,storeId:e,events:O});const ae=W=Symbol();Er().then(()=>{W===ae&&(w=!0)}),C=!0,Lc(k,Z,a.state.value[e])}const he=d?function(){const{state:Z}=i,ae=Z?Z():{};this.$patch(ke=>{Ao(ke,ae)})}:QS;function be(){m.stop(),k=[],M=[],a._s.delete(e)}function ge(V,Z){return function(){mm(a);const ae=Array.from(arguments),ke=[],_e=[];function oe(Qe){ke.push(Qe)}function Re(Qe){_e.push(Qe)}Lc(M,{args:ae,name:V,store:Ue,after:oe,onError:Re});let nt;try{nt=Z.apply(this&&this.$id===e?this:Ue,ae)}catch(Qe){throw Lc(_e,Qe),Qe}return nt instanceof Promise?nt.then(Qe=>(Lc(ke,Qe),Qe)).catch(Qe=>(Lc(_e,Qe),Promise.reject(Qe))):(Lc(ke,nt),nt)}}const Pe={_p:a,$id:e,$onAction:zb.bind(null,M),$patch:le,$reset:he,$subscribe(V,Z={}){const ae=zb(k,V,Z.detached,()=>ke()),ke=m.run(()=>Sn(()=>a.state.value[e],_e=>{(Z.flush==="sync"?C:w)&&V({storeId:e,type:Fh.direct,events:O},_e)},Ao({},b,Z)));return ae},$dispose:be},Ue=er(Pe);a._s.set(e,Ue);const Oe=a._a&&a._a.runWithContext||HP,Te=a._e.run(()=>(m=bd(),Oe(()=>m.run(t))));for(const V in Te){const Z=Te[V];if(Kn(Z)&&!YP(Z)||Uo(Z))d||(j&&WP(Z)&&(Kn(Z)?Z.value=j[V]:N_(Z,j[V])),a.state.value[e][V]=Z);else if(typeof Z=="function"){const ae=ge(V,Z);Te[V]=ae,l.actions[V]=Z}}return Ao(Ue,Te),Ao(an(Ue),Te),Object.defineProperty(Ue,"$state",{get:()=>a.state.value[e],set:V=>{le(Z=>{Ao(Z,V)})}}),a._p.forEach(V=>{Ao(Ue,m.run(()=>V({store:Ue,app:a._a,pinia:a,options:l})))}),j&&d&&i.hydrate&&i.hydrate(Ue.$state,j),w=!0,C=!0,Ue}function pv(e,t,i){let a,c;const d=typeof t=="function";typeof e=="string"?(a=e,c=d?i:t):(c=e,a=e.id);function m(l,b){const w=NA();return l=l||(w?Jn(JS,null):null),l&&mm(l),l=KS,l._s.has(a)||(d?eE(a,t,c,l):XP(a,c,l)),l._s.get(a)}return m.$id=a,m}function zl(e,t){let i;function a(){i=bd(),i.run(()=>t.length?t(()=>{i==null||i.stop(),a()}):t())}Sn(e,c=>{c&&!i?a():c||(i==null||i.stop(),i=void 0)},{immediate:!0}),Jr(()=>{i==null||i.stop()})}function tE(e,t,i){const a=t.length-1;if(a<0)return e===void 0?i:e;for(let c=0;c<a;c++){if(e==null)return i;e=e[t[c]]}return e==null||e[t[a]]===void 0?i:e[t[a]]}function gu(e,t){if(e===t)return!0;if(e instanceof Date&&t instanceof Date&&e.getTime()!==t.getTime()||e!==Object(e)||t!==Object(t))return!1;const i=Object.keys(e);return i.length!==Object.keys(t).length?!1:i.every(a=>gu(e[a],t[a]))}function U_(e,t,i){return e==null||!t||typeof t!="string"?i:e[t]!==void 0?e[t]:(t=t.replace(/\[(\w+)\]/g,".$1"),t=t.replace(/^\./,""),tE(e,t.split("."),i))}function pa(e,t,i){if(t==null)return e===void 0?i:e;if(e!==Object(e)){if(typeof t!="function")return i;const c=t(e,i);return typeof c>"u"?i:c}if(typeof t=="string")return U_(e,t,i);if(Array.isArray(t))return tE(e,t,i);if(typeof t!="function")return i;const a=t(e,i);return typeof a>"u"?i:a}function nE(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return Array.from({length:e},(i,a)=>t+a)}function gn(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"px";if(!(e==null||e===""))return isNaN(+e)?String(e):isFinite(+e)?`${Number(e)}${t}`:void 0}function $_(e){return e!==null&&typeof e=="object"&&!Array.isArray(e)}function V_(e){return e&&"$el"in e?e.$el:e}const Ob=Object.freeze({enter:13,tab:9,delete:46,esc:27,space:32,up:38,down:40,left:37,right:39,end:35,home:36,del:46,backspace:8,insert:45,pageup:33,pagedown:34,shift:16});function r_(e,t){return t.every(i=>e.hasOwnProperty(i))}function Ed(e,t,i){const a=Object.create(null),c=Object.create(null);for(const d in e)t.some(m=>m instanceof RegExp?m.test(d):m===d)&&!(i!=null&&i.some(m=>m===d))?a[d]=e[d]:c[d]=e[d];return[a,c]}function mv(e,t){const i={...e};return t.forEach(a=>delete i[a]),i}function gv(e){return Ed(e,["class","style","id",/^data-/])}function ga(e){return e==null?[]:Array.isArray(e)?e:[e]}function j_(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;return Math.max(t,Math.min(i,e))}function Bb(e,t){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"0";return e+i.repeat(Math.max(0,t-e.length))}function KP(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;const i=[];let a=0;for(;a<e.length;)i.push(e.substr(a,t)),a+=t;return i}function Ss(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=arguments.length>2?arguments[2]:void 0;const a={};for(const c in e)a[c]=e[c];for(const c in t){const d=e[c],m=t[c];if($_(d)&&$_(m)){a[c]=Ss(d,m,i);continue}if(Array.isArray(d)&&Array.isArray(m)&&i){a[c]=i(d,m);continue}a[c]=m}return a}function iE(e){return e.map(t=>t.type===yn?iE(t.children):t).flat()}function Rl(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";if(Rl.cache.has(e))return Rl.cache.get(e);const t=e.replace(/[^a-z]/gi,"-").replace(/\B([A-Z])/g,"-$1").toLowerCase();return Rl.cache.set(e,t),t}Rl.cache=new Map;function Nh(e,t){if(!t||typeof t!="object")return[];if(Array.isArray(t))return t.map(i=>Nh(e,i)).flat(1);if(Array.isArray(t.children))return t.children.map(i=>Nh(e,i)).flat(1);if(t.component){if(Object.getOwnPropertySymbols(t.component.provides).includes(e))return[t.component];if(t.component.subTree)return Nh(e,t.component.subTree).flat(1)}return[]}function _v(e){const t=er({}),i=Ie(e);return eo(()=>{for(const a in i.value)t[a]=i.value[a]},{flush:"sync"}),am(t)}function Cp(e,t){return e.includes(t)}const JP=/^on[^a-z]/,yv=e=>JP.test(e);function rE(e){return e[2].toLowerCase()+e.slice(3)}const _a=()=>[Function,Array];function Fb(e,t){return t="on"+du(t),!!(e[t]||e[`${t}Once`]||e[`${t}Capture`]||e[`${t}OnceCapture`]||e[`${t}CaptureOnce`])}function QP(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),a=1;a<t;a++)i[a-1]=arguments[a];if(Array.isArray(e))for(const c of e)c(...i);else typeof e=="function"&&e(...i)}function eR(e){const t=["button","[href]",'input:not([type="hidden"])',"select","textarea","[tabindex]"].map(i=>`${i}:not([tabindex="-1"]):not([disabled])`).join(", ");return[...e.querySelectorAll(t)]}function Ip(e,t){var c,d,m;const i=eR(e),a=i.indexOf(document.activeElement);if(!t)(e===document.activeElement||!e.contains(document.activeElement))&&((c=i[0])==null||c.focus());else if(t==="first")(d=i[0])==null||d.focus();else if(t==="last")(m=i.at(-1))==null||m.focus();else{let l,b=a;const w=t==="next"?1:-1;do b+=w,l=i[b];while((!l||l.offsetParent==null)&&b<i.length&&b>=0);l?l.focus():Ip(e,t==="next"?"first":"last")}}function tR(){}const sE=["top","bottom"],nR=["start","end","left","right"];function G_(e,t){let[i,a]=e.split(" ");return a||(a=Cp(sE,i)?"start":Cp(nR,i)?"top":"center"),{side:Nb(i,t),align:Nb(a,t)}}function Nb(e,t){return e==="start"?t?"right":"left":e==="end"?t?"left":"right":e}function s_(e){return{side:{center:"center",top:"bottom",bottom:"top",left:"right",right:"left"}[e.side],align:e.align}}function a_(e){return{side:e.side,align:{center:"center",top:"bottom",bottom:"top",left:"right",right:"left"}[e.align]}}function Ub(e){return{side:e.align,align:e.side}}function $b(e){return Cp(sE,e.side)?"y":"x"}class Yc{constructor(t){let{x:i,y:a,width:c,height:d}=t;this.x=i,this.y=a,this.width=c,this.height=d}get top(){return this.y}get bottom(){return this.y+this.height}get left(){return this.x}get right(){return this.x+this.width}}function Vb(e,t){return{x:{before:Math.max(0,t.left-e.left),after:Math.max(0,e.right-t.right)},y:{before:Math.max(0,t.top-e.top),after:Math.max(0,e.bottom-t.bottom)}}}function vv(e){const t=e.getBoundingClientRect(),i=getComputedStyle(e),a=i.transform;if(a){let c,d,m,l,b;if(a.startsWith("matrix3d("))c=a.slice(9,-1).split(/, /),d=+c[0],m=+c[5],l=+c[12],b=+c[13];else if(a.startsWith("matrix("))c=a.slice(7,-1).split(/, /),d=+c[0],m=+c[3],l=+c[4],b=+c[5];else return new Yc(t);const w=i.transformOrigin,C=t.x-l-(1-d)*parseFloat(w),k=t.y-b-(1-m)*parseFloat(w.slice(w.indexOf(" ")+1)),M=d?t.width/d:e.offsetWidth+1,O=m?t.height/m:e.offsetHeight+1;return new Yc({x:C,y:k,width:M,height:O})}else return new Yc(t)}function Vc(e,t,i){if(typeof e.animate>"u")return{finished:Promise.resolve()};let a;try{a=e.animate(t,i)}catch{return{finished:Promise.resolve()}}return typeof a.finished>"u"&&(a.finished=new Promise(c=>{a.onfinish=()=>{c(a)}})),a}const fp=new WeakMap;function iR(e,t){Object.keys(t).forEach(i=>{if(yv(i)){const a=rE(i),c=fp.get(e);if(t[i]==null)c==null||c.forEach(d=>{const[m,l]=d;m===a&&(e.removeEventListener(a,l),c.delete(d))});else if(!c||![...c].some(d=>d[0]===a&&d[1]===t[i])){e.addEventListener(a,t[i]);const d=c||new Set;d.add([a,t[i]]),fp.has(e)||fp.set(e,d)}}else t[i]==null?e.removeAttribute(i):e.setAttribute(i,t[i])})}function rR(e,t){Object.keys(t).forEach(i=>{if(yv(i)){const a=rE(i),c=fp.get(e);c==null||c.forEach(d=>{const[m,l]=d;m===a&&(e.removeEventListener(a,l),c.delete(d))})}else e.removeAttribute(i)})}function sR(e,t){t=Array.isArray(t)?t.slice(0,-1).map(i=>`'${i}'`).join(", ")+` or '${t.at(-1)}'`:`'${t}'`}const kp=.20689655172413793,aR=e=>e>kp**3?Math.cbrt(e):e/(3*kp**2)+4/29,oR=e=>e>kp?e**3:3*kp**2*(e-4/29);function aE(e){const t=aR,i=t(e[1]);return[116*i-16,500*(t(e[0]/.95047)-i),200*(i-t(e[2]/1.08883))]}function oE(e){const t=oR,i=(e[0]+16)/116;return[t(i+e[1]/500)*.95047,t(i),t(i-e[2]/200)*1.08883]}const lR=[[3.2406,-1.5372,-.4986],[-.9689,1.8758,.0415],[.0557,-.204,1.057]],cR=e=>e<=.0031308?e*12.92:1.055*e**(1/2.4)-.055,uR=[[.4124,.3576,.1805],[.2126,.7152,.0722],[.0193,.1192,.9505]],hR=e=>e<=.04045?e/12.92:((e+.055)/1.055)**2.4;function lE(e){const t=Array(3),i=cR,a=lR;for(let c=0;c<3;++c)t[c]=Math.round(j_(i(a[c][0]*e[0]+a[c][1]*e[1]+a[c][2]*e[2]))*255);return{r:t[0],g:t[1],b:t[2]}}function xv(e){let{r:t,g:i,b:a}=e;const c=[0,0,0],d=hR,m=uR;t=d(t/255),i=d(i/255),a=d(a/255);for(let l=0;l<3;++l)c[l]=m[l][0]*t+m[l][1]*i+m[l][2]*a;return c}function jb(e){return!!e&&/^(#|var\(--|(rgb|hsl)a?\()/.test(e)}const Gb=/^(?<fn>(?:rgb|hsl)a?)\((?<values>.+)\)/,dR={rgb:(e,t,i,a)=>({r:e,g:t,b:i,a}),rgba:(e,t,i,a)=>({r:e,g:t,b:i,a}),hsl:(e,t,i,a)=>qb({h:e,s:t,l:i,a}),hsla:(e,t,i,a)=>qb({h:e,s:t,l:i,a}),hsv:(e,t,i,a)=>id({h:e,s:t,v:i,a}),hsva:(e,t,i,a)=>id({h:e,s:t,v:i,a})};function Il(e){if(typeof e=="number")return{r:(e&16711680)>>16,g:(e&65280)>>8,b:e&255};if(typeof e=="string"&&Gb.test(e)){const{groups:t}=e.match(Gb),{fn:i,values:a}=t,c=a.split(/,\s*/).map(d=>d.endsWith("%")&&["hsl","hsla","hsv","hsva"].includes(i)?parseFloat(d)/100:parseFloat(d));return dR[i](...c)}else if(typeof e=="string"){let t=e.startsWith("#")?e.slice(1):e;return[3,4].includes(t.length)?t=t.split("").map(i=>i+i).join(""):[6,8].includes(t.length),pR(t)}else if(typeof e=="object"){if(r_(e,["r","g","b"]))return e;if(r_(e,["h","s","l"]))return id(cE(e));if(r_(e,["h","s","v"]))return id(e)}throw new TypeError(`Invalid color: ${e==null?e:String(e)||e.constructor.name}
Expected #hex, #hexa, rgb(), rgba(), hsl(), hsla(), object or number`)}function id(e){const{h:t,s:i,v:a,a:c}=e,d=l=>{const b=(l+t/60)%6;return a-a*i*Math.max(Math.min(b,4-b,1),0)},m=[d(5),d(3),d(1)].map(l=>Math.round(l*255));return{r:m[0],g:m[1],b:m[2],a:c}}function qb(e){return id(cE(e))}function cE(e){const{h:t,s:i,l:a,a:c}=e,d=a+i*Math.min(a,1-a),m=d===0?0:2-2*a/d;return{h:t,s:m,v:d,a:c}}function Gf(e){const t=Math.round(e).toString(16);return("00".substr(0,2-t.length)+t).toUpperCase()}function fR(e){let{r:t,g:i,b:a,a:c}=e;return`#${[Gf(t),Gf(i),Gf(a),c!==void 0?Gf(Math.round(c*255)):""].join("")}`}function pR(e){e=mR(e);let[t,i,a,c]=KP(e,2).map(d=>parseInt(d,16));return c=c===void 0?c:c/255,{r:t,g:i,b:a,a:c}}function mR(e){return e.startsWith("#")&&(e=e.slice(1)),e=e.replace(/([^0-9a-f])/gi,"F"),(e.length===3||e.length===4)&&(e=e.split("").map(t=>t+t).join("")),e.length!==6&&(e=Bb(Bb(e,6),8,"F")),e}function gR(e,t){const i=aE(xv(e));return i[0]=i[0]+t*10,lE(oE(i))}function _R(e,t){const i=aE(xv(e));return i[0]=i[0]-t*10,lE(oE(i))}function yR(e){const t=Il(e);return xv(t)[1]}function $t(e,t){return i=>Object.keys(e).reduce((a,c)=>{const m=typeof e[c]=="object"&&e[c]!=null&&!Array.isArray(e[c])?e[c]:{type:e[c]};return i&&c in i?a[c]={...m,default:i[c]}:a[c]=m,t&&!a[c].source&&(a[c].source=t),a},{})}const hi=$t({class:[String,Array],style:{type:[String,Array,Object],default:null}},"component");function _u(e){if(e._setup=e._setup??e.setup,!e.name)return e;if(e._setup){e.props=$t(e.props??{},e.name)();const t=Object.keys(e.props);e.filterProps=function(a){return Ed(a,t,["class","style"])},e.props._as=String,e.setup=function(a,c){const d=Sv();if(!d.value)return e._setup(a,c);const{props:m,provideSubDefaults:l}=IR(a,a._as??e.name,d),b=e._setup(m,c);return l(),b}}return e}function En(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return t=>(e?_u:cm)(t)}function uE(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"div",i=arguments.length>2?arguments[2]:void 0;return En()({name:i??du(Ts(e.replace(/__/g,"-"))),props:{tag:{type:String,default:t},...hi()},setup(a,c){let{slots:d}=c;return()=>{var m;return Wo(a.tag,{class:[e,a.class],style:a.style},(m=d.default)==null?void 0:m.call(d))}}})}function hE(e){if(typeof e.getRootNode!="function"){for(;e.parentNode;)e=e.parentNode;return e!==document?null:document}const t=e.getRootNode();return t!==document&&t.getRootNode({composed:!0})!==document?null:t}const Ap="cubic-bezier(0.4, 0, 0.2, 1)",vR="cubic-bezier(0.0, 0, 0.2, 1)",xR="cubic-bezier(0.4, 0, 1, 1)";function Nr(e,t){const i=dv();if(!i)throw new Error(`[Vuetify] ${e} ${t||"must be called from inside a setup function"}`);return i}function Yo(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"composables";const t=Nr(e).type;return Rl((t==null?void 0:t.aliasName)||(t==null?void 0:t.name))}let dE=0,pp=new WeakMap;function Zs(){const e=Nr("getUid");if(pp.has(e))return pp.get(e);{const t=dE++;return pp.set(e,t),t}}Zs.reset=()=>{dE=0,pp=new WeakMap};function bR(e){for(;e;){if(bv(e))return e;e=e.parentElement}return document.scrollingElement}function Pp(e,t){const i=[];if(t&&e&&!t.contains(e))return i;for(;e&&(bv(e)&&i.push(e),e!==t);)e=e.parentElement;return i}function bv(e){if(!e||e.nodeType!==Node.ELEMENT_NODE)return!1;const t=window.getComputedStyle(e);return t.overflowY==="scroll"||t.overflowY==="auto"&&e.scrollHeight>e.clientHeight}const Hi=typeof window<"u",wv=Hi&&"IntersectionObserver"in window,wR=Hi&&("ontouchstart"in window||window.navigator.maxTouchPoints>0),q_=Hi&&typeof CSS<"u"&&typeof CSS.supports<"u"&&CSS.supports("selector(:focus-visible)");function SR(e){const{provides:t}=Nr("injectSelf");if(t&&e in t)return t[e]}function ER(e){for(;e;){if(window.getComputedStyle(e).position==="fixed")return!0;e=e.offsetParent}return!1}function Gn(e){const t=Nr("useRender");t.render=e}const rd=Symbol.for("vuetify:defaults");function TR(e){return Jt(e)}function Sv(){const e=Jn(rd);if(!e)throw new Error("[Vuetify] Could not find defaults instance");return e}function Td(e,t){const i=Sv(),a=Jt(e),c=Ie(()=>{if(hr(t==null?void 0:t.disabled))return i.value;const m=hr(t==null?void 0:t.scoped),l=hr(t==null?void 0:t.reset),b=hr(t==null?void 0:t.root);let w=Ss(a.value,{prev:i.value});if(m)return w;if(l||b){const C=Number(l||1/0);for(let k=0;k<=C&&!(!w||!("prev"in w));k++)w=w.prev;return w&&typeof b=="string"&&b in w&&(w=Ss(Ss(w,{prev:w}),w[b])),w}return w.prev?Ss(w.prev,w):w});return Sr(rd,c),c}function CR(e,t){var i,a;return typeof((i=e.props)==null?void 0:i[t])<"u"||typeof((a=e.props)==null?void 0:a[Rl(t)])<"u"}function IR(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Sv();const a=Nr("useDefaults");if(t=t??a.type.name??a.type.__name,!t)throw new Error("[Vuetify] Could not determine component name");const c=Ie(()=>{var b;return(b=i.value)==null?void 0:b[e._as??t]}),d=new Proxy(e,{get(b,w){var k,M,O,j;const C=Reflect.get(b,w);return w==="class"||w==="style"?[(k=c.value)==null?void 0:k[w],C].filter(W=>W!=null):typeof w=="string"&&!CR(a.vnode,w)?((M=c.value)==null?void 0:M[w])??((j=(O=i.value)==null?void 0:O.global)==null?void 0:j[w])??C:C}}),m=wn();eo(()=>{if(c.value){const b=Object.entries(c.value).filter(w=>{let[C]=w;return C.startsWith(C[0].toUpperCase())});b.length&&(m.value=Object.fromEntries(b))}});function l(){zl(m,()=>{var b;Td(Ss(((b=SR(rd))==null?void 0:b.value)??{},m.value))})}return{props:d,provideSubDefaults:l}}const H_=Symbol.for("vuetify:display"),Hb={mobileBreakpoint:"lg",thresholds:{xs:0,sm:600,md:960,lg:1280,xl:1920,xxl:2560}},kR=function(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Hb;return Ss(Hb,e)};function Zb(e){return Hi&&!e?window.innerWidth:typeof e=="object"&&e.clientWidth||0}function Wb(e){return Hi&&!e?window.innerHeight:typeof e=="object"&&e.clientHeight||0}function Yb(e){const t=Hi&&!e?window.navigator.userAgent:"ssr";function i(j){return!!t.match(j)}const a=i(/android/i),c=i(/iphone|ipad|ipod/i),d=i(/cordova/i),m=i(/electron/i),l=i(/chrome/i),b=i(/edge/i),w=i(/firefox/i),C=i(/opera/i),k=i(/win/i),M=i(/mac/i),O=i(/linux/i);return{android:a,ios:c,cordova:d,electron:m,chrome:l,edge:b,firefox:w,opera:C,win:k,mac:M,linux:O,touch:wR,ssr:t==="ssr"}}function AR(e,t){const{thresholds:i,mobileBreakpoint:a}=kR(e),c=wn(Wb(t)),d=wn(Yb(t)),m=er({}),l=wn(Zb(t));function b(){c.value=Wb(),l.value=Zb()}function w(){b(),d.value=Yb()}return eo(()=>{const C=l.value<i.sm,k=l.value<i.md&&!C,M=l.value<i.lg&&!(k||C),O=l.value<i.xl&&!(M||k||C),j=l.value<i.xxl&&!(O||M||k||C),W=l.value>=i.xxl,le=C?"xs":k?"sm":M?"md":O?"lg":j?"xl":"xxl",he=typeof a=="number"?a:i[a],be=l.value<he;m.xs=C,m.sm=k,m.md=M,m.lg=O,m.xl=j,m.xxl=W,m.smAndUp=!C,m.mdAndUp=!(C||k),m.lgAndUp=!(C||k||M),m.xlAndUp=!(C||k||M||O),m.smAndDown=!(M||O||j||W),m.mdAndDown=!(O||j||W),m.lgAndDown=!(j||W),m.xlAndDown=!W,m.name=le,m.height=c.value,m.width=l.value,m.mobile=be,m.mobileBreakpoint=a,m.platform=d.value,m.thresholds=i}),Hi&&window.addEventListener("resize",b,{passive:!0}),{...am(m),update:w,ssr:!!t}}function PR(){const e=Jn(H_);if(!e)throw new Error("Could not find Vuetify display injection");return e}const RR={collapse:"mdi-chevron-up",complete:"mdi-check",cancel:"mdi-close-circle",close:"mdi-close",delete:"mdi-close-circle",clear:"mdi-close-circle",success:"mdi-check-circle",info:"mdi-information",warning:"mdi-alert-circle",error:"mdi-close-circle",prev:"mdi-chevron-left",next:"mdi-chevron-right",checkboxOn:"mdi-checkbox-marked",checkboxOff:"mdi-checkbox-blank-outline",checkboxIndeterminate:"mdi-minus-box",delimiter:"mdi-circle",sortAsc:"mdi-arrow-up",sortDesc:"mdi-arrow-down",expand:"mdi-chevron-down",menu:"mdi-menu",subgroup:"mdi-menu-down",dropdown:"mdi-menu-down",radioOn:"mdi-radiobox-marked",radioOff:"mdi-radiobox-blank",edit:"mdi-pencil",ratingEmpty:"mdi-star-outline",ratingFull:"mdi-star",ratingHalf:"mdi-star-half-full",loading:"mdi-cached",first:"mdi-page-first",last:"mdi-page-last",unfold:"mdi-unfold-more-horizontal",file:"mdi-paperclip",plus:"mdi-plus",minus:"mdi-minus",calendar:"mdi-calendar"},MR={component:e=>Wo(pE,{...e,class:"mdi"})},Mi=[String,Function,Object,Array],Z_=Symbol.for("vuetify:icons"),gm=$t({icon:{type:Mi},tag:{type:String,required:!0}},"icon"),Xb=En()({name:"VComponentIcon",props:gm(),setup(e,t){let{slots:i}=t;return()=>{const a=e.icon;return ue(e.tag,null,{default:()=>{var c;return[e.icon?ue(a,null,null):(c=i.default)==null?void 0:c.call(i)]}})}}}),fE=_u({name:"VSvgIcon",inheritAttrs:!1,props:gm(),setup(e,t){let{attrs:i}=t;return()=>ue(e.tag,kn(i,{style:null}),{default:()=>[ue("svg",{class:"v-icon__svg",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",role:"img","aria-hidden":"true"},[Array.isArray(e.icon)?e.icon.map(a=>Array.isArray(a)?ue("path",{d:a[0],"fill-opacity":a[1]},null):ue("path",{d:a},null)):ue("path",{d:e.icon},null)])]})}});_u({name:"VLigatureIcon",props:gm(),setup(e){return()=>ue(e.tag,null,{default:()=>[e.icon]})}});const pE=_u({name:"VClassIcon",props:gm(),setup(e){return()=>ue(e.tag,{class:e.icon},null)}}),DR={svg:{component:fE},class:{component:pE}};function LR(e){return Ss({defaultSet:"mdi",sets:{...DR,mdi:MR},aliases:{...RR,vuetify:["M8.2241 14.2009L12 21L22 3H14.4459L8.2241 14.2009Z",["M7.26303 12.4733L7.00113 12L2 3H12.5261C12.5261 3 12.5261 3 12.5261 3L7.26303 12.4733Z",.6]],"vuetify-outline":"svg:M7.26 12.47 12.53 3H2L7.26 12.47ZM14.45 3 8.22 14.2 12 21 22 3H14.45ZM18.6 5 12 16.88 10.51 14.2 15.62 5ZM7.26 8.35 5.4 5H9.13L7.26 8.35Z"}},e)}const zR=e=>{const t=Jn(Z_);if(!t)throw new Error("Missing Vuetify Icons provide!");return{iconData:Ie(()=>{var b;const a=hr(e);if(!a)return{component:Xb};let c=a;if(typeof c=="string"&&(c=c.trim(),c.startsWith("$")&&(c=(b=t.aliases)==null?void 0:b[c.slice(1)])),!c)throw new Error(`Could not find aliased icon "${a}"`);if(Array.isArray(c))return{component:fE,icon:c};if(typeof c!="string")return{component:Xb,icon:c};const d=Object.keys(t.sets).find(w=>typeof c=="string"&&c.startsWith(`${w}:`)),m=d?c.slice(d.length+1):c;return{component:t.sets[d??t.defaultSet].component,icon:m}})}},OR={badge:"Badge",close:"Close",dataIterator:{noResultsText:"No matching records found",loadingText:"Loading items..."},dataTable:{itemsPerPageText:"Rows per page:",ariaLabel:{sortDescending:"Sorted descending.",sortAscending:"Sorted ascending.",sortNone:"Not sorted.",activateNone:"Activate to remove sorting.",activateDescending:"Activate to sort descending.",activateAscending:"Activate to sort ascending."},sortBy:"Sort by"},dataFooter:{itemsPerPageText:"Items per page:",itemsPerPageAll:"All",nextPage:"Next page",prevPage:"Previous page",firstPage:"First page",lastPage:"Last page",pageText:"{0}-{1} of {2}"},dateRangeInput:{divider:"to"},datePicker:{ok:"OK",cancel:"Cancel",range:{title:"Select dates",header:"Enter dates"},title:"Select date",header:"Enter date",input:{placeholder:"Enter date"}},noDataText:"No data available",carousel:{prev:"Previous visual",next:"Next visual",ariaLabel:{delimiter:"Carousel slide {0} of {1}"}},calendar:{moreEvents:"{0} more"},input:{clear:"Clear {0}",prependAction:"{0} prepended action",appendAction:"{0} appended action"},fileInput:{counter:"{0} files",counterSize:"{0} files ({1} in total)"},timePicker:{am:"AM",pm:"PM"},pagination:{ariaLabel:{root:"Pagination Navigation",next:"Next page",previous:"Previous page",page:"Go to page {0}",currentPage:"Page {0}, Current page",first:"First page",last:"Last page"}},rating:{ariaLabel:{item:"Rating {0} of {1}"}},loading:"Loading...",infiniteScroll:{loadMore:"Load more",empty:"No more"}},BR={af:!1,ar:!0,bg:!1,ca:!1,ckb:!1,cs:!1,de:!1,el:!1,en:!1,es:!1,et:!1,fa:!0,fi:!1,fr:!1,hr:!1,hu:!1,he:!0,id:!1,it:!1,ja:!1,ko:!1,lv:!1,lt:!1,nl:!1,no:!1,pl:!1,pt:!1,ro:!1,ru:!1,sk:!1,sl:!1,srCyrl:!1,srLatn:!1,sv:!1,th:!1,tr:!1,az:!1,uk:!1,vi:!1,zhHans:!1,zhHant:!1};function Ci(e,t,i){let a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:k=>k,c=arguments.length>4&&arguments[4]!==void 0?arguments[4]:k=>k;const d=Nr("useProxiedModel"),m=Jt(e[t]!==void 0?e[t]:i),l=Rl(t),w=Ie(l!==t?()=>{var k,M,O,j;return e[t],!!(((k=d.vnode.props)!=null&&k.hasOwnProperty(t)||(M=d.vnode.props)!=null&&M.hasOwnProperty(l))&&((O=d.vnode.props)!=null&&O.hasOwnProperty(`onUpdate:${t}`)||(j=d.vnode.props)!=null&&j.hasOwnProperty(`onUpdate:${l}`)))}:()=>{var k,M;return e[t],!!((k=d.vnode.props)!=null&&k.hasOwnProperty(t)&&((M=d.vnode.props)!=null&&M.hasOwnProperty(`onUpdate:${t}`)))});zl(()=>!w.value,()=>{Sn(()=>e[t],k=>{m.value=k})});const C=Ie({get(){const k=e[t];return a(w.value?k:m.value)},set(k){const M=c(k),O=an(w.value?e[t]:m.value);O===M||a(O)===k||(m.value=M,d==null||d.emit(`update:${t}`,M))}});return Object.defineProperty(C,"externalValue",{get:()=>w.value?e[t]:m.value}),C}const Kb="$vuetify.",Jb=(e,t)=>e.replace(/\{(\d+)\}/g,(i,a)=>String(t[+a])),mE=(e,t,i)=>function(a){for(var c=arguments.length,d=new Array(c>1?c-1:0),m=1;m<c;m++)d[m-1]=arguments[m];if(!a.startsWith(Kb))return Jb(a,d);const l=a.replace(Kb,""),b=e.value&&i.value[e.value],w=t.value&&i.value[t.value];let C=U_(b,l,null);return C||(`${a}${e.value}`,C=U_(w,l,null)),C||(C=a),typeof C!="string"&&(C=a),Jb(C,d)};function gE(e,t){return(i,a)=>new Intl.NumberFormat([e.value,t.value],a).format(i)}function o_(e,t,i){const a=Ci(e,t,e[t]??i.value);return a.value=e[t]??i.value,Sn(i,c=>{e[t]==null&&(a.value=i.value)}),a}function _E(e){return t=>{const i=o_(t,"locale",e.current),a=o_(t,"fallback",e.fallback),c=o_(t,"messages",e.messages);return{name:"vuetify",current:i,fallback:a,messages:c,t:mE(i,a,c),n:gE(i,a),provide:_E({current:i,fallback:a,messages:c})}}}function FR(e){const t=wn((e==null?void 0:e.locale)??"en"),i=wn((e==null?void 0:e.fallback)??"en"),a=Jt({en:OR,...e==null?void 0:e.messages});return{name:"vuetify",current:t,fallback:i,messages:a,t:mE(t,i,a),n:gE(t,i),provide:_E({current:t,fallback:i,messages:a})}}const Rp=Symbol.for("vuetify:locale");function NR(e){return e.name!=null}function UR(e){const t=e!=null&&e.adapter&&NR(e==null?void 0:e.adapter)?e==null?void 0:e.adapter:FR(e),i=$R(t,e);return{...t,...i}}function _m(){const e=Jn(Rp);if(!e)throw new Error("[Vuetify] Could not find injected locale instance");return e}function $R(e,t){const i=Jt((t==null?void 0:t.rtl)??BR),a=Ie(()=>i.value[e.current.value]??!1);return{isRtl:a,rtl:i,rtlClasses:Ie(()=>`v-locale--is-${a.value?"rtl":"ltr"}`)}}function yu(){const e=Jn(Rp);if(!e)throw new Error("[Vuetify] Could not find injected rtl instance");return{isRtl:e.isRtl,rtlClasses:e.rtlClasses}}const zc=2.4,Qb=.2126729,e1=.7151522,t1=.072175,VR=.55,jR=.58,GR=.57,qR=.62,qf=.03,n1=1.45,HR=5e-4,ZR=1.25,WR=1.25,i1=.078,r1=12.82051282051282,Hf=.06,s1=.001;function a1(e,t){const i=(e.r/255)**zc,a=(e.g/255)**zc,c=(e.b/255)**zc,d=(t.r/255)**zc,m=(t.g/255)**zc,l=(t.b/255)**zc;let b=i*Qb+a*e1+c*t1,w=d*Qb+m*e1+l*t1;if(b<=qf&&(b+=(qf-b)**n1),w<=qf&&(w+=(qf-w)**n1),Math.abs(w-b)<HR)return 0;let C;if(w>b){const k=(w**VR-b**jR)*ZR;C=k<s1?0:k<i1?k-k*r1*Hf:k-Hf}else{const k=(w**qR-b**GR)*WR;C=k>-s1?0:k>-i1?k-k*r1*Hf:k+Hf}return C*100}const Mp=Symbol.for("vuetify:theme"),es=$t({theme:String},"theme"),Ch={defaultTheme:"light",variations:{colors:[],lighten:0,darken:0},themes:{light:{dark:!1,colors:{background:"#FFFFFF",surface:"#FFFFFF","surface-variant":"#424242","on-surface-variant":"#EEEEEE",primary:"#6200EE","primary-darken-1":"#3700B3",secondary:"#03DAC6","secondary-darken-1":"#018786",error:"#B00020",info:"#2196F3",success:"#4CAF50",warning:"#FB8C00"},variables:{"border-color":"#000000","border-opacity":.12,"high-emphasis-opacity":.87,"medium-emphasis-opacity":.6,"disabled-opacity":.38,"idle-opacity":.04,"hover-opacity":.04,"focus-opacity":.12,"selected-opacity":.08,"activated-opacity":.12,"pressed-opacity":.12,"dragged-opacity":.08,"theme-kbd":"#212529","theme-on-kbd":"#FFFFFF","theme-code":"#F5F5F5","theme-on-code":"#000000"}},dark:{dark:!0,colors:{background:"#121212",surface:"#212121","surface-variant":"#BDBDBD","on-surface-variant":"#424242",primary:"#BB86FC","primary-darken-1":"#3700B3",secondary:"#03DAC5","secondary-darken-1":"#03DAC5",error:"#CF6679",info:"#2196F3",success:"#4CAF50",warning:"#FB8C00"},variables:{"border-color":"#FFFFFF","border-opacity":.12,"high-emphasis-opacity":1,"medium-emphasis-opacity":.7,"disabled-opacity":.5,"idle-opacity":.1,"hover-opacity":.04,"focus-opacity":.12,"selected-opacity":.08,"activated-opacity":.12,"pressed-opacity":.16,"dragged-opacity":.08,"theme-kbd":"#212529","theme-on-kbd":"#FFFFFF","theme-code":"#343434","theme-on-code":"#CCCCCC"}}}};function YR(){var i,a;let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Ch;if(!e)return{...Ch,isDisabled:!0};const t={};for(const[c,d]of Object.entries(e.themes??{})){const m=d.dark||c==="dark"?(i=Ch.themes)==null?void 0:i.dark:(a=Ch.themes)==null?void 0:a.light;t[c]=Ss(m,d)}return Ss(Ch,{...e,themes:t})}function XR(e){const t=er(YR(e)),i=Jt(t.defaultTheme),a=Jt(t.themes),c=Ie(()=>{const C={};for(const[k,M]of Object.entries(a.value)){const O=C[k]={...M,colors:{...M.colors}};if(t.variations)for(const j of t.variations.colors){const W=O.colors[j];if(W)for(const le of["lighten","darken"]){const he=le==="lighten"?gR:_R;for(const be of nE(t.variations[le],1))O.colors[`${j}-${le}-${be}`]=fR(he(Il(W),be))}}for(const j of Object.keys(O.colors)){if(/^on-[a-z]/.test(j)||O.colors[`on-${j}`])continue;const W=`on-${j}`,le=Il(O.colors[j]),he=Math.abs(a1(Il(0),le)),be=Math.abs(a1(Il(16777215),le));O.colors[W]=be>Math.min(he,50)?"#fff":"#000"}}return C}),d=Ie(()=>c.value[i.value]),m=Ie(()=>{const C=[];d.value.dark&&wl(C,":root",["color-scheme: dark"]),wl(C,":root",o1(d.value));for(const[j,W]of Object.entries(c.value))wl(C,`.v-theme--${j}`,[`color-scheme: ${W.dark?"dark":"normal"}`,...o1(W)]);const k=[],M=[],O=new Set(Object.values(c.value).flatMap(j=>Object.keys(j.colors)));for(const j of O)/^on-[a-z]/.test(j)?wl(M,`.${j}`,[`color: rgb(var(--v-theme-${j})) !important`]):(wl(k,`.bg-${j}`,[`--v-theme-overlay-multiplier: var(--v-theme-${j}-overlay-multiplier)`,`background-color: rgb(var(--v-theme-${j})) !important`,`color: rgb(var(--v-theme-on-${j})) !important`]),wl(M,`.text-${j}`,[`color: rgb(var(--v-theme-${j})) !important`]),wl(M,`.border-${j}`,[`--v-border-color: var(--v-theme-${j})`]));return C.push(...k,...M),C.map((j,W)=>W===0?j:`    ${j}`).join("")});function l(){return{style:[{children:m.value,id:"vuetify-theme-stylesheet",nonce:t.cspNonce||!1}]}}function b(C){if(t.isDisabled)return;const k=C._context.provides.usehead;if(k)if(k.push){const O=k.push(l);Sn(m,()=>{O.patch(l)})}else Hi?(k.addHeadObjs(Ie(l)),eo(()=>k.updateDOM())):k.addHeadObjs(l());else{let j=function(){if(typeof document<"u"&&!O){const W=document.createElement("style");W.type="text/css",W.id="vuetify-theme-stylesheet",t.cspNonce&&W.setAttribute("nonce",t.cspNonce),O=W,document.head.appendChild(O)}O&&(O.innerHTML=m.value)};var M=j;let O=Hi?document.getElementById("vuetify-theme-stylesheet"):null;Sn(m,j,{immediate:!0})}}const w=Ie(()=>t.isDisabled?void 0:`v-theme--${i.value}`);return{install:b,isDisabled:t.isDisabled,name:i,themes:a,current:d,computedThemes:c,themeClasses:w,styles:m,global:{name:i,current:d}}}function Cs(e){Nr("provideTheme");const t=Jn(Mp,null);if(!t)throw new Error("Could not find Vuetify theme injection");const i=Ie(()=>e.theme??(t==null?void 0:t.name.value)),a=Ie(()=>t.isDisabled?void 0:`v-theme--${i.value}`),c={...t,name:i,themeClasses:a};return Sr(Mp,c),c}function wl(e,t,i){e.push(`${t} {
`,...i.map(a=>`  ${a};
`),`}
`)}function o1(e){const t=e.dark?2:1,i=e.dark?1:2,a=[];for(const[c,d]of Object.entries(e.colors)){const m=Il(d);a.push(`--v-theme-${c}: ${m.r},${m.g},${m.b}`),c.startsWith("on-")||a.push(`--v-theme-${c}-overlay-multiplier: ${yR(d)>.18?t:i}`)}for(const[c,d]of Object.entries(e.variables)){const m=typeof d=="string"&&d.startsWith("#")?Il(d):void 0,l=m?`${m.r}, ${m.g}, ${m.b}`:void 0;a.push(`--v-${c}: ${l??d}`)}return a}const W_={"001":1,AD:1,AE:6,AF:6,AG:0,AI:1,AL:1,AM:1,AN:1,AR:1,AS:0,AT:1,AU:1,AX:1,AZ:1,BA:1,BD:0,BE:1,BG:1,BH:6,BM:1,BN:1,BR:0,BS:0,BT:0,BW:0,BY:1,BZ:0,CA:0,CH:1,CL:1,CM:1,CN:1,CO:0,CR:1,CY:1,CZ:1,DE:1,DJ:6,DK:1,DM:0,DO:0,DZ:6,EC:1,EE:1,EG:6,ES:1,ET:0,FI:1,FJ:1,FO:1,FR:1,GB:1,"GB-alt-variant":0,GE:1,GF:1,GP:1,GR:1,GT:0,GU:0,HK:0,HN:0,HR:1,HU:1,ID:0,IE:1,IL:0,IN:0,IQ:6,IR:6,IS:1,IT:1,JM:0,JO:6,JP:0,KE:0,KG:1,KH:0,KR:0,KW:6,KZ:1,LA:0,LB:1,LI:1,LK:1,LT:1,LU:1,LV:1,LY:6,MC:1,MD:1,ME:1,MH:0,MK:1,MM:0,MN:1,MO:0,MQ:1,MT:0,MV:5,MX:0,MY:1,MZ:0,NI:0,NL:1,NO:1,NP:0,NZ:1,OM:6,PA:0,PE:0,PH:0,PK:0,PL:1,PR:0,PT:0,PY:0,QA:6,RE:1,RO:1,RS:1,RU:1,SA:0,SD:6,SE:1,SG:0,SI:1,SK:1,SM:1,SV:0,SY:6,TH:0,TJ:1,TM:1,TR:1,TT:0,TW:0,UA:1,UM:0,US:0,UY:1,UZ:1,VA:1,VE:0,VI:0,VN:1,WS:0,XK:1,YE:0,ZA:0,ZW:0};function KR(e,t){const i=[];let a=[];const c=yE(e),d=vE(e),m=c.getDay()-W_[t.slice(-2).toUpperCase()],l=d.getDay()-W_[t.slice(-2).toUpperCase()];for(let b=0;b<m;b++){const w=new Date(c);w.setDate(w.getDate()-(m-b)),a.push(w)}for(let b=1;b<=d.getDate();b++){const w=new Date(e.getFullYear(),e.getMonth(),b);a.push(w),a.length===7&&(i.push(a),a=[])}for(let b=1;b<7-l;b++){const w=new Date(d);w.setDate(w.getDate()+b),a.push(w)}return i.push(a),i}function yE(e){return new Date(e.getFullYear(),e.getMonth(),1)}function vE(e){return new Date(e.getFullYear(),e.getMonth()+1,0)}function JR(e){if(e==null)return new Date;if(e instanceof Date)return e;if(typeof e=="string"){const t=Date.parse(e);if(!isNaN(t))return new Date(t)}return null}const l1=new Date(2e3,0,2);function QR(e){const t=W_[e.slice(-2).toUpperCase()];return nE(7).map(i=>{const a=new Date(l1);return a.setDate(l1.getDate()+t+i),new Intl.DateTimeFormat(e,{weekday:"short"}).format(a)})}function eM(e,t,i){const a=new Date(e);let c={};switch(t){case"fullDateWithWeekday":c={weekday:"long",day:"numeric",month:"long",year:"numeric"};break;case"normalDateWithWeekday":c={weekday:"short",day:"numeric",month:"short"};break;case"keyboardDate":c={};break;case"monthAndDate":c={month:"long",day:"numeric"};break;case"monthAndYear":c={month:"long",year:"numeric"};break;case"dayOfMonth":c={day:"numeric"};break;default:c={timeZone:"UTC",timeZoneName:"short"}}return new Intl.DateTimeFormat(i,c).format(a)}function tM(e,t){const i=new Date(e);return i.setDate(i.getDate()+t),i}function nM(e,t){const i=new Date(e);return i.setMonth(i.getMonth()+t),i}function iM(e){return e.getFullYear()}function rM(e){return e.getMonth()}function sM(e){return new Date(e.getFullYear(),0,1)}function aM(e){return new Date(e.getFullYear(),11,31)}function oM(e,t){return Y_(e,t[0])&&cM(e,t[1])}function lM(e){const t=new Date(e);return t instanceof Date&&!isNaN(t.getTime())}function Y_(e,t){return e.getTime()>t.getTime()}function cM(e,t){return e.getTime()<t.getTime()}function c1(e,t){return e.getTime()===t.getTime()}function uM(e,t){return e.getDate()===t.getDate()&&e.getMonth()===t.getMonth()&&e.getFullYear()===t.getFullYear()}function hM(e,t){return e.getMonth()===t.getMonth()&&e.getFullYear()===t.getFullYear()}function dM(e,t,i){const a=new Date(e),c=new Date(t);return i==="month"?a.getMonth()-c.getMonth()+(a.getFullYear()-c.getFullYear())*12:Math.floor((a.getTime()-c.getTime())/(1e3*60*60*24))}function fM(e,t){const i=new Date(e);return i.setFullYear(t),i}class pM{constructor(t){this.locale=t.locale}date(t){return JR(t)}toJsDate(t){return t}addDays(t,i){return tM(t,i)}addMonths(t,i){return nM(t,i)}getWeekArray(t){return KR(t,this.locale)}startOfMonth(t){return yE(t)}endOfMonth(t){return vE(t)}format(t,i){return eM(t,i,this.locale)}isEqual(t,i){return c1(t,i)}isValid(t){return lM(t)}isWithinRange(t,i){return oM(t,i)}isAfter(t,i){return Y_(t,i)}isBefore(t,i){return!Y_(t,i)&&!c1(t,i)}isSameDay(t,i){return uM(t,i)}isSameMonth(t,i){return hM(t,i)}setYear(t,i){return fM(t,i)}getDiff(t,i,a){return dM(t,i,a)}getWeekdays(){return QR(this.locale)}getYear(t){return iM(t)}getMonth(t){return rM(t)}startOfYear(t){return sM(t)}endOfYear(t){return aM(t)}}const u1=Symbol.for("vuetify:date-adapter");function mM(e){return Ss({adapter:pM,locale:{af:"af-ZA",bg:"bg-BG",ca:"ca-ES",ckb:"",cs:"",de:"de-DE",el:"el-GR",en:"en-US",et:"et-EE",fa:"fa-IR",fi:"fi-FI",hr:"hr-HR",hu:"hu-HU",he:"he-IL",id:"id-ID",it:"it-IT",ja:"ja-JP",ko:"ko-KR",lv:"lv-LV",lt:"lt-LT",nl:"nl-NL",no:"nn-NO",pl:"pl-PL",pt:"pt-PT",ro:"ro-RO",ru:"ru-RU",sk:"sk-SK",sl:"sl-SI",srCyrl:"sr-SP",srLatn:"sr-SP",sv:"sv-SE",th:"th-TH",tr:"tr-TR",az:"az-AZ",uk:"uk-UA",vi:"vi-VN",zhHans:"zh-CN",zhHant:"zh-TW"}},e)}function xE(e){const t=Jt(),i=Jt();if(Hi){const a=new ResizeObserver(c=>{e==null||e(c,a),c.length&&(i.value=c[0].contentRect)});no(()=>{a.disconnect()}),Sn(t,(c,d)=>{d&&(a.unobserve(V_(d)),i.value=void 0),c&&a.observe(V_(c))},{flush:"post"})}return{resizeRef:t,contentRect:wd(i)}}const h1=Symbol.for("vuetify:layout"),gM=Symbol.for("vuetify:layout-item"),d1=1e3,_M=$t({overlaps:{type:Array,default:()=>[]},fullHeight:Boolean},"layout"),yM=(e,t,i,a)=>{let c={top:0,left:0,right:0,bottom:0};const d=[{id:"",layer:{...c}}];for(const m of e){const l=t.get(m),b=i.get(m),w=a.get(m);if(!l||!b||!w)continue;const C={...c,[l.value]:parseInt(c[l.value],10)+(w.value?parseInt(b.value,10):0)};d.push({id:m,layer:C}),c=C}return d};function vM(e){const t=Jn(h1,null),i=Ie(()=>t?t.rootZIndex.value-100:d1),a=Jt([]),c=er(new Map),d=er(new Map),m=er(new Map),l=er(new Map),b=er(new Map),{resizeRef:w,contentRect:C}=xE(),k=Ie(()=>{const Oe=new Map,Te=e.overlaps??[];for(const V of Te.filter(Z=>Z.includes(":"))){const[Z,ae]=V.split(":");if(!a.value.includes(Z)||!a.value.includes(ae))continue;const ke=c.get(Z),_e=c.get(ae),oe=d.get(Z),Re=d.get(ae);!ke||!_e||!oe||!Re||(Oe.set(ae,{position:ke.value,amount:parseInt(oe.value,10)}),Oe.set(Z,{position:_e.value,amount:-parseInt(Re.value,10)}))}return Oe}),M=Ie(()=>{const Oe=[...new Set([...m.values()].map(V=>V.value))].sort((V,Z)=>V-Z),Te=[];for(const V of Oe){const Z=a.value.filter(ae=>{var ke;return((ke=m.get(ae))==null?void 0:ke.value)===V});Te.push(...Z)}return yM(Te,c,d,l)}),O=Ie(()=>!Array.from(b.values()).some(Oe=>Oe.value)),j=Ie(()=>M.value[M.value.length-1].layer),W=Ie(()=>({"--v-layout-left":gn(j.value.left),"--v-layout-right":gn(j.value.right),"--v-layout-top":gn(j.value.top),"--v-layout-bottom":gn(j.value.bottom),...O.value?void 0:{transition:"none"}})),le=Ie(()=>M.value.slice(1).map((Oe,Te)=>{let{id:V}=Oe;const{layer:Z}=M.value[Te],ae=d.get(V),ke=c.get(V);return{id:V,...Z,size:Number(ae.value),position:ke.value}})),he=Oe=>le.value.find(Te=>Te.id===Oe),be=Nr("createLayout"),ge=wn(!1);Fl(()=>{ge.value=!0}),Sr(h1,{register:(Oe,Te)=>{let{id:V,order:Z,position:ae,layoutSize:ke,elementSize:_e,active:oe,disableTransitions:Re,absolute:nt}=Te;m.set(V,Z),c.set(V,ae),d.set(V,ke),l.set(V,oe),Re&&b.set(V,Re);const qe=Nh(gM,be==null?void 0:be.vnode).indexOf(Oe);qe>-1?a.value.splice(qe,0,V):a.value.push(V);const je=Ie(()=>le.value.findIndex(rt=>rt.id===V)),Ze=Ie(()=>i.value+M.value.length*2-je.value*2),kt=Ie(()=>{const rt=ae.value==="left"||ae.value==="right",At=ae.value==="right",Pt=ae.value==="bottom",Wt={[ae.value]:0,zIndex:Ze.value,transform:`translate${rt?"X":"Y"}(${(oe.value?0:-110)*(At||Pt?-1:1)}%)`,position:nt.value||i.value!==d1?"absolute":"fixed",...O.value?void 0:{transition:"none"}};if(!ge.value)return Wt;const He=le.value[je.value];if(!He)throw new Error(`[Vuetify] Could not find layout item "${V}"`);const xe=k.value.get(V);return xe&&(He[xe.position]+=xe.amount),{...Wt,height:rt?`calc(100% - ${He.top}px - ${He.bottom}px)`:_e.value?`${_e.value}px`:void 0,left:At?void 0:`${He.left}px`,right:At?`${He.right}px`:void 0,top:ae.value!=="bottom"?`${He.top}px`:void 0,bottom:ae.value!=="top"?`${He.bottom}px`:void 0,width:rt?_e.value?`${_e.value}px`:void 0:`calc(100% - ${He.left}px - ${He.right}px)`}}),Et=Ie(()=>({zIndex:Ze.value-1}));return{layoutItemStyles:kt,layoutItemScrimStyles:Et,zIndex:Ze}},unregister:Oe=>{m.delete(Oe),c.delete(Oe),d.delete(Oe),l.delete(Oe),b.delete(Oe),a.value=a.value.filter(Te=>Te!==Oe)},mainRect:j,mainStyles:W,getLayoutItem:he,items:le,layoutRect:C,rootZIndex:i});const Pe=Ie(()=>["v-layout",{"v-layout--full-height":e.fullHeight}]),Ue=Ie(()=>({zIndex:i.value,position:t?"relative":void 0,overflow:t?"hidden":void 0}));return{layoutClasses:Pe,layoutStyles:Ue,getLayoutItem:he,items:le,layoutRect:C,layoutRef:w}}function bE(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{blueprint:t,...i}=e,a=Ss(t,i),{aliases:c={},components:d={},directives:m={}}=a,l=TR(a.defaults),b=AR(a.display,a.ssr),w=XR(a.theme),C=LR(a.icons),k=UR(a.locale),M=mM(a.date);return{install:j=>{for(const W in m)j.directive(W,m[W]);for(const W in d)j.component(W,d[W]);for(const W in c)j.component(W,_u({...c[W],name:W,aliasName:c[W].name}));if(w.install(j),j.provide(rd,l),j.provide(H_,b),j.provide(Mp,w),j.provide(Z_,C),j.provide(Rp,k),j.provide(u1,M),Hi&&a.ssr)if(j.$nuxt)j.$nuxt.hook("app:suspense:resolve",()=>{b.update()});else{const{mount:W}=j;j.mount=function(){const le=W(...arguments);return Er(()=>b.update()),j.mount=W,le}}Zs.reset(),j.mixin({computed:{$vuetify(){return er({defaults:Oc.call(this,rd),display:Oc.call(this,H_),theme:Oc.call(this,Mp),icons:Oc.call(this,Z_),locale:Oc.call(this,Rp),date:Oc.call(this,u1)})}}})},defaults:l,display:b,theme:w,icons:C,locale:k,date:M}}const xM="3.3.6";bE.version=xM;function Oc(e){var a,c;const t=this.$,i=((a=t.parent)==null?void 0:a.provides)??((c=t.vnode.appContext)==null?void 0:c.provides);if(i&&e in i)return i[e]}var bM=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};bM.SENTRY_RELEASE={id:"4de697d01551039de6dfea8001012f1aadd2b573"};const wM=bE({theme:{defaultTheme:"light"}}),wE=Symbol("vue-facing-decorator-slot");class SM{constructor(t){this.names=new Map,this.inComponent=!1,this.cachedVueComponent=null,this.master=t}obtainMap(t){let i=this.names.get(t);return i||(i=new Map,this.names.set(t,i)),i}}function EM(e){if(ym(e))throw"";const t=new SM(e);return Object.defineProperty(e,wE,{enumerable:!1,value:t}),t}function ym(e){var t;return(t=Object.getOwnPropertyDescriptor(e,wE))===null||t===void 0?void 0:t.value}function nr(e){const t=ym(e);return t||EM(e)}function TM(e,t){return e.reduce((i,a)=>(i[a]=t[a],i),{})}function Ev(e){const t=[];let i=e;do t.unshift(i),i=Object.getPrototypeOf(i);while(i.constructor!==Iv&&!ym(i));return t}function SE(e){let t=Object.getPrototypeOf(e);for(;t.constructor!==Iv;){const i=ym(t);if(i)return i;t=Object.getPrototypeOf(t)}return null}function EE(e,t){return e.filter(i=>{let a=t;for(;a!=null;){for(const c of a.names.keys()){if(["watch","hooks","setup","emits"].includes(c))continue;if(a.names.get(c).has(i))return!1}a=SE(a.master)}return!0})}function Tv(e,t){const i=Object.getOwnPropertyDescriptors(e);return Object.keys(i).filter(a=>t(i[a],a))}function Cv(e){function t(i,a){if(a)e(i,a);else return function(c,d){e(c,d,i)}}return t}const CM=e=>e instanceof Promise;function IM(e,t){const a=nr(e.prototype).obtainMap("setup");if(a.size===0)return;const c=function(d,m){const l={};let b=null;for(const w of a.keys()){const C=a.get(w).setupFunction(d,m);CM(C)?(b??(b=[]),b.push(C.then(k=>{l[w]=k}))):l[w]=C}return Array.isArray(b)?Promise.all(b).then(()=>l):l};t.setup=c}function kM(e,t){var i;(i=t.computed)!==null&&i!==void 0||(t.computed={});const a=nr(e.prototype),c=a.obtainMap("computed"),d=a.obtainMap("vanilla");Ev(e.prototype).forEach(l=>{Tv(l,(b,w)=>(typeof b.get=="function"||typeof b.set=="function")&&!d.has(w)).forEach(b=>{c.set(b,!0);const w=Object.getOwnPropertyDescriptor(l,b);t.computed[b]={get:typeof w.get=="function"?w.get:void 0,set:typeof w.set=="function"?w.set:void 0}})})}function AM(e,t,i,a){var c;(c=t.data)!==null&&c!==void 0||(t.data={});const d=new e(t,i);let m=Tv(d,b=>!!b.enumerable);const l=nr(e.prototype);m=EE(m,l),Object.assign(t.data,TM(m,d))}const PM=["beforeCreate","created","beforeMount","mounted","beforeUpdate","updated","activated","deactivated","beforeDestroy","beforeUnmount","destroyed","unmounted","renderTracked","renderTriggered","errorCaptured","serverPrefetch","render"];function RM(e,t){var i,a;const c=nr(e.prototype),d=Ev(e.prototype),m=c.obtainMap("hooks");(i=t.hooks)!==null&&i!==void 0||(t.hooks={}),(a=t.methods)!==null&&a!==void 0||(t.methods={});const l={},b={};d.forEach(C=>{EE(Tv(C,(k,M)=>M==="constructor"?!1:typeof k.value=="function"),c).forEach(k=>{PM.includes(k)||m.has(k)?l[k]=C[k]:b[k]=C[k]})}),Object.assign(t.methods,b);const w=t.beforeCreateCallbacks;if(w&&w.length>0){const C=l.beforeCreate;l.beforeCreate=function(){w.forEach(k=>k.apply(this,arguments)),C&&C.apply(this,arguments)}}Object.assign(t.hooks,l)}function TE(e,t){var i;(i=e.beforeCreateCallbacks)!==null&&i!==void 0||(e.beforeCreateCallbacks=[]),e.beforeCreateCallbacks.push(function(){const a=this;t(a).forEach((d,m)=>{Object.defineProperty(a,m,d)})})}const MM=Cv(function(e,t){nr(e).obtainMap("ref").set(t,!0)});function DM(e,t){const a=nr(e.prototype).obtainMap("ref");a&&TE(t,c=>{const d=new Map;return a.forEach((m,l)=>{d.set(l,{get:function(){return c.$refs[l]},set:void 0})}),d})}function Ws(e,t){return function(i,a){const d=nr(i).obtainMap("watch"),m=Object.assign({},t??{},{key:e,handler:i[a]});if(d.has(a)){const l=d.get(a);Array.isArray(l)?l.push(m):d.set(a,[l,m])}else d.set(a,m)}}function LM(e,t){var i;(i=t.watch)!==null&&i!==void 0||(t.watch={});const c=nr(e.prototype).obtainMap("watch");c&&c.forEach((d,m)=>{(Array.isArray(d)?d:[d]).forEach(b=>{if(!t.watch[b.key])t.watch[b.key]=b;else{const w=t.watch[b.key];Array.isArray(w)?w.push(b):t.watch[b.key]=[w,b]}})})}const ts=Cv(function(e,t,i){const c=nr(e).obtainMap("props"),d=Object.assign({},i??{});c.set(t,d)});function zM(e,t){var i;(i=t.props)!==null&&i!==void 0||(t.props={});const c=nr(e.prototype).obtainMap("props");c&&c.forEach((d,m)=>{t.props[m]=d})}function OM(e,t){var i;(i=t.inject)!==null&&i!==void 0||(t.inject={});const c=nr(e.prototype).obtainMap("inject");c&&c.forEach((d,m)=>{t.inject[m]=d})}var BM=globalThis&&globalThis.__awaiter||function(e,t,i,a){function c(d){return d instanceof i?d:new i(function(m){m(d)})}return new(i||(i=Promise))(function(d,m){function l(C){try{w(a.next(C))}catch(k){m(k)}}function b(C){try{w(a.throw(C))}catch(k){m(k)}}function w(C){C.done?d(C.value):c(C.value).then(l,b)}w((a=a.apply(e,t||[])).next())})};const FM=Cv(function(e,t,i){nr(e).obtainMap("emit").set(t,typeof i>"u"?null:i)});function NM(e,t){var i;(i=t.methods)!==null&&i!==void 0||(t.methods={});const a=e.prototype,c=nr(a),d=c.obtainMap("emit"),m=c.obtainMap("emits");d&&d.forEach((l,b)=>{const w=l===null?b:l;m.set(w,!0),t.methods[b]=function(){return BM(this,arguments,void 0,function*(){const C=a[b].apply(this,arguments);if(C instanceof Promise){const k=yield C;this.$emit(w,k)}else this.$emit(w,C)})}})}function UM(e,t){var i;(i=t.computed)!==null&&i!==void 0||(t.computed={});const c=nr(e.prototype).obtainMap("v-model");c&&c.size>0&&c.forEach((d,m)=>{var l;const b=(l=d&&d.name)!==null&&l!==void 0?l:"modelValue";t.computed[m]={get:function(){return this[b]},set:function(w){this.$emit(`update:${b}`,w)}}})}function $M(e,t){const a=nr(e.prototype).obtainMap("vanilla"),c=Ev(e.prototype),d=new Map;TE(t,m=>(c.forEach(l=>{const b=Object.getOwnPropertyDescriptors(l);for(const w in b){const C=b[w];C&&a.has(w)&&(typeof C.get=="function"||typeof C.set=="function")&&d.set(w,{set:typeof C.set=="function"?C.set.bind(m):void 0,get:typeof C.get=="function"?C.get.bind(m):void 0})}}),d))}const VM=[];function jM(e,t){const i={};IM(e,i),UM(e,i),kM(e,i),LM(e,i),zM(e,i),OM(e,i),NM(e,i),DM(e,i),RM(e,i),$M(e,i);const a=i.setup?function(d,m){return i.setup(d,m)}:void 0;return Object.assign(Object.assign({setup:a,data(){var d;return delete i.data,AM(e,i,this),(d=i.data)!==null&&d!==void 0?d:{}},methods:i.methods,computed:i.computed,watch:i.watch,props:i.props,inject:i.inject},i.hooks),{extends:t})}function GM(e,t,i){const a=jM(e,i),c=nr(e.prototype);Object.keys(t).reduce((m,l)=>(["options","modifier","emits","setup"].includes(l)||(m[l]=t[l]),m),a);let d=Array.from(c.obtainMap("emits").keys());if(Array.isArray(t.emits)&&(d=Array.from(new Set([...d,...t.emits]))),a.emits=d,VM.forEach(m=>{m.creator.apply({},[a,m.key])}),t.setup)if(!a.setup)a.setup=t.setup;else{const m=a.setup,l=t.setup,b=function(w,C){const k=l(w,C),M=m(w,C);return M instanceof Promise||k instanceof Promise?Promise.all([k,M]).then(O=>Object.assign({},O[0],O[1])):Object.assign({},k,M)};a.setup=b}return t.options&&Object.assign(a,t.options),t.modifier&&t.modifier(a),cm(a)}function qM(e,t){const i=nr(e.prototype);i.inComponent=!0;const a=SE(e.prototype);if(a){if(!a.inComponent)throw"Class should be decorated by Component or ComponentBase: "+i.master;if(a.cachedVueComponent===null)throw"Component decorator 1"}const c=GM(e,t,a===null?void 0:a.cachedVueComponent);c.__vfdConstructor=e,i.cachedVueComponent=c}function HM(e,t){return typeof e=="function"?t(e,{}):function(i){return t(i,e)}}function Ur(e){return HM(e,function(t,i){return qM(t,i),nr(t.prototype).cachedVueComponent})}const Iv=class{constructor(e,t){const i=e.props;i&&Object.keys(i).forEach(a=>{this[a]=t[a]})}},$r=Iv,Yn=pv("filter",{state:()=>({search:"",isMapSynced:!1,resetTrigger:!1,mapShownAssociations:[],countriesFilter:[],thematicsFilter:[],countries:[],thematics:[{value:"accueil",label:"Accueil, assistance et orientation"},{value:"accompagnement",label:"Accompagnement  des migrants de retour"},{value:"humanitaire",label:"Assistance humanitaire (réfugies, déplacés, apatrides)"},{value:"cohesion",label:"Cohésion sociale et vivre ensemble, lutte contre les discriminations"},{value:"droit",label:"Droit et protection des migrants"},{value:"education_sante",label:"Education et santé"},{value:"enfants",label:"Enfants et migration"},{value:"genre",label:"Genre et migration"},{value:"gouvernance",label:"Gouvernance et politiques migratoires"},{value:"professionnel",label:"Formation, insertion professionnelle, intégration économique"},{value:"developpement",label:"Migration et développement "},{value:"plaidoyer",label:"Plaidoyer et sensibilisation"},{value:"circulation",label:"Prévention de la migration irrégulière, promotion de la migration légale et de la liberté de circulation"},{value:"autre_theme",label:"Autre"}]}),getters:{getThematicName:e=>t=>{var i;return((i=e.thematics.find(a=>a.value===t))==null?void 0:i.label)??null}},actions:{}}),Ni=pv("associations",{state:()=>({associations:[],activeAssociationId:null,hoveredAssociationId:null}),getters:{filteredAssociationsWithoutMapFilter:e=>{let t=e.associations;if(Yn().countriesFilter.length&&(t=t.filter(i=>Yn().countriesFilter.includes(i.country))),Yn().thematicsFilter.length&&(t=t.filter(i=>i.thematics.some(a=>Yn().thematicsFilter.includes(a)))),Yn().search!==""){let i=[];t.forEach(a=>{let c=a.name.normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLowerCase(),d=Yn().search.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"");c.includes(d)&&i.push(a)}),t=i}return t},filteredAssociations(){let e=this.filteredAssociationsWithoutMapFilter;return Yn().isMapSynced&&(e=e.filter(t=>Yn().mapShownAssociations.includes(t.id))),e.sort((t,i)=>t.name.localeCompare(i.name))},activeAssociation:e=>e.associations.find(t=>t.id===e.activeAssociationId)??null},actions:{}}),xi=pv("app",{state:()=>({isAboutModalShown:!1,isRedirectionModalShown:!1,isInfoPanelShown:!1,isFiltersBarShown:!1,isDownloadShown:!1,triggerZoomReset:!1,downloadReports:[{name:"Synthèse nationale - Cameroun",filename:"Synthèse nationale - Cameroun.pdf"},{name:"Synthèse nationale - Côte d'Ivoire",filename:"Synthèse nationale - Côte d'Ivoire.pdf"},{name:"Synthèse nationale - Guinée",filename:"Synthèse nationale - Guinée.pdf"},{name:"Synthèse nationale - Mali",filename:"Synthèse nationale - Mali.pdf"},{name:"Synthèse nationale - Maroc",filename:"Synthèse nationale - Maroc.pdf"},{name:"Synthèse nationale - Sénégal",filename:"Synthèse nationale - Sénégal.pdf"},{name:"Synthèse nationale - Tunisie",filename:"Synthèse nationale - Tunisie.pdf"},{name:"Résultats synthétiques Tunisie",filename:"Résultats synthétiques_Tunisie.pdf"}]}),getters:{},actions:{}});var CE=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function ZM(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var IE={exports:{}};(function(e,t){(function(i,a){e.exports=a()})(CE,function(){var i,a,c;function d(l,b){if(!i)i=b;else if(!a)a=b;else{var w="var sharedChunk = {}; ("+i+")(sharedChunk); ("+a+")(sharedChunk);",C={};i(C),c=b(C),typeof window<"u"&&(c.workerUrl=window.URL.createObjectURL(new Blob([w],{type:"text/javascript"})))}}d(["exports"],function(l){function b(s){return s&&s.__esModule&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s}var w=C;function C(s,n){this.x=s,this.y=n}C.prototype={clone:function(){return new C(this.x,this.y)},add:function(s){return this.clone()._add(s)},sub:function(s){return this.clone()._sub(s)},multByPoint:function(s){return this.clone()._multByPoint(s)},divByPoint:function(s){return this.clone()._divByPoint(s)},mult:function(s){return this.clone()._mult(s)},div:function(s){return this.clone()._div(s)},rotate:function(s){return this.clone()._rotate(s)},rotateAround:function(s,n){return this.clone()._rotateAround(s,n)},matMult:function(s){return this.clone()._matMult(s)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(s){return this.x===s.x&&this.y===s.y},dist:function(s){return Math.sqrt(this.distSqr(s))},distSqr:function(s){var n=s.x-this.x,o=s.y-this.y;return n*n+o*o},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(s){return Math.atan2(this.y-s.y,this.x-s.x)},angleWith:function(s){return this.angleWithSep(s.x,s.y)},angleWithSep:function(s,n){return Math.atan2(this.x*n-this.y*s,this.x*s+this.y*n)},_matMult:function(s){var n=s[2]*this.x+s[3]*this.y;return this.x=s[0]*this.x+s[1]*this.y,this.y=n,this},_add:function(s){return this.x+=s.x,this.y+=s.y,this},_sub:function(s){return this.x-=s.x,this.y-=s.y,this},_mult:function(s){return this.x*=s,this.y*=s,this},_div:function(s){return this.x/=s,this.y/=s,this},_multByPoint:function(s){return this.x*=s.x,this.y*=s.y,this},_divByPoint:function(s){return this.x/=s.x,this.y/=s.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var s=this.y;return this.y=this.x,this.x=-s,this},_rotate:function(s){var n=Math.cos(s),o=Math.sin(s),h=o*this.x+n*this.y;return this.x=n*this.x-o*this.y,this.y=h,this},_rotateAround:function(s,n){var o=Math.cos(s),h=Math.sin(s),p=n.y+h*(this.x-n.x)+o*(this.y-n.y);return this.x=n.x+o*(this.x-n.x)-h*(this.y-n.y),this.y=p,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},C.convert=function(s){return s instanceof C?s:Array.isArray(s)?new C(s[0],s[1]):s};var k=b(w),M=O;function O(s,n,o,h){this.cx=3*s,this.bx=3*(o-s)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*n,this.by=3*(h-n)-this.cy,this.ay=1-this.cy-this.by,this.p1x=s,this.p1y=n,this.p2x=o,this.p2y=h}O.prototype={sampleCurveX:function(s){return((this.ax*s+this.bx)*s+this.cx)*s},sampleCurveY:function(s){return((this.ay*s+this.by)*s+this.cy)*s},sampleCurveDerivativeX:function(s){return(3*this.ax*s+2*this.bx)*s+this.cx},solveCurveX:function(s,n){if(n===void 0&&(n=1e-6),s<0)return 0;if(s>1)return 1;for(var o=s,h=0;h<8;h++){var p=this.sampleCurveX(o)-s;if(Math.abs(p)<n)return o;var y=this.sampleCurveDerivativeX(o);if(Math.abs(y)<1e-6)break;o-=p/y}var x=0,S=1;for(o=s,h=0;h<20&&(p=this.sampleCurveX(o),!(Math.abs(p-s)<n));h++)s>p?x=o:S=o,o=.5*(S-x)+x;return o},solve:function(s,n){return this.sampleCurveY(this.solveCurveX(s,n))}};var j=b(M);function W(s,n,o,h){const p=new j(s,n,o,h);return function(y){return p.solve(y)}}const le=W(.25,.1,.25,1);function he(s,n,o){return Math.min(o,Math.max(n,s))}function be(s,n,o){const h=o-n,p=((s-n)%h+h)%h+n;return p===n?o:p}function ge(s,...n){for(const o of n)for(const h in o)s[h]=o[h];return s}let Pe=1;function Ue(s,n,o){const h={};for(const p in s)h[p]=n.call(o||this,s[p],p,s);return h}function Oe(s,n,o){const h={};for(const p in s)n.call(o||this,s[p],p,s)&&(h[p]=s[p]);return h}function Te(s){return Array.isArray(s)?s.map(Te):typeof s=="object"&&s?Ue(s,Te):s}const V={};function Z(s){V[s]||(typeof console<"u"&&console.warn(s),V[s]=!0)}function ae(s,n,o){return(o.y-s.y)*(n.x-s.x)>(n.y-s.y)*(o.x-s.x)}function ke(s){let n=0;for(let o,h,p=0,y=s.length,x=y-1;p<y;x=p++)o=s[p],h=s[x],n+=(h.x-o.x)*(o.y+h.y);return n}function _e(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}let oe=null;function Re(s){if(oe==null){const n=s.navigator?s.navigator.userAgent:null;oe=!!s.safari||!(!n||!(/\b(iPad|iPhone|iPod)\b/.test(n)||n.match("Safari")&&!n.match("Chrome")))}return oe}function nt(s){return typeof ImageBitmap<"u"&&s instanceof ImageBitmap}const Qe="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let qe,je;const Ze={now:typeof performance<"u"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),frame(s){const n=requestAnimationFrame(s);return{cancel:()=>cancelAnimationFrame(n)}},getImageData(s,n=0){return this.getImageCanvasContext(s).getImageData(-n,-n,s.width+2*n,s.height+2*n)},getImageCanvasContext(s){const n=window.document.createElement("canvas"),o=n.getContext("2d",{willReadFrequently:!0});if(!o)throw new Error("failed to create canvas 2d context");return n.width=s.width,n.height=s.height,o.drawImage(s,0,0,s.width,s.height),o},resolveURL:s=>(qe||(qe=document.createElement("a")),qe.href=s,qe.href),hardwareConcurrency:typeof navigator<"u"&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return!!matchMedia&&(je==null&&(je=matchMedia("(prefers-reduced-motion: reduce)")),je.matches)}},kt={MAX_PARALLEL_IMAGE_REQUESTS:16,MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:8,MAX_TILE_CACHE_ZOOM_LEVELS:5,REGISTERED_PROTOCOLS:{},WORKER_URL:""};class Et extends Error{constructor(n,o,h,p){super(`AJAXError: ${o} (${n}): ${h}`),this.status=n,this.statusText=o,this.url=h,this.body=p}}const rt=_e()?()=>self.worker&&self.worker.referrer:()=>(window.location.protocol==="blob:"?window.parent:window).location.href,At=s=>kt.REGISTERED_PROTOCOLS[s.substring(0,s.indexOf("://"))];function Pt(s,n){const o=new AbortController,h=new Request(s.url,{method:s.method||"GET",body:s.body,credentials:s.credentials,headers:s.headers,cache:s.cache,referrer:rt(),signal:o.signal});let p=!1,y=!1;return s.type==="json"&&h.headers.set("Accept","application/json"),y||fetch(h).then(x=>x.ok?(S=>{(s.type==="arrayBuffer"||s.type==="image"?S.arrayBuffer():s.type==="json"?S.json():S.text()).then(I=>{y||(p=!0,n(null,I,S.headers.get("Cache-Control"),S.headers.get("Expires")))}).catch(I=>{y||n(new Error(I.message))})})(x):x.blob().then(S=>n(new Et(x.status,x.statusText,s.url,S)))).catch(x=>{x.code!==20&&n(new Error(x.message))}),{cancel:()=>{y=!0,p||o.abort()}}}const Wt=function(s,n){if(/:\/\//.test(s.url)&&!/^https?:|^file:/.test(s.url)){if(_e()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",s,n);if(!_e())return(At(s.url)||Pt)(s,n)}if(!(/^file:/.test(o=s.url)||/^file:/.test(rt())&&!/^\w+:/.test(o))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return Pt(s,n);if(_e()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",s,n,void 0,!0)}var o;return function(h,p){const y=new XMLHttpRequest;y.open(h.method||"GET",h.url,!0),h.type!=="arrayBuffer"&&h.type!=="image"||(y.responseType="arraybuffer");for(const x in h.headers)y.setRequestHeader(x,h.headers[x]);return h.type==="json"&&(y.responseType="text",y.setRequestHeader("Accept","application/json")),y.withCredentials=h.credentials==="include",y.onerror=()=>{p(new Error(y.statusText))},y.onload=()=>{if((y.status>=200&&y.status<300||y.status===0)&&y.response!==null){let x=y.response;if(h.type==="json")try{x=JSON.parse(y.response)}catch(S){return p(S)}p(null,x,y.getResponseHeader("Cache-Control"),y.getResponseHeader("Expires"))}else{const x=new Blob([y.response],{type:y.getResponseHeader("Content-Type")});p(new Et(y.status,y.statusText,h.url,x))}},y.send(h.body),{cancel:()=>y.abort()}}(s,n)},He=function(s,n){return Wt(ge(s,{type:"arrayBuffer"}),n)};function xe(s){if(!s||s.indexOf("://")<=0||s.indexOf("data:image/")===0||s.indexOf("blob:")===0)return!0;const n=new URL(s),o=window.location;return n.protocol===o.protocol&&n.host===o.host}function Ke(s,n,o){o[s]&&o[s].indexOf(n)!==-1||(o[s]=o[s]||[],o[s].push(n))}function Fe(s,n,o){if(o&&o[s]){const h=o[s].indexOf(n);h!==-1&&o[s].splice(h,1)}}class Ge{constructor(n,o={}){ge(this,o),this.type=n}}class ft extends Ge{constructor(n,o={}){super("error",ge({error:n},o))}}class X{on(n,o){return this._listeners=this._listeners||{},Ke(n,o,this._listeners),this}off(n,o){return Fe(n,o,this._listeners),Fe(n,o,this._oneTimeListeners),this}once(n,o){return o?(this._oneTimeListeners=this._oneTimeListeners||{},Ke(n,o,this._oneTimeListeners),this):new Promise(h=>this.once(n,h))}fire(n,o){typeof n=="string"&&(n=new Ge(n,o||{}));const h=n.type;if(this.listens(h)){n.target=this;const p=this._listeners&&this._listeners[h]?this._listeners[h].slice():[];for(const S of p)S.call(this,n);const y=this._oneTimeListeners&&this._oneTimeListeners[h]?this._oneTimeListeners[h].slice():[];for(const S of y)Fe(h,S,this._oneTimeListeners),S.call(this,n);const x=this._eventedParent;x&&(ge(n,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),x.fire(n))}else n instanceof ft&&console.error(n.error);return this}listens(n){return this._listeners&&this._listeners[n]&&this._listeners[n].length>0||this._oneTimeListeners&&this._oneTimeListeners[n]&&this._oneTimeListeners[n].length>0||this._eventedParent&&this._eventedParent.listens(n)}setEventedParent(n,o){return this._eventedParent=n,this._eventedParentData=o,this}}var U={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{}},default:"mapbox"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};const ye=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function Le(s,n){const o={};for(const h in s)h!=="ref"&&(o[h]=s[h]);return ye.forEach(h=>{h in n&&(o[h]=n[h])}),o}function De(s,n){if(Array.isArray(s)){if(!Array.isArray(n)||s.length!==n.length)return!1;for(let o=0;o<s.length;o++)if(!De(s[o],n[o]))return!1;return!0}if(typeof s=="object"&&s!==null&&n!==null){if(typeof n!="object"||Object.keys(s).length!==Object.keys(n).length)return!1;for(const o in s)if(!De(s[o],n[o]))return!1;return!0}return s===n}const Ve={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight"};function ht(s,n,o){o.push({command:Ve.addSource,args:[s,n[s]]})}function ct(s,n,o){n.push({command:Ve.removeSource,args:[s]}),o[s]=!0}function pt(s,n,o,h){ct(s,o,h),ht(s,n,o)}function it(s,n,o){let h;for(h in s[o])if(Object.prototype.hasOwnProperty.call(s[o],h)&&h!=="data"&&!De(s[o][h],n[o][h]))return!1;for(h in n[o])if(Object.prototype.hasOwnProperty.call(n[o],h)&&h!=="data"&&!De(s[o][h],n[o][h]))return!1;return!0}function ut(s,n,o,h,p,y){let x;for(x in n=n||{},s=s||{})Object.prototype.hasOwnProperty.call(s,x)&&(De(s[x],n[x])||o.push({command:y,args:[h,x,n[x],p]}));for(x in n)Object.prototype.hasOwnProperty.call(n,x)&&!Object.prototype.hasOwnProperty.call(s,x)&&(De(s[x],n[x])||o.push({command:y,args:[h,x,n[x],p]}))}function yt(s){return s.id}function Lt(s,n){return s[n.id]=n,s}class Be{constructor(n,o,h,p){this.message=(n?`${n}: `:"")+h,p&&(this.identifier=p),o!=null&&o.__line__&&(this.line=o.__line__)}}function jt(s,...n){for(const o of n)for(const h in o)s[h]=o[h];return s}class Xt extends Error{constructor(n,o){super(o),this.message=o,this.key=n}}class tn{constructor(n,o=[]){this.parent=n,this.bindings={};for(const[h,p]of o)this.bindings[h]=p}concat(n){return new tn(this,n)}get(n){if(this.bindings[n])return this.bindings[n];if(this.parent)return this.parent.get(n);throw new Error(`${n} not found in scope.`)}has(n){return!!this.bindings[n]||!!this.parent&&this.parent.has(n)}}const fn={kind:"null"},st={kind:"number"},Ft={kind:"string"},Nt={kind:"boolean"},On={kind:"color"},qn={kind:"object"},It={kind:"value"},Hn={kind:"collator"},Tr={kind:"formatted"},Ys={kind:"padding"},jr={kind:"resolvedImage"},Xs={kind:"variableAnchorOffsetCollection"};function Ui(s,n){return{kind:"array",itemType:s,N:n}}function Bn(s){if(s.kind==="array"){const n=Bn(s.itemType);return typeof s.N=="number"?`array<${n}, ${s.N}>`:s.itemType.kind==="value"?"array":`array<${n}>`}return s.kind}const Ko=[fn,st,Ft,Nt,On,Tr,qn,Ui(It),Ys,jr,Xs];function gs(s,n){if(n.kind==="error")return null;if(s.kind==="array"){if(n.kind==="array"&&(n.N===0&&n.itemType.kind==="value"||!gs(s.itemType,n.itemType))&&(typeof s.N!="number"||s.N===n.N))return null}else{if(s.kind===n.kind)return null;if(s.kind==="value"){for(const o of Ko)if(!gs(o,n))return null}}return`Expected ${Bn(s)} but found ${Bn(n)} instead.`}function ne(s,n){return n.some(o=>o.kind===s.kind)}function F(s,n){return n.some(o=>o==="null"?s===null:o==="array"?Array.isArray(s):o==="object"?s&&!Array.isArray(s)&&typeof s=="object":o===typeof s)}function $(s,n){return s.kind==="array"&&n.kind==="array"?s.itemType.kind===n.itemType.kind&&typeof s.N=="number":s.kind===n.kind}const Y=.96422,re=.82521,de=4/29,Se=6/29,pe=3*Se*Se,fe=Se*Se*Se,Ce=Math.PI/180,Xe=180/Math.PI;function et(s){return(s%=360)<0&&(s+=360),s}function tt([s,n,o,h]){let p,y;const x=Qt((.2225045*(s=Gt(s))+.7168786*(n=Gt(n))+.0606169*(o=Gt(o)))/1);s===n&&n===o?p=y=x:(p=Qt((.4360747*s+.3850649*n+.1430804*o)/Y),y=Qt((.0139322*s+.0971045*n+.7141733*o)/re));const S=116*x-16;return[S<0?0:S,500*(p-x),200*(x-y),h]}function Gt(s){return s<=.04045?s/12.92:Math.pow((s+.055)/1.055,2.4)}function Qt(s){return s>fe?Math.pow(s,1/3):s/pe+de}function Rt([s,n,o,h]){let p=(s+16)/116,y=isNaN(n)?p:p+n/500,x=isNaN(o)?p:p-o/200;return p=1*Kt(p),y=Y*Kt(y),x=re*Kt(x),[Ut(3.1338561*y-1.6168667*p-.4906146*x),Ut(-.9787684*y+1.9161415*p+.033454*x),Ut(.0719453*y-.2289914*p+1.4052427*x),h]}function Ut(s){return(s=s<=.00304?12.92*s:1.055*Math.pow(s,1/2.4)-.055)<0?0:s>1?1:s}function Kt(s){return s>Se?s*s*s:pe*(s-de)}function _n(s){return parseInt(s.padEnd(2,s),16)/255}function Dn(s,n){return on(n?s/100:s,0,1)}function on(s,n,o){return Math.min(Math.max(n,s),o)}function pn(s){return!s.some(Number.isNaN)}const dr={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};class Yt{constructor(n,o,h,p=1,y=!0){this.r=n,this.g=o,this.b=h,this.a=p,y||(this.r*=p,this.g*=p,this.b*=p,p||this.overwriteGetter("rgb",[n,o,h,p]))}static parse(n){if(n instanceof Yt)return n;if(typeof n!="string")return;const o=function(h){if((h=h.toLowerCase().trim())==="transparent")return[0,0,0,0];const p=dr[h];if(p){const[x,S,I]=p;return[x/255,S/255,I/255,1]}if(h.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(h)){const x=h.length<6?1:2;let S=1;return[_n(h.slice(S,S+=x)),_n(h.slice(S,S+=x)),_n(h.slice(S,S+=x)),_n(h.slice(S,S+x)||"ff")]}if(h.startsWith("rgb")){const x=h.match(/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(x){const[S,I,P,L,B,N,q,H,ee,ie,ce,Ee]=x,me=[L||" ",q||" ",ie].join("");if(me==="  "||me==="  /"||me===",,"||me===",,,"){const Ae=[P,N,ee].join(""),ze=Ae==="%%%"?100:Ae===""?255:0;if(ze){const Ye=[on(+I/ze,0,1),on(+B/ze,0,1),on(+H/ze,0,1),ce?Dn(+ce,Ee):1];if(pn(Ye))return Ye}}return}}const y=h.match(/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(y){const[x,S,I,P,L,B,N,q,H]=y,ee=[I||" ",L||" ",N].join("");if(ee==="  "||ee==="  /"||ee===",,"||ee===",,,"){const ie=[+S,on(+P,0,100),on(+B,0,100),q?Dn(+q,H):1];if(pn(ie))return function([ce,Ee,me,Ae]){function ze(Ye){const wt=(Ye+ce/30)%12,Dt=Ee*Math.min(me,1-me);return me-Dt*Math.max(-1,Math.min(wt-3,9-wt,1))}return ce=et(ce),Ee/=100,me/=100,[ze(0),ze(8),ze(4),Ae]}(ie)}}}(n);return o?new Yt(...o,!1):void 0}get rgb(){const{r:n,g:o,b:h,a:p}=this,y=p||1/0;return this.overwriteGetter("rgb",[n/y,o/y,h/y,p])}get hcl(){return this.overwriteGetter("hcl",function(n){const[o,h,p,y]=tt(n),x=Math.sqrt(h*h+p*p);return[Math.round(1e4*x)?et(Math.atan2(p,h)*Xe):NaN,x,o,y]}(this.rgb))}get lab(){return this.overwriteGetter("lab",tt(this.rgb))}overwriteGetter(n,o){return Object.defineProperty(this,n,{value:o}),o}toString(){const[n,o,h,p]=this.rgb;return`rgba(${[n,o,h].map(y=>Math.round(255*y)).join(",")},${p})`}}Yt.black=new Yt(0,0,0,1),Yt.white=new Yt(1,1,1,1),Yt.transparent=new Yt(0,0,0,0),Yt.red=new Yt(1,0,0,1);class bi{constructor(n,o,h){this.sensitivity=n?o?"variant":"case":o?"accent":"base",this.locale=h,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(n,o){return this.collator.compare(n,o)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class $i{constructor(n,o,h,p,y){this.text=n,this.image=o,this.scale=h,this.fontStack=p,this.textColor=y}}class di{constructor(n){this.sections=n}static fromString(n){return new di([new $i(n,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(n=>n.text.length!==0||n.image&&n.image.name.length!==0)}static factory(n){return n instanceof di?n:di.fromString(n)}toString(){return this.sections.length===0?"":this.sections.map(n=>n.text).join("")}}class Cr{constructor(n){this.values=n.slice()}static parse(n){if(n instanceof Cr)return n;if(typeof n=="number")return new Cr([n,n,n,n]);if(Array.isArray(n)&&!(n.length<1||n.length>4)){for(const o of n)if(typeof o!="number")return;switch(n.length){case 1:n=[n[0],n[0],n[0],n[0]];break;case 2:n=[n[0],n[1],n[0],n[1]];break;case 3:n=[n[0],n[1],n[2],n[1]]}return new Cr(n)}}toString(){return JSON.stringify(this.values)}}const $m=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]);class Zi{constructor(n){this.values=n.slice()}static parse(n){if(n instanceof Zi)return n;if(Array.isArray(n)&&!(n.length<1)&&n.length%2==0){for(let o=0;o<n.length;o+=2){const h=n[o],p=n[o+1];if(typeof h!="string"||!$m.has(h)||!Array.isArray(p)||p.length!==2||typeof p[0]!="number"||typeof p[1]!="number")return}return new Zi(n)}}toString(){return JSON.stringify(this.values)}}class Gr{constructor(n){this.name=n.name,this.available=n.available}toString(){return this.name}static fromString(n){return n?new Gr({name:n,available:!1}):null}}function Ld(s,n,o,h){return typeof s=="number"&&s>=0&&s<=255&&typeof n=="number"&&n>=0&&n<=255&&typeof o=="number"&&o>=0&&o<=255?h===void 0||typeof h=="number"&&h>=0&&h<=1?null:`Invalid rgba value [${[s,n,o,h].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof h=="number"?[s,n,o,h]:[s,n,o]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function $l(s){if(s===null||typeof s=="string"||typeof s=="boolean"||typeof s=="number"||s instanceof Yt||s instanceof bi||s instanceof di||s instanceof Cr||s instanceof Zi||s instanceof Gr)return!0;if(Array.isArray(s)){for(const n of s)if(!$l(n))return!1;return!0}if(typeof s=="object"){for(const n in s)if(!$l(s[n]))return!1;return!0}return!1}function fi(s){if(s===null)return fn;if(typeof s=="string")return Ft;if(typeof s=="boolean")return Nt;if(typeof s=="number")return st;if(s instanceof Yt)return On;if(s instanceof bi)return Hn;if(s instanceof di)return Tr;if(s instanceof Cr)return Ys;if(s instanceof Zi)return Xs;if(s instanceof Gr)return jr;if(Array.isArray(s)){const n=s.length;let o;for(const h of s){const p=fi(h);if(o){if(o===p)continue;o=It;break}o=p}return Ui(o||It,n)}return qn}function Ks(s){const n=typeof s;return s===null?"":n==="string"||n==="number"||n==="boolean"?String(s):s instanceof Yt||s instanceof di||s instanceof Cr||s instanceof Zi||s instanceof Gr?s.toString():JSON.stringify(s)}class wa{constructor(n,o){this.type=n,this.value=o}static parse(n,o){if(n.length!==2)return o.error(`'literal' expression requires exactly one argument, but found ${n.length-1} instead.`);if(!$l(n[1]))return o.error("invalid value");const h=n[1];let p=fi(h);const y=o.expectedType;return p.kind!=="array"||p.N!==0||!y||y.kind!=="array"||typeof y.N=="number"&&y.N!==0||(p=y),new wa(p,h)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}class pi{constructor(n){this.name="ExpressionEvaluationError",this.message=n}toJSON(){return this.message}}const Vl={string:Ft,number:st,boolean:Nt,object:qn};class Wi{constructor(n,o){this.type=n,this.args=o}static parse(n,o){if(n.length<2)return o.error("Expected at least one argument.");let h,p=1;const y=n[0];if(y==="array"){let S,I;if(n.length>2){const P=n[1];if(typeof P!="string"||!(P in Vl)||P==="object")return o.error('The item type argument of "array" must be one of string, number, boolean',1);S=Vl[P],p++}else S=It;if(n.length>3){if(n[2]!==null&&(typeof n[2]!="number"||n[2]<0||n[2]!==Math.floor(n[2])))return o.error('The length argument to "array" must be a positive integer literal',2);I=n[2],p++}h=Ui(S,I)}else{if(!Vl[y])throw new Error(`Types doesn't contain name = ${y}`);h=Vl[y]}const x=[];for(;p<n.length;p++){const S=o.parse(n[p],p,It);if(!S)return null;x.push(S)}return new Wi(h,x)}evaluate(n){for(let o=0;o<this.args.length;o++){const h=this.args[o].evaluate(n);if(!gs(this.type,fi(h)))return h;if(o===this.args.length-1)throw new pi(`Expected value to be of type ${Bn(this.type)}, but found ${Bn(fi(h))} instead.`)}throw new Error}eachChild(n){this.args.forEach(n)}outputDefined(){return this.args.every(n=>n.outputDefined())}}const jl={"to-boolean":Nt,"to-color":On,"to-number":st,"to-string":Ft};class _s{constructor(n,o){this.type=n,this.args=o}static parse(n,o){if(n.length<2)return o.error("Expected at least one argument.");const h=n[0];if(!jl[h])throw new Error(`Can't parse ${h} as it is not part of the known types`);if((h==="to-boolean"||h==="to-string")&&n.length!==2)return o.error("Expected one argument.");const p=jl[h],y=[];for(let x=1;x<n.length;x++){const S=o.parse(n[x],x,It);if(!S)return null;y.push(S)}return new _s(p,y)}evaluate(n){switch(this.type.kind){case"boolean":return!!this.args[0].evaluate(n);case"color":{let o,h;for(const p of this.args){if(o=p.evaluate(n),h=null,o instanceof Yt)return o;if(typeof o=="string"){const y=n.parseColor(o);if(y)return y}else if(Array.isArray(o)&&(h=o.length<3||o.length>4?`Invalid rbga value ${JSON.stringify(o)}: expected an array containing either three or four numeric values.`:Ld(o[0],o[1],o[2],o[3]),!h))return new Yt(o[0]/255,o[1]/255,o[2]/255,o[3])}throw new pi(h||`Could not parse color from value '${typeof o=="string"?o:JSON.stringify(o)}'`)}case"padding":{let o;for(const h of this.args){o=h.evaluate(n);const p=Cr.parse(o);if(p)return p}throw new pi(`Could not parse padding from value '${typeof o=="string"?o:JSON.stringify(o)}'`)}case"variableAnchorOffsetCollection":{let o;for(const h of this.args){o=h.evaluate(n);const p=Zi.parse(o);if(p)return p}throw new pi(`Could not parse variableAnchorOffsetCollection from value '${typeof o=="string"?o:JSON.stringify(o)}'`)}case"number":{let o=null;for(const h of this.args){if(o=h.evaluate(n),o===null)return 0;const p=Number(o);if(!isNaN(p))return p}throw new pi(`Could not convert ${JSON.stringify(o)} to number.`)}case"formatted":return di.fromString(Ks(this.args[0].evaluate(n)));case"resolvedImage":return Gr.fromString(Ks(this.args[0].evaluate(n)));default:return Ks(this.args[0].evaluate(n))}}eachChild(n){this.args.forEach(n)}outputDefined(){return this.args.every(n=>n.outputDefined())}}const Jo=["Unknown","Point","LineString","Polygon"];class Pn{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?Jo[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(n){let o=this._parseColorCache[n];return o||(o=this._parseColorCache[n]=Yt.parse(n)),o}}class Gl{constructor(n,o,h=[],p,y=new tn,x=[]){this.registry=n,this.path=h,this.key=h.map(S=>`[${S}]`).join(""),this.scope=y,this.errors=x,this.expectedType=p,this._isConstant=o}parse(n,o,h,p,y={}){return o?this.concat(o,h,p)._parse(n,y):this._parse(n,y)}_parse(n,o){function h(p,y,x){return x==="assert"?new Wi(y,[p]):x==="coerce"?new _s(y,[p]):p}if(n!==null&&typeof n!="string"&&typeof n!="boolean"&&typeof n!="number"||(n=["literal",n]),Array.isArray(n)){if(n.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const p=n[0];if(typeof p!="string")return this.error(`Expression name must be a string, but found ${typeof p} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const y=this.registry[p];if(y){let x=y.parse(n,this);if(!x)return null;if(this.expectedType){const S=this.expectedType,I=x.type;if(S.kind!=="string"&&S.kind!=="number"&&S.kind!=="boolean"&&S.kind!=="object"&&S.kind!=="array"||I.kind!=="value")if(S.kind!=="color"&&S.kind!=="formatted"&&S.kind!=="resolvedImage"||I.kind!=="value"&&I.kind!=="string")if(S.kind!=="padding"||I.kind!=="value"&&I.kind!=="number"&&I.kind!=="array")if(S.kind!=="variableAnchorOffsetCollection"||I.kind!=="value"&&I.kind!=="array"){if(this.checkSubtype(S,I))return null}else x=h(x,S,o.typeAnnotation||"coerce");else x=h(x,S,o.typeAnnotation||"coerce");else x=h(x,S,o.typeAnnotation||"coerce");else x=h(x,S,o.typeAnnotation||"assert")}if(!(x instanceof wa)&&x.type.kind!=="resolvedImage"&&this._isConstant(x)){const S=new Pn;try{x=new wa(x.type,x.evaluate(S))}catch(I){return this.error(I.message),null}}return x}return this.error(`Unknown expression "${p}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(n===void 0?"'undefined' value invalid. Use null instead.":typeof n=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof n} instead.`)}concat(n,o,h){const p=typeof n=="number"?this.path.concat(n):this.path,y=h?this.scope.concat(h):this.scope;return new Gl(this.registry,this._isConstant,p,o||null,y,this.errors)}error(n,...o){const h=`${this.key}${o.map(p=>`[${p}]`).join("")}`;this.errors.push(new Xt(h,n))}checkSubtype(n,o){const h=gs(n,o);return h&&this.error(h),h}}class io{constructor(n,o,h){this.type=Hn,this.locale=h,this.caseSensitive=n,this.diacriticSensitive=o}static parse(n,o){if(n.length!==2)return o.error("Expected one argument.");const h=n[1];if(typeof h!="object"||Array.isArray(h))return o.error("Collator options argument must be an object.");const p=o.parse(h["case-sensitive"]!==void 0&&h["case-sensitive"],1,Nt);if(!p)return null;const y=o.parse(h["diacritic-sensitive"]!==void 0&&h["diacritic-sensitive"],1,Nt);if(!y)return null;let x=null;return h.locale&&(x=o.parse(h.locale,1,Ft),!x)?null:new io(p,y,x)}evaluate(n){return new bi(this.caseSensitive.evaluate(n),this.diacriticSensitive.evaluate(n),this.locale?this.locale.evaluate(n):null)}eachChild(n){n(this.caseSensitive),n(this.diacriticSensitive),this.locale&&n(this.locale)}outputDefined(){return!1}}const Js=8192;function ql(s,n){s[0]=Math.min(s[0],n[0]),s[1]=Math.min(s[1],n[1]),s[2]=Math.max(s[2],n[0]),s[3]=Math.max(s[3],n[1])}function Qo(s,n){return!(s[0]<=n[0]||s[2]>=n[2]||s[1]<=n[1]||s[3]>=n[3])}function Vm(s,n){const o=(180+s[0])/360,h=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+s[1]*Math.PI/360)))/360,p=Math.pow(2,n.z);return[Math.round(o*p*Js),Math.round(h*p*Js)]}function zd(s,n,o){const h=s[0]-n[0],p=s[1]-n[1],y=s[0]-o[0],x=s[1]-o[1];return h*x-y*p==0&&h*y<=0&&p*x<=0}function Hl(s,n){let o=!1;for(let x=0,S=n.length;x<S;x++){const I=n[x];for(let P=0,L=I.length;P<L-1;P++){if(zd(s,I[P],I[P+1]))return!1;(p=I[P])[1]>(h=s)[1]!=(y=I[P+1])[1]>h[1]&&h[0]<(y[0]-p[0])*(h[1]-p[1])/(y[1]-p[1])+p[0]&&(o=!o)}}var h,p,y;return o}function jm(s,n){for(let o=0;o<n.length;o++)if(Hl(s,n[o]))return!0;return!1}function Od(s,n,o,h){const p=h[0]-o[0],y=h[1]-o[1],x=(s[0]-o[0])*y-p*(s[1]-o[1]),S=(n[0]-o[0])*y-p*(n[1]-o[1]);return x>0&&S<0||x<0&&S>0}function Gm(s,n,o){for(const P of o)for(let L=0;L<P.length-1;++L)if((S=[(x=P[L+1])[0]-(y=P[L])[0],x[1]-y[1]])[0]*(I=[(p=n)[0]-(h=s)[0],p[1]-h[1]])[1]-S[1]*I[0]!=0&&Od(h,p,y,x)&&Od(y,x,h,p))return!0;var h,p,y,x,S,I;return!1}function Bd(s,n){for(let o=0;o<s.length;++o)if(!Hl(s[o],n))return!1;for(let o=0;o<s.length-1;++o)if(Gm(s[o],s[o+1],n))return!1;return!0}function Fd(s,n){for(let o=0;o<n.length;o++)if(Bd(s,n[o]))return!0;return!1}function Zl(s,n,o){const h=[];for(let p=0;p<s.length;p++){const y=[];for(let x=0;x<s[p].length;x++){const S=Vm(s[p][x],o);ql(n,S),y.push(S)}h.push(y)}return h}function Nd(s,n,o){const h=[];for(let p=0;p<s.length;p++){const y=Zl(s[p],n,o);h.push(y)}return h}function Ud(s,n,o,h){if(s[0]<o[0]||s[0]>o[2]){const p=.5*h;let y=s[0]-o[0]>p?-h:o[0]-s[0]>p?h:0;y===0&&(y=s[0]-o[2]>p?-h:o[2]-s[0]>p?h:0),s[0]+=y}ql(n,s)}function Wl(s,n,o,h){const p=Math.pow(2,h.z)*Js,y=[h.x*Js,h.y*Js],x=[];for(const S of s)for(const I of S){const P=[I.x+y[0],I.y+y[1]];Ud(P,n,o,p),x.push(P)}return x}function $d(s,n,o,h){const p=Math.pow(2,h.z)*Js,y=[h.x*Js,h.y*Js],x=[];for(const I of s){const P=[];for(const L of I){const B=[L.x+y[0],L.y+y[1]];ql(n,B),P.push(B)}x.push(P)}if(n[2]-n[0]<=p/2){(S=n)[0]=S[1]=1/0,S[2]=S[3]=-1/0;for(const I of x)for(const P of I)Ud(P,n,o,p)}var S;return x}class Sa{constructor(n,o){this.type=Nt,this.geojson=n,this.geometries=o}static parse(n,o){if(n.length!==2)return o.error(`'within' expression requires exactly one argument, but found ${n.length-1} instead.`);if($l(n[1])){const h=n[1];if(h.type==="FeatureCollection")for(let p=0;p<h.features.length;++p){const y=h.features[p].geometry.type;if(y==="Polygon"||y==="MultiPolygon")return new Sa(h,h.features[p].geometry)}else if(h.type==="Feature"){const p=h.geometry.type;if(p==="Polygon"||p==="MultiPolygon")return new Sa(h,h.geometry)}else if(h.type==="Polygon"||h.type==="MultiPolygon")return new Sa(h,h)}return o.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(n){if(n.geometry()!=null&&n.canonicalID()!=null){if(n.geometryType()==="Point")return function(o,h){const p=[1/0,1/0,-1/0,-1/0],y=[1/0,1/0,-1/0,-1/0],x=o.canonicalID();if(h.type==="Polygon"){const S=Zl(h.coordinates,y,x),I=Wl(o.geometry(),p,y,x);if(!Qo(p,y))return!1;for(const P of I)if(!Hl(P,S))return!1}if(h.type==="MultiPolygon"){const S=Nd(h.coordinates,y,x),I=Wl(o.geometry(),p,y,x);if(!Qo(p,y))return!1;for(const P of I)if(!jm(P,S))return!1}return!0}(n,this.geometries);if(n.geometryType()==="LineString")return function(o,h){const p=[1/0,1/0,-1/0,-1/0],y=[1/0,1/0,-1/0,-1/0],x=o.canonicalID();if(h.type==="Polygon"){const S=Zl(h.coordinates,y,x),I=$d(o.geometry(),p,y,x);if(!Qo(p,y))return!1;for(const P of I)if(!Bd(P,S))return!1}if(h.type==="MultiPolygon"){const S=Nd(h.coordinates,y,x),I=$d(o.geometry(),p,y,x);if(!Qo(p,y))return!1;for(const P of I)if(!Fd(P,S))return!1}return!0}(n,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}class Yl{constructor(n,o){this.type=o.type,this.name=n,this.boundExpression=o}static parse(n,o){if(n.length!==2||typeof n[1]!="string")return o.error("'var' expression requires exactly one string literal argument.");const h=n[1];return o.scope.has(h)?new Yl(h,o.scope.get(h)):o.error(`Unknown variable "${h}". Make sure "${h}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(n){return this.boundExpression.evaluate(n)}eachChild(){}outputDefined(){return!1}}class Ir{constructor(n,o,h,p){this.name=n,this.type=o,this._evaluate=h,this.args=p}evaluate(n){return this._evaluate(n,this.args)}eachChild(n){this.args.forEach(n)}outputDefined(){return!1}static parse(n,o){const h=n[0],p=Ir.definitions[h];if(!p)return o.error(`Unknown expression "${h}". If you wanted a literal array, use ["literal", [...]].`,0);const y=Array.isArray(p)?p[0]:p.type,x=Array.isArray(p)?[[p[1],p[2]]]:p.overloads,S=x.filter(([P])=>!Array.isArray(P)||P.length===n.length-1);let I=null;for(const[P,L]of S){I=new Gl(o.registry,el,o.path,null,o.scope);const B=[];let N=!1;for(let q=1;q<n.length;q++){const H=n[q],ee=Array.isArray(P)?P[q-1]:P.type,ie=I.parse(H,1+B.length,ee);if(!ie){N=!0;break}B.push(ie)}if(!N)if(Array.isArray(P)&&P.length!==B.length)I.error(`Expected ${P.length} arguments, but found ${B.length} instead.`);else{for(let q=0;q<B.length;q++){const H=Array.isArray(P)?P[q]:P.type,ee=B[q];I.concat(q+1).checkSubtype(H,ee.type)}if(I.errors.length===0)return new Ir(h,y,L,B)}}if(S.length===1)o.errors.push(...I.errors);else{const P=(S.length?S:x).map(([B])=>{return N=B,Array.isArray(N)?`(${N.map(Bn).join(", ")})`:`(${Bn(N.type)}...)`;var N}).join(" | "),L=[];for(let B=1;B<n.length;B++){const N=o.parse(n[B],1+L.length);if(!N)return null;L.push(Bn(N.type))}o.error(`Expected arguments of type ${P}, but found (${L.join(", ")}) instead.`)}return null}static register(n,o){Ir.definitions=o;for(const h in o)n[h]=Ir}}function el(s){if(s instanceof Yl)return el(s.boundExpression);if(s instanceof Ir&&s.name==="error"||s instanceof io||s instanceof Sa)return!1;const n=s instanceof _s||s instanceof Wi;let o=!0;return s.eachChild(h=>{o=n?o&&el(h):o&&h instanceof wa}),!!o&&Xl(s)&&nl(s,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}function Xl(s){if(s instanceof Ir&&(s.name==="get"&&s.args.length===1||s.name==="feature-state"||s.name==="has"&&s.args.length===1||s.name==="properties"||s.name==="geometry-type"||s.name==="id"||/^filter-/.test(s.name))||s instanceof Sa)return!1;let n=!0;return s.eachChild(o=>{n&&!Xl(o)&&(n=!1)}),n}function tl(s){if(s instanceof Ir&&s.name==="feature-state")return!1;let n=!0;return s.eachChild(o=>{n&&!tl(o)&&(n=!1)}),n}function nl(s,n){if(s instanceof Ir&&n.indexOf(s.name)>=0)return!1;let o=!0;return s.eachChild(h=>{o&&!nl(h,n)&&(o=!1)}),o}function il(s,n){const o=s.length-1;let h,p,y=0,x=o,S=0;for(;y<=x;)if(S=Math.floor((y+x)/2),h=s[S],p=s[S+1],h<=n){if(S===o||n<p)return S;y=S+1}else{if(!(h>n))throw new pi("Input is not a number.");x=S-1}return 0}class rl{constructor(n,o,h){this.type=n,this.input=o,this.labels=[],this.outputs=[];for(const[p,y]of h)this.labels.push(p),this.outputs.push(y)}static parse(n,o){if(n.length-1<4)return o.error(`Expected at least 4 arguments, but found only ${n.length-1}.`);if((n.length-1)%2!=0)return o.error("Expected an even number of arguments.");const h=o.parse(n[1],1,st);if(!h)return null;const p=[];let y=null;o.expectedType&&o.expectedType.kind!=="value"&&(y=o.expectedType);for(let x=1;x<n.length;x+=2){const S=x===1?-1/0:n[x],I=n[x+1],P=x,L=x+1;if(typeof S!="number")return o.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',P);if(p.length&&p[p.length-1][0]>=S)return o.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',P);const B=o.parse(I,L,y);if(!B)return null;y=y||B.type,p.push([S,B])}return new rl(y,h,p)}evaluate(n){const o=this.labels,h=this.outputs;if(o.length===1)return h[0].evaluate(n);const p=this.input.evaluate(n);if(p<=o[0])return h[0].evaluate(n);const y=o.length;return p>=o[y-1]?h[y-1].evaluate(n):h[il(o,p)].evaluate(n)}eachChild(n){n(this.input);for(const o of this.outputs)n(o)}outputDefined(){return this.outputs.every(n=>n.outputDefined())}}function Ea(s,n,o){return s+o*(n-s)}function Kl(s,n,o){return s.map((h,p)=>Ea(h,n[p],o))}const kr={number:Ea,color:function(s,n,o,h="rgb"){switch(h){case"rgb":{const[p,y,x,S]=Kl(s.rgb,n.rgb,o);return new Yt(p,y,x,S,!1)}case"hcl":{const[p,y,x,S]=s.hcl,[I,P,L,B]=n.hcl;let N,q;if(isNaN(p)||isNaN(I))isNaN(p)?isNaN(I)?N=NaN:(N=I,x!==1&&x!==0||(q=P)):(N=p,L!==1&&L!==0||(q=y));else{let Ee=I-p;I>p&&Ee>180?Ee-=360:I<p&&p-I>180&&(Ee+=360),N=p+o*Ee}const[H,ee,ie,ce]=function([Ee,me,Ae,ze]){return Ee=isNaN(Ee)?0:Ee*Ce,Rt([Ae,Math.cos(Ee)*me,Math.sin(Ee)*me,ze])}([N,q??Ea(y,P,o),Ea(x,L,o),Ea(S,B,o)]);return new Yt(H,ee,ie,ce,!1)}case"lab":{const[p,y,x,S]=Rt(Kl(s.lab,n.lab,o));return new Yt(p,y,x,S,!1)}}},array:Kl,padding:function(s,n,o){return new Cr(Kl(s.values,n.values,o))},variableAnchorOffsetCollection:function(s,n,o){const h=s.values,p=n.values;if(h.length!==p.length)throw new pi(`Cannot interpolate values of different length. from: ${s.toString()}, to: ${n.toString()}`);const y=[];for(let x=0;x<h.length;x+=2){if(h[x]!==p[x])throw new pi(`Cannot interpolate values containing mismatched anchors. from[${x}]: ${h[x]}, to[${x}]: ${p[x]}`);y.push(h[x]);const[S,I]=h[x+1],[P,L]=p[x+1];y.push([Ea(S,P,o),Ea(I,L,o)])}return new Zi(y)}};class Ar{constructor(n,o,h,p,y){this.type=n,this.operator=o,this.interpolation=h,this.input=p,this.labels=[],this.outputs=[];for(const[x,S]of y)this.labels.push(x),this.outputs.push(S)}static interpolationFactor(n,o,h,p){let y=0;if(n.name==="exponential")y=ku(o,n.base,h,p);else if(n.name==="linear")y=ku(o,1,h,p);else if(n.name==="cubic-bezier"){const x=n.controlPoints;y=new j(x[0],x[1],x[2],x[3]).solve(ku(o,1,h,p))}return y}static parse(n,o){let[h,p,y,...x]=n;if(!Array.isArray(p)||p.length===0)return o.error("Expected an interpolation type expression.",1);if(p[0]==="linear")p={name:"linear"};else if(p[0]==="exponential"){const P=p[1];if(typeof P!="number")return o.error("Exponential interpolation requires a numeric base.",1,1);p={name:"exponential",base:P}}else{if(p[0]!=="cubic-bezier")return o.error(`Unknown interpolation type ${String(p[0])}`,1,0);{const P=p.slice(1);if(P.length!==4||P.some(L=>typeof L!="number"||L<0||L>1))return o.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);p={name:"cubic-bezier",controlPoints:P}}}if(n.length-1<4)return o.error(`Expected at least 4 arguments, but found only ${n.length-1}.`);if((n.length-1)%2!=0)return o.error("Expected an even number of arguments.");if(y=o.parse(y,2,st),!y)return null;const S=[];let I=null;h==="interpolate-hcl"||h==="interpolate-lab"?I=On:o.expectedType&&o.expectedType.kind!=="value"&&(I=o.expectedType);for(let P=0;P<x.length;P+=2){const L=x[P],B=x[P+1],N=P+3,q=P+4;if(typeof L!="number")return o.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',N);if(S.length&&S[S.length-1][0]>=L)return o.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',N);const H=o.parse(B,q,I);if(!H)return null;I=I||H.type,S.push([L,H])}return $(I,st)||$(I,On)||$(I,Ys)||$(I,Xs)||$(I,Ui(st))?new Ar(I,h,p,y,S):o.error(`Type ${Bn(I)} is not interpolatable.`)}evaluate(n){const o=this.labels,h=this.outputs;if(o.length===1)return h[0].evaluate(n);const p=this.input.evaluate(n);if(p<=o[0])return h[0].evaluate(n);const y=o.length;if(p>=o[y-1])return h[y-1].evaluate(n);const x=il(o,p),S=Ar.interpolationFactor(this.interpolation,p,o[x],o[x+1]),I=h[x].evaluate(n),P=h[x+1].evaluate(n);switch(this.operator){case"interpolate":return kr[this.type.kind](I,P,S);case"interpolate-hcl":return kr.color(I,P,S,"hcl");case"interpolate-lab":return kr.color(I,P,S,"lab")}}eachChild(n){n(this.input);for(const o of this.outputs)n(o)}outputDefined(){return this.outputs.every(n=>n.outputDefined())}}function ku(s,n,o,h){const p=h-o,y=s-o;return p===0?0:n===1?y/p:(Math.pow(n,y)-1)/(Math.pow(n,p)-1)}class Jl{constructor(n,o){this.type=n,this.args=o}static parse(n,o){if(n.length<2)return o.error("Expectected at least one argument.");let h=null;const p=o.expectedType;p&&p.kind!=="value"&&(h=p);const y=[];for(const S of n.slice(1)){const I=o.parse(S,1+y.length,h,void 0,{typeAnnotation:"omit"});if(!I)return null;h=h||I.type,y.push(I)}if(!h)throw new Error("No output type");const x=p&&y.some(S=>gs(p,S.type));return new Jl(x?It:h,y)}evaluate(n){let o,h=null,p=0;for(const y of this.args)if(p++,h=y.evaluate(n),h&&h instanceof Gr&&!h.available&&(o||(o=h.name),h=null,p===this.args.length&&(h=o)),h!==null)break;return h}eachChild(n){this.args.forEach(n)}outputDefined(){return this.args.every(n=>n.outputDefined())}}class ro{constructor(n,o){this.type=o.type,this.bindings=[].concat(n),this.result=o}evaluate(n){return this.result.evaluate(n)}eachChild(n){for(const o of this.bindings)n(o[1]);n(this.result)}static parse(n,o){if(n.length<4)return o.error(`Expected at least 3 arguments, but found ${n.length-1} instead.`);const h=[];for(let y=1;y<n.length-1;y+=2){const x=n[y];if(typeof x!="string")return o.error(`Expected string, but found ${typeof x} instead.`,y);if(/[^a-zA-Z0-9_]/.test(x))return o.error("Variable names must contain only alphanumeric characters or '_'.",y);const S=o.parse(n[y+1],y+1);if(!S)return null;h.push([x,S])}const p=o.parse(n[n.length-1],n.length-1,o.expectedType,h);return p?new ro(h,p):null}outputDefined(){return this.result.outputDefined()}}class so{constructor(n,o,h){this.type=n,this.index=o,this.input=h}static parse(n,o){if(n.length!==3)return o.error(`Expected 2 arguments, but found ${n.length-1} instead.`);const h=o.parse(n[1],1,st),p=o.parse(n[2],2,Ui(o.expectedType||It));return h&&p?new so(p.type.itemType,h,p):null}evaluate(n){const o=this.index.evaluate(n),h=this.input.evaluate(n);if(o<0)throw new pi(`Array index out of bounds: ${o} < 0.`);if(o>=h.length)throw new pi(`Array index out of bounds: ${o} > ${h.length-1}.`);if(o!==Math.floor(o))throw new pi(`Array index must be an integer, but found ${o} instead.`);return h[o]}eachChild(n){n(this.index),n(this.input)}outputDefined(){return!1}}class xn{constructor(n,o){this.type=Nt,this.needle=n,this.haystack=o}static parse(n,o){if(n.length!==3)return o.error(`Expected 2 arguments, but found ${n.length-1} instead.`);const h=o.parse(n[1],1,It),p=o.parse(n[2],2,It);return h&&p?ne(h.type,[Nt,Ft,st,fn,It])?new xn(h,p):o.error(`Expected first argument to be of type boolean, string, number or null, but found ${Bn(h.type)} instead`):null}evaluate(n){const o=this.needle.evaluate(n),h=this.haystack.evaluate(n);if(!h)return!1;if(!F(o,["boolean","string","number","null"]))throw new pi(`Expected first argument to be of type boolean, string, number or null, but found ${Bn(fi(o))} instead.`);if(!F(h,["string","array"]))throw new pi(`Expected second argument to be of type array or string, but found ${Bn(fi(h))} instead.`);return h.indexOf(o)>=0}eachChild(n){n(this.needle),n(this.haystack)}outputDefined(){return!0}}class Ql{constructor(n,o,h){this.type=st,this.needle=n,this.haystack=o,this.fromIndex=h}static parse(n,o){if(n.length<=2||n.length>=5)return o.error(`Expected 3 or 4 arguments, but found ${n.length-1} instead.`);const h=o.parse(n[1],1,It),p=o.parse(n[2],2,It);if(!h||!p)return null;if(!ne(h.type,[Nt,Ft,st,fn,It]))return o.error(`Expected first argument to be of type boolean, string, number or null, but found ${Bn(h.type)} instead`);if(n.length===4){const y=o.parse(n[3],3,st);return y?new Ql(h,p,y):null}return new Ql(h,p)}evaluate(n){const o=this.needle.evaluate(n),h=this.haystack.evaluate(n);if(!F(o,["boolean","string","number","null"]))throw new pi(`Expected first argument to be of type boolean, string, number or null, but found ${Bn(fi(o))} instead.`);if(!F(h,["string","array"]))throw new pi(`Expected second argument to be of type array or string, but found ${Bn(fi(h))} instead.`);if(this.fromIndex){const p=this.fromIndex.evaluate(n);return h.indexOf(o,p)}return h.indexOf(o)}eachChild(n){n(this.needle),n(this.haystack),this.fromIndex&&n(this.fromIndex)}outputDefined(){return!1}}class Au{constructor(n,o,h,p,y,x){this.inputType=n,this.type=o,this.input=h,this.cases=p,this.outputs=y,this.otherwise=x}static parse(n,o){if(n.length<5)return o.error(`Expected at least 4 arguments, but found only ${n.length-1}.`);if(n.length%2!=1)return o.error("Expected an even number of arguments.");let h,p;o.expectedType&&o.expectedType.kind!=="value"&&(p=o.expectedType);const y={},x=[];for(let P=2;P<n.length-1;P+=2){let L=n[P];const B=n[P+1];Array.isArray(L)||(L=[L]);const N=o.concat(P);if(L.length===0)return N.error("Expected at least one branch label.");for(const H of L){if(typeof H!="number"&&typeof H!="string")return N.error("Branch labels must be numbers or strings.");if(typeof H=="number"&&Math.abs(H)>Number.MAX_SAFE_INTEGER)return N.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof H=="number"&&Math.floor(H)!==H)return N.error("Numeric branch labels must be integer values.");if(h){if(N.checkSubtype(h,fi(H)))return null}else h=fi(H);if(y[String(H)]!==void 0)return N.error("Branch labels must be unique.");y[String(H)]=x.length}const q=o.parse(B,P,p);if(!q)return null;p=p||q.type,x.push(q)}const S=o.parse(n[1],1,It);if(!S)return null;const I=o.parse(n[n.length-1],n.length-1,p);return I?S.type.kind!=="value"&&o.concat(1).checkSubtype(h,S.type)?null:new Au(h,p,S,y,x,I):null}evaluate(n){const o=this.input.evaluate(n);return(fi(o)===this.inputType&&this.outputs[this.cases[o]]||this.otherwise).evaluate(n)}eachChild(n){n(this.input),this.outputs.forEach(n),n(this.otherwise)}outputDefined(){return this.outputs.every(n=>n.outputDefined())&&this.otherwise.outputDefined()}}class Pu{constructor(n,o,h){this.type=n,this.branches=o,this.otherwise=h}static parse(n,o){if(n.length<4)return o.error(`Expected at least 3 arguments, but found only ${n.length-1}.`);if(n.length%2!=0)return o.error("Expected an odd number of arguments.");let h;o.expectedType&&o.expectedType.kind!=="value"&&(h=o.expectedType);const p=[];for(let x=1;x<n.length-1;x+=2){const S=o.parse(n[x],x,Nt);if(!S)return null;const I=o.parse(n[x+1],x+1,h);if(!I)return null;p.push([S,I]),h=h||I.type}const y=o.parse(n[n.length-1],n.length-1,h);if(!y)return null;if(!h)throw new Error("Can't infer output type");return new Pu(h,p,y)}evaluate(n){for(const[o,h]of this.branches)if(o.evaluate(n))return h.evaluate(n);return this.otherwise.evaluate(n)}eachChild(n){for(const[o,h]of this.branches)n(o),n(h);n(this.otherwise)}outputDefined(){return this.branches.every(([n,o])=>o.outputDefined())&&this.otherwise.outputDefined()}}class ec{constructor(n,o,h,p){this.type=n,this.input=o,this.beginIndex=h,this.endIndex=p}static parse(n,o){if(n.length<=2||n.length>=5)return o.error(`Expected 3 or 4 arguments, but found ${n.length-1} instead.`);const h=o.parse(n[1],1,It),p=o.parse(n[2],2,st);if(!h||!p)return null;if(!ne(h.type,[Ui(It),Ft,It]))return o.error(`Expected first argument to be of type array or string, but found ${Bn(h.type)} instead`);if(n.length===4){const y=o.parse(n[3],3,st);return y?new ec(h.type,h,p,y):null}return new ec(h.type,h,p)}evaluate(n){const o=this.input.evaluate(n),h=this.beginIndex.evaluate(n);if(!F(o,["string","array"]))throw new pi(`Expected first argument to be of type array or string, but found ${Bn(fi(o))} instead.`);if(this.endIndex){const p=this.endIndex.evaluate(n);return o.slice(h,p)}return o.slice(h)}eachChild(n){n(this.input),n(this.beginIndex),this.endIndex&&n(this.endIndex)}outputDefined(){return!1}}function Vd(s,n){return s==="=="||s==="!="?n.kind==="boolean"||n.kind==="string"||n.kind==="number"||n.kind==="null"||n.kind==="value":n.kind==="string"||n.kind==="number"||n.kind==="value"}function jd(s,n,o,h){return h.compare(n,o)===0}function ao(s,n,o){const h=s!=="=="&&s!=="!=";return class kE{constructor(y,x,S){this.type=Nt,this.lhs=y,this.rhs=x,this.collator=S,this.hasUntypedArgument=y.type.kind==="value"||x.type.kind==="value"}static parse(y,x){if(y.length!==3&&y.length!==4)return x.error("Expected two or three arguments.");const S=y[0];let I=x.parse(y[1],1,It);if(!I)return null;if(!Vd(S,I.type))return x.concat(1).error(`"${S}" comparisons are not supported for type '${Bn(I.type)}'.`);let P=x.parse(y[2],2,It);if(!P)return null;if(!Vd(S,P.type))return x.concat(2).error(`"${S}" comparisons are not supported for type '${Bn(P.type)}'.`);if(I.type.kind!==P.type.kind&&I.type.kind!=="value"&&P.type.kind!=="value")return x.error(`Cannot compare types '${Bn(I.type)}' and '${Bn(P.type)}'.`);h&&(I.type.kind==="value"&&P.type.kind!=="value"?I=new Wi(P.type,[I]):I.type.kind!=="value"&&P.type.kind==="value"&&(P=new Wi(I.type,[P])));let L=null;if(y.length===4){if(I.type.kind!=="string"&&P.type.kind!=="string"&&I.type.kind!=="value"&&P.type.kind!=="value")return x.error("Cannot use collator to compare non-string types.");if(L=x.parse(y[3],3,Hn),!L)return null}return new kE(I,P,L)}evaluate(y){const x=this.lhs.evaluate(y),S=this.rhs.evaluate(y);if(h&&this.hasUntypedArgument){const I=fi(x),P=fi(S);if(I.kind!==P.kind||I.kind!=="string"&&I.kind!=="number")throw new pi(`Expected arguments for "${s}" to be (string, string) or (number, number), but found (${I.kind}, ${P.kind}) instead.`)}if(this.collator&&!h&&this.hasUntypedArgument){const I=fi(x),P=fi(S);if(I.kind!=="string"||P.kind!=="string")return n(y,x,S)}return this.collator?o(y,x,S,this.collator.evaluate(y)):n(y,x,S)}eachChild(y){y(this.lhs),y(this.rhs),this.collator&&y(this.collator)}outputDefined(){return!0}}}const qm=ao("==",function(s,n,o){return n===o},jd),Hm=ao("!=",function(s,n,o){return n!==o},function(s,n,o,h){return!jd(0,n,o,h)}),Zm=ao("<",function(s,n,o){return n<o},function(s,n,o,h){return h.compare(n,o)<0}),Wm=ao(">",function(s,n,o){return n>o},function(s,n,o,h){return h.compare(n,o)>0}),Ym=ao("<=",function(s,n,o){return n<=o},function(s,n,o,h){return h.compare(n,o)<=0}),Xm=ao(">=",function(s,n,o){return n>=o},function(s,n,o,h){return h.compare(n,o)>=0});class Ru{constructor(n,o,h,p,y){this.type=Ft,this.number=n,this.locale=o,this.currency=h,this.minFractionDigits=p,this.maxFractionDigits=y}static parse(n,o){if(n.length!==3)return o.error("Expected two arguments.");const h=o.parse(n[1],1,st);if(!h)return null;const p=n[2];if(typeof p!="object"||Array.isArray(p))return o.error("NumberFormat options argument must be an object.");let y=null;if(p.locale&&(y=o.parse(p.locale,1,Ft),!y))return null;let x=null;if(p.currency&&(x=o.parse(p.currency,1,Ft),!x))return null;let S=null;if(p["min-fraction-digits"]&&(S=o.parse(p["min-fraction-digits"],1,st),!S))return null;let I=null;return p["max-fraction-digits"]&&(I=o.parse(p["max-fraction-digits"],1,st),!I)?null:new Ru(h,y,x,S,I)}evaluate(n){return new Intl.NumberFormat(this.locale?this.locale.evaluate(n):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(n):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(n):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(n):void 0}).format(this.number.evaluate(n))}eachChild(n){n(this.number),this.locale&&n(this.locale),this.currency&&n(this.currency),this.minFractionDigits&&n(this.minFractionDigits),this.maxFractionDigits&&n(this.maxFractionDigits)}outputDefined(){return!1}}class tc{constructor(n){this.type=Tr,this.sections=n}static parse(n,o){if(n.length<2)return o.error("Expected at least one argument.");const h=n[1];if(!Array.isArray(h)&&typeof h=="object")return o.error("First argument must be an image or text section.");const p=[];let y=!1;for(let x=1;x<=n.length-1;++x){const S=n[x];if(y&&typeof S=="object"&&!Array.isArray(S)){y=!1;let I=null;if(S["font-scale"]&&(I=o.parse(S["font-scale"],1,st),!I))return null;let P=null;if(S["text-font"]&&(P=o.parse(S["text-font"],1,Ui(Ft)),!P))return null;let L=null;if(S["text-color"]&&(L=o.parse(S["text-color"],1,On),!L))return null;const B=p[p.length-1];B.scale=I,B.font=P,B.textColor=L}else{const I=o.parse(n[x],1,It);if(!I)return null;const P=I.type.kind;if(P!=="string"&&P!=="value"&&P!=="null"&&P!=="resolvedImage")return o.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");y=!0,p.push({content:I,scale:null,font:null,textColor:null})}}return new tc(p)}evaluate(n){return new di(this.sections.map(o=>{const h=o.content.evaluate(n);return fi(h)===jr?new $i("",h,null,null,null):new $i(Ks(h),null,o.scale?o.scale.evaluate(n):null,o.font?o.font.evaluate(n).join(","):null,o.textColor?o.textColor.evaluate(n):null)}))}eachChild(n){for(const o of this.sections)n(o.content),o.scale&&n(o.scale),o.font&&n(o.font),o.textColor&&n(o.textColor)}outputDefined(){return!1}}class Mu{constructor(n){this.type=jr,this.input=n}static parse(n,o){if(n.length!==2)return o.error("Expected two arguments.");const h=o.parse(n[1],1,Ft);return h?new Mu(h):o.error("No image name provided.")}evaluate(n){const o=this.input.evaluate(n),h=Gr.fromString(o);return h&&n.availableImages&&(h.available=n.availableImages.indexOf(o)>-1),h}eachChild(n){n(this.input)}outputDefined(){return!1}}class Du{constructor(n){this.type=st,this.input=n}static parse(n,o){if(n.length!==2)return o.error(`Expected 1 argument, but found ${n.length-1} instead.`);const h=o.parse(n[1],1);return h?h.type.kind!=="array"&&h.type.kind!=="string"&&h.type.kind!=="value"?o.error(`Expected argument of type string or array, but found ${Bn(h.type)} instead.`):new Du(h):null}evaluate(n){const o=this.input.evaluate(n);if(typeof o=="string"||Array.isArray(o))return o.length;throw new pi(`Expected value to be of type string or array, but found ${Bn(fi(o))} instead.`)}eachChild(n){n(this.input)}outputDefined(){return!1}}const oo={"==":qm,"!=":Hm,">":Wm,"<":Zm,">=":Xm,"<=":Ym,array:Wi,at:so,boolean:Wi,case:Pu,coalesce:Jl,collator:io,format:tc,image:Mu,in:xn,"index-of":Ql,interpolate:Ar,"interpolate-hcl":Ar,"interpolate-lab":Ar,length:Du,let:ro,literal:wa,match:Au,number:Wi,"number-format":Ru,object:Wi,slice:ec,step:rl,string:Wi,"to-boolean":_s,"to-color":_s,"to-number":_s,"to-string":_s,var:Yl,within:Sa};function Gd(s,[n,o,h,p]){n=n.evaluate(s),o=o.evaluate(s),h=h.evaluate(s);const y=p?p.evaluate(s):1,x=Ld(n,o,h,y);if(x)throw new pi(x);return new Yt(n/255,o/255,h/255,y,!1)}function qd(s,n){return s in n}function Lu(s,n){const o=n[s];return o===void 0?null:o}function Ta(s){return{type:s}}function Hd(s){return{result:"success",value:s}}function lo(s){return{result:"error",value:s}}function co(s){return s["property-type"]==="data-driven"||s["property-type"]==="cross-faded-data-driven"}function Zd(s){return!!s.expression&&s.expression.parameters.indexOf("zoom")>-1}function zu(s){return!!s.expression&&s.expression.interpolated}function Cn(s){return s instanceof Number?"number":s instanceof String?"string":s instanceof Boolean?"boolean":Array.isArray(s)?"array":s===null?"null":typeof s}function nc(s){return typeof s=="object"&&s!==null&&!Array.isArray(s)}function Km(s){return s}function Wd(s,n){const o=n.type==="color",h=s.stops&&typeof s.stops[0][0]=="object",p=h||!(h||s.property!==void 0),y=s.type||(zu(n)?"exponential":"interval");if(o||n.type==="padding"){const L=o?Yt.parse:Cr.parse;(s=jt({},s)).stops&&(s.stops=s.stops.map(B=>[B[0],L(B[1])])),s.default=L(s.default?s.default:n.default)}if(s.colorSpace&&(x=s.colorSpace)!=="rgb"&&x!=="hcl"&&x!=="lab")throw new Error(`Unknown color space: "${s.colorSpace}"`);var x;let S,I,P;if(y==="exponential")S=Yd;else if(y==="interval")S=Qm;else if(y==="categorical"){S=Jm,I=Object.create(null);for(const L of s.stops)I[L[0]]=L[1];P=typeof s.stops[0][0]}else{if(y!=="identity")throw new Error(`Unknown function type "${y}"`);S=eg}if(h){const L={},B=[];for(let H=0;H<s.stops.length;H++){const ee=s.stops[H],ie=ee[0].zoom;L[ie]===void 0&&(L[ie]={zoom:ie,type:s.type,property:s.property,default:s.default,stops:[]},B.push(ie)),L[ie].stops.push([ee[0].value,ee[1]])}const N=[];for(const H of B)N.push([L[H].zoom,Wd(L[H],n)]);const q={name:"linear"};return{kind:"composite",interpolationType:q,interpolationFactor:Ar.interpolationFactor.bind(void 0,q),zoomStops:N.map(H=>H[0]),evaluate:({zoom:H},ee)=>Yd({stops:N,base:s.base},n,H).evaluate(H,ee)}}if(p){const L=y==="exponential"?{name:"exponential",base:s.base!==void 0?s.base:1}:null;return{kind:"camera",interpolationType:L,interpolationFactor:Ar.interpolationFactor.bind(void 0,L),zoomStops:s.stops.map(B=>B[0]),evaluate:({zoom:B})=>S(s,n,B,I,P)}}return{kind:"source",evaluate(L,B){const N=B&&B.properties?B.properties[s.property]:void 0;return N===void 0?Ca(s.default,n.default):S(s,n,N,I,P)}}}function Ca(s,n,o){return s!==void 0?s:n!==void 0?n:o!==void 0?o:void 0}function Jm(s,n,o,h,p){return Ca(typeof o===p?h[o]:void 0,s.default,n.default)}function Qm(s,n,o){if(Cn(o)!=="number")return Ca(s.default,n.default);const h=s.stops.length;if(h===1||o<=s.stops[0][0])return s.stops[0][1];if(o>=s.stops[h-1][0])return s.stops[h-1][1];const p=il(s.stops.map(y=>y[0]),o);return s.stops[p][1]}function Yd(s,n,o){const h=s.base!==void 0?s.base:1;if(Cn(o)!=="number")return Ca(s.default,n.default);const p=s.stops.length;if(p===1||o<=s.stops[0][0])return s.stops[0][1];if(o>=s.stops[p-1][0])return s.stops[p-1][1];const y=il(s.stops.map(L=>L[0]),o),x=function(L,B,N,q){const H=q-N,ee=L-N;return H===0?0:B===1?ee/H:(Math.pow(B,ee)-1)/(Math.pow(B,H)-1)}(o,h,s.stops[y][0],s.stops[y+1][0]),S=s.stops[y][1],I=s.stops[y+1][1],P=kr[n.type]||Km;return typeof S.evaluate=="function"?{evaluate(...L){const B=S.evaluate.apply(void 0,L),N=I.evaluate.apply(void 0,L);if(B!==void 0&&N!==void 0)return P(B,N,x,s.colorSpace)}}:P(S,I,x,s.colorSpace)}function eg(s,n,o){switch(n.type){case"color":o=Yt.parse(o);break;case"formatted":o=di.fromString(o.toString());break;case"resolvedImage":o=Gr.fromString(o.toString());break;case"padding":o=Cr.parse(o);break;default:Cn(o)===n.type||n.type==="enum"&&n.values[o]||(o=void 0)}return Ca(o,s.default,n.default)}Ir.register(oo,{error:[{kind:"error"},[Ft],(s,[n])=>{throw new pi(n.evaluate(s))}],typeof:[Ft,[It],(s,[n])=>Bn(fi(n.evaluate(s)))],"to-rgba":[Ui(st,4),[On],(s,[n])=>{const[o,h,p,y]=n.evaluate(s).rgb;return[255*o,255*h,255*p,y]}],rgb:[On,[st,st,st],Gd],rgba:[On,[st,st,st,st],Gd],has:{type:Nt,overloads:[[[Ft],(s,[n])=>qd(n.evaluate(s),s.properties())],[[Ft,qn],(s,[n,o])=>qd(n.evaluate(s),o.evaluate(s))]]},get:{type:It,overloads:[[[Ft],(s,[n])=>Lu(n.evaluate(s),s.properties())],[[Ft,qn],(s,[n,o])=>Lu(n.evaluate(s),o.evaluate(s))]]},"feature-state":[It,[Ft],(s,[n])=>Lu(n.evaluate(s),s.featureState||{})],properties:[qn,[],s=>s.properties()],"geometry-type":[Ft,[],s=>s.geometryType()],id:[It,[],s=>s.id()],zoom:[st,[],s=>s.globals.zoom],"heatmap-density":[st,[],s=>s.globals.heatmapDensity||0],"line-progress":[st,[],s=>s.globals.lineProgress||0],accumulated:[It,[],s=>s.globals.accumulated===void 0?null:s.globals.accumulated],"+":[st,Ta(st),(s,n)=>{let o=0;for(const h of n)o+=h.evaluate(s);return o}],"*":[st,Ta(st),(s,n)=>{let o=1;for(const h of n)o*=h.evaluate(s);return o}],"-":{type:st,overloads:[[[st,st],(s,[n,o])=>n.evaluate(s)-o.evaluate(s)],[[st],(s,[n])=>-n.evaluate(s)]]},"/":[st,[st,st],(s,[n,o])=>n.evaluate(s)/o.evaluate(s)],"%":[st,[st,st],(s,[n,o])=>n.evaluate(s)%o.evaluate(s)],ln2:[st,[],()=>Math.LN2],pi:[st,[],()=>Math.PI],e:[st,[],()=>Math.E],"^":[st,[st,st],(s,[n,o])=>Math.pow(n.evaluate(s),o.evaluate(s))],sqrt:[st,[st],(s,[n])=>Math.sqrt(n.evaluate(s))],log10:[st,[st],(s,[n])=>Math.log(n.evaluate(s))/Math.LN10],ln:[st,[st],(s,[n])=>Math.log(n.evaluate(s))],log2:[st,[st],(s,[n])=>Math.log(n.evaluate(s))/Math.LN2],sin:[st,[st],(s,[n])=>Math.sin(n.evaluate(s))],cos:[st,[st],(s,[n])=>Math.cos(n.evaluate(s))],tan:[st,[st],(s,[n])=>Math.tan(n.evaluate(s))],asin:[st,[st],(s,[n])=>Math.asin(n.evaluate(s))],acos:[st,[st],(s,[n])=>Math.acos(n.evaluate(s))],atan:[st,[st],(s,[n])=>Math.atan(n.evaluate(s))],min:[st,Ta(st),(s,n)=>Math.min(...n.map(o=>o.evaluate(s)))],max:[st,Ta(st),(s,n)=>Math.max(...n.map(o=>o.evaluate(s)))],abs:[st,[st],(s,[n])=>Math.abs(n.evaluate(s))],round:[st,[st],(s,[n])=>{const o=n.evaluate(s);return o<0?-Math.round(-o):Math.round(o)}],floor:[st,[st],(s,[n])=>Math.floor(n.evaluate(s))],ceil:[st,[st],(s,[n])=>Math.ceil(n.evaluate(s))],"filter-==":[Nt,[Ft,It],(s,[n,o])=>s.properties()[n.value]===o.value],"filter-id-==":[Nt,[It],(s,[n])=>s.id()===n.value],"filter-type-==":[Nt,[Ft],(s,[n])=>s.geometryType()===n.value],"filter-<":[Nt,[Ft,It],(s,[n,o])=>{const h=s.properties()[n.value],p=o.value;return typeof h==typeof p&&h<p}],"filter-id-<":[Nt,[It],(s,[n])=>{const o=s.id(),h=n.value;return typeof o==typeof h&&o<h}],"filter->":[Nt,[Ft,It],(s,[n,o])=>{const h=s.properties()[n.value],p=o.value;return typeof h==typeof p&&h>p}],"filter-id->":[Nt,[It],(s,[n])=>{const o=s.id(),h=n.value;return typeof o==typeof h&&o>h}],"filter-<=":[Nt,[Ft,It],(s,[n,o])=>{const h=s.properties()[n.value],p=o.value;return typeof h==typeof p&&h<=p}],"filter-id-<=":[Nt,[It],(s,[n])=>{const o=s.id(),h=n.value;return typeof o==typeof h&&o<=h}],"filter->=":[Nt,[Ft,It],(s,[n,o])=>{const h=s.properties()[n.value],p=o.value;return typeof h==typeof p&&h>=p}],"filter-id->=":[Nt,[It],(s,[n])=>{const o=s.id(),h=n.value;return typeof o==typeof h&&o>=h}],"filter-has":[Nt,[It],(s,[n])=>n.value in s.properties()],"filter-has-id":[Nt,[],s=>s.id()!==null&&s.id()!==void 0],"filter-type-in":[Nt,[Ui(Ft)],(s,[n])=>n.value.indexOf(s.geometryType())>=0],"filter-id-in":[Nt,[Ui(It)],(s,[n])=>n.value.indexOf(s.id())>=0],"filter-in-small":[Nt,[Ft,Ui(It)],(s,[n,o])=>o.value.indexOf(s.properties()[n.value])>=0],"filter-in-large":[Nt,[Ft,Ui(It)],(s,[n,o])=>function(h,p,y,x){for(;y<=x;){const S=y+x>>1;if(p[S]===h)return!0;p[S]>h?x=S-1:y=S+1}return!1}(s.properties()[n.value],o.value,0,o.value.length-1)],all:{type:Nt,overloads:[[[Nt,Nt],(s,[n,o])=>n.evaluate(s)&&o.evaluate(s)],[Ta(Nt),(s,n)=>{for(const o of n)if(!o.evaluate(s))return!1;return!0}]]},any:{type:Nt,overloads:[[[Nt,Nt],(s,[n,o])=>n.evaluate(s)||o.evaluate(s)],[Ta(Nt),(s,n)=>{for(const o of n)if(o.evaluate(s))return!0;return!1}]]},"!":[Nt,[Nt],(s,[n])=>!n.evaluate(s)],"is-supported-script":[Nt,[Ft],(s,[n])=>{const o=s.globals&&s.globals.isSupportedScript;return!o||o(n.evaluate(s))}],upcase:[Ft,[Ft],(s,[n])=>n.evaluate(s).toUpperCase()],downcase:[Ft,[Ft],(s,[n])=>n.evaluate(s).toLowerCase()],concat:[Ft,Ta(It),(s,n)=>n.map(o=>Ks(o.evaluate(s))).join("")],"resolved-locale":[Ft,[Hn],(s,[n])=>n.evaluate(s).resolvedLocale()]});class ni{constructor(n,o){var h;this.expression=n,this._warningHistory={},this._evaluator=new Pn,this._defaultValue=o?(h=o).type==="color"&&nc(h.default)?new Yt(0,0,0,0):h.type==="color"?Yt.parse(h.default)||null:h.type==="padding"?Cr.parse(h.default)||null:h.type==="variableAnchorOffsetCollection"?Zi.parse(h.default)||null:h.default===void 0?null:h.default:null,this._enumValues=o&&o.type==="enum"?o.values:null}evaluateWithoutErrorHandling(n,o,h,p,y,x){return this._evaluator.globals=n,this._evaluator.feature=o,this._evaluator.featureState=h,this._evaluator.canonical=p,this._evaluator.availableImages=y||null,this._evaluator.formattedSection=x,this.expression.evaluate(this._evaluator)}evaluate(n,o,h,p,y,x){this._evaluator.globals=n,this._evaluator.feature=o||null,this._evaluator.featureState=h||null,this._evaluator.canonical=p,this._evaluator.availableImages=y||null,this._evaluator.formattedSection=x||null;try{const S=this.expression.evaluate(this._evaluator);if(S==null||typeof S=="number"&&S!=S)return this._defaultValue;if(this._enumValues&&!(S in this._enumValues))throw new pi(`Expected value to be one of ${Object.keys(this._enumValues).map(I=>JSON.stringify(I)).join(", ")}, but found ${JSON.stringify(S)} instead.`);return S}catch(S){return this._warningHistory[S.message]||(this._warningHistory[S.message]=!0,typeof console<"u"&&console.warn(S.message)),this._defaultValue}}}function ic(s){return Array.isArray(s)&&s.length>0&&typeof s[0]=="string"&&s[0]in oo}function ln(s,n){const o=new Gl(oo,el,[],n?function(p){const y={color:On,string:Ft,number:st,enum:Ft,boolean:Nt,formatted:Tr,padding:Ys,resolvedImage:jr,variableAnchorOffsetCollection:Xs};return p.type==="array"?Ui(y[p.value]||It,p.length):y[p.type]}(n):void 0),h=o.parse(s,void 0,void 0,void 0,n&&n.type==="string"?{typeAnnotation:"coerce"}:void 0);return h?Hd(new ni(h,n)):lo(o.errors)}class sl{constructor(n,o){this.kind=n,this._styleExpression=o,this.isStateDependent=n!=="constant"&&!tl(o.expression)}evaluateWithoutErrorHandling(n,o,h,p,y,x){return this._styleExpression.evaluateWithoutErrorHandling(n,o,h,p,y,x)}evaluate(n,o,h,p,y,x){return this._styleExpression.evaluate(n,o,h,p,y,x)}}class $n{constructor(n,o,h,p){this.kind=n,this.zoomStops=h,this._styleExpression=o,this.isStateDependent=n!=="camera"&&!tl(o.expression),this.interpolationType=p}evaluateWithoutErrorHandling(n,o,h,p,y,x){return this._styleExpression.evaluateWithoutErrorHandling(n,o,h,p,y,x)}evaluate(n,o,h,p,y,x){return this._styleExpression.evaluate(n,o,h,p,y,x)}interpolationFactor(n,o,h){return this.interpolationType?Ar.interpolationFactor(this.interpolationType,n,o,h):0}}function Vn(s,n){const o=ln(s,n);if(o.result==="error")return o;const h=o.value.expression,p=Xl(h);if(!p&&!co(n))return lo([new Xt("","data expressions not supported")]);const y=nl(h,["zoom"]);if(!y&&!Zd(n))return lo([new Xt("","zoom expressions not supported")]);const x=al(h);return x||y?x instanceof Xt?lo([x]):x instanceof Ar&&!zu(n)?lo([new Xt("",'"interpolate" expressions cannot be used with this property')]):Hd(x?new $n(p?"camera":"composite",o.value,x.labels,x instanceof Ar?x.interpolation:void 0):new sl(p?"constant":"source",o.value)):lo([new Xt("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class Ia{constructor(n,o){this._parameters=n,this._specification=o,jt(this,Wd(this._parameters,this._specification))}static deserialize(n){return new Ia(n._parameters,n._specification)}static serialize(n){return{_parameters:n._parameters,_specification:n._specification}}}function al(s){let n=null;if(s instanceof ro)n=al(s.result);else if(s instanceof Jl){for(const o of s.args)if(n=al(o),n)break}else(s instanceof rl||s instanceof Ar)&&s.input instanceof Ir&&s.input.name==="zoom"&&(n=s);return n instanceof Xt||s.eachChild(o=>{const h=al(o);h instanceof Xt?n=h:!n&&h?n=new Xt("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):n&&h&&n!==h&&(n=new Xt("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),n}function Ou(s){if(s===!0||s===!1)return!0;if(!Array.isArray(s)||s.length===0)return!1;switch(s[0]){case"has":return s.length>=2&&s[1]!=="$id"&&s[1]!=="$type";case"in":return s.length>=3&&(typeof s[1]!="string"||Array.isArray(s[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return s.length!==3||Array.isArray(s[1])||Array.isArray(s[2]);case"any":case"all":for(const n of s.slice(1))if(!Ou(n)&&typeof n!="boolean")return!1;return!0;default:return!0}}const tg={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function Bu(s){if(s==null)return{filter:()=>!0,needGeometry:!1};Ou(s)||(s=ol(s));const n=ln(s,tg);if(n.result==="error")throw new Error(n.value.map(o=>`${o.key}: ${o.message}`).join(", "));return{filter:(o,h,p)=>n.value.evaluate(o,h,{},p),needGeometry:Fu(s)}}function ng(s,n){return s<n?-1:s>n?1:0}function Fu(s){if(!Array.isArray(s))return!1;if(s[0]==="within")return!0;for(let n=1;n<s.length;n++)if(Fu(s[n]))return!0;return!1}function ol(s){if(!s)return!0;const n=s[0];return s.length<=1?n!=="any":n==="=="?rc(s[1],s[2],"=="):n==="!="?ac(rc(s[1],s[2],"==")):n==="<"||n===">"||n==="<="||n===">="?rc(s[1],s[2],n):n==="any"?(o=s.slice(1),["any"].concat(o.map(ol))):n==="all"?["all"].concat(s.slice(1).map(ol)):n==="none"?["all"].concat(s.slice(1).map(ol).map(ac)):n==="in"?Nu(s[1],s.slice(2)):n==="!in"?ac(Nu(s[1],s.slice(2))):n==="has"?sc(s[1]):n==="!has"?ac(sc(s[1])):n!=="within"||s;var o}function rc(s,n,o){switch(s){case"$type":return[`filter-type-${o}`,n];case"$id":return[`filter-id-${o}`,n];default:return[`filter-${o}`,s,n]}}function Nu(s,n){if(n.length===0)return!1;switch(s){case"$type":return["filter-type-in",["literal",n]];case"$id":return["filter-id-in",["literal",n]];default:return n.length>200&&!n.some(o=>typeof o!=typeof n[0])?["filter-in-large",s,["literal",n.sort(ng)]]:["filter-in-small",s,["literal",n]]}}function sc(s){switch(s){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",s]}}function ac(s){return["!",s]}function Uu(s){const n=typeof s;if(n==="number"||n==="boolean"||n==="string"||s==null)return JSON.stringify(s);if(Array.isArray(s)){let p="[";for(const y of s)p+=`${Uu(y)},`;return`${p}]`}const o=Object.keys(s).sort();let h="{";for(let p=0;p<o.length;p++)h+=`${JSON.stringify(o[p])}:${Uu(s[o[p]])},`;return`${h}}`}function ig(s){let n="";for(const o of ye)n+=`/${Uu(s[o])}`;return n}function Xd(s){const n=s.value;return n?[new Be(s.key,n,"constants have been deprecated as of v8")]:[]}function mi(s){return s instanceof Number||s instanceof String||s instanceof Boolean?s.valueOf():s}function ka(s){if(Array.isArray(s))return s.map(ka);if(s instanceof Object&&!(s instanceof Number||s instanceof String||s instanceof Boolean)){const n={};for(const o in s)n[o]=ka(s[o]);return n}return mi(s)}function qr(s){const n=s.key,o=s.value,h=s.valueSpec||{},p=s.objectElementValidators||{},y=s.style,x=s.styleSpec,S=s.validateSpec;let I=[];const P=Cn(o);if(P!=="object")return[new Be(n,o,`object expected, ${P} found`)];for(const L in o){const B=L.split(".")[0],N=h[B]||h["*"];let q;if(p[B])q=p[B];else if(h[B])q=S;else if(p["*"])q=p["*"];else{if(!h["*"]){I.push(new Be(n,o[L],`unknown property "${L}"`));continue}q=S}I=I.concat(q({key:(n&&`${n}.`)+L,value:o[L],valueSpec:N,style:y,styleSpec:x,object:o,objectKey:L,validateSpec:S},o))}for(const L in h)p[L]||h[L].required&&h[L].default===void 0&&o[L]===void 0&&I.push(new Be(n,o,`missing required property "${L}"`));return I}function $u(s){const n=s.value,o=s.valueSpec,h=s.style,p=s.styleSpec,y=s.key,x=s.arrayElementValidator||s.validateSpec;if(Cn(n)!=="array")return[new Be(y,n,`array expected, ${Cn(n)} found`)];if(o.length&&n.length!==o.length)return[new Be(y,n,`array length ${o.length} expected, length ${n.length} found`)];if(o["min-length"]&&n.length<o["min-length"])return[new Be(y,n,`array length at least ${o["min-length"]} expected, length ${n.length} found`)];let S={type:o.value,values:o.values};p.$version<7&&(S.function=o.function),Cn(o.value)==="object"&&(S=o.value);let I=[];for(let P=0;P<n.length;P++)I=I.concat(x({array:n,arrayIndex:P,value:n[P],valueSpec:S,validateSpec:s.validateSpec,style:h,styleSpec:p,key:`${y}[${P}]`}));return I}function oc(s){const n=s.key,o=s.value,h=s.valueSpec;let p=Cn(o);return p==="number"&&o!=o&&(p="NaN"),p!=="number"?[new Be(n,o,`number expected, ${p} found`)]:"minimum"in h&&o<h.minimum?[new Be(n,o,`${o} is less than the minimum value ${h.minimum}`)]:"maximum"in h&&o>h.maximum?[new Be(n,o,`${o} is greater than the maximum value ${h.maximum}`)]:[]}function Vu(s){const n=s.valueSpec,o=mi(s.value.type);let h,p,y,x={};const S=o!=="categorical"&&s.value.property===void 0,I=!S,P=Cn(s.value.stops)==="array"&&Cn(s.value.stops[0])==="array"&&Cn(s.value.stops[0][0])==="object",L=qr({key:s.key,value:s.value,valueSpec:s.styleSpec.function,validateSpec:s.validateSpec,style:s.style,styleSpec:s.styleSpec,objectElementValidators:{stops:function(q){if(o==="identity")return[new Be(q.key,q.value,'identity function may not have a "stops" property')];let H=[];const ee=q.value;return H=H.concat($u({key:q.key,value:ee,valueSpec:q.valueSpec,validateSpec:q.validateSpec,style:q.style,styleSpec:q.styleSpec,arrayElementValidator:B})),Cn(ee)==="array"&&ee.length===0&&H.push(new Be(q.key,ee,"array must have at least one stop")),H},default:function(q){return q.validateSpec({key:q.key,value:q.value,valueSpec:n,validateSpec:q.validateSpec,style:q.style,styleSpec:q.styleSpec})}}});return o==="identity"&&S&&L.push(new Be(s.key,s.value,'missing required property "property"')),o==="identity"||s.value.stops||L.push(new Be(s.key,s.value,'missing required property "stops"')),o==="exponential"&&s.valueSpec.expression&&!zu(s.valueSpec)&&L.push(new Be(s.key,s.value,"exponential functions not supported")),s.styleSpec.$version>=8&&(I&&!co(s.valueSpec)?L.push(new Be(s.key,s.value,"property functions not supported")):S&&!Zd(s.valueSpec)&&L.push(new Be(s.key,s.value,"zoom functions not supported"))),o!=="categorical"&&!P||s.value.property!==void 0||L.push(new Be(s.key,s.value,'"property" property is required')),L;function B(q){let H=[];const ee=q.value,ie=q.key;if(Cn(ee)!=="array")return[new Be(ie,ee,`array expected, ${Cn(ee)} found`)];if(ee.length!==2)return[new Be(ie,ee,`array length 2 expected, length ${ee.length} found`)];if(P){if(Cn(ee[0])!=="object")return[new Be(ie,ee,`object expected, ${Cn(ee[0])} found`)];if(ee[0].zoom===void 0)return[new Be(ie,ee,"object stop key must have zoom")];if(ee[0].value===void 0)return[new Be(ie,ee,"object stop key must have value")];if(y&&y>mi(ee[0].zoom))return[new Be(ie,ee[0].zoom,"stop zoom values must appear in ascending order")];mi(ee[0].zoom)!==y&&(y=mi(ee[0].zoom),p=void 0,x={}),H=H.concat(qr({key:`${ie}[0]`,value:ee[0],valueSpec:{zoom:{}},validateSpec:q.validateSpec,style:q.style,styleSpec:q.styleSpec,objectElementValidators:{zoom:oc,value:N}}))}else H=H.concat(N({key:`${ie}[0]`,value:ee[0],valueSpec:{},validateSpec:q.validateSpec,style:q.style,styleSpec:q.styleSpec},ee));return ic(ka(ee[1]))?H.concat([new Be(`${ie}[1]`,ee[1],"expressions are not allowed in function stops.")]):H.concat(q.validateSpec({key:`${ie}[1]`,value:ee[1],valueSpec:n,validateSpec:q.validateSpec,style:q.style,styleSpec:q.styleSpec}))}function N(q,H){const ee=Cn(q.value),ie=mi(q.value),ce=q.value!==null?q.value:H;if(h){if(ee!==h)return[new Be(q.key,ce,`${ee} stop domain type must match previous stop domain type ${h}`)]}else h=ee;if(ee!=="number"&&ee!=="string"&&ee!=="boolean")return[new Be(q.key,ce,"stop domain value must be a number, string, or boolean")];if(ee!=="number"&&o!=="categorical"){let Ee=`number expected, ${ee} found`;return co(n)&&o===void 0&&(Ee+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new Be(q.key,ce,Ee)]}return o!=="categorical"||ee!=="number"||isFinite(ie)&&Math.floor(ie)===ie?o!=="categorical"&&ee==="number"&&p!==void 0&&ie<p?[new Be(q.key,ce,"stop domain values must appear in ascending order")]:(p=ie,o==="categorical"&&ie in x?[new Be(q.key,ce,"stop domain values must be unique")]:(x[ie]=!0,[])):[new Be(q.key,ce,`integer expected, found ${ie}`)]}}function Is(s){const n=(s.expressionContext==="property"?Vn:ln)(ka(s.value),s.valueSpec);if(n.result==="error")return n.value.map(h=>new Be(`${s.key}${h.key}`,s.value,h.message));const o=n.value.expression||n.value._styleExpression.expression;if(s.expressionContext==="property"&&s.propertyKey==="text-font"&&!o.outputDefined())return[new Be(s.key,s.value,`Invalid data expression for "${s.propertyKey}". Output values must be contained as literals within the expression.`)];if(s.expressionContext==="property"&&s.propertyType==="layout"&&!tl(o))return[new Be(s.key,s.value,'"feature-state" data expressions are not supported with layout properties.')];if(s.expressionContext==="filter"&&!tl(o))return[new Be(s.key,s.value,'"feature-state" data expressions are not supported with filters.')];if(s.expressionContext&&s.expressionContext.indexOf("cluster")===0){if(!nl(o,["zoom","feature-state"]))return[new Be(s.key,s.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(s.expressionContext==="cluster-initial"&&!Xl(o))return[new Be(s.key,s.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function ll(s){const n=s.key,o=s.value,h=s.valueSpec,p=[];return Array.isArray(h.values)?h.values.indexOf(mi(o))===-1&&p.push(new Be(n,o,`expected one of [${h.values.join(", ")}], ${JSON.stringify(o)} found`)):Object.keys(h.values).indexOf(mi(o))===-1&&p.push(new Be(n,o,`expected one of [${Object.keys(h.values).join(", ")}], ${JSON.stringify(o)} found`)),p}function lc(s){return Ou(ka(s.value))?Is(jt({},s,{expressionContext:"filter",valueSpec:{value:"boolean"}})):Kd(s)}function Kd(s){const n=s.value,o=s.key;if(Cn(n)!=="array")return[new Be(o,n,`array expected, ${Cn(n)} found`)];const h=s.styleSpec;let p,y=[];if(n.length<1)return[new Be(o,n,"filter array must have at least 1 element")];switch(y=y.concat(ll({key:`${o}[0]`,value:n[0],valueSpec:h.filter_operator,style:s.style,styleSpec:s.styleSpec})),mi(n[0])){case"<":case"<=":case">":case">=":n.length>=2&&mi(n[1])==="$type"&&y.push(new Be(o,n,`"$type" cannot be use with operator "${n[0]}"`));case"==":case"!=":n.length!==3&&y.push(new Be(o,n,`filter array for operator "${n[0]}" must have 3 elements`));case"in":case"!in":n.length>=2&&(p=Cn(n[1]),p!=="string"&&y.push(new Be(`${o}[1]`,n[1],`string expected, ${p} found`)));for(let x=2;x<n.length;x++)p=Cn(n[x]),mi(n[1])==="$type"?y=y.concat(ll({key:`${o}[${x}]`,value:n[x],valueSpec:h.geometry_type,style:s.style,styleSpec:s.styleSpec})):p!=="string"&&p!=="number"&&p!=="boolean"&&y.push(new Be(`${o}[${x}]`,n[x],`string, number, or boolean expected, ${p} found`));break;case"any":case"all":case"none":for(let x=1;x<n.length;x++)y=y.concat(Kd({key:`${o}[${x}]`,value:n[x],style:s.style,styleSpec:s.styleSpec}));break;case"has":case"!has":p=Cn(n[1]),n.length!==2?y.push(new Be(o,n,`filter array for "${n[0]}" operator must have 2 elements`)):p!=="string"&&y.push(new Be(`${o}[1]`,n[1],`string expected, ${p} found`));break;case"within":p=Cn(n[1]),n.length!==2?y.push(new Be(o,n,`filter array for "${n[0]}" operator must have 2 elements`)):p!=="object"&&y.push(new Be(`${o}[1]`,n[1],`object expected, ${p} found`))}return y}function cc(s,n){const o=s.key,h=s.validateSpec,p=s.style,y=s.styleSpec,x=s.value,S=s.objectKey,I=y[`${n}_${s.layerType}`];if(!I)return[];const P=S.match(/^(.*)-transition$/);if(n==="paint"&&P&&I[P[1]]&&I[P[1]].transition)return h({key:o,value:x,valueSpec:y.transition,style:p,styleSpec:y});const L=s.valueSpec||I[S];if(!L)return[new Be(o,x,`unknown property "${S}"`)];let B;if(Cn(x)==="string"&&co(L)&&!L.tokens&&(B=/^{([^}]+)}$/.exec(x)))return[new Be(o,x,`"${S}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(B[1])} }\`.`)];const N=[];return s.layerType==="symbol"&&(S==="text-field"&&p&&!p.glyphs&&N.push(new Be(o,x,'use of "text-field" requires a style "glyphs" property')),S==="text-font"&&nc(ka(x))&&mi(x.type)==="identity"&&N.push(new Be(o,x,'"text-font" does not support identity functions'))),N.concat(h({key:s.key,value:x,valueSpec:L,style:p,styleSpec:y,expressionContext:"property",propertyType:n,propertyKey:S}))}function cl(s){return cc(s,"paint")}function uc(s){return cc(s,"layout")}function hc(s){let n=[];const o=s.value,h=s.key,p=s.style,y=s.styleSpec;o.type||o.ref||n.push(new Be(h,o,'either "type" or "ref" is required'));let x=mi(o.type);const S=mi(o.ref);if(o.id){const I=mi(o.id);for(let P=0;P<s.arrayIndex;P++){const L=p.layers[P];mi(L.id)===I&&n.push(new Be(h,o.id,`duplicate layer id "${o.id}", previously used at line ${L.id.__line__}`))}}if("ref"in o){let I;["type","source","source-layer","filter","layout"].forEach(P=>{P in o&&n.push(new Be(h,o[P],`"${P}" is prohibited for ref layers`))}),p.layers.forEach(P=>{mi(P.id)===S&&(I=P)}),I?I.ref?n.push(new Be(h,o.ref,"ref cannot reference another ref layer")):x=mi(I.type):n.push(new Be(h,o.ref,`ref layer "${S}" not found`))}else if(x!=="background")if(o.source){const I=p.sources&&p.sources[o.source],P=I&&mi(I.type);I?P==="vector"&&x==="raster"?n.push(new Be(h,o.source,`layer "${o.id}" requires a raster source`)):P==="raster"&&x!=="raster"?n.push(new Be(h,o.source,`layer "${o.id}" requires a vector source`)):P!=="vector"||o["source-layer"]?P==="raster-dem"&&x!=="hillshade"?n.push(new Be(h,o.source,"raster-dem source can only be used with layer type 'hillshade'.")):x!=="line"||!o.paint||!o.paint["line-gradient"]||P==="geojson"&&I.lineMetrics||n.push(new Be(h,o,`layer "${o.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):n.push(new Be(h,o,`layer "${o.id}" must specify a "source-layer"`)):n.push(new Be(h,o.source,`source "${o.source}" not found`))}else n.push(new Be(h,o,'missing required property "source"'));return n=n.concat(qr({key:h,value:o,valueSpec:y.layer,style:s.style,styleSpec:s.styleSpec,validateSpec:s.validateSpec,objectElementValidators:{"*":()=>[],type:()=>s.validateSpec({key:`${h}.type`,value:o.type,valueSpec:y.layer.type,style:s.style,styleSpec:s.styleSpec,validateSpec:s.validateSpec,object:o,objectKey:"type"}),filter:lc,layout:I=>qr({layer:o,key:I.key,value:I.value,style:I.style,styleSpec:I.styleSpec,validateSpec:I.validateSpec,objectElementValidators:{"*":P=>uc(jt({layerType:x},P))}}),paint:I=>qr({layer:o,key:I.key,value:I.value,style:I.style,styleSpec:I.styleSpec,validateSpec:I.validateSpec,objectElementValidators:{"*":P=>cl(jt({layerType:x},P))}})}})),n}function Aa(s){const n=s.value,o=s.key,h=Cn(n);return h!=="string"?[new Be(o,n,`string expected, ${h} found`)]:[]}const ul={promoteId:function({key:s,value:n}){if(Cn(n)==="string")return Aa({key:s,value:n});{const o=[];for(const h in n)o.push(...Aa({key:`${s}.${h}`,value:n[h]}));return o}}};function Jd(s){const n=s.value,o=s.key,h=s.styleSpec,p=s.style,y=s.validateSpec;if(!n.type)return[new Be(o,n,'"type" is required')];const x=mi(n.type);let S;switch(x){case"vector":case"raster":case"raster-dem":return S=qr({key:o,value:n,valueSpec:h[`source_${x.replace("-","_")}`],style:s.style,styleSpec:h,objectElementValidators:ul,validateSpec:y}),S;case"geojson":if(S=qr({key:o,value:n,valueSpec:h.source_geojson,style:p,styleSpec:h,validateSpec:y,objectElementValidators:ul}),n.cluster)for(const I in n.clusterProperties){const[P,L]=n.clusterProperties[I],B=typeof P=="string"?[P,["accumulated"],["get",I]]:P;S.push(...Is({key:`${o}.${I}.map`,value:L,validateSpec:y,expressionContext:"cluster-map"})),S.push(...Is({key:`${o}.${I}.reduce`,value:B,validateSpec:y,expressionContext:"cluster-reduce"}))}return S;case"video":return qr({key:o,value:n,valueSpec:h.source_video,style:p,validateSpec:y,styleSpec:h});case"image":return qr({key:o,value:n,valueSpec:h.source_image,style:p,validateSpec:y,styleSpec:h});case"canvas":return[new Be(o,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return ll({key:`${o}.type`,value:n.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:p,validateSpec:y,styleSpec:h})}}function Qd(s){const n=s.value,o=s.styleSpec,h=o.light,p=s.style;let y=[];const x=Cn(n);if(n===void 0)return y;if(x!=="object")return y=y.concat([new Be("light",n,`object expected, ${x} found`)]),y;for(const S in n){const I=S.match(/^(.*)-transition$/);y=y.concat(I&&h[I[1]]&&h[I[1]].transition?s.validateSpec({key:S,value:n[S],valueSpec:o.transition,validateSpec:s.validateSpec,style:p,styleSpec:o}):h[S]?s.validateSpec({key:S,value:n[S],valueSpec:h[S],validateSpec:s.validateSpec,style:p,styleSpec:o}):[new Be(S,n[S],`unknown property "${S}"`)])}return y}function ef(s){const n=s.value,o=s.styleSpec,h=o.terrain,p=s.style;let y=[];const x=Cn(n);if(n===void 0)return y;if(x!=="object")return y=y.concat([new Be("terrain",n,`object expected, ${x} found`)]),y;for(const S in n)y=y.concat(h[S]?s.validateSpec({key:S,value:n[S],valueSpec:h[S],validateSpec:s.validateSpec,style:p,styleSpec:o}):[new Be(S,n[S],`unknown property "${S}"`)]);return y}function tf(s){let n=[];const o=s.value,h=s.key;if(Array.isArray(o)){const p=[],y=[];for(const x in o)o[x].id&&p.includes(o[x].id)&&n.push(new Be(h,o,`all the sprites' ids must be unique, but ${o[x].id} is duplicated`)),p.push(o[x].id),o[x].url&&y.includes(o[x].url)&&n.push(new Be(h,o,`all the sprites' URLs must be unique, but ${o[x].url} is duplicated`)),y.push(o[x].url),n=n.concat(qr({key:`${h}[${x}]`,value:o[x],valueSpec:{id:{type:"string",required:!0},url:{type:"string",required:!0}},validateSpec:s.validateSpec}));return n}return Aa({key:h,value:o})}const nf={"*":()=>[],array:$u,boolean:function(s){const n=s.value,o=s.key,h=Cn(n);return h!=="boolean"?[new Be(o,n,`boolean expected, ${h} found`)]:[]},number:oc,color:function(s){const n=s.key,o=s.value,h=Cn(o);return h!=="string"?[new Be(n,o,`color expected, ${h} found`)]:Yt.parse(String(o))?[]:[new Be(n,o,`color expected, "${o}" found`)]},constants:Xd,enum:ll,filter:lc,function:Vu,layer:hc,object:qr,source:Jd,light:Qd,terrain:ef,string:Aa,formatted:function(s){return Aa(s).length===0?[]:Is(s)},resolvedImage:function(s){return Aa(s).length===0?[]:Is(s)},padding:function(s){const n=s.key,o=s.value;if(Cn(o)==="array"){if(o.length<1||o.length>4)return[new Be(n,o,`padding requires 1 to 4 values; ${o.length} values found`)];const h={type:"number"};let p=[];for(let y=0;y<o.length;y++)p=p.concat(s.validateSpec({key:`${n}[${y}]`,value:o[y],validateSpec:s.validateSpec,valueSpec:h}));return p}return oc({key:n,value:o,valueSpec:{}})},variableAnchorOffsetCollection:function(s){const n=s.key,o=s.value,h=Cn(o),p=s.styleSpec;if(h!=="array"||o.length<1||o.length%2!=0)return[new Be(n,o,"variableAnchorOffsetCollection requires a non-empty array of even length")];let y=[];for(let x=0;x<o.length;x+=2)y=y.concat(ll({key:`${n}[${x}]`,value:o[x],valueSpec:p.layout_symbol["text-anchor"]})),y=y.concat($u({key:`${n}[${x+1}]`,value:o[x+1],valueSpec:{length:2,value:"number"},validateSpec:s.validateSpec,style:s.style,styleSpec:p}));return y},sprite:tf};function Qs(s){const n=s.value,o=s.valueSpec,h=s.styleSpec;return s.validateSpec=Qs,o.expression&&nc(mi(n))?Vu(s):o.expression&&ic(ka(n))?Is(s):o.type&&nf[o.type]?nf[o.type](s):qr(jt({},s,{valueSpec:o.type?h[o.type]:o}))}function hl(s){const n=s.value,o=s.key,h=Aa(s);return h.length||(n.indexOf("{fontstack}")===-1&&h.push(new Be(o,n,'"glyphs" url must include a "{fontstack}" token')),n.indexOf("{range}")===-1&&h.push(new Be(o,n,'"glyphs" url must include a "{range}" token'))),h}function gi(s,n=U){let o=[];return o=o.concat(Qs({key:"",value:s,valueSpec:n.$root,styleSpec:n,style:s,validateSpec:Qs,objectElementValidators:{glyphs:hl,"*":()=>[]}})),s.constants&&(o=o.concat(Xd({key:"constants",value:s.constants,style:s,styleSpec:n,validateSpec:Qs}))),rf(o)}function Hr(s){return function(n){return s({...n,validateSpec:Qs})}}function rf(s){return[].concat(s).sort((n,o)=>n.line-o.line)}function ks(s){return function(...n){return rf(s.apply(this,n))}}gi.source=ks(Hr(Jd)),gi.sprite=ks(Hr(tf)),gi.glyphs=ks(Hr(hl)),gi.light=ks(Hr(Qd)),gi.terrain=ks(Hr(ef)),gi.layer=ks(Hr(hc)),gi.filter=ks(Hr(lc)),gi.paintProperty=ks(Hr(cl)),gi.layoutProperty=ks(Hr(uc));const dl=gi,fl=dl.light,rg=dl.paintProperty,ju=dl.layoutProperty;function sf(s,n){let o=!1;if(n&&n.length)for(const h of n)s.fire(new ft(new Error(h.message))),o=!0;return o}class Pa{constructor(n,o,h){const p=this.cells=[];if(n instanceof ArrayBuffer){this.arrayBuffer=n;const x=new Int32Array(this.arrayBuffer);n=x[0],this.d=(o=x[1])+2*(h=x[2]);for(let I=0;I<this.d*this.d;I++){const P=x[3+I],L=x[3+I+1];p.push(P===L?null:x.subarray(P,L))}const S=x[3+p.length+1];this.keys=x.subarray(x[3+p.length],S),this.bboxes=x.subarray(S),this.insert=this._insertReadonly}else{this.d=o+2*h;for(let x=0;x<this.d*this.d;x++)p.push([]);this.keys=[],this.bboxes=[]}this.n=o,this.extent=n,this.padding=h,this.scale=o/n,this.uid=0;const y=h/o*n;this.min=-y,this.max=n+y}insert(n,o,h,p,y){this._forEachCell(o,h,p,y,this._insertCell,this.uid++,void 0,void 0),this.keys.push(n),this.bboxes.push(o),this.bboxes.push(h),this.bboxes.push(p),this.bboxes.push(y)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(n,o,h,p,y,x){this.cells[y].push(x)}query(n,o,h,p,y){const x=this.min,S=this.max;if(n<=x&&o<=x&&S<=h&&S<=p&&!y)return Array.prototype.slice.call(this.keys);{const I=[];return this._forEachCell(n,o,h,p,this._queryCell,I,{},y),I}}_queryCell(n,o,h,p,y,x,S,I){const P=this.cells[y];if(P!==null){const L=this.keys,B=this.bboxes;for(let N=0;N<P.length;N++){const q=P[N];if(S[q]===void 0){const H=4*q;(I?I(B[H+0],B[H+1],B[H+2],B[H+3]):n<=B[H+2]&&o<=B[H+3]&&h>=B[H+0]&&p>=B[H+1])?(S[q]=!0,x.push(L[q])):S[q]=!1}}}}_forEachCell(n,o,h,p,y,x,S,I){const P=this._convertToCellCoord(n),L=this._convertToCellCoord(o),B=this._convertToCellCoord(h),N=this._convertToCellCoord(p);for(let q=P;q<=B;q++)for(let H=L;H<=N;H++){const ee=this.d*H+q;if((!I||I(this._convertFromCellCoord(q),this._convertFromCellCoord(H),this._convertFromCellCoord(q+1),this._convertFromCellCoord(H+1)))&&y.call(this,n,o,h,p,ee,x,S,I))return}}_convertFromCellCoord(n){return(n-this.padding)/this.scale}_convertToCellCoord(n){return Math.max(0,Math.min(this.d-1,Math.floor(n*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;const n=this.cells,o=3+this.cells.length+1+1;let h=0;for(let x=0;x<this.cells.length;x++)h+=this.cells[x].length;const p=new Int32Array(o+h+this.keys.length+this.bboxes.length);p[0]=this.extent,p[1]=this.n,p[2]=this.padding;let y=o;for(let x=0;x<n.length;x++){const S=n[x];p[3+x]=y,p.set(S,y),y+=S.length}return p[3+n.length]=y,p.set(this.keys,y),y+=this.keys.length,p[3+n.length+1]=y,p.set(this.bboxes,y),y+=this.bboxes.length,p.buffer}static serialize(n,o){const h=n.toArrayBuffer();return o&&o.push(h),{buffer:h}}static deserialize(n){return new Pa(n.buffer)}}const ea={};function St(s,n,o={}){if(ea[s])throw new Error(`${s} is already registered.`);Object.defineProperty(n,"_classRegistryKey",{value:s,writeable:!1}),ea[s]={klass:n,omit:o.omit||[],shallow:o.shallow||[]}}St("Object",Object),St("TransferableGridIndex",Pa),St("Color",Yt),St("Error",Error),St("AJAXError",Et),St("ResolvedImage",Gr),St("StylePropertyFunction",Ia),St("StyleExpression",ni,{omit:["_evaluator"]}),St("ZoomDependentExpression",$n),St("ZoomConstantExpression",sl),St("CompoundExpression",Ir,{omit:["_evaluate"]});for(const s in oo)oo[s]._classRegistryKey||St(`Expression_${s}`,oo[s]);function af(s){return s&&typeof ArrayBuffer<"u"&&(s instanceof ArrayBuffer||s.constructor&&s.constructor.name==="ArrayBuffer")}function Ra(s,n){if(s==null||typeof s=="boolean"||typeof s=="number"||typeof s=="string"||s instanceof Boolean||s instanceof Number||s instanceof String||s instanceof Date||s instanceof RegExp||s instanceof Blob)return s;if(af(s)||nt(s))return n&&n.push(s),s;if(ArrayBuffer.isView(s)){const o=s;return n&&n.push(o.buffer),o}if(s instanceof ImageData)return n&&n.push(s.data.buffer),s;if(Array.isArray(s)){const o=[];for(const h of s)o.push(Ra(h,n));return o}if(typeof s=="object"){const o=s.constructor,h=o._classRegistryKey;if(!h)throw new Error("can't serialize object of unregistered class");if(!ea[h])throw new Error(`${h} is not registered.`);const p=o.serialize?o.serialize(s,n):{};if(o.serialize){if(n&&p===n[n.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(const y in s){if(!s.hasOwnProperty(y)||ea[h].omit.indexOf(y)>=0)continue;const x=s[y];p[y]=ea[h].shallow.indexOf(y)>=0?x:Ra(x,n)}s instanceof Error&&(p.message=s.message)}if(p.$name)throw new Error("$name property is reserved for worker serialization logic.");return h!=="Object"&&(p.$name=h),p}throw new Error("can't serialize object of type "+typeof s)}function uo(s){if(s==null||typeof s=="boolean"||typeof s=="number"||typeof s=="string"||s instanceof Boolean||s instanceof Number||s instanceof String||s instanceof Date||s instanceof RegExp||s instanceof Blob||af(s)||nt(s)||ArrayBuffer.isView(s)||s instanceof ImageData)return s;if(Array.isArray(s))return s.map(uo);if(typeof s=="object"){const n=s.$name||"Object";if(!ea[n])throw new Error(`can't deserialize unregistered class ${n}`);const{klass:o}=ea[n];if(!o)throw new Error(`can't deserialize unregistered class ${n}`);if(o.deserialize)return o.deserialize(s);const h=Object.create(o.prototype);for(const p of Object.keys(s)){if(p==="$name")continue;const y=s[p];h[p]=ea[n].shallow.indexOf(p)>=0?y:uo(y)}return h}throw new Error("can't deserialize object of type "+typeof s)}class dc{constructor(){this.first=!0}update(n,o){const h=Math.floor(n);return this.first?(this.first=!1,this.lastIntegerZoom=h,this.lastIntegerZoomTime=0,this.lastZoom=n,this.lastFloorZoom=h,!0):(this.lastFloorZoom>h?(this.lastIntegerZoom=h+1,this.lastIntegerZoomTime=o):this.lastFloorZoom<h&&(this.lastIntegerZoom=h,this.lastIntegerZoomTime=o),n!==this.lastZoom&&(this.lastZoom=n,this.lastFloorZoom=h,!0))}}const bt={"Latin-1 Supplement":s=>s>=128&&s<=255,Arabic:s=>s>=1536&&s<=1791,"Arabic Supplement":s=>s>=1872&&s<=1919,"Arabic Extended-A":s=>s>=2208&&s<=2303,"Hangul Jamo":s=>s>=4352&&s<=4607,"Unified Canadian Aboriginal Syllabics":s=>s>=5120&&s<=5759,Khmer:s=>s>=6016&&s<=6143,"Unified Canadian Aboriginal Syllabics Extended":s=>s>=6320&&s<=6399,"General Punctuation":s=>s>=8192&&s<=8303,"Letterlike Symbols":s=>s>=8448&&s<=8527,"Number Forms":s=>s>=8528&&s<=8591,"Miscellaneous Technical":s=>s>=8960&&s<=9215,"Control Pictures":s=>s>=9216&&s<=9279,"Optical Character Recognition":s=>s>=9280&&s<=9311,"Enclosed Alphanumerics":s=>s>=9312&&s<=9471,"Geometric Shapes":s=>s>=9632&&s<=9727,"Miscellaneous Symbols":s=>s>=9728&&s<=9983,"Miscellaneous Symbols and Arrows":s=>s>=11008&&s<=11263,"CJK Radicals Supplement":s=>s>=11904&&s<=12031,"Kangxi Radicals":s=>s>=12032&&s<=12255,"Ideographic Description Characters":s=>s>=12272&&s<=12287,"CJK Symbols and Punctuation":s=>s>=12288&&s<=12351,Hiragana:s=>s>=12352&&s<=12447,Katakana:s=>s>=12448&&s<=12543,Bopomofo:s=>s>=12544&&s<=12591,"Hangul Compatibility Jamo":s=>s>=12592&&s<=12687,Kanbun:s=>s>=12688&&s<=12703,"Bopomofo Extended":s=>s>=12704&&s<=12735,"CJK Strokes":s=>s>=12736&&s<=12783,"Katakana Phonetic Extensions":s=>s>=12784&&s<=12799,"Enclosed CJK Letters and Months":s=>s>=12800&&s<=13055,"CJK Compatibility":s=>s>=13056&&s<=13311,"CJK Unified Ideographs Extension A":s=>s>=13312&&s<=19903,"Yijing Hexagram Symbols":s=>s>=19904&&s<=19967,"CJK Unified Ideographs":s=>s>=19968&&s<=40959,"Yi Syllables":s=>s>=40960&&s<=42127,"Yi Radicals":s=>s>=42128&&s<=42191,"Hangul Jamo Extended-A":s=>s>=43360&&s<=43391,"Hangul Syllables":s=>s>=44032&&s<=55215,"Hangul Jamo Extended-B":s=>s>=55216&&s<=55295,"Private Use Area":s=>s>=57344&&s<=63743,"CJK Compatibility Ideographs":s=>s>=63744&&s<=64255,"Arabic Presentation Forms-A":s=>s>=64336&&s<=65023,"Vertical Forms":s=>s>=65040&&s<=65055,"CJK Compatibility Forms":s=>s>=65072&&s<=65103,"Small Form Variants":s=>s>=65104&&s<=65135,"Arabic Presentation Forms-B":s=>s>=65136&&s<=65279,"Halfwidth and Fullwidth Forms":s=>s>=65280&&s<=65519};function fc(s){for(const n of s)if(ho(n.charCodeAt(0)))return!0;return!1}function sg(s){for(const n of s)if(!Gu(n.charCodeAt(0)))return!1;return!0}function Gu(s){return!(bt.Arabic(s)||bt["Arabic Supplement"](s)||bt["Arabic Extended-A"](s)||bt["Arabic Presentation Forms-A"](s)||bt["Arabic Presentation Forms-B"](s))}function ho(s){return!(s!==746&&s!==747&&(s<4352||!(bt["Bopomofo Extended"](s)||bt.Bopomofo(s)||bt["CJK Compatibility Forms"](s)&&!(s>=65097&&s<=65103)||bt["CJK Compatibility Ideographs"](s)||bt["CJK Compatibility"](s)||bt["CJK Radicals Supplement"](s)||bt["CJK Strokes"](s)||!(!bt["CJK Symbols and Punctuation"](s)||s>=12296&&s<=12305||s>=12308&&s<=12319||s===12336)||bt["CJK Unified Ideographs Extension A"](s)||bt["CJK Unified Ideographs"](s)||bt["Enclosed CJK Letters and Months"](s)||bt["Hangul Compatibility Jamo"](s)||bt["Hangul Jamo Extended-A"](s)||bt["Hangul Jamo Extended-B"](s)||bt["Hangul Jamo"](s)||bt["Hangul Syllables"](s)||bt.Hiragana(s)||bt["Ideographic Description Characters"](s)||bt.Kanbun(s)||bt["Kangxi Radicals"](s)||bt["Katakana Phonetic Extensions"](s)||bt.Katakana(s)&&s!==12540||!(!bt["Halfwidth and Fullwidth Forms"](s)||s===65288||s===65289||s===65293||s>=65306&&s<=65310||s===65339||s===65341||s===65343||s>=65371&&s<=65503||s===65507||s>=65512&&s<=65519)||!(!bt["Small Form Variants"](s)||s>=65112&&s<=65118||s>=65123&&s<=65126)||bt["Unified Canadian Aboriginal Syllabics"](s)||bt["Unified Canadian Aboriginal Syllabics Extended"](s)||bt["Vertical Forms"](s)||bt["Yijing Hexagram Symbols"](s)||bt["Yi Syllables"](s)||bt["Yi Radicals"](s))))}function qu(s){return!(ho(s)||function(n){return!!(bt["Latin-1 Supplement"](n)&&(n===167||n===169||n===174||n===177||n===188||n===189||n===190||n===215||n===247)||bt["General Punctuation"](n)&&(n===8214||n===8224||n===8225||n===8240||n===8241||n===8251||n===8252||n===8258||n===8263||n===8264||n===8265||n===8273)||bt["Letterlike Symbols"](n)||bt["Number Forms"](n)||bt["Miscellaneous Technical"](n)&&(n>=8960&&n<=8967||n>=8972&&n<=8991||n>=8996&&n<=9e3||n===9003||n>=9085&&n<=9114||n>=9150&&n<=9165||n===9167||n>=9169&&n<=9179||n>=9186&&n<=9215)||bt["Control Pictures"](n)&&n!==9251||bt["Optical Character Recognition"](n)||bt["Enclosed Alphanumerics"](n)||bt["Geometric Shapes"](n)||bt["Miscellaneous Symbols"](n)&&!(n>=9754&&n<=9759)||bt["Miscellaneous Symbols and Arrows"](n)&&(n>=11026&&n<=11055||n>=11088&&n<=11097||n>=11192&&n<=11243)||bt["CJK Symbols and Punctuation"](n)||bt.Katakana(n)||bt["Private Use Area"](n)||bt["CJK Compatibility Forms"](n)||bt["Small Form Variants"](n)||bt["Halfwidth and Fullwidth Forms"](n)||n===8734||n===8756||n===8757||n>=9984&&n<=10087||n>=10102&&n<=10131||n===65532||n===65533)}(s))}function of(s){return s>=1424&&s<=2303||bt["Arabic Presentation Forms-A"](s)||bt["Arabic Presentation Forms-B"](s)}function lf(s,n){return!(!n&&of(s)||s>=2304&&s<=3583||s>=3840&&s<=4255||bt.Khmer(s))}function ag(s){for(const n of s)if(of(n.charCodeAt(0)))return!0;return!1}const pl="deferred",Hu="loading",Zu="loaded";let Wu=null,fr="unavailable",As=null;const cf=function(s){s&&typeof s=="string"&&s.indexOf("NetworkError")>-1&&(fr="error"),Wu&&Wu(s)};function Yu(){Xu.fire(new Ge("pluginStateChange",{pluginStatus:fr,pluginURL:As}))}const Xu=new X,Ku=function(){return fr},uf=function(){if(fr!==pl||!As)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");fr=Hu,Yu(),As&&He({url:As},s=>{s?cf(s):(fr=Zu,Yu())})},Zr={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>fr===Zu||Zr.applyArabicShaping!=null,isLoading:()=>fr===Hu,setState(s){if(!_e())throw new Error("Cannot set the state of the rtl-text-plugin when not in the web-worker context");fr=s.pluginStatus,As=s.pluginURL},isParsed(){if(!_e())throw new Error("rtl-text-plugin is only parsed on the worker-threads");return Zr.applyArabicShaping!=null&&Zr.processBidirectionalText!=null&&Zr.processStyledBidirectionalText!=null},getPluginURL(){if(!_e())throw new Error("rtl-text-plugin url can only be queried from the worker threads");return As}};class Zn{constructor(n,o){this.zoom=n,o?(this.now=o.now,this.fadeDuration=o.fadeDuration,this.zoomHistory=o.zoomHistory,this.transition=o.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new dc,this.transition={})}isSupportedScript(n){return function(o,h){for(const p of o)if(!lf(p.charCodeAt(0),h))return!1;return!0}(n,Zr.isLoaded())}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const n=this.zoom,o=n-Math.floor(n),h=this.crossFadingFactor();return n>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:o+(1-o)*h}:{fromScale:.5,toScale:1,t:1-(1-h)*o}}}class Ma{constructor(n,o){this.property=n,this.value=o,this.expression=function(h,p){if(nc(h))return new Ia(h,p);if(ic(h)){const y=Vn(h,p);if(y.result==="error")throw new Error(y.value.map(x=>`${x.key}: ${x.message}`).join(", "));return y.value}{let y=h;return p.type==="color"&&typeof h=="string"?y=Yt.parse(h):p.type!=="padding"||typeof h!="number"&&!Array.isArray(h)?p.type==="variableAnchorOffsetCollection"&&Array.isArray(h)&&(y=Zi.parse(h)):y=Cr.parse(h),{kind:"constant",evaluate:()=>y}}}(o===void 0?n.specification.default:o,n.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(n,o,h){return this.property.possiblyEvaluate(this,n,o,h)}}class Ju{constructor(n){this.property=n,this.value=new Ma(n,void 0)}transitioned(n,o){return new hf(this.property,this.value,o,ge({},n.transition,this.transition),n.now)}untransitioned(){return new hf(this.property,this.value,null,{},0)}}class pc{constructor(n){this._properties=n,this._values=Object.create(n.defaultTransitionablePropertyValues)}getValue(n){return Te(this._values[n].value.value)}setValue(n,o){Object.prototype.hasOwnProperty.call(this._values,n)||(this._values[n]=new Ju(this._values[n].property)),this._values[n].value=new Ma(this._values[n].property,o===null?void 0:Te(o))}getTransition(n){return Te(this._values[n].transition)}setTransition(n,o){Object.prototype.hasOwnProperty.call(this._values,n)||(this._values[n]=new Ju(this._values[n].property)),this._values[n].transition=Te(o)||void 0}serialize(){const n={};for(const o of Object.keys(this._values)){const h=this.getValue(o);h!==void 0&&(n[o]=h);const p=this.getTransition(o);p!==void 0&&(n[`${o}-transition`]=p)}return n}transitioned(n,o){const h=new df(this._properties);for(const p of Object.keys(this._values))h._values[p]=this._values[p].transitioned(n,o._values[p]);return h}untransitioned(){const n=new df(this._properties);for(const o of Object.keys(this._values))n._values[o]=this._values[o].untransitioned();return n}}class hf{constructor(n,o,h,p,y){this.property=n,this.value=o,this.begin=y+p.delay||0,this.end=this.begin+p.duration||0,n.specification.transition&&(p.delay||p.duration)&&(this.prior=h)}possiblyEvaluate(n,o,h){const p=n.now||0,y=this.value.possiblyEvaluate(n,o,h),x=this.prior;if(x){if(p>this.end)return this.prior=null,y;if(this.value.isDataDriven())return this.prior=null,y;if(p<this.begin)return x.possiblyEvaluate(n,o,h);{const S=(p-this.begin)/(this.end-this.begin);return this.property.interpolate(x.possiblyEvaluate(n,o,h),y,function(I){if(I<=0)return 0;if(I>=1)return 1;const P=I*I,L=P*I;return 4*(I<.5?L:3*(I-P)+L-.75)}(S))}}return y}}class df{constructor(n){this._properties=n,this._values=Object.create(n.defaultTransitioningPropertyValues)}possiblyEvaluate(n,o,h){const p=new mc(this._properties);for(const y of Object.keys(this._values))p._values[y]=this._values[y].possiblyEvaluate(n,o,h);return p}hasTransition(){for(const n of Object.keys(this._values))if(this._values[n].prior)return!0;return!1}}class ff{constructor(n){this._properties=n,this._values=Object.create(n.defaultPropertyValues)}hasValue(n){return this._values[n].value!==void 0}getValue(n){return Te(this._values[n].value)}setValue(n,o){this._values[n]=new Ma(this._values[n].property,o===null?void 0:Te(o))}serialize(){const n={};for(const o of Object.keys(this._values)){const h=this.getValue(o);h!==void 0&&(n[o]=h)}return n}possiblyEvaluate(n,o,h){const p=new mc(this._properties);for(const y of Object.keys(this._values))p._values[y]=this._values[y].possiblyEvaluate(n,o,h);return p}}class ns{constructor(n,o,h){this.property=n,this.value=o,this.parameters=h}isConstant(){return this.value.kind==="constant"}constantOr(n){return this.value.kind==="constant"?this.value.value:n}evaluate(n,o,h,p){return this.property.evaluate(this.value,this.parameters,n,o,h,p)}}class mc{constructor(n){this._properties=n,this._values=Object.create(n.defaultPossiblyEvaluatedValues)}get(n){return this._values[n]}}class Ot{constructor(n){this.specification=n}possiblyEvaluate(n,o){if(n.isDataDriven())throw new Error("Value should not be data driven");return n.expression.evaluate(o)}interpolate(n,o,h){const p=kr[this.specification.type];return p?p(n,o,h):n}}class qt{constructor(n,o){this.specification=n,this.overrides=o}possiblyEvaluate(n,o,h,p){return new ns(this,n.expression.kind==="constant"||n.expression.kind==="camera"?{kind:"constant",value:n.expression.evaluate(o,null,{},h,p)}:n.expression,o)}interpolate(n,o,h){if(n.value.kind!=="constant"||o.value.kind!=="constant")return n;if(n.value.value===void 0||o.value.value===void 0)return new ns(this,{kind:"constant",value:void 0},n.parameters);const p=kr[this.specification.type];if(p){const y=p(n.value.value,o.value.value,h);return new ns(this,{kind:"constant",value:y},n.parameters)}return n}evaluate(n,o,h,p,y,x){return n.kind==="constant"?n.value:n.evaluate(o,h,p,y,x)}}class gc extends qt{possiblyEvaluate(n,o,h,p){if(n.value===void 0)return new ns(this,{kind:"constant",value:void 0},o);if(n.expression.kind==="constant"){const y=n.expression.evaluate(o,null,{},h,p),x=n.property.specification.type==="resolvedImage"&&typeof y!="string"?y.name:y,S=this._calculate(x,x,x,o);return new ns(this,{kind:"constant",value:S},o)}if(n.expression.kind==="camera"){const y=this._calculate(n.expression.evaluate({zoom:o.zoom-1}),n.expression.evaluate({zoom:o.zoom}),n.expression.evaluate({zoom:o.zoom+1}),o);return new ns(this,{kind:"constant",value:y},o)}return new ns(this,n.expression,o)}evaluate(n,o,h,p,y,x){if(n.kind==="source"){const S=n.evaluate(o,h,p,y,x);return this._calculate(S,S,S,o)}return n.kind==="composite"?this._calculate(n.evaluate({zoom:Math.floor(o.zoom)-1},h,p),n.evaluate({zoom:Math.floor(o.zoom)},h,p),n.evaluate({zoom:Math.floor(o.zoom)+1},h,p),o):n.value}_calculate(n,o,h,p){return p.zoom>p.zoomHistory.lastIntegerZoom?{from:n,to:o}:{from:h,to:o}}interpolate(n){return n}}class Qu{constructor(n){this.specification=n}possiblyEvaluate(n,o,h,p){if(n.value!==void 0){if(n.expression.kind==="constant"){const y=n.expression.evaluate(o,null,{},h,p);return this._calculate(y,y,y,o)}return this._calculate(n.expression.evaluate(new Zn(Math.floor(o.zoom-1),o)),n.expression.evaluate(new Zn(Math.floor(o.zoom),o)),n.expression.evaluate(new Zn(Math.floor(o.zoom+1),o)),o)}}_calculate(n,o,h,p){return p.zoom>p.zoomHistory.lastIntegerZoom?{from:n,to:o}:{from:h,to:o}}interpolate(n){return n}}class eh{constructor(n){this.specification=n}possiblyEvaluate(n,o,h,p){return!!n.expression.evaluate(o,null,{},h,p)}interpolate(){return!1}}class ki{constructor(n){this.properties=n,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const o in n){const h=n[o];h.specification.overridable&&this.overridableProperties.push(o);const p=this.defaultPropertyValues[o]=new Ma(h,void 0),y=this.defaultTransitionablePropertyValues[o]=new Ju(h);this.defaultTransitioningPropertyValues[o]=y.untransitioned(),this.defaultPossiblyEvaluatedValues[o]=p.possiblyEvaluate({})}}}St("DataDrivenProperty",qt),St("DataConstantProperty",Ot),St("CrossFadedDataDrivenProperty",gc),St("CrossFadedProperty",Qu),St("ColorRampProperty",eh);const pf="-transition";class ys extends X{constructor(n,o){if(super(),this.id=n.id,this.type=n.type,this._featureFilter={filter:()=>!0,needGeometry:!1},n.type!=="custom"&&(this.metadata=n.metadata,this.minzoom=n.minzoom,this.maxzoom=n.maxzoom,n.type!=="background"&&(this.source=n.source,this.sourceLayer=n["source-layer"],this.filter=n.filter),o.layout&&(this._unevaluatedLayout=new ff(o.layout)),o.paint)){this._transitionablePaint=new pc(o.paint);for(const h in n.paint)this.setPaintProperty(h,n.paint[h],{validate:!1});for(const h in n.layout)this.setLayoutProperty(h,n.layout[h],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new mc(o.paint)}}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(n){return n==="visibility"?this.visibility:this._unevaluatedLayout.getValue(n)}setLayoutProperty(n,o,h={}){o!=null&&this._validate(ju,`layers.${this.id}.layout.${n}`,n,o,h)||(n!=="visibility"?this._unevaluatedLayout.setValue(n,o):this.visibility=o)}getPaintProperty(n){return n.endsWith(pf)?this._transitionablePaint.getTransition(n.slice(0,-11)):this._transitionablePaint.getValue(n)}setPaintProperty(n,o,h={}){if(o!=null&&this._validate(rg,`layers.${this.id}.paint.${n}`,n,o,h))return!1;if(n.endsWith(pf))return this._transitionablePaint.setTransition(n.slice(0,-11),o||void 0),!1;{const p=this._transitionablePaint._values[n],y=p.property.specification["property-type"]==="cross-faded-data-driven",x=p.value.isDataDriven(),S=p.value;this._transitionablePaint.setValue(n,o),this._handleSpecialPaintPropertyUpdate(n);const I=this._transitionablePaint._values[n].value;return I.isDataDriven()||x||y||this._handleOverridablePaintPropertyUpdate(n,S,I)}}_handleSpecialPaintPropertyUpdate(n){}_handleOverridablePaintPropertyUpdate(n,o,h){return!1}isHidden(n){return!!(this.minzoom&&n<this.minzoom)||!!(this.maxzoom&&n>=this.maxzoom)||this.visibility==="none"}updateTransitions(n){this._transitioningPaint=this._transitionablePaint.transitioned(n,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(n,o){n.getCrossfadeParameters&&(this._crossfadeParameters=n.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(n,void 0,o)),this.paint=this._transitioningPaint.possiblyEvaluate(n,void 0,o)}serialize(){const n={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(n.layout=n.layout||{},n.layout.visibility=this.visibility),Oe(n,(o,h)=>!(o===void 0||h==="layout"&&!Object.keys(o).length||h==="paint"&&!Object.keys(o).length))}_validate(n,o,h,p,y={}){return(!y||y.validate!==!1)&&sf(this,n.call(dl,{key:o,layerType:this.type,objectKey:h,value:p,styleSpec:U,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const n in this.paint._values){const o=this.paint.get(n);if(o instanceof ns&&co(o.property.specification)&&(o.value.kind==="source"||o.value.kind==="composite")&&o.value.isStateDependent)return!0}return!1}}const og={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class fo{constructor(n,o){this._structArray=n,this._pos1=o*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class ii{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(n,o){return n._trim(),o&&(n.isTransferred=!0,o.push(n.arrayBuffer)),{length:n.length,arrayBuffer:n.arrayBuffer}}static deserialize(n){const o=Object.create(this.prototype);return o.arrayBuffer=n.arrayBuffer,o.length=n.length,o.capacity=n.arrayBuffer.byteLength/o.bytesPerElement,o._refreshViews(),o}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(n){this.reserve(n),this.length=n}reserve(n){if(n>this.capacity){this.capacity=Math.max(n,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const o=this.uint8;this._refreshViews(),o&&this.uint8.set(o)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function _i(s,n=1){let o=0,h=0;return{members:s.map(p=>{const y=og[p.type].BYTES_PER_ELEMENT,x=o=Ps(o,Math.max(n,y)),S=p.components||1;return h=Math.max(h,y),o+=y*S,{name:p.name,type:p.type,components:S,offset:x}}),size:Ps(o,Math.max(h,n)),alignment:n}}function Ps(s,n){return Math.ceil(s/n)*n}class po extends ii{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,o){const h=this.length;return this.resize(h+1),this.emplace(h,n,o)}emplace(n,o,h){const p=2*n;return this.int16[p+0]=o,this.int16[p+1]=h,n}}po.prototype.bytesPerElement=4,St("StructArrayLayout2i4",po);class mo extends ii{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,o,h){const p=this.length;return this.resize(p+1),this.emplace(p,n,o,h)}emplace(n,o,h,p){const y=3*n;return this.int16[y+0]=o,this.int16[y+1]=h,this.int16[y+2]=p,n}}mo.prototype.bytesPerElement=6,St("StructArrayLayout3i6",mo);class _c extends ii{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,o,h,p){const y=this.length;return this.resize(y+1),this.emplace(y,n,o,h,p)}emplace(n,o,h,p,y){const x=4*n;return this.int16[x+0]=o,this.int16[x+1]=h,this.int16[x+2]=p,this.int16[x+3]=y,n}}_c.prototype.bytesPerElement=8,St("StructArrayLayout4i8",_c);class ml extends ii{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,o,h,p,y,x){const S=this.length;return this.resize(S+1),this.emplace(S,n,o,h,p,y,x)}emplace(n,o,h,p,y,x,S){const I=6*n;return this.int16[I+0]=o,this.int16[I+1]=h,this.int16[I+2]=p,this.int16[I+3]=y,this.int16[I+4]=x,this.int16[I+5]=S,n}}ml.prototype.bytesPerElement=12,St("StructArrayLayout2i4i12",ml);class th extends ii{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,o,h,p,y,x){const S=this.length;return this.resize(S+1),this.emplace(S,n,o,h,p,y,x)}emplace(n,o,h,p,y,x,S){const I=4*n,P=8*n;return this.int16[I+0]=o,this.int16[I+1]=h,this.uint8[P+4]=p,this.uint8[P+5]=y,this.uint8[P+6]=x,this.uint8[P+7]=S,n}}th.prototype.bytesPerElement=8,St("StructArrayLayout2i4ub8",th);class ta extends ii{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,o){const h=this.length;return this.resize(h+1),this.emplace(h,n,o)}emplace(n,o,h){const p=2*n;return this.float32[p+0]=o,this.float32[p+1]=h,n}}ta.prototype.bytesPerElement=8,St("StructArrayLayout2f8",ta);class Da extends ii{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,o,h,p,y,x,S,I,P,L){const B=this.length;return this.resize(B+1),this.emplace(B,n,o,h,p,y,x,S,I,P,L)}emplace(n,o,h,p,y,x,S,I,P,L,B){const N=10*n;return this.uint16[N+0]=o,this.uint16[N+1]=h,this.uint16[N+2]=p,this.uint16[N+3]=y,this.uint16[N+4]=x,this.uint16[N+5]=S,this.uint16[N+6]=I,this.uint16[N+7]=P,this.uint16[N+8]=L,this.uint16[N+9]=B,n}}Da.prototype.bytesPerElement=20,St("StructArrayLayout10ui20",Da);class nh extends ii{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,o,h,p,y,x,S,I,P,L,B,N){const q=this.length;return this.resize(q+1),this.emplace(q,n,o,h,p,y,x,S,I,P,L,B,N)}emplace(n,o,h,p,y,x,S,I,P,L,B,N,q){const H=12*n;return this.int16[H+0]=o,this.int16[H+1]=h,this.int16[H+2]=p,this.int16[H+3]=y,this.uint16[H+4]=x,this.uint16[H+5]=S,this.uint16[H+6]=I,this.uint16[H+7]=P,this.int16[H+8]=L,this.int16[H+9]=B,this.int16[H+10]=N,this.int16[H+11]=q,n}}nh.prototype.bytesPerElement=24,St("StructArrayLayout4i4ui4i24",nh);class yc extends ii{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,o,h){const p=this.length;return this.resize(p+1),this.emplace(p,n,o,h)}emplace(n,o,h,p){const y=3*n;return this.float32[y+0]=o,this.float32[y+1]=h,this.float32[y+2]=p,n}}yc.prototype.bytesPerElement=12,St("StructArrayLayout3f12",yc);class La extends ii{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(n){const o=this.length;return this.resize(o+1),this.emplace(o,n)}emplace(n,o){return this.uint32[1*n+0]=o,n}}La.prototype.bytesPerElement=4,St("StructArrayLayout1ul4",La);class ih extends ii{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,o,h,p,y,x,S,I,P){const L=this.length;return this.resize(L+1),this.emplace(L,n,o,h,p,y,x,S,I,P)}emplace(n,o,h,p,y,x,S,I,P,L){const B=10*n,N=5*n;return this.int16[B+0]=o,this.int16[B+1]=h,this.int16[B+2]=p,this.int16[B+3]=y,this.int16[B+4]=x,this.int16[B+5]=S,this.uint32[N+3]=I,this.uint16[B+8]=P,this.uint16[B+9]=L,n}}ih.prototype.bytesPerElement=20,St("StructArrayLayout6i1ul2ui20",ih);class rh extends ii{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,o,h,p,y,x){const S=this.length;return this.resize(S+1),this.emplace(S,n,o,h,p,y,x)}emplace(n,o,h,p,y,x,S){const I=6*n;return this.int16[I+0]=o,this.int16[I+1]=h,this.int16[I+2]=p,this.int16[I+3]=y,this.int16[I+4]=x,this.int16[I+5]=S,n}}rh.prototype.bytesPerElement=12,St("StructArrayLayout2i2i2i12",rh);class vc extends ii{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,o,h,p,y){const x=this.length;return this.resize(x+1),this.emplace(x,n,o,h,p,y)}emplace(n,o,h,p,y,x){const S=4*n,I=8*n;return this.float32[S+0]=o,this.float32[S+1]=h,this.float32[S+2]=p,this.int16[I+6]=y,this.int16[I+7]=x,n}}vc.prototype.bytesPerElement=16,St("StructArrayLayout2f1f2i16",vc);class sh extends ii{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,o,h,p){const y=this.length;return this.resize(y+1),this.emplace(y,n,o,h,p)}emplace(n,o,h,p,y){const x=12*n,S=3*n;return this.uint8[x+0]=o,this.uint8[x+1]=h,this.float32[S+1]=p,this.float32[S+2]=y,n}}sh.prototype.bytesPerElement=12,St("StructArrayLayout2ub2f12",sh);class xc extends ii{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,o,h){const p=this.length;return this.resize(p+1),this.emplace(p,n,o,h)}emplace(n,o,h,p){const y=3*n;return this.uint16[y+0]=o,this.uint16[y+1]=h,this.uint16[y+2]=p,n}}xc.prototype.bytesPerElement=6,St("StructArrayLayout3ui6",xc);class Tn extends ii{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,o,h,p,y,x,S,I,P,L,B,N,q,H,ee,ie,ce){const Ee=this.length;return this.resize(Ee+1),this.emplace(Ee,n,o,h,p,y,x,S,I,P,L,B,N,q,H,ee,ie,ce)}emplace(n,o,h,p,y,x,S,I,P,L,B,N,q,H,ee,ie,ce,Ee){const me=24*n,Ae=12*n,ze=48*n;return this.int16[me+0]=o,this.int16[me+1]=h,this.uint16[me+2]=p,this.uint16[me+3]=y,this.uint32[Ae+2]=x,this.uint32[Ae+3]=S,this.uint32[Ae+4]=I,this.uint16[me+10]=P,this.uint16[me+11]=L,this.uint16[me+12]=B,this.float32[Ae+7]=N,this.float32[Ae+8]=q,this.uint8[ze+36]=H,this.uint8[ze+37]=ee,this.uint8[ze+38]=ie,this.uint32[Ae+10]=ce,this.int16[me+22]=Ee,n}}Tn.prototype.bytesPerElement=48,St("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",Tn);class _ extends ii{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,o,h,p,y,x,S,I,P,L,B,N,q,H,ee,ie,ce,Ee,me,Ae,ze,Ye,wt,Dt,xt,vt,mt,Tt){const gt=this.length;return this.resize(gt+1),this.emplace(gt,n,o,h,p,y,x,S,I,P,L,B,N,q,H,ee,ie,ce,Ee,me,Ae,ze,Ye,wt,Dt,xt,vt,mt,Tt)}emplace(n,o,h,p,y,x,S,I,P,L,B,N,q,H,ee,ie,ce,Ee,me,Ae,ze,Ye,wt,Dt,xt,vt,mt,Tt,gt){const lt=32*n,Vt=16*n;return this.int16[lt+0]=o,this.int16[lt+1]=h,this.int16[lt+2]=p,this.int16[lt+3]=y,this.int16[lt+4]=x,this.int16[lt+5]=S,this.int16[lt+6]=I,this.int16[lt+7]=P,this.uint16[lt+8]=L,this.uint16[lt+9]=B,this.uint16[lt+10]=N,this.uint16[lt+11]=q,this.uint16[lt+12]=H,this.uint16[lt+13]=ee,this.uint16[lt+14]=ie,this.uint16[lt+15]=ce,this.uint16[lt+16]=Ee,this.uint16[lt+17]=me,this.uint16[lt+18]=Ae,this.uint16[lt+19]=ze,this.uint16[lt+20]=Ye,this.uint16[lt+21]=wt,this.uint16[lt+22]=Dt,this.uint32[Vt+12]=xt,this.float32[Vt+13]=vt,this.float32[Vt+14]=mt,this.uint16[lt+30]=Tt,this.uint16[lt+31]=gt,n}}_.prototype.bytesPerElement=64,St("StructArrayLayout8i15ui1ul2f2ui64",_);class r extends ii{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n){const o=this.length;return this.resize(o+1),this.emplace(o,n)}emplace(n,o){return this.float32[1*n+0]=o,n}}r.prototype.bytesPerElement=4,St("StructArrayLayout1f4",r);class u extends ii{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,o,h){const p=this.length;return this.resize(p+1),this.emplace(p,n,o,h)}emplace(n,o,h,p){const y=3*n;return this.uint16[6*n+0]=o,this.float32[y+1]=h,this.float32[y+2]=p,n}}u.prototype.bytesPerElement=12,St("StructArrayLayout1ui2f12",u);class f extends ii{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,o,h){const p=this.length;return this.resize(p+1),this.emplace(p,n,o,h)}emplace(n,o,h,p){const y=4*n;return this.uint32[2*n+0]=o,this.uint16[y+2]=h,this.uint16[y+3]=p,n}}f.prototype.bytesPerElement=8,St("StructArrayLayout1ul2ui8",f);class g extends ii{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,o){const h=this.length;return this.resize(h+1),this.emplace(h,n,o)}emplace(n,o,h){const p=2*n;return this.uint16[p+0]=o,this.uint16[p+1]=h,n}}g.prototype.bytesPerElement=4,St("StructArrayLayout2ui4",g);class v extends ii{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n){const o=this.length;return this.resize(o+1),this.emplace(o,n)}emplace(n,o){return this.uint16[1*n+0]=o,n}}v.prototype.bytesPerElement=2,St("StructArrayLayout1ui2",v);class E extends ii{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,o,h,p){const y=this.length;return this.resize(y+1),this.emplace(y,n,o,h,p)}emplace(n,o,h,p,y){const x=4*n;return this.float32[x+0]=o,this.float32[x+1]=h,this.float32[x+2]=p,this.float32[x+3]=y,n}}E.prototype.bytesPerElement=16,St("StructArrayLayout4f16",E);class T extends fo{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new k(this.anchorPointX,this.anchorPointY)}}T.prototype.size=20;class A extends ih{get(n){return new T(this,n)}}St("CollisionBoxArray",A);class R extends fo{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(n){this._structArray.uint8[this._pos1+37]=n}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(n){this._structArray.uint8[this._pos1+38]=n}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(n){this._structArray.uint32[this._pos4+10]=n}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}R.prototype.size=48;class D extends Tn{get(n){return new R(this,n)}}St("PlacedSymbolArray",D);class z extends fo{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(n){this._structArray.uint32[this._pos4+12]=n}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+14]}get textAnchorOffsetStartIndex(){return this._structArray.uint16[this._pos2+30]}get textAnchorOffsetEndIndex(){return this._structArray.uint16[this._pos2+31]}}z.prototype.size=64;class G extends _{get(n){return new z(this,n)}}St("SymbolInstanceArray",G);class Q extends r{getoffsetX(n){return this.float32[1*n+0]}}St("GlyphOffsetArray",Q);class J extends mo{getx(n){return this.int16[3*n+0]}gety(n){return this.int16[3*n+1]}gettileUnitDistanceFromAnchor(n){return this.int16[3*n+2]}}St("SymbolLineVertexArray",J);class te extends fo{get textAnchor(){return this._structArray.uint16[this._pos2+0]}get textOffset0(){return this._structArray.float32[this._pos4+1]}get textOffset1(){return this._structArray.float32[this._pos4+2]}}te.prototype.size=12;class K extends u{get(n){return new te(this,n)}}St("TextAnchorOffsetArray",K);class ve extends fo{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}ve.prototype.size=8;class Me extends f{get(n){return new ve(this,n)}}St("FeatureIndexArray",Me);class se extends po{}class we extends po{}class Ne extends po{}class $e extends ml{}class We extends th{}class ot extends ta{}class Je extends Da{}class dt extends nh{}class Mt extends yc{}class cn extends La{}class _t extends rh{}class Ht extends sh{}class Ct extends xc{}class Fn extends g{}const sn=_i([{name:"a_pos",components:2,type:"Int16"}],4),{members:nn}=sn;class Zt{constructor(n=[]){this.segments=n}prepareSegment(n,o,h,p){let y=this.segments[this.segments.length-1];return n>Zt.MAX_VERTEX_ARRAY_LENGTH&&Z(`Max vertices per segment is ${Zt.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${n}`),(!y||y.vertexLength+n>Zt.MAX_VERTEX_ARRAY_LENGTH||y.sortKey!==p)&&(y={vertexOffset:o.length,primitiveOffset:h.length,vertexLength:0,primitiveLength:0},p!==void 0&&(y.sortKey=p),this.segments.push(y)),y}get(){return this.segments}destroy(){for(const n of this.segments)for(const o in n.vaos)n.vaos[o].destroy()}static simpleSegment(n,o,h,p){return new Zt([{vertexOffset:n,primitiveOffset:o,vertexLength:h,primitiveLength:p,vaos:{},sortKey:0}])}}function oi(s,n){return 256*(s=he(Math.floor(s),0,255))+he(Math.floor(n),0,255)}Zt.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,St("SegmentVector",Zt);const Rn=_i([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]);var ir={exports:{}},Li={exports:{}};Li.exports=function(s,n){var o,h,p,y,x,S,I,P;for(h=s.length-(o=3&s.length),p=n,x=3432918353,S=461845907,P=0;P<h;)I=255&s.charCodeAt(P)|(255&s.charCodeAt(++P))<<8|(255&s.charCodeAt(++P))<<16|(255&s.charCodeAt(++P))<<24,++P,p=27492+(65535&(y=5*(65535&(p=(p^=I=(65535&(I=(I=(65535&I)*x+(((I>>>16)*x&65535)<<16)&4294967295)<<15|I>>>17))*S+(((I>>>16)*S&65535)<<16)&4294967295)<<13|p>>>19))+((5*(p>>>16)&65535)<<16)&4294967295))+((58964+(y>>>16)&65535)<<16);switch(I=0,o){case 3:I^=(255&s.charCodeAt(P+2))<<16;case 2:I^=(255&s.charCodeAt(P+1))<<8;case 1:p^=I=(65535&(I=(I=(65535&(I^=255&s.charCodeAt(P)))*x+(((I>>>16)*x&65535)<<16)&4294967295)<<15|I>>>17))*S+(((I>>>16)*S&65535)<<16)&4294967295}return p^=s.length,p=2246822507*(65535&(p^=p>>>16))+((2246822507*(p>>>16)&65535)<<16)&4294967295,p=3266489909*(65535&(p^=p>>>13))+((3266489909*(p>>>16)&65535)<<16)&4294967295,(p^=p>>>16)>>>0};var yi=Li.exports,pr={exports:{}};pr.exports=function(s,n){for(var o,h=s.length,p=n^h,y=0;h>=4;)o=1540483477*(65535&(o=255&s.charCodeAt(y)|(255&s.charCodeAt(++y))<<8|(255&s.charCodeAt(++y))<<16|(255&s.charCodeAt(++y))<<24))+((1540483477*(o>>>16)&65535)<<16),p=1540483477*(65535&p)+((1540483477*(p>>>16)&65535)<<16)^(o=1540483477*(65535&(o^=o>>>24))+((1540483477*(o>>>16)&65535)<<16)),h-=4,++y;switch(h){case 3:p^=(255&s.charCodeAt(y+2))<<16;case 2:p^=(255&s.charCodeAt(y+1))<<8;case 1:p=1540483477*(65535&(p^=255&s.charCodeAt(y)))+((1540483477*(p>>>16)&65535)<<16)}return p=1540483477*(65535&(p^=p>>>13))+((1540483477*(p>>>16)&65535)<<16),(p^=p>>>15)>>>0};var is=yi,Rs=pr.exports;ir.exports=is,ir.exports.murmur3=is,ir.exports.murmur2=Rs;var Ms=b(ir.exports);class na{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(n,o,h,p){this.ids.push(za(n)),this.positions.push(o,h,p)}getPositions(n){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");const o=za(n);let h=0,p=this.ids.length-1;for(;h<p;){const x=h+p>>1;this.ids[x]>=o?p=x:h=x+1}const y=[];for(;this.ids[h]===o;)y.push({index:this.positions[3*h],start:this.positions[3*h+1],end:this.positions[3*h+2]}),h++;return y}static serialize(n,o){const h=new Float64Array(n.ids),p=new Uint32Array(n.positions);return ia(h,p,0,h.length-1),o&&o.push(h.buffer,p.buffer),{ids:h,positions:p}}static deserialize(n){const o=new na;return o.ids=n.ids,o.positions=n.positions,o.indexed=!0,o}}function za(s){const n=+s;return!isNaN(n)&&n<=Number.MAX_SAFE_INTEGER?n:Ms(String(s))}function ia(s,n,o,h){for(;o<h;){const p=s[o+h>>1];let y=o-1,x=h+1;for(;;){do y++;while(s[y]<p);do x--;while(s[x]>p);if(y>=x)break;zi(s,y,x),zi(n,3*y,3*x),zi(n,3*y+1,3*x+1),zi(n,3*y+2,3*x+2)}x-o<h-x?(ia(s,n,o,x),o=x+1):(ia(s,n,x+1,h),h=x)}}function zi(s,n,o){const h=s[n];s[n]=s[o],s[o]=h}St("FeaturePositionMap",na);class li{constructor(n,o){this.gl=n.gl,this.location=o}}class Oi extends li{constructor(n,o){super(n,o),this.current=0}set(n){this.current!==n&&(this.current=n,this.gl.uniform1f(this.location,n))}}class go extends li{constructor(n,o){super(n,o),this.current=[0,0,0,0]}set(n){n[0]===this.current[0]&&n[1]===this.current[1]&&n[2]===this.current[2]&&n[3]===this.current[3]||(this.current=n,this.gl.uniform4f(this.location,n[0],n[1],n[2],n[3]))}}class wi extends li{constructor(n,o){super(n,o),this.current=Yt.transparent}set(n){n.r===this.current.r&&n.g===this.current.g&&n.b===this.current.b&&n.a===this.current.a||(this.current=n,this.gl.uniform4f(this.location,n.r,n.g,n.b,n.a))}}const Bi=new Float32Array(16);function mr(s){return[oi(255*s.r,255*s.g),oi(255*s.b,255*s.a)]}class ri{constructor(n,o,h){this.value=n,this.uniformNames=o.map(p=>`u_${p}`),this.type=h}setUniform(n,o,h){n.set(h.constantOr(this.value))}getBinding(n,o,h){return this.type==="color"?new wi(n,o):new Oi(n,o)}}class _o{constructor(n,o){this.uniformNames=o.map(h=>`u_${h}`),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(n,o){this.pixelRatioFrom=o.pixelRatio,this.pixelRatioTo=n.pixelRatio,this.patternFrom=o.tlbr,this.patternTo=n.tlbr}setUniform(n,o,h,p){const y=p==="u_pattern_to"?this.patternTo:p==="u_pattern_from"?this.patternFrom:p==="u_pixel_ratio_to"?this.pixelRatioTo:p==="u_pixel_ratio_from"?this.pixelRatioFrom:null;y&&n.set(y)}getBinding(n,o,h){return h.substr(0,9)==="u_pattern"?new go(n,o):new Oi(n,o)}}class Ds{constructor(n,o,h,p){this.expression=n,this.type=h,this.maxValue=0,this.paintVertexAttributes=o.map(y=>({name:`a_${y}`,type:"Float32",components:h==="color"?2:1,offset:0})),this.paintVertexArray=new p}populatePaintArray(n,o,h,p,y){const x=this.paintVertexArray.length,S=this.expression.evaluate(new Zn(0),o,{},p,[],y);this.paintVertexArray.resize(n),this._setPaintValue(x,n,S)}updatePaintArray(n,o,h,p){const y=this.expression.evaluate({zoom:0},h,p);this._setPaintValue(n,o,y)}_setPaintValue(n,o,h){if(this.type==="color"){const p=mr(h);for(let y=n;y<o;y++)this.paintVertexArray.emplace(y,p[0],p[1])}else{for(let p=n;p<o;p++)this.paintVertexArray.emplace(p,h);this.maxValue=Math.max(this.maxValue,Math.abs(h))}}upload(n){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=n.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class rs{constructor(n,o,h,p,y,x){this.expression=n,this.uniformNames=o.map(S=>`u_${S}_t`),this.type=h,this.useIntegerZoom=p,this.zoom=y,this.maxValue=0,this.paintVertexAttributes=o.map(S=>({name:`a_${S}`,type:"Float32",components:h==="color"?4:2,offset:0})),this.paintVertexArray=new x}populatePaintArray(n,o,h,p,y){const x=this.expression.evaluate(new Zn(this.zoom),o,{},p,[],y),S=this.expression.evaluate(new Zn(this.zoom+1),o,{},p,[],y),I=this.paintVertexArray.length;this.paintVertexArray.resize(n),this._setPaintValue(I,n,x,S)}updatePaintArray(n,o,h,p){const y=this.expression.evaluate({zoom:this.zoom},h,p),x=this.expression.evaluate({zoom:this.zoom+1},h,p);this._setPaintValue(n,o,y,x)}_setPaintValue(n,o,h,p){if(this.type==="color"){const y=mr(h),x=mr(p);for(let S=n;S<o;S++)this.paintVertexArray.emplace(S,y[0],y[1],x[0],x[1])}else{for(let y=n;y<o;y++)this.paintVertexArray.emplace(y,h,p);this.maxValue=Math.max(this.maxValue,Math.abs(h),Math.abs(p))}}upload(n){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=n.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(n,o){const h=this.useIntegerZoom?Math.floor(o.zoom):o.zoom,p=he(this.expression.interpolationFactor(h,this.zoom,this.zoom+1),0,1);n.set(p)}getBinding(n,o,h){return new Oi(n,o)}}class ra{constructor(n,o,h,p,y,x){this.expression=n,this.type=o,this.useIntegerZoom=h,this.zoom=p,this.layerId=x,this.zoomInPaintVertexArray=new y,this.zoomOutPaintVertexArray=new y}populatePaintArray(n,o,h){const p=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(n),this.zoomOutPaintVertexArray.resize(n),this._setPaintValues(p,n,o.patterns&&o.patterns[this.layerId],h)}updatePaintArray(n,o,h,p,y){this._setPaintValues(n,o,h.patterns&&h.patterns[this.layerId],y)}_setPaintValues(n,o,h,p){if(!p||!h)return;const{min:y,mid:x,max:S}=h,I=p[y],P=p[x],L=p[S];if(I&&P&&L)for(let B=n;B<o;B++)this.zoomInPaintVertexArray.emplace(B,P.tl[0],P.tl[1],P.br[0],P.br[1],I.tl[0],I.tl[1],I.br[0],I.br[1],P.pixelRatio,I.pixelRatio),this.zoomOutPaintVertexArray.emplace(B,P.tl[0],P.tl[1],P.br[0],P.br[1],L.tl[0],L.tl[1],L.br[0],L.br[1],P.pixelRatio,L.pixelRatio)}upload(n){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=n.createVertexBuffer(this.zoomInPaintVertexArray,Rn.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=n.createVertexBuffer(this.zoomOutPaintVertexArray,Rn.members,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class mf{constructor(n,o,h){this.binders={},this._buffers=[];const p=[];for(const y in n.paint._values){if(!h(y))continue;const x=n.paint.get(y);if(!(x instanceof ns&&co(x.property.specification)))continue;const S=yo(y,n.type),I=x.value,P=x.property.specification.type,L=x.property.useIntegerZoom,B=x.property.specification["property-type"],N=B==="cross-faded"||B==="cross-faded-data-driven";if(I.kind==="constant")this.binders[y]=N?new _o(I.value,S):new ri(I.value,S,P),p.push(`/u_${y}`);else if(I.kind==="source"||N){const q=ah(y,P,"source");this.binders[y]=N?new ra(I,P,L,o,q,n.id):new Ds(I,S,P,q),p.push(`/a_${y}`)}else{const q=ah(y,P,"composite");this.binders[y]=new rs(I,S,P,L,o,q),p.push(`/z_${y}`)}}this.cacheKey=p.sort().join("")}getMaxValue(n){const o=this.binders[n];return o instanceof Ds||o instanceof rs?o.maxValue:0}populatePaintArrays(n,o,h,p,y){for(const x in this.binders){const S=this.binders[x];(S instanceof Ds||S instanceof rs||S instanceof ra)&&S.populatePaintArray(n,o,h,p,y)}}setConstantPatternPositions(n,o){for(const h in this.binders){const p=this.binders[h];p instanceof _o&&p.setConstantPatternPositions(n,o)}}updatePaintArrays(n,o,h,p,y){let x=!1;for(const S in n){const I=o.getPositions(S);for(const P of I){const L=h.feature(P.index);for(const B in this.binders){const N=this.binders[B];if((N instanceof Ds||N instanceof rs||N instanceof ra)&&N.expression.isStateDependent===!0){const q=p.paint.get(B);N.expression=q.value,N.updatePaintArray(P.start,P.end,L,n[S],y),x=!0}}}}return x}defines(){const n=[];for(const o in this.binders){const h=this.binders[o];(h instanceof ri||h instanceof _o)&&n.push(...h.uniformNames.map(p=>`#define HAS_UNIFORM_${p}`))}return n}getBinderAttributes(){const n=[];for(const o in this.binders){const h=this.binders[o];if(h instanceof Ds||h instanceof rs)for(let p=0;p<h.paintVertexAttributes.length;p++)n.push(h.paintVertexAttributes[p].name);else if(h instanceof ra)for(let p=0;p<Rn.members.length;p++)n.push(Rn.members[p].name)}return n}getBinderUniforms(){const n=[];for(const o in this.binders){const h=this.binders[o];if(h instanceof ri||h instanceof _o||h instanceof rs)for(const p of h.uniformNames)n.push(p)}return n}getPaintVertexBuffers(){return this._buffers}getUniforms(n,o){const h=[];for(const p in this.binders){const y=this.binders[p];if(y instanceof ri||y instanceof _o||y instanceof rs){for(const x of y.uniformNames)if(o[x]){const S=y.getBinding(n,o[x],x);h.push({name:x,property:p,binding:S})}}}return h}setUniforms(n,o,h,p){for(const{name:y,property:x,binding:S}of o)this.binders[x].setUniform(S,p,h.get(x),y)}updatePaintBuffers(n){this._buffers=[];for(const o in this.binders){const h=this.binders[o];if(n&&h instanceof ra){const p=n.fromScale===2?h.zoomInPaintVertexBuffer:h.zoomOutPaintVertexBuffer;p&&this._buffers.push(p)}else(h instanceof Ds||h instanceof rs)&&h.paintVertexBuffer&&this._buffers.push(h.paintVertexBuffer)}}upload(n){for(const o in this.binders){const h=this.binders[o];(h instanceof Ds||h instanceof rs||h instanceof ra)&&h.upload(n)}this.updatePaintBuffers()}destroy(){for(const n in this.binders){const o=this.binders[n];(o instanceof Ds||o instanceof rs||o instanceof ra)&&o.destroy()}}}class Oa{constructor(n,o,h=()=>!0){this.programConfigurations={};for(const p of n)this.programConfigurations[p.id]=new mf(p,o,h);this.needsUpload=!1,this._featureMap=new na,this._bufferOffset=0}populatePaintArrays(n,o,h,p,y,x){for(const S in this.programConfigurations)this.programConfigurations[S].populatePaintArrays(n,o,p,y,x);o.id!==void 0&&this._featureMap.add(o.id,h,this._bufferOffset,n),this._bufferOffset=n,this.needsUpload=!0}updatePaintArrays(n,o,h,p){for(const y of h)this.needsUpload=this.programConfigurations[y.id].updatePaintArrays(n,this._featureMap,o,y,p)||this.needsUpload}get(n){return this.programConfigurations[n]}upload(n){if(this.needsUpload){for(const o in this.programConfigurations)this.programConfigurations[o].upload(n);this.needsUpload=!1}}destroy(){for(const n in this.programConfigurations)this.programConfigurations[n].destroy()}}function yo(s,n){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[s]||[s.replace(`${n}-`,"").replace(/-/g,"_")]}function ah(s,n,o){const h={color:{source:ta,composite:E},number:{source:r,composite:ta}},p=function(y){return{"line-pattern":{source:Je,composite:Je},"fill-pattern":{source:Je,composite:Je},"fill-extrusion-pattern":{source:Je,composite:Je}}[y]}(s);return p&&p[o]||h[n][o]}St("ConstantBinder",ri),St("CrossFadedConstantBinder",_o),St("SourceExpressionBinder",Ds),St("CrossFadedCompositeBinder",ra),St("CompositeExpressionBinder",rs),St("ProgramConfiguration",mf,{omit:["_buffers"]}),St("ProgramConfigurationSet",Oa);const si=8192,bc=Math.pow(2,14)-1,wc=-bc-1;function sa(s){const n=si/s.extent,o=s.loadGeometry();for(let h=0;h<o.length;h++){const p=o[h];for(let y=0;y<p.length;y++){const x=p[y],S=Math.round(x.x*n),I=Math.round(x.y*n);x.x=he(S,wc,bc),x.y=he(I,wc,bc),(S<x.x||S>x.x+1||I<x.y||I>x.y+1)&&Z("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return o}function Ls(s,n){return{type:s.type,id:s.id,properties:s.properties,geometry:n?sa(s):[]}}function gf(s,n,o,h,p){s.emplaceBack(2*n+(h+1)/2,2*o+(p+1)/2)}class lg{constructor(n){this.zoom=n.zoom,this.overscaling=n.overscaling,this.layers=n.layers,this.layerIds=this.layers.map(o=>o.id),this.index=n.index,this.hasPattern=!1,this.layoutVertexArray=new we,this.indexArray=new Ct,this.segments=new Zt,this.programConfigurations=new Oa(n.layers,n.zoom),this.stateDependentLayerIds=this.layers.filter(o=>o.isStateDependent()).map(o=>o.id)}populate(n,o,h){const p=this.layers[0],y=[];let x=null,S=!1;p.type==="circle"&&(x=p.layout.get("circle-sort-key"),S=!x.isConstant());for(const{feature:I,id:P,index:L,sourceLayerIndex:B}of n){const N=this.layers[0]._featureFilter.needGeometry,q=Ls(I,N);if(!this.layers[0]._featureFilter.filter(new Zn(this.zoom),q,h))continue;const H=S?x.evaluate(q,{},h):void 0,ee={id:P,properties:I.properties,type:I.type,sourceLayerIndex:B,index:L,geometry:N?q.geometry:sa(I),patterns:{},sortKey:H};y.push(ee)}S&&y.sort((I,P)=>I.sortKey-P.sortKey);for(const I of y){const{geometry:P,index:L,sourceLayerIndex:B}=I,N=n[L].feature;this.addFeature(I,P,L,h),o.featureIndex.insert(N,P,L,B,this.index)}}update(n,o,h){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(n,o,this.stateDependentLayers,h)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(n){this.uploaded||(this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,nn),this.indexBuffer=n.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(n),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(n,o,h,p){for(const y of o)for(const x of y){const S=x.x,I=x.y;if(S<0||S>=si||I<0||I>=si)continue;const P=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,n.sortKey),L=P.vertexLength;gf(this.layoutVertexArray,S,I,-1,-1),gf(this.layoutVertexArray,S,I,1,-1),gf(this.layoutVertexArray,S,I,1,1),gf(this.layoutVertexArray,S,I,-1,1),this.indexArray.emplaceBack(L,L+1,L+2),this.indexArray.emplaceBack(L,L+3,L+2),P.vertexLength+=4,P.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,n,h,{},p)}}function v0(s,n){for(let o=0;o<s.length;o++)if(Sc(n,s[o]))return!0;for(let o=0;o<n.length;o++)if(Sc(s,n[o]))return!0;return!!cg(s,n)}function gC(s,n,o){return!!Sc(s,n)||!!ug(n,s,o)}function x0(s,n){if(s.length===1)return w0(n,s[0]);for(let o=0;o<n.length;o++){const h=n[o];for(let p=0;p<h.length;p++)if(Sc(s,h[p]))return!0}for(let o=0;o<s.length;o++)if(w0(n,s[o]))return!0;for(let o=0;o<n.length;o++)if(cg(s,n[o]))return!0;return!1}function _C(s,n,o){if(s.length>1){if(cg(s,n))return!0;for(let h=0;h<n.length;h++)if(ug(n[h],s,o))return!0}for(let h=0;h<s.length;h++)if(ug(s[h],n,o))return!0;return!1}function cg(s,n){if(s.length===0||n.length===0)return!1;for(let o=0;o<s.length-1;o++){const h=s[o],p=s[o+1];for(let y=0;y<n.length-1;y++)if(yC(h,p,n[y],n[y+1]))return!0}return!1}function yC(s,n,o,h){return ae(s,o,h)!==ae(n,o,h)&&ae(s,n,o)!==ae(s,n,h)}function ug(s,n,o){const h=o*o;if(n.length===1)return s.distSqr(n[0])<h;for(let p=1;p<n.length;p++)if(b0(s,n[p-1],n[p])<h)return!0;return!1}function b0(s,n,o){const h=n.distSqr(o);if(h===0)return s.distSqr(n);const p=((s.x-n.x)*(o.x-n.x)+(s.y-n.y)*(o.y-n.y))/h;return s.distSqr(p<0?n:p>1?o:o.sub(n)._mult(p)._add(n))}function w0(s,n){let o,h,p,y=!1;for(let x=0;x<s.length;x++){o=s[x];for(let S=0,I=o.length-1;S<o.length;I=S++)h=o[S],p=o[I],h.y>n.y!=p.y>n.y&&n.x<(p.x-h.x)*(n.y-h.y)/(p.y-h.y)+h.x&&(y=!y)}return y}function Sc(s,n){let o=!1;for(let h=0,p=s.length-1;h<s.length;p=h++){const y=s[h],x=s[p];y.y>n.y!=x.y>n.y&&n.x<(x.x-y.x)*(n.y-y.y)/(x.y-y.y)+y.x&&(o=!o)}return o}function vC(s,n,o){const h=o[0],p=o[2];if(s.x<h.x&&n.x<h.x||s.x>p.x&&n.x>p.x||s.y<h.y&&n.y<h.y||s.y>p.y&&n.y>p.y)return!1;const y=ae(s,n,o[0]);return y!==ae(s,n,o[1])||y!==ae(s,n,o[2])||y!==ae(s,n,o[3])}function oh(s,n,o){const h=n.paint.get(s).value;return h.kind==="constant"?h.value:o.programConfigurations.get(n.id).getMaxValue(s)}function _f(s){return Math.sqrt(s[0]*s[0]+s[1]*s[1])}function yf(s,n,o,h,p){if(!n[0]&&!n[1])return s;const y=k.convert(n)._mult(p);o==="viewport"&&y._rotate(-h);const x=[];for(let S=0;S<s.length;S++)x.push(s[S].sub(y));return x}let S0,E0;St("CircleBucket",lg,{omit:["layers"]});var xC={get paint(){return E0=E0||new ki({"circle-radius":new qt(U.paint_circle["circle-radius"]),"circle-color":new qt(U.paint_circle["circle-color"]),"circle-blur":new qt(U.paint_circle["circle-blur"]),"circle-opacity":new qt(U.paint_circle["circle-opacity"]),"circle-translate":new Ot(U.paint_circle["circle-translate"]),"circle-translate-anchor":new Ot(U.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Ot(U.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Ot(U.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new qt(U.paint_circle["circle-stroke-width"]),"circle-stroke-color":new qt(U.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new qt(U.paint_circle["circle-stroke-opacity"])})},get layout(){return S0=S0||new ki({"circle-sort-key":new qt(U.layout_circle["circle-sort-key"])})}},gr=1e-6,Ec=typeof Float32Array<"u"?Float32Array:Array;function hg(s){return s[0]=1,s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=1,s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[10]=1,s[11]=0,s[12]=0,s[13]=0,s[14]=0,s[15]=1,s}function T0(s,n,o){var h=n[0],p=n[1],y=n[2],x=n[3],S=n[4],I=n[5],P=n[6],L=n[7],B=n[8],N=n[9],q=n[10],H=n[11],ee=n[12],ie=n[13],ce=n[14],Ee=n[15],me=o[0],Ae=o[1],ze=o[2],Ye=o[3];return s[0]=me*h+Ae*S+ze*B+Ye*ee,s[1]=me*p+Ae*I+ze*N+Ye*ie,s[2]=me*y+Ae*P+ze*q+Ye*ce,s[3]=me*x+Ae*L+ze*H+Ye*Ee,s[4]=(me=o[4])*h+(Ae=o[5])*S+(ze=o[6])*B+(Ye=o[7])*ee,s[5]=me*p+Ae*I+ze*N+Ye*ie,s[6]=me*y+Ae*P+ze*q+Ye*ce,s[7]=me*x+Ae*L+ze*H+Ye*Ee,s[8]=(me=o[8])*h+(Ae=o[9])*S+(ze=o[10])*B+(Ye=o[11])*ee,s[9]=me*p+Ae*I+ze*N+Ye*ie,s[10]=me*y+Ae*P+ze*q+Ye*ce,s[11]=me*x+Ae*L+ze*H+Ye*Ee,s[12]=(me=o[12])*h+(Ae=o[13])*S+(ze=o[14])*B+(Ye=o[15])*ee,s[13]=me*p+Ae*I+ze*N+Ye*ie,s[14]=me*y+Ae*P+ze*q+Ye*ce,s[15]=me*x+Ae*L+ze*H+Ye*Ee,s}Math.hypot||(Math.hypot=function(){for(var s=0,n=arguments.length;n--;)s+=arguments[n]*arguments[n];return Math.sqrt(s)});var lh,bC=T0;function vf(s,n,o){var h=n[0],p=n[1],y=n[2],x=n[3];return s[0]=o[0]*h+o[4]*p+o[8]*y+o[12]*x,s[1]=o[1]*h+o[5]*p+o[9]*y+o[13]*x,s[2]=o[2]*h+o[6]*p+o[10]*y+o[14]*x,s[3]=o[3]*h+o[7]*p+o[11]*y+o[15]*x,s}lh=new Ec(4),Ec!=Float32Array&&(lh[0]=0,lh[1]=0,lh[2]=0,lh[3]=0);class wC extends ys{constructor(n){super(n,xC)}createBucket(n){return new lg(n)}queryRadius(n){const o=n;return oh("circle-radius",this,o)+oh("circle-stroke-width",this,o)+_f(this.paint.get("circle-translate"))}queryIntersectsFeature(n,o,h,p,y,x,S,I){const P=yf(n,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),x.angle,S),L=this.paint.get("circle-radius").evaluate(o,h)+this.paint.get("circle-stroke-width").evaluate(o,h),B=this.paint.get("circle-pitch-alignment")==="map",N=B?P:function(H,ee){return H.map(ie=>C0(ie,ee))}(P,I),q=B?L*S:L;for(const H of p)for(const ee of H){const ie=B?ee:C0(ee,I);let ce=q;const Ee=vf([],[ee.x,ee.y,0,1],I);if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?ce*=Ee[3]/x.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(ce*=x.cameraToCenterDistance/Ee[3]),gC(N,ie,ce))return!0}return!1}}function C0(s,n){const o=vf([],[s.x,s.y,0,1],n);return new k(o[0]/o[3],o[1]/o[3])}class I0 extends lg{}let k0;St("HeatmapBucket",I0,{omit:["layers"]});var SC={get paint(){return k0=k0||new ki({"heatmap-radius":new qt(U.paint_heatmap["heatmap-radius"]),"heatmap-weight":new qt(U.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Ot(U.paint_heatmap["heatmap-intensity"]),"heatmap-color":new eh(U.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Ot(U.paint_heatmap["heatmap-opacity"])})}};function dg(s,{width:n,height:o},h,p){if(p){if(p instanceof Uint8ClampedArray)p=new Uint8Array(p.buffer);else if(p.length!==n*o*h)throw new RangeError(`mismatched image size. expected: ${p.length} but got: ${n*o*h}`)}else p=new Uint8Array(n*o*h);return s.width=n,s.height=o,s.data=p,s}function A0(s,{width:n,height:o},h){if(n===s.width&&o===s.height)return;const p=dg({},{width:n,height:o},h);fg(s,p,{x:0,y:0},{x:0,y:0},{width:Math.min(s.width,n),height:Math.min(s.height,o)},h),s.width=n,s.height=o,s.data=p.data}function fg(s,n,o,h,p,y){if(p.width===0||p.height===0)return n;if(p.width>s.width||p.height>s.height||o.x>s.width-p.width||o.y>s.height-p.height)throw new RangeError("out of range source coordinates for image copy");if(p.width>n.width||p.height>n.height||h.x>n.width-p.width||h.y>n.height-p.height)throw new RangeError("out of range destination coordinates for image copy");const x=s.data,S=n.data;if(x===S)throw new Error("srcData equals dstData, so image is already copied");for(let I=0;I<p.height;I++){const P=((o.y+I)*s.width+o.x)*y,L=((h.y+I)*n.width+h.x)*y;for(let B=0;B<p.width*y;B++)S[L+B]=x[P+B]}return n}class ch{constructor(n,o){dg(this,n,1,o)}resize(n){A0(this,n,1)}clone(){return new ch({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(n,o,h,p,y){fg(n,o,h,p,y,1)}}class ss{constructor(n,o){dg(this,n,4,o)}resize(n){A0(this,n,4)}replace(n,o){o?this.data.set(n):this.data=n instanceof Uint8ClampedArray?new Uint8Array(n.buffer):n}clone(){return new ss({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(n,o,h,p,y){fg(n,o,h,p,y,4)}}function P0(s){const n={},o=s.resolution||256,h=s.clips?s.clips.length:1,p=s.image||new ss({width:o,height:h});if(Math.log(o)/Math.LN2%1!=0)throw new Error(`width is not a power of 2 - ${o}`);const y=(x,S,I)=>{n[s.evaluationKey]=I;const P=s.expression.evaluate(n);p.data[x+S+0]=Math.floor(255*P.r/P.a),p.data[x+S+1]=Math.floor(255*P.g/P.a),p.data[x+S+2]=Math.floor(255*P.b/P.a),p.data[x+S+3]=Math.floor(255*P.a)};if(s.clips)for(let x=0,S=0;x<h;++x,S+=4*o)for(let I=0,P=0;I<o;I++,P+=4){const L=I/(o-1),{start:B,end:N}=s.clips[x];y(S,P,B*(1-L)+N*L)}else for(let x=0,S=0;x<o;x++,S+=4)y(0,S,x/(o-1));return p}St("AlphaImage",ch),St("RGBAImage",ss);class EC extends ys{createBucket(n){return new I0(n)}constructor(n){super(n,SC),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(n){n==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=P0({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(){return 0}queryIntersectsFeature(){return!1}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}}let R0;var TC={get paint(){return R0=R0||new ki({"hillshade-illumination-direction":new Ot(U.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new Ot(U.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Ot(U.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Ot(U.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Ot(U.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Ot(U.paint_hillshade["hillshade-accent-color"])})}};class CC extends ys{constructor(n){super(n,TC)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}}const IC=_i([{name:"a_pos",components:2,type:"Int16"}],4),{members:kC}=IC;var pg={exports:{}};function xf(s,n,o){o=o||2;var h,p,y,x,S,I,P,L=n&&n.length,B=L?n[0]*o:s.length,N=M0(s,0,B,o,!0),q=[];if(!N||N.next===N.prev)return q;if(L&&(N=function(ee,ie,ce,Ee){var me,Ae,ze,Ye=[];for(me=0,Ae=ie.length;me<Ae;me++)(ze=M0(ee,ie[me]*Ee,me<Ae-1?ie[me+1]*Ee:ee.length,Ee,!1))===ze.next&&(ze.steiner=!0),Ye.push(OC(ze));for(Ye.sort(DC),me=0;me<Ye.length;me++)ce=LC(Ye[me],ce);return ce}(s,n,N,o)),s.length>80*o){h=y=s[0],p=x=s[1];for(var H=o;H<B;H+=o)(S=s[H])<h&&(h=S),(I=s[H+1])<p&&(p=I),S>y&&(y=S),I>x&&(x=I);P=(P=Math.max(y-h,x-p))!==0?32767/P:0}return uh(N,q,o,h,p,P,0),q}function M0(s,n,o,h,p){var y,x;if(p===_g(s,n,o,h)>0)for(y=n;y<o;y+=h)x=z0(y,s[y],s[y+1],x);else for(y=o-h;y>=n;y-=h)x=z0(y,s[y],s[y+1],x);return x&&bf(x,x.next)&&(dh(x),x=x.next),x}function gl(s,n){if(!s)return s;n||(n=s);var o,h=s;do if(o=!1,h.steiner||!bf(h,h.next)&&vi(h.prev,h,h.next)!==0)h=h.next;else{if(dh(h),(h=n=h.prev)===h.next)break;o=!0}while(o||h!==n);return n}function uh(s,n,o,h,p,y,x){if(s){!x&&y&&function(L,B,N,q){var H=L;do H.z===0&&(H.z=mg(H.x,H.y,B,N,q)),H.prevZ=H.prev,H.nextZ=H.next,H=H.next;while(H!==L);H.prevZ.nextZ=null,H.prevZ=null,function(ee){var ie,ce,Ee,me,Ae,ze,Ye,wt,Dt=1;do{for(ce=ee,ee=null,Ae=null,ze=0;ce;){for(ze++,Ee=ce,Ye=0,ie=0;ie<Dt&&(Ye++,Ee=Ee.nextZ);ie++);for(wt=Dt;Ye>0||wt>0&&Ee;)Ye!==0&&(wt===0||!Ee||ce.z<=Ee.z)?(me=ce,ce=ce.nextZ,Ye--):(me=Ee,Ee=Ee.nextZ,wt--),Ae?Ae.nextZ=me:ee=me,me.prevZ=Ae,Ae=me;ce=Ee}Ae.nextZ=null,Dt*=2}while(ze>1)}(H)}(s,h,p,y);for(var S,I,P=s;s.prev!==s.next;)if(S=s.prev,I=s.next,y?PC(s,h,p,y):AC(s))n.push(S.i/o|0),n.push(s.i/o|0),n.push(I.i/o|0),dh(s),s=I.next,P=I.next;else if((s=I)===P){x?x===1?uh(s=RC(gl(s),n,o),n,o,h,p,y,2):x===2&&MC(s,n,o,h,p,y):uh(gl(s),n,o,h,p,y,1);break}}}function AC(s){var n=s.prev,o=s,h=s.next;if(vi(n,o,h)>=0)return!1;for(var p=n.x,y=o.x,x=h.x,S=n.y,I=o.y,P=h.y,L=p<y?p<x?p:x:y<x?y:x,B=S<I?S<P?S:P:I<P?I:P,N=p>y?p>x?p:x:y>x?y:x,q=S>I?S>P?S:P:I>P?I:P,H=h.next;H!==n;){if(H.x>=L&&H.x<=N&&H.y>=B&&H.y<=q&&Tc(p,S,y,I,x,P,H.x,H.y)&&vi(H.prev,H,H.next)>=0)return!1;H=H.next}return!0}function PC(s,n,o,h){var p=s.prev,y=s,x=s.next;if(vi(p,y,x)>=0)return!1;for(var S=p.x,I=y.x,P=x.x,L=p.y,B=y.y,N=x.y,q=S<I?S<P?S:P:I<P?I:P,H=L<B?L<N?L:N:B<N?B:N,ee=S>I?S>P?S:P:I>P?I:P,ie=L>B?L>N?L:N:B>N?B:N,ce=mg(q,H,n,o,h),Ee=mg(ee,ie,n,o,h),me=s.prevZ,Ae=s.nextZ;me&&me.z>=ce&&Ae&&Ae.z<=Ee;){if(me.x>=q&&me.x<=ee&&me.y>=H&&me.y<=ie&&me!==p&&me!==x&&Tc(S,L,I,B,P,N,me.x,me.y)&&vi(me.prev,me,me.next)>=0||(me=me.prevZ,Ae.x>=q&&Ae.x<=ee&&Ae.y>=H&&Ae.y<=ie&&Ae!==p&&Ae!==x&&Tc(S,L,I,B,P,N,Ae.x,Ae.y)&&vi(Ae.prev,Ae,Ae.next)>=0))return!1;Ae=Ae.nextZ}for(;me&&me.z>=ce;){if(me.x>=q&&me.x<=ee&&me.y>=H&&me.y<=ie&&me!==p&&me!==x&&Tc(S,L,I,B,P,N,me.x,me.y)&&vi(me.prev,me,me.next)>=0)return!1;me=me.prevZ}for(;Ae&&Ae.z<=Ee;){if(Ae.x>=q&&Ae.x<=ee&&Ae.y>=H&&Ae.y<=ie&&Ae!==p&&Ae!==x&&Tc(S,L,I,B,P,N,Ae.x,Ae.y)&&vi(Ae.prev,Ae,Ae.next)>=0)return!1;Ae=Ae.nextZ}return!0}function RC(s,n,o){var h=s;do{var p=h.prev,y=h.next.next;!bf(p,y)&&D0(p,h,h.next,y)&&hh(p,y)&&hh(y,p)&&(n.push(p.i/o|0),n.push(h.i/o|0),n.push(y.i/o|0),dh(h),dh(h.next),h=s=y),h=h.next}while(h!==s);return gl(h)}function MC(s,n,o,h,p,y){var x=s;do{for(var S=x.next.next;S!==x.prev;){if(x.i!==S.i&&BC(x,S)){var I=L0(x,S);return x=gl(x,x.next),I=gl(I,I.next),uh(x,n,o,h,p,y,0),void uh(I,n,o,h,p,y,0)}S=S.next}x=x.next}while(x!==s)}function DC(s,n){return s.x-n.x}function LC(s,n){var o=function(p,y){var x,S=y,I=p.x,P=p.y,L=-1/0;do{if(P<=S.y&&P>=S.next.y&&S.next.y!==S.y){var B=S.x+(P-S.y)*(S.next.x-S.x)/(S.next.y-S.y);if(B<=I&&B>L&&(L=B,x=S.x<S.next.x?S:S.next,B===I))return x}S=S.next}while(S!==y);if(!x)return null;var N,q=x,H=x.x,ee=x.y,ie=1/0;S=x;do I>=S.x&&S.x>=H&&I!==S.x&&Tc(P<ee?I:L,P,H,ee,P<ee?L:I,P,S.x,S.y)&&(N=Math.abs(P-S.y)/(I-S.x),hh(S,p)&&(N<ie||N===ie&&(S.x>x.x||S.x===x.x&&zC(x,S)))&&(x=S,ie=N)),S=S.next;while(S!==q);return x}(s,n);if(!o)return n;var h=L0(o,s);return gl(h,h.next),gl(o,o.next)}function zC(s,n){return vi(s.prev,s,n.prev)<0&&vi(n.next,s,s.next)<0}function mg(s,n,o,h,p){return(s=1431655765&((s=858993459&((s=252645135&((s=16711935&((s=(s-o)*p|0)|s<<8))|s<<4))|s<<2))|s<<1))|(n=1431655765&((n=858993459&((n=252645135&((n=16711935&((n=(n-h)*p|0)|n<<8))|n<<4))|n<<2))|n<<1))<<1}function OC(s){var n=s,o=s;do(n.x<o.x||n.x===o.x&&n.y<o.y)&&(o=n),n=n.next;while(n!==s);return o}function Tc(s,n,o,h,p,y,x,S){return(p-x)*(n-S)>=(s-x)*(y-S)&&(s-x)*(h-S)>=(o-x)*(n-S)&&(o-x)*(y-S)>=(p-x)*(h-S)}function BC(s,n){return s.next.i!==n.i&&s.prev.i!==n.i&&!function(o,h){var p=o;do{if(p.i!==o.i&&p.next.i!==o.i&&p.i!==h.i&&p.next.i!==h.i&&D0(p,p.next,o,h))return!0;p=p.next}while(p!==o);return!1}(s,n)&&(hh(s,n)&&hh(n,s)&&function(o,h){var p=o,y=!1,x=(o.x+h.x)/2,S=(o.y+h.y)/2;do p.y>S!=p.next.y>S&&p.next.y!==p.y&&x<(p.next.x-p.x)*(S-p.y)/(p.next.y-p.y)+p.x&&(y=!y),p=p.next;while(p!==o);return y}(s,n)&&(vi(s.prev,s,n.prev)||vi(s,n.prev,n))||bf(s,n)&&vi(s.prev,s,s.next)>0&&vi(n.prev,n,n.next)>0)}function vi(s,n,o){return(n.y-s.y)*(o.x-n.x)-(n.x-s.x)*(o.y-n.y)}function bf(s,n){return s.x===n.x&&s.y===n.y}function D0(s,n,o,h){var p=Sf(vi(s,n,o)),y=Sf(vi(s,n,h)),x=Sf(vi(o,h,s)),S=Sf(vi(o,h,n));return p!==y&&x!==S||!(p!==0||!wf(s,o,n))||!(y!==0||!wf(s,h,n))||!(x!==0||!wf(o,s,h))||!(S!==0||!wf(o,n,h))}function wf(s,n,o){return n.x<=Math.max(s.x,o.x)&&n.x>=Math.min(s.x,o.x)&&n.y<=Math.max(s.y,o.y)&&n.y>=Math.min(s.y,o.y)}function Sf(s){return s>0?1:s<0?-1:0}function hh(s,n){return vi(s.prev,s,s.next)<0?vi(s,n,s.next)>=0&&vi(s,s.prev,n)>=0:vi(s,n,s.prev)<0||vi(s,s.next,n)<0}function L0(s,n){var o=new gg(s.i,s.x,s.y),h=new gg(n.i,n.x,n.y),p=s.next,y=n.prev;return s.next=n,n.prev=s,o.next=p,p.prev=o,h.next=o,o.prev=h,y.next=h,h.prev=y,h}function z0(s,n,o,h){var p=new gg(s,n,o);return h?(p.next=h.next,p.prev=h,h.next.prev=p,h.next=p):(p.prev=p,p.next=p),p}function dh(s){s.next.prev=s.prev,s.prev.next=s.next,s.prevZ&&(s.prevZ.nextZ=s.nextZ),s.nextZ&&(s.nextZ.prevZ=s.prevZ)}function gg(s,n,o){this.i=s,this.x=n,this.y=o,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function _g(s,n,o,h){for(var p=0,y=n,x=o-h;y<o;y+=h)p+=(s[x]-s[y])*(s[y+1]+s[x+1]),x=y;return p}pg.exports=xf,pg.exports.default=xf,xf.deviation=function(s,n,o,h){var p=n&&n.length,y=Math.abs(_g(s,0,p?n[0]*o:s.length,o));if(p)for(var x=0,S=n.length;x<S;x++)y-=Math.abs(_g(s,n[x]*o,x<S-1?n[x+1]*o:s.length,o));var I=0;for(x=0;x<h.length;x+=3){var P=h[x]*o,L=h[x+1]*o,B=h[x+2]*o;I+=Math.abs((s[P]-s[B])*(s[L+1]-s[P+1])-(s[P]-s[L])*(s[B+1]-s[P+1]))}return y===0&&I===0?0:Math.abs((I-y)/y)},xf.flatten=function(s){for(var n=s[0][0].length,o={vertices:[],holes:[],dimensions:n},h=0,p=0;p<s.length;p++){for(var y=0;y<s[p].length;y++)for(var x=0;x<n;x++)o.vertices.push(s[p][y][x]);p>0&&o.holes.push(h+=s[p-1].length)}return o};var O0=b(pg.exports);function FC(s,n,o,h,p){B0(s,n,o||0,h||s.length-1,p||NC)}function B0(s,n,o,h,p){for(;h>o;){if(h-o>600){var y=h-o+1,x=n-o+1,S=Math.log(y),I=.5*Math.exp(2*S/3),P=.5*Math.sqrt(S*I*(y-I)/y)*(x-y/2<0?-1:1);B0(s,n,Math.max(o,Math.floor(n-x*I/y+P)),Math.min(h,Math.floor(n+(y-x)*I/y+P)),p)}var L=s[n],B=o,N=h;for(fh(s,o,n),p(s[h],L)>0&&fh(s,o,h);B<N;){for(fh(s,B,N),B++,N--;p(s[B],L)<0;)B++;for(;p(s[N],L)>0;)N--}p(s[o],L)===0?fh(s,o,N):fh(s,++N,h),N<=n&&(o=N+1),n<=N&&(h=N-1)}}function fh(s,n,o){var h=s[n];s[n]=s[o],s[o]=h}function NC(s,n){return s<n?-1:s>n?1:0}function yg(s,n){const o=s.length;if(o<=1)return[s];const h=[];let p,y;for(let x=0;x<o;x++){const S=ke(s[x]);S!==0&&(s[x].area=Math.abs(S),y===void 0&&(y=S<0),y===S<0?(p&&h.push(p),p=[s[x]]):p.push(s[x]))}if(p&&h.push(p),n>1)for(let x=0;x<h.length;x++)h[x].length<=n||(FC(h[x],n,1,h[x].length-1,UC),h[x]=h[x].slice(0,n));return h}function UC(s,n){return n.area-s.area}function vg(s,n,o){const h=o.patternDependencies;let p=!1;for(const y of n){const x=y.paint.get(`${s}-pattern`);x.isConstant()||(p=!0);const S=x.constantOr(null);S&&(p=!0,h[S.to]=!0,h[S.from]=!0)}return p}function xg(s,n,o,h,p){const y=p.patternDependencies;for(const x of n){const S=x.paint.get(`${s}-pattern`).value;if(S.kind!=="constant"){let I=S.evaluate({zoom:h-1},o,{},p.availableImages),P=S.evaluate({zoom:h},o,{},p.availableImages),L=S.evaluate({zoom:h+1},o,{},p.availableImages);I=I&&I.name?I.name:I,P=P&&P.name?P.name:P,L=L&&L.name?L.name:L,y[I]=!0,y[P]=!0,y[L]=!0,o.patterns[x.id]={min:I,mid:P,max:L}}}return o}class bg{constructor(n){this.zoom=n.zoom,this.overscaling=n.overscaling,this.layers=n.layers,this.layerIds=this.layers.map(o=>o.id),this.index=n.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Ne,this.indexArray=new Ct,this.indexArray2=new Fn,this.programConfigurations=new Oa(n.layers,n.zoom),this.segments=new Zt,this.segments2=new Zt,this.stateDependentLayerIds=this.layers.filter(o=>o.isStateDependent()).map(o=>o.id)}populate(n,o,h){this.hasPattern=vg("fill",this.layers,o);const p=this.layers[0].layout.get("fill-sort-key"),y=!p.isConstant(),x=[];for(const{feature:S,id:I,index:P,sourceLayerIndex:L}of n){const B=this.layers[0]._featureFilter.needGeometry,N=Ls(S,B);if(!this.layers[0]._featureFilter.filter(new Zn(this.zoom),N,h))continue;const q=y?p.evaluate(N,{},h,o.availableImages):void 0,H={id:I,properties:S.properties,type:S.type,sourceLayerIndex:L,index:P,geometry:B?N.geometry:sa(S),patterns:{},sortKey:q};x.push(H)}y&&x.sort((S,I)=>S.sortKey-I.sortKey);for(const S of x){const{geometry:I,index:P,sourceLayerIndex:L}=S;if(this.hasPattern){const B=xg("fill",this.layers,S,this.zoom,o);this.patternFeatures.push(B)}else this.addFeature(S,I,P,h,{});o.featureIndex.insert(n[P].feature,I,P,L,this.index)}}update(n,o,h){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(n,o,this.stateDependentLayers,h)}addFeatures(n,o,h){for(const p of this.patternFeatures)this.addFeature(p,p.geometry,p.index,o,h)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(n){this.uploaded||(this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,kC),this.indexBuffer=n.createIndexBuffer(this.indexArray),this.indexBuffer2=n.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(n),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(n,o,h,p,y){for(const x of yg(o,500)){let S=0;for(const q of x)S+=q.length;const I=this.segments.prepareSegment(S,this.layoutVertexArray,this.indexArray),P=I.vertexLength,L=[],B=[];for(const q of x){if(q.length===0)continue;q!==x[0]&&B.push(L.length/2);const H=this.segments2.prepareSegment(q.length,this.layoutVertexArray,this.indexArray2),ee=H.vertexLength;this.layoutVertexArray.emplaceBack(q[0].x,q[0].y),this.indexArray2.emplaceBack(ee+q.length-1,ee),L.push(q[0].x),L.push(q[0].y);for(let ie=1;ie<q.length;ie++)this.layoutVertexArray.emplaceBack(q[ie].x,q[ie].y),this.indexArray2.emplaceBack(ee+ie-1,ee+ie),L.push(q[ie].x),L.push(q[ie].y);H.vertexLength+=q.length,H.primitiveLength+=q.length}const N=O0(L,B);for(let q=0;q<N.length;q+=3)this.indexArray.emplaceBack(P+N[q],P+N[q+1],P+N[q+2]);I.vertexLength+=S,I.primitiveLength+=N.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,n,h,y,p)}}let F0,N0;St("FillBucket",bg,{omit:["layers","patternFeatures"]});var $C={get paint(){return N0=N0||new ki({"fill-antialias":new Ot(U.paint_fill["fill-antialias"]),"fill-opacity":new qt(U.paint_fill["fill-opacity"]),"fill-color":new qt(U.paint_fill["fill-color"]),"fill-outline-color":new qt(U.paint_fill["fill-outline-color"]),"fill-translate":new Ot(U.paint_fill["fill-translate"]),"fill-translate-anchor":new Ot(U.paint_fill["fill-translate-anchor"]),"fill-pattern":new gc(U.paint_fill["fill-pattern"])})},get layout(){return F0=F0||new ki({"fill-sort-key":new qt(U.layout_fill["fill-sort-key"])})}};class VC extends ys{constructor(n){super(n,$C)}recalculate(n,o){super.recalculate(n,o);const h=this.paint._values["fill-outline-color"];h.value.kind==="constant"&&h.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(n){return new bg(n)}queryRadius(){return _f(this.paint.get("fill-translate"))}queryIntersectsFeature(n,o,h,p,y,x,S){return x0(yf(n,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),x.angle,S),p)}isTileClipped(){return!0}}const jC=_i([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),GC=_i([{name:"a_centroid",components:2,type:"Int16"}],4),{members:qC}=jC;var vo={},HC=w,U0=Cc;function Cc(s,n,o,h,p){this.properties={},this.extent=o,this.type=0,this._pbf=s,this._geometry=-1,this._keys=h,this._values=p,s.readFields(ZC,this,n)}function ZC(s,n,o){s==1?n.id=o.readVarint():s==2?function(h,p){for(var y=h.readVarint()+h.pos;h.pos<y;){var x=p._keys[h.readVarint()],S=p._values[h.readVarint()];p.properties[x]=S}}(o,n):s==3?n.type=o.readVarint():s==4&&(n._geometry=o.pos)}function WC(s){for(var n,o,h=0,p=0,y=s.length,x=y-1;p<y;x=p++)h+=((o=s[x]).x-(n=s[p]).x)*(n.y+o.y);return h}Cc.types=["Unknown","Point","LineString","Polygon"],Cc.prototype.loadGeometry=function(){var s=this._pbf;s.pos=this._geometry;for(var n,o=s.readVarint()+s.pos,h=1,p=0,y=0,x=0,S=[];s.pos<o;){if(p<=0){var I=s.readVarint();h=7&I,p=I>>3}if(p--,h===1||h===2)y+=s.readSVarint(),x+=s.readSVarint(),h===1&&(n&&S.push(n),n=[]),n.push(new HC(y,x));else{if(h!==7)throw new Error("unknown command "+h);n&&n.push(n[0].clone())}}return n&&S.push(n),S},Cc.prototype.bbox=function(){var s=this._pbf;s.pos=this._geometry;for(var n=s.readVarint()+s.pos,o=1,h=0,p=0,y=0,x=1/0,S=-1/0,I=1/0,P=-1/0;s.pos<n;){if(h<=0){var L=s.readVarint();o=7&L,h=L>>3}if(h--,o===1||o===2)(p+=s.readSVarint())<x&&(x=p),p>S&&(S=p),(y+=s.readSVarint())<I&&(I=y),y>P&&(P=y);else if(o!==7)throw new Error("unknown command "+o)}return[x,I,S,P]},Cc.prototype.toGeoJSON=function(s,n,o){var h,p,y=this.extent*Math.pow(2,o),x=this.extent*s,S=this.extent*n,I=this.loadGeometry(),P=Cc.types[this.type];function L(q){for(var H=0;H<q.length;H++){var ee=q[H];q[H]=[360*(ee.x+x)/y-180,360/Math.PI*Math.atan(Math.exp((180-360*(ee.y+S)/y)*Math.PI/180))-90]}}switch(this.type){case 1:var B=[];for(h=0;h<I.length;h++)B[h]=I[h][0];L(I=B);break;case 2:for(h=0;h<I.length;h++)L(I[h]);break;case 3:for(I=function(q){var H=q.length;if(H<=1)return[q];for(var ee,ie,ce=[],Ee=0;Ee<H;Ee++){var me=WC(q[Ee]);me!==0&&(ie===void 0&&(ie=me<0),ie===me<0?(ee&&ce.push(ee),ee=[q[Ee]]):ee.push(q[Ee]))}return ee&&ce.push(ee),ce}(I),h=0;h<I.length;h++)for(p=0;p<I[h].length;p++)L(I[h][p])}I.length===1?I=I[0]:P="Multi"+P;var N={type:"Feature",geometry:{type:P,coordinates:I},properties:this.properties};return"id"in this&&(N.id=this.id),N};var YC=U0,$0=V0;function V0(s,n){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=s,this._keys=[],this._values=[],this._features=[],s.readFields(XC,this,n),this.length=this._features.length}function XC(s,n,o){s===15?n.version=o.readVarint():s===1?n.name=o.readString():s===5?n.extent=o.readVarint():s===2?n._features.push(o.pos):s===3?n._keys.push(o.readString()):s===4&&n._values.push(function(h){for(var p=null,y=h.readVarint()+h.pos;h.pos<y;){var x=h.readVarint()>>3;p=x===1?h.readString():x===2?h.readFloat():x===3?h.readDouble():x===4?h.readVarint64():x===5?h.readVarint():x===6?h.readSVarint():x===7?h.readBoolean():null}return p}(o))}V0.prototype.feature=function(s){if(s<0||s>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[s];var n=this._pbf.readVarint()+this._pbf.pos;return new YC(this._pbf,n,this.extent,this._keys,this._values)};var KC=$0;function JC(s,n,o){if(s===3){var h=new KC(o,o.readVarint()+o.pos);h.length&&(n[h.name]=h)}}vo.VectorTile=function(s,n){this.layers=s.readFields(JC,{},n)},vo.VectorTileFeature=U0,vo.VectorTileLayer=$0;const QC=vo.VectorTileFeature.types,wg=Math.pow(2,13);function ph(s,n,o,h,p,y,x,S){s.emplaceBack(n,o,2*Math.floor(h*wg)+x,p*wg*2,y*wg*2,Math.round(S))}class Sg{constructor(n){this.zoom=n.zoom,this.overscaling=n.overscaling,this.layers=n.layers,this.layerIds=this.layers.map(o=>o.id),this.index=n.index,this.hasPattern=!1,this.layoutVertexArray=new $e,this.centroidVertexArray=new se,this.indexArray=new Ct,this.programConfigurations=new Oa(n.layers,n.zoom),this.segments=new Zt,this.stateDependentLayerIds=this.layers.filter(o=>o.isStateDependent()).map(o=>o.id)}populate(n,o,h){this.features=[],this.hasPattern=vg("fill-extrusion",this.layers,o);for(const{feature:p,id:y,index:x,sourceLayerIndex:S}of n){const I=this.layers[0]._featureFilter.needGeometry,P=Ls(p,I);if(!this.layers[0]._featureFilter.filter(new Zn(this.zoom),P,h))continue;const L={id:y,sourceLayerIndex:S,index:x,geometry:I?P.geometry:sa(p),properties:p.properties,type:p.type,patterns:{}};this.hasPattern?this.features.push(xg("fill-extrusion",this.layers,L,this.zoom,o)):this.addFeature(L,L.geometry,x,h,{}),o.featureIndex.insert(p,L.geometry,x,S,this.index,!0)}}addFeatures(n,o,h){for(const p of this.features){const{geometry:y}=p;this.addFeature(p,y,p.index,o,h)}}update(n,o,h){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(n,o,this.stateDependentLayers,h)}isEmpty(){return this.layoutVertexArray.length===0&&this.centroidVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(n){this.uploaded||(this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,qC),this.centroidVertexBuffer=n.createVertexBuffer(this.centroidVertexArray,GC.members,!0),this.indexBuffer=n.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(n),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(n,o,h,p,y){const x={x:0,y:0,vertexCount:0};for(const S of yg(o,500)){let I=0;for(const H of S)I+=H.length;let P=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray);for(const H of S){if(H.length===0||tI(H))continue;let ee=0;for(let ie=0;ie<H.length;ie++){const ce=H[ie];if(ie>=1){const Ee=H[ie-1];if(!eI(ce,Ee)){P.vertexLength+4>Zt.MAX_VERTEX_ARRAY_LENGTH&&(P=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const me=ce.sub(Ee)._perp()._unit(),Ae=Ee.dist(ce);ee+Ae>32768&&(ee=0),ph(this.layoutVertexArray,ce.x,ce.y,me.x,me.y,0,0,ee),ph(this.layoutVertexArray,ce.x,ce.y,me.x,me.y,0,1,ee),x.x+=2*ce.x,x.y+=2*ce.y,x.vertexCount+=2,ee+=Ae,ph(this.layoutVertexArray,Ee.x,Ee.y,me.x,me.y,0,0,ee),ph(this.layoutVertexArray,Ee.x,Ee.y,me.x,me.y,0,1,ee),x.x+=2*Ee.x,x.y+=2*Ee.y,x.vertexCount+=2;const ze=P.vertexLength;this.indexArray.emplaceBack(ze,ze+2,ze+1),this.indexArray.emplaceBack(ze+1,ze+2,ze+3),P.vertexLength+=4,P.primitiveLength+=2}}}}if(P.vertexLength+I>Zt.MAX_VERTEX_ARRAY_LENGTH&&(P=this.segments.prepareSegment(I,this.layoutVertexArray,this.indexArray)),QC[n.type]!=="Polygon")continue;const L=[],B=[],N=P.vertexLength;for(const H of S)if(H.length!==0){H!==S[0]&&B.push(L.length/2);for(let ee=0;ee<H.length;ee++){const ie=H[ee];ph(this.layoutVertexArray,ie.x,ie.y,0,0,1,1,0),x.x+=ie.x,x.y+=ie.y,x.vertexCount+=1,L.push(ie.x),L.push(ie.y)}}const q=O0(L,B);for(let H=0;H<q.length;H+=3)this.indexArray.emplaceBack(N+q[H],N+q[H+2],N+q[H+1]);P.primitiveLength+=q.length/3,P.vertexLength+=I}for(let S=0;S<x.vertexCount;S++)this.centroidVertexArray.emplaceBack(Math.floor(x.x/x.vertexCount),Math.floor(x.y/x.vertexCount));this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,n,h,y,p)}}function eI(s,n){return s.x===n.x&&(s.x<0||s.x>si)||s.y===n.y&&(s.y<0||s.y>si)}function tI(s){return s.every(n=>n.x<0)||s.every(n=>n.x>si)||s.every(n=>n.y<0)||s.every(n=>n.y>si)}let j0;St("FillExtrusionBucket",Sg,{omit:["layers","features"]});var nI={get paint(){return j0=j0||new ki({"fill-extrusion-opacity":new Ot(U["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new qt(U["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Ot(U["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Ot(U["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new gc(U["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new qt(U["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new qt(U["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new Ot(U["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})}};class iI extends ys{constructor(n){super(n,nI)}createBucket(n){return new Sg(n)}queryRadius(){return _f(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature(n,o,h,p,y,x,S,I){const P=yf(n,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),x.angle,S),L=this.paint.get("fill-extrusion-height").evaluate(o,h),B=this.paint.get("fill-extrusion-base").evaluate(o,h),N=function(H,ee,ie,ce){const Ee=[];for(const me of H){const Ae=[me.x,me.y,0,1];vf(Ae,Ae,ee),Ee.push(new k(Ae[0]/Ae[3],Ae[1]/Ae[3]))}return Ee}(P,I),q=function(H,ee,ie,ce){const Ee=[],me=[],Ae=ce[8]*ee,ze=ce[9]*ee,Ye=ce[10]*ee,wt=ce[11]*ee,Dt=ce[8]*ie,xt=ce[9]*ie,vt=ce[10]*ie,mt=ce[11]*ie;for(const Tt of H){const gt=[],lt=[];for(const Vt of Tt){const zt=Vt.x,rn=Vt.y,jn=ce[0]*zt+ce[4]*rn+ce[12],Wn=ce[1]*zt+ce[5]*rn+ce[13],Pi=ce[2]*zt+ce[6]*rn+ce[14],Wr=ce[3]*zt+ce[7]*rn+ce[15],_r=Pi+Ye,Si=Wr+wt,Fi=jn+Dt,Xi=Wn+xt,Rr=Pi+vt,yr=Wr+mt,Ei=new k((jn+Ae)/Si,(Wn+ze)/Si);Ei.z=_r/Si,gt.push(Ei);const Ri=new k(Fi/yr,Xi/yr);Ri.z=Rr/yr,lt.push(Ri)}Ee.push(gt),me.push(lt)}return[Ee,me]}(p,B,L,I);return function(H,ee,ie){let ce=1/0;x0(ie,ee)&&(ce=G0(ie,ee[0]));for(let Ee=0;Ee<ee.length;Ee++){const me=ee[Ee],Ae=H[Ee];for(let ze=0;ze<me.length-1;ze++){const Ye=me[ze],wt=[Ye,me[ze+1],Ae[ze+1],Ae[ze],Ye];v0(ie,wt)&&(ce=Math.min(ce,G0(ie,wt)))}}return ce!==1/0&&ce}(q[0],q[1],N)}}function mh(s,n){return s.x*n.x+s.y*n.y}function G0(s,n){if(s.length===1){let o=0;const h=n[o++];let p;for(;!p||h.equals(p);)if(p=n[o++],!p)return 1/0;for(;o<n.length;o++){const y=n[o],x=s[0],S=p.sub(h),I=y.sub(h),P=x.sub(h),L=mh(S,S),B=mh(S,I),N=mh(I,I),q=mh(P,S),H=mh(P,I),ee=L*N-B*B,ie=(N*q-B*H)/ee,ce=(L*H-B*q)/ee,Ee=h.z*(1-ie-ce)+p.z*ie+y.z*ce;if(isFinite(Ee))return Ee}return 1/0}{let o=1/0;for(const h of n)o=Math.min(o,h.z);return o}}const rI=_i([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:sI}=rI,aI=_i([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:oI}=aI,lI=vo.VectorTileFeature.types,cI=Math.cos(Math.PI/180*37.5),q0=Math.pow(2,14)/.5;class Eg{constructor(n){this.zoom=n.zoom,this.overscaling=n.overscaling,this.layers=n.layers,this.layerIds=this.layers.map(o=>o.id),this.index=n.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(o=>{this.gradients[o.id]={}}),this.layoutVertexArray=new We,this.layoutVertexArray2=new ot,this.indexArray=new Ct,this.programConfigurations=new Oa(n.layers,n.zoom),this.segments=new Zt,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(o=>o.isStateDependent()).map(o=>o.id)}populate(n,o,h){this.hasPattern=vg("line",this.layers,o);const p=this.layers[0].layout.get("line-sort-key"),y=!p.isConstant(),x=[];for(const{feature:S,id:I,index:P,sourceLayerIndex:L}of n){const B=this.layers[0]._featureFilter.needGeometry,N=Ls(S,B);if(!this.layers[0]._featureFilter.filter(new Zn(this.zoom),N,h))continue;const q=y?p.evaluate(N,{},h):void 0,H={id:I,properties:S.properties,type:S.type,sourceLayerIndex:L,index:P,geometry:B?N.geometry:sa(S),patterns:{},sortKey:q};x.push(H)}y&&x.sort((S,I)=>S.sortKey-I.sortKey);for(const S of x){const{geometry:I,index:P,sourceLayerIndex:L}=S;if(this.hasPattern){const B=xg("line",this.layers,S,this.zoom,o);this.patternFeatures.push(B)}else this.addFeature(S,I,P,h,{});o.featureIndex.insert(n[P].feature,I,P,L,this.index)}}update(n,o,h){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(n,o,this.stateDependentLayers,h)}addFeatures(n,o,h){for(const p of this.patternFeatures)this.addFeature(p,p.geometry,p.index,o,h)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(n){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=n.createVertexBuffer(this.layoutVertexArray2,oI)),this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,sI),this.indexBuffer=n.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(n),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(n){if(n.properties&&Object.prototype.hasOwnProperty.call(n.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(n.properties,"mapbox_clip_end"))return{start:+n.properties.mapbox_clip_start,end:+n.properties.mapbox_clip_end}}addFeature(n,o,h,p,y){const x=this.layers[0].layout,S=x.get("line-join").evaluate(n,{}),I=x.get("line-cap"),P=x.get("line-miter-limit"),L=x.get("line-round-limit");this.lineClips=this.lineFeatureClips(n);for(const B of o)this.addLine(B,n,S,I,P,L);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,n,h,y,p)}addLine(n,o,h,p,y,x){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let ce=0;ce<n.length-1;ce++)this.totalDistance+=n[ce].dist(n[ce+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const S=lI[o.type]==="Polygon";let I=n.length;for(;I>=2&&n[I-1].equals(n[I-2]);)I--;let P=0;for(;P<I-1&&n[P].equals(n[P+1]);)P++;if(I<(S?3:2))return;h==="bevel"&&(y=1.05);const L=this.overscaling<=16?15*si/(512*this.overscaling):0,B=this.segments.prepareSegment(10*I,this.layoutVertexArray,this.indexArray);let N,q,H,ee,ie;this.e1=this.e2=-1,S&&(N=n[I-2],ie=n[P].sub(N)._unit()._perp());for(let ce=P;ce<I;ce++){if(H=ce===I-1?S?n[P+1]:void 0:n[ce+1],H&&n[ce].equals(H))continue;ie&&(ee=ie),N&&(q=N),N=n[ce],ie=H?H.sub(N)._unit()._perp():ee,ee=ee||ie;let Ee=ee.add(ie);Ee.x===0&&Ee.y===0||Ee._unit();const me=ee.x*ie.x+ee.y*ie.y,Ae=Ee.x*ie.x+Ee.y*ie.y,ze=Ae!==0?1/Ae:1/0,Ye=2*Math.sqrt(2-2*Ae),wt=Ae<cI&&q&&H,Dt=ee.x*ie.y-ee.y*ie.x>0;if(wt&&ce>P){const mt=N.dist(q);if(mt>2*L){const Tt=N.sub(N.sub(q)._mult(L/mt)._round());this.updateDistance(q,Tt),this.addCurrentVertex(Tt,ee,0,0,B),q=Tt}}const xt=q&&H;let vt=xt?h:S?"butt":p;if(xt&&vt==="round"&&(ze<x?vt="miter":ze<=2&&(vt="fakeround")),vt==="miter"&&ze>y&&(vt="bevel"),vt==="bevel"&&(ze>2&&(vt="flipbevel"),ze<y&&(vt="miter")),q&&this.updateDistance(q,N),vt==="miter")Ee._mult(ze),this.addCurrentVertex(N,Ee,0,0,B);else if(vt==="flipbevel"){if(ze>100)Ee=ie.mult(-1);else{const mt=ze*ee.add(ie).mag()/ee.sub(ie).mag();Ee._perp()._mult(mt*(Dt?-1:1))}this.addCurrentVertex(N,Ee,0,0,B),this.addCurrentVertex(N,Ee.mult(-1),0,0,B)}else if(vt==="bevel"||vt==="fakeround"){const mt=-Math.sqrt(ze*ze-1),Tt=Dt?mt:0,gt=Dt?0:mt;if(q&&this.addCurrentVertex(N,ee,Tt,gt,B),vt==="fakeround"){const lt=Math.round(180*Ye/Math.PI/20);for(let Vt=1;Vt<lt;Vt++){let zt=Vt/lt;if(zt!==.5){const jn=zt-.5;zt+=zt*jn*(zt-1)*((1.0904+me*(me*(3.55645-1.43519*me)-3.2452))*jn*jn+(.848013+me*(.215638*me-1.06021)))}const rn=ie.sub(ee)._mult(zt)._add(ee)._unit()._mult(Dt?-1:1);this.addHalfVertex(N,rn.x,rn.y,!1,Dt,0,B)}}H&&this.addCurrentVertex(N,ie,-Tt,-gt,B)}else if(vt==="butt")this.addCurrentVertex(N,Ee,0,0,B);else if(vt==="square"){const mt=q?1:-1;this.addCurrentVertex(N,Ee,mt,mt,B)}else vt==="round"&&(q&&(this.addCurrentVertex(N,ee,0,0,B),this.addCurrentVertex(N,ee,1,1,B,!0)),H&&(this.addCurrentVertex(N,ie,-1,-1,B,!0),this.addCurrentVertex(N,ie,0,0,B)));if(wt&&ce<I-1){const mt=N.dist(H);if(mt>2*L){const Tt=N.add(H.sub(N)._mult(L/mt)._round());this.updateDistance(N,Tt),this.addCurrentVertex(Tt,ie,0,0,B),N=Tt}}}}addCurrentVertex(n,o,h,p,y,x=!1){const S=o.y*p-o.x,I=-o.y-o.x*p;this.addHalfVertex(n,o.x+o.y*h,o.y-o.x*h,x,!1,h,y),this.addHalfVertex(n,S,I,x,!0,-p,y),this.distance>q0/2&&this.totalDistance===0&&(this.distance=0,this.updateScaledDistance(),this.addCurrentVertex(n,o,h,p,y,x))}addHalfVertex({x:n,y:o},h,p,y,x,S,I){const P=.5*(this.lineClips?this.scaledDistance*(q0-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((n<<1)+(y?1:0),(o<<1)+(x?1:0),Math.round(63*h)+128,Math.round(63*p)+128,1+(S===0?0:S<0?-1:1)|(63&P)<<2,P>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);const L=I.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,L),I.primitiveLength++),x?this.e2=L:this.e1=L}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(n,o){this.distance+=n.dist(o),this.updateScaledDistance()}}let H0,Z0;St("LineBucket",Eg,{omit:["layers","patternFeatures"]});var W0={get paint(){return Z0=Z0||new ki({"line-opacity":new qt(U.paint_line["line-opacity"]),"line-color":new qt(U.paint_line["line-color"]),"line-translate":new Ot(U.paint_line["line-translate"]),"line-translate-anchor":new Ot(U.paint_line["line-translate-anchor"]),"line-width":new qt(U.paint_line["line-width"]),"line-gap-width":new qt(U.paint_line["line-gap-width"]),"line-offset":new qt(U.paint_line["line-offset"]),"line-blur":new qt(U.paint_line["line-blur"]),"line-dasharray":new Qu(U.paint_line["line-dasharray"]),"line-pattern":new gc(U.paint_line["line-pattern"]),"line-gradient":new eh(U.paint_line["line-gradient"])})},get layout(){return H0=H0||new ki({"line-cap":new Ot(U.layout_line["line-cap"]),"line-join":new qt(U.layout_line["line-join"]),"line-miter-limit":new Ot(U.layout_line["line-miter-limit"]),"line-round-limit":new Ot(U.layout_line["line-round-limit"]),"line-sort-key":new qt(U.layout_line["line-sort-key"])})}};class uI extends qt{possiblyEvaluate(n,o){return o=new Zn(Math.floor(o.zoom),{now:o.now,fadeDuration:o.fadeDuration,zoomHistory:o.zoomHistory,transition:o.transition}),super.possiblyEvaluate(n,o)}evaluate(n,o,h,p){return o=ge({},o,{zoom:Math.floor(o.zoom)}),super.evaluate(n,o,h,p)}}let Ef;class hI extends ys{constructor(n){super(n,W0),this.gradientVersion=0,Ef||(Ef=new uI(W0.paint.properties["line-width"].specification),Ef.useIntegerZoom=!0)}_handleSpecialPaintPropertyUpdate(n){n==="line-gradient"&&(this.stepInterpolant=this._transitionablePaint._values["line-gradient"].value.expression._styleExpression.expression instanceof rl,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER)}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(n,o){super.recalculate(n,o),this.paint._values["line-floorwidth"]=Ef.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,n)}createBucket(n){return new Eg(n)}queryRadius(n){const o=n,h=Y0(oh("line-width",this,o),oh("line-gap-width",this,o)),p=oh("line-offset",this,o);return h/2+Math.abs(p)+_f(this.paint.get("line-translate"))}queryIntersectsFeature(n,o,h,p,y,x,S){const I=yf(n,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),x.angle,S),P=S/2*Y0(this.paint.get("line-width").evaluate(o,h),this.paint.get("line-gap-width").evaluate(o,h)),L=this.paint.get("line-offset").evaluate(o,h);return L&&(p=function(B,N){const q=[];for(let H=0;H<B.length;H++){const ee=B[H],ie=[];for(let ce=0;ce<ee.length;ce++){const Ee=ee[ce-1],me=ee[ce],Ae=ee[ce+1],ze=ce===0?new k(0,0):me.sub(Ee)._unit()._perp(),Ye=ce===ee.length-1?new k(0,0):Ae.sub(me)._unit()._perp(),wt=ze._add(Ye)._unit(),Dt=wt.x*Ye.x+wt.y*Ye.y;Dt!==0&&wt._mult(1/Dt),ie.push(wt._mult(N)._add(me))}q.push(ie)}return q}(p,L*S)),function(B,N,q){for(let H=0;H<N.length;H++){const ee=N[H];if(B.length>=3){for(let ie=0;ie<ee.length;ie++)if(Sc(B,ee[ie]))return!0}if(_C(B,ee,q))return!0}return!1}(I,p,P)}isTileClipped(){return!0}}function Y0(s,n){return n>0?n+2*s:s}const dI=_i([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),fI=_i([{name:"a_projected_pos",components:3,type:"Float32"}],4);_i([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const pI=_i([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]);_i([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const X0=_i([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),mI=_i([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function gI(s,n,o){return s.sections.forEach(h=>{h.text=function(p,y,x){const S=y.layout.get("text-transform").evaluate(x,{});return S==="uppercase"?p=p.toLocaleUpperCase():S==="lowercase"&&(p=p.toLocaleLowerCase()),Zr.applyArabicShaping&&(p=Zr.applyArabicShaping(p)),p}(h.text,n,o)}),s}_i([{name:"triangle",components:3,type:"Uint16"}]),_i([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),_i([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Uint16",name:"textAnchorOffsetStartIndex"},{type:"Uint16",name:"textAnchorOffsetEndIndex"}]),_i([{type:"Float32",name:"offsetX"}]),_i([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]),_i([{type:"Uint16",name:"textAnchor"},{type:"Float32",components:2,name:"textOffset"}]);const gh={"!":"︕","#":"＃",$:"＄","%":"％","&":"＆","(":"︵",")":"︶","*":"＊","+":"＋",",":"︐","-":"︲",".":"・","/":"／",":":"︓",";":"︔","<":"︿","=":"＝",">":"﹀","?":"︖","@":"＠","[":"﹇","\\":"＼","]":"﹈","^":"＾",_:"︳","`":"｀","{":"︷","|":"―","}":"︸","~":"～","¢":"￠","£":"￡","¥":"￥","¦":"￤","¬":"￢","¯":"￣","–":"︲","—":"︱","‘":"﹃","’":"﹄","“":"﹁","”":"﹂","…":"︙","‧":"・","₩":"￦","、":"︑","。":"︒","〈":"︿","〉":"﹀","《":"︽","》":"︾","「":"﹁","」":"﹂","『":"﹃","』":"﹄","【":"︻","】":"︼","〔":"︹","〕":"︺","〖":"︗","〗":"︘","！":"︕","（":"︵","）":"︶","，":"︐","－":"︲","．":"・","：":"︓","；":"︔","＜":"︿","＞":"﹀","？":"︖","［":"﹇","］":"﹈","＿":"︳","｛":"︷","｜":"―","｝":"︸","｟":"︵","｠":"︶","｡":"︒","｢":"﹁","｣":"﹂"};var Ai=24,K0=Ln,J0=function(s,n,o,h,p){var y,x,S=8*p-h-1,I=(1<<S)-1,P=I>>1,L=-7,B=o?p-1:0,N=o?-1:1,q=s[n+B];for(B+=N,y=q&(1<<-L)-1,q>>=-L,L+=S;L>0;y=256*y+s[n+B],B+=N,L-=8);for(x=y&(1<<-L)-1,y>>=-L,L+=h;L>0;x=256*x+s[n+B],B+=N,L-=8);if(y===0)y=1-P;else{if(y===I)return x?NaN:1/0*(q?-1:1);x+=Math.pow(2,h),y-=P}return(q?-1:1)*x*Math.pow(2,y-h)},Q0=function(s,n,o,h,p,y){var x,S,I,P=8*y-p-1,L=(1<<P)-1,B=L>>1,N=p===23?Math.pow(2,-24)-Math.pow(2,-77):0,q=h?0:y-1,H=h?1:-1,ee=n<0||n===0&&1/n<0?1:0;for(n=Math.abs(n),isNaN(n)||n===1/0?(S=isNaN(n)?1:0,x=L):(x=Math.floor(Math.log(n)/Math.LN2),n*(I=Math.pow(2,-x))<1&&(x--,I*=2),(n+=x+B>=1?N/I:N*Math.pow(2,1-B))*I>=2&&(x++,I/=2),x+B>=L?(S=0,x=L):x+B>=1?(S=(n*I-1)*Math.pow(2,p),x+=B):(S=n*Math.pow(2,B-1)*Math.pow(2,p),x=0));p>=8;s[o+q]=255&S,q+=H,S/=256,p-=8);for(x=x<<p|S,P+=p;P>0;s[o+q]=255&x,q+=H,x/=256,P-=8);s[o+q-H]|=128*ee};function Ln(s){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(s)?s:new Uint8Array(s||0),this.pos=0,this.type=0,this.length=this.buf.length}Ln.Varint=0,Ln.Fixed64=1,Ln.Bytes=2,Ln.Fixed32=5;var Tg=4294967296,ex=1/Tg,tx=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function Ba(s){return s.type===Ln.Bytes?s.readVarint()+s.pos:s.pos+1}function Ic(s,n,o){return o?4294967296*n+(s>>>0):4294967296*(n>>>0)+(s>>>0)}function nx(s,n,o){var h=n<=16383?1:n<=2097151?2:n<=268435455?3:Math.floor(Math.log(n)/(7*Math.LN2));o.realloc(h);for(var p=o.pos-1;p>=s;p--)o.buf[p+h]=o.buf[p]}function _I(s,n){for(var o=0;o<s.length;o++)n.writeVarint(s[o])}function yI(s,n){for(var o=0;o<s.length;o++)n.writeSVarint(s[o])}function vI(s,n){for(var o=0;o<s.length;o++)n.writeFloat(s[o])}function xI(s,n){for(var o=0;o<s.length;o++)n.writeDouble(s[o])}function bI(s,n){for(var o=0;o<s.length;o++)n.writeBoolean(s[o])}function wI(s,n){for(var o=0;o<s.length;o++)n.writeFixed32(s[o])}function SI(s,n){for(var o=0;o<s.length;o++)n.writeSFixed32(s[o])}function EI(s,n){for(var o=0;o<s.length;o++)n.writeFixed64(s[o])}function TI(s,n){for(var o=0;o<s.length;o++)n.writeSFixed64(s[o])}function Tf(s,n){return(s[n]|s[n+1]<<8|s[n+2]<<16)+16777216*s[n+3]}function kc(s,n,o){s[o]=n,s[o+1]=n>>>8,s[o+2]=n>>>16,s[o+3]=n>>>24}function ix(s,n){return(s[n]|s[n+1]<<8|s[n+2]<<16)+(s[n+3]<<24)}Ln.prototype={destroy:function(){this.buf=null},readFields:function(s,n,o){for(o=o||this.length;this.pos<o;){var h=this.readVarint(),p=h>>3,y=this.pos;this.type=7&h,s(p,n,this),this.pos===y&&this.skip(h)}return n},readMessage:function(s,n){return this.readFields(s,n,this.readVarint()+this.pos)},readFixed32:function(){var s=Tf(this.buf,this.pos);return this.pos+=4,s},readSFixed32:function(){var s=ix(this.buf,this.pos);return this.pos+=4,s},readFixed64:function(){var s=Tf(this.buf,this.pos)+Tf(this.buf,this.pos+4)*Tg;return this.pos+=8,s},readSFixed64:function(){var s=Tf(this.buf,this.pos)+ix(this.buf,this.pos+4)*Tg;return this.pos+=8,s},readFloat:function(){var s=J0(this.buf,this.pos,!0,23,4);return this.pos+=4,s},readDouble:function(){var s=J0(this.buf,this.pos,!0,52,8);return this.pos+=8,s},readVarint:function(s){var n,o,h=this.buf;return n=127&(o=h[this.pos++]),o<128?n:(n|=(127&(o=h[this.pos++]))<<7,o<128?n:(n|=(127&(o=h[this.pos++]))<<14,o<128?n:(n|=(127&(o=h[this.pos++]))<<21,o<128?n:function(p,y,x){var S,I,P=x.buf;if(S=(112&(I=P[x.pos++]))>>4,I<128||(S|=(127&(I=P[x.pos++]))<<3,I<128)||(S|=(127&(I=P[x.pos++]))<<10,I<128)||(S|=(127&(I=P[x.pos++]))<<17,I<128)||(S|=(127&(I=P[x.pos++]))<<24,I<128)||(S|=(1&(I=P[x.pos++]))<<31,I<128))return Ic(p,S,y);throw new Error("Expected varint not more than 10 bytes")}(n|=(15&(o=h[this.pos]))<<28,s,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var s=this.readVarint();return s%2==1?(s+1)/-2:s/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var s=this.readVarint()+this.pos,n=this.pos;return this.pos=s,s-n>=12&&tx?function(o,h,p){return tx.decode(o.subarray(h,p))}(this.buf,n,s):function(o,h,p){for(var y="",x=h;x<p;){var S,I,P,L=o[x],B=null,N=L>239?4:L>223?3:L>191?2:1;if(x+N>p)break;N===1?L<128&&(B=L):N===2?(192&(S=o[x+1]))==128&&(B=(31&L)<<6|63&S)<=127&&(B=null):N===3?(I=o[x+2],(192&(S=o[x+1]))==128&&(192&I)==128&&((B=(15&L)<<12|(63&S)<<6|63&I)<=2047||B>=55296&&B<=57343)&&(B=null)):N===4&&(I=o[x+2],P=o[x+3],(192&(S=o[x+1]))==128&&(192&I)==128&&(192&P)==128&&((B=(15&L)<<18|(63&S)<<12|(63&I)<<6|63&P)<=65535||B>=1114112)&&(B=null)),B===null?(B=65533,N=1):B>65535&&(B-=65536,y+=String.fromCharCode(B>>>10&1023|55296),B=56320|1023&B),y+=String.fromCharCode(B),x+=N}return y}(this.buf,n,s)},readBytes:function(){var s=this.readVarint()+this.pos,n=this.buf.subarray(this.pos,s);return this.pos=s,n},readPackedVarint:function(s,n){if(this.type!==Ln.Bytes)return s.push(this.readVarint(n));var o=Ba(this);for(s=s||[];this.pos<o;)s.push(this.readVarint(n));return s},readPackedSVarint:function(s){if(this.type!==Ln.Bytes)return s.push(this.readSVarint());var n=Ba(this);for(s=s||[];this.pos<n;)s.push(this.readSVarint());return s},readPackedBoolean:function(s){if(this.type!==Ln.Bytes)return s.push(this.readBoolean());var n=Ba(this);for(s=s||[];this.pos<n;)s.push(this.readBoolean());return s},readPackedFloat:function(s){if(this.type!==Ln.Bytes)return s.push(this.readFloat());var n=Ba(this);for(s=s||[];this.pos<n;)s.push(this.readFloat());return s},readPackedDouble:function(s){if(this.type!==Ln.Bytes)return s.push(this.readDouble());var n=Ba(this);for(s=s||[];this.pos<n;)s.push(this.readDouble());return s},readPackedFixed32:function(s){if(this.type!==Ln.Bytes)return s.push(this.readFixed32());var n=Ba(this);for(s=s||[];this.pos<n;)s.push(this.readFixed32());return s},readPackedSFixed32:function(s){if(this.type!==Ln.Bytes)return s.push(this.readSFixed32());var n=Ba(this);for(s=s||[];this.pos<n;)s.push(this.readSFixed32());return s},readPackedFixed64:function(s){if(this.type!==Ln.Bytes)return s.push(this.readFixed64());var n=Ba(this);for(s=s||[];this.pos<n;)s.push(this.readFixed64());return s},readPackedSFixed64:function(s){if(this.type!==Ln.Bytes)return s.push(this.readSFixed64());var n=Ba(this);for(s=s||[];this.pos<n;)s.push(this.readSFixed64());return s},skip:function(s){var n=7&s;if(n===Ln.Varint)for(;this.buf[this.pos++]>127;);else if(n===Ln.Bytes)this.pos=this.readVarint()+this.pos;else if(n===Ln.Fixed32)this.pos+=4;else{if(n!==Ln.Fixed64)throw new Error("Unimplemented type: "+n);this.pos+=8}},writeTag:function(s,n){this.writeVarint(s<<3|n)},realloc:function(s){for(var n=this.length||16;n<this.pos+s;)n*=2;if(n!==this.length){var o=new Uint8Array(n);o.set(this.buf),this.buf=o,this.length=n}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(s){this.realloc(4),kc(this.buf,s,this.pos),this.pos+=4},writeSFixed32:function(s){this.realloc(4),kc(this.buf,s,this.pos),this.pos+=4},writeFixed64:function(s){this.realloc(8),kc(this.buf,-1&s,this.pos),kc(this.buf,Math.floor(s*ex),this.pos+4),this.pos+=8},writeSFixed64:function(s){this.realloc(8),kc(this.buf,-1&s,this.pos),kc(this.buf,Math.floor(s*ex),this.pos+4),this.pos+=8},writeVarint:function(s){(s=+s||0)>268435455||s<0?function(n,o){var h,p;if(n>=0?(h=n%4294967296|0,p=n/4294967296|0):(p=~(-n/4294967296),4294967295^(h=~(-n%4294967296))?h=h+1|0:(h=0,p=p+1|0)),n>=18446744073709552e3||n<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");o.realloc(10),function(y,x,S){S.buf[S.pos++]=127&y|128,y>>>=7,S.buf[S.pos++]=127&y|128,y>>>=7,S.buf[S.pos++]=127&y|128,y>>>=7,S.buf[S.pos++]=127&y|128,S.buf[S.pos]=127&(y>>>=7)}(h,0,o),function(y,x){var S=(7&y)<<4;x.buf[x.pos++]|=S|((y>>>=3)?128:0),y&&(x.buf[x.pos++]=127&y|((y>>>=7)?128:0),y&&(x.buf[x.pos++]=127&y|((y>>>=7)?128:0),y&&(x.buf[x.pos++]=127&y|((y>>>=7)?128:0),y&&(x.buf[x.pos++]=127&y|((y>>>=7)?128:0),y&&(x.buf[x.pos++]=127&y)))))}(p,o)}(s,this):(this.realloc(4),this.buf[this.pos++]=127&s|(s>127?128:0),s<=127||(this.buf[this.pos++]=127&(s>>>=7)|(s>127?128:0),s<=127||(this.buf[this.pos++]=127&(s>>>=7)|(s>127?128:0),s<=127||(this.buf[this.pos++]=s>>>7&127))))},writeSVarint:function(s){this.writeVarint(s<0?2*-s-1:2*s)},writeBoolean:function(s){this.writeVarint(!!s)},writeString:function(s){s=String(s),this.realloc(4*s.length),this.pos++;var n=this.pos;this.pos=function(h,p,y){for(var x,S,I=0;I<p.length;I++){if((x=p.charCodeAt(I))>55295&&x<57344){if(!S){x>56319||I+1===p.length?(h[y++]=239,h[y++]=191,h[y++]=189):S=x;continue}if(x<56320){h[y++]=239,h[y++]=191,h[y++]=189,S=x;continue}x=S-55296<<10|x-56320|65536,S=null}else S&&(h[y++]=239,h[y++]=191,h[y++]=189,S=null);x<128?h[y++]=x:(x<2048?h[y++]=x>>6|192:(x<65536?h[y++]=x>>12|224:(h[y++]=x>>18|240,h[y++]=x>>12&63|128),h[y++]=x>>6&63|128),h[y++]=63&x|128)}return y}(this.buf,s,this.pos);var o=this.pos-n;o>=128&&nx(n,o,this),this.pos=n-1,this.writeVarint(o),this.pos+=o},writeFloat:function(s){this.realloc(4),Q0(this.buf,s,this.pos,!0,23,4),this.pos+=4},writeDouble:function(s){this.realloc(8),Q0(this.buf,s,this.pos,!0,52,8),this.pos+=8},writeBytes:function(s){var n=s.length;this.writeVarint(n),this.realloc(n);for(var o=0;o<n;o++)this.buf[this.pos++]=s[o]},writeRawMessage:function(s,n){this.pos++;var o=this.pos;s(n,this);var h=this.pos-o;h>=128&&nx(o,h,this),this.pos=o-1,this.writeVarint(h),this.pos+=h},writeMessage:function(s,n,o){this.writeTag(s,Ln.Bytes),this.writeRawMessage(n,o)},writePackedVarint:function(s,n){n.length&&this.writeMessage(s,_I,n)},writePackedSVarint:function(s,n){n.length&&this.writeMessage(s,yI,n)},writePackedBoolean:function(s,n){n.length&&this.writeMessage(s,bI,n)},writePackedFloat:function(s,n){n.length&&this.writeMessage(s,vI,n)},writePackedDouble:function(s,n){n.length&&this.writeMessage(s,xI,n)},writePackedFixed32:function(s,n){n.length&&this.writeMessage(s,wI,n)},writePackedSFixed32:function(s,n){n.length&&this.writeMessage(s,SI,n)},writePackedFixed64:function(s,n){n.length&&this.writeMessage(s,EI,n)},writePackedSFixed64:function(s,n){n.length&&this.writeMessage(s,TI,n)},writeBytesField:function(s,n){this.writeTag(s,Ln.Bytes),this.writeBytes(n)},writeFixed32Field:function(s,n){this.writeTag(s,Ln.Fixed32),this.writeFixed32(n)},writeSFixed32Field:function(s,n){this.writeTag(s,Ln.Fixed32),this.writeSFixed32(n)},writeFixed64Field:function(s,n){this.writeTag(s,Ln.Fixed64),this.writeFixed64(n)},writeSFixed64Field:function(s,n){this.writeTag(s,Ln.Fixed64),this.writeSFixed64(n)},writeVarintField:function(s,n){this.writeTag(s,Ln.Varint),this.writeVarint(n)},writeSVarintField:function(s,n){this.writeTag(s,Ln.Varint),this.writeSVarint(n)},writeStringField:function(s,n){this.writeTag(s,Ln.Bytes),this.writeString(n)},writeFloatField:function(s,n){this.writeTag(s,Ln.Fixed32),this.writeFloat(n)},writeDoubleField:function(s,n){this.writeTag(s,Ln.Fixed64),this.writeDouble(n)},writeBooleanField:function(s,n){this.writeVarintField(s,!!n)}};var Cg=b(K0);const Ig=3;function CI(s,n,o){s===1&&o.readMessage(II,n)}function II(s,n,o){if(s===3){const{id:h,bitmap:p,width:y,height:x,left:S,top:I,advance:P}=o.readMessage(kI,{});n.push({id:h,bitmap:new ch({width:y+2*Ig,height:x+2*Ig},p),metrics:{width:y,height:x,left:S,top:I,advance:P}})}}function kI(s,n,o){s===1?n.id=o.readVarint():s===2?n.bitmap=o.readBytes():s===3?n.width=o.readVarint():s===4?n.height=o.readVarint():s===5?n.left=o.readSVarint():s===6?n.top=o.readSVarint():s===7&&(n.advance=o.readVarint())}const rx=Ig;function sx(s){let n=0,o=0;for(const x of s)n+=x.w*x.h,o=Math.max(o,x.w);s.sort((x,S)=>S.h-x.h);const h=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(n/.95)),o),h:1/0}];let p=0,y=0;for(const x of s)for(let S=h.length-1;S>=0;S--){const I=h[S];if(!(x.w>I.w||x.h>I.h)){if(x.x=I.x,x.y=I.y,y=Math.max(y,x.y+x.h),p=Math.max(p,x.x+x.w),x.w===I.w&&x.h===I.h){const P=h.pop();S<h.length&&(h[S]=P)}else x.h===I.h?(I.x+=x.w,I.w-=x.w):x.w===I.w?(I.y+=x.h,I.h-=x.h):(h.push({x:I.x+x.w,y:I.y,w:I.w-x.w,h:x.h}),I.y+=x.h,I.h-=x.h);break}}return{w:p,h:y,fill:n/(p*y)||0}}const Pr=1;class kg{constructor(n,{pixelRatio:o,version:h,stretchX:p,stretchY:y,content:x}){this.paddedRect=n,this.pixelRatio=o,this.stretchX=p,this.stretchY=y,this.content=x,this.version=h}get tl(){return[this.paddedRect.x+Pr,this.paddedRect.y+Pr]}get br(){return[this.paddedRect.x+this.paddedRect.w-Pr,this.paddedRect.y+this.paddedRect.h-Pr]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2*Pr)/this.pixelRatio,(this.paddedRect.h-2*Pr)/this.pixelRatio]}}class ax{constructor(n,o){const h={},p={};this.haveRenderCallbacks=[];const y=[];this.addImages(n,h,y),this.addImages(o,p,y);const{w:x,h:S}=sx(y),I=new ss({width:x||1,height:S||1});for(const P in n){const L=n[P],B=h[P].paddedRect;ss.copy(L.data,I,{x:0,y:0},{x:B.x+Pr,y:B.y+Pr},L.data)}for(const P in o){const L=o[P],B=p[P].paddedRect,N=B.x+Pr,q=B.y+Pr,H=L.data.width,ee=L.data.height;ss.copy(L.data,I,{x:0,y:0},{x:N,y:q},L.data),ss.copy(L.data,I,{x:0,y:ee-1},{x:N,y:q-1},{width:H,height:1}),ss.copy(L.data,I,{x:0,y:0},{x:N,y:q+ee},{width:H,height:1}),ss.copy(L.data,I,{x:H-1,y:0},{x:N-1,y:q},{width:1,height:ee}),ss.copy(L.data,I,{x:0,y:0},{x:N+H,y:q},{width:1,height:ee})}this.image=I,this.iconPositions=h,this.patternPositions=p}addImages(n,o,h){for(const p in n){const y=n[p],x={x:0,y:0,w:y.data.width+2*Pr,h:y.data.height+2*Pr};h.push(x),o[p]=new kg(x,y),y.hasRenderCallback&&this.haveRenderCallbacks.push(p)}}patchUpdatedImages(n,o){n.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const h in n.updatedImages)this.patchUpdatedImage(this.iconPositions[h],n.getImage(h),o),this.patchUpdatedImage(this.patternPositions[h],n.getImage(h),o)}patchUpdatedImage(n,o,h){if(!n||!o||n.version===o.version)return;n.version=o.version;const[p,y]=n.tl;h.update(o.data,void 0,{x:p,y})}}var xo;St("ImagePosition",kg),St("ImageAtlas",ax),l.WritingMode=void 0,(xo=l.WritingMode||(l.WritingMode={}))[xo.none=0]="none",xo[xo.horizontal=1]="horizontal",xo[xo.vertical=2]="vertical",xo[xo.horizontalOnly=3]="horizontalOnly";const _h=-17;class yh{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(n,o){const h=new yh;return h.scale=n||1,h.fontStack=o,h}static forImage(n){const o=new yh;return o.imageName=n,o}}class Ac{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(n,o){const h=new Ac;for(let p=0;p<n.sections.length;p++){const y=n.sections[p];y.image?h.addImageSection(y):h.addTextSection(y,o)}return h}length(){return this.text.length}getSection(n){return this.sections[this.sectionIndex[n]]}getSectionIndex(n){return this.sectionIndex[n]}getCharCode(n){return this.text.charCodeAt(n)}verticalizePunctuation(){this.text=function(n){let o="";for(let h=0;h<n.length;h++){const p=n.charCodeAt(h+1)||null,y=n.charCodeAt(h-1)||null;o+=p&&qu(p)&&!gh[n[h+1]]||y&&qu(y)&&!gh[n[h-1]]||!gh[n[h]]?n[h]:gh[n[h]]}return o}(this.text)}trim(){let n=0;for(let h=0;h<this.text.length&&If[this.text.charCodeAt(h)];h++)n++;let o=this.text.length;for(let h=this.text.length-1;h>=0&&h>=n&&If[this.text.charCodeAt(h)];h--)o--;this.text=this.text.substring(n,o),this.sectionIndex=this.sectionIndex.slice(n,o)}substring(n,o){const h=new Ac;return h.text=this.text.substring(n,o),h.sectionIndex=this.sectionIndex.slice(n,o),h.sections=this.sections,h}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((n,o)=>Math.max(n,this.sections[o].scale),0)}addTextSection(n,o){this.text+=n.text,this.sections.push(yh.forText(n.scale,n.fontStack||o));const h=this.sections.length-1;for(let p=0;p<n.text.length;++p)this.sectionIndex.push(h)}addImageSection(n){const o=n.image?n.image.name:"";if(o.length===0)return void Z("Can't add FormattedSection with an empty image.");const h=this.getNextImageSectionCharCode();h?(this.text+=String.fromCharCode(h),this.sections.push(yh.forImage(o)),this.sectionIndex.push(this.sections.length-1)):Z("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function Cf(s,n,o,h,p,y,x,S,I,P,L,B,N,q,H,ee){const ie=Ac.fromFeature(s,p);let ce;B===l.WritingMode.vertical&&ie.verticalizePunctuation();const{processBidirectionalText:Ee,processStyledBidirectionalText:me}=Zr;if(Ee&&ie.sections.length===1){ce=[];const Ye=Ee(ie.toString(),Ag(ie,P,y,n,h,q,H));for(const wt of Ye){const Dt=new Ac;Dt.text=wt,Dt.sections=ie.sections;for(let xt=0;xt<wt.length;xt++)Dt.sectionIndex.push(0);ce.push(Dt)}}else if(me){ce=[];const Ye=me(ie.text,ie.sectionIndex,Ag(ie,P,y,n,h,q,H));for(const wt of Ye){const Dt=new Ac;Dt.text=wt[0],Dt.sectionIndex=wt[1],Dt.sections=ie.sections,ce.push(Dt)}}else ce=function(Ye,wt){const Dt=[],xt=Ye.text;let vt=0;for(const mt of wt)Dt.push(Ye.substring(vt,mt)),vt=mt;return vt<xt.length&&Dt.push(Ye.substring(vt,xt.length)),Dt}(ie,Ag(ie,P,y,n,h,q,H));const Ae=[],ze={positionedLines:Ae,text:ie.toString(),top:L[1],bottom:L[1],left:L[0],right:L[0],writingMode:B,iconsInText:!1,verticalizable:!1};return function(Ye,wt,Dt,xt,vt,mt,Tt,gt,lt,Vt,zt,rn){let jn=0,Wn=_h,Pi=0,Wr=0;const _r=gt==="right"?1:gt==="left"?0:.5;let Si=0;for(const Ei of vt){Ei.trim();const Ri=Ei.getMaxScale(),rr=(Ri-1)*Ai,vr={positionedGlyphs:[],lineOffset:0};Ye.positionedLines[Si]=vr;const Mr=vr.positionedGlyphs;let Dr=0;if(!Ei.length()){Wn+=mt,++Si;continue}for(let Ki=0;Ki<Ei.length();Ki++){const dn=Ei.getSection(Ki),Yr=Ei.getSectionIndex(Ki),Ji=Ei.getCharCode(Ki);let xr=0,vs=null,zs=null,Os=null,Fa=Ai;const xs=!(lt===l.WritingMode.horizontal||!zt&&!ho(Ji)||zt&&(If[Ji]||(Fi=Ji,bt.Arabic(Fi)||bt["Arabic Supplement"](Fi)||bt["Arabic Extended-A"](Fi)||bt["Arabic Presentation Forms-A"](Fi)||bt["Arabic Presentation Forms-B"](Fi))));if(dn.imageName){const os=xt[dn.imageName];if(!os)continue;Os=dn.imageName,Ye.iconsInText=Ye.iconsInText||!0,zs=os.paddedRect;const Lr=os.displaySize;dn.scale=dn.scale*Ai/rn,vs={width:Lr[0],height:Lr[1],left:Pr,top:-rx,advance:xs?Lr[1]:Lr[0]},xr=rr+(Ai-Lr[1]*dn.scale),Fa=vs.advance;const Na=xs?Lr[0]*dn.scale-Ai*Ri:Lr[1]*dn.scale-Ai*Ri;Na>0&&Na>Dr&&(Dr=Na)}else{const os=Dt[dn.fontStack],Lr=os&&os[Ji];if(Lr&&Lr.rect)zs=Lr.rect,vs=Lr.metrics;else{const Na=wt[dn.fontStack],Sh=Na&&Na[Ji];if(!Sh)continue;vs=Sh.metrics}xr=(Ri-dn.scale)*Ai}xs?(Ye.verticalizable=!0,Mr.push({glyph:Ji,imageName:Os,x:jn,y:Wn+xr,vertical:xs,scale:dn.scale,fontStack:dn.fontStack,sectionIndex:Yr,metrics:vs,rect:zs}),jn+=Fa*dn.scale+Vt):(Mr.push({glyph:Ji,imageName:Os,x:jn,y:Wn+xr,vertical:xs,scale:dn.scale,fontStack:dn.fontStack,sectionIndex:Yr,metrics:vs,rect:zs}),jn+=vs.advance*dn.scale+Vt)}Mr.length!==0&&(Pi=Math.max(jn-Vt,Pi),RI(Mr,0,Mr.length-1,_r,Dr)),jn=0;const ci=mt*Ri+Dr;vr.lineOffset=Math.max(Dr,rr),Wn+=ci,Wr=Math.max(ci,Wr),++Si}var Fi;const Xi=Wn-_h,{horizontalAlign:Rr,verticalAlign:yr}=Pg(Tt);(function(Ei,Ri,rr,vr,Mr,Dr,ci,Ki,dn){const Yr=(Ri-rr)*Mr;let Ji=0;Ji=Dr!==ci?-Ki*vr-_h:(-vr*dn+.5)*ci;for(const xr of Ei)for(const vs of xr.positionedGlyphs)vs.x+=Yr,vs.y+=Ji})(Ye.positionedLines,_r,Rr,yr,Pi,Wr,mt,Xi,vt.length),Ye.top+=-yr*Xi,Ye.bottom=Ye.top+Xi,Ye.left+=-Rr*Pi,Ye.right=Ye.left+Pi}(ze,n,o,h,ce,x,S,I,B,P,N,ee),!function(Ye){for(const wt of Ye)if(wt.positionedGlyphs.length!==0)return!1;return!0}(Ae)&&ze}const If={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},AI={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function ox(s,n,o,h,p,y){if(n.imageName){const x=h[n.imageName];return x?x.displaySize[0]*n.scale*Ai/y+p:0}{const x=o[n.fontStack],S=x&&x[s];return S?S.metrics.advance*n.scale+p:0}}function lx(s,n,o,h){const p=Math.pow(s-n,2);return h?s<n?p/2:2*p:p+Math.abs(o)*o}function PI(s,n,o){let h=0;return s===10&&(h-=1e4),o&&(h+=150),s!==40&&s!==65288||(h+=50),n!==41&&n!==65289||(h+=50),h}function cx(s,n,o,h,p,y){let x=null,S=lx(n,o,p,y);for(const I of h){const P=lx(n-I.x,o,p,y)+I.badness;P<=S&&(x=I,S=P)}return{index:s,x:n,priorBreak:x,badness:S}}function ux(s){return s?ux(s.priorBreak).concat(s.index):[]}function Ag(s,n,o,h,p,y,x){if(y!=="point")return[];if(!s)return[];const S=[],I=function(N,q,H,ee,ie,ce){let Ee=0;for(let me=0;me<N.length();me++){const Ae=N.getSection(me);Ee+=ox(N.getCharCode(me),Ae,ee,ie,q,ce)}return Ee/Math.max(1,Math.ceil(Ee/H))}(s,n,o,h,p,x),P=s.text.indexOf("​")>=0;let L=0;for(let N=0;N<s.length();N++){const q=s.getSection(N),H=s.getCharCode(N);if(If[H]||(L+=ox(H,q,h,p,n,x)),N<s.length()-1){const ee=!((B=H)<11904||!(bt["Bopomofo Extended"](B)||bt.Bopomofo(B)||bt["CJK Compatibility Forms"](B)||bt["CJK Compatibility Ideographs"](B)||bt["CJK Compatibility"](B)||bt["CJK Radicals Supplement"](B)||bt["CJK Strokes"](B)||bt["CJK Symbols and Punctuation"](B)||bt["CJK Unified Ideographs Extension A"](B)||bt["CJK Unified Ideographs"](B)||bt["Enclosed CJK Letters and Months"](B)||bt["Halfwidth and Fullwidth Forms"](B)||bt.Hiragana(B)||bt["Ideographic Description Characters"](B)||bt["Kangxi Radicals"](B)||bt["Katakana Phonetic Extensions"](B)||bt.Katakana(B)||bt["Vertical Forms"](B)||bt["Yi Radicals"](B)||bt["Yi Syllables"](B)));(AI[H]||ee||q.imageName)&&S.push(cx(N+1,L,I,S,PI(H,s.getCharCode(N+1),ee&&P),!1))}}var B;return ux(cx(s.length(),L,I,S,0,!0))}function Pg(s){let n=.5,o=.5;switch(s){case"right":case"top-right":case"bottom-right":n=1;break;case"left":case"top-left":case"bottom-left":n=0}switch(s){case"bottom":case"bottom-right":case"bottom-left":o=1;break;case"top":case"top-right":case"top-left":o=0}return{horizontalAlign:n,verticalAlign:o}}function RI(s,n,o,h,p){if(!h&&!p)return;const y=s[o],x=(s[o].x+y.metrics.advance*y.scale)*h;for(let S=n;S<=o;S++)s[S].x-=x,s[S].y+=p}function MI(s,n,o){const{horizontalAlign:h,verticalAlign:p}=Pg(o),y=n[0]-s.displaySize[0]*h,x=n[1]-s.displaySize[1]*p;return{image:s,top:x,bottom:x+s.displaySize[1],left:y,right:y+s.displaySize[0]}}function hx(s,n,o,h,p,y){const x=s.image;let S;if(x.content){const ie=x.content,ce=x.pixelRatio||1;S=[ie[0]/ce,ie[1]/ce,x.displaySize[0]-ie[2]/ce,x.displaySize[1]-ie[3]/ce]}const I=n.left*y,P=n.right*y;let L,B,N,q;o==="width"||o==="both"?(q=p[0]+I-h[3],B=p[0]+P+h[1]):(q=p[0]+(I+P-x.displaySize[0])/2,B=q+x.displaySize[0]);const H=n.top*y,ee=n.bottom*y;return o==="height"||o==="both"?(L=p[1]+H-h[0],N=p[1]+ee+h[2]):(L=p[1]+(H+ee-x.displaySize[1])/2,N=L+x.displaySize[1]),{image:x,top:L,right:B,bottom:N,left:q,collisionPadding:S}}const vh=255,aa=128,bo=vh*aa;function dx(s,n){const{expression:o}=n;if(o.kind==="constant")return{kind:"constant",layoutSize:o.evaluate(new Zn(s+1))};if(o.kind==="source")return{kind:"source"};{const{zoomStops:h,interpolationType:p}=o;let y=0;for(;y<h.length&&h[y]<=s;)y++;y=Math.max(0,y-1);let x=y;for(;x<h.length&&h[x]<s+1;)x++;x=Math.min(h.length-1,x);const S=h[y],I=h[x];return o.kind==="composite"?{kind:"composite",minZoom:S,maxZoom:I,interpolationType:p}:{kind:"camera",minZoom:S,maxZoom:I,minSize:o.evaluate(new Zn(S)),maxSize:o.evaluate(new Zn(I)),interpolationType:p}}}function Rg(s,n,o){let h="never";const p=s.get(n);return p?h=p:s.get(o)&&(h="always"),h}const DI=vo.VectorTileFeature.types,LI=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function kf(s,n,o,h,p,y,x,S,I,P,L,B,N){const q=S?Math.min(bo,Math.round(S[0])):0,H=S?Math.min(bo,Math.round(S[1])):0;s.emplaceBack(n,o,Math.round(32*h),Math.round(32*p),y,x,(q<<1)+(I?1:0),H,16*P,16*L,256*B,256*N)}function Mg(s,n,o){s.emplaceBack(n.x,n.y,o),s.emplaceBack(n.x,n.y,o),s.emplaceBack(n.x,n.y,o),s.emplaceBack(n.x,n.y,o)}function zI(s){for(const n of s.sections)if(ag(n.text))return!0;return!1}class Dg{constructor(n){this.layoutVertexArray=new dt,this.indexArray=new Ct,this.programConfigurations=n,this.segments=new Zt,this.dynamicLayoutVertexArray=new Mt,this.opacityVertexArray=new cn,this.hasVisibleVertices=!1,this.placedSymbolArray=new D}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(n,o,h,p){this.isEmpty()||(h&&(this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,dI.members),this.indexBuffer=n.createIndexBuffer(this.indexArray,o),this.dynamicLayoutVertexBuffer=n.createVertexBuffer(this.dynamicLayoutVertexArray,fI.members,!0),this.opacityVertexBuffer=n.createVertexBuffer(this.opacityVertexArray,LI,!0),this.opacityVertexBuffer.itemSize=1),(h||p)&&this.programConfigurations.upload(n))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}St("SymbolBuffers",Dg);class Lg{constructor(n,o,h){this.layoutVertexArray=new n,this.layoutAttributes=o,this.indexArray=new h,this.segments=new Zt,this.collisionVertexArray=new Ht}upload(n){this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=n.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=n.createVertexBuffer(this.collisionVertexArray,pI.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}St("CollisionBuffers",Lg);class Pc{constructor(n){this.collisionBoxArray=n.collisionBoxArray,this.zoom=n.zoom,this.overscaling=n.overscaling,this.layers=n.layers,this.layerIds=this.layers.map(x=>x.id),this.index=n.index,this.pixelRatio=n.pixelRatio,this.sourceLayerIndex=n.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=hg([]),this.placementViewportMatrix=hg([]);const o=this.layers[0]._unevaluatedLayout._values;this.textSizeData=dx(this.zoom,o["text-size"]),this.iconSizeData=dx(this.zoom,o["icon-size"]);const h=this.layers[0].layout,p=h.get("symbol-sort-key"),y=h.get("symbol-z-order");this.canOverlap=Rg(h,"text-overlap","text-allow-overlap")!=="never"||Rg(h,"icon-overlap","icon-allow-overlap")!=="never"||h.get("text-ignore-placement")||h.get("icon-ignore-placement"),this.sortFeaturesByKey=y!=="viewport-y"&&!p.isConstant(),this.sortFeaturesByY=(y==="viewport-y"||y==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,h.get("symbol-placement")==="point"&&(this.writingModes=h.get("text-writing-mode").map(x=>l.WritingMode[x])),this.stateDependentLayerIds=this.layers.filter(x=>x.isStateDependent()).map(x=>x.id),this.sourceID=n.sourceID}createArrays(){this.text=new Dg(new Oa(this.layers,this.zoom,n=>/^text/.test(n))),this.icon=new Dg(new Oa(this.layers,this.zoom,n=>/^icon/.test(n))),this.glyphOffsetArray=new Q,this.lineVertexArray=new J,this.symbolInstances=new G,this.textAnchorOffsets=new K}calculateGlyphDependencies(n,o,h,p,y){for(let x=0;x<n.length;x++)if(o[n.charCodeAt(x)]=!0,(h||p)&&y){const S=gh[n.charAt(x)];S&&(o[S.charCodeAt(0)]=!0)}}populate(n,o,h){const p=this.layers[0],y=p.layout,x=y.get("text-font"),S=y.get("text-field"),I=y.get("icon-image"),P=(S.value.kind!=="constant"||S.value.value instanceof di&&!S.value.value.isEmpty()||S.value.value.toString().length>0)&&(x.value.kind!=="constant"||x.value.value.length>0),L=I.value.kind!=="constant"||!!I.value.value||Object.keys(I.parameters).length>0,B=y.get("symbol-sort-key");if(this.features=[],!P&&!L)return;const N=o.iconDependencies,q=o.glyphDependencies,H=o.availableImages,ee=new Zn(this.zoom);for(const{feature:ie,id:ce,index:Ee,sourceLayerIndex:me}of n){const Ae=p._featureFilter.needGeometry,ze=Ls(ie,Ae);if(!p._featureFilter.filter(ee,ze,h))continue;let Ye,wt;if(Ae||(ze.geometry=sa(ie)),P){const xt=p.getValueAndResolveTokens("text-field",ze,h,H),vt=di.factory(xt);zI(vt)&&(this.hasRTLText=!0),(!this.hasRTLText||Ku()==="unavailable"||this.hasRTLText&&Zr.isParsed())&&(Ye=gI(vt,p,ze))}if(L){const xt=p.getValueAndResolveTokens("icon-image",ze,h,H);wt=xt instanceof Gr?xt:Gr.fromString(xt)}if(!Ye&&!wt)continue;const Dt=this.sortFeaturesByKey?B.evaluate(ze,{},h):void 0;if(this.features.push({id:ce,text:Ye,icon:wt,index:Ee,sourceLayerIndex:me,geometry:ze.geometry,properties:ie.properties,type:DI[ie.type],sortKey:Dt}),wt&&(N[wt.name]=!0),Ye){const xt=x.evaluate(ze,{},h).join(","),vt=y.get("text-rotation-alignment")!=="viewport"&&y.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(l.WritingMode.vertical)>=0;for(const mt of Ye.sections)if(mt.image)N[mt.image.name]=!0;else{const Tt=fc(Ye.toString()),gt=mt.fontStack||xt,lt=q[gt]=q[gt]||{};this.calculateGlyphDependencies(mt.text,lt,vt,this.allowVerticalPlacement,Tt)}}}y.get("symbol-placement")==="line"&&(this.features=function(ie){const ce={},Ee={},me=[];let Ae=0;function ze(xt){me.push(ie[xt]),Ae++}function Ye(xt,vt,mt){const Tt=Ee[xt];return delete Ee[xt],Ee[vt]=Tt,me[Tt].geometry[0].pop(),me[Tt].geometry[0]=me[Tt].geometry[0].concat(mt[0]),Tt}function wt(xt,vt,mt){const Tt=ce[vt];return delete ce[vt],ce[xt]=Tt,me[Tt].geometry[0].shift(),me[Tt].geometry[0]=mt[0].concat(me[Tt].geometry[0]),Tt}function Dt(xt,vt,mt){const Tt=mt?vt[0][vt[0].length-1]:vt[0][0];return`${xt}:${Tt.x}:${Tt.y}`}for(let xt=0;xt<ie.length;xt++){const vt=ie[xt],mt=vt.geometry,Tt=vt.text?vt.text.toString():null;if(!Tt){ze(xt);continue}const gt=Dt(Tt,mt),lt=Dt(Tt,mt,!0);if(gt in Ee&&lt in ce&&Ee[gt]!==ce[lt]){const Vt=wt(gt,lt,mt),zt=Ye(gt,lt,me[Vt].geometry);delete ce[gt],delete Ee[lt],Ee[Dt(Tt,me[zt].geometry,!0)]=zt,me[Vt].geometry=null}else gt in Ee?Ye(gt,lt,mt):lt in ce?wt(gt,lt,mt):(ze(xt),ce[gt]=Ae-1,Ee[lt]=Ae-1)}return me.filter(xt=>xt.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((ie,ce)=>ie.sortKey-ce.sortKey)}update(n,o,h){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(n,o,this.layers,h),this.icon.programConfigurations.updatePaintArrays(n,o,this.layers,h))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(n){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(n),this.iconCollisionBox.upload(n)),this.text.upload(n,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(n,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(n,o){const h=this.lineVertexArray.length;if(n.segment!==void 0){let p=n.dist(o[n.segment+1]),y=n.dist(o[n.segment]);const x={};for(let S=n.segment+1;S<o.length;S++)x[S]={x:o[S].x,y:o[S].y,tileUnitDistanceFromAnchor:p},S<o.length-1&&(p+=o[S+1].dist(o[S]));for(let S=n.segment||0;S>=0;S--)x[S]={x:o[S].x,y:o[S].y,tileUnitDistanceFromAnchor:y},S>0&&(y+=o[S-1].dist(o[S]));for(let S=0;S<o.length;S++){const I=x[S];this.lineVertexArray.emplaceBack(I.x,I.y,I.tileUnitDistanceFromAnchor)}}return{lineStartIndex:h,lineLength:this.lineVertexArray.length-h}}addSymbols(n,o,h,p,y,x,S,I,P,L,B,N){const q=n.indexArray,H=n.layoutVertexArray,ee=n.segments.prepareSegment(4*o.length,H,q,this.canOverlap?x.sortKey:void 0),ie=this.glyphOffsetArray.length,ce=ee.vertexLength,Ee=this.allowVerticalPlacement&&S===l.WritingMode.vertical?Math.PI/2:0,me=x.text&&x.text.sections;for(let Ae=0;Ae<o.length;Ae++){const{tl:ze,tr:Ye,bl:wt,br:Dt,tex:xt,pixelOffsetTL:vt,pixelOffsetBR:mt,minFontScaleX:Tt,minFontScaleY:gt,glyphOffset:lt,isSDF:Vt,sectionIndex:zt}=o[Ae],rn=ee.vertexLength,jn=lt[1];kf(H,I.x,I.y,ze.x,jn+ze.y,xt.x,xt.y,h,Vt,vt.x,vt.y,Tt,gt),kf(H,I.x,I.y,Ye.x,jn+Ye.y,xt.x+xt.w,xt.y,h,Vt,mt.x,vt.y,Tt,gt),kf(H,I.x,I.y,wt.x,jn+wt.y,xt.x,xt.y+xt.h,h,Vt,vt.x,mt.y,Tt,gt),kf(H,I.x,I.y,Dt.x,jn+Dt.y,xt.x+xt.w,xt.y+xt.h,h,Vt,mt.x,mt.y,Tt,gt),Mg(n.dynamicLayoutVertexArray,I,Ee),q.emplaceBack(rn,rn+1,rn+2),q.emplaceBack(rn+1,rn+2,rn+3),ee.vertexLength+=4,ee.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(lt[0]),Ae!==o.length-1&&zt===o[Ae+1].sectionIndex||n.programConfigurations.populatePaintArrays(H.length,x,x.index,{},N,me&&me[zt])}n.placedSymbolArray.emplaceBack(I.x,I.y,ie,this.glyphOffsetArray.length-ie,ce,P,L,I.segment,h?h[0]:0,h?h[1]:0,p[0],p[1],S,0,!1,0,B)}_addCollisionDebugVertex(n,o,h,p,y,x){return o.emplaceBack(0,0),n.emplaceBack(h.x,h.y,p,y,Math.round(x.x),Math.round(x.y))}addCollisionDebugVertices(n,o,h,p,y,x,S){const I=y.segments.prepareSegment(4,y.layoutVertexArray,y.indexArray),P=I.vertexLength,L=y.layoutVertexArray,B=y.collisionVertexArray,N=S.anchorX,q=S.anchorY;this._addCollisionDebugVertex(L,B,x,N,q,new k(n,o)),this._addCollisionDebugVertex(L,B,x,N,q,new k(h,o)),this._addCollisionDebugVertex(L,B,x,N,q,new k(h,p)),this._addCollisionDebugVertex(L,B,x,N,q,new k(n,p)),I.vertexLength+=4;const H=y.indexArray;H.emplaceBack(P,P+1),H.emplaceBack(P+1,P+2),H.emplaceBack(P+2,P+3),H.emplaceBack(P+3,P),I.primitiveLength+=4}addDebugCollisionBoxes(n,o,h,p){for(let y=n;y<o;y++){const x=this.collisionBoxArray.get(y);this.addCollisionDebugVertices(x.x1,x.y1,x.x2,x.y2,p?this.textCollisionBox:this.iconCollisionBox,x.anchorPoint,h)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new Lg(_t,X0.members,Fn),this.iconCollisionBox=new Lg(_t,X0.members,Fn);for(let n=0;n<this.symbolInstances.length;n++){const o=this.symbolInstances.get(n);this.addDebugCollisionBoxes(o.textBoxStartIndex,o.textBoxEndIndex,o,!0),this.addDebugCollisionBoxes(o.verticalTextBoxStartIndex,o.verticalTextBoxEndIndex,o,!0),this.addDebugCollisionBoxes(o.iconBoxStartIndex,o.iconBoxEndIndex,o,!1),this.addDebugCollisionBoxes(o.verticalIconBoxStartIndex,o.verticalIconBoxEndIndex,o,!1)}}_deserializeCollisionBoxesForSymbol(n,o,h,p,y,x,S,I,P){const L={};for(let B=o;B<h;B++){const N=n.get(B);L.textBox={x1:N.x1,y1:N.y1,x2:N.x2,y2:N.y2,anchorPointX:N.anchorPointX,anchorPointY:N.anchorPointY},L.textFeatureIndex=N.featureIndex;break}for(let B=p;B<y;B++){const N=n.get(B);L.verticalTextBox={x1:N.x1,y1:N.y1,x2:N.x2,y2:N.y2,anchorPointX:N.anchorPointX,anchorPointY:N.anchorPointY},L.verticalTextFeatureIndex=N.featureIndex;break}for(let B=x;B<S;B++){const N=n.get(B);L.iconBox={x1:N.x1,y1:N.y1,x2:N.x2,y2:N.y2,anchorPointX:N.anchorPointX,anchorPointY:N.anchorPointY},L.iconFeatureIndex=N.featureIndex;break}for(let B=I;B<P;B++){const N=n.get(B);L.verticalIconBox={x1:N.x1,y1:N.y1,x2:N.x2,y2:N.y2,anchorPointX:N.anchorPointX,anchorPointY:N.anchorPointY},L.verticalIconFeatureIndex=N.featureIndex;break}return L}deserializeCollisionBoxes(n){this.collisionArrays=[];for(let o=0;o<this.symbolInstances.length;o++){const h=this.symbolInstances.get(o);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(n,h.textBoxStartIndex,h.textBoxEndIndex,h.verticalTextBoxStartIndex,h.verticalTextBoxEndIndex,h.iconBoxStartIndex,h.iconBoxEndIndex,h.verticalIconBoxStartIndex,h.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(n,o){const h=n.placedSymbolArray.get(o),p=h.vertexStartIndex+4*h.numGlyphs;for(let y=h.vertexStartIndex;y<p;y+=4)n.indexArray.emplaceBack(y,y+1,y+2),n.indexArray.emplaceBack(y+1,y+2,y+3)}getSortedSymbolIndexes(n){if(this.sortedAngle===n&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const o=Math.sin(n),h=Math.cos(n),p=[],y=[],x=[];for(let S=0;S<this.symbolInstances.length;++S){x.push(S);const I=this.symbolInstances.get(S);p.push(0|Math.round(o*I.anchorX+h*I.anchorY)),y.push(I.featureIndex)}return x.sort((S,I)=>p[S]-p[I]||y[I]-y[S]),x}addToSortKeyRanges(n,o){const h=this.sortKeyRanges[this.sortKeyRanges.length-1];h&&h.sortKey===o?h.symbolInstanceEnd=n+1:this.sortKeyRanges.push({sortKey:o,symbolInstanceStart:n,symbolInstanceEnd:n+1})}sortFeatures(n){if(this.sortFeaturesByY&&this.sortedAngle!==n&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(n),this.sortedAngle=n,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const o of this.symbolInstanceIndexes){const h=this.symbolInstances.get(o);this.featureSortOrder.push(h.featureIndex),[h.rightJustifiedTextSymbolIndex,h.centerJustifiedTextSymbolIndex,h.leftJustifiedTextSymbolIndex].forEach((p,y,x)=>{p>=0&&x.indexOf(p)===y&&this.addIndicesForPlacedSymbol(this.text,p)}),h.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,h.verticalPlacedTextSymbolIndex),h.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,h.placedIconSymbolIndex),h.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,h.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let fx,px;St("SymbolBucket",Pc,{omit:["layers","collisionBoxArray","features","compareText"]}),Pc.MAX_GLYPHS=65535,Pc.addDynamicAttributes=Mg;var zg={get paint(){return px=px||new ki({"icon-opacity":new qt(U.paint_symbol["icon-opacity"]),"icon-color":new qt(U.paint_symbol["icon-color"]),"icon-halo-color":new qt(U.paint_symbol["icon-halo-color"]),"icon-halo-width":new qt(U.paint_symbol["icon-halo-width"]),"icon-halo-blur":new qt(U.paint_symbol["icon-halo-blur"]),"icon-translate":new Ot(U.paint_symbol["icon-translate"]),"icon-translate-anchor":new Ot(U.paint_symbol["icon-translate-anchor"]),"text-opacity":new qt(U.paint_symbol["text-opacity"]),"text-color":new qt(U.paint_symbol["text-color"],{runtimeType:On,getOverride:s=>s.textColor,hasOverride:s=>!!s.textColor}),"text-halo-color":new qt(U.paint_symbol["text-halo-color"]),"text-halo-width":new qt(U.paint_symbol["text-halo-width"]),"text-halo-blur":new qt(U.paint_symbol["text-halo-blur"]),"text-translate":new Ot(U.paint_symbol["text-translate"]),"text-translate-anchor":new Ot(U.paint_symbol["text-translate-anchor"])})},get layout(){return fx=fx||new ki({"symbol-placement":new Ot(U.layout_symbol["symbol-placement"]),"symbol-spacing":new Ot(U.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Ot(U.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new qt(U.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Ot(U.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new Ot(U.layout_symbol["icon-allow-overlap"]),"icon-overlap":new Ot(U.layout_symbol["icon-overlap"]),"icon-ignore-placement":new Ot(U.layout_symbol["icon-ignore-placement"]),"icon-optional":new Ot(U.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Ot(U.layout_symbol["icon-rotation-alignment"]),"icon-size":new qt(U.layout_symbol["icon-size"]),"icon-text-fit":new Ot(U.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Ot(U.layout_symbol["icon-text-fit-padding"]),"icon-image":new qt(U.layout_symbol["icon-image"]),"icon-rotate":new qt(U.layout_symbol["icon-rotate"]),"icon-padding":new qt(U.layout_symbol["icon-padding"]),"icon-keep-upright":new Ot(U.layout_symbol["icon-keep-upright"]),"icon-offset":new qt(U.layout_symbol["icon-offset"]),"icon-anchor":new qt(U.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Ot(U.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Ot(U.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Ot(U.layout_symbol["text-rotation-alignment"]),"text-field":new qt(U.layout_symbol["text-field"]),"text-font":new qt(U.layout_symbol["text-font"]),"text-size":new qt(U.layout_symbol["text-size"]),"text-max-width":new qt(U.layout_symbol["text-max-width"]),"text-line-height":new Ot(U.layout_symbol["text-line-height"]),"text-letter-spacing":new qt(U.layout_symbol["text-letter-spacing"]),"text-justify":new qt(U.layout_symbol["text-justify"]),"text-radial-offset":new qt(U.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Ot(U.layout_symbol["text-variable-anchor"]),"text-variable-anchor-offset":new qt(U.layout_symbol["text-variable-anchor-offset"]),"text-anchor":new qt(U.layout_symbol["text-anchor"]),"text-max-angle":new Ot(U.layout_symbol["text-max-angle"]),"text-writing-mode":new Ot(U.layout_symbol["text-writing-mode"]),"text-rotate":new qt(U.layout_symbol["text-rotate"]),"text-padding":new Ot(U.layout_symbol["text-padding"]),"text-keep-upright":new Ot(U.layout_symbol["text-keep-upright"]),"text-transform":new qt(U.layout_symbol["text-transform"]),"text-offset":new qt(U.layout_symbol["text-offset"]),"text-allow-overlap":new Ot(U.layout_symbol["text-allow-overlap"]),"text-overlap":new Ot(U.layout_symbol["text-overlap"]),"text-ignore-placement":new Ot(U.layout_symbol["text-ignore-placement"]),"text-optional":new Ot(U.layout_symbol["text-optional"])})}};class mx{constructor(n){if(n.property.overrides===void 0)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=n.property.overrides?n.property.overrides.runtimeType:fn,this.defaultValue=n}evaluate(n){if(n.formattedSection){const o=this.defaultValue.property.overrides;if(o&&o.hasOverride(n.formattedSection))return o.getOverride(n.formattedSection)}return n.feature&&n.featureState?this.defaultValue.evaluate(n.feature,n.featureState):this.defaultValue.property.specification.default}eachChild(n){this.defaultValue.isConstant()||n(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}St("FormatSectionOverride",mx,{omit:["defaultValue"]});class Af extends ys{constructor(n){super(n,zg)}recalculate(n,o){if(super.recalculate(n,o),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")==="map"?"map":"viewport"),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){const h=this.layout.get("text-writing-mode");if(h){const p=[];for(const y of h)p.indexOf(y)<0&&p.push(y);this.layout._values["text-writing-mode"]=p}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(n,o,h,p){const y=this.layout.get(n).evaluate(o,{},h,p),x=this._unevaluatedLayout._values[n];return x.isDataDriven()||ic(x.value)||!y?y:function(S,I){return I.replace(/{([^{}]+)}/g,(P,L)=>L in S?String(S[L]):"")}(o.properties,y)}createBucket(n){return new Pc(n)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(const n of zg.paint.overridableProperties){if(!Af.hasPaintOverride(this.layout,n))continue;const o=this.paint.get(n),h=new mx(o),p=new ni(h,o.property.specification);let y=null;y=o.value.kind==="constant"||o.value.kind==="source"?new sl("source",p):new $n("composite",p,o.value.zoomStops),this.paint._values[n]=new ns(o.property,y,o.parameters)}}_handleOverridablePaintPropertyUpdate(n,o,h){return!(!this.layout||o.isDataDriven()||h.isDataDriven())&&Af.hasPaintOverride(this.layout,n)}static hasPaintOverride(n,o){const h=n.get("text-field"),p=zg.paint.properties[o];let y=!1;const x=S=>{for(const I of S)if(p.overrides&&p.overrides.hasOverride(I))return void(y=!0)};if(h.value.kind==="constant"&&h.value.value instanceof di)x(h.value.value.sections);else if(h.value.kind==="source"){const S=P=>{y||(P instanceof wa&&fi(P.value)===Tr?x(P.value.sections):P instanceof tc?x(P.sections):P.eachChild(S))},I=h.value;I._styleExpression&&S(I._styleExpression.expression)}return y}}let gx;var OI={get paint(){return gx=gx||new ki({"background-color":new Ot(U.paint_background["background-color"]),"background-pattern":new Qu(U.paint_background["background-pattern"]),"background-opacity":new Ot(U.paint_background["background-opacity"])})}};class BI extends ys{constructor(n){super(n,OI)}}let _x;var FI={get paint(){return _x=_x||new ki({"raster-opacity":new Ot(U.paint_raster["raster-opacity"]),"raster-hue-rotate":new Ot(U.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Ot(U.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Ot(U.paint_raster["raster-brightness-max"]),"raster-saturation":new Ot(U.paint_raster["raster-saturation"]),"raster-contrast":new Ot(U.paint_raster["raster-contrast"]),"raster-resampling":new Ot(U.paint_raster["raster-resampling"]),"raster-fade-duration":new Ot(U.paint_raster["raster-fade-duration"])})}};class NI extends ys{constructor(n){super(n,FI)}}class UI extends ys{constructor(n){super(n,{}),this.onAdd=o=>{this.implementation.onAdd&&this.implementation.onAdd(o,o.painter.context.gl)},this.onRemove=o=>{this.implementation.onRemove&&this.implementation.onRemove(o,o.painter.context.gl)},this.implementation=n}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}class $I{constructor(n){this._callback=n,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){delete this._channel,this._callback=()=>{}}}const Og=63710088e-1;class wo{constructor(n,o){if(isNaN(n)||isNaN(o))throw new Error(`Invalid LngLat object: (${n}, ${o})`);if(this.lng=+n,this.lat=+o,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new wo(be(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(n){const o=Math.PI/180,h=this.lat*o,p=n.lat*o,y=Math.sin(h)*Math.sin(p)+Math.cos(h)*Math.cos(p)*Math.cos((n.lng-this.lng)*o);return Og*Math.acos(Math.min(y,1))}static convert(n){if(n instanceof wo)return n;if(Array.isArray(n)&&(n.length===2||n.length===3))return new wo(Number(n[0]),Number(n[1]));if(!Array.isArray(n)&&typeof n=="object"&&n!==null)return new wo(Number("lng"in n?n.lng:n.lon),Number(n.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const yx=2*Math.PI*Og;function vx(s){return yx*Math.cos(s*Math.PI/180)}function xx(s){return(180+s)/360}function bx(s){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+s*Math.PI/360)))/360}function wx(s,n){return s/vx(n)}function Bg(s){return 360/Math.PI*Math.atan(Math.exp((180-360*s)*Math.PI/180))-90}class Pf{constructor(n,o,h=0){this.x=+n,this.y=+o,this.z=+h}static fromLngLat(n,o=0){const h=wo.convert(n);return new Pf(xx(h.lng),bx(h.lat),wx(o,h.lat))}toLngLat(){return new wo(360*this.x-180,Bg(this.y))}toAltitude(){return this.z*vx(Bg(this.y))}meterInMercatorCoordinateUnits(){return 1/yx*(n=Bg(this.y),1/Math.cos(n*Math.PI/180));var n}}function Sx(s,n,o){var h=2*Math.PI*6378137/256/Math.pow(2,o);return[s*h-2*Math.PI*6378137/2,n*h-2*Math.PI*6378137/2]}class Fg{constructor(n,o,h){if(n<0||n>25||h<0||h>=Math.pow(2,n)||o<0||o>=Math.pow(2,n))throw new Error(`x=${o}, y=${h}, z=${n} outside of bounds. 0<=x<${Math.pow(2,n)}, 0<=y<${Math.pow(2,n)} 0<=z<=25 `);this.z=n,this.x=o,this.y=h,this.key=xh(0,n,n,o,h)}equals(n){return this.z===n.z&&this.x===n.x&&this.y===n.y}url(n,o,h){const p=(x=this.y,S=this.z,I=Sx(256*(y=this.x),256*(x=Math.pow(2,S)-x-1),S),P=Sx(256*(y+1),256*(x+1),S),I[0]+","+I[1]+","+P[0]+","+P[1]);var y,x,S,I,P;const L=function(B,N,q){let H,ee="";for(let ie=B;ie>0;ie--)H=1<<ie-1,ee+=(N&H?1:0)+(q&H?2:0);return ee}(this.z,this.x,this.y);return n[(this.x+this.y)%n.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(h==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,o>1?"@2x":"").replace(/{quadkey}/g,L).replace(/{bbox-epsg-3857}/g,p)}isChildOf(n){const o=this.z-n.z;return o>0&&n.x===this.x>>o&&n.y===this.y>>o}getTilePoint(n){const o=Math.pow(2,this.z);return new k((n.x*o-this.x)*si,(n.y*o-this.y)*si)}toString(){return`${this.z}/${this.x}/${this.y}`}}class Ex{constructor(n,o){this.wrap=n,this.canonical=o,this.key=xh(n,o.z,o.z,o.x,o.y)}}class as{constructor(n,o,h,p,y){if(n<h)throw new Error(`overscaledZ should be >= z; overscaledZ = ${n}; z = ${h}`);this.overscaledZ=n,this.wrap=o,this.canonical=new Fg(h,+p,+y),this.key=xh(o,n,h,p,y)}clone(){return new as(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(n){return this.overscaledZ===n.overscaledZ&&this.wrap===n.wrap&&this.canonical.equals(n.canonical)}scaledTo(n){if(n>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${n}; overscaledZ = ${this.overscaledZ}`);const o=this.canonical.z-n;return n>this.canonical.z?new as(n,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new as(n,this.wrap,n,this.canonical.x>>o,this.canonical.y>>o)}calculateScaledKey(n,o){if(n>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${n}; overscaledZ = ${this.overscaledZ}`);const h=this.canonical.z-n;return n>this.canonical.z?xh(this.wrap*+o,n,this.canonical.z,this.canonical.x,this.canonical.y):xh(this.wrap*+o,n,n,this.canonical.x>>h,this.canonical.y>>h)}isChildOf(n){if(n.wrap!==this.wrap)return!1;const o=this.canonical.z-n.canonical.z;return n.overscaledZ===0||n.overscaledZ<this.overscaledZ&&n.canonical.x===this.canonical.x>>o&&n.canonical.y===this.canonical.y>>o}children(n){if(this.overscaledZ>=n)return[new as(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const o=this.canonical.z+1,h=2*this.canonical.x,p=2*this.canonical.y;return[new as(o,this.wrap,o,h,p),new as(o,this.wrap,o,h+1,p),new as(o,this.wrap,o,h,p+1),new as(o,this.wrap,o,h+1,p+1)]}isLessThan(n){return this.wrap<n.wrap||!(this.wrap>n.wrap)&&(this.overscaledZ<n.overscaledZ||!(this.overscaledZ>n.overscaledZ)&&(this.canonical.x<n.canonical.x||!(this.canonical.x>n.canonical.x)&&this.canonical.y<n.canonical.y))}wrapped(){return new as(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(n){return new as(this.overscaledZ,n,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new Ex(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(n){return this.canonical.getTilePoint(new Pf(n.x-this.wrap,n.y))}}function xh(s,n,o,h,p){(s*=2)<0&&(s=-1*s-1);const y=1<<o;return(y*y*s+y*p+h).toString(36)+o.toString(36)+n.toString(36)}St("CanonicalTileID",Fg),St("OverscaledTileID",as,{omit:["posMatrix"]});class Tx{constructor(n,o,h){if(this.uid=n,o.height!==o.width)throw new RangeError("DEM tiles must be square");if(h&&h!=="mapbox"&&h!=="terrarium")return void Z(`"${h}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=o.height;const p=this.dim=o.height-2;this.data=new Uint32Array(o.data.buffer),this.encoding=h||"mapbox";for(let y=0;y<p;y++)this.data[this._idx(-1,y)]=this.data[this._idx(0,y)],this.data[this._idx(p,y)]=this.data[this._idx(p-1,y)],this.data[this._idx(y,-1)]=this.data[this._idx(y,0)],this.data[this._idx(y,p)]=this.data[this._idx(y,p-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(p,-1)]=this.data[this._idx(p-1,0)],this.data[this._idx(-1,p)]=this.data[this._idx(0,p-1)],this.data[this._idx(p,p)]=this.data[this._idx(p-1,p-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let y=0;y<p;y++)for(let x=0;x<p;x++){const S=this.get(y,x);S>this.max&&(this.max=S),S<this.min&&(this.min=S)}}get(n,o){const h=new Uint8Array(this.data.buffer),p=4*this._idx(n,o);return(this.encoding==="terrarium"?this._unpackTerrarium:this._unpackMapbox)(h[p],h[p+1],h[p+2])}getUnpackVector(){return this.encoding==="terrarium"?[256,1,1/256,32768]:[6553.6,25.6,.1,1e4]}_idx(n,o){if(n<-1||n>=this.dim+1||o<-1||o>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(o+1)*this.stride+(n+1)}_unpackMapbox(n,o,h){return(256*n*256+256*o+h)/10-1e4}_unpackTerrarium(n,o,h){return 256*n+o+h/256-32768}getPixels(){return new ss({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(n,o,h){if(this.dim!==n.dim)throw new Error("dem dimension mismatch");let p=o*this.dim,y=o*this.dim+this.dim,x=h*this.dim,S=h*this.dim+this.dim;switch(o){case-1:p=y-1;break;case 1:y=p+1}switch(h){case-1:x=S-1;break;case 1:S=x+1}const I=-o*this.dim,P=-h*this.dim;for(let L=x;L<S;L++)for(let B=p;B<y;B++)this.data[this._idx(B,L)]=n.data[this._idx(B+I,L+P)]}}St("DEMData",Tx);class Cx{constructor(n){this._stringToNumber={},this._numberToString=[];for(let o=0;o<n.length;o++){const h=n[o];this._stringToNumber[h]=o,this._numberToString[o]=h}}encode(n){return this._stringToNumber[n]}decode(n){if(n>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${n} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[n]}}class Ix{constructor(n,o,h,p,y){this.type="Feature",this._vectorTileFeature=n,n._z=o,n._x=h,n._y=p,this.properties=n.properties,this.id=y}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(n){this._geometry=n}toJSON(){const n={geometry:this.geometry};for(const o in this)o!=="_geometry"&&o!=="_vectorTileFeature"&&(n[o]=this[o]);return n}}class kx{constructor(n,o){this.tileID=n,this.x=n.canonical.x,this.y=n.canonical.y,this.z=n.canonical.z,this.grid=new Pa(si,16,0),this.grid3D=new Pa(si,16,0),this.featureIndexArray=new Me,this.promoteId=o}insert(n,o,h,p,y,x){const S=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(h,p,y);const I=x?this.grid3D:this.grid;for(let P=0;P<o.length;P++){const L=o[P],B=[1/0,1/0,-1/0,-1/0];for(let N=0;N<L.length;N++){const q=L[N];B[0]=Math.min(B[0],q.x),B[1]=Math.min(B[1],q.y),B[2]=Math.max(B[2],q.x),B[3]=Math.max(B[3],q.y)}B[0]<si&&B[1]<si&&B[2]>=0&&B[3]>=0&&I.insert(S,B[0],B[1],B[2],B[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new vo.VectorTile(new Cg(this.rawTileData)).layers,this.sourceLayerCoder=new Cx(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(n,o,h,p){this.loadVTLayers();const y=n.params||{},x=si/n.tileSize/n.scale,S=Bu(y.filter),I=n.queryGeometry,P=n.queryPadding*x,L=Px(I),B=this.grid.query(L.minX-P,L.minY-P,L.maxX+P,L.maxY+P),N=Px(n.cameraQueryGeometry),q=this.grid3D.query(N.minX-P,N.minY-P,N.maxX+P,N.maxY+P,(ie,ce,Ee,me)=>function(Ae,ze,Ye,wt,Dt){for(const vt of Ae)if(ze<=vt.x&&Ye<=vt.y&&wt>=vt.x&&Dt>=vt.y)return!0;const xt=[new k(ze,Ye),new k(ze,Dt),new k(wt,Dt),new k(wt,Ye)];if(Ae.length>2){for(const vt of xt)if(Sc(Ae,vt))return!0}for(let vt=0;vt<Ae.length-1;vt++)if(vC(Ae[vt],Ae[vt+1],xt))return!0;return!1}(n.cameraQueryGeometry,ie-P,ce-P,Ee+P,me+P));for(const ie of q)B.push(ie);B.sort(VI);const H={};let ee;for(let ie=0;ie<B.length;ie++){const ce=B[ie];if(ce===ee)continue;ee=ce;const Ee=this.featureIndexArray.get(ce);let me=null;this.loadMatchingFeature(H,Ee.bucketIndex,Ee.sourceLayerIndex,Ee.featureIndex,S,y.layers,y.availableImages,o,h,p,(Ae,ze,Ye)=>(me||(me=sa(Ae)),ze.queryIntersectsFeature(I,Ae,Ye,me,this.z,n.transform,x,n.pixelPosMatrix)))}return H}loadMatchingFeature(n,o,h,p,y,x,S,I,P,L,B){const N=this.bucketLayerIDs[o];if(x&&!function(ie,ce){for(let Ee=0;Ee<ie.length;Ee++)if(ce.indexOf(ie[Ee])>=0)return!0;return!1}(x,N))return;const q=this.sourceLayerCoder.decode(h),H=this.vtLayers[q].feature(p);if(y.needGeometry){const ie=Ls(H,!0);if(!y.filter(new Zn(this.tileID.overscaledZ),ie,this.tileID.canonical))return}else if(!y.filter(new Zn(this.tileID.overscaledZ),H))return;const ee=this.getId(H,q);for(let ie=0;ie<N.length;ie++){const ce=N[ie];if(x&&x.indexOf(ce)<0)continue;const Ee=I[ce];if(!Ee)continue;let me={};ee&&L&&(me=L.getState(Ee.sourceLayer||"_geojsonTileLayer",ee));const Ae=ge({},P[ce]);Ae.paint=Ax(Ae.paint,Ee.paint,H,me,S),Ae.layout=Ax(Ae.layout,Ee.layout,H,me,S);const ze=!B||B(H,Ee,me);if(!ze)continue;const Ye=new Ix(H,this.z,this.x,this.y,ee);Ye.layer=Ae;let wt=n[ce];wt===void 0&&(wt=n[ce]=[]),wt.push({featureIndex:p,feature:Ye,intersectionZ:ze})}}lookupSymbolFeatures(n,o,h,p,y,x,S,I){const P={};this.loadVTLayers();const L=Bu(y);for(const B of n)this.loadMatchingFeature(P,h,p,B,L,x,S,I,o);return P}hasLayer(n){for(const o of this.bucketLayerIDs)for(const h of o)if(n===h)return!0;return!1}getId(n,o){let h=n.id;return this.promoteId&&(h=n.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[o]],typeof h=="boolean"&&(h=Number(h))),h}}function Ax(s,n,o,h,p){return Ue(s,(y,x)=>{const S=n instanceof mc?n.get(x):null;return S&&S.evaluate?S.evaluate(o,h,p):S})}function Px(s){let n=1/0,o=1/0,h=-1/0,p=-1/0;for(const y of s)n=Math.min(n,y.x),o=Math.min(o,y.y),h=Math.max(h,y.x),p=Math.max(p,y.y);return{minX:n,minY:o,maxX:h,maxY:p}}function VI(s,n){return n-s}function Rx(s,n,o,h,p){const y=[];for(let x=0;x<s.length;x++){const S=s[x];let I;for(let P=0;P<S.length-1;P++){let L=S[P],B=S[P+1];L.x<n&&B.x<n||(L.x<n?L=new k(n,L.y+(n-L.x)/(B.x-L.x)*(B.y-L.y))._round():B.x<n&&(B=new k(n,L.y+(n-L.x)/(B.x-L.x)*(B.y-L.y))._round()),L.y<o&&B.y<o||(L.y<o?L=new k(L.x+(o-L.y)/(B.y-L.y)*(B.x-L.x),o)._round():B.y<o&&(B=new k(L.x+(o-L.y)/(B.y-L.y)*(B.x-L.x),o)._round()),L.x>=h&&B.x>=h||(L.x>=h?L=new k(h,L.y+(h-L.x)/(B.x-L.x)*(B.y-L.y))._round():B.x>=h&&(B=new k(h,L.y+(h-L.x)/(B.x-L.x)*(B.y-L.y))._round()),L.y>=p&&B.y>=p||(L.y>=p?L=new k(L.x+(p-L.y)/(B.y-L.y)*(B.x-L.x),p)._round():B.y>=p&&(B=new k(L.x+(p-L.y)/(B.y-L.y)*(B.x-L.x),p)._round()),I&&L.equals(I[I.length-1])||(I=[L],y.push(I)),I.push(B)))))}}return y}St("FeatureIndex",kx,{omit:["rawTileData","sourceLayerCoder"]});class So extends k{constructor(n,o,h,p){super(n,o),this.angle=h,p!==void 0&&(this.segment=p)}clone(){return new So(this.x,this.y,this.angle,this.segment)}}function Mx(s,n,o,h,p){if(n.segment===void 0||o===0)return!0;let y=n,x=n.segment+1,S=0;for(;S>-o/2;){if(x--,x<0)return!1;S-=s[x].dist(y),y=s[x]}S+=s[x].dist(s[x+1]),x++;const I=[];let P=0;for(;S<o/2;){const L=s[x],B=s[x+1];if(!B)return!1;let N=s[x-1].angleTo(L)-L.angleTo(B);for(N=Math.abs((N+3*Math.PI)%(2*Math.PI)-Math.PI),I.push({distance:S,angleDelta:N}),P+=N;S-I[0].distance>h;)P-=I.shift().angleDelta;if(P>p)return!1;x++,S+=L.dist(B)}return!0}function Dx(s){let n=0;for(let o=0;o<s.length-1;o++)n+=s[o].dist(s[o+1]);return n}function Lx(s,n,o){return s?.6*n*o:0}function zx(s,n){return Math.max(s?s.right-s.left:0,n?n.right-n.left:0)}function jI(s,n,o,h,p,y){const x=Lx(o,p,y),S=zx(o,h)*y;let I=0;const P=Dx(s)/2;for(let L=0;L<s.length-1;L++){const B=s[L],N=s[L+1],q=B.dist(N);if(I+q>P){const H=(P-I)/q,ee=kr.number(B.x,N.x,H),ie=kr.number(B.y,N.y,H),ce=new So(ee,ie,N.angleTo(B),L);return ce._round(),!x||Mx(s,ce,S,x,n)?ce:void 0}I+=q}}function GI(s,n,o,h,p,y,x,S,I){const P=Lx(h,y,x),L=zx(h,p),B=L*x,N=s[0].x===0||s[0].x===I||s[0].y===0||s[0].y===I;return n-B<n/4&&(n=B+n/4),Ox(s,N?n/2*S%n:(L/2+2*y)*x*S%n,n,P,o,B,N,!1,I)}function Ox(s,n,o,h,p,y,x,S,I){const P=y/2,L=Dx(s);let B=0,N=n-o,q=[];for(let H=0;H<s.length-1;H++){const ee=s[H],ie=s[H+1],ce=ee.dist(ie),Ee=ie.angleTo(ee);for(;N+o<B+ce;){N+=o;const me=(N-B)/ce,Ae=kr.number(ee.x,ie.x,me),ze=kr.number(ee.y,ie.y,me);if(Ae>=0&&Ae<I&&ze>=0&&ze<I&&N-P>=0&&N+P<=L){const Ye=new So(Ae,ze,Ee,H);Ye._round(),h&&!Mx(s,Ye,y,h,p)||q.push(Ye)}}B+=ce}return S||q.length||x||(q=Ox(s,B/2,o,h,p,y,x,!0,I)),q}St("Anchor",So);const Rc=Pr;function Bx(s,n,o,h){const p=[],y=s.image,x=y.pixelRatio,S=y.paddedRect.w-2*Rc,I=y.paddedRect.h-2*Rc,P=s.right-s.left,L=s.bottom-s.top,B=y.stretchX||[[0,S]],N=y.stretchY||[[0,I]],q=(mt,Tt)=>mt+Tt[1]-Tt[0],H=B.reduce(q,0),ee=N.reduce(q,0),ie=S-H,ce=I-ee;let Ee=0,me=H,Ae=0,ze=ee,Ye=0,wt=ie,Dt=0,xt=ce;if(y.content&&h){const mt=y.content;Ee=Rf(B,0,mt[0]),Ae=Rf(N,0,mt[1]),me=Rf(B,mt[0],mt[2]),ze=Rf(N,mt[1],mt[3]),Ye=mt[0]-Ee,Dt=mt[1]-Ae,wt=mt[2]-mt[0]-me,xt=mt[3]-mt[1]-ze}const vt=(mt,Tt,gt,lt)=>{const Vt=Mf(mt.stretch-Ee,me,P,s.left),zt=Df(mt.fixed-Ye,wt,mt.stretch,H),rn=Mf(Tt.stretch-Ae,ze,L,s.top),jn=Df(Tt.fixed-Dt,xt,Tt.stretch,ee),Wn=Mf(gt.stretch-Ee,me,P,s.left),Pi=Df(gt.fixed-Ye,wt,gt.stretch,H),Wr=Mf(lt.stretch-Ae,ze,L,s.top),_r=Df(lt.fixed-Dt,xt,lt.stretch,ee),Si=new k(Vt,rn),Fi=new k(Wn,rn),Xi=new k(Wn,Wr),Rr=new k(Vt,Wr),yr=new k(zt/x,jn/x),Ei=new k(Pi/x,_r/x),Ri=n*Math.PI/180;if(Ri){const Mr=Math.sin(Ri),Dr=Math.cos(Ri),ci=[Dr,-Mr,Mr,Dr];Si._matMult(ci),Fi._matMult(ci),Rr._matMult(ci),Xi._matMult(ci)}const rr=mt.stretch+mt.fixed,vr=Tt.stretch+Tt.fixed;return{tl:Si,tr:Fi,bl:Rr,br:Xi,tex:{x:y.paddedRect.x+Rc+rr,y:y.paddedRect.y+Rc+vr,w:gt.stretch+gt.fixed-rr,h:lt.stretch+lt.fixed-vr},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:yr,pixelOffsetBR:Ei,minFontScaleX:wt/x/P,minFontScaleY:xt/x/L,isSDF:o}};if(h&&(y.stretchX||y.stretchY)){const mt=Fx(B,ie,H),Tt=Fx(N,ce,ee);for(let gt=0;gt<mt.length-1;gt++){const lt=mt[gt],Vt=mt[gt+1];for(let zt=0;zt<Tt.length-1;zt++)p.push(vt(lt,Tt[zt],Vt,Tt[zt+1]))}}else p.push(vt({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:S+1},{fixed:0,stretch:I+1}));return p}function Rf(s,n,o){let h=0;for(const p of s)h+=Math.max(n,Math.min(o,p[1]))-Math.max(n,Math.min(o,p[0]));return h}function Fx(s,n,o){const h=[{fixed:-Rc,stretch:0}];for(const[p,y]of s){const x=h[h.length-1];h.push({fixed:p-x.stretch,stretch:x.stretch}),h.push({fixed:p-x.stretch,stretch:x.stretch+(y-p)})}return h.push({fixed:n+Rc,stretch:o}),h}function Mf(s,n,o,h){return s/n*o+h}function Df(s,n,o,h){return s-n*o/h}class Lf{constructor(n,o,h,p,y,x,S,I,P,L){if(this.boxStartIndex=n.length,P){let B=x.top,N=x.bottom;const q=x.collisionPadding;q&&(B-=q[1],N+=q[3]);let H=N-B;H>0&&(H=Math.max(10,H),this.circleDiameter=H)}else{let B=x.top*S-I[0],N=x.bottom*S+I[2],q=x.left*S-I[3],H=x.right*S+I[1];const ee=x.collisionPadding;if(ee&&(q-=ee[0]*S,B-=ee[1]*S,H+=ee[2]*S,N+=ee[3]*S),L){const ie=new k(q,B),ce=new k(H,B),Ee=new k(q,N),me=new k(H,N),Ae=L*Math.PI/180;ie._rotate(Ae),ce._rotate(Ae),Ee._rotate(Ae),me._rotate(Ae),q=Math.min(ie.x,ce.x,Ee.x,me.x),H=Math.max(ie.x,ce.x,Ee.x,me.x),B=Math.min(ie.y,ce.y,Ee.y,me.y),N=Math.max(ie.y,ce.y,Ee.y,me.y)}n.emplaceBack(o.x,o.y,q,B,H,N,h,p,y)}this.boxEndIndex=n.length}}class qI{constructor(n=[],o=HI){if(this.data=n,this.length=this.data.length,this.compare=o,this.length>0)for(let h=(this.length>>1)-1;h>=0;h--)this._down(h)}push(n){this.data.push(n),this.length++,this._up(this.length-1)}pop(){if(this.length===0)return;const n=this.data[0],o=this.data.pop();return this.length--,this.length>0&&(this.data[0]=o,this._down(0)),n}peek(){return this.data[0]}_up(n){const{data:o,compare:h}=this,p=o[n];for(;n>0;){const y=n-1>>1,x=o[y];if(h(p,x)>=0)break;o[n]=x,n=y}o[n]=p}_down(n){const{data:o,compare:h}=this,p=this.length>>1,y=o[n];for(;n<p;){let x=1+(n<<1),S=o[x];const I=x+1;if(I<this.length&&h(o[I],S)<0&&(x=I,S=o[I]),h(S,y)>=0)break;o[n]=S,n=x}o[n]=y}}function HI(s,n){return s<n?-1:s>n?1:0}function ZI(s,n=1,o=!1){let h=1/0,p=1/0,y=-1/0,x=-1/0;const S=s[0];for(let q=0;q<S.length;q++){const H=S[q];(!q||H.x<h)&&(h=H.x),(!q||H.y<p)&&(p=H.y),(!q||H.x>y)&&(y=H.x),(!q||H.y>x)&&(x=H.y)}const I=Math.min(y-h,x-p);let P=I/2;const L=new qI([],WI);if(I===0)return new k(h,p);for(let q=h;q<y;q+=I)for(let H=p;H<x;H+=I)L.push(new Mc(q+P,H+P,P,s));let B=function(q){let H=0,ee=0,ie=0;const ce=q[0];for(let Ee=0,me=ce.length,Ae=me-1;Ee<me;Ae=Ee++){const ze=ce[Ee],Ye=ce[Ae],wt=ze.x*Ye.y-Ye.x*ze.y;ee+=(ze.x+Ye.x)*wt,ie+=(ze.y+Ye.y)*wt,H+=3*wt}return new Mc(ee/H,ie/H,0,q)}(s),N=L.length;for(;L.length;){const q=L.pop();(q.d>B.d||!B.d)&&(B=q,o&&console.log("found best %d after %d probes",Math.round(1e4*q.d)/1e4,N)),q.max-B.d<=n||(P=q.h/2,L.push(new Mc(q.p.x-P,q.p.y-P,P,s)),L.push(new Mc(q.p.x+P,q.p.y-P,P,s)),L.push(new Mc(q.p.x-P,q.p.y+P,P,s)),L.push(new Mc(q.p.x+P,q.p.y+P,P,s)),N+=4)}return o&&(console.log(`num probes: ${N}`),console.log(`best distance: ${B.d}`)),B.p}function WI(s,n){return n.max-s.max}function Mc(s,n,o,h){this.p=new k(s,n),this.h=o,this.d=function(p,y){let x=!1,S=1/0;for(let I=0;I<y.length;I++){const P=y[I];for(let L=0,B=P.length,N=B-1;L<B;N=L++){const q=P[L],H=P[N];q.y>p.y!=H.y>p.y&&p.x<(H.x-q.x)*(p.y-q.y)/(H.y-q.y)+q.x&&(x=!x),S=Math.min(S,b0(p,q,H))}}return(x?1:-1)*Math.sqrt(S)}(this.p,h),this.max=this.d+this.h*Math.SQRT2}var Yi;l.TextAnchorEnum=void 0,(Yi=l.TextAnchorEnum||(l.TextAnchorEnum={}))[Yi.center=1]="center",Yi[Yi.left=2]="left",Yi[Yi.right=3]="right",Yi[Yi.top=4]="top",Yi[Yi.bottom=5]="bottom",Yi[Yi["top-left"]=6]="top-left",Yi[Yi["top-right"]=7]="top-right",Yi[Yi["bottom-left"]=8]="bottom-left",Yi[Yi["bottom-right"]=9]="bottom-right";const Eo=7,Ng=Number.POSITIVE_INFINITY;function Nx(s,n){return n[1]!==Ng?function(o,h,p){let y=0,x=0;switch(h=Math.abs(h),p=Math.abs(p),o){case"top-right":case"top-left":case"top":x=p-Eo;break;case"bottom-right":case"bottom-left":case"bottom":x=-p+Eo}switch(o){case"top-right":case"bottom-right":case"right":y=-h;break;case"top-left":case"bottom-left":case"left":y=h}return[y,x]}(s,n[0],n[1]):function(o,h){let p=0,y=0;h<0&&(h=0);const x=h/Math.sqrt(2);switch(o){case"top-right":case"top-left":y=x-Eo;break;case"bottom-right":case"bottom-left":y=-x+Eo;break;case"bottom":y=-h+Eo;break;case"top":y=h-Eo}switch(o){case"top-right":case"bottom-right":p=-x;break;case"top-left":case"bottom-left":p=x;break;case"left":p=h;break;case"right":p=-h}return[p,y]}(s,n[0])}function Ux(s,n,o){var h;const p=s.layout,y=(h=p.get("text-variable-anchor-offset"))===null||h===void 0?void 0:h.evaluate(n,{},o);if(y){const S=y.values,I=[];for(let P=0;P<S.length;P+=2){const L=I[P]=S[P],B=S[P+1].map(N=>N*Ai);L.startsWith("top")?B[1]-=Eo:L.startsWith("bottom")&&(B[1]+=Eo),I[P+1]=B}return new Zi(I)}const x=p.get("text-variable-anchor");if(x){let S;S=s._unevaluatedLayout.getValue("text-radial-offset")!==void 0?[p.get("text-radial-offset").evaluate(n,{},o)*Ai,Ng]:p.get("text-offset").evaluate(n,{},o).map(P=>P*Ai);const I=[];for(const P of x)I.push(P,Nx(P,S));return new Zi(I)}return null}function Ug(s){switch(s){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function YI(s,n,o,h,p,y,x,S,I,P,L){let B=y.textMaxSize.evaluate(n,{});B===void 0&&(B=x);const N=s.layers[0].layout,q=N.get("icon-offset").evaluate(n,{},L),H=Vx(o.horizontal),ee=x/24,ie=s.tilePixelRatio*ee,ce=s.tilePixelRatio*B/24,Ee=s.tilePixelRatio*S,me=s.tilePixelRatio*N.get("symbol-spacing"),Ae=N.get("text-padding")*s.tilePixelRatio,ze=function(lt,Vt,zt,rn=1){const jn=lt.get("icon-padding").evaluate(Vt,{},zt),Wn=jn&&jn.values;return[Wn[0]*rn,Wn[1]*rn,Wn[2]*rn,Wn[3]*rn]}(N,n,L,s.tilePixelRatio),Ye=N.get("text-max-angle")/180*Math.PI,wt=N.get("text-rotation-alignment")!=="viewport"&&N.get("symbol-placement")!=="point",Dt=N.get("icon-rotation-alignment")==="map"&&N.get("symbol-placement")!=="point",xt=N.get("symbol-placement"),vt=me/2,mt=N.get("icon-text-fit");let Tt;h&&mt!=="none"&&(s.allowVerticalPlacement&&o.vertical&&(Tt=hx(h,o.vertical,mt,N.get("icon-text-fit-padding"),q,ee)),H&&(h=hx(h,H,mt,N.get("icon-text-fit-padding"),q,ee)));const gt=(lt,Vt)=>{Vt.x<0||Vt.x>=si||Vt.y<0||Vt.y>=si||function(zt,rn,jn,Wn,Pi,Wr,_r,Si,Fi,Xi,Rr,yr,Ei,Ri,rr,vr,Mr,Dr,ci,Ki,dn,Yr,Ji,xr,vs){const zs=zt.addToLineVertexArray(rn,jn);let Os,Fa,xs,os,Lr=0,Na=0,Sh=0,Hx=0,Wg=-1,Yg=-1;const Ua={};let Zx=Ms("");if(zt.allowVerticalPlacement&&Wn.vertical){const sr=Si.layout.get("text-rotate").evaluate(dn,{},xr)+90;xs=new Lf(Fi,rn,Xi,Rr,yr,Wn.vertical,Ei,Ri,rr,sr),_r&&(os=new Lf(Fi,rn,Xi,Rr,yr,_r,Mr,Dr,rr,sr))}if(Pi){const sr=Si.layout.get("icon-rotate").evaluate(dn,{}),ls=Si.layout.get("icon-text-fit")!=="none",_l=Bx(Pi,sr,Ji,ls),Fs=_r?Bx(_r,sr,Ji,ls):void 0;Fa=new Lf(Fi,rn,Xi,Rr,yr,Pi,Mr,Dr,!1,sr),Lr=4*_l.length;const yl=zt.iconSizeData;let oa=null;yl.kind==="source"?(oa=[aa*Si.layout.get("icon-size").evaluate(dn,{})],oa[0]>bo&&Z(`${zt.layerIds[0]}: Value for "icon-size" is >= ${vh}. Reduce your "icon-size".`)):yl.kind==="composite"&&(oa=[aa*Yr.compositeIconSizes[0].evaluate(dn,{},xr),aa*Yr.compositeIconSizes[1].evaluate(dn,{},xr)],(oa[0]>bo||oa[1]>bo)&&Z(`${zt.layerIds[0]}: Value for "icon-size" is >= ${vh}. Reduce your "icon-size".`)),zt.addSymbols(zt.icon,_l,oa,Ki,ci,dn,l.WritingMode.none,rn,zs.lineStartIndex,zs.lineLength,-1,xr),Wg=zt.icon.placedSymbolArray.length-1,Fs&&(Na=4*Fs.length,zt.addSymbols(zt.icon,Fs,oa,Ki,ci,dn,l.WritingMode.vertical,rn,zs.lineStartIndex,zs.lineLength,-1,xr),Yg=zt.icon.placedSymbolArray.length-1)}const Wx=Object.keys(Wn.horizontal);for(const sr of Wx){const ls=Wn.horizontal[sr];if(!Os){Zx=Ms(ls.text);const Fs=Si.layout.get("text-rotate").evaluate(dn,{},xr);Os=new Lf(Fi,rn,Xi,Rr,yr,ls,Ei,Ri,rr,Fs)}const _l=ls.positionedLines.length===1;if(Sh+=$x(zt,rn,ls,Wr,Si,rr,dn,vr,zs,Wn.vertical?l.WritingMode.horizontal:l.WritingMode.horizontalOnly,_l?Wx:[sr],Ua,Wg,Yr,xr),_l)break}Wn.vertical&&(Hx+=$x(zt,rn,Wn.vertical,Wr,Si,rr,dn,vr,zs,l.WritingMode.vertical,["vertical"],Ua,Yg,Yr,xr));const JI=Os?Os.boxStartIndex:zt.collisionBoxArray.length,QI=Os?Os.boxEndIndex:zt.collisionBoxArray.length,ek=xs?xs.boxStartIndex:zt.collisionBoxArray.length,tk=xs?xs.boxEndIndex:zt.collisionBoxArray.length,nk=Fa?Fa.boxStartIndex:zt.collisionBoxArray.length,ik=Fa?Fa.boxEndIndex:zt.collisionBoxArray.length,rk=os?os.boxStartIndex:zt.collisionBoxArray.length,sk=os?os.boxEndIndex:zt.collisionBoxArray.length;let Bs=-1;const Of=(sr,ls)=>sr&&sr.circleDiameter?Math.max(sr.circleDiameter,ls):ls;Bs=Of(Os,Bs),Bs=Of(xs,Bs),Bs=Of(Fa,Bs),Bs=Of(os,Bs);const Yx=Bs>-1?1:0;Yx&&(Bs*=vs/Ai),zt.glyphOffsetArray.length>=Pc.MAX_GLYPHS&&Z("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),dn.sortKey!==void 0&&zt.addToSortKeyRanges(zt.symbolInstances.length,dn.sortKey);const ak=Ux(Si,dn,xr),[ok,lk]=function(sr,ls){const _l=sr.length,Fs=ls==null?void 0:ls.values;if((Fs==null?void 0:Fs.length)>0)for(let yl=0;yl<Fs.length;yl+=2){const oa=Fs[yl+1];sr.emplaceBack(l.TextAnchorEnum[Fs[yl]],oa[0],oa[1])}return[_l,sr.length]}(zt.textAnchorOffsets,ak);zt.symbolInstances.emplaceBack(rn.x,rn.y,Ua.right>=0?Ua.right:-1,Ua.center>=0?Ua.center:-1,Ua.left>=0?Ua.left:-1,Ua.vertical||-1,Wg,Yg,Zx,JI,QI,ek,tk,nk,ik,rk,sk,Xi,Sh,Hx,Lr,Na,Yx,0,Ei,Bs,ok,lk)}(s,Vt,lt,o,h,p,Tt,s.layers[0],s.collisionBoxArray,n.index,n.sourceLayerIndex,s.index,ie,[Ae,Ae,Ae,Ae],wt,I,Ee,ze,Dt,q,n,y,P,L,x)};if(xt==="line")for(const lt of Rx(n.geometry,0,0,si,si)){const Vt=GI(lt,me,Ye,o.vertical||H,h,24,ce,s.overscaling,si);for(const zt of Vt)H&&XI(s,H.text,vt,zt)||gt(lt,zt)}else if(xt==="line-center"){for(const lt of n.geometry)if(lt.length>1){const Vt=jI(lt,Ye,o.vertical||H,h,24,ce);Vt&&gt(lt,Vt)}}else if(n.type==="Polygon")for(const lt of yg(n.geometry,0)){const Vt=ZI(lt,16);gt(lt[0],new So(Vt.x,Vt.y,0))}else if(n.type==="LineString")for(const lt of n.geometry)gt(lt,new So(lt[0].x,lt[0].y,0));else if(n.type==="Point")for(const lt of n.geometry)for(const Vt of lt)gt([Vt],new So(Vt.x,Vt.y,0))}function $x(s,n,o,h,p,y,x,S,I,P,L,B,N,q,H){const ee=function(Ee,me,Ae,ze,Ye,wt,Dt,xt){const vt=ze.layout.get("text-rotate").evaluate(wt,{})*Math.PI/180,mt=[];for(const Tt of me.positionedLines)for(const gt of Tt.positionedGlyphs){if(!gt.rect)continue;const lt=gt.rect||{};let Vt=rx+1,zt=!0,rn=1,jn=0;const Wn=(Ye||xt)&&gt.vertical,Pi=gt.metrics.advance*gt.scale/2;if(xt&&me.verticalizable&&(jn=Tt.lineOffset/2-(gt.imageName?-(Ai-gt.metrics.width*gt.scale)/2:(gt.scale-1)*Ai)),gt.imageName){const ci=Dt[gt.imageName];zt=ci.sdf,rn=ci.pixelRatio,Vt=Pr/rn}const Wr=Ye?[gt.x+Pi,gt.y]:[0,0];let _r=Ye?[0,0]:[gt.x+Pi+Ae[0],gt.y+Ae[1]-jn],Si=[0,0];Wn&&(Si=_r,_r=[0,0]);const Fi=(gt.metrics.left-Vt)*gt.scale-Pi+_r[0],Xi=(-gt.metrics.top-Vt)*gt.scale+_r[1],Rr=Fi+lt.w*gt.scale/rn,yr=Xi+lt.h*gt.scale/rn,Ei=new k(Fi,Xi),Ri=new k(Rr,Xi),rr=new k(Fi,yr),vr=new k(Rr,yr);if(Wn){const ci=new k(-Pi,Pi-_h),Ki=-Math.PI/2,dn=Ai/2-Pi,Yr=new k(5-_h-dn,-(gt.imageName?dn:0)),Ji=new k(...Si);Ei._rotateAround(Ki,ci)._add(Yr)._add(Ji),Ri._rotateAround(Ki,ci)._add(Yr)._add(Ji),rr._rotateAround(Ki,ci)._add(Yr)._add(Ji),vr._rotateAround(Ki,ci)._add(Yr)._add(Ji)}if(vt){const ci=Math.sin(vt),Ki=Math.cos(vt),dn=[Ki,-ci,ci,Ki];Ei._matMult(dn),Ri._matMult(dn),rr._matMult(dn),vr._matMult(dn)}const Mr=new k(0,0),Dr=new k(0,0);mt.push({tl:Ei,tr:Ri,bl:rr,br:vr,tex:lt,writingMode:me.writingMode,glyphOffset:Wr,sectionIndex:gt.sectionIndex,isSDF:zt,pixelOffsetTL:Mr,pixelOffsetBR:Dr,minFontScaleX:0,minFontScaleY:0})}return mt}(0,o,S,p,y,x,h,s.allowVerticalPlacement),ie=s.textSizeData;let ce=null;ie.kind==="source"?(ce=[aa*p.layout.get("text-size").evaluate(x,{})],ce[0]>bo&&Z(`${s.layerIds[0]}: Value for "text-size" is >= ${vh}. Reduce your "text-size".`)):ie.kind==="composite"&&(ce=[aa*q.compositeTextSizes[0].evaluate(x,{},H),aa*q.compositeTextSizes[1].evaluate(x,{},H)],(ce[0]>bo||ce[1]>bo)&&Z(`${s.layerIds[0]}: Value for "text-size" is >= ${vh}. Reduce your "text-size".`)),s.addSymbols(s.text,ee,ce,S,y,x,P,n,I.lineStartIndex,I.lineLength,N,H);for(const Ee of L)B[Ee]=s.text.placedSymbolArray.length-1;return 4*ee.length}function Vx(s){for(const n in s)return s[n];return null}function XI(s,n,o,h){const p=s.compareText;if(n in p){const y=p[n];for(let x=y.length-1;x>=0;x--)if(h.dist(y[x])<o)return!0}else p[n]=[];return p[n].push(h),!1}const jx=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class $g{static from(n){if(!(n instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[o,h]=new Uint8Array(n,0,2);if(o!==219)throw new Error("Data does not appear to be in a KDBush format.");const p=h>>4;if(p!==1)throw new Error(`Got v${p} data when expected v1.`);const y=jx[15&h];if(!y)throw new Error("Unrecognized array type.");const[x]=new Uint16Array(n,2,1),[S]=new Uint32Array(n,4,1);return new $g(S,x,y,n)}constructor(n,o=64,h=Float64Array,p){if(isNaN(n)||n<0)throw new Error(`Unpexpected numItems value: ${n}.`);this.numItems=+n,this.nodeSize=Math.min(Math.max(+o,2),65535),this.ArrayType=h,this.IndexArrayType=n<65536?Uint16Array:Uint32Array;const y=jx.indexOf(this.ArrayType),x=2*n*this.ArrayType.BYTES_PER_ELEMENT,S=n*this.IndexArrayType.BYTES_PER_ELEMENT,I=(8-S%8)%8;if(y<0)throw new Error(`Unexpected typed array class: ${h}.`);p&&p instanceof ArrayBuffer?(this.data=p,this.ids=new this.IndexArrayType(this.data,8,n),this.coords=new this.ArrayType(this.data,8+S+I,2*n),this._pos=2*n,this._finished=!0):(this.data=new ArrayBuffer(8+x+S+I),this.ids=new this.IndexArrayType(this.data,8,n),this.coords=new this.ArrayType(this.data,8+S+I,2*n),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+y]),new Uint16Array(this.data,2,1)[0]=o,new Uint32Array(this.data,4,1)[0]=n)}add(n,o){const h=this._pos>>1;return this.ids[h]=h,this.coords[this._pos++]=n,this.coords[this._pos++]=o,h}finish(){const n=this._pos>>1;if(n!==this.numItems)throw new Error(`Added ${n} items when expected ${this.numItems}.`);return Vg(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(n,o,h,p){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:y,coords:x,nodeSize:S}=this,I=[0,y.length-1,0],P=[];for(;I.length;){const L=I.pop()||0,B=I.pop()||0,N=I.pop()||0;if(B-N<=S){for(let ie=N;ie<=B;ie++){const ce=x[2*ie],Ee=x[2*ie+1];ce>=n&&ce<=h&&Ee>=o&&Ee<=p&&P.push(y[ie])}continue}const q=N+B>>1,H=x[2*q],ee=x[2*q+1];H>=n&&H<=h&&ee>=o&&ee<=p&&P.push(y[q]),(L===0?n<=H:o<=ee)&&(I.push(N),I.push(q-1),I.push(1-L)),(L===0?h>=H:p>=ee)&&(I.push(q+1),I.push(B),I.push(1-L))}return P}within(n,o,h){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:p,coords:y,nodeSize:x}=this,S=[0,p.length-1,0],I=[],P=h*h;for(;S.length;){const L=S.pop()||0,B=S.pop()||0,N=S.pop()||0;if(B-N<=x){for(let ie=N;ie<=B;ie++)qx(y[2*ie],y[2*ie+1],n,o)<=P&&I.push(p[ie]);continue}const q=N+B>>1,H=y[2*q],ee=y[2*q+1];qx(H,ee,n,o)<=P&&I.push(p[q]),(L===0?n-h<=H:o-h<=ee)&&(S.push(N),S.push(q-1),S.push(1-L)),(L===0?n+h>=H:o+h>=ee)&&(S.push(q+1),S.push(B),S.push(1-L))}return I}}function Vg(s,n,o,h,p,y){if(p-h<=o)return;const x=h+p>>1;Gx(s,n,x,h,p,y),Vg(s,n,o,h,x-1,1-y),Vg(s,n,o,x+1,p,1-y)}function Gx(s,n,o,h,p,y){for(;p>h;){if(p-h>600){const P=p-h+1,L=o-h+1,B=Math.log(P),N=.5*Math.exp(2*B/3),q=.5*Math.sqrt(B*N*(P-N)/P)*(L-P/2<0?-1:1);Gx(s,n,o,Math.max(h,Math.floor(o-L*N/P+q)),Math.min(p,Math.floor(o+(P-L)*N/P+q)),y)}const x=n[2*o+y];let S=h,I=p;for(bh(s,n,h,o),n[2*p+y]>x&&bh(s,n,h,p);S<I;){for(bh(s,n,S,I),S++,I--;n[2*S+y]<x;)S++;for(;n[2*I+y]>x;)I--}n[2*h+y]===x?bh(s,n,h,I):(I++,bh(s,n,I,p)),I<=o&&(h=I+1),o<=I&&(p=I-1)}}function bh(s,n,o,h){jg(s,o,h),jg(n,2*o,2*h),jg(n,2*o+1,2*h+1)}function jg(s,n,o){const h=s[n];s[n]=s[o],s[o]=h}function qx(s,n,o,h){const p=s-o,y=n-h;return p*p+y*y}var Gg;l.PerformanceMarkers=void 0,(Gg=l.PerformanceMarkers||(l.PerformanceMarkers={})).create="create",Gg.load="load",Gg.fullLoad="fullLoad";let zf=null,wh=[];const qg=1e3/60,Hg="loadTime",Zg="fullLoadTime",KI={mark(s){performance.mark(s)},frame(s){const n=s;zf!=null&&wh.push(n-zf),zf=n},clearMetrics(){zf=null,wh=[],performance.clearMeasures(Hg),performance.clearMeasures(Zg);for(const s in l.PerformanceMarkers)performance.clearMarks(l.PerformanceMarkers[s])},getPerformanceMetrics(){performance.measure(Hg,l.PerformanceMarkers.create,l.PerformanceMarkers.load),performance.measure(Zg,l.PerformanceMarkers.create,l.PerformanceMarkers.fullLoad);const s=performance.getEntriesByName(Hg)[0].duration,n=performance.getEntriesByName(Zg)[0].duration,o=wh.length,h=1/(wh.reduce((y,x)=>y+x,0)/o/1e3),p=wh.filter(y=>y>qg).reduce((y,x)=>y+(x-qg)/qg,0);return{loadTime:s,fullLoadTime:n,fps:h,percentDroppedFrames:p/(o+p)*100,totalFrames:o}}};l.AJAXError=Et,l.ARRAY_TYPE=Ec,l.Actor=class{constructor(s,n,o){this.receive=h=>{const p=h.data,y=p.id;if(y&&(!p.targetMapId||this.mapId===p.targetMapId))if(p.type==="<cancel>"){delete this.tasks[y];const x=this.cancelCallbacks[y];delete this.cancelCallbacks[y],x&&x()}else _e()||p.mustQueue?(this.tasks[y]=p,this.taskQueue.push(y),this.invoker.trigger()):this.processTask(y,p)},this.process=()=>{if(!this.taskQueue.length)return;const h=this.taskQueue.shift(),p=this.tasks[h];delete this.tasks[h],this.taskQueue.length&&this.invoker.trigger(),p&&this.processTask(h,p)},this.target=s,this.parent=n,this.mapId=o,this.callbacks={},this.tasks={},this.taskQueue=[],this.cancelCallbacks={},this.invoker=new $I(this.process),this.target.addEventListener("message",this.receive,!1),this.globalScope=_e()?s:window}send(s,n,o,h,p=!1){const y=Math.round(1e18*Math.random()).toString(36).substring(0,10);o&&(this.callbacks[y]=o);const x=Re(this.globalScope)?void 0:[];return this.target.postMessage({id:y,type:s,hasCallback:!!o,targetMapId:h,mustQueue:p,sourceMapId:this.mapId,data:Ra(n,x)},x),{cancel:()=>{o&&delete this.callbacks[y],this.target.postMessage({id:y,type:"<cancel>",targetMapId:h,sourceMapId:this.mapId})}}}processTask(s,n){if(n.type==="<response>"){const o=this.callbacks[s];delete this.callbacks[s],o&&(n.error?o(uo(n.error)):o(null,uo(n.data)))}else{let o=!1;const h=Re(this.globalScope)?void 0:[],p=n.hasCallback?(S,I)=>{o=!0,delete this.cancelCallbacks[s],this.target.postMessage({id:s,type:"<response>",sourceMapId:this.mapId,error:S?Ra(S):null,data:Ra(I,h)},h)}:S=>{o=!0};let y=null;const x=uo(n.data);if(this.parent[n.type])y=this.parent[n.type](n.sourceMapId,x,p);else if(this.parent.getWorkerSource){const S=n.type.split(".");y=this.parent.getWorkerSource(n.sourceMapId,S[0],x.source)[S[1]](x,p)}else p(new Error(`Could not find function ${n.type}`));!o&&y&&y.cancel&&(this.cancelCallbacks[s]=y.cancel)}}remove(){this.invoker.remove(),this.target.removeEventListener("message",this.receive,!1)}},l.AlphaImage=ch,l.CanonicalTileID=Fg,l.CollisionBoxArray=A,l.CollisionCircleLayoutArray=class extends vc{},l.Color=Yt,l.DEMData=Tx,l.DataConstantProperty=Ot,l.DictionaryCoder=Cx,l.EXTENT=si,l.ErrorEvent=ft,l.EvaluationParameters=Zn,l.Event=Ge,l.Evented=X,l.FeatureIndex=kx,l.FillBucket=bg,l.FillExtrusionBucket=Sg,l.GeoJSONFeature=Ix,l.ImageAtlas=ax,l.ImagePosition=kg,l.KDBush=$g,l.LineBucket=Eg,l.LineStripIndexArray=class extends v{},l.LngLat=wo,l.MercatorCoordinate=Pf,l.ONE_EM=Ai,l.OverscaledTileID=as,l.PerformanceUtils=KI,l.Point=k,l.Pos3dArray=class extends mo{},l.PosArray=se,l.Properties=ki,l.Protobuf=Cg,l.QuadTriangleArray=class extends xc{},l.RGBAImage=ss,l.RasterBoundsArray=class extends _c{},l.RequestPerformance=class{constructor(s){this._marks={start:[s.url,"start"].join("#"),end:[s.url,"end"].join("#"),measure:s.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let s=performance.getEntriesByName(this._marks.measure);return s.length===0&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),s=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),s}},l.SegmentVector=Zt,l.SymbolBucket=Pc,l.Transitionable=pc,l.TriangleIndexArray=Ct,l.Uniform1f=Oi,l.Uniform1i=class extends li{constructor(s,n){super(s,n),this.current=0}set(s){this.current!==s&&(this.current=s,this.gl.uniform1i(this.location,s))}},l.Uniform2f=class extends li{constructor(s,n){super(s,n),this.current=[0,0]}set(s){s[0]===this.current[0]&&s[1]===this.current[1]||(this.current=s,this.gl.uniform2f(this.location,s[0],s[1]))}},l.Uniform3f=class extends li{constructor(s,n){super(s,n),this.current=[0,0,0]}set(s){s[0]===this.current[0]&&s[1]===this.current[1]&&s[2]===this.current[2]||(this.current=s,this.gl.uniform3f(this.location,s[0],s[1],s[2]))}},l.Uniform4f=go,l.UniformColor=wi,l.UniformMatrix4f=class extends li{constructor(s,n){super(s,n),this.current=Bi}set(s){if(s[12]!==this.current[12]||s[0]!==this.current[0])return this.current=s,void this.gl.uniformMatrix4fv(this.location,!1,s);for(let n=1;n<16;n++)if(s[n]!==this.current[n]){this.current=s,this.gl.uniformMatrix4fv(this.location,!1,s);break}}},l.UnwrappedTileID=Ex,l.ValidationError=Be,l.ZoomHistory=dc,l.addDynamicAttributes=Mg,l.arrayBufferToImage=function(s,n){const o=new Image;o.onload=()=>{n(null,o),URL.revokeObjectURL(o.src),o.onload=null,window.requestAnimationFrame(()=>{o.src=Qe})},o.onerror=()=>n(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const h=new Blob([new Uint8Array(s)],{type:"image/png"});o.src=s.byteLength?URL.createObjectURL(h):Qe},l.arrayBufferToImageBitmap=function(s,n){const o=new Blob([new Uint8Array(s)],{type:"image/png"});createImageBitmap(o).then(h=>{n(null,h)}).catch(h=>{n(new Error(`Could not load image because of ${h.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})},l.asyncAll=function(s,n,o){if(!s.length)return o(null,[]);let h=s.length;const p=new Array(s.length);let y=null;s.forEach((x,S)=>{n(x,(I,P)=>{I&&(y=I),p[S]=P,--h==0&&o(y,p)})})},l.bezier=W,l.browser=Ze,l.clamp=he,l.clipLine=Rx,l.clone=function(s){var n=new Ec(16);return n[0]=s[0],n[1]=s[1],n[2]=s[2],n[3]=s[3],n[4]=s[4],n[5]=s[5],n[6]=s[6],n[7]=s[7],n[8]=s[8],n[9]=s[9],n[10]=s[10],n[11]=s[11],n[12]=s[12],n[13]=s[13],n[14]=s[14],n[15]=s[15],n},l.clone$1=Te,l.collisionCircleLayout=mI,l.config=kt,l.copy=function(s,n){return s[0]=n[0],s[1]=n[1],s[2]=n[2],s[3]=n[3],s[4]=n[4],s[5]=n[5],s[6]=n[6],s[7]=n[7],s[8]=n[8],s[9]=n[9],s[10]=n[10],s[11]=n[11],s[12]=n[12],s[13]=n[13],s[14]=n[14],s[15]=n[15],s},l.create=function(){var s=new Ec(16);return Ec!=Float32Array&&(s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[11]=0,s[12]=0,s[13]=0,s[14]=0),s[0]=1,s[5]=1,s[10]=1,s[15]=1,s},l.createExpression=ln,l.createFilter=Bu,l.createLayout=_i,l.createStyleLayer=function(s){if(s.type==="custom")return new UI(s);switch(s.type){case"background":return new BI(s);case"circle":return new wC(s);case"fill":return new VC(s);case"fill-extrusion":return new iI(s);case"heatmap":return new EC(s);case"hillshade":return new CC(s);case"line":return new hI(s);case"raster":return new NI(s);case"symbol":return new Af(s)}},l.deepEqual=function s(n,o){if(Array.isArray(n)){if(!Array.isArray(o)||n.length!==o.length)return!1;for(let h=0;h<n.length;h++)if(!s(n[h],o[h]))return!1;return!0}if(typeof n=="object"&&n!==null&&o!==null){if(typeof o!="object"||Object.keys(n).length!==Object.keys(o).length)return!1;for(const h in n)if(!s(n[h],o[h]))return!1;return!0}return n===o},l.defaultEasing=le,l.derefLayers=function(s){s=s.slice();const n=Object.create(null);for(let o=0;o<s.length;o++)n[s[o].id]=s[o];for(let o=0;o<s.length;o++)"ref"in s[o]&&(s[o]=Le(s[o],n[s[o].ref]));return s},l.diffStyles=function(s,n){if(!s)return[{command:Ve.setStyle,args:[n]}];let o=[];try{if(!De(s.version,n.version))return[{command:Ve.setStyle,args:[n]}];De(s.center,n.center)||o.push({command:Ve.setCenter,args:[n.center]}),De(s.zoom,n.zoom)||o.push({command:Ve.setZoom,args:[n.zoom]}),De(s.bearing,n.bearing)||o.push({command:Ve.setBearing,args:[n.bearing]}),De(s.pitch,n.pitch)||o.push({command:Ve.setPitch,args:[n.pitch]}),De(s.sprite,n.sprite)||o.push({command:Ve.setSprite,args:[n.sprite]}),De(s.glyphs,n.glyphs)||o.push({command:Ve.setGlyphs,args:[n.glyphs]}),De(s.transition,n.transition)||o.push({command:Ve.setTransition,args:[n.transition]}),De(s.light,n.light)||o.push({command:Ve.setLight,args:[n.light]});const h={},p=[];(function(x,S,I,P){let L;for(L in S=S||{},x=x||{})Object.prototype.hasOwnProperty.call(x,L)&&(Object.prototype.hasOwnProperty.call(S,L)||ct(L,I,P));for(L in S)Object.prototype.hasOwnProperty.call(S,L)&&(Object.prototype.hasOwnProperty.call(x,L)?De(x[L],S[L])||(x[L].type==="geojson"&&S[L].type==="geojson"&&it(x,S,L)?I.push({command:Ve.setGeoJSONSourceData,args:[L,S[L].data]}):pt(L,S,I,P)):ht(L,S,I))})(s.sources,n.sources,p,h);const y=[];s.layers&&s.layers.forEach(x=>{h[x.source]?o.push({command:Ve.removeLayer,args:[x.id]}):y.push(x)}),o=o.concat(p),function(x,S,I){S=S||[];const P=(x=x||[]).map(yt),L=S.map(yt),B=x.reduce(Lt,{}),N=S.reduce(Lt,{}),q=P.slice(),H=Object.create(null);let ee,ie,ce,Ee,me,Ae,ze;for(ee=0,ie=0;ee<P.length;ee++)ce=P[ee],Object.prototype.hasOwnProperty.call(N,ce)?ie++:(I.push({command:Ve.removeLayer,args:[ce]}),q.splice(q.indexOf(ce,ie),1));for(ee=0,ie=0;ee<L.length;ee++)ce=L[L.length-1-ee],q[q.length-1-ee]!==ce&&(Object.prototype.hasOwnProperty.call(B,ce)?(I.push({command:Ve.removeLayer,args:[ce]}),q.splice(q.lastIndexOf(ce,q.length-ie),1)):ie++,Ae=q[q.length-ee],I.push({command:Ve.addLayer,args:[N[ce],Ae]}),q.splice(q.length-ee,0,ce),H[ce]=!0);for(ee=0;ee<L.length;ee++)if(ce=L[ee],Ee=B[ce],me=N[ce],!H[ce]&&!De(Ee,me))if(De(Ee.source,me.source)&&De(Ee["source-layer"],me["source-layer"])&&De(Ee.type,me.type)){for(ze in ut(Ee.layout,me.layout,I,ce,null,Ve.setLayoutProperty),ut(Ee.paint,me.paint,I,ce,null,Ve.setPaintProperty),De(Ee.filter,me.filter)||I.push({command:Ve.setFilter,args:[ce,me.filter]}),De(Ee.minzoom,me.minzoom)&&De(Ee.maxzoom,me.maxzoom)||I.push({command:Ve.setLayerZoomRange,args:[ce,me.minzoom,me.maxzoom]}),Ee)Object.prototype.hasOwnProperty.call(Ee,ze)&&ze!=="layout"&&ze!=="paint"&&ze!=="filter"&&ze!=="metadata"&&ze!=="minzoom"&&ze!=="maxzoom"&&(ze.indexOf("paint.")===0?ut(Ee[ze],me[ze],I,ce,ze.slice(6),Ve.setPaintProperty):De(Ee[ze],me[ze])||I.push({command:Ve.setLayerProperty,args:[ce,ze,me[ze]]}));for(ze in me)Object.prototype.hasOwnProperty.call(me,ze)&&!Object.prototype.hasOwnProperty.call(Ee,ze)&&ze!=="layout"&&ze!=="paint"&&ze!=="filter"&&ze!=="metadata"&&ze!=="minzoom"&&ze!=="maxzoom"&&(ze.indexOf("paint.")===0?ut(Ee[ze],me[ze],I,ce,ze.slice(6),Ve.setPaintProperty):De(Ee[ze],me[ze])||I.push({command:Ve.setLayerProperty,args:[ce,ze,me[ze]]}))}else I.push({command:Ve.removeLayer,args:[ce]}),Ae=q[q.lastIndexOf(ce)+1],I.push({command:Ve.addLayer,args:[me,Ae]})}(y,n.layers,o)}catch(h){console.warn("Unable to compute style diff:",h),o=[{command:Ve.setStyle,args:[n]}]}return o},l.dot=function(s,n){return s[0]*n[0]+s[1]*n[1]+s[2]*n[2]+s[3]*n[3]},l.earthRadius=Og,l.emitValidationErrors=sf,l.emptyStyle=function(){const s={},n=U.$version;for(const o in U.$root){const h=U.$root[o];if(h.required){let p=null;p=o==="version"?n:h.type==="array"?[]:{},p!=null&&(s[o]=p)}}return s},l.equals=function(s,n){var o=s[0],h=s[1],p=s[2],y=s[3],x=s[4],S=s[5],I=s[6],P=s[7],L=s[8],B=s[9],N=s[10],q=s[11],H=s[12],ee=s[13],ie=s[14],ce=s[15],Ee=n[0],me=n[1],Ae=n[2],ze=n[3],Ye=n[4],wt=n[5],Dt=n[6],xt=n[7],vt=n[8],mt=n[9],Tt=n[10],gt=n[11],lt=n[12],Vt=n[13],zt=n[14],rn=n[15];return Math.abs(o-Ee)<=gr*Math.max(1,Math.abs(o),Math.abs(Ee))&&Math.abs(h-me)<=gr*Math.max(1,Math.abs(h),Math.abs(me))&&Math.abs(p-Ae)<=gr*Math.max(1,Math.abs(p),Math.abs(Ae))&&Math.abs(y-ze)<=gr*Math.max(1,Math.abs(y),Math.abs(ze))&&Math.abs(x-Ye)<=gr*Math.max(1,Math.abs(x),Math.abs(Ye))&&Math.abs(S-wt)<=gr*Math.max(1,Math.abs(S),Math.abs(wt))&&Math.abs(I-Dt)<=gr*Math.max(1,Math.abs(I),Math.abs(Dt))&&Math.abs(P-xt)<=gr*Math.max(1,Math.abs(P),Math.abs(xt))&&Math.abs(L-vt)<=gr*Math.max(1,Math.abs(L),Math.abs(vt))&&Math.abs(B-mt)<=gr*Math.max(1,Math.abs(B),Math.abs(mt))&&Math.abs(N-Tt)<=gr*Math.max(1,Math.abs(N),Math.abs(Tt))&&Math.abs(q-gt)<=gr*Math.max(1,Math.abs(q),Math.abs(gt))&&Math.abs(H-lt)<=gr*Math.max(1,Math.abs(H),Math.abs(lt))&&Math.abs(ee-Vt)<=gr*Math.max(1,Math.abs(ee),Math.abs(Vt))&&Math.abs(ie-zt)<=gr*Math.max(1,Math.abs(ie),Math.abs(zt))&&Math.abs(ce-rn)<=gr*Math.max(1,Math.abs(ce),Math.abs(rn))},l.evaluateSizeForFeature=function(s,{uSize:n,uSizeT:o},{lowerSize:h,upperSize:p}){return s.kind==="source"?h/aa:s.kind==="composite"?kr.number(h/aa,p/aa,o):n},l.evaluateSizeForZoom=function(s,n){let o=0,h=0;if(s.kind==="constant")h=s.layoutSize;else if(s.kind!=="source"){const{interpolationType:p,minZoom:y,maxZoom:x}=s,S=p?he(Ar.interpolationFactor(p,n,y,x),0,1):0;s.kind==="camera"?h=kr.number(s.minSize,s.maxSize,S):o=S}return{uSizeT:o,uSize:h}},l.evented=Xu,l.extend=ge,l.filterObject=Oe,l.findLineIntersection=function(s,n,o,h){const p=n.y-s.y,y=n.x-s.x,x=h.y-o.y,S=h.x-o.x,I=x*y-S*p;if(I===0)return null;const P=(S*(s.y-o.y)-x*(s.x-o.x))/I;return new k(s.x+P*y,s.y+P*p)},l.fromScaling=function(s,n){return s[0]=n[0],s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=n[1],s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[10]=n[2],s[11]=0,s[12]=0,s[13]=0,s[14]=0,s[15]=1,s},l.getAnchorAlignment=Pg,l.getAnchorJustification=Ug,l.getArrayBuffer=He,l.getDefaultExportFromCjs=b,l.getJSON=function(s,n){return Wt(ge(s,{type:"json"}),n)},l.getOverlapMode=Rg,l.getProtocolAction=At,l.getRTLTextPluginStatus=Ku,l.getReferrer=rt,l.getVideo=function(s,n){const o=window.document.createElement("video");o.muted=!0,o.onloadstart=function(){n(null,o)};for(let h=0;h<s.length;h++){const p=window.document.createElement("source");xe(s[h])||(o.crossOrigin="Anonymous"),p.src=s[h],o.appendChild(p)}return{cancel:()=>{}}},l.groupByLayout=function(s,n){const o={};for(let p=0;p<s.length;p++){const y=n&&n[s[p].id]||ig(s[p]);n&&(n[s[p].id]=y);let x=o[y];x||(x=o[y]=[]),x.push(s[p])}const h=[];for(const p in o)h.push(o[p]);return h},l.identity=hg,l.interpolate=kr,l.invert=function(s,n){var o=n[0],h=n[1],p=n[2],y=n[3],x=n[4],S=n[5],I=n[6],P=n[7],L=n[8],B=n[9],N=n[10],q=n[11],H=n[12],ee=n[13],ie=n[14],ce=n[15],Ee=o*S-h*x,me=o*I-p*x,Ae=o*P-y*x,ze=h*I-p*S,Ye=h*P-y*S,wt=p*P-y*I,Dt=L*ee-B*H,xt=L*ie-N*H,vt=L*ce-q*H,mt=B*ie-N*ee,Tt=B*ce-q*ee,gt=N*ce-q*ie,lt=Ee*gt-me*Tt+Ae*mt+ze*vt-Ye*xt+wt*Dt;return lt?(s[0]=(S*gt-I*Tt+P*mt)*(lt=1/lt),s[1]=(p*Tt-h*gt-y*mt)*lt,s[2]=(ee*wt-ie*Ye+ce*ze)*lt,s[3]=(N*Ye-B*wt-q*ze)*lt,s[4]=(I*vt-x*gt-P*xt)*lt,s[5]=(o*gt-p*vt+y*xt)*lt,s[6]=(ie*Ae-H*wt-ce*me)*lt,s[7]=(L*wt-N*Ae+q*me)*lt,s[8]=(x*Tt-S*vt+P*Dt)*lt,s[9]=(h*vt-o*Tt-y*Dt)*lt,s[10]=(H*Ye-ee*Ae+ce*Ee)*lt,s[11]=(B*Ae-L*Ye-q*Ee)*lt,s[12]=(S*xt-x*mt-I*Dt)*lt,s[13]=(o*mt-h*xt+p*Dt)*lt,s[14]=(ee*me-H*ze-ie*Ee)*lt,s[15]=(L*ze-B*me+N*Ee)*lt,s):null},l.isImageBitmap=nt,l.isSafari=Re,l.isWorker=_e,l.keysDifference=function(s,n){const o=[];for(const h in s)h in n||o.push(h);return o},l.lazyLoadRTLTextPlugin=function(){Zr.isLoading()||Zr.isLoaded()||Ku()!=="deferred"||uf()},l.makeRequest=Wt,l.mapObject=Ue,l.mercatorXfromLng=xx,l.mercatorYfromLat=bx,l.mercatorZfromAltitude=wx,l.mul=bC,l.mul$1=function(s,n,o){return s[0]=n[0]*o[0],s[1]=n[1]*o[1],s[2]=n[2]*o[2],s[3]=n[3]*o[3],s},l.multiply=T0,l.nextPowerOfTwo=function(s){return s<=1?1:Math.pow(2,Math.ceil(Math.log(s)/Math.LN2))},l.operations=Ve,l.ortho=function(s,n,o,h,p,y,x){var S=1/(n-o),I=1/(h-p),P=1/(y-x);return s[0]=-2*S,s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=-2*I,s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[10]=2*P,s[11]=0,s[12]=(n+o)*S,s[13]=(p+h)*I,s[14]=(x+y)*P,s[15]=1,s},l.parseCacheControl=function(s){const n={};if(s.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(o,h,p,y)=>{const x=p||y;return n[h]=!x||x.toLowerCase(),""}),n["max-age"]){const o=parseInt(n["max-age"],10);isNaN(o)?delete n["max-age"]:n["max-age"]=o}return n},l.parseGlyphPbf=function(s){return new Cg(s).readFields(CI,[])},l.pbf=K0,l.performSymbolLayout=function(s){s.bucket.createArrays(),s.bucket.tilePixelRatio=si/(512*s.bucket.overscaling),s.bucket.compareText={},s.bucket.iconsNeedLinear=!1;const n=s.bucket.layers[0],o=n.layout,h=n._unevaluatedLayout._values,p={layoutIconSize:h["icon-size"].possiblyEvaluate(new Zn(s.bucket.zoom+1),s.canonical),layoutTextSize:h["text-size"].possiblyEvaluate(new Zn(s.bucket.zoom+1),s.canonical),textMaxSize:h["text-size"].possiblyEvaluate(new Zn(18))};if(s.bucket.textSizeData.kind==="composite"){const{minZoom:P,maxZoom:L}=s.bucket.textSizeData;p.compositeTextSizes=[h["text-size"].possiblyEvaluate(new Zn(P),s.canonical),h["text-size"].possiblyEvaluate(new Zn(L),s.canonical)]}if(s.bucket.iconSizeData.kind==="composite"){const{minZoom:P,maxZoom:L}=s.bucket.iconSizeData;p.compositeIconSizes=[h["icon-size"].possiblyEvaluate(new Zn(P),s.canonical),h["icon-size"].possiblyEvaluate(new Zn(L),s.canonical)]}const y=o.get("text-line-height")*Ai,x=o.get("text-rotation-alignment")!=="viewport"&&o.get("symbol-placement")!=="point",S=o.get("text-keep-upright"),I=o.get("text-size");for(const P of s.bucket.features){const L=o.get("text-font").evaluate(P,{},s.canonical).join(","),B=I.evaluate(P,{},s.canonical),N=p.layoutTextSize.evaluate(P,{},s.canonical),q=p.layoutIconSize.evaluate(P,{},s.canonical),H={horizontal:{},vertical:void 0},ee=P.text;let ie,ce=[0,0];if(ee){const Ae=ee.toString(),ze=o.get("text-letter-spacing").evaluate(P,{},s.canonical)*Ai,Ye=sg(Ae)?ze:0,wt=o.get("text-anchor").evaluate(P,{},s.canonical),Dt=Ux(n,P,s.canonical);if(!Dt){const gt=o.get("text-radial-offset").evaluate(P,{},s.canonical);ce=gt?Nx(wt,[gt*Ai,Ng]):o.get("text-offset").evaluate(P,{},s.canonical).map(lt=>lt*Ai)}let xt=x?"center":o.get("text-justify").evaluate(P,{},s.canonical);const vt=o.get("symbol-placement"),mt=vt==="point"?o.get("text-max-width").evaluate(P,{},s.canonical)*Ai:0,Tt=()=>{s.bucket.allowVerticalPlacement&&fc(Ae)&&(H.vertical=Cf(ee,s.glyphMap,s.glyphPositions,s.imagePositions,L,mt,y,wt,"left",Ye,ce,l.WritingMode.vertical,!0,vt,N,B))};if(!x&&Dt){const gt=new Set;if(xt==="auto")for(let Vt=0;Vt<Dt.values.length;Vt+=2)gt.add(Ug(Dt.values[Vt]));else gt.add(xt);let lt=!1;for(const Vt of gt)if(!H.horizontal[Vt])if(lt)H.horizontal[Vt]=H.horizontal[0];else{const zt=Cf(ee,s.glyphMap,s.glyphPositions,s.imagePositions,L,mt,y,"center",Vt,Ye,ce,l.WritingMode.horizontal,!1,vt,N,B);zt&&(H.horizontal[Vt]=zt,lt=zt.positionedLines.length===1)}Tt()}else{xt==="auto"&&(xt=Ug(wt));const gt=Cf(ee,s.glyphMap,s.glyphPositions,s.imagePositions,L,mt,y,wt,xt,Ye,ce,l.WritingMode.horizontal,!1,vt,N,B);gt&&(H.horizontal[xt]=gt),Tt(),fc(Ae)&&x&&S&&(H.vertical=Cf(ee,s.glyphMap,s.glyphPositions,s.imagePositions,L,mt,y,wt,xt,Ye,ce,l.WritingMode.vertical,!1,vt,N,B))}}let Ee=!1;if(P.icon&&P.icon.name){const Ae=s.imageMap[P.icon.name];Ae&&(ie=MI(s.imagePositions[P.icon.name],o.get("icon-offset").evaluate(P,{},s.canonical),o.get("icon-anchor").evaluate(P,{},s.canonical)),Ee=!!Ae.sdf,s.bucket.sdfIcons===void 0?s.bucket.sdfIcons=Ee:s.bucket.sdfIcons!==Ee&&Z("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(Ae.pixelRatio!==s.bucket.pixelRatio||o.get("icon-rotate").constantOr(1)!==0)&&(s.bucket.iconsNeedLinear=!0))}const me=Vx(H.horizontal)||H.vertical;s.bucket.iconsInText=!!me&&me.iconsInText,(me||ie)&&YI(s.bucket,P,H,ie,s.imageMap,p,N,q,ce,Ee,s.canonical)}s.showCollisionBoxes&&s.bucket.generateCollisionDebugBuffers()},l.perspective=function(s,n,o,h,p){var y,x=1/Math.tan(n/2);return s[0]=x/o,s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=x,s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[11]=-1,s[12]=0,s[13]=0,s[15]=0,p!=null&&p!==1/0?(s[10]=(p+h)*(y=1/(h-p)),s[14]=2*p*h*y):(s[10]=-1,s[14]=-2*h),s},l.pick=function(s,n){const o={};for(let h=0;h<n.length;h++){const p=n[h];p in s&&(o[p]=s[p])}return o},l.plugin=Zr,l.pointGeometry=w,l.polygonIntersectsPolygon=v0,l.potpack=sx,l.register=St,l.registerForPluginStateChange=function(s){return s({pluginStatus:fr,pluginURL:As}),Xu.on("pluginStateChange",s),s},l.renderColorRamp=P0,l.rotateX=function(s,n,o){var h=Math.sin(o),p=Math.cos(o),y=n[4],x=n[5],S=n[6],I=n[7],P=n[8],L=n[9],B=n[10],N=n[11];return n!==s&&(s[0]=n[0],s[1]=n[1],s[2]=n[2],s[3]=n[3],s[12]=n[12],s[13]=n[13],s[14]=n[14],s[15]=n[15]),s[4]=y*p+P*h,s[5]=x*p+L*h,s[6]=S*p+B*h,s[7]=I*p+N*h,s[8]=P*p-y*h,s[9]=L*p-x*h,s[10]=B*p-S*h,s[11]=N*p-I*h,s},l.rotateZ=function(s,n,o){var h=Math.sin(o),p=Math.cos(o),y=n[0],x=n[1],S=n[2],I=n[3],P=n[4],L=n[5],B=n[6],N=n[7];return n!==s&&(s[8]=n[8],s[9]=n[9],s[10]=n[10],s[11]=n[11],s[12]=n[12],s[13]=n[13],s[14]=n[14],s[15]=n[15]),s[0]=y*p+P*h,s[1]=x*p+L*h,s[2]=S*p+B*h,s[3]=I*p+N*h,s[4]=P*p-y*h,s[5]=L*p-x*h,s[6]=B*p-S*h,s[7]=N*p-I*h,s},l.sameOrigin=xe,l.scale=function(s,n,o){var h=o[0],p=o[1],y=o[2];return s[0]=n[0]*h,s[1]=n[1]*h,s[2]=n[2]*h,s[3]=n[3]*h,s[4]=n[4]*p,s[5]=n[5]*p,s[6]=n[6]*p,s[7]=n[7]*p,s[8]=n[8]*y,s[9]=n[9]*y,s[10]=n[10]*y,s[11]=n[11]*y,s[12]=n[12],s[13]=n[13],s[14]=n[14],s[15]=n[15],s},l.setRTLTextPlugin=function(s,n,o=!1){if(fr===pl||fr===Hu||fr===Zu)throw new Error("setRTLTextPlugin cannot be called multiple times.");As=Ze.resolveURL(s),fr=pl,Wu=n,Yu(),o||uf()},l.sphericalToCartesian=function([s,n,o]){return n+=90,n*=Math.PI/180,o*=Math.PI/180,{x:s*Math.cos(n)*Math.sin(o),y:s*Math.sin(n)*Math.sin(o),z:s*Math.cos(o)}},l.toEvaluationFeature=Ls,l.transformMat4=vf,l.translate=function(s,n,o){var h,p,y,x,S,I,P,L,B,N,q,H,ee=o[0],ie=o[1],ce=o[2];return n===s?(s[12]=n[0]*ee+n[4]*ie+n[8]*ce+n[12],s[13]=n[1]*ee+n[5]*ie+n[9]*ce+n[13],s[14]=n[2]*ee+n[6]*ie+n[10]*ce+n[14],s[15]=n[3]*ee+n[7]*ie+n[11]*ce+n[15]):(p=n[1],y=n[2],x=n[3],S=n[4],I=n[5],P=n[6],L=n[7],B=n[8],N=n[9],q=n[10],H=n[11],s[0]=h=n[0],s[1]=p,s[2]=y,s[3]=x,s[4]=S,s[5]=I,s[6]=P,s[7]=L,s[8]=B,s[9]=N,s[10]=q,s[11]=H,s[12]=h*ee+S*ie+B*ce+n[12],s[13]=p*ee+I*ie+N*ce+n[13],s[14]=y*ee+P*ie+q*ce+n[14],s[15]=x*ee+L*ie+H*ce+n[15]),s},l.triggerPluginCompletionEvent=cf,l.unicodeBlockLookup=bt,l.uniqueId=function(){return Pe++},l.v8Spec=U,l.validateCustomStyleLayer=function(s){const n=[],o=s.id;return o===void 0&&n.push({message:`layers.${o}: missing required property "id"`}),s.render===void 0&&n.push({message:`layers.${o}: missing required method "render"`}),s.renderingMode&&s.renderingMode!=="2d"&&s.renderingMode!=="3d"&&n.push({message:`layers.${o}: property "renderingMode" must be either "2d" or "3d"`}),n},l.validateLight=fl,l.validateStyle=dl,l.vectorTile=vo,l.warnOnce=Z,l.wrap=be}),d(["./shared"],function(l){class b{constructor(F){this.keyCache={},F&&this.replace(F)}replace(F){this._layerConfigs={},this._layers={},this.update(F,[])}update(F,$){for(const re of F){this._layerConfigs[re.id]=re;const de=this._layers[re.id]=l.createStyleLayer(re);de._featureFilter=l.createFilter(de.filter),this.keyCache[re.id]&&delete this.keyCache[re.id]}for(const re of $)delete this.keyCache[re],delete this._layerConfigs[re],delete this._layers[re];this.familiesBySource={};const Y=l.groupByLayout(Object.values(this._layerConfigs),this.keyCache);for(const re of Y){const de=re.map(et=>this._layers[et.id]),Se=de[0];if(Se.visibility==="none")continue;const pe=Se.source||"";let fe=this.familiesBySource[pe];fe||(fe=this.familiesBySource[pe]={});const Ce=Se.sourceLayer||"_geojsonTileLayer";let Xe=fe[Ce];Xe||(Xe=fe[Ce]=[]),Xe.push(de)}}}class w{constructor(F){const $={},Y=[];for(const pe in F){const fe=F[pe],Ce=$[pe]={};for(const Xe in fe){const et=fe[+Xe];if(!et||et.bitmap.width===0||et.bitmap.height===0)continue;const tt={x:0,y:0,w:et.bitmap.width+2,h:et.bitmap.height+2};Y.push(tt),Ce[Xe]={rect:tt,metrics:et.metrics}}}const{w:re,h:de}=l.potpack(Y),Se=new l.AlphaImage({width:re||1,height:de||1});for(const pe in F){const fe=F[pe];for(const Ce in fe){const Xe=fe[+Ce];if(!Xe||Xe.bitmap.width===0||Xe.bitmap.height===0)continue;const et=$[pe][Ce].rect;l.AlphaImage.copy(Xe.bitmap,Se,{x:0,y:0},{x:et.x+1,y:et.y+1},Xe.bitmap)}}this.image=Se,this.positions=$}}l.register("GlyphAtlas",w);class C{constructor(F){this.tileID=new l.OverscaledTileID(F.tileID.overscaledZ,F.tileID.wrap,F.tileID.canonical.z,F.tileID.canonical.x,F.tileID.canonical.y),this.uid=F.uid,this.zoom=F.zoom,this.pixelRatio=F.pixelRatio,this.tileSize=F.tileSize,this.source=F.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=F.showCollisionBoxes,this.collectResourceTiming=!!F.collectResourceTiming,this.returnDependencies=!!F.returnDependencies,this.promoteId=F.promoteId,this.inFlightDependencies=[],this.dependencySentinel=-1}parse(F,$,Y,re,de){this.status="parsing",this.data=F,this.collisionBoxArray=new l.CollisionBoxArray;const Se=new l.DictionaryCoder(Object.keys(F.layers).sort()),pe=new l.FeatureIndex(this.tileID,this.promoteId);pe.bucketLayerIDs=[];const fe={},Ce={featureIndex:pe,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:Y},Xe=$.familiesBySource[this.source];for(const on in Xe){const pn=F.layers[on];if(!pn)continue;pn.version===1&&l.warnOnce(`Vector tile source "${this.source}" layer "${on}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const dr=Se.encode(on),Yt=[];for(let bi=0;bi<pn.length;bi++){const $i=pn.feature(bi),di=pe.getId($i,on);Yt.push({feature:$i,id:di,index:bi,sourceLayerIndex:dr})}for(const bi of Xe[on]){const $i=bi[0];$i.source!==this.source&&l.warnOnce(`layer.source = ${$i.source} does not equal this.source = ${this.source}`),$i.minzoom&&this.zoom<Math.floor($i.minzoom)||$i.maxzoom&&this.zoom>=$i.maxzoom||$i.visibility!=="none"&&(k(bi,this.zoom,Y),(fe[$i.id]=$i.createBucket({index:pe.bucketLayerIDs.length,layers:bi,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:dr,sourceID:this.source})).populate(Yt,Ce,this.tileID.canonical),pe.bucketLayerIDs.push(bi.map(di=>di.id)))}}let et,tt,Gt,Qt;const Rt=l.mapObject(Ce.glyphDependencies,on=>Object.keys(on).map(Number));this.inFlightDependencies.forEach(on=>on==null?void 0:on.cancel()),this.inFlightDependencies=[];const Ut=++this.dependencySentinel;Object.keys(Rt).length?this.inFlightDependencies.push(re.send("getGlyphs",{uid:this.uid,stacks:Rt,source:this.source,tileID:this.tileID,type:"glyphs"},(on,pn)=>{Ut===this.dependencySentinel&&(et||(et=on,tt=pn,Dn.call(this)))})):tt={};const Kt=Object.keys(Ce.iconDependencies);Kt.length?this.inFlightDependencies.push(re.send("getImages",{icons:Kt,source:this.source,tileID:this.tileID,type:"icons"},(on,pn)=>{Ut===this.dependencySentinel&&(et||(et=on,Gt=pn,Dn.call(this)))})):Gt={};const _n=Object.keys(Ce.patternDependencies);function Dn(){if(et)return de(et);if(tt&&Gt&&Qt){const on=new w(tt),pn=new l.ImageAtlas(Gt,Qt);for(const dr in fe){const Yt=fe[dr];Yt instanceof l.SymbolBucket?(k(Yt.layers,this.zoom,Y),l.performSymbolLayout({bucket:Yt,glyphMap:tt,glyphPositions:on.positions,imageMap:Gt,imagePositions:pn.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical})):Yt.hasPattern&&(Yt instanceof l.LineBucket||Yt instanceof l.FillBucket||Yt instanceof l.FillExtrusionBucket)&&(k(Yt.layers,this.zoom,Y),Yt.addFeatures(Ce,this.tileID.canonical,pn.patternPositions))}this.status="done",de(null,{buckets:Object.values(fe).filter(dr=>!dr.isEmpty()),featureIndex:pe,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:on.image,imageAtlas:pn,glyphMap:this.returnDependencies?tt:null,iconMap:this.returnDependencies?Gt:null,glyphPositions:this.returnDependencies?on.positions:null})}}_n.length?this.inFlightDependencies.push(re.send("getImages",{icons:_n,source:this.source,tileID:this.tileID,type:"patterns"},(on,pn)=>{Ut===this.dependencySentinel&&(et||(et=on,Qt=pn,Dn.call(this)))})):Qt={},Dn.call(this)}}function k(ne,F,$){const Y=new l.EvaluationParameters(F);for(const re of ne)re.recalculate(Y,$)}function M(ne,F){const $=l.getArrayBuffer(ne.request,(Y,re,de,Se)=>{Y?F(Y):re&&F(null,{vectorTile:new l.vectorTile.VectorTile(new l.Protobuf(re)),rawData:re,cacheControl:de,expires:Se})});return()=>{$.cancel(),F()}}class O{constructor(F,$,Y,re){this.actor=F,this.layerIndex=$,this.availableImages=Y,this.loadVectorData=re||M,this.fetching={},this.loading={},this.loaded={}}loadTile(F,$){const Y=F.uid;this.loading||(this.loading={});const re=!!(F&&F.request&&F.request.collectResourceTiming)&&new l.RequestPerformance(F.request),de=this.loading[Y]=new C(F);de.abort=this.loadVectorData(F,(Se,pe)=>{if(delete this.loading[Y],Se||!pe)return de.status="done",this.loaded[Y]=de,$(Se);const fe=pe.rawData,Ce={};pe.expires&&(Ce.expires=pe.expires),pe.cacheControl&&(Ce.cacheControl=pe.cacheControl);const Xe={};if(re){const et=re.finish();et&&(Xe.resourceTiming=JSON.parse(JSON.stringify(et)))}de.vectorTile=pe.vectorTile,de.parse(pe.vectorTile,this.layerIndex,this.availableImages,this.actor,(et,tt)=>{if(delete this.fetching[Y],et||!tt)return $(et);$(null,l.extend({rawTileData:fe.slice(0)},tt,Ce,Xe))}),this.loaded=this.loaded||{},this.loaded[Y]=de,this.fetching[Y]={rawTileData:fe,cacheControl:Ce,resourceTiming:Xe}})}reloadTile(F,$){const Y=this.loaded,re=F.uid;if(Y&&Y[re]){const de=Y[re];de.showCollisionBoxes=F.showCollisionBoxes,de.status==="parsing"?de.parse(de.vectorTile,this.layerIndex,this.availableImages,this.actor,(Se,pe)=>{if(Se||!pe)return $(Se,pe);let fe;if(this.fetching[re]){const{rawTileData:Ce,cacheControl:Xe,resourceTiming:et}=this.fetching[re];delete this.fetching[re],fe=l.extend({rawTileData:Ce.slice(0)},pe,Xe,et)}else fe=pe;$(null,fe)}):de.status==="done"&&(de.vectorTile?de.parse(de.vectorTile,this.layerIndex,this.availableImages,this.actor,$):$())}}abortTile(F,$){const Y=this.loading,re=F.uid;Y&&Y[re]&&Y[re].abort&&(Y[re].abort(),delete Y[re]),$()}removeTile(F,$){const Y=this.loaded,re=F.uid;Y&&Y[re]&&delete Y[re],$()}}class j{constructor(){this.loaded={}}loadTile(F,$){const{uid:Y,encoding:re,rawImageData:de}=F,Se=l.isImageBitmap(de)?this.getImageData(de):de,pe=new l.DEMData(Y,Se,re);this.loaded=this.loaded||{},this.loaded[Y]=pe,$(null,pe)}getImageData(F){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(F.width,F.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d",{willReadFrequently:!0})),this.offscreenCanvas.width=F.width,this.offscreenCanvas.height=F.height,this.offscreenCanvasContext.drawImage(F,0,0,F.width,F.height);const $=this.offscreenCanvasContext.getImageData(-1,-1,F.width+2,F.height+2);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),new l.RGBAImage({width:$.width,height:$.height},$.data)}removeTile(F){const $=this.loaded,Y=F.uid;$&&$[Y]&&delete $[Y]}}function W(ne,F){if(ne.length!==0){le(ne[0],F);for(var $=1;$<ne.length;$++)le(ne[$],!F)}}function le(ne,F){for(var $=0,Y=0,re=0,de=ne.length,Se=de-1;re<de;Se=re++){var pe=(ne[re][0]-ne[Se][0])*(ne[Se][1]+ne[re][1]),fe=$+pe;Y+=Math.abs($)>=Math.abs(pe)?$-fe+pe:pe-fe+$,$=fe}$+Y>=0!=!!F&&ne.reverse()}var he=l.getDefaultExportFromCjs(function ne(F,$){var Y,re=F&&F.type;if(re==="FeatureCollection")for(Y=0;Y<F.features.length;Y++)ne(F.features[Y],$);else if(re==="GeometryCollection")for(Y=0;Y<F.geometries.length;Y++)ne(F.geometries[Y],$);else if(re==="Feature")ne(F.geometry,$);else if(re==="Polygon")W(F.coordinates,$);else if(re==="MultiPolygon")for(Y=0;Y<F.coordinates.length;Y++)W(F.coordinates[Y],$);return F});const be=l.vectorTile.VectorTileFeature.prototype.toGeoJSON;var ge={exports:{}},Pe=l.pointGeometry,Ue=l.vectorTile.VectorTileFeature,Oe=Te;function Te(ne,F){this.options=F||{},this.features=ne,this.length=ne.length}function V(ne,F){this.id=typeof ne.id=="number"?ne.id:void 0,this.type=ne.type,this.rawGeometry=ne.type===1?[ne.geometry]:ne.geometry,this.properties=ne.tags,this.extent=F||4096}Te.prototype.feature=function(ne){return new V(this.features[ne],this.options.extent)},V.prototype.loadGeometry=function(){var ne=this.rawGeometry;this.geometry=[];for(var F=0;F<ne.length;F++){for(var $=ne[F],Y=[],re=0;re<$.length;re++)Y.push(new Pe($[re][0],$[re][1]));this.geometry.push(Y)}return this.geometry},V.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var ne=this.geometry,F=1/0,$=-1/0,Y=1/0,re=-1/0,de=0;de<ne.length;de++)for(var Se=ne[de],pe=0;pe<Se.length;pe++){var fe=Se[pe];F=Math.min(F,fe.x),$=Math.max($,fe.x),Y=Math.min(Y,fe.y),re=Math.max(re,fe.y)}return[F,Y,$,re]},V.prototype.toGeoJSON=Ue.prototype.toGeoJSON;var Z=l.pbf,ae=Oe;function ke(ne){var F=new Z;return function($,Y){for(var re in $.layers)Y.writeMessage(3,_e,$.layers[re])}(ne,F),F.finish()}function _e(ne,F){var $;F.writeVarintField(15,ne.version||1),F.writeStringField(1,ne.name||""),F.writeVarintField(5,ne.extent||4096);var Y={keys:[],values:[],keycache:{},valuecache:{}};for($=0;$<ne.length;$++)Y.feature=ne.feature($),F.writeMessage(2,oe,Y);var re=Y.keys;for($=0;$<re.length;$++)F.writeStringField(3,re[$]);var de=Y.values;for($=0;$<de.length;$++)F.writeMessage(4,je,de[$])}function oe(ne,F){var $=ne.feature;$.id!==void 0&&F.writeVarintField(1,$.id),F.writeMessage(2,Re,ne),F.writeVarintField(3,$.type),F.writeMessage(4,qe,$)}function Re(ne,F){var $=ne.feature,Y=ne.keys,re=ne.values,de=ne.keycache,Se=ne.valuecache;for(var pe in $.properties){var fe=$.properties[pe],Ce=de[pe];if(fe!==null){Ce===void 0&&(Y.push(pe),de[pe]=Ce=Y.length-1),F.writeVarint(Ce);var Xe=typeof fe;Xe!=="string"&&Xe!=="boolean"&&Xe!=="number"&&(fe=JSON.stringify(fe));var et=Xe+":"+fe,tt=Se[et];tt===void 0&&(re.push(fe),Se[et]=tt=re.length-1),F.writeVarint(tt)}}}function nt(ne,F){return(F<<3)+(7&ne)}function Qe(ne){return ne<<1^ne>>31}function qe(ne,F){for(var $=ne.loadGeometry(),Y=ne.type,re=0,de=0,Se=$.length,pe=0;pe<Se;pe++){var fe=$[pe],Ce=1;Y===1&&(Ce=fe.length),F.writeVarint(nt(1,Ce));for(var Xe=Y===3?fe.length-1:fe.length,et=0;et<Xe;et++){et===1&&Y!==1&&F.writeVarint(nt(2,Xe-1));var tt=fe[et].x-re,Gt=fe[et].y-de;F.writeVarint(Qe(tt)),F.writeVarint(Qe(Gt)),re+=tt,de+=Gt}Y===3&&F.writeVarint(nt(7,1))}}function je(ne,F){var $=typeof ne;$==="string"?F.writeStringField(1,ne):$==="boolean"?F.writeBooleanField(7,ne):$==="number"&&(ne%1!=0?F.writeDoubleField(3,ne):ne<0?F.writeSVarintField(6,ne):F.writeVarintField(5,ne))}ge.exports=ke,ge.exports.fromVectorTileJs=ke,ge.exports.fromGeojsonVt=function(ne,F){F=F||{};var $={};for(var Y in ne)$[Y]=new ae(ne[Y].features,F),$[Y].name=Y,$[Y].version=F.version,$[Y].extent=F.extent;return ke({layers:$})},ge.exports.GeoJSONWrapper=ae;var Ze=l.getDefaultExportFromCjs(ge.exports);const kt={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:ne=>ne},Et=Math.fround||(rt=new Float32Array(1),ne=>(rt[0]=+ne,rt[0]));var rt;const At=3,Pt=5,Wt=6;class He{constructor(F){this.options=Object.assign(Object.create(kt),F),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(F){const{log:$,minZoom:Y,maxZoom:re}=this.options;$&&console.time("total time");const de=`prepare ${F.length} points`;$&&console.time(de),this.points=F;const Se=[];for(let fe=0;fe<F.length;fe++){const Ce=F[fe];if(!Ce.geometry)continue;const[Xe,et]=Ce.geometry.coordinates,tt=Et(Fe(Xe)),Gt=Et(Ge(et));Se.push(tt,Gt,1/0,fe,-1,1),this.options.reduce&&Se.push(0)}let pe=this.trees[re+1]=this._createTree(Se);$&&console.timeEnd(de);for(let fe=re;fe>=Y;fe--){const Ce=+Date.now();pe=this.trees[fe]=this._createTree(this._cluster(pe,fe)),$&&console.log("z%d: %d clusters in %dms",fe,pe.numItems,+Date.now()-Ce)}return $&&console.timeEnd("total time"),this}getClusters(F,$){let Y=((F[0]+180)%360+360)%360-180;const re=Math.max(-90,Math.min(90,F[1]));let de=F[2]===180?180:((F[2]+180)%360+360)%360-180;const Se=Math.max(-90,Math.min(90,F[3]));if(F[2]-F[0]>=360)Y=-180,de=180;else if(Y>de){const et=this.getClusters([Y,re,180,Se],$),tt=this.getClusters([-180,re,de,Se],$);return et.concat(tt)}const pe=this.trees[this._limitZoom($)],fe=pe.range(Fe(Y),Ge(Se),Fe(de),Ge(re)),Ce=pe.data,Xe=[];for(const et of fe){const tt=this.stride*et;Xe.push(Ce[tt+Pt]>1?xe(Ce,tt,this.clusterProps):this.points[Ce[tt+At]])}return Xe}getChildren(F){const $=this._getOriginId(F),Y=this._getOriginZoom(F),re="No cluster with the specified id.",de=this.trees[Y];if(!de)throw new Error(re);const Se=de.data;if($*this.stride>=Se.length)throw new Error(re);const pe=this.options.radius/(this.options.extent*Math.pow(2,Y-1)),fe=de.within(Se[$*this.stride],Se[$*this.stride+1],pe),Ce=[];for(const Xe of fe){const et=Xe*this.stride;Se[et+4]===F&&Ce.push(Se[et+Pt]>1?xe(Se,et,this.clusterProps):this.points[Se[et+At]])}if(Ce.length===0)throw new Error(re);return Ce}getLeaves(F,$,Y){const re=[];return this._appendLeaves(re,F,$=$||10,Y=Y||0,0),re}getTile(F,$,Y){const re=this.trees[this._limitZoom(F)],de=Math.pow(2,F),{extent:Se,radius:pe}=this.options,fe=pe/Se,Ce=(Y-fe)/de,Xe=(Y+1+fe)/de,et={features:[]};return this._addTileFeatures(re.range(($-fe)/de,Ce,($+1+fe)/de,Xe),re.data,$,Y,de,et),$===0&&this._addTileFeatures(re.range(1-fe/de,Ce,1,Xe),re.data,de,Y,de,et),$===de-1&&this._addTileFeatures(re.range(0,Ce,fe/de,Xe),re.data,-1,Y,de,et),et.features.length?et:null}getClusterExpansionZoom(F){let $=this._getOriginZoom(F)-1;for(;$<=this.options.maxZoom;){const Y=this.getChildren(F);if($++,Y.length!==1)break;F=Y[0].properties.cluster_id}return $}_appendLeaves(F,$,Y,re,de){const Se=this.getChildren($);for(const pe of Se){const fe=pe.properties;if(fe&&fe.cluster?de+fe.point_count<=re?de+=fe.point_count:de=this._appendLeaves(F,fe.cluster_id,Y,re,de):de<re?de++:F.push(pe),F.length===Y)break}return de}_createTree(F){const $=new l.KDBush(F.length/this.stride|0,this.options.nodeSize,Float32Array);for(let Y=0;Y<F.length;Y+=this.stride)$.add(F[Y],F[Y+1]);return $.finish(),$.data=F,$}_addTileFeatures(F,$,Y,re,de,Se){for(const pe of F){const fe=pe*this.stride,Ce=$[fe+Pt]>1;let Xe,et,tt;if(Ce)Xe=Ke($,fe,this.clusterProps),et=$[fe],tt=$[fe+1];else{const Rt=this.points[$[fe+At]];Xe=Rt.properties;const[Ut,Kt]=Rt.geometry.coordinates;et=Fe(Ut),tt=Ge(Kt)}const Gt={type:1,geometry:[[Math.round(this.options.extent*(et*de-Y)),Math.round(this.options.extent*(tt*de-re))]],tags:Xe};let Qt;Qt=Ce||this.options.generateId?$[fe+At]:this.points[$[fe+At]].id,Qt!==void 0&&(Gt.id=Qt),Se.features.push(Gt)}}_limitZoom(F){return Math.max(this.options.minZoom,Math.min(Math.floor(+F),this.options.maxZoom+1))}_cluster(F,$){const{radius:Y,extent:re,reduce:de,minPoints:Se}=this.options,pe=Y/(re*Math.pow(2,$)),fe=F.data,Ce=[],Xe=this.stride;for(let et=0;et<fe.length;et+=Xe){if(fe[et+2]<=$)continue;fe[et+2]=$;const tt=fe[et],Gt=fe[et+1],Qt=F.within(fe[et],fe[et+1],pe),Rt=fe[et+Pt];let Ut=Rt;for(const Kt of Qt){const _n=Kt*Xe;fe[_n+2]>$&&(Ut+=fe[_n+Pt])}if(Ut>Rt&&Ut>=Se){let Kt,_n=tt*Rt,Dn=Gt*Rt,on=-1;const pn=((et/Xe|0)<<5)+($+1)+this.points.length;for(const dr of Qt){const Yt=dr*Xe;if(fe[Yt+2]<=$)continue;fe[Yt+2]=$;const bi=fe[Yt+Pt];_n+=fe[Yt]*bi,Dn+=fe[Yt+1]*bi,fe[Yt+4]=pn,de&&(Kt||(Kt=this._map(fe,et,!0),on=this.clusterProps.length,this.clusterProps.push(Kt)),de(Kt,this._map(fe,Yt)))}fe[et+4]=pn,Ce.push(_n/Ut,Dn/Ut,1/0,pn,-1,Ut),de&&Ce.push(on)}else{for(let Kt=0;Kt<Xe;Kt++)Ce.push(fe[et+Kt]);if(Ut>1)for(const Kt of Qt){const _n=Kt*Xe;if(!(fe[_n+2]<=$)){fe[_n+2]=$;for(let Dn=0;Dn<Xe;Dn++)Ce.push(fe[_n+Dn])}}}}return Ce}_getOriginId(F){return F-this.points.length>>5}_getOriginZoom(F){return(F-this.points.length)%32}_map(F,$,Y){if(F[$+Pt]>1){const Se=this.clusterProps[F[$+Wt]];return Y?Object.assign({},Se):Se}const re=this.points[F[$+At]].properties,de=this.options.map(re);return Y&&de===re?Object.assign({},de):de}}function xe(ne,F,$){return{type:"Feature",id:ne[F+At],properties:Ke(ne,F,$),geometry:{type:"Point",coordinates:[(Y=ne[F],360*(Y-.5)),ft(ne[F+1])]}};var Y}function Ke(ne,F,$){const Y=ne[F+Pt],re=Y>=1e4?`${Math.round(Y/1e3)}k`:Y>=1e3?Math.round(Y/100)/10+"k":Y,de=ne[F+Wt],Se=de===-1?{}:Object.assign({},$[de]);return Object.assign(Se,{cluster:!0,cluster_id:ne[F+At],point_count:Y,point_count_abbreviated:re})}function Fe(ne){return ne/360+.5}function Ge(ne){const F=Math.sin(ne*Math.PI/180),$=.5-.25*Math.log((1+F)/(1-F))/Math.PI;return $<0?0:$>1?1:$}function ft(ne){const F=(180-360*ne)*Math.PI/180;return 360*Math.atan(Math.exp(F))/Math.PI-90}function X(ne,F,$,Y){for(var re,de=Y,Se=$-F>>1,pe=$-F,fe=ne[F],Ce=ne[F+1],Xe=ne[$],et=ne[$+1],tt=F+3;tt<$;tt+=3){var Gt=U(ne[tt],ne[tt+1],fe,Ce,Xe,et);if(Gt>de)re=tt,de=Gt;else if(Gt===de){var Qt=Math.abs(tt-Se);Qt<pe&&(re=tt,pe=Qt)}}de>Y&&(re-F>3&&X(ne,F,re,Y),ne[re+2]=de,$-re>3&&X(ne,re,$,Y))}function U(ne,F,$,Y,re,de){var Se=re-$,pe=de-Y;if(Se!==0||pe!==0){var fe=((ne-$)*Se+(F-Y)*pe)/(Se*Se+pe*pe);fe>1?($=re,Y=de):fe>0&&($+=Se*fe,Y+=pe*fe)}return(Se=ne-$)*Se+(pe=F-Y)*pe}function ye(ne,F,$,Y){var re={id:ne===void 0?null:ne,type:F,geometry:$,tags:Y,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(de){var Se=de.geometry,pe=de.type;if(pe==="Point"||pe==="MultiPoint"||pe==="LineString")Le(de,Se);else if(pe==="Polygon"||pe==="MultiLineString")for(var fe=0;fe<Se.length;fe++)Le(de,Se[fe]);else if(pe==="MultiPolygon")for(fe=0;fe<Se.length;fe++)for(var Ce=0;Ce<Se[fe].length;Ce++)Le(de,Se[fe][Ce])}(re),re}function Le(ne,F){for(var $=0;$<F.length;$+=3)ne.minX=Math.min(ne.minX,F[$]),ne.minY=Math.min(ne.minY,F[$+1]),ne.maxX=Math.max(ne.maxX,F[$]),ne.maxY=Math.max(ne.maxY,F[$+1])}function De(ne,F,$,Y){if(F.geometry){var re=F.geometry.coordinates,de=F.geometry.type,Se=Math.pow($.tolerance/((1<<$.maxZoom)*$.extent),2),pe=[],fe=F.id;if($.promoteId?fe=F.properties[$.promoteId]:$.generateId&&(fe=Y||0),de==="Point")Ve(re,pe);else if(de==="MultiPoint")for(var Ce=0;Ce<re.length;Ce++)Ve(re[Ce],pe);else if(de==="LineString")ht(re,pe,Se,!1);else if(de==="MultiLineString"){if($.lineMetrics){for(Ce=0;Ce<re.length;Ce++)ht(re[Ce],pe=[],Se,!1),ne.push(ye(fe,"LineString",pe,F.properties));return}ct(re,pe,Se,!1)}else if(de==="Polygon")ct(re,pe,Se,!0);else{if(de!=="MultiPolygon"){if(de==="GeometryCollection"){for(Ce=0;Ce<F.geometry.geometries.length;Ce++)De(ne,{id:fe,geometry:F.geometry.geometries[Ce],properties:F.properties},$,Y);return}throw new Error("Input data is not a valid GeoJSON object.")}for(Ce=0;Ce<re.length;Ce++){var Xe=[];ct(re[Ce],Xe,Se,!0),pe.push(Xe)}}ne.push(ye(fe,de,pe,F.properties))}}function Ve(ne,F){F.push(pt(ne[0])),F.push(it(ne[1])),F.push(0)}function ht(ne,F,$,Y){for(var re,de,Se=0,pe=0;pe<ne.length;pe++){var fe=pt(ne[pe][0]),Ce=it(ne[pe][1]);F.push(fe),F.push(Ce),F.push(0),pe>0&&(Se+=Y?(re*Ce-fe*de)/2:Math.sqrt(Math.pow(fe-re,2)+Math.pow(Ce-de,2))),re=fe,de=Ce}var Xe=F.length-3;F[2]=1,X(F,0,Xe,$),F[Xe+2]=1,F.size=Math.abs(Se),F.start=0,F.end=F.size}function ct(ne,F,$,Y){for(var re=0;re<ne.length;re++){var de=[];ht(ne[re],de,$,Y),F.push(de)}}function pt(ne){return ne/360+.5}function it(ne){var F=Math.sin(ne*Math.PI/180),$=.5-.25*Math.log((1+F)/(1-F))/Math.PI;return $<0?0:$>1?1:$}function ut(ne,F,$,Y,re,de,Se,pe){if(Y/=F,de>=($/=F)&&Se<Y)return ne;if(Se<$||de>=Y)return null;for(var fe=[],Ce=0;Ce<ne.length;Ce++){var Xe=ne[Ce],et=Xe.geometry,tt=Xe.type,Gt=re===0?Xe.minX:Xe.minY,Qt=re===0?Xe.maxX:Xe.maxY;if(Gt>=$&&Qt<Y)fe.push(Xe);else if(!(Qt<$||Gt>=Y)){var Rt=[];if(tt==="Point"||tt==="MultiPoint")yt(et,Rt,$,Y,re);else if(tt==="LineString")Lt(et,Rt,$,Y,re,!1,pe.lineMetrics);else if(tt==="MultiLineString")jt(et,Rt,$,Y,re,!1);else if(tt==="Polygon")jt(et,Rt,$,Y,re,!0);else if(tt==="MultiPolygon")for(var Ut=0;Ut<et.length;Ut++){var Kt=[];jt(et[Ut],Kt,$,Y,re,!0),Kt.length&&Rt.push(Kt)}if(Rt.length){if(pe.lineMetrics&&tt==="LineString"){for(Ut=0;Ut<Rt.length;Ut++)fe.push(ye(Xe.id,tt,Rt[Ut],Xe.tags));continue}tt!=="LineString"&&tt!=="MultiLineString"||(Rt.length===1?(tt="LineString",Rt=Rt[0]):tt="MultiLineString"),tt!=="Point"&&tt!=="MultiPoint"||(tt=Rt.length===3?"Point":"MultiPoint"),fe.push(ye(Xe.id,tt,Rt,Xe.tags))}}}return fe.length?fe:null}function yt(ne,F,$,Y,re){for(var de=0;de<ne.length;de+=3){var Se=ne[de+re];Se>=$&&Se<=Y&&(F.push(ne[de]),F.push(ne[de+1]),F.push(ne[de+2]))}}function Lt(ne,F,$,Y,re,de,Se){for(var pe,fe,Ce=Be(ne),Xe=re===0?tn:fn,et=ne.start,tt=0;tt<ne.length-3;tt+=3){var Gt=ne[tt],Qt=ne[tt+1],Rt=ne[tt+2],Ut=ne[tt+3],Kt=ne[tt+4],_n=re===0?Gt:Qt,Dn=re===0?Ut:Kt,on=!1;Se&&(pe=Math.sqrt(Math.pow(Gt-Ut,2)+Math.pow(Qt-Kt,2))),_n<$?Dn>$&&(fe=Xe(Ce,Gt,Qt,Ut,Kt,$),Se&&(Ce.start=et+pe*fe)):_n>Y?Dn<Y&&(fe=Xe(Ce,Gt,Qt,Ut,Kt,Y),Se&&(Ce.start=et+pe*fe)):Xt(Ce,Gt,Qt,Rt),Dn<$&&_n>=$&&(fe=Xe(Ce,Gt,Qt,Ut,Kt,$),on=!0),Dn>Y&&_n<=Y&&(fe=Xe(Ce,Gt,Qt,Ut,Kt,Y),on=!0),!de&&on&&(Se&&(Ce.end=et+pe*fe),F.push(Ce),Ce=Be(ne)),Se&&(et+=pe)}var pn=ne.length-3;Gt=ne[pn],Qt=ne[pn+1],Rt=ne[pn+2],(_n=re===0?Gt:Qt)>=$&&_n<=Y&&Xt(Ce,Gt,Qt,Rt),pn=Ce.length-3,de&&pn>=3&&(Ce[pn]!==Ce[0]||Ce[pn+1]!==Ce[1])&&Xt(Ce,Ce[0],Ce[1],Ce[2]),Ce.length&&F.push(Ce)}function Be(ne){var F=[];return F.size=ne.size,F.start=ne.start,F.end=ne.end,F}function jt(ne,F,$,Y,re,de){for(var Se=0;Se<ne.length;Se++)Lt(ne[Se],F,$,Y,re,de,!1)}function Xt(ne,F,$,Y){ne.push(F),ne.push($),ne.push(Y)}function tn(ne,F,$,Y,re,de){var Se=(de-F)/(Y-F);return ne.push(de),ne.push($+(re-$)*Se),ne.push(1),Se}function fn(ne,F,$,Y,re,de){var Se=(de-$)/(re-$);return ne.push(F+(Y-F)*Se),ne.push(de),ne.push(1),Se}function st(ne,F){for(var $=[],Y=0;Y<ne.length;Y++){var re,de=ne[Y],Se=de.type;if(Se==="Point"||Se==="MultiPoint"||Se==="LineString")re=Ft(de.geometry,F);else if(Se==="MultiLineString"||Se==="Polygon"){re=[];for(var pe=0;pe<de.geometry.length;pe++)re.push(Ft(de.geometry[pe],F))}else if(Se==="MultiPolygon")for(re=[],pe=0;pe<de.geometry.length;pe++){for(var fe=[],Ce=0;Ce<de.geometry[pe].length;Ce++)fe.push(Ft(de.geometry[pe][Ce],F));re.push(fe)}$.push(ye(de.id,Se,re,de.tags))}return $}function Ft(ne,F){var $=[];$.size=ne.size,ne.start!==void 0&&($.start=ne.start,$.end=ne.end);for(var Y=0;Y<ne.length;Y+=3)$.push(ne[Y]+F,ne[Y+1],ne[Y+2]);return $}function Nt(ne,F){if(ne.transformed)return ne;var $,Y,re,de=1<<ne.z,Se=ne.x,pe=ne.y;for($=0;$<ne.features.length;$++){var fe=ne.features[$],Ce=fe.geometry,Xe=fe.type;if(fe.geometry=[],Xe===1)for(Y=0;Y<Ce.length;Y+=2)fe.geometry.push(On(Ce[Y],Ce[Y+1],F,de,Se,pe));else for(Y=0;Y<Ce.length;Y++){var et=[];for(re=0;re<Ce[Y].length;re+=2)et.push(On(Ce[Y][re],Ce[Y][re+1],F,de,Se,pe));fe.geometry.push(et)}}return ne.transformed=!0,ne}function On(ne,F,$,Y,re,de){return[Math.round($*(ne*Y-re)),Math.round($*(F*Y-de))]}function qn(ne,F,$,Y,re){for(var de=F===re.maxZoom?0:re.tolerance/((1<<F)*re.extent),Se={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:$,y:Y,z:F,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},pe=0;pe<ne.length;pe++){Se.numFeatures++,It(Se,ne[pe],de,re);var fe=ne[pe].minX,Ce=ne[pe].minY,Xe=ne[pe].maxX,et=ne[pe].maxY;fe<Se.minX&&(Se.minX=fe),Ce<Se.minY&&(Se.minY=Ce),Xe>Se.maxX&&(Se.maxX=Xe),et>Se.maxY&&(Se.maxY=et)}return Se}function It(ne,F,$,Y){var re=F.geometry,de=F.type,Se=[];if(de==="Point"||de==="MultiPoint")for(var pe=0;pe<re.length;pe+=3)Se.push(re[pe]),Se.push(re[pe+1]),ne.numPoints++,ne.numSimplified++;else if(de==="LineString")Hn(Se,re,ne,$,!1,!1);else if(de==="MultiLineString"||de==="Polygon")for(pe=0;pe<re.length;pe++)Hn(Se,re[pe],ne,$,de==="Polygon",pe===0);else if(de==="MultiPolygon")for(var fe=0;fe<re.length;fe++){var Ce=re[fe];for(pe=0;pe<Ce.length;pe++)Hn(Se,Ce[pe],ne,$,!0,pe===0)}if(Se.length){var Xe=F.tags||null;if(de==="LineString"&&Y.lineMetrics){for(var et in Xe={},F.tags)Xe[et]=F.tags[et];Xe.mapbox_clip_start=re.start/re.size,Xe.mapbox_clip_end=re.end/re.size}var tt={geometry:Se,type:de==="Polygon"||de==="MultiPolygon"?3:de==="LineString"||de==="MultiLineString"?2:1,tags:Xe};F.id!==null&&(tt.id=F.id),ne.features.push(tt)}}function Hn(ne,F,$,Y,re,de){var Se=Y*Y;if(Y>0&&F.size<(re?Se:Y))$.numPoints+=F.length/3;else{for(var pe=[],fe=0;fe<F.length;fe+=3)(Y===0||F[fe+2]>Se)&&($.numSimplified++,pe.push(F[fe]),pe.push(F[fe+1])),$.numPoints++;re&&function(Ce,Xe){for(var et=0,tt=0,Gt=Ce.length,Qt=Gt-2;tt<Gt;Qt=tt,tt+=2)et+=(Ce[tt]-Ce[Qt])*(Ce[tt+1]+Ce[Qt+1]);if(et>0===Xe)for(tt=0,Gt=Ce.length;tt<Gt/2;tt+=2){var Rt=Ce[tt],Ut=Ce[tt+1];Ce[tt]=Ce[Gt-2-tt],Ce[tt+1]=Ce[Gt-1-tt],Ce[Gt-2-tt]=Rt,Ce[Gt-1-tt]=Ut}}(pe,de),ne.push(pe)}}function Tr(ne,F){var $=(F=this.options=function(re,de){for(var Se in de)re[Se]=de[Se];return re}(Object.create(this.options),F)).debug;if($&&console.time("preprocess data"),F.maxZoom<0||F.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(F.promoteId&&F.generateId)throw new Error("promoteId and generateId cannot be used together.");var Y=function(re,de){var Se=[];if(re.type==="FeatureCollection")for(var pe=0;pe<re.features.length;pe++)De(Se,re.features[pe],de,pe);else De(Se,re.type==="Feature"?re:{geometry:re},de);return Se}(ne,F);this.tiles={},this.tileCoords=[],$&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",F.indexMaxZoom,F.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),Y=function(re,de){var Se=de.buffer/de.extent,pe=re,fe=ut(re,1,-1-Se,Se,0,-1,2,de),Ce=ut(re,1,1-Se,2+Se,0,-1,2,de);return(fe||Ce)&&(pe=ut(re,1,-Se,1+Se,0,-1,2,de)||[],fe&&(pe=st(fe,1).concat(pe)),Ce&&(pe=pe.concat(st(Ce,-1)))),pe}(Y,F),Y.length&&this.splitTile(Y,0,0,0),$&&(Y.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function Ys(ne,F,$){return 32*((1<<ne)*$+F)+ne}function jr(ne,F){return F?ne.properties[F]:ne.id}function Xs(ne,F){if(ne==null)return!0;if(ne.type==="Feature")return jr(ne,F)!=null;if(ne.type==="FeatureCollection"){const $=new Set;for(const Y of ne.features){const re=jr(Y,F);if(re==null||$.has(re))return!1;$.add(re)}return!0}return!1}function Ui(ne,F){const $=new Map;if(ne!=null)if(ne.type==="Feature")$.set(jr(ne,F),ne);else for(const Y of ne.features)$.set(jr(Y,F),Y);return $}function Bn(ne,F){const $=ne.tileID.canonical;if(!this._geoJSONIndex)return F(null,null);const Y=this._geoJSONIndex.getTile($.z,$.x,$.y);if(!Y)return F(null,null);const re=new class{constructor(Se){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=l.EXTENT,this.length=Se.length,this._features=Se}feature(Se){return new class{constructor(pe){this._feature=pe,this.extent=l.EXTENT,this.type=pe.type,this.properties=pe.tags,"id"in pe&&!isNaN(pe.id)&&(this.id=parseInt(pe.id,10))}loadGeometry(){if(this._feature.type===1){const pe=[];for(const fe of this._feature.geometry)pe.push([new l.Point(fe[0],fe[1])]);return pe}{const pe=[];for(const fe of this._feature.geometry){const Ce=[];for(const Xe of fe)Ce.push(new l.Point(Xe[0],Xe[1]));pe.push(Ce)}return pe}}toGeoJSON(pe,fe,Ce){return be.call(this,pe,fe,Ce)}}(this._features[Se])}}(Y.features);let de=Ze(re);de.byteOffset===0&&de.byteLength===de.buffer.byteLength||(de=new Uint8Array(de)),F(null,{vectorTile:re,rawData:de.buffer})}Tr.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},Tr.prototype.splitTile=function(ne,F,$,Y,re,de,Se){for(var pe=[ne,F,$,Y],fe=this.options,Ce=fe.debug;pe.length;){Y=pe.pop(),$=pe.pop(),F=pe.pop(),ne=pe.pop();var Xe=1<<F,et=Ys(F,$,Y),tt=this.tiles[et];if(!tt&&(Ce>1&&console.time("creation"),tt=this.tiles[et]=qn(ne,F,$,Y,fe),this.tileCoords.push({z:F,x:$,y:Y}),Ce)){Ce>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",F,$,Y,tt.numFeatures,tt.numPoints,tt.numSimplified),console.timeEnd("creation"));var Gt="z"+F;this.stats[Gt]=(this.stats[Gt]||0)+1,this.total++}if(tt.source=ne,re){if(F===fe.maxZoom||F===re)continue;var Qt=1<<re-F;if($!==Math.floor(de/Qt)||Y!==Math.floor(Se/Qt))continue}else if(F===fe.indexMaxZoom||tt.numPoints<=fe.indexMaxPoints)continue;if(tt.source=null,ne.length!==0){Ce>1&&console.time("clipping");var Rt,Ut,Kt,_n,Dn,on,pn=.5*fe.buffer/fe.extent,dr=.5-pn,Yt=.5+pn,bi=1+pn;Rt=Ut=Kt=_n=null,Dn=ut(ne,Xe,$-pn,$+Yt,0,tt.minX,tt.maxX,fe),on=ut(ne,Xe,$+dr,$+bi,0,tt.minX,tt.maxX,fe),ne=null,Dn&&(Rt=ut(Dn,Xe,Y-pn,Y+Yt,1,tt.minY,tt.maxY,fe),Ut=ut(Dn,Xe,Y+dr,Y+bi,1,tt.minY,tt.maxY,fe),Dn=null),on&&(Kt=ut(on,Xe,Y-pn,Y+Yt,1,tt.minY,tt.maxY,fe),_n=ut(on,Xe,Y+dr,Y+bi,1,tt.minY,tt.maxY,fe),on=null),Ce>1&&console.timeEnd("clipping"),pe.push(Rt||[],F+1,2*$,2*Y),pe.push(Ut||[],F+1,2*$,2*Y+1),pe.push(Kt||[],F+1,2*$+1,2*Y),pe.push(_n||[],F+1,2*$+1,2*Y+1)}}},Tr.prototype.getTile=function(ne,F,$){var Y=this.options,re=Y.extent,de=Y.debug;if(ne<0||ne>24)return null;var Se=1<<ne,pe=Ys(ne,F=(F%Se+Se)%Se,$);if(this.tiles[pe])return Nt(this.tiles[pe],re);de>1&&console.log("drilling down to z%d-%d-%d",ne,F,$);for(var fe,Ce=ne,Xe=F,et=$;!fe&&Ce>0;)Ce--,Xe=Math.floor(Xe/2),et=Math.floor(et/2),fe=this.tiles[Ys(Ce,Xe,et)];return fe&&fe.source?(de>1&&console.log("found parent tile z%d-%d-%d",Ce,Xe,et),de>1&&console.time("drilling down"),this.splitTile(fe.source,Ce,Xe,et,ne,F,$),de>1&&console.timeEnd("drilling down"),this.tiles[pe]?Nt(this.tiles[pe],re):null):null};class Ko extends O{constructor(F,$,Y,re){super(F,$,Y,Bn),this._dataUpdateable=new Map,this.loadGeoJSON=(de,Se)=>{const{promoteId:pe}=de;if(de.request)return l.getJSON(de.request,(fe,Ce,Xe,et)=>{this._dataUpdateable=Xs(Ce,pe)?Ui(Ce,pe):void 0,Se(fe,Ce,Xe,et)});if(typeof de.data=="string")try{const fe=JSON.parse(de.data);this._dataUpdateable=Xs(fe,pe)?Ui(fe,pe):void 0,Se(null,fe)}catch{Se(new Error(`Input data given to '${de.source}' is not a valid GeoJSON object.`))}else de.dataDiff?this._dataUpdateable?(function(fe,Ce,Xe){var et,tt,Gt,Qt;if(Ce.removeAll&&fe.clear(),Ce.remove)for(const Rt of Ce.remove)fe.delete(Rt);if(Ce.add)for(const Rt of Ce.add){const Ut=jr(Rt,Xe);Ut!=null&&fe.set(Ut,Rt)}if(Ce.update)for(const Rt of Ce.update){let Ut=fe.get(Rt.id);if(Ut==null)continue;const Kt=!Rt.removeAllProperties&&(((et=Rt.removeProperties)===null||et===void 0?void 0:et.length)>0||((tt=Rt.addOrUpdateProperties)===null||tt===void 0?void 0:tt.length)>0);if((Rt.newGeometry||Rt.removeAllProperties||Kt)&&(Ut={...Ut},fe.set(Rt.id,Ut),Kt&&(Ut.properties={...Ut.properties})),Rt.newGeometry&&(Ut.geometry=Rt.newGeometry),Rt.removeAllProperties)Ut.properties={};else if(((Gt=Rt.removeProperties)===null||Gt===void 0?void 0:Gt.length)>0)for(const _n of Rt.removeProperties)Object.prototype.hasOwnProperty.call(Ut.properties,_n)&&delete Ut.properties[_n];if(((Qt=Rt.addOrUpdateProperties)===null||Qt===void 0?void 0:Qt.length)>0)for(const{key:_n,value:Dn}of Rt.addOrUpdateProperties)Ut.properties[_n]=Dn}}(this._dataUpdateable,de.dataDiff,pe),Se(null,{type:"FeatureCollection",features:Array.from(this._dataUpdateable.values())})):Se(new Error(`Cannot update existing geojson data in ${de.source}`)):Se(new Error(`Input data given to '${de.source}' is not a valid GeoJSON object.`));return{cancel:()=>{}}},re&&(this.loadGeoJSON=re)}loadData(F,$){var Y;(Y=this._pendingRequest)===null||Y===void 0||Y.cancel(),this._pendingCallback&&this._pendingCallback(null,{abandoned:!0});const re=!!(F&&F.request&&F.request.collectResourceTiming)&&new l.RequestPerformance(F.request);this._pendingCallback=$,this._pendingRequest=this.loadGeoJSON(F,(de,Se)=>{if(delete this._pendingCallback,delete this._pendingRequest,de||!Se)return $(de);if(typeof Se!="object")return $(new Error(`Input data given to '${F.source}' is not a valid GeoJSON object.`));{he(Se,!0);try{if(F.filter){const fe=l.createExpression(F.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(fe.result==="error")throw new Error(fe.value.map(Xe=>`${Xe.key}: ${Xe.message}`).join(", "));Se={type:"FeatureCollection",features:Se.features.filter(Xe=>fe.value.evaluate({zoom:0},Xe))}}this._geoJSONIndex=F.cluster?new He(function({superclusterOptions:fe,clusterProperties:Ce}){if(!Ce||!fe)return fe;const Xe={},et={},tt={accumulated:null,zoom:0},Gt={properties:null},Qt=Object.keys(Ce);for(const Rt of Qt){const[Ut,Kt]=Ce[Rt],_n=l.createExpression(Kt),Dn=l.createExpression(typeof Ut=="string"?[Ut,["accumulated"],["get",Rt]]:Ut);Xe[Rt]=_n.value,et[Rt]=Dn.value}return fe.map=Rt=>{Gt.properties=Rt;const Ut={};for(const Kt of Qt)Ut[Kt]=Xe[Kt].evaluate(tt,Gt);return Ut},fe.reduce=(Rt,Ut)=>{Gt.properties=Ut;for(const Kt of Qt)tt.accumulated=Rt[Kt],Rt[Kt]=et[Kt].evaluate(tt,Gt)},fe}(F)).load(Se.features):function(fe,Ce){return new Tr(fe,Ce)}(Se,F.geojsonVtOptions)}catch(fe){return $(fe)}this.loaded={};const pe={};if(re){const fe=re.finish();fe&&(pe.resourceTiming={},pe.resourceTiming[F.source]=JSON.parse(JSON.stringify(fe)))}$(null,pe)}})}reloadTile(F,$){const Y=this.loaded;return Y&&Y[F.uid]?super.reloadTile(F,$):this.loadTile(F,$)}removeSource(F,$){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),$()}getClusterExpansionZoom(F,$){try{$(null,this._geoJSONIndex.getClusterExpansionZoom(F.clusterId))}catch(Y){$(Y)}}getClusterChildren(F,$){try{$(null,this._geoJSONIndex.getChildren(F.clusterId))}catch(Y){$(Y)}}getClusterLeaves(F,$){try{$(null,this._geoJSONIndex.getLeaves(F.clusterId,F.limit,F.offset))}catch(Y){$(Y)}}}class gs{constructor(F){this.self=F,this.actor=new l.Actor(F,this),this.layerIndexes={},this.availableImages={},this.workerSourceTypes={vector:O,geojson:Ko},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=($,Y)=>{if(this.workerSourceTypes[$])throw new Error(`Worker source with name "${$}" already registered.`);this.workerSourceTypes[$]=Y},this.self.registerRTLTextPlugin=$=>{if(l.plugin.isParsed())throw new Error("RTL text plugin already registered.");l.plugin.applyArabicShaping=$.applyArabicShaping,l.plugin.processBidirectionalText=$.processBidirectionalText,l.plugin.processStyledBidirectionalText=$.processStyledBidirectionalText}}setReferrer(F,$){this.referrer=$}setImages(F,$,Y){this.availableImages[F]=$;for(const re in this.workerSources[F]){const de=this.workerSources[F][re];for(const Se in de)de[Se].availableImages=$}Y()}setLayers(F,$,Y){this.getLayerIndex(F).replace($),Y()}updateLayers(F,$,Y){this.getLayerIndex(F).update($.layers,$.removedIds),Y()}loadTile(F,$,Y){this.getWorkerSource(F,$.type,$.source).loadTile($,Y)}loadDEMTile(F,$,Y){this.getDEMWorkerSource(F,$.source).loadTile($,Y)}reloadTile(F,$,Y){this.getWorkerSource(F,$.type,$.source).reloadTile($,Y)}abortTile(F,$,Y){this.getWorkerSource(F,$.type,$.source).abortTile($,Y)}removeTile(F,$,Y){this.getWorkerSource(F,$.type,$.source).removeTile($,Y)}removeDEMTile(F,$){this.getDEMWorkerSource(F,$.source).removeTile($)}removeSource(F,$,Y){if(!this.workerSources[F]||!this.workerSources[F][$.type]||!this.workerSources[F][$.type][$.source])return;const re=this.workerSources[F][$.type][$.source];delete this.workerSources[F][$.type][$.source],re.removeSource!==void 0?re.removeSource($,Y):Y()}loadWorkerSource(F,$,Y){try{this.self.importScripts($.url),Y()}catch(re){Y(re.toString())}}syncRTLPluginState(F,$,Y){try{l.plugin.setState($);const re=l.plugin.getPluginURL();if(l.plugin.isLoaded()&&!l.plugin.isParsed()&&re!=null){this.self.importScripts(re);const de=l.plugin.isParsed();Y(de?void 0:new Error(`RTL Text Plugin failed to import scripts from ${re}`),de)}}catch(re){Y(re.toString())}}getAvailableImages(F){let $=this.availableImages[F];return $||($=[]),$}getLayerIndex(F){let $=this.layerIndexes[F];return $||($=this.layerIndexes[F]=new b),$}getWorkerSource(F,$,Y){if(this.workerSources[F]||(this.workerSources[F]={}),this.workerSources[F][$]||(this.workerSources[F][$]={}),!this.workerSources[F][$][Y]){const re={send:(de,Se,pe)=>{this.actor.send(de,Se,pe,F)}};this.workerSources[F][$][Y]=new this.workerSourceTypes[$](re,this.getLayerIndex(F),this.getAvailableImages(F))}return this.workerSources[F][$][Y]}getDEMWorkerSource(F,$){return this.demWorkerSources[F]||(this.demWorkerSources[F]={}),this.demWorkerSources[F][$]||(this.demWorkerSources[F][$]=new j),this.demWorkerSources[F][$]}}return l.isWorker()&&(self.worker=new gs(self)),gs}),d(["./shared"],function(l){var b="3.3.0";class w{static testProp(r){if(!w.docStyle)return r[0];for(let u=0;u<r.length;u++)if(r[u]in w.docStyle)return r[u];return r[0]}static create(r,u,f){const g=window.document.createElement(r);return u!==void 0&&(g.className=u),f&&f.appendChild(g),g}static createNS(r,u){return window.document.createElementNS(r,u)}static disableDrag(){w.docStyle&&w.selectProp&&(w.userSelect=w.docStyle[w.selectProp],w.docStyle[w.selectProp]="none")}static enableDrag(){w.docStyle&&w.selectProp&&(w.docStyle[w.selectProp]=w.userSelect)}static setTransform(r,u){r.style[w.transformProp]=u}static addEventListener(r,u,f,g={}){r.addEventListener(u,f,"passive"in g?g:g.capture)}static removeEventListener(r,u,f,g={}){r.removeEventListener(u,f,"passive"in g?g:g.capture)}static suppressClickInternal(r){r.preventDefault(),r.stopPropagation(),window.removeEventListener("click",w.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",w.suppressClickInternal,!0),window.setTimeout(()=>{window.removeEventListener("click",w.suppressClickInternal,!0)},0)}static mousePos(r,u){const f=r.getBoundingClientRect();return new l.Point(u.clientX-f.left-r.clientLeft,u.clientY-f.top-r.clientTop)}static touchPos(r,u){const f=r.getBoundingClientRect(),g=[];for(let v=0;v<u.length;v++)g.push(new l.Point(u[v].clientX-f.left-r.clientLeft,u[v].clientY-f.top-r.clientTop));return g}static mouseButton(r){return r.button}static remove(r){r.parentNode&&r.parentNode.removeChild(r)}}w.docStyle=typeof window<"u"&&window.document&&window.document.documentElement.style,w.selectProp=w.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),w.transformProp=w.testProp(["transform","WebkitTransform"]);const C={supported:!1,testSupport:function(_){!O&&M&&(j?W(_):k=_)}};let k,M,O=!1,j=!1;function W(_){const r=_.createTexture();_.bindTexture(_.TEXTURE_2D,r);try{if(_.texImage2D(_.TEXTURE_2D,0,_.RGBA,_.RGBA,_.UNSIGNED_BYTE,M),_.isContextLost())return;C.supported=!0}catch{}_.deleteTexture(r),O=!0}var le,he;typeof document<"u"&&(M=document.createElement("img"),M.onload=function(){k&&W(k),k=null,j=!0},M.onerror=function(){O=!0,k=null},M.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA="),function(_){let r,u,f,g;_.resetRequestQueue=()=>{r=[],u=0,f=0,g={}},_.addThrottleControl=R=>{const D=f++;return g[D]=R,D},_.removeThrottleControl=R=>{delete g[R],T()},_.getImage=(R,D,z=!0)=>{C.supported&&(R.headers||(R.headers={}),R.headers.accept="image/webp,*/*");const G={requestParameters:R,supportImageRefresh:z,callback:D,cancelled:!1,completed:!1,cancel:()=>{G.completed||G.cancelled||(G.cancelled=!0,G.innerRequest&&(G.innerRequest.cancel(),u--),T())}};return r.push(G),T(),G};const v=R=>{const{requestParameters:D,supportImageRefresh:z,callback:G}=R;return l.extend(D,{type:"image"}),(z!==!1||l.isWorker()||l.getProtocolAction(D.url)||D.headers&&!Object.keys(D.headers).reduce((Q,J)=>Q&&J==="accept",!0)?l.makeRequest:A)(D,(Q,J,te,K)=>{E(R,G,Q,J,te,K)})},E=(R,D,z,G,Q,J)=>{z?D(z):G instanceof HTMLImageElement||l.isImageBitmap(G)?D(null,G):G&&((te,K)=>{typeof createImageBitmap=="function"?l.arrayBufferToImageBitmap(te,K):l.arrayBufferToImage(te,K)})(G,(te,K)=>{te!=null?D(te):K!=null&&D(null,K,{cacheControl:Q,expires:J})}),R.cancelled||(R.completed=!0,u--,T())},T=()=>{const R=(()=>{const D=Object.keys(g);let z=!1;if(D.length>0){for(const G of D)if(z=g[G](),z)break}return z})()?l.config.MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:l.config.MAX_PARALLEL_IMAGE_REQUESTS;for(let D=u;D<R&&r.length>0;D++){const z=r.shift();if(z.cancelled){D--;continue}const G=v(z);u++,z.innerRequest=G}},A=(R,D)=>{const z=new Image,G=R.url;let Q=!1;const J=R.credentials;return J&&J==="include"?z.crossOrigin="use-credentials":(J&&J==="same-origin"||!l.sameOrigin(G))&&(z.crossOrigin="anonymous"),z.fetchPriority="high",z.onload=()=>{D(null,z),z.onerror=z.onload=null},z.onerror=()=>{Q||D(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.")),z.onerror=z.onload=null},z.src=G,{cancel:()=>{Q=!0,z.src=""}}}}(le||(le={})),le.resetRequestQueue(),function(_){_.Glyphs="Glyphs",_.Image="Image",_.Source="Source",_.SpriteImage="SpriteImage",_.SpriteJSON="SpriteJSON",_.Style="Style",_.Tile="Tile",_.Unknown="Unknown"}(he||(he={}));class be{constructor(r){this._transformRequestFn=r}transformRequest(r,u){return this._transformRequestFn&&this._transformRequestFn(r,u)||{url:r}}normalizeSpriteURL(r,u,f){const g=function(v){const E=v.match(ge);if(!E)throw new Error(`Unable to parse URL "${v}"`);return{protocol:E[1],authority:E[2],path:E[3]||"/",params:E[4]?E[4].split("&"):[]}}(r);return g.path+=`${u}${f}`,function(v){const E=v.params.length?`?${v.params.join("&")}`:"";return`${v.protocol}://${v.authority}${v.path}${E}`}(g)}setTransformRequest(r){this._transformRequestFn=r}}const ge=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function Pe(_){var r=new l.ARRAY_TYPE(3);return r[0]=_[0],r[1]=_[1],r[2]=_[2],r}var Ue,Oe=function(_,r,u){return _[0]=r[0]-u[0],_[1]=r[1]-u[1],_[2]=r[2]-u[2],_};Ue=new l.ARRAY_TYPE(3),l.ARRAY_TYPE!=Float32Array&&(Ue[0]=0,Ue[1]=0,Ue[2]=0);var Te=function(_){var r=_[0],u=_[1];return r*r+u*u};function V(_){const r=[];if(typeof _=="string")r.push({id:"default",url:_});else if(_&&_.length>0){const u=[];for(const{id:f,url:g}of _){const v=`${f}${g}`;u.indexOf(v)===-1&&(u.push(v),r.push({id:f,url:g}))}}return r}function Z(_,r,u,f,g){if(f)return void _(f);if(g!==Object.values(r).length||g!==Object.values(u).length)return;const v={};for(const E in r){v[E]={};const T=l.browser.getImageCanvasContext(u[E]),A=r[E];for(const R in A){const{width:D,height:z,x:G,y:Q,sdf:J,pixelRatio:te,stretchX:K,stretchY:ve,content:Me}=A[R];v[E][R]={data:null,pixelRatio:te,sdf:J,stretchX:K,stretchY:ve,content:Me,spriteData:{width:D,height:z,x:G,y:Q,context:T}}}}_(null,v)}(function(){var _=new l.ARRAY_TYPE(2);l.ARRAY_TYPE!=Float32Array&&(_[0]=0,_[1]=0)})();class ae{constructor(r,u,f,g){this.context=r,this.format=f,this.texture=r.gl.createTexture(),this.update(u,g)}update(r,u,f){const{width:g,height:v}=r,E=!(this.size&&this.size[0]===g&&this.size[1]===v||f),{context:T}=this,{gl:A}=T;if(this.useMipmap=!!(u&&u.useMipmap),A.bindTexture(A.TEXTURE_2D,this.texture),T.pixelStoreUnpackFlipY.set(!1),T.pixelStoreUnpack.set(1),T.pixelStoreUnpackPremultiplyAlpha.set(this.format===A.RGBA&&(!u||u.premultiply!==!1)),E)this.size=[g,v],r instanceof HTMLImageElement||r instanceof HTMLCanvasElement||r instanceof HTMLVideoElement||r instanceof ImageData||l.isImageBitmap(r)?A.texImage2D(A.TEXTURE_2D,0,this.format,this.format,A.UNSIGNED_BYTE,r):A.texImage2D(A.TEXTURE_2D,0,this.format,g,v,0,this.format,A.UNSIGNED_BYTE,r.data);else{const{x:R,y:D}=f||{x:0,y:0};r instanceof HTMLImageElement||r instanceof HTMLCanvasElement||r instanceof HTMLVideoElement||r instanceof ImageData||l.isImageBitmap(r)?A.texSubImage2D(A.TEXTURE_2D,0,R,D,A.RGBA,A.UNSIGNED_BYTE,r):A.texSubImage2D(A.TEXTURE_2D,0,R,D,g,v,A.RGBA,A.UNSIGNED_BYTE,r.data)}this.useMipmap&&this.isSizePowerOfTwo()&&A.generateMipmap(A.TEXTURE_2D)}bind(r,u,f){const{context:g}=this,{gl:v}=g;v.bindTexture(v.TEXTURE_2D,this.texture),f!==v.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(f=v.LINEAR),r!==this.filter&&(v.texParameteri(v.TEXTURE_2D,v.TEXTURE_MAG_FILTER,r),v.texParameteri(v.TEXTURE_2D,v.TEXTURE_MIN_FILTER,f||r),this.filter=r),u!==this.wrap&&(v.texParameteri(v.TEXTURE_2D,v.TEXTURE_WRAP_S,u),v.texParameteri(v.TEXTURE_2D,v.TEXTURE_WRAP_T,u),this.wrap=u)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:r}=this.context;r.deleteTexture(this.texture),this.texture=null}}function ke(_){const{userImage:r}=_;return!!(r&&r.render&&r.render())&&(_.data.replace(new Uint8Array(r.data.buffer)),!0)}class _e extends l.Evented{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new l.RGBAImage({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(r){if(this.loaded!==r&&(this.loaded=r,r)){for(const{ids:u,callback:f}of this.requestors)this._notify(u,f);this.requestors=[]}}getImage(r){const u=this.images[r];if(u&&!u.data&&u.spriteData){const f=u.spriteData;u.data=new l.RGBAImage({width:f.width,height:f.height},f.context.getImageData(f.x,f.y,f.width,f.height).data),u.spriteData=null}return u}addImage(r,u){if(this.images[r])throw new Error(`Image id ${r} already exist, use updateImage instead`);this._validate(r,u)&&(this.images[r]=u)}_validate(r,u){let f=!0;const g=u.data||u.spriteData;return this._validateStretch(u.stretchX,g&&g.width)||(this.fire(new l.ErrorEvent(new Error(`Image "${r}" has invalid "stretchX" value`))),f=!1),this._validateStretch(u.stretchY,g&&g.height)||(this.fire(new l.ErrorEvent(new Error(`Image "${r}" has invalid "stretchY" value`))),f=!1),this._validateContent(u.content,u)||(this.fire(new l.ErrorEvent(new Error(`Image "${r}" has invalid "content" value`))),f=!1),f}_validateStretch(r,u){if(!r)return!0;let f=0;for(const g of r){if(g[0]<f||g[1]<g[0]||u<g[1])return!1;f=g[1]}return!0}_validateContent(r,u){if(!r)return!0;if(r.length!==4)return!1;const f=u.spriteData,g=f&&f.width||u.data.width,v=f&&f.height||u.data.height;return!(r[0]<0||g<r[0]||r[1]<0||v<r[1]||r[2]<0||g<r[2]||r[3]<0||v<r[3]||r[2]<r[0]||r[3]<r[1])}updateImage(r,u,f=!0){const g=this.getImage(r);if(f&&(g.data.width!==u.data.width||g.data.height!==u.data.height))throw new Error(`size mismatch between old image (${g.data.width}x${g.data.height}) and new image (${u.data.width}x${u.data.height}).`);u.version=g.version+1,this.images[r]=u,this.updatedImages[r]=!0}removeImage(r){const u=this.images[r];delete this.images[r],delete this.patterns[r],u.userImage&&u.userImage.onRemove&&u.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(r,u){let f=!0;if(!this.isLoaded())for(const g of r)this.images[g]||(f=!1);this.isLoaded()||f?this._notify(r,u):this.requestors.push({ids:r,callback:u})}_notify(r,u){const f={};for(const g of r){let v=this.getImage(g);v||(this.fire(new l.Event("styleimagemissing",{id:g})),v=this.getImage(g)),v?f[g]={data:v.data.clone(),pixelRatio:v.pixelRatio,sdf:v.sdf,version:v.version,stretchX:v.stretchX,stretchY:v.stretchY,content:v.content,hasRenderCallback:!!(v.userImage&&v.userImage.render)}:l.warnOnce(`Image "${g}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}u(null,f)}getPixelSize(){const{width:r,height:u}=this.atlasImage;return{width:r,height:u}}getPattern(r){const u=this.patterns[r],f=this.getImage(r);if(!f)return null;if(u&&u.position.version===f.version)return u.position;if(u)u.position.version=f.version;else{const g={w:f.data.width+2,h:f.data.height+2,x:0,y:0},v=new l.ImagePosition(g,f);this.patterns[r]={bin:g,position:v}}return this._updatePatternAtlas(),this.patterns[r].position}bind(r){const u=r.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new ae(r,this.atlasImage,u.RGBA),this.atlasTexture.bind(u.LINEAR,u.CLAMP_TO_EDGE)}_updatePatternAtlas(){const r=[];for(const v in this.patterns)r.push(this.patterns[v].bin);const{w:u,h:f}=l.potpack(r),g=this.atlasImage;g.resize({width:u||1,height:f||1});for(const v in this.patterns){const{bin:E}=this.patterns[v],T=E.x+1,A=E.y+1,R=this.getImage(v).data,D=R.width,z=R.height;l.RGBAImage.copy(R,g,{x:0,y:0},{x:T,y:A},{width:D,height:z}),l.RGBAImage.copy(R,g,{x:0,y:z-1},{x:T,y:A-1},{width:D,height:1}),l.RGBAImage.copy(R,g,{x:0,y:0},{x:T,y:A+z},{width:D,height:1}),l.RGBAImage.copy(R,g,{x:D-1,y:0},{x:T-1,y:A},{width:1,height:z}),l.RGBAImage.copy(R,g,{x:0,y:0},{x:T+D,y:A},{width:1,height:z})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(r){for(const u of r){if(this.callbackDispatchedThisFrame[u])continue;this.callbackDispatchedThisFrame[u]=!0;const f=this.getImage(u);f||l.warnOnce(`Image with ID: "${u}" was not found`),ke(f)&&this.updateImage(u,f)}}}const oe=1e20;function Re(_,r,u,f,g,v,E,T,A){for(let R=r;R<r+f;R++)nt(_,u*v+R,v,g,E,T,A);for(let R=u;R<u+g;R++)nt(_,R*v+r,1,f,E,T,A)}function nt(_,r,u,f,g,v,E){v[0]=0,E[0]=-oe,E[1]=oe,g[0]=_[r];for(let T=1,A=0,R=0;T<f;T++){g[T]=_[r+T*u];const D=T*T;do{const z=v[A];R=(g[T]-g[z]+D-z*z)/(T-z)/2}while(R<=E[A]&&--A>-1);A++,v[A]=T,E[A]=R,E[A+1]=oe}for(let T=0,A=0;T<f;T++){for(;E[A+1]<T;)A++;const R=v[A],D=T-R;_[r+T*u]=g[R]+D*D}}class Qe{constructor(r,u){this.requestManager=r,this.localIdeographFontFamily=u,this.entries={}}setURL(r){this.url=r}getGlyphs(r,u){const f=[];for(const g in r)for(const v of r[g])f.push({stack:g,id:v});l.asyncAll(f,({stack:g,id:v},E)=>{let T=this.entries[g];T||(T=this.entries[g]={glyphs:{},requests:{},ranges:{}});let A=T.glyphs[v];if(A!==void 0)return void E(null,{stack:g,id:v,glyph:A});if(A=this._tinySDF(T,g,v),A)return T.glyphs[v]=A,void E(null,{stack:g,id:v,glyph:A});const R=Math.floor(v/256);if(256*R>65535)return void E(new Error("glyphs > 65535 not supported"));if(T.ranges[R])return void E(null,{stack:g,id:v,glyph:A});if(!this.url)return void E(new Error("glyphsUrl is not set"));let D=T.requests[R];D||(D=T.requests[R]=[],Qe.loadGlyphRange(g,R,this.url,this.requestManager,(z,G)=>{if(G){for(const Q in G)this._doesCharSupportLocalGlyph(+Q)||(T.glyphs[+Q]=G[+Q]);T.ranges[R]=!0}for(const Q of D)Q(z,G);delete T.requests[R]})),D.push((z,G)=>{z?E(z):G&&E(null,{stack:g,id:v,glyph:G[v]||null})})},(g,v)=>{if(g)u(g);else if(v){const E={};for(const{stack:T,id:A,glyph:R}of v)(E[T]||(E[T]={}))[A]=R&&{id:R.id,bitmap:R.bitmap.clone(),metrics:R.metrics};u(null,E)}})}_doesCharSupportLocalGlyph(r){return!!this.localIdeographFontFamily&&(l.unicodeBlockLookup["CJK Unified Ideographs"](r)||l.unicodeBlockLookup["Hangul Syllables"](r)||l.unicodeBlockLookup.Hiragana(r)||l.unicodeBlockLookup.Katakana(r))}_tinySDF(r,u,f){const g=this.localIdeographFontFamily;if(!g||!this._doesCharSupportLocalGlyph(f))return;let v=r.tinySDF;if(!v){let T="400";/bold/i.test(u)?T="900":/medium/i.test(u)?T="500":/light/i.test(u)&&(T="200"),v=r.tinySDF=new Qe.TinySDF({fontSize:24,buffer:3,radius:8,cutoff:.25,fontFamily:g,fontWeight:T})}const E=v.draw(String.fromCharCode(f));return{id:f,bitmap:new l.AlphaImage({width:E.width||30,height:E.height||30},E.data),metrics:{width:E.glyphWidth||24,height:E.glyphHeight||24,left:E.glyphLeft||0,top:E.glyphTop-27||-8,advance:E.glyphAdvance||24}}}}Qe.loadGlyphRange=function(_,r,u,f,g){const v=256*r,E=v+255,T=f.transformRequest(u.replace("{fontstack}",_).replace("{range}",`${v}-${E}`),he.Glyphs);l.getArrayBuffer(T,(A,R)=>{if(A)g(A);else if(R){const D={};for(const z of l.parseGlyphPbf(R))D[z.id]=z;g(null,D)}})},Qe.TinySDF=class{constructor({fontSize:_=24,buffer:r=3,radius:u=8,cutoff:f=.25,fontFamily:g="sans-serif",fontWeight:v="normal",fontStyle:E="normal"}={}){this.buffer=r,this.cutoff=f,this.radius=u;const T=this.size=_+4*r,A=this._createCanvas(T),R=this.ctx=A.getContext("2d",{willReadFrequently:!0});R.font=`${E} ${v} ${_}px ${g}`,R.textBaseline="alphabetic",R.textAlign="left",R.fillStyle="black",this.gridOuter=new Float64Array(T*T),this.gridInner=new Float64Array(T*T),this.f=new Float64Array(T),this.z=new Float64Array(T+1),this.v=new Uint16Array(T)}_createCanvas(_){const r=document.createElement("canvas");return r.width=r.height=_,r}draw(_){const{width:r,actualBoundingBoxAscent:u,actualBoundingBoxDescent:f,actualBoundingBoxLeft:g,actualBoundingBoxRight:v}=this.ctx.measureText(_),E=Math.ceil(u),T=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(v-g))),A=Math.min(this.size-this.buffer,E+Math.ceil(f)),R=T+2*this.buffer,D=A+2*this.buffer,z=Math.max(R*D,0),G=new Uint8ClampedArray(z),Q={data:G,width:R,height:D,glyphWidth:T,glyphHeight:A,glyphTop:E,glyphLeft:0,glyphAdvance:r};if(T===0||A===0)return Q;const{ctx:J,buffer:te,gridInner:K,gridOuter:ve}=this;J.clearRect(te,te,T,A),J.fillText(_,te,te+E);const Me=J.getImageData(te,te,T,A);ve.fill(oe,0,z),K.fill(0,0,z);for(let se=0;se<A;se++)for(let we=0;we<T;we++){const Ne=Me.data[4*(se*T+we)+3]/255;if(Ne===0)continue;const $e=(se+te)*R+we+te;if(Ne===1)ve[$e]=0,K[$e]=oe;else{const We=.5-Ne;ve[$e]=We>0?We*We:0,K[$e]=We<0?We*We:0}}Re(ve,0,0,R,D,R,this.f,this.v,this.z),Re(K,te,te,T,A,R,this.f,this.v,this.z);for(let se=0;se<z;se++){const we=Math.sqrt(ve[se])-Math.sqrt(K[se]);G[se]=Math.round(255-255*(we/this.radius+this.cutoff))}return Q}};class qe{constructor(){this.specification=l.v8Spec.light.position}possiblyEvaluate(r,u){return l.sphericalToCartesian(r.expression.evaluate(u))}interpolate(r,u,f){return{x:l.interpolate.number(r.x,u.x,f),y:l.interpolate.number(r.y,u.y,f),z:l.interpolate.number(r.z,u.z,f)}}}let je,Ze;class kt extends l.Evented{constructor(r){super(),je=je||new l.Properties({anchor:new l.DataConstantProperty(l.v8Spec.light.anchor),position:new qe,color:new l.DataConstantProperty(l.v8Spec.light.color),intensity:new l.DataConstantProperty(l.v8Spec.light.intensity)}),this._transitionable=new l.Transitionable(je),this.setLight(r),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(r,u={}){if(!this._validate(l.validateLight,r,u))for(const f in r){const g=r[f];f.endsWith("-transition")?this._transitionable.setTransition(f.slice(0,-11),g):this._transitionable.setValue(f,g)}}updateTransitions(r){this._transitioning=this._transitionable.transitioned(r,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(r){this.properties=this._transitioning.possiblyEvaluate(r)}_validate(r,u,f){return(!f||f.validate!==!1)&&l.emitValidationErrors(this,r.call(l.validateStyle,l.extend({value:u,style:{glyphs:!0,sprite:!0},styleSpec:l.v8Spec})))}}class Et{constructor(r,u){this.width=r,this.height=u,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(r,u){const f=r.join(",")+String(u);return this.dashEntry[f]||(this.dashEntry[f]=this.addDash(r,u)),this.dashEntry[f]}getDashRanges(r,u,f){const g=[];let v=r.length%2==1?-r[r.length-1]*f:0,E=r[0]*f,T=!0;g.push({left:v,right:E,isDash:T,zeroLength:r[0]===0});let A=r[0];for(let R=1;R<r.length;R++){T=!T;const D=r[R];v=A*f,A+=D,E=A*f,g.push({left:v,right:E,isDash:T,zeroLength:D===0})}return g}addRoundDash(r,u,f){const g=u/2;for(let v=-f;v<=f;v++){const E=this.width*(this.nextRow+f+v);let T=0,A=r[T];for(let R=0;R<this.width;R++){R/A.right>1&&(A=r[++T]);const D=Math.abs(R-A.left),z=Math.abs(R-A.right),G=Math.min(D,z);let Q;const J=v/f*(g+1);if(A.isDash){const te=g-Math.abs(J);Q=Math.sqrt(G*G+te*te)}else Q=g-Math.sqrt(G*G+J*J);this.data[E+R]=Math.max(0,Math.min(255,Q+128))}}}addRegularDash(r){for(let T=r.length-1;T>=0;--T){const A=r[T],R=r[T+1];A.zeroLength?r.splice(T,1):R&&R.isDash===A.isDash&&(R.left=A.left,r.splice(T,1))}const u=r[0],f=r[r.length-1];u.isDash===f.isDash&&(u.left=f.left-this.width,f.right=u.right+this.width);const g=this.width*this.nextRow;let v=0,E=r[v];for(let T=0;T<this.width;T++){T/E.right>1&&(E=r[++v]);const A=Math.abs(T-E.left),R=Math.abs(T-E.right),D=Math.min(A,R);this.data[g+T]=Math.max(0,Math.min(255,(E.isDash?D:-D)+128))}}addDash(r,u){const f=u?7:0,g=2*f+1;if(this.nextRow+g>this.height)return l.warnOnce("LineAtlas out of space"),null;let v=0;for(let T=0;T<r.length;T++)v+=r[T];if(v!==0){const T=this.width/v,A=this.getDashRanges(r,this.width,T);u?this.addRoundDash(A,T,f):this.addRegularDash(A)}const E={y:(this.nextRow+f+.5)/this.height,height:2*f/this.height,width:v};return this.nextRow+=g,this.dirty=!0,E}bind(r){const u=r.gl;this.texture?(u.bindTexture(u.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,u.texSubImage2D(u.TEXTURE_2D,0,0,0,this.width,this.height,u.ALPHA,u.UNSIGNED_BYTE,this.data))):(this.texture=u.createTexture(),u.bindTexture(u.TEXTURE_2D,this.texture),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_WRAP_S,u.REPEAT),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_WRAP_T,u.REPEAT),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_MIN_FILTER,u.LINEAR),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_MAG_FILTER,u.LINEAR),u.texImage2D(u.TEXTURE_2D,0,u.ALPHA,this.width,this.height,0,u.ALPHA,u.UNSIGNED_BYTE,this.data))}}class rt{constructor(r,u,f){this.workerPool=r,this.actors=[],this.currentActor=0,this.id=f;const g=this.workerPool.acquire(f);for(let v=0;v<g.length;v++){const E=new rt.Actor(g[v],u,f);E.name=`Worker ${v}`,this.actors.push(E)}if(!this.actors.length)throw new Error("No actors found")}broadcast(r,u,f){l.asyncAll(this.actors,(g,v)=>{g.send(r,u,v)},f=f||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(r=!0){this.actors.forEach(u=>{u.remove()}),this.actors=[],r&&this.workerPool.release(this.id)}}function At(_,r,u){const f=function(g,v){if(g)return u(g);if(v){const E=l.pick(l.extend(v,_),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);v.vector_layers&&(E.vectorLayers=v.vector_layers,E.vectorLayerIds=E.vectorLayers.map(T=>T.id)),u(null,E)}};return _.url?l.getJSON(r.transformRequest(_.url,he.Source),f):l.browser.frame(()=>f(null,_))}rt.Actor=l.Actor;class Pt{constructor(r,u){r&&(u?this.setSouthWest(r).setNorthEast(u):Array.isArray(r)&&(r.length===4?this.setSouthWest([r[0],r[1]]).setNorthEast([r[2],r[3]]):this.setSouthWest(r[0]).setNorthEast(r[1])))}setNorthEast(r){return this._ne=r instanceof l.LngLat?new l.LngLat(r.lng,r.lat):l.LngLat.convert(r),this}setSouthWest(r){return this._sw=r instanceof l.LngLat?new l.LngLat(r.lng,r.lat):l.LngLat.convert(r),this}extend(r){const u=this._sw,f=this._ne;let g,v;if(r instanceof l.LngLat)g=r,v=r;else{if(!(r instanceof Pt))return Array.isArray(r)?r.length===4||r.every(Array.isArray)?this.extend(Pt.convert(r)):this.extend(l.LngLat.convert(r)):r&&("lng"in r||"lon"in r)&&"lat"in r?this.extend(l.LngLat.convert(r)):this;if(g=r._sw,v=r._ne,!g||!v)return this}return u||f?(u.lng=Math.min(g.lng,u.lng),u.lat=Math.min(g.lat,u.lat),f.lng=Math.max(v.lng,f.lng),f.lat=Math.max(v.lat,f.lat)):(this._sw=new l.LngLat(g.lng,g.lat),this._ne=new l.LngLat(v.lng,v.lat)),this}getCenter(){return new l.LngLat((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new l.LngLat(this.getWest(),this.getNorth())}getSouthEast(){return new l.LngLat(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(r){const{lng:u,lat:f}=l.LngLat.convert(r);let g=this._sw.lng<=u&&u<=this._ne.lng;return this._sw.lng>this._ne.lng&&(g=this._sw.lng>=u&&u>=this._ne.lng),this._sw.lat<=f&&f<=this._ne.lat&&g}static convert(r){return r instanceof Pt?r:r&&new Pt(r)}static fromLngLat(r,u=0){const f=360*u/40075017,g=f/Math.cos(Math.PI/180*r.lat);return new Pt(new l.LngLat(r.lng-g,r.lat-f),new l.LngLat(r.lng+g,r.lat+f))}}class Wt{constructor(r,u,f){this.bounds=Pt.convert(this.validateBounds(r)),this.minzoom=u||0,this.maxzoom=f||24}validateBounds(r){return Array.isArray(r)&&r.length===4?[Math.max(-180,r[0]),Math.max(-90,r[1]),Math.min(180,r[2]),Math.min(90,r[3])]:[-180,-90,180,90]}contains(r){const u=Math.pow(2,r.z),f=Math.floor(l.mercatorXfromLng(this.bounds.getWest())*u),g=Math.floor(l.mercatorYfromLat(this.bounds.getNorth())*u),v=Math.ceil(l.mercatorXfromLng(this.bounds.getEast())*u),E=Math.ceil(l.mercatorYfromLat(this.bounds.getSouth())*u);return r.x>=f&&r.x<v&&r.y>=g&&r.y<E}}class He extends l.Evented{constructor(r,u,f,g){if(super(),this.load=()=>{this._loaded=!1,this.fire(new l.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=At(this._options,this.map._requestManager,(v,E)=>{this._tileJSONRequest=null,this._loaded=!0,this.map.style.sourceCaches[this.id].clearTiles(),v?this.fire(new l.ErrorEvent(v)):E&&(l.extend(this,E),E.bounds&&(this.tileBounds=new Wt(E.bounds,this.minzoom,this.maxzoom)),this.fire(new l.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new l.Event("data",{dataType:"source",sourceDataType:"content"})))})},this.serialize=()=>l.extend({},this._options),this.id=r,this.dispatcher=f,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,l.extend(this,l.pick(u,["url","scheme","tileSize","promoteId"])),this._options=l.extend({type:"vector"},u),this._collectResourceTiming=u.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(g)}loaded(){return this._loaded}hasTile(r){return!this.tileBounds||this.tileBounds.contains(r.canonical)}onAdd(r){this.map=r,this.load()}setSourceProperty(r){this._tileJSONRequest&&this._tileJSONRequest.cancel(),r(),this.load()}setTiles(r){return this.setSourceProperty(()=>{this._options.tiles=r}),this}setUrl(r){return this.setSourceProperty(()=>{this.url=r,this._options.url=r}),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}loadTile(r,u){const f=r.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),g={request:this.map._requestManager.transformRequest(f,he.Tile),uid:r.uid,tileID:r.tileID,zoom:r.tileID.overscaledZ,tileSize:this.tileSize*r.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};function v(E,T){return delete r.request,r.aborted?u(null):E&&E.status!==404?u(E):(T&&T.resourceTiming&&(r.resourceTiming=T.resourceTiming),this.map._refreshExpiredTiles&&T&&r.setExpiryData(T),r.loadVectorData(T,this.map.painter),u(null),void(r.reloadCallback&&(this.loadTile(r,r.reloadCallback),r.reloadCallback=null)))}g.request.collectResourceTiming=this._collectResourceTiming,r.actor&&r.state!=="expired"?r.state==="loading"?r.reloadCallback=u:r.request=r.actor.send("reloadTile",g,v.bind(this)):(r.actor=this.dispatcher.getActor(),r.request=r.actor.send("loadTile",g,v.bind(this)))}abortTile(r){r.request&&(r.request.cancel(),delete r.request),r.actor&&r.actor.send("abortTile",{uid:r.uid,type:this.type,source:this.id},void 0)}unloadTile(r){r.unloadVectorData(),r.actor&&r.actor.send("removeTile",{uid:r.uid,type:this.type,source:this.id},void 0)}hasTransition(){return!1}}class xe extends l.Evented{constructor(r,u,f,g){super(),this.id=r,this.dispatcher=f,this.setEventedParent(g),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=l.extend({type:"raster"},u),l.extend(this,l.pick(u,["url","scheme","tileSize"]))}load(){this._loaded=!1,this.fire(new l.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=At(this._options,this.map._requestManager,(r,u)=>{this._tileJSONRequest=null,this._loaded=!0,r?this.fire(new l.ErrorEvent(r)):u&&(l.extend(this,u),u.bounds&&(this.tileBounds=new Wt(u.bounds,this.minzoom,this.maxzoom)),this.fire(new l.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new l.Event("data",{dataType:"source",sourceDataType:"content"})))})}loaded(){return this._loaded}onAdd(r){this.map=r,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}serialize(){return l.extend({},this._options)}hasTile(r){return!this.tileBounds||this.tileBounds.contains(r.canonical)}loadTile(r,u){const f=r.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);r.request=le.getImage(this.map._requestManager.transformRequest(f,he.Tile),(g,v,E)=>{if(delete r.request,r.aborted)r.state="unloaded",u(null);else if(g)r.state="errored",u(g);else if(v){this.map._refreshExpiredTiles&&E&&r.setExpiryData(E);const T=this.map.painter.context,A=T.gl;r.texture=this.map.painter.getTileTexture(v.width),r.texture?r.texture.update(v,{useMipmap:!0}):(r.texture=new ae(T,v,A.RGBA,{useMipmap:!0}),r.texture.bind(A.LINEAR,A.CLAMP_TO_EDGE,A.LINEAR_MIPMAP_NEAREST),T.extTextureFilterAnisotropic&&A.texParameterf(A.TEXTURE_2D,T.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,T.extTextureFilterAnisotropicMax)),r.state="loaded",u(null)}},this.map._refreshExpiredTiles)}abortTile(r,u){r.request&&(r.request.cancel(),delete r.request),u()}unloadTile(r,u){r.texture&&this.map.painter.saveTileTexture(r.texture),u()}hasTransition(){return!1}}class Ke extends xe{constructor(r,u,f,g){super(r,u,f,g),this.type="raster-dem",this.maxzoom=22,this._options=l.extend({type:"raster-dem"},u),this.encoding=u.encoding||"mapbox"}loadTile(r,u){const f=r.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);function g(v,E){v&&(r.state="errored",u(v)),E&&(r.dem=E,r.needsHillshadePrepare=!0,r.needsTerrainPrepare=!0,r.state="loaded",u(null))}r.request=le.getImage(this.map._requestManager.transformRequest(f,he.Tile),function(v,E){if(delete r.request,r.aborted)r.state="unloaded",u(null);else if(v)r.state="errored",u(v);else if(E){this.map._refreshExpiredTiles&&r.setExpiryData(E),delete E.cacheControl,delete E.expires;const T=l.isImageBitmap(E)&&(Ze==null&&(Ze=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&typeof createImageBitmap=="function"),Ze)?E:l.browser.getImageData(E,1),A={uid:r.uid,coord:r.tileID,source:this.id,rawImageData:T,encoding:this.encoding};r.actor&&r.state!=="expired"||(r.actor=this.dispatcher.getActor(),r.actor.send("loadDEMTile",A,g.bind(this)))}}.bind(this),this.map._refreshExpiredTiles),r.neighboringTiles=this._getNeighboringTiles(r.tileID)}_getNeighboringTiles(r){const u=r.canonical,f=Math.pow(2,u.z),g=(u.x-1+f)%f,v=u.x===0?r.wrap-1:r.wrap,E=(u.x+1+f)%f,T=u.x+1===f?r.wrap+1:r.wrap,A={};return A[new l.OverscaledTileID(r.overscaledZ,v,u.z,g,u.y).key]={backfilled:!1},A[new l.OverscaledTileID(r.overscaledZ,T,u.z,E,u.y).key]={backfilled:!1},u.y>0&&(A[new l.OverscaledTileID(r.overscaledZ,v,u.z,g,u.y-1).key]={backfilled:!1},A[new l.OverscaledTileID(r.overscaledZ,r.wrap,u.z,u.x,u.y-1).key]={backfilled:!1},A[new l.OverscaledTileID(r.overscaledZ,T,u.z,E,u.y-1).key]={backfilled:!1}),u.y+1<f&&(A[new l.OverscaledTileID(r.overscaledZ,v,u.z,g,u.y+1).key]={backfilled:!1},A[new l.OverscaledTileID(r.overscaledZ,r.wrap,u.z,u.x,u.y+1).key]={backfilled:!1},A[new l.OverscaledTileID(r.overscaledZ,T,u.z,E,u.y+1).key]={backfilled:!1}),A}unloadTile(r){r.demTexture&&this.map.painter.saveTileTexture(r.demTexture),r.fbo&&(r.fbo.destroy(),delete r.fbo),r.dem&&delete r.dem,delete r.neighboringTiles,r.state="unloaded",r.actor&&r.actor.send("removeDEMTile",{uid:r.uid,source:this.id})}}class Fe extends l.Evented{constructor(r,u,f,g){super(),this.load=()=>{this._updateWorkerData()},this.serialize=()=>l.extend({},this._options,{type:this.type,data:this._data}),this.id=r,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._pendingLoads=0,this.actor=f.getActor(),this.setEventedParent(g),this._data=u.data,this._options=l.extend({},u),this._collectResourceTiming=u.collectResourceTiming,u.maxzoom!==void 0&&(this.maxzoom=u.maxzoom),u.type&&(this.type=u.type),u.attribution&&(this.attribution=u.attribution),this.promoteId=u.promoteId;const v=l.EXTENT/this.tileSize;this.workerOptions=l.extend({source:this.id,cluster:u.cluster||!1,geojsonVtOptions:{buffer:(u.buffer!==void 0?u.buffer:128)*v,tolerance:(u.tolerance!==void 0?u.tolerance:.375)*v,extent:l.EXTENT,maxZoom:this.maxzoom,lineMetrics:u.lineMetrics||!1,generateId:u.generateId||!1},superclusterOptions:{maxZoom:u.clusterMaxZoom!==void 0?u.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,u.clusterMinPoints||2),extent:l.EXTENT,radius:(u.clusterRadius||50)*v,log:!1,generateId:u.generateId||!1},clusterProperties:u.clusterProperties,filter:u.filter},u.workerOptions),typeof this.promoteId=="string"&&(this.workerOptions.promoteId=this.promoteId)}onAdd(r){this.map=r,this.load()}setData(r){return this._data=r,this._updateWorkerData(),this}updateData(r){return this._updateWorkerData(r),this}setClusterOptions(r){return this.workerOptions.cluster=r.cluster,r&&(r.clusterRadius!==void 0&&(this.workerOptions.superclusterOptions.radius=r.clusterRadius),r.clusterMaxZoom!==void 0&&(this.workerOptions.superclusterOptions.maxZoom=r.clusterMaxZoom)),this._updateWorkerData(),this}getClusterExpansionZoom(r,u){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:r,source:this.id},u),this}getClusterChildren(r,u){return this.actor.send("geojson.getClusterChildren",{clusterId:r,source:this.id},u),this}getClusterLeaves(r,u,f,g){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:r,limit:u,offset:f},g),this}_updateWorkerData(r){const u=l.extend({},this.workerOptions);r?u.dataDiff=r:typeof this._data=="string"?(u.request=this.map._requestManager.transformRequest(l.browser.resolveURL(this._data),he.Source),u.request.collectResourceTiming=this._collectResourceTiming):u.data=JSON.stringify(this._data),this._pendingLoads++,this.fire(new l.Event("dataloading",{dataType:"source"})),this.actor.send(`${this.type}.loadData`,u,(f,g)=>{if(this._pendingLoads--,this._removed||g&&g.abandoned)return void this.fire(new l.Event("dataabort",{dataType:"source"}));let v=null;if(g&&g.resourceTiming&&g.resourceTiming[this.id]&&(v=g.resourceTiming[this.id].slice(0)),f)return void this.fire(new l.ErrorEvent(f));const E={dataType:"source"};this._collectResourceTiming&&v&&v.length>0&&l.extend(E,{resourceTiming:v}),this.fire(new l.Event("data",{...E,sourceDataType:"metadata"})),this.fire(new l.Event("data",{...E,sourceDataType:"content"}))})}loaded(){return this._pendingLoads===0}loadTile(r,u){const f=r.actor?"reloadTile":"loadTile";r.actor=this.actor;const g={type:this.type,uid:r.uid,tileID:r.tileID,zoom:r.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};r.request=this.actor.send(f,g,(v,E)=>(delete r.request,r.unloadVectorData(),r.aborted?u(null):v?u(v):(r.loadVectorData(E,this.map.painter,f==="reloadTile"),u(null))))}abortTile(r){r.request&&(r.request.cancel(),delete r.request),r.aborted=!0}unloadTile(r){r.unloadVectorData(),this.actor.send("removeTile",{uid:r.uid,type:this.type,source:this.id})}onRemove(){this._removed=!0,this.actor.send("removeSource",{type:this.type,source:this.id})}hasTransition(){return!1}}var Ge=l.createLayout([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class ft extends l.Evented{constructor(r,u,f,g){super(),this.load=(v,E)=>{this._loaded=!1,this.fire(new l.Event("dataloading",{dataType:"source"})),this.url=this.options.url,this._request=le.getImage(this.map._requestManager.transformRequest(this.url,he.Image),(T,A)=>{this._request=null,this._loaded=!0,T?this.fire(new l.ErrorEvent(T)):A&&(this.image=A,v&&(this.coordinates=v),E&&E(),this._finishLoading())})},this.prepare=()=>{if(Object.keys(this.tiles).length===0||!this.image)return;const v=this.map.painter.context,E=v.gl;this.boundsBuffer||(this.boundsBuffer=v.createVertexBuffer(this._boundsArray,Ge.members)),this.boundsSegments||(this.boundsSegments=l.SegmentVector.simpleSegment(0,0,4,2)),this.texture||(this.texture=new ae(v,this.image,E.RGBA),this.texture.bind(E.LINEAR,E.CLAMP_TO_EDGE));let T=!1;for(const A in this.tiles){const R=this.tiles[A];R.state!=="loaded"&&(R.state="loaded",R.texture=this.texture,T=!0)}T&&this.fire(new l.Event("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))},this.serialize=()=>({type:"image",url:this.options.url,coordinates:this.coordinates}),this.id=r,this.dispatcher=f,this.coordinates=u.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(g),this.options=u}loaded(){return this._loaded}updateImage(r){return r.url?(this._request&&(this._request.cancel(),this._request=null),this.options.url=r.url,this.load(r.coordinates,()=>{this.texture=null}),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new l.Event("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(r){this.map=r,this.load()}onRemove(){this._request&&(this._request.cancel(),this._request=null)}setCoordinates(r){this.coordinates=r;const u=r.map(l.MercatorCoordinate.fromLngLat);this.tileID=function(g){let v=1/0,E=1/0,T=-1/0,A=-1/0;for(const G of g)v=Math.min(v,G.x),E=Math.min(E,G.y),T=Math.max(T,G.x),A=Math.max(A,G.y);const R=Math.max(T-v,A-E),D=Math.max(0,Math.floor(-Math.log(R)/Math.LN2)),z=Math.pow(2,D);return new l.CanonicalTileID(D,Math.floor((v+T)/2*z),Math.floor((E+A)/2*z))}(u),this.minzoom=this.maxzoom=this.tileID.z;const f=u.map(g=>this.tileID.getTilePoint(g)._round());return this._boundsArray=new l.RasterBoundsArray,this._boundsArray.emplaceBack(f[0].x,f[0].y,0,0),this._boundsArray.emplaceBack(f[1].x,f[1].y,l.EXTENT,0),this._boundsArray.emplaceBack(f[3].x,f[3].y,0,l.EXTENT),this._boundsArray.emplaceBack(f[2].x,f[2].y,l.EXTENT,l.EXTENT),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new l.Event("data",{dataType:"source",sourceDataType:"content"})),this}loadTile(r,u){this.tileID&&this.tileID.equals(r.tileID.canonical)?(this.tiles[String(r.tileID.wrap)]=r,r.buckets={},u(null)):(r.state="errored",u(null))}hasTransition(){return!1}}class X extends ft{constructor(r,u,f,g){super(r,u,f,g),this.load=()=>{this._loaded=!1;const v=this.options;this.urls=[];for(const E of v.urls)this.urls.push(this.map._requestManager.transformRequest(E,he.Source).url);l.getVideo(this.urls,(E,T)=>{this._loaded=!0,E?this.fire(new l.ErrorEvent(E)):T&&(this.video=T,this.video.loop=!0,this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})},this.prepare=()=>{if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const v=this.map.painter.context,E=v.gl;this.boundsBuffer||(this.boundsBuffer=v.createVertexBuffer(this._boundsArray,Ge.members)),this.boundsSegments||(this.boundsSegments=l.SegmentVector.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(E.LINEAR,E.CLAMP_TO_EDGE),E.texSubImage2D(E.TEXTURE_2D,0,0,0,E.RGBA,E.UNSIGNED_BYTE,this.video)):(this.texture=new ae(v,this.video,E.RGBA),this.texture.bind(E.LINEAR,E.CLAMP_TO_EDGE));let T=!1;for(const A in this.tiles){const R=this.tiles[A];R.state!=="loaded"&&(R.state="loaded",R.texture=this.texture,T=!0)}T&&this.fire(new l.Event("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))},this.serialize=()=>({type:"video",urls:this.urls,coordinates:this.coordinates}),this.roundZoom=!0,this.type="video",this.options=u}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(r){if(this.video){const u=this.video.seekable;r<u.start(0)||r>u.end(0)?this.fire(new l.ErrorEvent(new l.ValidationError(`sources.${this.id}`,null,`Playback for this video can be set only between the ${u.start(0)} and ${u.end(0)}-second mark.`))):this.video.currentTime=r}}getVideo(){return this.video}onAdd(r){this.map||(this.map=r,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}hasTransition(){return this.video&&!this.video.paused}}class U extends ft{constructor(r,u,f,g){super(r,u,f,g),this.load=()=>{this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new l.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())},this.prepare=()=>{let v=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,v=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,v=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const E=this.map.painter.context,T=E.gl;this.boundsBuffer||(this.boundsBuffer=E.createVertexBuffer(this._boundsArray,Ge.members)),this.boundsSegments||(this.boundsSegments=l.SegmentVector.simpleSegment(0,0,4,2)),this.texture?(v||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new ae(E,this.canvas,T.RGBA,{premultiply:!0});let A=!1;for(const R in this.tiles){const D=this.tiles[R];D.state!=="loaded"&&(D.state="loaded",D.texture=this.texture,A=!0)}A&&this.fire(new l.Event("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))},this.serialize=()=>({type:"canvas",coordinates:this.coordinates}),u.coordinates?Array.isArray(u.coordinates)&&u.coordinates.length===4&&!u.coordinates.some(v=>!Array.isArray(v)||v.length!==2||v.some(E=>typeof E!="number"))||this.fire(new l.ErrorEvent(new l.ValidationError(`sources.${r}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new l.ErrorEvent(new l.ValidationError(`sources.${r}`,null,'missing required property "coordinates"'))),u.animate&&typeof u.animate!="boolean"&&this.fire(new l.ErrorEvent(new l.ValidationError(`sources.${r}`,null,'optional "animate" property must be a boolean value'))),u.canvas?typeof u.canvas=="string"||u.canvas instanceof HTMLCanvasElement||this.fire(new l.ErrorEvent(new l.ValidationError(`sources.${r}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new l.ErrorEvent(new l.ValidationError(`sources.${r}`,null,'missing required property "canvas"'))),this.options=u,this.animate=u.animate===void 0||u.animate}getCanvas(){return this.canvas}onAdd(r){this.map=r,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const r of[this.canvas.width,this.canvas.height])if(isNaN(r)||r<=0)return!0;return!1}}const ye={},Le=_=>{switch(_){case"geojson":return Fe;case"image":return ft;case"raster":return xe;case"raster-dem":return Ke;case"vector":return He;case"video":return X;case"canvas":return U}return ye[_]};function De(_,r){const u=l.create();return l.translate(u,u,[1,1,0]),l.scale(u,u,[.5*_.width,.5*_.height,1]),l.multiply(u,u,_.calculatePosMatrix(r.toUnwrapped()))}function Ve(_,r,u,f,g,v){const E=function(z,G,Q){if(z)for(const J of z){const te=G[J];if(te&&te.source===Q&&te.type==="fill-extrusion")return!0}else for(const J in G){const te=G[J];if(te.source===Q&&te.type==="fill-extrusion")return!0}return!1}(g&&g.layers,r,_.id),T=v.maxPitchScaleFactor(),A=_.tilesIn(f,T,E);A.sort(ht);const R=[];for(const z of A)R.push({wrappedTileID:z.tileID.wrapped().key,queryResults:z.tile.queryRenderedFeatures(r,u,_._state,z.queryGeometry,z.cameraQueryGeometry,z.scale,g,v,T,De(_.transform,z.tileID))});const D=function(z){const G={},Q={};for(const J of z){const te=J.queryResults,K=J.wrappedTileID,ve=Q[K]=Q[K]||{};for(const Me in te){const se=te[Me],we=ve[Me]=ve[Me]||{},Ne=G[Me]=G[Me]||[];for(const $e of se)we[$e.featureIndex]||(we[$e.featureIndex]=!0,Ne.push($e))}}return G}(R);for(const z in D)D[z].forEach(G=>{const Q=G.feature,J=_.getFeatureState(Q.layer["source-layer"],Q.id);Q.source=Q.layer.source,Q.layer["source-layer"]&&(Q.sourceLayer=Q.layer["source-layer"]),Q.state=J});return D}function ht(_,r){const u=_.tileID,f=r.tileID;return u.overscaledZ-f.overscaledZ||u.canonical.y-f.canonical.y||u.wrap-f.wrap||u.canonical.x-f.canonical.x}class ct{constructor(r,u){this.timeAdded=0,this.fadeEndTime=0,this.tileID=r,this.uid=l.uniqueId(),this.uses=0,this.tileSize=u,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.rtt=[],this.rttCoords={},this.expiredRequestCount=0,this.state="loading"}registerFadeDuration(r){const u=r+this.timeAdded;u<this.fadeEndTime||(this.fadeEndTime=u)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}clearTextures(r){this.demTexture&&r.saveTileTexture(this.demTexture),this.demTexture=null}loadVectorData(r,u,f){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",r){r.featureIndex&&(this.latestFeatureIndex=r.featureIndex,r.rawTileData?(this.latestRawTileData=r.rawTileData,this.latestFeatureIndex.rawTileData=r.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=r.collisionBoxArray,this.buckets=function(g,v){const E={};if(!v)return E;for(const T of g){const A=T.layerIds.map(R=>v.getLayer(R)).filter(Boolean);if(A.length!==0){T.layers=A,T.stateDependentLayerIds&&(T.stateDependentLayers=T.stateDependentLayerIds.map(R=>A.filter(D=>D.id===R)[0]));for(const R of A)E[R.id]=T}}return E}(r.buckets,u.style),this.hasSymbolBuckets=!1;for(const g in this.buckets){const v=this.buckets[g];if(v instanceof l.SymbolBucket){if(this.hasSymbolBuckets=!0,!f)break;v.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const g in this.buckets){const v=this.buckets[g];if(v instanceof l.SymbolBucket&&v.hasRTLText){this.hasRTLText=!0,l.lazyLoadRTLTextPlugin();break}}this.queryPadding=0;for(const g in this.buckets){const v=this.buckets[g];this.queryPadding=Math.max(this.queryPadding,u.style.getLayer(g).queryRadius(v))}r.imageAtlas&&(this.imageAtlas=r.imageAtlas),r.glyphAtlasImage&&(this.glyphAtlasImage=r.glyphAtlasImage)}else this.collisionBoxArray=new l.CollisionBoxArray}unloadVectorData(){for(const r in this.buckets)this.buckets[r].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(r){return this.buckets[r.id]}upload(r){for(const f in this.buckets){const g=this.buckets[f];g.uploadPending()&&g.upload(r)}const u=r.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new ae(r,this.imageAtlas.image,u.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new ae(r,this.glyphAtlasImage,u.ALPHA),this.glyphAtlasImage=null)}prepare(r){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(r,this.imageAtlasTexture)}queryRenderedFeatures(r,u,f,g,v,E,T,A,R,D){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:g,cameraQueryGeometry:v,scale:E,tileSize:this.tileSize,pixelPosMatrix:D,transform:A,params:T,queryPadding:this.queryPadding*R},r,u,f):{}}querySourceFeatures(r,u){const f=this.latestFeatureIndex;if(!f||!f.rawTileData)return;const g=f.loadVTLayers(),v=u&&u.sourceLayer?u.sourceLayer:"",E=g._geojsonTileLayer||g[v];if(!E)return;const T=l.createFilter(u&&u.filter),{z:A,x:R,y:D}=this.tileID.canonical,z={z:A,x:R,y:D};for(let G=0;G<E.length;G++){const Q=E.feature(G);if(T.needGeometry){const K=l.toEvaluationFeature(Q,!0);if(!T.filter(new l.EvaluationParameters(this.tileID.overscaledZ),K,this.tileID.canonical))continue}else if(!T.filter(new l.EvaluationParameters(this.tileID.overscaledZ),Q))continue;const J=f.getId(Q,v),te=new l.GeoJSONFeature(Q,A,R,D,J);te.tile=z,r.push(te)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(r){const u=this.expirationTime;if(r.cacheControl){const f=l.parseCacheControl(r.cacheControl);f["max-age"]&&(this.expirationTime=Date.now()+1e3*f["max-age"])}else r.expires&&(this.expirationTime=new Date(r.expires).getTime());if(this.expirationTime){const f=Date.now();let g=!1;if(this.expirationTime>f)g=!1;else if(u)if(this.expirationTime<u)g=!0;else{const v=this.expirationTime-u;v?this.expirationTime=f+Math.max(v,3e4):g=!0}else g=!0;g?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(r,u){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(r).length===0)return;const f=this.latestFeatureIndex.loadVTLayers();for(const g in this.buckets){if(!u.style.hasLayer(g))continue;const v=this.buckets[g],E=v.layers[0].sourceLayer||"_geojsonTileLayer",T=f[E],A=r[E];if(!T||!A||Object.keys(A).length===0)continue;v.update(A,T,this.imageAtlas&&this.imageAtlas.patternPositions||{});const R=u&&u.style&&u.style.getLayer(g);R&&(this.queryPadding=Math.max(this.queryPadding,R.queryRadius(v)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<l.browser.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(r){this.symbolFadeHoldUntil=l.browser.now()+r}setDependencies(r,u){const f={};for(const g of u)f[g]=!0;this.dependencies[r]=f}hasDependency(r,u){for(const f of r){const g=this.dependencies[f];if(g){for(const v of u)if(g[v])return!0}}return!1}}class pt{constructor(r,u){this.max=r,this.onRemove=u,this.reset()}reset(){for(const r in this.data)for(const u of this.data[r])u.timeout&&clearTimeout(u.timeout),this.onRemove(u.value);return this.data={},this.order=[],this}add(r,u,f){const g=r.wrapped().key;this.data[g]===void 0&&(this.data[g]=[]);const v={value:u,timeout:void 0};if(f!==void 0&&(v.timeout=setTimeout(()=>{this.remove(r,v)},f)),this.data[g].push(v),this.order.push(g),this.order.length>this.max){const E=this._getAndRemoveByKey(this.order[0]);E&&this.onRemove(E)}return this}has(r){return r.wrapped().key in this.data}getAndRemove(r){return this.has(r)?this._getAndRemoveByKey(r.wrapped().key):null}_getAndRemoveByKey(r){const u=this.data[r].shift();return u.timeout&&clearTimeout(u.timeout),this.data[r].length===0&&delete this.data[r],this.order.splice(this.order.indexOf(r),1),u.value}getByKey(r){const u=this.data[r];return u?u[0].value:null}get(r){return this.has(r)?this.data[r.wrapped().key][0].value:null}remove(r,u){if(!this.has(r))return this;const f=r.wrapped().key,g=u===void 0?0:this.data[f].indexOf(u),v=this.data[f][g];return this.data[f].splice(g,1),v.timeout&&clearTimeout(v.timeout),this.data[f].length===0&&delete this.data[f],this.onRemove(v.value),this.order.splice(this.order.indexOf(f),1),this}setMaxSize(r){for(this.max=r;this.order.length>this.max;){const u=this._getAndRemoveByKey(this.order[0]);u&&this.onRemove(u)}return this}filter(r){const u=[];for(const f in this.data)for(const g of this.data[f])r(g.value)||u.push(g);for(const f of u)this.remove(f.value.tileID,f)}}class it{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(r,u,f){const g=String(u);if(this.stateChanges[r]=this.stateChanges[r]||{},this.stateChanges[r][g]=this.stateChanges[r][g]||{},l.extend(this.stateChanges[r][g],f),this.deletedStates[r]===null){this.deletedStates[r]={};for(const v in this.state[r])v!==g&&(this.deletedStates[r][v]=null)}else if(this.deletedStates[r]&&this.deletedStates[r][g]===null){this.deletedStates[r][g]={};for(const v in this.state[r][g])f[v]||(this.deletedStates[r][g][v]=null)}else for(const v in f)this.deletedStates[r]&&this.deletedStates[r][g]&&this.deletedStates[r][g][v]===null&&delete this.deletedStates[r][g][v]}removeFeatureState(r,u,f){if(this.deletedStates[r]===null)return;const g=String(u);if(this.deletedStates[r]=this.deletedStates[r]||{},f&&u!==void 0)this.deletedStates[r][g]!==null&&(this.deletedStates[r][g]=this.deletedStates[r][g]||{},this.deletedStates[r][g][f]=null);else if(u!==void 0)if(this.stateChanges[r]&&this.stateChanges[r][g])for(f in this.deletedStates[r][g]={},this.stateChanges[r][g])this.deletedStates[r][g][f]=null;else this.deletedStates[r][g]=null;else this.deletedStates[r]=null}getState(r,u){const f=String(u),g=l.extend({},(this.state[r]||{})[f],(this.stateChanges[r]||{})[f]);if(this.deletedStates[r]===null)return{};if(this.deletedStates[r]){const v=this.deletedStates[r][u];if(v===null)return{};for(const E in v)delete g[E]}return g}initializeTileState(r,u){r.setFeatureState(this.state,u)}coalesceChanges(r,u){const f={};for(const g in this.stateChanges){this.state[g]=this.state[g]||{};const v={};for(const E in this.stateChanges[g])this.state[g][E]||(this.state[g][E]={}),l.extend(this.state[g][E],this.stateChanges[g][E]),v[E]=this.state[g][E];f[g]=v}for(const g in this.deletedStates){this.state[g]=this.state[g]||{};const v={};if(this.deletedStates[g]===null)for(const E in this.state[g])v[E]={},this.state[g][E]={};else for(const E in this.deletedStates[g]){if(this.deletedStates[g][E]===null)this.state[g][E]={};else for(const T of Object.keys(this.deletedStates[g][E]))delete this.state[g][E][T];v[E]=this.state[g][E]}f[g]=f[g]||{},l.extend(f[g],v)}if(this.stateChanges={},this.deletedStates={},Object.keys(f).length!==0)for(const g in r)r[g].setFeatureState(f,u)}}class ut extends l.Evented{constructor(r,u,f){super(),this.id=r,this.dispatcher=f,this.on("data",g=>{g.dataType==="source"&&g.sourceDataType==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&g.dataType==="source"&&g.sourceDataType==="content"&&(this.reload(),this.transform&&this.update(this.transform,this.terrain),this._didEmitContent=!0)}),this.on("dataloading",()=>{this._sourceErrored=!1}),this.on("error",()=>{this._sourceErrored=this._source.loaded()}),this._source=((g,v,E,T)=>{const A=new(Le(v.type))(g,v,E,T);if(A.id!==g)throw new Error(`Expected Source id to be ${g} instead of ${A.id}`);return A})(r,u,f,this),this._tiles={},this._cache=new pt(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._maxTileCacheZoomLevels=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new it,this._didEmitContent=!1,this._updated=!1}onAdd(r){this.map=r,this._maxTileCacheSize=r?r._maxTileCacheSize:null,this._maxTileCacheZoomLevels=r?r._maxTileCacheZoomLevels:null,this._source&&this._source.onAdd&&this._source.onAdd(r)}onRemove(r){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(r)}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;if(!(this.used===void 0&&this.usedForTerrain===void 0||this.used||this.usedForTerrain))return!0;if(!this._updated)return!1;for(const r in this._tiles){const u=this._tiles[r];if(u.state!=="loaded"&&u.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const r=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,r&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(r,u){return this._source.loadTile(r,u)}_unloadTile(r){if(this._source.unloadTile)return this._source.unloadTile(r,()=>{})}_abortTile(r){this._source.abortTile&&this._source.abortTile(r,()=>{}),this._source.fire(new l.Event("dataabort",{tile:r,coord:r.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(r){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const u in this._tiles){const f=this._tiles[u];f.upload(r),f.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map(r=>r.tileID).sort(yt).map(r=>r.key)}getRenderableIds(r){const u=[];for(const f in this._tiles)this._isIdRenderable(f,r)&&u.push(this._tiles[f]);return r?u.sort((f,g)=>{const v=f.tileID,E=g.tileID,T=new l.Point(v.canonical.x,v.canonical.y)._rotate(this.transform.angle),A=new l.Point(E.canonical.x,E.canonical.y)._rotate(this.transform.angle);return v.overscaledZ-E.overscaledZ||A.y-T.y||A.x-T.x}).map(f=>f.tileID.key):u.map(f=>f.tileID).sort(yt).map(f=>f.key)}hasRenderableParent(r){const u=this.findLoadedParent(r,0);return!!u&&this._isIdRenderable(u.tileID.key)}_isIdRenderable(r,u){return this._tiles[r]&&this._tiles[r].hasData()&&!this._coveredTiles[r]&&(u||!this._tiles[r].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const r in this._tiles)this._tiles[r].state!=="errored"&&this._reloadTile(r,"reloading")}}_reloadTile(r,u){const f=this._tiles[r];f&&(f.state!=="loading"&&(f.state=u),this._loadTile(f,this._tileLoaded.bind(this,f,r,u)))}_tileLoaded(r,u,f,g){if(g)return r.state="errored",void(g.status!==404?this._source.fire(new l.ErrorEvent(g,{tile:r})):this.update(this.transform,this.terrain));r.timeAdded=l.browser.now(),f==="expired"&&(r.refreshedUponExpiration=!0),this._setTileReloadTimer(u,r),this.getSource().type==="raster-dem"&&r.dem&&this._backfillDEM(r),this._state.initializeTileState(r,this.map?this.map.painter:null),r.aborted||this._source.fire(new l.Event("data",{dataType:"source",tile:r,coord:r.tileID}))}_backfillDEM(r){const u=this.getRenderableIds();for(let g=0;g<u.length;g++){const v=u[g];if(r.neighboringTiles&&r.neighboringTiles[v]){const E=this.getTileByID(v);f(r,E),f(E,r)}}function f(g,v){g.needsHillshadePrepare=!0,g.needsTerrainPrepare=!0;let E=v.tileID.canonical.x-g.tileID.canonical.x;const T=v.tileID.canonical.y-g.tileID.canonical.y,A=Math.pow(2,g.tileID.canonical.z),R=v.tileID.key;E===0&&T===0||Math.abs(T)>1||(Math.abs(E)>1&&(Math.abs(E+A)===1?E+=A:Math.abs(E-A)===1&&(E-=A)),v.dem&&g.dem&&(g.dem.backfillBorder(v.dem,E,T),g.neighboringTiles&&g.neighboringTiles[R]&&(g.neighboringTiles[R].backfilled=!0)))}}getTile(r){return this.getTileByID(r.key)}getTileByID(r){return this._tiles[r]}_retainLoadedChildren(r,u,f,g){for(const v in this._tiles){let E=this._tiles[v];if(g[v]||!E.hasData()||E.tileID.overscaledZ<=u||E.tileID.overscaledZ>f)continue;let T=E.tileID;for(;E&&E.tileID.overscaledZ>u+1;){const R=E.tileID.scaledTo(E.tileID.overscaledZ-1);E=this._tiles[R.key],E&&E.hasData()&&(T=R)}let A=T;for(;A.overscaledZ>u;)if(A=A.scaledTo(A.overscaledZ-1),r[A.key]){g[T.key]=T;break}}}findLoadedParent(r,u){if(r.key in this._loadedParentTiles){const f=this._loadedParentTiles[r.key];return f&&f.tileID.overscaledZ>=u?f:null}for(let f=r.overscaledZ-1;f>=u;f--){const g=r.scaledTo(f),v=this._getLoadedTile(g);if(v)return v}}_getLoadedTile(r){const u=this._tiles[r.key];return u&&u.hasData()?u:this._cache.getByKey(r.wrapped().key)}updateCacheSize(r){const u=Math.ceil(r.width/this._source.tileSize)+1,f=Math.ceil(r.height/this._source.tileSize)+1,g=Math.floor(u*f*(this._maxTileCacheZoomLevels===null?l.config.MAX_TILE_CACHE_ZOOM_LEVELS:this._maxTileCacheZoomLevels)),v=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,g):g;this._cache.setMaxSize(v)}handleWrapJump(r){const u=Math.round((r-(this._prevLng===void 0?r:this._prevLng))/360);if(this._prevLng=r,u){const f={};for(const g in this._tiles){const v=this._tiles[g];v.tileID=v.tileID.unwrapTo(v.tileID.wrap+u),f[v.tileID.key]=v}this._tiles=f;for(const g in this._timers)clearTimeout(this._timers[g]),delete this._timers[g];for(const g in this._tiles)this._setTileReloadTimer(g,this._tiles[g])}}update(r,u){if(this.transform=r,this.terrain=u,!this._sourceLoaded||this._paused)return;let f;this.updateCacheSize(r),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?f=r.getVisibleUnwrappedCoordinates(this._source.tileID).map(D=>new l.OverscaledTileID(D.canonical.z,D.wrap,D.canonical.z,D.canonical.x,D.canonical.y)):(f=r.coveringTiles({tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:u}),this._source.hasTile&&(f=f.filter(D=>this._source.hasTile(D)))):f=[];const g=r.coveringZoomLevel(this._source),v=Math.max(g-ut.maxOverzooming,this._source.minzoom),E=Math.max(g+ut.maxUnderzooming,this._source.minzoom);if(this.usedForTerrain){const D={};for(const z of f)if(z.canonical.z>this._source.minzoom){const G=z.scaledTo(z.canonical.z-1);D[G.key]=G;const Q=z.scaledTo(Math.max(this._source.minzoom,Math.min(z.canonical.z,5)));D[Q.key]=Q}f=f.concat(Object.values(D))}const T=f.length===0&&!this._updated&&this._didEmitContent;this._updated=!0,T&&this.fire(new l.Event("data",{sourceDataType:"idle",dataType:"source",sourceId:this.id}));const A=this._updateRetainedTiles(f,g);if(Lt(this._source.type)){const D={},z={},G=Object.keys(A),Q=l.browser.now();for(const J of G){const te=A[J],K=this._tiles[J];if(!K||K.fadeEndTime!==0&&K.fadeEndTime<=Q)continue;const ve=this.findLoadedParent(te,v);ve&&(this._addTile(ve.tileID),D[ve.tileID.key]=ve.tileID),z[J]=te}this._retainLoadedChildren(z,g,E,A);for(const J in D)A[J]||(this._coveredTiles[J]=!0,A[J]=D[J]);if(u){const J={},te={};for(const K of f)this._tiles[K.key].hasData()?J[K.key]=K:te[K.key]=K;for(const K in te){const ve=te[K].children(this._source.maxzoom);this._tiles[ve[0].key]&&this._tiles[ve[1].key]&&this._tiles[ve[2].key]&&this._tiles[ve[3].key]&&(J[ve[0].key]=A[ve[0].key]=ve[0],J[ve[1].key]=A[ve[1].key]=ve[1],J[ve[2].key]=A[ve[2].key]=ve[2],J[ve[3].key]=A[ve[3].key]=ve[3],delete te[K])}for(const K in te){const ve=this.findLoadedParent(te[K],this._source.minzoom);if(ve){J[ve.tileID.key]=A[ve.tileID.key]=ve.tileID;for(const Me in J)J[Me].isChildOf(ve.tileID)&&delete J[Me]}}for(const K in this._tiles)J[K]||(this._coveredTiles[K]=!0)}}for(const D in A)this._tiles[D].clearFadeHold();const R=l.keysDifference(this._tiles,A);for(const D of R){const z=this._tiles[D];z.hasSymbolBuckets&&!z.holdingForFade()?z.setHoldDuration(this.map._fadeDuration):z.hasSymbolBuckets&&!z.symbolFadeFinished()||this._removeTile(D)}this._updateLoadedParentTileCache()}releaseSymbolFadeTiles(){for(const r in this._tiles)this._tiles[r].holdingForFade()&&this._removeTile(r)}_updateRetainedTiles(r,u){const f={},g={},v=Math.max(u-ut.maxOverzooming,this._source.minzoom),E=Math.max(u+ut.maxUnderzooming,this._source.minzoom),T={};for(const A of r){const R=this._addTile(A);f[A.key]=A,R.hasData()||u<this._source.maxzoom&&(T[A.key]=A)}this._retainLoadedChildren(T,u,E,f);for(const A of r){let R=this._tiles[A.key];if(R.hasData())continue;if(u+1>this._source.maxzoom){const z=A.children(this._source.maxzoom)[0],G=this.getTile(z);if(G&&G.hasData()){f[z.key]=z;continue}}else{const z=A.children(this._source.maxzoom);if(f[z[0].key]&&f[z[1].key]&&f[z[2].key]&&f[z[3].key])continue}let D=R.wasRequested();for(let z=A.overscaledZ-1;z>=v;--z){const G=A.scaledTo(z);if(g[G.key])break;if(g[G.key]=!0,R=this.getTile(G),!R&&D&&(R=this._addTile(G)),R){const Q=R.hasData();if((D||Q)&&(f[G.key]=G),D=R.wasRequested(),Q)break}}}return f}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const r in this._tiles){const u=[];let f,g=this._tiles[r].tileID;for(;g.overscaledZ>0;){if(g.key in this._loadedParentTiles){f=this._loadedParentTiles[g.key];break}u.push(g.key);const v=g.scaledTo(g.overscaledZ-1);if(f=this._getLoadedTile(v),f)break;g=v}for(const v of u)this._loadedParentTiles[v]=f}}_addTile(r){let u=this._tiles[r.key];if(u)return u;u=this._cache.getAndRemove(r),u&&(this._setTileReloadTimer(r.key,u),u.tileID=r,this._state.initializeTileState(u,this.map?this.map.painter:null),this._cacheTimers[r.key]&&(clearTimeout(this._cacheTimers[r.key]),delete this._cacheTimers[r.key],this._setTileReloadTimer(r.key,u)));const f=u;return u||(u=new ct(r,this._source.tileSize*r.overscaleFactor()),this._loadTile(u,this._tileLoaded.bind(this,u,r.key,u.state))),u.uses++,this._tiles[r.key]=u,f||this._source.fire(new l.Event("dataloading",{tile:u,coord:u.tileID,dataType:"source"})),u}_setTileReloadTimer(r,u){r in this._timers&&(clearTimeout(this._timers[r]),delete this._timers[r]);const f=u.getExpiryTimeout();f&&(this._timers[r]=setTimeout(()=>{this._reloadTile(r,"expired"),delete this._timers[r]},f))}_removeTile(r){const u=this._tiles[r];u&&(u.uses--,delete this._tiles[r],this._timers[r]&&(clearTimeout(this._timers[r]),delete this._timers[r]),u.uses>0||(u.hasData()&&u.state!=="reloading"?this._cache.add(u.tileID,u,u.getExpiryTimeout()):(u.aborted=!0,this._abortTile(u),this._unloadTile(u))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const r in this._tiles)this._removeTile(r);this._cache.reset()}tilesIn(r,u,f){const g=[],v=this.transform;if(!v)return g;const E=f?v.getCameraQueryGeometry(r):r,T=r.map(J=>v.pointCoordinate(J,this.terrain)),A=E.map(J=>v.pointCoordinate(J,this.terrain)),R=this.getIds();let D=1/0,z=1/0,G=-1/0,Q=-1/0;for(const J of A)D=Math.min(D,J.x),z=Math.min(z,J.y),G=Math.max(G,J.x),Q=Math.max(Q,J.y);for(let J=0;J<R.length;J++){const te=this._tiles[R[J]];if(te.holdingForFade())continue;const K=te.tileID,ve=Math.pow(2,v.zoom-te.tileID.overscaledZ),Me=u*te.queryPadding*l.EXTENT/te.tileSize/ve,se=[K.getTilePoint(new l.MercatorCoordinate(D,z)),K.getTilePoint(new l.MercatorCoordinate(G,Q))];if(se[0].x-Me<l.EXTENT&&se[0].y-Me<l.EXTENT&&se[1].x+Me>=0&&se[1].y+Me>=0){const we=T.map($e=>K.getTilePoint($e)),Ne=A.map($e=>K.getTilePoint($e));g.push({tile:te,tileID:K,queryGeometry:we,cameraQueryGeometry:Ne,scale:ve})}}return g}getVisibleCoordinates(r){const u=this.getRenderableIds(r).map(f=>this._tiles[f].tileID);for(const f of u)f.posMatrix=this.transform.calculatePosMatrix(f.toUnwrapped());return u}hasTransition(){if(this._source.hasTransition())return!0;if(Lt(this._source.type)){const r=l.browser.now();for(const u in this._tiles)if(this._tiles[u].fadeEndTime>=r)return!0}return!1}setFeatureState(r,u,f){this._state.updateState(r=r||"_geojsonTileLayer",u,f)}removeFeatureState(r,u,f){this._state.removeFeatureState(r=r||"_geojsonTileLayer",u,f)}getFeatureState(r,u){return this._state.getState(r=r||"_geojsonTileLayer",u)}setDependencies(r,u,f){const g=this._tiles[r];g&&g.setDependencies(u,f)}reloadTilesForDependencies(r,u){for(const f in this._tiles)this._tiles[f].hasDependency(r,u)&&this._reloadTile(f,"reloading");this._cache.filter(f=>!f.hasDependency(r,u))}}function yt(_,r){const u=Math.abs(2*_.wrap)-+(_.wrap<0),f=Math.abs(2*r.wrap)-+(r.wrap<0);return _.overscaledZ-r.overscaledZ||f-u||r.canonical.y-_.canonical.y||r.canonical.x-_.canonical.x}function Lt(_){return _==="raster"||_==="image"||_==="video"}ut.maxOverzooming=10,ut.maxUnderzooming=3;const Be="mapboxgl_preloaded_worker_pool";class jt{constructor(){this.active={}}acquire(r){if(!this.workers)for(this.workers=[];this.workers.length<jt.workerCount;)this.workers.push(new Worker(l.config.WORKER_URL));return this.active[r]=!0,this.workers.slice()}release(r){delete this.active[r],this.numActive()===0&&(this.workers.forEach(u=>{u.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[Be]}numActive(){return Object.keys(this.active).length}}const Xt=Math.floor(l.browser.hardwareConcurrency/2);let tn;function fn(){return tn||(tn=new jt),tn}jt.workerCount=l.isSafari(globalThis)?Math.max(Math.min(Xt,3),1):1;class st{constructor(r,u){this.reset(r,u)}reset(r,u){this.points=r||[],this._distances=[0];for(let f=1;f<this.points.length;f++)this._distances[f]=this._distances[f-1]+this.points[f].dist(this.points[f-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(u||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(r){if(this.points.length===1)return this.points[0];r=l.clamp(r,0,1);let u=1,f=this._distances[u];const g=r*this.paddedLength+this.padding;for(;f<g&&u<this._distances.length;)f=this._distances[++u];const v=u-1,E=this._distances[v],T=f-E,A=T>0?(g-E)/T:0;return this.points[v].mult(1-A).add(this.points[u].mult(A))}}function Ft(_,r){let u=!0;return _==="always"||_!=="never"&&r!=="never"||(u=!1),u}class Nt{constructor(r,u,f){const g=this.boxCells=[],v=this.circleCells=[];this.xCellCount=Math.ceil(r/f),this.yCellCount=Math.ceil(u/f);for(let E=0;E<this.xCellCount*this.yCellCount;E++)g.push([]),v.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=r,this.height=u,this.xScale=this.xCellCount/r,this.yScale=this.yCellCount/u,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(r,u,f,g,v){this._forEachCell(u,f,g,v,this._insertBoxCell,this.boxUid++),this.boxKeys.push(r),this.bboxes.push(u),this.bboxes.push(f),this.bboxes.push(g),this.bboxes.push(v)}insertCircle(r,u,f,g){this._forEachCell(u-g,f-g,u+g,f+g,this._insertCircleCell,this.circleUid++),this.circleKeys.push(r),this.circles.push(u),this.circles.push(f),this.circles.push(g)}_insertBoxCell(r,u,f,g,v,E){this.boxCells[v].push(E)}_insertCircleCell(r,u,f,g,v,E){this.circleCells[v].push(E)}_query(r,u,f,g,v,E,T){if(f<0||r>this.width||g<0||u>this.height)return[];const A=[];if(r<=0&&u<=0&&this.width<=f&&this.height<=g){if(v)return[{key:null,x1:r,y1:u,x2:f,y2:g}];for(let R=0;R<this.boxKeys.length;R++)A.push({key:this.boxKeys[R],x1:this.bboxes[4*R],y1:this.bboxes[4*R+1],x2:this.bboxes[4*R+2],y2:this.bboxes[4*R+3]});for(let R=0;R<this.circleKeys.length;R++){const D=this.circles[3*R],z=this.circles[3*R+1],G=this.circles[3*R+2];A.push({key:this.circleKeys[R],x1:D-G,y1:z-G,x2:D+G,y2:z+G})}}else this._forEachCell(r,u,f,g,this._queryCell,A,{hitTest:v,overlapMode:E,seenUids:{box:{},circle:{}}},T);return A}query(r,u,f,g){return this._query(r,u,f,g,!1,null)}hitTest(r,u,f,g,v,E){return this._query(r,u,f,g,!0,v,E).length>0}hitTestCircle(r,u,f,g,v){const E=r-f,T=r+f,A=u-f,R=u+f;if(T<0||E>this.width||R<0||A>this.height)return!1;const D=[];return this._forEachCell(E,A,T,R,this._queryCellCircle,D,{hitTest:!0,overlapMode:g,circle:{x:r,y:u,radius:f},seenUids:{box:{},circle:{}}},v),D.length>0}_queryCell(r,u,f,g,v,E,T,A){const{seenUids:R,hitTest:D,overlapMode:z}=T,G=this.boxCells[v];if(G!==null){const J=this.bboxes;for(const te of G)if(!R.box[te]){R.box[te]=!0;const K=4*te,ve=this.boxKeys[te];if(r<=J[K+2]&&u<=J[K+3]&&f>=J[K+0]&&g>=J[K+1]&&(!A||A(ve))&&(!D||!Ft(z,ve.overlapMode))&&(E.push({key:ve,x1:J[K],y1:J[K+1],x2:J[K+2],y2:J[K+3]}),D))return!0}}const Q=this.circleCells[v];if(Q!==null){const J=this.circles;for(const te of Q)if(!R.circle[te]){R.circle[te]=!0;const K=3*te,ve=this.circleKeys[te];if(this._circleAndRectCollide(J[K],J[K+1],J[K+2],r,u,f,g)&&(!A||A(ve))&&(!D||!Ft(z,ve.overlapMode))){const Me=J[K],se=J[K+1],we=J[K+2];if(E.push({key:ve,x1:Me-we,y1:se-we,x2:Me+we,y2:se+we}),D)return!0}}}return!1}_queryCellCircle(r,u,f,g,v,E,T,A){const{circle:R,seenUids:D,overlapMode:z}=T,G=this.boxCells[v];if(G!==null){const J=this.bboxes;for(const te of G)if(!D.box[te]){D.box[te]=!0;const K=4*te,ve=this.boxKeys[te];if(this._circleAndRectCollide(R.x,R.y,R.radius,J[K+0],J[K+1],J[K+2],J[K+3])&&(!A||A(ve))&&!Ft(z,ve.overlapMode))return E.push(!0),!0}}const Q=this.circleCells[v];if(Q!==null){const J=this.circles;for(const te of Q)if(!D.circle[te]){D.circle[te]=!0;const K=3*te,ve=this.circleKeys[te];if(this._circlesCollide(J[K],J[K+1],J[K+2],R.x,R.y,R.radius)&&(!A||A(ve))&&!Ft(z,ve.overlapMode))return E.push(!0),!0}}}_forEachCell(r,u,f,g,v,E,T,A){const R=this._convertToXCellCoord(r),D=this._convertToYCellCoord(u),z=this._convertToXCellCoord(f),G=this._convertToYCellCoord(g);for(let Q=R;Q<=z;Q++)for(let J=D;J<=G;J++)if(v.call(this,r,u,f,g,this.xCellCount*J+Q,E,T,A))return}_convertToXCellCoord(r){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(r*this.xScale)))}_convertToYCellCoord(r){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(r*this.yScale)))}_circlesCollide(r,u,f,g,v,E){const T=g-r,A=v-u,R=f+E;return R*R>T*T+A*A}_circleAndRectCollide(r,u,f,g,v,E,T){const A=(E-g)/2,R=Math.abs(r-(g+A));if(R>A+f)return!1;const D=(T-v)/2,z=Math.abs(u-(v+D));if(z>D+f)return!1;if(R<=A||z<=D)return!0;const G=R-A,Q=z-D;return G*G+Q*Q<=f*f}}function On(_,r,u,f,g){const v=l.create();return r?(l.scale(v,v,[1/g,1/g,1]),u||l.rotateZ(v,v,f.angle)):l.multiply(v,f.labelPlaneMatrix,_),v}function qn(_,r,u,f,g){if(r){const v=l.clone(_);return l.scale(v,v,[g,g,1]),u||l.rotateZ(v,v,-f.angle),v}return f.glCoordMatrix}function It(_,r,u){let f;u?(f=[_.x,_.y,u(_.x,_.y),1],l.transformMat4(f,f,r)):(f=[_.x,_.y,0,1],re(f,f,r));const g=f[3];return{point:new l.Point(f[0]/g,f[1]/g),signedDistanceFromCamera:g}}function Hn(_,r){return .5+_/r*.5}function Tr(_,r){const u=_[0]/_[3],f=_[1]/_[3];return u>=-r[0]&&u<=r[0]&&f>=-r[1]&&f<=r[1]}function Ys(_,r,u,f,g,v,E,T,A,R){const D=f?_.textSizeData:_.iconSizeData,z=l.evaluateSizeForZoom(D,u.transform.zoom),G=[256/u.width*2+1,256/u.height*2+1],Q=f?_.text.dynamicLayoutVertexArray:_.icon.dynamicLayoutVertexArray;Q.clear();const J=_.lineVertexArray,te=f?_.text.placedSymbolArray:_.icon.placedSymbolArray,K=u.transform.width/u.transform.height;let ve=!1;for(let Me=0;Me<te.length;Me++){const se=te.get(Me);if(se.hidden||se.writingMode===l.WritingMode.vertical&&!ve){Y(se.numGlyphs,Q);continue}let we;if(ve=!1,R?(we=[se.anchorX,se.anchorY,R(se.anchorX,se.anchorY),1],l.transformMat4(we,we,r)):(we=[se.anchorX,se.anchorY,0,1],re(we,we,r)),!Tr(we,G)){Y(se.numGlyphs,Q);continue}const Ne=Hn(u.transform.cameraToCenterDistance,we[3]),$e=l.evaluateSizeForFeature(D,z,se),We=E?$e/Ne:$e*Ne,ot=new l.Point(se.anchorX,se.anchorY),Je=It(ot,g,R).point,dt={projections:{},offsets:{}},Mt=Ui(se,We,!1,T,r,g,v,_.glyphOffsetArray,J,Q,Je,ot,dt,K,A,R);ve=Mt.useVertical,(Mt.notEnoughRoom||ve||Mt.needsFlipping&&Ui(se,We,!0,T,r,g,v,_.glyphOffsetArray,J,Q,Je,ot,dt,K,A,R).notEnoughRoom)&&Y(se.numGlyphs,Q)}f?_.text.dynamicLayoutVertexBuffer.updateData(Q):_.icon.dynamicLayoutVertexBuffer.updateData(Q)}function jr(_,r,u,f,g,v,E,T,A,R,D,z,G){const Q=T.glyphStartIndex+T.numGlyphs,J=T.lineStartIndex,te=T.lineStartIndex+T.lineLength,K=r.getoffsetX(T.glyphStartIndex),ve=r.getoffsetX(Q-1),Me=F(_*K,u,f,g,v,E,T.segment,J,te,A,R,D,z,G);if(!Me)return null;const se=F(_*ve,u,f,g,v,E,T.segment,J,te,A,R,D,z,G);return se?{first:Me,last:se}:null}function Xs(_,r,u,f){return _===l.WritingMode.horizontal&&Math.abs(u.y-r.y)>Math.abs(u.x-r.x)*f?{useVertical:!0}:(_===l.WritingMode.vertical?r.y<u.y:r.x>u.x)?{needsFlipping:!0}:null}function Ui(_,r,u,f,g,v,E,T,A,R,D,z,G,Q,J,te){const K=r/24,ve=_.lineOffsetX*K,Me=_.lineOffsetY*K;let se;if(_.numGlyphs>1){const we=_.glyphStartIndex+_.numGlyphs,Ne=_.lineStartIndex,$e=_.lineStartIndex+_.lineLength,We=jr(K,T,ve,Me,u,D,z,_,A,v,G,J,te);if(!We)return{notEnoughRoom:!0};const ot=It(We.first.point,E,te).point,Je=It(We.last.point,E,te).point;if(f&&!u){const dt=Xs(_.writingMode,ot,Je,Q);if(dt)return dt}se=[We.first];for(let dt=_.glyphStartIndex+1;dt<we-1;dt++)se.push(F(K*T.getoffsetX(dt),ve,Me,u,D,z,_.segment,Ne,$e,A,v,G,J,te));se.push(We.last)}else{if(f&&!u){const Ne=It(z,g,te).point,$e=_.lineStartIndex+_.segment+1,We=new l.Point(A.getx($e),A.gety($e)),ot=It(We,g,te),Je=ot.signedDistanceFromCamera>0?ot.point:Bn(z,We,Ne,1,g,te),dt=Xs(_.writingMode,Ne,Je,Q);if(dt)return dt}const we=F(K*T.getoffsetX(_.glyphStartIndex),ve,Me,u,D,z,_.segment,_.lineStartIndex,_.lineStartIndex+_.lineLength,A,v,G,J,te);if(!we)return{notEnoughRoom:!0};se=[we]}for(const we of se)l.addDynamicAttributes(R,we.point,we.angle);return{}}function Bn(_,r,u,f,g,v){const E=It(_.add(_.sub(r)._unit()),g,v).point,T=u.sub(E);return u.add(T._mult(f/T.mag()))}function Ko(_,r){const{projectionCache:u,lineVertexArray:f,labelPlaneMatrix:g,tileAnchorPoint:v,distanceFromAnchor:E,getElevation:T,previousVertex:A,direction:R,absOffsetX:D}=r;if(u.projections[_])return u.projections[_];const z=new l.Point(f.getx(_),f.gety(_)),G=It(z,g,T);if(G.signedDistanceFromCamera>0)return u.projections[_]=G.point,G.point;const Q=_-R;return Bn(E===0?v:new l.Point(f.getx(Q),f.gety(Q)),z,A,D-E+1,g,T)}function gs(_,r,u){return _._unit()._perp()._mult(r*u)}function ne(_,r,u,f,g,v,E,T){const{projectionCache:A,direction:R}=T;if(A.offsets[_])return A.offsets[_];const D=u.add(r);if(_+R<f||_+R>=g)return A.offsets[_]=D,D;const z=Ko(_+R,T),G=gs(z.sub(u),E,R),Q=u.add(G),J=z.add(G);return A.offsets[_]=l.findLineIntersection(v,D,Q,J)||D,A.offsets[_]}function F(_,r,u,f,g,v,E,T,A,R,D,z,G,Q){const J=f?_-r:_+r;let te=J>0?1:-1,K=0;f&&(te*=-1,K=Math.PI),te<0&&(K+=Math.PI);let ve,Me,se=te>0?T+E:T+E+1,we=g,Ne=g,$e=0,We=0;const ot=Math.abs(J),Je=[];let dt;for(;$e+We<=ot;){if(se+=te,se<T||se>=A)return null;$e+=We,Ne=we,Me=ve;const _t={projectionCache:z,lineVertexArray:R,labelPlaneMatrix:D,tileAnchorPoint:v,distanceFromAnchor:$e,getElevation:Q,previousVertex:Ne,direction:te,absOffsetX:ot};if(we=Ko(se,_t),u===0)Je.push(Ne),dt=we.sub(Ne);else{let Ht;const Ct=we.sub(Ne);Ht=Ct.mag()===0?gs(Ko(se+te,_t).sub(we),u,te):gs(Ct,u,te),Me||(Me=Ne.add(Ht)),ve=ne(se,Ht,we,T,A,Me,u,_t),Je.push(Me),dt=ve.sub(Me)}We=dt.mag()}const Mt=dt._mult((ot-$e)/We)._add(Me||Ne),cn=K+Math.atan2(we.y-Ne.y,we.x-Ne.x);return Je.push(Mt),{point:Mt,angle:G?cn:0,path:Je}}const $=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function Y(_,r){for(let u=0;u<_;u++){const f=r.length;r.resize(f+4),r.float32.set($,3*f)}}function re(_,r,u){const f=r[0],g=r[1];return _[0]=u[0]*f+u[4]*g+u[12],_[1]=u[1]*f+u[5]*g+u[13],_[3]=u[3]*f+u[7]*g+u[15],_}const de=100;class Se{constructor(r,u=new Nt(r.width+200,r.height+200,25),f=new Nt(r.width+200,r.height+200,25)){this.transform=r,this.grid=u,this.ignoredGrid=f,this.pitchfactor=Math.cos(r._pitch)*r.cameraToCenterDistance,this.screenRightBoundary=r.width+de,this.screenBottomBoundary=r.height+de,this.gridRightBoundary=r.width+200,this.gridBottomBoundary=r.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(r,u,f,g,v,E){const T=this.projectAndGetPerspectiveRatio(g,r.anchorPointX,r.anchorPointY,E),A=f*T.perspectiveRatio,R=r.x1*A+T.point.x,D=r.y1*A+T.point.y,z=r.x2*A+T.point.x,G=r.y2*A+T.point.y;return!this.isInsideGrid(R,D,z,G)||u!=="always"&&this.grid.hitTest(R,D,z,G,u,v)||T.perspectiveRatio<this.perspectiveRatioCutoff?{box:[],offscreen:!1}:{box:[R,D,z,G],offscreen:this.isOffscreen(R,D,z,G)}}placeCollisionCircles(r,u,f,g,v,E,T,A,R,D,z,G,Q,J){const te=[],K=new l.Point(u.anchorX,u.anchorY),ve=It(K,E,J),Me=Hn(this.transform.cameraToCenterDistance,ve.signedDistanceFromCamera),se=(D?v/Me:v*Me)/l.ONE_EM,we=It(K,T,J).point,Ne=jr(se,g,u.lineOffsetX*se,u.lineOffsetY*se,!1,we,K,u,f,T,{projections:{},offsets:{}},!1,J);let $e=!1,We=!1,ot=!0;if(Ne){const Je=.5*G*Me+Q,dt=new l.Point(-100,-100),Mt=new l.Point(this.screenRightBoundary,this.screenBottomBoundary),cn=new st,_t=Ne.first,Ht=Ne.last;let Ct=[];for(let nn=_t.path.length-1;nn>=1;nn--)Ct.push(_t.path[nn]);for(let nn=1;nn<Ht.path.length;nn++)Ct.push(Ht.path[nn]);const Fn=2.5*Je;if(A){const nn=Ct.map(Zt=>It(Zt,A,J));Ct=nn.some(Zt=>Zt.signedDistanceFromCamera<=0)?[]:nn.map(Zt=>Zt.point)}let sn=[];if(Ct.length>0){const nn=Ct[0].clone(),Zt=Ct[0].clone();for(let oi=1;oi<Ct.length;oi++)nn.x=Math.min(nn.x,Ct[oi].x),nn.y=Math.min(nn.y,Ct[oi].y),Zt.x=Math.max(Zt.x,Ct[oi].x),Zt.y=Math.max(Zt.y,Ct[oi].y);sn=nn.x>=dt.x&&Zt.x<=Mt.x&&nn.y>=dt.y&&Zt.y<=Mt.y?[Ct]:Zt.x<dt.x||nn.x>Mt.x||Zt.y<dt.y||nn.y>Mt.y?[]:l.clipLine([Ct],dt.x,dt.y,Mt.x,Mt.y)}for(const nn of sn){cn.reset(nn,.25*Je);let Zt=0;Zt=cn.length<=.5*Je?1:Math.ceil(cn.paddedLength/Fn)+1;for(let oi=0;oi<Zt;oi++){const Rn=oi/Math.max(Zt-1,1),ir=cn.lerp(Rn),Li=ir.x+de,yi=ir.y+de;te.push(Li,yi,Je,0);const pr=Li-Je,is=yi-Je,Rs=Li+Je,Ms=yi+Je;if(ot=ot&&this.isOffscreen(pr,is,Rs,Ms),We=We||this.isInsideGrid(pr,is,Rs,Ms),r!=="always"&&this.grid.hitTestCircle(Li,yi,Je,r,z)&&($e=!0,!R))return{circles:[],offscreen:!1,collisionDetected:$e}}}}return{circles:!R&&$e||!We||Me<this.perspectiveRatioCutoff?[]:te,offscreen:ot,collisionDetected:$e}}queryRenderedSymbols(r){if(r.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const u=[];let f=1/0,g=1/0,v=-1/0,E=-1/0;for(const D of r){const z=new l.Point(D.x+de,D.y+de);f=Math.min(f,z.x),g=Math.min(g,z.y),v=Math.max(v,z.x),E=Math.max(E,z.y),u.push(z)}const T=this.grid.query(f,g,v,E).concat(this.ignoredGrid.query(f,g,v,E)),A={},R={};for(const D of T){const z=D.key;if(A[z.bucketInstanceId]===void 0&&(A[z.bucketInstanceId]={}),A[z.bucketInstanceId][z.featureIndex])continue;const G=[new l.Point(D.x1,D.y1),new l.Point(D.x2,D.y1),new l.Point(D.x2,D.y2),new l.Point(D.x1,D.y2)];l.polygonIntersectsPolygon(u,G)&&(A[z.bucketInstanceId][z.featureIndex]=!0,R[z.bucketInstanceId]===void 0&&(R[z.bucketInstanceId]=[]),R[z.bucketInstanceId].push(z.featureIndex))}return R}insertCollisionBox(r,u,f,g,v,E){(f?this.ignoredGrid:this.grid).insert({bucketInstanceId:g,featureIndex:v,collisionGroupID:E,overlapMode:u},r[0],r[1],r[2],r[3])}insertCollisionCircles(r,u,f,g,v,E){const T=f?this.ignoredGrid:this.grid,A={bucketInstanceId:g,featureIndex:v,collisionGroupID:E,overlapMode:u};for(let R=0;R<r.length;R+=4)T.insertCircle(A,r[R],r[R+1],r[R+2])}projectAndGetPerspectiveRatio(r,u,f,g){let v;return g?(v=[u,f,g(u,f),1],l.transformMat4(v,v,r)):(v=[u,f,0,1],re(v,v,r)),{point:new l.Point((v[0]/v[3]+1)/2*this.transform.width+de,(-v[1]/v[3]+1)/2*this.transform.height+de),perspectiveRatio:.5+this.transform.cameraToCenterDistance/v[3]*.5}}isOffscreen(r,u,f,g){return f<de||r>=this.screenRightBoundary||g<de||u>this.screenBottomBoundary}isInsideGrid(r,u,f,g){return f>=0&&r<this.gridRightBoundary&&g>=0&&u<this.gridBottomBoundary}getViewportMatrix(){const r=l.identity([]);return l.translate(r,r,[-100,-100,0]),r}}function pe(_,r,u){return r*(l.EXTENT/(_.tileSize*Math.pow(2,u-_.tileID.overscaledZ)))}class fe{constructor(r,u,f,g){this.opacity=r?Math.max(0,Math.min(1,r.opacity+(r.placed?u:-u))):g&&f?1:0,this.placed=f}isHidden(){return this.opacity===0&&!this.placed}}class Ce{constructor(r,u,f,g,v){this.text=new fe(r?r.text:null,u,f,v),this.icon=new fe(r?r.icon:null,u,g,v)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class Xe{constructor(r,u,f){this.text=r,this.icon=u,this.skipFade=f}}class et{constructor(){this.invProjMatrix=l.create(),this.viewportMatrix=l.create(),this.circles=[]}}class tt{constructor(r,u,f,g,v){this.bucketInstanceId=r,this.featureIndex=u,this.sourceLayerIndex=f,this.bucketIndex=g,this.tileID=v}}class Gt{constructor(r){this.crossSourceCollisions=r,this.maxGroupID=0,this.collisionGroups={}}get(r){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[r]){const u=++this.maxGroupID;this.collisionGroups[r]={ID:u,predicate:f=>f.collisionGroupID===u}}return this.collisionGroups[r]}}function Qt(_,r,u,f,g){const{horizontalAlign:v,verticalAlign:E}=l.getAnchorAlignment(_);return new l.Point(-(v-.5)*r+f[0]*g,-(E-.5)*u+f[1]*g)}function Rt(_,r,u,f,g,v){const{x1:E,x2:T,y1:A,y2:R,anchorPointX:D,anchorPointY:z}=_,G=new l.Point(r,u);return f&&G._rotate(g?v:-v),{x1:E+G.x,y1:A+G.y,x2:T+G.x,y2:R+G.y,anchorPointX:D,anchorPointY:z}}class Ut{constructor(r,u,f,g,v){this.transform=r.clone(),this.terrain=u,this.collisionIndex=new Se(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=f,this.retainedQueryData={},this.collisionGroups=new Gt(g),this.collisionCircleArrays={},this.prevPlacement=v,v&&(v.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(r,u,f,g){const v=f.getBucket(u),E=f.latestFeatureIndex;if(!v||!E||u.id!==v.layerIds[0])return;const T=f.collisionBoxArray,A=v.layers[0].layout,R=Math.pow(2,this.transform.zoom-f.tileID.overscaledZ),D=f.tileSize/l.EXTENT,z=this.transform.calculatePosMatrix(f.tileID.toUnwrapped()),G=A.get("text-pitch-alignment")==="map",Q=A.get("text-rotation-alignment")==="map",J=pe(f,1,this.transform.zoom),te=On(z,G,Q,this.transform,J);let K=null;if(G){const Me=qn(z,G,Q,this.transform,J);K=l.multiply([],this.transform.labelPlaneMatrix,Me)}this.retainedQueryData[v.bucketInstanceId]=new tt(v.bucketInstanceId,E,v.sourceLayerIndex,v.index,f.tileID);const ve={bucket:v,layout:A,posMatrix:z,textLabelPlaneMatrix:te,labelToScreenMatrix:K,scale:R,textPixelRatio:D,holdingForFade:f.holdingForFade(),collisionBoxArray:T,partiallyEvaluatedTextSize:l.evaluateSizeForZoom(v.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(v.sourceID)};if(g)for(const Me of v.sortKeyRanges){const{sortKey:se,symbolInstanceStart:we,symbolInstanceEnd:Ne}=Me;r.push({sortKey:se,symbolInstanceStart:we,symbolInstanceEnd:Ne,parameters:ve})}else r.push({symbolInstanceStart:0,symbolInstanceEnd:v.symbolInstances.length,parameters:ve})}attemptAnchorPlacement(r,u,f,g,v,E,T,A,R,D,z,G,Q,J,te,K){const ve=l.TextAnchorEnum[r.textAnchor],Me=[r.textOffset0,r.textOffset1],se=Qt(ve,f,g,Me,v),we=this.collisionIndex.placeCollisionBox(Rt(u,se.x,se.y,E,T,this.transform.angle),z,A,R,D.predicate,K);if((!te||this.collisionIndex.placeCollisionBox(Rt(te,se.x,se.y,E,T,this.transform.angle),z,A,R,D.predicate,K).box.length!==0)&&we.box.length>0){let Ne;if(this.prevPlacement&&this.prevPlacement.variableOffsets[G.crossTileID]&&this.prevPlacement.placements[G.crossTileID]&&this.prevPlacement.placements[G.crossTileID].text&&(Ne=this.prevPlacement.variableOffsets[G.crossTileID].anchor),G.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[G.crossTileID]={textOffset:Me,width:f,height:g,anchor:ve,textBoxScale:v,prevAnchor:Ne},this.markUsedJustification(Q,ve,G,J),Q.allowVerticalPlacement&&(this.markUsedOrientation(Q,J,G),this.placedOrientations[G.crossTileID]=J),{shift:se,placedGlyphBoxes:we}}}placeLayerBucketPart(r,u,f){const{bucket:g,layout:v,posMatrix:E,textLabelPlaneMatrix:T,labelToScreenMatrix:A,textPixelRatio:R,holdingForFade:D,collisionBoxArray:z,partiallyEvaluatedTextSize:G,collisionGroup:Q}=r.parameters,J=v.get("text-optional"),te=v.get("icon-optional"),K=l.getOverlapMode(v,"text-overlap","text-allow-overlap"),ve=K==="always",Me=l.getOverlapMode(v,"icon-overlap","icon-allow-overlap"),se=Me==="always",we=v.get("text-rotation-alignment")==="map",Ne=v.get("text-pitch-alignment")==="map",$e=v.get("icon-text-fit")!=="none",We=v.get("symbol-z-order")==="viewport-y",ot=ve&&(se||!g.hasIconData()||te),Je=se&&(ve||!g.hasTextData()||J);!g.collisionArrays&&z&&g.deserializeCollisionBoxes(z);const dt=this.retainedQueryData[g.bucketInstanceId].tileID,Mt=this.terrain?(_t,Ht)=>this.terrain.getElevation(dt,_t,Ht):null,cn=(_t,Ht)=>{var Ct,Fn;if(u[_t.crossTileID])return;if(D)return void(this.placements[_t.crossTileID]=new Xe(!1,!1,!1));let sn=!1,nn=!1,Zt=!0,oi=null,Rn={box:null,offscreen:null},ir={box:null,offscreen:null},Li=null,yi=null,pr=null,is=0,Rs=0,Ms=0;Ht.textFeatureIndex?is=Ht.textFeatureIndex:_t.useRuntimeCollisionCircles&&(is=_t.featureIndex),Ht.verticalTextFeatureIndex&&(Rs=Ht.verticalTextFeatureIndex);const na=Ht.textBox;if(na){const zi=wi=>{let Bi=l.WritingMode.horizontal;if(g.allowVerticalPlacement&&!wi&&this.prevPlacement){const mr=this.prevPlacement.placedOrientations[_t.crossTileID];mr&&(this.placedOrientations[_t.crossTileID]=mr,Bi=mr,this.markUsedOrientation(g,Bi,_t))}return Bi},li=(wi,Bi)=>{if(g.allowVerticalPlacement&&_t.numVerticalGlyphVertices>0&&Ht.verticalTextBox){for(const mr of g.writingModes)if(mr===l.WritingMode.vertical?(Rn=Bi(),ir=Rn):Rn=wi(),Rn&&Rn.box&&Rn.box.length)break}else Rn=wi()},Oi=_t.textAnchorOffsetStartIndex,go=_t.textAnchorOffsetEndIndex;if(go===Oi){const wi=(Bi,mr)=>{const ri=this.collisionIndex.placeCollisionBox(Bi,K,R,E,Q.predicate,Mt);return ri&&ri.box&&ri.box.length&&(this.markUsedOrientation(g,mr,_t),this.placedOrientations[_t.crossTileID]=mr),ri};li(()=>wi(na,l.WritingMode.horizontal),()=>{const Bi=Ht.verticalTextBox;return g.allowVerticalPlacement&&_t.numVerticalGlyphVertices>0&&Bi?wi(Bi,l.WritingMode.vertical):{box:null,offscreen:null}}),zi(Rn&&Rn.box&&Rn.box.length)}else{let wi=l.TextAnchorEnum[(Fn=(Ct=this.prevPlacement)===null||Ct===void 0?void 0:Ct.variableOffsets[_t.crossTileID])===null||Fn===void 0?void 0:Fn.anchor];const Bi=(ri,_o,Ds)=>{const rs=ri.x2-ri.x1,ra=ri.y2-ri.y1,mf=_t.textBoxScale,Oa=$e&&Me==="never"?_o:null;let yo={box:[],offscreen:!1},ah=K==="never"?1:2,si="never";wi&&ah++;for(let bc=0;bc<ah;bc++){for(let wc=Oi;wc<go;wc++){const sa=g.textAnchorOffsets.get(wc);if(wi&&sa.textAnchor!==wi)continue;const Ls=this.attemptAnchorPlacement(sa,ri,rs,ra,mf,we,Ne,R,E,Q,si,_t,g,Ds,Oa,Mt);if(Ls&&(yo=Ls.placedGlyphBoxes,yo&&yo.box&&yo.box.length))return sn=!0,oi=Ls.shift,yo}wi?wi=null:si=K}return yo};li(()=>Bi(na,Ht.iconBox,l.WritingMode.horizontal),()=>{const ri=Ht.verticalTextBox;return g.allowVerticalPlacement&&!(Rn&&Rn.box&&Rn.box.length)&&_t.numVerticalGlyphVertices>0&&ri?Bi(ri,Ht.verticalIconBox,l.WritingMode.vertical):{box:null,offscreen:null}}),Rn&&(sn=Rn.box,Zt=Rn.offscreen);const mr=zi(Rn&&Rn.box);if(!sn&&this.prevPlacement){const ri=this.prevPlacement.variableOffsets[_t.crossTileID];ri&&(this.variableOffsets[_t.crossTileID]=ri,this.markUsedJustification(g,ri.anchor,_t,mr))}}}if(Li=Rn,sn=Li&&Li.box&&Li.box.length>0,Zt=Li&&Li.offscreen,_t.useRuntimeCollisionCircles){const zi=g.text.placedSymbolArray.get(_t.centerJustifiedTextSymbolIndex),li=l.evaluateSizeForFeature(g.textSizeData,G,zi),Oi=v.get("text-padding");yi=this.collisionIndex.placeCollisionCircles(K,zi,g.lineVertexArray,g.glyphOffsetArray,li,E,T,A,f,Ne,Q.predicate,_t.collisionCircleDiameter,Oi,Mt),yi.circles.length&&yi.collisionDetected&&!f&&l.warnOnce("Collisions detected, but collision boxes are not shown"),sn=ve||yi.circles.length>0&&!yi.collisionDetected,Zt=Zt&&yi.offscreen}if(Ht.iconFeatureIndex&&(Ms=Ht.iconFeatureIndex),Ht.iconBox){const zi=li=>{const Oi=$e&&oi?Rt(li,oi.x,oi.y,we,Ne,this.transform.angle):li;return this.collisionIndex.placeCollisionBox(Oi,Me,R,E,Q.predicate,Mt)};ir&&ir.box&&ir.box.length&&Ht.verticalIconBox?(pr=zi(Ht.verticalIconBox),nn=pr.box.length>0):(pr=zi(Ht.iconBox),nn=pr.box.length>0),Zt=Zt&&pr.offscreen}const za=J||_t.numHorizontalGlyphVertices===0&&_t.numVerticalGlyphVertices===0,ia=te||_t.numIconVertices===0;if(za||ia?ia?za||(nn=nn&&sn):sn=nn&&sn:nn=sn=nn&&sn,sn&&Li&&Li.box&&this.collisionIndex.insertCollisionBox(Li.box,K,v.get("text-ignore-placement"),g.bucketInstanceId,ir&&ir.box&&Rs?Rs:is,Q.ID),nn&&pr&&this.collisionIndex.insertCollisionBox(pr.box,Me,v.get("icon-ignore-placement"),g.bucketInstanceId,Ms,Q.ID),yi&&(sn&&this.collisionIndex.insertCollisionCircles(yi.circles,K,v.get("text-ignore-placement"),g.bucketInstanceId,is,Q.ID),f)){const zi=g.bucketInstanceId;let li=this.collisionCircleArrays[zi];li===void 0&&(li=this.collisionCircleArrays[zi]=new et);for(let Oi=0;Oi<yi.circles.length;Oi+=4)li.circles.push(yi.circles[Oi+0]),li.circles.push(yi.circles[Oi+1]),li.circles.push(yi.circles[Oi+2]),li.circles.push(yi.collisionDetected?1:0)}if(_t.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");if(g.bucketInstanceId===0)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[_t.crossTileID]=new Xe(sn||ot,nn||Je,Zt||g.justReloaded),u[_t.crossTileID]=!0};if(We){if(r.symbolInstanceStart!==0)throw new Error("bucket.bucketInstanceId should be 0");const _t=g.getSortedSymbolIndexes(this.transform.angle);for(let Ht=_t.length-1;Ht>=0;--Ht){const Ct=_t[Ht];cn(g.symbolInstances.get(Ct),g.collisionArrays[Ct])}}else for(let _t=r.symbolInstanceStart;_t<r.symbolInstanceEnd;_t++)cn(g.symbolInstances.get(_t),g.collisionArrays[_t]);if(f&&g.bucketInstanceId in this.collisionCircleArrays){const _t=this.collisionCircleArrays[g.bucketInstanceId];l.invert(_t.invProjMatrix,E),_t.viewportMatrix=this.collisionIndex.getViewportMatrix()}g.justReloaded=!1}markUsedJustification(r,u,f,g){let v;v=g===l.WritingMode.vertical?f.verticalPlacedTextSymbolIndex:{left:f.leftJustifiedTextSymbolIndex,center:f.centerJustifiedTextSymbolIndex,right:f.rightJustifiedTextSymbolIndex}[l.getAnchorJustification(u)];const E=[f.leftJustifiedTextSymbolIndex,f.centerJustifiedTextSymbolIndex,f.rightJustifiedTextSymbolIndex,f.verticalPlacedTextSymbolIndex];for(const T of E)T>=0&&(r.text.placedSymbolArray.get(T).crossTileID=v>=0&&T!==v?0:f.crossTileID)}markUsedOrientation(r,u,f){const g=u===l.WritingMode.horizontal||u===l.WritingMode.horizontalOnly?u:0,v=u===l.WritingMode.vertical?u:0,E=[f.leftJustifiedTextSymbolIndex,f.centerJustifiedTextSymbolIndex,f.rightJustifiedTextSymbolIndex];for(const T of E)r.text.placedSymbolArray.get(T).placedOrientation=g;f.verticalPlacedTextSymbolIndex&&(r.text.placedSymbolArray.get(f.verticalPlacedTextSymbolIndex).placedOrientation=v)}commit(r){this.commitTime=r,this.zoomAtLastRecencyCheck=this.transform.zoom;const u=this.prevPlacement;let f=!1;this.prevZoomAdjustment=u?u.zoomAdjustment(this.transform.zoom):0;const g=u?u.symbolFadeChange(r):1,v=u?u.opacities:{},E=u?u.variableOffsets:{},T=u?u.placedOrientations:{};for(const A in this.placements){const R=this.placements[A],D=v[A];D?(this.opacities[A]=new Ce(D,g,R.text,R.icon),f=f||R.text!==D.text.placed||R.icon!==D.icon.placed):(this.opacities[A]=new Ce(null,g,R.text,R.icon,R.skipFade),f=f||R.text||R.icon)}for(const A in v){const R=v[A];if(!this.opacities[A]){const D=new Ce(R,g,!1,!1);D.isHidden()||(this.opacities[A]=D,f=f||R.text.placed||R.icon.placed)}}for(const A in E)this.variableOffsets[A]||!this.opacities[A]||this.opacities[A].isHidden()||(this.variableOffsets[A]=E[A]);for(const A in T)this.placedOrientations[A]||!this.opacities[A]||this.opacities[A].isHidden()||(this.placedOrientations[A]=T[A]);if(u&&u.lastPlacementChangeTime===void 0)throw new Error("Last placement time for previous placement is not defined");f?this.lastPlacementChangeTime=r:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=u?u.lastPlacementChangeTime:r)}updateLayerOpacities(r,u){const f={};for(const g of u){const v=g.getBucket(r);v&&g.latestFeatureIndex&&r.id===v.layerIds[0]&&this.updateBucketOpacities(v,f,g.collisionBoxArray)}}updateBucketOpacities(r,u,f){r.hasTextData()&&(r.text.opacityVertexArray.clear(),r.text.hasVisibleVertices=!1),r.hasIconData()&&(r.icon.opacityVertexArray.clear(),r.icon.hasVisibleVertices=!1),r.hasIconCollisionBoxData()&&r.iconCollisionBox.collisionVertexArray.clear(),r.hasTextCollisionBoxData()&&r.textCollisionBox.collisionVertexArray.clear();const g=r.layers[0],v=g.layout,E=new Ce(null,0,!1,!1,!0),T=v.get("text-allow-overlap"),A=v.get("icon-allow-overlap"),R=g._unevaluatedLayout.hasValue("text-variable-anchor")||g._unevaluatedLayout.hasValue("text-variable-anchor-offset"),D=v.get("text-rotation-alignment")==="map",z=v.get("text-pitch-alignment")==="map",G=v.get("icon-text-fit")!=="none",Q=new Ce(null,0,T&&(A||!r.hasIconData()||v.get("icon-optional")),A&&(T||!r.hasTextData()||v.get("text-optional")),!0);!r.collisionArrays&&f&&(r.hasIconCollisionBoxData()||r.hasTextCollisionBoxData())&&r.deserializeCollisionBoxes(f);const J=(te,K,ve)=>{for(let Me=0;Me<K/4;Me++)te.opacityVertexArray.emplaceBack(ve);te.hasVisibleVertices=te.hasVisibleVertices||ve!==di};for(let te=0;te<r.symbolInstances.length;te++){const K=r.symbolInstances.get(te),{numHorizontalGlyphVertices:ve,numVerticalGlyphVertices:Me,crossTileID:se}=K;let we=this.opacities[se];u[se]?we=E:we||(we=Q,this.opacities[se]=we),u[se]=!0;const Ne=K.numIconVertices>0,$e=this.placedOrientations[K.crossTileID],We=$e===l.WritingMode.vertical,ot=$e===l.WritingMode.horizontal||$e===l.WritingMode.horizontalOnly;if(ve>0||Me>0){const Je=$i(we.text);J(r.text,ve,We?di:Je),J(r.text,Me,ot?di:Je);const dt=we.text.isHidden();[K.rightJustifiedTextSymbolIndex,K.centerJustifiedTextSymbolIndex,K.leftJustifiedTextSymbolIndex].forEach(_t=>{_t>=0&&(r.text.placedSymbolArray.get(_t).hidden=dt||We?1:0)}),K.verticalPlacedTextSymbolIndex>=0&&(r.text.placedSymbolArray.get(K.verticalPlacedTextSymbolIndex).hidden=dt||ot?1:0);const Mt=this.variableOffsets[K.crossTileID];Mt&&this.markUsedJustification(r,Mt.anchor,K,$e);const cn=this.placedOrientations[K.crossTileID];cn&&(this.markUsedJustification(r,"left",K,cn),this.markUsedOrientation(r,cn,K))}if(Ne){const Je=$i(we.icon),dt=!(G&&K.verticalPlacedIconSymbolIndex&&We);K.placedIconSymbolIndex>=0&&(J(r.icon,K.numIconVertices,dt?Je:di),r.icon.placedSymbolArray.get(K.placedIconSymbolIndex).hidden=we.icon.isHidden()),K.verticalPlacedIconSymbolIndex>=0&&(J(r.icon,K.numVerticalIconVertices,dt?di:Je),r.icon.placedSymbolArray.get(K.verticalPlacedIconSymbolIndex).hidden=we.icon.isHidden())}if(r.hasIconCollisionBoxData()||r.hasTextCollisionBoxData()){const Je=r.collisionArrays[te];if(Je){let dt=new l.Point(0,0);if(Je.textBox||Je.verticalTextBox){let cn=!0;if(R){const _t=this.variableOffsets[se];_t?(dt=Qt(_t.anchor,_t.width,_t.height,_t.textOffset,_t.textBoxScale),D&&dt._rotate(z?this.transform.angle:-this.transform.angle)):cn=!1}Je.textBox&&Kt(r.textCollisionBox.collisionVertexArray,we.text.placed,!cn||We,dt.x,dt.y),Je.verticalTextBox&&Kt(r.textCollisionBox.collisionVertexArray,we.text.placed,!cn||ot,dt.x,dt.y)}const Mt=!!(!ot&&Je.verticalIconBox);Je.iconBox&&Kt(r.iconCollisionBox.collisionVertexArray,we.icon.placed,Mt,G?dt.x:0,G?dt.y:0),Je.verticalIconBox&&Kt(r.iconCollisionBox.collisionVertexArray,we.icon.placed,!Mt,G?dt.x:0,G?dt.y:0)}}}if(r.sortFeatures(this.transform.angle),this.retainedQueryData[r.bucketInstanceId]&&(this.retainedQueryData[r.bucketInstanceId].featureSortOrder=r.featureSortOrder),r.hasTextData()&&r.text.opacityVertexBuffer&&r.text.opacityVertexBuffer.updateData(r.text.opacityVertexArray),r.hasIconData()&&r.icon.opacityVertexBuffer&&r.icon.opacityVertexBuffer.updateData(r.icon.opacityVertexArray),r.hasIconCollisionBoxData()&&r.iconCollisionBox.collisionVertexBuffer&&r.iconCollisionBox.collisionVertexBuffer.updateData(r.iconCollisionBox.collisionVertexArray),r.hasTextCollisionBoxData()&&r.textCollisionBox.collisionVertexBuffer&&r.textCollisionBox.collisionVertexBuffer.updateData(r.textCollisionBox.collisionVertexArray),r.text.opacityVertexArray.length!==r.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${r.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${r.text.layoutVertexArray.length}) / 4`);if(r.icon.opacityVertexArray.length!==r.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${r.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${r.icon.layoutVertexArray.length}) / 4`);if(r.bucketInstanceId in this.collisionCircleArrays){const te=this.collisionCircleArrays[r.bucketInstanceId];r.placementInvProjMatrix=te.invProjMatrix,r.placementViewportMatrix=te.viewportMatrix,r.collisionCircleArray=te.circles,delete this.collisionCircleArrays[r.bucketInstanceId]}}symbolFadeChange(r){return this.fadeDuration===0?1:(r-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(r){return Math.max(0,(this.transform.zoom-r)/1.5)}hasTransitions(r){return this.stale||r-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(r,u){const f=this.zoomAtLastRecencyCheck===u?1-this.zoomAdjustment(u):1;return this.zoomAtLastRecencyCheck=u,this.commitTime+this.fadeDuration*f>r}setStale(){this.stale=!0}}function Kt(_,r,u,f,g){_.emplaceBack(r?1:0,u?1:0,f||0,g||0),_.emplaceBack(r?1:0,u?1:0,f||0,g||0),_.emplaceBack(r?1:0,u?1:0,f||0,g||0),_.emplaceBack(r?1:0,u?1:0,f||0,g||0)}const _n=Math.pow(2,25),Dn=Math.pow(2,24),on=Math.pow(2,17),pn=Math.pow(2,16),dr=Math.pow(2,9),Yt=Math.pow(2,8),bi=Math.pow(2,1);function $i(_){if(_.opacity===0&&!_.placed)return 0;if(_.opacity===1&&_.placed)return 4294967295;const r=_.placed?1:0,u=Math.floor(127*_.opacity);return u*_n+r*Dn+u*on+r*pn+u*dr+r*Yt+u*bi+r}const di=0;class Cr{constructor(r){this._sortAcrossTiles=r.layout.get("symbol-z-order")!=="viewport-y"&&!r.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(r,u,f,g,v){const E=this._bucketParts;for(;this._currentTileIndex<r.length;)if(u.getBucketParts(E,g,r[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,v())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,E.sort((T,A)=>T.sortKey-A.sortKey));this._currentPartIndex<E.length;)if(u.placeLayerBucketPart(E[this._currentPartIndex],this._seenCrossTileIDs,f),this._currentPartIndex++,v())return!0;return!1}}class $m{constructor(r,u,f,g,v,E,T,A){this.placement=new Ut(r,u,E,T,A),this._currentPlacementIndex=f.length-1,this._forceFullPlacement=g,this._showCollisionBoxes=v,this._done=!1}isDone(){return this._done}continuePlacement(r,u,f){const g=l.browser.now(),v=()=>!this._forceFullPlacement&&l.browser.now()-g>2;for(;this._currentPlacementIndex>=0;){const E=u[r[this._currentPlacementIndex]],T=this.placement.collisionIndex.transform.zoom;if(E.type==="symbol"&&(!E.minzoom||E.minzoom<=T)&&(!E.maxzoom||E.maxzoom>T)){if(this._inProgressLayer||(this._inProgressLayer=new Cr(E)),this._inProgressLayer.continuePlacement(f[E.source],this.placement,this._showCollisionBoxes,E,v))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(r){return this.placement.commit(r),this.placement}}const Zi=512/l.EXTENT/2;class Gr{constructor(r,u,f){this.tileID=r,this.bucketInstanceId=f,this._symbolsByKey={};const g=new Map;for(let v=0;v<u.length;v++){const E=u.get(v),T=E.key,A=g.get(T);A?A.push(E):g.set(T,[E])}for(const[v,E]of g){const T={positions:E.map(A=>({x:Math.floor(A.anchorX*Zi),y:Math.floor(A.anchorY*Zi)})),crossTileIDs:E.map(A=>A.crossTileID)};if(T.positions.length>128){const A=new l.KDBush(T.positions.length,16,Uint16Array);for(const{x:R,y:D}of T.positions)A.add(R,D);A.finish(),delete T.positions,T.index=A}this._symbolsByKey[v]=T}}getScaledCoordinates(r,u){const{x:f,y:g,z:v}=this.tileID.canonical,{x:E,y:T,z:A}=u.canonical,R=Zi/Math.pow(2,A-v),D=(T*l.EXTENT+r.anchorY)*R,z=g*l.EXTENT*Zi;return{x:Math.floor((E*l.EXTENT+r.anchorX)*R-f*l.EXTENT*Zi),y:Math.floor(D-z)}}findMatches(r,u,f){const g=this.tileID.canonical.z<u.canonical.z?1:Math.pow(2,this.tileID.canonical.z-u.canonical.z);for(let v=0;v<r.length;v++){const E=r.get(v);if(E.crossTileID)continue;const T=this._symbolsByKey[E.key];if(!T)continue;const A=this.getScaledCoordinates(E,u);if(T.index){const R=T.index.range(A.x-g,A.y-g,A.x+g,A.y+g).sort();for(const D of R){const z=T.crossTileIDs[D];if(!f[z]){f[z]=!0,E.crossTileID=z;break}}}else if(T.positions)for(let R=0;R<T.positions.length;R++){const D=T.positions[R],z=T.crossTileIDs[R];if(Math.abs(D.x-A.x)<=g&&Math.abs(D.y-A.y)<=g&&!f[z]){f[z]=!0,E.crossTileID=z;break}}}}getCrossTileIDsLists(){return Object.values(this._symbolsByKey).map(({crossTileIDs:r})=>r)}}class Ld{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class $l{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(r){const u=Math.round((r-this.lng)/360);if(u!==0)for(const f in this.indexes){const g=this.indexes[f],v={};for(const E in g){const T=g[E];T.tileID=T.tileID.unwrapTo(T.tileID.wrap+u),v[T.tileID.key]=T}this.indexes[f]=v}this.lng=r}addBucket(r,u,f){if(this.indexes[r.overscaledZ]&&this.indexes[r.overscaledZ][r.key]){if(this.indexes[r.overscaledZ][r.key].bucketInstanceId===u.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(r.overscaledZ,this.indexes[r.overscaledZ][r.key])}for(let v=0;v<u.symbolInstances.length;v++)u.symbolInstances.get(v).crossTileID=0;this.usedCrossTileIDs[r.overscaledZ]||(this.usedCrossTileIDs[r.overscaledZ]={});const g=this.usedCrossTileIDs[r.overscaledZ];for(const v in this.indexes){const E=this.indexes[v];if(Number(v)>r.overscaledZ)for(const T in E){const A=E[T];A.tileID.isChildOf(r)&&A.findMatches(u.symbolInstances,r,g)}else{const T=E[r.scaledTo(Number(v)).key];T&&T.findMatches(u.symbolInstances,r,g)}}for(let v=0;v<u.symbolInstances.length;v++){const E=u.symbolInstances.get(v);E.crossTileID||(E.crossTileID=f.generate(),g[E.crossTileID]=!0)}return this.indexes[r.overscaledZ]===void 0&&(this.indexes[r.overscaledZ]={}),this.indexes[r.overscaledZ][r.key]=new Gr(r,u.symbolInstances,u.bucketInstanceId),!0}removeBucketCrossTileIDs(r,u){for(const f of u.getCrossTileIDsLists())for(const g of f)delete this.usedCrossTileIDs[r][g]}removeStaleBuckets(r){let u=!1;for(const f in this.indexes){const g=this.indexes[f];for(const v in g)r[g[v].bucketInstanceId]||(this.removeBucketCrossTileIDs(f,g[v]),delete g[v],u=!0)}return u}}class fi{constructor(){this.layerIndexes={},this.crossTileIDs=new Ld,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(r,u,f){let g=this.layerIndexes[r.id];g===void 0&&(g=this.layerIndexes[r.id]=new $l);let v=!1;const E={};g.handleWrapJump(f);for(const T of u){const A=T.getBucket(r);A&&r.id===A.layerIds[0]&&(A.bucketInstanceId||(A.bucketInstanceId=++this.maxBucketInstanceId),g.addBucket(T.tileID,A,this.crossTileIDs)&&(v=!0),E[A.bucketInstanceId]=!0)}return g.removeStaleBuckets(E)&&(v=!0),v}pruneUnusedLayers(r){const u={};r.forEach(f=>{u[f]=!0});for(const f in this.layerIndexes)u[f]||delete this.layerIndexes[f]}}const Ks=(_,r)=>l.emitValidationErrors(_,r&&r.filter(u=>u.identifier!=="source.canvas")),wa=l.pick(l.operations,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setGlyphs","setSprite"]),pi=l.pick(l.operations,["setCenter","setZoom","setBearing","setPitch"]),Vl=l.emptyStyle();class Wi extends l.Evented{constructor(r,u={}){super(),this.map=r,this.dispatcher=new rt(fn(),this,r._getMapId()),this.imageManager=new _e,this.imageManager.setEventedParent(this),this.glyphManager=new Qe(r._requestManager,u.localIdeographFontFamily),this.lineAtlas=new Et(256,512),this.crossTileSymbolIndex=new fi,this._spritesImagesIds={},this._layers={},this._order=[],this.sourceCaches={},this.zoomHistory=new l.ZoomHistory,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("setReferrer",l.getReferrer());const f=this;this._rtlTextPluginCallback=Wi.registerForPluginStateChange(g=>{f.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:g.pluginStatus,pluginURL:g.pluginURL},(v,E)=>{if(l.triggerPluginCompletionEvent(v),E&&E.every(T=>T))for(const T in f.sourceCaches){const A=f.sourceCaches[T].getSource().type;A!=="vector"&&A!=="geojson"||f.sourceCaches[T].reload()}})}),this.on("data",g=>{if(g.dataType!=="source"||g.sourceDataType!=="metadata")return;const v=this.sourceCaches[g.sourceId];if(!v)return;const E=v.getSource();if(E&&E.vectorLayerIds)for(const T in this._layers){const A=this._layers[T];A.source===E.id&&this._validateLayer(A)}})}loadURL(r,u={},f){this.fire(new l.Event("dataloading",{dataType:"style"})),u.validate=typeof u.validate!="boolean"||u.validate;const g=this.map._requestManager.transformRequest(r,he.Style);this._request=l.getJSON(g,(v,E)=>{this._request=null,v?this.fire(new l.ErrorEvent(v)):E&&this._load(E,u,f)})}loadJSON(r,u={},f){this.fire(new l.Event("dataloading",{dataType:"style"})),this._request=l.browser.frame(()=>{this._request=null,u.validate=u.validate!==!1,this._load(r,u,f)})}loadEmpty(){this.fire(new l.Event("dataloading",{dataType:"style"})),this._load(Vl,{validate:!1})}_load(r,u,f){const g=u.transformStyle?u.transformStyle(f,r):r;if(!u.validate||!Ks(this,l.validateStyle(g))){this._loaded=!0,this.stylesheet=g;for(const v in g.sources)this.addSource(v,g.sources[v],{validate:!1});g.sprite?this._loadSprite(g.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(g.glyphs),this._createLayers(),this.light=new kt(this.stylesheet.light),this.map.setTerrain(this.stylesheet.terrain),this.fire(new l.Event("data",{dataType:"style"})),this.fire(new l.Event("style.load"))}}_createLayers(){const r=l.derefLayers(this.stylesheet.layers);this.dispatcher.broadcast("setLayers",r),this._order=r.map(u=>u.id),this._layers={},this._serializedLayers=null;for(const u of r){const f=l.createStyleLayer(u);f.setEventedParent(this,{layer:{id:u.id}}),this._layers[u.id]=f}}_loadSprite(r,u=!1,f=void 0){this.imageManager.setLoaded(!1),this._spriteRequest=function(g,v,E,T){const A=V(g),R=A.length,D=E>1?"@2x":"",z={},G={},Q={};for(const{id:J,url:te}of A){const K=v.transformRequest(v.normalizeSpriteURL(te,D,".json"),he.SpriteJSON),ve=`${J}_${K.url}`;z[ve]=l.getJSON(K,(we,Ne)=>{delete z[ve],G[J]=Ne,Z(T,G,Q,we,R)});const Me=v.transformRequest(v.normalizeSpriteURL(te,D,".png"),he.SpriteImage),se=`${J}_${Me.url}`;z[se]=le.getImage(Me,(we,Ne)=>{delete z[se],Q[J]=Ne,Z(T,G,Q,we,R)})}return{cancel(){for(const J of Object.values(z))J.cancel()}}}(r,this.map._requestManager,this.map.getPixelRatio(),(g,v)=>{if(this._spriteRequest=null,g)this.fire(new l.ErrorEvent(g));else if(v)for(const E in v){this._spritesImagesIds[E]=[];const T=this._spritesImagesIds[E]?this._spritesImagesIds[E].filter(A=>!(A in v)):[];for(const A of T)this.imageManager.removeImage(A),this._changedImages[A]=!0;for(const A in v[E]){const R=E==="default"?A:`${E}:${A}`;this._spritesImagesIds[E].push(R),R in this.imageManager.images?this.imageManager.updateImage(R,v[E][A],!1):this.imageManager.addImage(R,v[E][A]),u&&(this._changedImages[R]=!0)}}this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),u&&(this._changed=!0),this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new l.Event("data",{dataType:"style"})),f&&f(g)})}_unloadSprite(){for(const r of Object.values(this._spritesImagesIds).flat())this.imageManager.removeImage(r),this._changedImages[r]=!0;this._spritesImagesIds={},this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new l.Event("data",{dataType:"style"}))}_validateLayer(r){const u=this.sourceCaches[r.source];if(!u)return;const f=r.sourceLayer;if(!f)return;const g=u.getSource();(g.type==="geojson"||g.vectorLayerIds&&g.vectorLayerIds.indexOf(f)===-1)&&this.fire(new l.ErrorEvent(new Error(`Source layer "${f}" does not exist on source "${g.id}" as specified by style layer "${r.id}".`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const r in this.sourceCaches)if(!this.sourceCaches[r].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeByIds(r){const u=this._serializedAllLayers();if(!r||r.length===0)return Object.values(u);const f=[];for(const g of r)u[g]&&f.push(u[g]);return f}_serializedAllLayers(){let r=this._serializedLayers;if(r)return r;r=this._serializedLayers={};const u=Object.keys(this._layers);for(const f of u){const g=this._layers[f];g.type!=="custom"&&(r[f]=g.serialize())}return r}hasTransitions(){if(this.light&&this.light.hasTransition())return!0;for(const r in this.sourceCaches)if(this.sourceCaches[r].hasTransition())return!0;for(const r in this._layers)if(this._layers[r].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(r){if(!this._loaded)return;const u=this._changed;if(this._changed){const g=Object.keys(this._updatedLayers),v=Object.keys(this._removedLayers);(g.length||v.length)&&this._updateWorkerLayers(g,v);for(const E in this._updatedSources){const T=this._updatedSources[E];if(T==="reload")this._reloadSource(E);else{if(T!=="clear")throw new Error(`Invalid action ${T}`);this._clearSource(E)}}this._updateTilesForChangedImages(),this._updateTilesForChangedGlyphs();for(const E in this._updatedPaintProps)this._layers[E].updateTransitions(r);this.light.updateTransitions(r),this._resetUpdates()}const f={};for(const g in this.sourceCaches){const v=this.sourceCaches[g];f[g]=v.used,v.used=!1}for(const g of this._order){const v=this._layers[g];v.recalculate(r,this._availableImages),!v.isHidden(r.zoom)&&v.source&&(this.sourceCaches[v.source].used=!0)}for(const g in f){const v=this.sourceCaches[g];f[g]!==v.used&&v.fire(new l.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:g}))}this.light.recalculate(r),this.z=r.zoom,u&&this.fire(new l.Event("data",{dataType:"style"}))}_updateTilesForChangedImages(){const r=Object.keys(this._changedImages);if(r.length){for(const u in this.sourceCaches)this.sourceCaches[u].reloadTilesForDependencies(["icons","patterns"],r);this._changedImages={}}}_updateTilesForChangedGlyphs(){if(this._glyphsDidChange){for(const r in this.sourceCaches)this.sourceCaches[r].reloadTilesForDependencies(["glyphs"],[""]);this._glyphsDidChange=!1}}_updateWorkerLayers(r,u){this.dispatcher.broadcast("updateLayers",{layers:this._serializeByIds(r),removedIds:u})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={},this._glyphsDidChange=!1}setState(r,u={}){this._checkLoaded();const f=this.serialize();if(r=u.transformStyle?u.transformStyle(f,r):r,Ks(this,l.validateStyle(r)))return!1;(r=l.clone$1(r)).layers=l.derefLayers(r.layers);const g=l.diffStyles(f,r).filter(E=>!(E.command in pi));if(g.length===0)return!1;const v=g.filter(E=>!(E.command in wa));if(v.length>0)throw new Error(`Unimplemented: ${v.map(E=>E.command).join(", ")}.`);for(const E of g)E.command!=="setTransition"&&this[E.command].apply(this,E.args);return this.stylesheet=r,!0}addImage(r,u){if(this.getImage(r))return this.fire(new l.ErrorEvent(new Error(`An image named "${r}" already exists.`)));this.imageManager.addImage(r,u),this._afterImageUpdated(r)}updateImage(r,u){this.imageManager.updateImage(r,u)}getImage(r){return this.imageManager.getImage(r)}removeImage(r){if(!this.getImage(r))return this.fire(new l.ErrorEvent(new Error(`An image named "${r}" does not exist.`)));this.imageManager.removeImage(r),this._afterImageUpdated(r)}_afterImageUpdated(r){this._availableImages=this.imageManager.listImages(),this._changedImages[r]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new l.Event("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(r,u,f={}){if(this._checkLoaded(),this.sourceCaches[r]!==void 0)throw new Error(`Source "${r}" already exists.`);if(!u.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(u).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(u.type)>=0&&this._validate(l.validateStyle.source,`sources.${r}`,u,null,f))return;this.map&&this.map._collectResourceTiming&&(u.collectResourceTiming=!0);const g=this.sourceCaches[r]=new ut(r,u,this.dispatcher);g.style=this,g.setEventedParent(this,()=>({isSourceLoaded:g.loaded(),source:g.serialize(),sourceId:r})),g.onAdd(this.map),this._changed=!0}removeSource(r){if(this._checkLoaded(),this.sourceCaches[r]===void 0)throw new Error("There is no source with this ID");for(const f in this._layers)if(this._layers[f].source===r)return this.fire(new l.ErrorEvent(new Error(`Source "${r}" cannot be removed while layer "${f}" is using it.`)));const u=this.sourceCaches[r];delete this.sourceCaches[r],delete this._updatedSources[r],u.fire(new l.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:r})),u.setEventedParent(null),u.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(r,u){if(this._checkLoaded(),this.sourceCaches[r]===void 0)throw new Error(`There is no source with this ID=${r}`);const f=this.sourceCaches[r].getSource();if(f.type!=="geojson")throw new Error(`geojsonSource.type is ${f.type}, which is !== 'geojson`);f.setData(u),this._changed=!0}getSource(r){return this.sourceCaches[r]&&this.sourceCaches[r].getSource()}addLayer(r,u,f={}){this._checkLoaded();const g=r.id;if(this.getLayer(g))return void this.fire(new l.ErrorEvent(new Error(`Layer "${g}" already exists on this map.`)));let v;if(r.type==="custom"){if(Ks(this,l.validateCustomStyleLayer(r)))return;v=l.createStyleLayer(r)}else{if(typeof r.source=="object"&&(this.addSource(g,r.source),r=l.clone$1(r),r=l.extend(r,{source:g})),this._validate(l.validateStyle.layer,`layers.${g}`,r,{arrayIndex:-1},f))return;v=l.createStyleLayer(r),this._validateLayer(v),v.setEventedParent(this,{layer:{id:g}})}const E=u?this._order.indexOf(u):this._order.length;if(u&&E===-1)this.fire(new l.ErrorEvent(new Error(`Cannot add layer "${g}" before non-existing layer "${u}".`)));else{if(this._order.splice(E,0,g),this._layerOrderChanged=!0,this._layers[g]=v,this._removedLayers[g]&&v.source&&v.type!=="custom"){const T=this._removedLayers[g];delete this._removedLayers[g],T.type!==v.type?this._updatedSources[v.source]="clear":(this._updatedSources[v.source]="reload",this.sourceCaches[v.source].pause())}this._updateLayer(v),v.onAdd&&v.onAdd(this.map)}}moveLayer(r,u){if(this._checkLoaded(),this._changed=!0,!this._layers[r])return void this.fire(new l.ErrorEvent(new Error(`The layer '${r}' does not exist in the map's style and cannot be moved.`)));if(r===u)return;const f=this._order.indexOf(r);this._order.splice(f,1);const g=u?this._order.indexOf(u):this._order.length;u&&g===-1?this.fire(new l.ErrorEvent(new Error(`Cannot move layer "${r}" before non-existing layer "${u}".`))):(this._order.splice(g,0,r),this._layerOrderChanged=!0)}removeLayer(r){this._checkLoaded();const u=this._layers[r];if(!u)return void this.fire(new l.ErrorEvent(new Error(`Cannot remove non-existing layer "${r}".`)));u.setEventedParent(null);const f=this._order.indexOf(r);this._order.splice(f,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[r]=u,delete this._layers[r],this._serializedLayers&&delete this._serializedLayers[r],delete this._updatedLayers[r],delete this._updatedPaintProps[r],u.onRemove&&u.onRemove(this.map)}getLayer(r){return this._layers[r]}hasLayer(r){return r in this._layers}setLayerZoomRange(r,u,f){this._checkLoaded();const g=this.getLayer(r);g?g.minzoom===u&&g.maxzoom===f||(u!=null&&(g.minzoom=u),f!=null&&(g.maxzoom=f),this._updateLayer(g)):this.fire(new l.ErrorEvent(new Error(`Cannot set the zoom range of non-existing layer "${r}".`)))}setFilter(r,u,f={}){this._checkLoaded();const g=this.getLayer(r);if(g){if(!l.deepEqual(g.filter,u))return u==null?(g.filter=void 0,void this._updateLayer(g)):void(this._validate(l.validateStyle.filter,`layers.${g.id}.filter`,u,null,f)||(g.filter=l.clone$1(u),this._updateLayer(g)))}else this.fire(new l.ErrorEvent(new Error(`Cannot filter non-existing layer "${r}".`)))}getFilter(r){return l.clone$1(this.getLayer(r).filter)}setLayoutProperty(r,u,f,g={}){this._checkLoaded();const v=this.getLayer(r);v?l.deepEqual(v.getLayoutProperty(u),f)||(v.setLayoutProperty(u,f,g),this._updateLayer(v)):this.fire(new l.ErrorEvent(new Error(`Cannot style non-existing layer "${r}".`)))}getLayoutProperty(r,u){const f=this.getLayer(r);if(f)return f.getLayoutProperty(u);this.fire(new l.ErrorEvent(new Error(`Cannot get style of non-existing layer "${r}".`)))}setPaintProperty(r,u,f,g={}){this._checkLoaded();const v=this.getLayer(r);v?l.deepEqual(v.getPaintProperty(u),f)||(v.setPaintProperty(u,f,g)&&this._updateLayer(v),this._changed=!0,this._updatedPaintProps[r]=!0):this.fire(new l.ErrorEvent(new Error(`Cannot style non-existing layer "${r}".`)))}getPaintProperty(r,u){return this.getLayer(r).getPaintProperty(u)}setFeatureState(r,u){this._checkLoaded();const f=r.source,g=r.sourceLayer,v=this.sourceCaches[f];if(v===void 0)return void this.fire(new l.ErrorEvent(new Error(`The source '${f}' does not exist in the map's style.`)));const E=v.getSource().type;E==="geojson"&&g?this.fire(new l.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):E!=="vector"||g?(r.id===void 0&&this.fire(new l.ErrorEvent(new Error("The feature id parameter must be provided."))),v.setFeatureState(g,r.id,u)):this.fire(new l.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(r,u){this._checkLoaded();const f=r.source,g=this.sourceCaches[f];if(g===void 0)return void this.fire(new l.ErrorEvent(new Error(`The source '${f}' does not exist in the map's style.`)));const v=g.getSource().type,E=v==="vector"?r.sourceLayer:void 0;v!=="vector"||E?u&&typeof r.id!="string"&&typeof r.id!="number"?this.fire(new l.ErrorEvent(new Error("A feature id is required to remove its specific state property."))):g.removeFeatureState(E,r.id,u):this.fire(new l.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(r){this._checkLoaded();const u=r.source,f=r.sourceLayer,g=this.sourceCaches[u];if(g!==void 0)return g.getSource().type!=="vector"||f?(r.id===void 0&&this.fire(new l.ErrorEvent(new Error("The feature id parameter must be provided."))),g.getFeatureState(f,r.id)):void this.fire(new l.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new l.ErrorEvent(new Error(`The source '${u}' does not exist in the map's style.`)))}getTransition(){return l.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){if(!this._loaded)return;const r=l.mapObject(this.sourceCaches,g=>g.serialize()),u=this._serializeByIds(this._order),f=this.stylesheet;return l.filterObject({version:f.version,name:f.name,metadata:f.metadata,light:f.light,center:f.center,zoom:f.zoom,bearing:f.bearing,pitch:f.pitch,sprite:f.sprite,glyphs:f.glyphs,transition:f.transition,sources:r,layers:u},g=>g!==void 0)}_updateLayer(r){this._updatedLayers[r.id]=!0,r.source&&!this._updatedSources[r.source]&&this.sourceCaches[r.source].getSource().type!=="raster"&&(this._updatedSources[r.source]="reload",this.sourceCaches[r.source].pause()),this._serializedLayers=null,this._changed=!0}_flattenAndSortRenderedFeatures(r){const u=E=>this._layers[E].type==="fill-extrusion",f={},g=[];for(let E=this._order.length-1;E>=0;E--){const T=this._order[E];if(u(T)){f[T]=E;for(const A of r){const R=A[T];if(R)for(const D of R)g.push(D)}}}g.sort((E,T)=>T.intersectionZ-E.intersectionZ);const v=[];for(let E=this._order.length-1;E>=0;E--){const T=this._order[E];if(u(T))for(let A=g.length-1;A>=0;A--){const R=g[A].feature;if(f[R.layer.id]<E)break;v.push(R),g.pop()}else for(const A of r){const R=A[T];if(R)for(const D of R)v.push(D.feature)}}return v}queryRenderedFeatures(r,u,f){u&&u.filter&&this._validate(l.validateStyle.filter,"queryRenderedFeatures.filter",u.filter,null,u);const g={};if(u&&u.layers){if(!Array.isArray(u.layers))return this.fire(new l.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(const T of u.layers){const A=this._layers[T];if(!A)return this.fire(new l.ErrorEvent(new Error(`The layer '${T}' does not exist in the map's style and cannot be queried for features.`))),[];g[A.source]=!0}}const v=[];u.availableImages=this._availableImages;const E=this._serializedAllLayers();for(const T in this.sourceCaches)u.layers&&!g[T]||v.push(Ve(this.sourceCaches[T],this._layers,E,r,u,f));return this.placement&&v.push(function(T,A,R,D,z,G,Q){const J={},te=G.queryRenderedSymbols(D),K=[];for(const ve of Object.keys(te).map(Number))K.push(Q[ve]);K.sort(ht);for(const ve of K){const Me=ve.featureIndex.lookupSymbolFeatures(te[ve.bucketInstanceId],A,ve.bucketIndex,ve.sourceLayerIndex,z.filter,z.layers,z.availableImages,T);for(const se in Me){const we=J[se]=J[se]||[],Ne=Me[se];Ne.sort(($e,We)=>{const ot=ve.featureSortOrder;if(ot){const Je=ot.indexOf($e.featureIndex);return ot.indexOf(We.featureIndex)-Je}return We.featureIndex-$e.featureIndex});for(const $e of Ne)we.push($e)}}for(const ve in J)J[ve].forEach(Me=>{const se=Me.feature,we=R[T[ve].source].getFeatureState(se.layer["source-layer"],se.id);se.source=se.layer.source,se.layer["source-layer"]&&(se.sourceLayer=se.layer["source-layer"]),se.state=we});return J}(this._layers,E,this.sourceCaches,r,u,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(v)}querySourceFeatures(r,u){u&&u.filter&&this._validate(l.validateStyle.filter,"querySourceFeatures.filter",u.filter,null,u);const f=this.sourceCaches[r];return f?function(g,v){const E=g.getRenderableIds().map(R=>g.getTileByID(R)),T=[],A={};for(let R=0;R<E.length;R++){const D=E[R],z=D.tileID.canonical.key;A[z]||(A[z]=!0,D.querySourceFeatures(T,v))}return T}(f,u):[]}addSourceType(r,u,f){return Le(r)?f(new Error(`A source type called "${r}" already exists.`)):(((g,v)=>{ye[g]=v})(r,u),u.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:r,url:u.workerSourceURL},f):f(null,null))}getLight(){return this.light.getLight()}setLight(r,u={}){this._checkLoaded();const f=this.light.getLight();let g=!1;for(const E in r)if(!l.deepEqual(r[E],f[E])){g=!0;break}if(!g)return;const v={now:l.browser.now(),transition:l.extend({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(r,u),this.light.updateTransitions(v)}_validate(r,u,f,g,v={}){return(!v||v.validate!==!1)&&Ks(this,r.call(l.validateStyle,l.extend({key:u,style:this.serialize(),value:f,styleSpec:l.v8Spec},g)))}_remove(r=!0){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),l.evented.off("pluginStateChange",this._rtlTextPluginCallback);for(const u in this._layers)this._layers[u].setEventedParent(null);for(const u in this.sourceCaches){const f=this.sourceCaches[u];f.setEventedParent(null),f.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove(r)}_clearSource(r){this.sourceCaches[r].clearTiles()}_reloadSource(r){this.sourceCaches[r].resume(),this.sourceCaches[r].reload()}_updateSources(r){for(const u in this.sourceCaches)this.sourceCaches[u].update(r,this.map.terrain)}_generateCollisionBoxes(){for(const r in this.sourceCaches)this._reloadSource(r)}_updatePlacement(r,u,f,g,v=!1){let E=!1,T=!1;const A={};for(const R of this._order){const D=this._layers[R];if(D.type!=="symbol")continue;if(!A[D.source]){const G=this.sourceCaches[D.source];A[D.source]=G.getRenderableIds(!0).map(Q=>G.getTileByID(Q)).sort((Q,J)=>J.tileID.overscaledZ-Q.tileID.overscaledZ||(Q.tileID.isLessThan(J.tileID)?-1:1))}const z=this.crossTileSymbolIndex.addLayer(D,A[D.source],r.center.lng);E=E||z}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((v=v||this._layerOrderChanged||f===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(l.browser.now(),r.zoom))&&(this.pauseablePlacement=new $m(r,this.map.terrain,this._order,v,u,f,g,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,A),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(l.browser.now()),T=!0),E&&this.pauseablePlacement.placement.setStale()),T||E)for(const R of this._order){const D=this._layers[R];D.type==="symbol"&&this.placement.updateLayerOpacities(D,A[D.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(l.browser.now())}_releaseSymbolFadeTiles(){for(const r in this.sourceCaches)this.sourceCaches[r].releaseSymbolFadeTiles()}getImages(r,u,f){this.imageManager.getImages(u.icons,f),this._updateTilesForChangedImages();const g=this.sourceCaches[u.source];g&&g.setDependencies(u.tileID.key,u.type,u.icons)}getGlyphs(r,u,f){this.glyphManager.getGlyphs(u.stacks,f);const g=this.sourceCaches[u.source];g&&g.setDependencies(u.tileID.key,u.type,[""])}getResource(r,u,f){return l.makeRequest(u,f)}getGlyphsUrl(){return this.stylesheet.glyphs||null}setGlyphs(r,u={}){this._checkLoaded(),r&&this._validate(l.validateStyle.glyphs,"glyphs",r,null,u)||(this._glyphsDidChange=!0,this.stylesheet.glyphs=r,this.glyphManager.entries={},this.glyphManager.setURL(r))}addSprite(r,u,f={},g){this._checkLoaded();const v=[{id:r,url:u}],E=[...V(this.stylesheet.sprite),...v];this._validate(l.validateStyle.sprite,"sprite",E,null,f)||(this.stylesheet.sprite=E,this._loadSprite(v,!0,g))}removeSprite(r){this._checkLoaded();const u=V(this.stylesheet.sprite);if(u.find(f=>f.id===r)){if(this._spritesImagesIds[r])for(const f of this._spritesImagesIds[r])this.imageManager.removeImage(f),this._changedImages[f]=!0;u.splice(u.findIndex(f=>f.id===r),1),this.stylesheet.sprite=u.length>0?u:void 0,delete this._spritesImagesIds[r],this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new l.Event("data",{dataType:"style"}))}else this.fire(new l.ErrorEvent(new Error(`Sprite "${r}" doesn't exists on this map.`)))}getSprite(){return V(this.stylesheet.sprite)}setSprite(r,u={},f){this._checkLoaded(),r&&this._validate(l.validateStyle.sprite,"sprite",r,null,u)||(this.stylesheet.sprite=r,r?this._loadSprite(r,!0,f):(this._unloadSprite(),f&&f(null)))}}Wi.registerForPluginStateChange=l.registerForPluginStateChange;var jl=l.createLayout([{name:"a_pos",type:"Int16",components:2}]),_s="attribute vec3 a_pos3d;uniform mat4 u_matrix;uniform float u_ele_delta;varying vec2 v_texture_pos;varying float v_depth;void main() {float extent=8192.0;float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/extent;gl_Position=u_matrix*vec4(a_pos3d.xy,get_elevation(a_pos3d.xy)-ele_delta,1.0);v_depth=gl_Position.z/gl_Position.w;}";const Jo={prelude:Pn(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}
#ifdef TERRAIN3D
uniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;
#endif
const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {
#ifdef TERRAIN3D
highp float d=unpack(texture2D(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));
#else
return 1.0;
#endif
}float calculate_visibility(vec4 pos) {
#ifdef TERRAIN3D
vec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;
#else
return 1.0;
#endif
}float ele(vec2 pos) {
#ifdef TERRAIN3D
vec4 rgb=(texture2D(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;
#else
return 0.0;
#endif
}float get_elevation(vec2 pos) {
#ifdef TERRAIN3D
vec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return elevation*u_terrain_exaggeration;
#else
return 0.0;
#endif
}`),background:Pn(`uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),backgroundPattern:Pn(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:Pn(`varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);float ele=get_elevation(circle_center);v_visibility=calculate_visibility(u_matrix*vec4(circle_center,ele,1.0));if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,ele,1);} else {gl_Position=u_matrix*vec4(circle_center,ele,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),clippingMask:Pn("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:Pn(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}`),heatmapTexture:Pn(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:Pn("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,get_elevation(a_pos),1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:Pn("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:Pn("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,get_elevation(a_pos),1);}"),fill:Pn(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_FragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);}`),fillOutline:Pn(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillOutlinePattern:Pn(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillPattern:Pn(`#ifdef GL_ES
precision highp float;
#endif
uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),fillExtrusion:Pn(`varying vec4 v_color;void main() {gl_FragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),fillExtrusionPattern:Pn(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),hillshadePrepare:Pn(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:Pn(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;
#define PI 3.141592653589793
void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),line:Pn(`uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),lineGradient:Pn(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),linePattern:Pn(`#ifdef GL_ES
precision highp float;
#endif
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),lineSDF:Pn(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),raster:Pn(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),symbolIcon:Pn(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0),z,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}`),symbolSDF:Pn(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float inner_edge=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);inner_edge=inner_edge+gamma*gamma_scale;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(inner_edge-gamma_scaled,inner_edge+gamma_scaled,dist);if (u_is_halo) {lowp float halo_edge=(6.0-halo_width/fontScale)/SDF_PX;alpha=min(smoothstep(halo_edge-gamma_scaled,halo_edge+gamma_scaled,dist),1.0-alpha);}gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset),z,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),symbolTextAndIcon:Pn(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),z,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`),terrain:Pn("uniform sampler2D u_texture;varying vec2 v_texture_pos;void main() {gl_FragColor=texture2D(u_texture,v_texture_pos);}",_s),terrainDepth:Pn("varying float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {gl_FragColor=pack(v_depth);}",_s),terrainCoords:Pn("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;varying vec2 v_texture_pos;void main() {vec4 rgba=texture2D(u_texture,v_texture_pos);gl_FragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}",_s)};function Pn(_,r){const u=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,f=r.match(/attribute ([\w]+) ([\w]+)/g),g=_.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),v=r.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),E=v?v.concat(g):g,T={};return{fragmentSource:_=_.replace(u,(A,R,D,z,G)=>(T[G]=!0,R==="define"?`
#ifndef HAS_UNIFORM_u_${G}
varying ${D} ${z} ${G};
#else
uniform ${D} ${z} u_${G};
#endif
`:`
#ifdef HAS_UNIFORM_u_${G}
    ${D} ${z} ${G} = u_${G};
#endif
`)),vertexSource:r=r.replace(u,(A,R,D,z,G)=>{const Q=z==="float"?"vec2":"vec4",J=G.match(/color/)?"color":Q;return T[G]?R==="define"?`
#ifndef HAS_UNIFORM_u_${G}
uniform lowp float u_${G}_t;
attribute ${D} ${Q} a_${G};
varying ${D} ${z} ${G};
#else
uniform ${D} ${z} u_${G};
#endif
`:J==="vec4"?`
#ifndef HAS_UNIFORM_u_${G}
    ${G} = a_${G};
#else
    ${D} ${z} ${G} = u_${G};
#endif
`:`
#ifndef HAS_UNIFORM_u_${G}
    ${G} = unpack_mix_${J}(a_${G}, u_${G}_t);
#else
    ${D} ${z} ${G} = u_${G};
#endif
`:R==="define"?`
#ifndef HAS_UNIFORM_u_${G}
uniform lowp float u_${G}_t;
attribute ${D} ${Q} a_${G};
#else
uniform ${D} ${z} u_${G};
#endif
`:J==="vec4"?`
#ifndef HAS_UNIFORM_u_${G}
    ${D} ${z} ${G} = a_${G};
#else
    ${D} ${z} ${G} = u_${G};
#endif
`:`
#ifndef HAS_UNIFORM_u_${G}
    ${D} ${z} ${G} = unpack_mix_${J}(a_${G}, u_${G}_t);
#else
    ${D} ${z} ${G} = u_${G};
#endif
`}),staticAttributes:f,staticUniforms:E}}class Gl{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(r,u,f,g,v,E,T,A,R){this.context=r;let D=this.boundPaintVertexBuffers.length!==g.length;for(let z=0;!D&&z<g.length;z++)this.boundPaintVertexBuffers[z]!==g[z]&&(D=!0);!this.vao||this.boundProgram!==u||this.boundLayoutVertexBuffer!==f||D||this.boundIndexBuffer!==v||this.boundVertexOffset!==E||this.boundDynamicVertexBuffer!==T||this.boundDynamicVertexBuffer2!==A||this.boundDynamicVertexBuffer3!==R?this.freshBind(u,f,g,v,E,T,A,R):(r.bindVertexArray.set(this.vao),T&&T.bind(),v&&v.dynamicDraw&&v.bind(),A&&A.bind(),R&&R.bind())}freshBind(r,u,f,g,v,E,T,A){const R=r.numAttributes,D=this.context,z=D.gl;this.vao&&this.destroy(),this.vao=D.createVertexArray(),D.bindVertexArray.set(this.vao),this.boundProgram=r,this.boundLayoutVertexBuffer=u,this.boundPaintVertexBuffers=f,this.boundIndexBuffer=g,this.boundVertexOffset=v,this.boundDynamicVertexBuffer=E,this.boundDynamicVertexBuffer2=T,this.boundDynamicVertexBuffer3=A,u.enableAttributes(z,r);for(const G of f)G.enableAttributes(z,r);E&&E.enableAttributes(z,r),T&&T.enableAttributes(z,r),A&&A.enableAttributes(z,r),u.bind(),u.setVertexAttribPointers(z,r,v);for(const G of f)G.bind(),G.setVertexAttribPointers(z,r,v);E&&(E.bind(),E.setVertexAttribPointers(z,r,v)),g&&g.bind(),T&&(T.bind(),T.setVertexAttribPointers(z,r,v)),A&&(A.bind(),A.setVertexAttribPointers(z,r,v)),D.currentNumAttributes=R}destroy(){this.vao&&(this.context.deleteVertexArray(this.vao),this.vao=null)}}function io(_){const r=[];for(let u=0;u<_.length;u++){if(_[u]===null)continue;const f=_[u].split(" ");r.push(f.pop())}return r}class Js{constructor(r,u,f,g,v,E){const T=r.gl;this.program=T.createProgram();const A=io(u.staticAttributes),R=f?f.getBinderAttributes():[],D=A.concat(R),z=Jo.prelude.staticUniforms?io(Jo.prelude.staticUniforms):[],G=u.staticUniforms?io(u.staticUniforms):[],Q=f?f.getBinderUniforms():[],J=z.concat(G).concat(Q),te=[];for(const $e of J)te.indexOf($e)<0&&te.push($e);const K=f?f.defines():[];v&&K.push("#define OVERDRAW_INSPECTOR;"),E&&K.push("#define TERRAIN3D;");const ve=K.concat(Jo.prelude.fragmentSource,u.fragmentSource).join(`
`),Me=K.concat(Jo.prelude.vertexSource,u.vertexSource).join(`
`),se=T.createShader(T.FRAGMENT_SHADER);if(T.isContextLost())return void(this.failedToCreate=!0);T.shaderSource(se,ve),T.compileShader(se),T.attachShader(this.program,se);const we=T.createShader(T.VERTEX_SHADER);if(T.isContextLost())return void(this.failedToCreate=!0);T.shaderSource(we,Me),T.compileShader(we),T.attachShader(this.program,we),this.attributes={};const Ne={};this.numAttributes=D.length;for(let $e=0;$e<this.numAttributes;$e++)D[$e]&&(T.bindAttribLocation(this.program,$e,D[$e]),this.attributes[D[$e]]=$e);T.linkProgram(this.program),T.deleteShader(we),T.deleteShader(se);for(let $e=0;$e<te.length;$e++){const We=te[$e];if(We&&!Ne[We]){const ot=T.getUniformLocation(this.program,We);ot&&(Ne[We]=ot)}}this.fixedUniforms=g(r,Ne),this.terrainUniforms=(($e,We)=>({u_depth:new l.Uniform1i($e,We.u_depth),u_terrain:new l.Uniform1i($e,We.u_terrain),u_terrain_dim:new l.Uniform1f($e,We.u_terrain_dim),u_terrain_matrix:new l.UniformMatrix4f($e,We.u_terrain_matrix),u_terrain_unpack:new l.Uniform4f($e,We.u_terrain_unpack),u_terrain_exaggeration:new l.Uniform1f($e,We.u_terrain_exaggeration)}))(r,Ne),this.binderUniforms=f?f.getUniforms(r,Ne):[]}draw(r,u,f,g,v,E,T,A,R,D,z,G,Q,J,te,K,ve,Me){const se=r.gl;if(this.failedToCreate)return;if(r.program.set(this.program),r.setDepthMode(f),r.setStencilMode(g),r.setColorMode(v),r.setCullFace(E),A){r.activeTexture.set(se.TEXTURE2),se.bindTexture(se.TEXTURE_2D,A.depthTexture),r.activeTexture.set(se.TEXTURE3),se.bindTexture(se.TEXTURE_2D,A.texture);for(const Ne in this.terrainUniforms)this.terrainUniforms[Ne].set(A[Ne])}for(const Ne in this.fixedUniforms)this.fixedUniforms[Ne].set(T[Ne]);te&&te.setUniforms(r,this.binderUniforms,Q,{zoom:J});let we=0;switch(u){case se.LINES:we=2;break;case se.TRIANGLES:we=3;break;case se.LINE_STRIP:we=1}for(const Ne of G.get()){const $e=Ne.vaos||(Ne.vaos={});($e[R]||($e[R]=new Gl)).bind(r,this,D,te?te.getPaintVertexBuffers():[],z,Ne.vertexOffset,K,ve,Me),se.drawElements(u,Ne.primitiveLength*we,se.UNSIGNED_SHORT,Ne.primitiveOffset*we*2)}}}function ql(_,r,u){const f=1/pe(u,1,r.transform.tileZoom),g=Math.pow(2,u.tileID.overscaledZ),v=u.tileSize*Math.pow(2,r.transform.tileZoom)/g,E=v*(u.tileID.canonical.x+u.tileID.wrap*g),T=v*u.tileID.canonical.y;return{u_image:0,u_texsize:u.imageAtlasTexture.size,u_scale:[f,_.fromScale,_.toScale],u_fade:_.t,u_pixel_coord_upper:[E>>16,T>>16],u_pixel_coord_lower:[65535&E,65535&T]}}const Qo=(_,r,u,f)=>{const g=r.style.light,v=g.properties.get("position"),E=[v.x,v.y,v.z],T=function(){var R=new l.ARRAY_TYPE(9);return l.ARRAY_TYPE!=Float32Array&&(R[1]=0,R[2]=0,R[3]=0,R[5]=0,R[6]=0,R[7]=0),R[0]=1,R[4]=1,R[8]=1,R}();g.properties.get("anchor")==="viewport"&&function(R,D){var z=Math.sin(D),G=Math.cos(D);R[0]=G,R[1]=z,R[2]=0,R[3]=-z,R[4]=G,R[5]=0,R[6]=0,R[7]=0,R[8]=1}(T,-r.transform.angle),function(R,D,z){var G=D[0],Q=D[1],J=D[2];R[0]=G*z[0]+Q*z[3]+J*z[6],R[1]=G*z[1]+Q*z[4]+J*z[7],R[2]=G*z[2]+Q*z[5]+J*z[8]}(E,E,T);const A=g.properties.get("color");return{u_matrix:_,u_lightpos:E,u_lightintensity:g.properties.get("intensity"),u_lightcolor:[A.r,A.g,A.b],u_vertical_gradient:+u,u_opacity:f}},Vm=(_,r,u,f,g,v,E)=>l.extend(Qo(_,r,u,f),ql(v,r,E),{u_height_factor:-Math.pow(2,g.overscaledZ)/E.tileSize/8}),zd=_=>({u_matrix:_}),Hl=(_,r,u,f)=>l.extend(zd(_),ql(u,r,f)),jm=(_,r)=>({u_matrix:_,u_world:r}),Od=(_,r,u,f,g)=>l.extend(Hl(_,r,u,f),{u_world:g}),Gm=(_,r,u,f)=>{const g=_.transform;let v,E;if(f.paint.get("circle-pitch-alignment")==="map"){const T=pe(u,1,g.zoom);v=!0,E=[T,T]}else v=!1,E=g.pixelsToGLUnits;return{u_camera_to_center_distance:g.cameraToCenterDistance,u_scale_with_map:+(f.paint.get("circle-pitch-scale")==="map"),u_matrix:_.translatePosMatrix(r.posMatrix,u,f.paint.get("circle-translate"),f.paint.get("circle-translate-anchor")),u_pitch_with_map:+v,u_device_pixel_ratio:_.pixelRatio,u_extrude_scale:E}},Bd=(_,r,u)=>{const f=pe(u,1,r.zoom),g=Math.pow(2,r.zoom-u.tileID.overscaledZ),v=u.tileID.overscaleFactor();return{u_matrix:_,u_camera_to_center_distance:r.cameraToCenterDistance,u_pixels_to_tile_units:f,u_extrude_scale:[r.pixelsToGLUnits[0]/(f*g),r.pixelsToGLUnits[1]/(f*g)],u_overscale_factor:v}},Fd=(_,r,u=1)=>({u_matrix:_,u_color:r,u_overlay:0,u_overlay_scale:u}),Zl=_=>({u_matrix:_}),Nd=(_,r,u,f)=>({u_matrix:_,u_extrude_scale:pe(r,1,u),u_intensity:f});function Ud(_,r){const u=Math.pow(2,r.canonical.z),f=r.canonical.y;return[new l.MercatorCoordinate(0,f/u).toLngLat().lat,new l.MercatorCoordinate(0,(f+1)/u).toLngLat().lat]}const Wl=(_,r,u,f)=>{const g=_.transform;return{u_matrix:el(_,r,u,f),u_ratio:1/pe(r,1,g.zoom),u_device_pixel_ratio:_.pixelRatio,u_units_to_pixels:[1/g.pixelsToGLUnits[0],1/g.pixelsToGLUnits[1]]}},$d=(_,r,u,f,g)=>l.extend(Wl(_,r,u,g),{u_image:0,u_image_height:f}),Sa=(_,r,u,f,g)=>{const v=_.transform,E=Ir(r,v);return{u_matrix:el(_,r,u,g),u_texsize:r.imageAtlasTexture.size,u_ratio:1/pe(r,1,v.zoom),u_device_pixel_ratio:_.pixelRatio,u_image:0,u_scale:[E,f.fromScale,f.toScale],u_fade:f.t,u_units_to_pixels:[1/v.pixelsToGLUnits[0],1/v.pixelsToGLUnits[1]]}},Yl=(_,r,u,f,g,v)=>{const E=_.lineAtlas,T=Ir(r,_.transform),A=u.layout.get("line-cap")==="round",R=E.getDash(f.from,A),D=E.getDash(f.to,A),z=R.width*g.fromScale,G=D.width*g.toScale;return l.extend(Wl(_,r,u,v),{u_patternscale_a:[T/z,-R.height/2],u_patternscale_b:[T/G,-D.height/2],u_sdfgamma:E.width/(256*Math.min(z,G)*_.pixelRatio)/2,u_image:0,u_tex_y_a:R.y,u_tex_y_b:D.y,u_mix:g.t})};function Ir(_,r){return 1/pe(_,1,r.tileZoom)}function el(_,r,u,f){return _.translatePosMatrix(f?f.posMatrix:r.tileID.posMatrix,r,u.paint.get("line-translate"),u.paint.get("line-translate-anchor"))}const Xl=(_,r,u,f,g)=>{return{u_matrix:_,u_tl_parent:r,u_scale_parent:u,u_buffer_scale:1,u_fade_t:f.mix,u_opacity:f.opacity*g.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:g.paint.get("raster-brightness-min"),u_brightness_high:g.paint.get("raster-brightness-max"),u_saturation_factor:(E=g.paint.get("raster-saturation"),E>0?1-1/(1.001-E):-E),u_contrast_factor:(v=g.paint.get("raster-contrast"),v>0?1/(1-v):1+v),u_spin_weights:tl(g.paint.get("raster-hue-rotate"))};var v,E};function tl(_){_*=Math.PI/180;const r=Math.sin(_),u=Math.cos(_);return[(2*u+1)/3,(-Math.sqrt(3)*r-u+1)/3,(Math.sqrt(3)*r-u+1)/3]}const nl=(_,r,u,f,g,v,E,T,A,R)=>{const D=g.transform;return{u_is_size_zoom_constant:+(_==="constant"||_==="source"),u_is_size_feature_constant:+(_==="constant"||_==="camera"),u_size_t:r?r.uSizeT:0,u_size:r?r.uSize:0,u_camera_to_center_distance:D.cameraToCenterDistance,u_pitch:D.pitch/360*2*Math.PI,u_rotate_symbol:+u,u_aspect_ratio:D.width/D.height,u_fade_change:g.options.fadeDuration?g.symbolFadeChange:1,u_matrix:v,u_label_plane_matrix:E,u_coord_matrix:T,u_is_text:+A,u_pitch_with_map:+f,u_texsize:R,u_texture:0}},il=(_,r,u,f,g,v,E,T,A,R,D)=>{const z=g.transform;return l.extend(nl(_,r,u,f,g,v,E,T,A,R),{u_gamma_scale:f?Math.cos(z._pitch)*z.cameraToCenterDistance:1,u_device_pixel_ratio:g.pixelRatio,u_is_halo:+D})},rl=(_,r,u,f,g,v,E,T,A,R)=>l.extend(il(_,r,u,f,g,v,E,T,!0,A,!0),{u_texsize_icon:R,u_texture_icon:1}),Ea=(_,r,u)=>({u_matrix:_,u_opacity:r,u_color:u}),Kl=(_,r,u,f,g,v)=>l.extend(function(E,T,A,R){const D=A.imageManager.getPattern(E.from.toString()),z=A.imageManager.getPattern(E.to.toString()),{width:G,height:Q}=A.imageManager.getPixelSize(),J=Math.pow(2,R.tileID.overscaledZ),te=R.tileSize*Math.pow(2,A.transform.tileZoom)/J,K=te*(R.tileID.canonical.x+R.tileID.wrap*J),ve=te*R.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:D.tl,u_pattern_br_a:D.br,u_pattern_tl_b:z.tl,u_pattern_br_b:z.br,u_texsize:[G,Q],u_mix:T.t,u_pattern_size_a:D.displaySize,u_pattern_size_b:z.displaySize,u_scale_a:T.fromScale,u_scale_b:T.toScale,u_tile_units_to_pixels:1/pe(R,1,A.transform.tileZoom),u_pixel_coord_upper:[K>>16,ve>>16],u_pixel_coord_lower:[65535&K,65535&ve]}}(f,v,u,g),{u_matrix:_,u_opacity:r}),kr={fillExtrusion:(_,r)=>({u_matrix:new l.UniformMatrix4f(_,r.u_matrix),u_lightpos:new l.Uniform3f(_,r.u_lightpos),u_lightintensity:new l.Uniform1f(_,r.u_lightintensity),u_lightcolor:new l.Uniform3f(_,r.u_lightcolor),u_vertical_gradient:new l.Uniform1f(_,r.u_vertical_gradient),u_opacity:new l.Uniform1f(_,r.u_opacity)}),fillExtrusionPattern:(_,r)=>({u_matrix:new l.UniformMatrix4f(_,r.u_matrix),u_lightpos:new l.Uniform3f(_,r.u_lightpos),u_lightintensity:new l.Uniform1f(_,r.u_lightintensity),u_lightcolor:new l.Uniform3f(_,r.u_lightcolor),u_vertical_gradient:new l.Uniform1f(_,r.u_vertical_gradient),u_height_factor:new l.Uniform1f(_,r.u_height_factor),u_image:new l.Uniform1i(_,r.u_image),u_texsize:new l.Uniform2f(_,r.u_texsize),u_pixel_coord_upper:new l.Uniform2f(_,r.u_pixel_coord_upper),u_pixel_coord_lower:new l.Uniform2f(_,r.u_pixel_coord_lower),u_scale:new l.Uniform3f(_,r.u_scale),u_fade:new l.Uniform1f(_,r.u_fade),u_opacity:new l.Uniform1f(_,r.u_opacity)}),fill:(_,r)=>({u_matrix:new l.UniformMatrix4f(_,r.u_matrix)}),fillPattern:(_,r)=>({u_matrix:new l.UniformMatrix4f(_,r.u_matrix),u_image:new l.Uniform1i(_,r.u_image),u_texsize:new l.Uniform2f(_,r.u_texsize),u_pixel_coord_upper:new l.Uniform2f(_,r.u_pixel_coord_upper),u_pixel_coord_lower:new l.Uniform2f(_,r.u_pixel_coord_lower),u_scale:new l.Uniform3f(_,r.u_scale),u_fade:new l.Uniform1f(_,r.u_fade)}),fillOutline:(_,r)=>({u_matrix:new l.UniformMatrix4f(_,r.u_matrix),u_world:new l.Uniform2f(_,r.u_world)}),fillOutlinePattern:(_,r)=>({u_matrix:new l.UniformMatrix4f(_,r.u_matrix),u_world:new l.Uniform2f(_,r.u_world),u_image:new l.Uniform1i(_,r.u_image),u_texsize:new l.Uniform2f(_,r.u_texsize),u_pixel_coord_upper:new l.Uniform2f(_,r.u_pixel_coord_upper),u_pixel_coord_lower:new l.Uniform2f(_,r.u_pixel_coord_lower),u_scale:new l.Uniform3f(_,r.u_scale),u_fade:new l.Uniform1f(_,r.u_fade)}),circle:(_,r)=>({u_camera_to_center_distance:new l.Uniform1f(_,r.u_camera_to_center_distance),u_scale_with_map:new l.Uniform1i(_,r.u_scale_with_map),u_pitch_with_map:new l.Uniform1i(_,r.u_pitch_with_map),u_extrude_scale:new l.Uniform2f(_,r.u_extrude_scale),u_device_pixel_ratio:new l.Uniform1f(_,r.u_device_pixel_ratio),u_matrix:new l.UniformMatrix4f(_,r.u_matrix)}),collisionBox:(_,r)=>({u_matrix:new l.UniformMatrix4f(_,r.u_matrix),u_camera_to_center_distance:new l.Uniform1f(_,r.u_camera_to_center_distance),u_pixels_to_tile_units:new l.Uniform1f(_,r.u_pixels_to_tile_units),u_extrude_scale:new l.Uniform2f(_,r.u_extrude_scale),u_overscale_factor:new l.Uniform1f(_,r.u_overscale_factor)}),collisionCircle:(_,r)=>({u_matrix:new l.UniformMatrix4f(_,r.u_matrix),u_inv_matrix:new l.UniformMatrix4f(_,r.u_inv_matrix),u_camera_to_center_distance:new l.Uniform1f(_,r.u_camera_to_center_distance),u_viewport_size:new l.Uniform2f(_,r.u_viewport_size)}),debug:(_,r)=>({u_color:new l.UniformColor(_,r.u_color),u_matrix:new l.UniformMatrix4f(_,r.u_matrix),u_overlay:new l.Uniform1i(_,r.u_overlay),u_overlay_scale:new l.Uniform1f(_,r.u_overlay_scale)}),clippingMask:(_,r)=>({u_matrix:new l.UniformMatrix4f(_,r.u_matrix)}),heatmap:(_,r)=>({u_extrude_scale:new l.Uniform1f(_,r.u_extrude_scale),u_intensity:new l.Uniform1f(_,r.u_intensity),u_matrix:new l.UniformMatrix4f(_,r.u_matrix)}),heatmapTexture:(_,r)=>({u_matrix:new l.UniformMatrix4f(_,r.u_matrix),u_world:new l.Uniform2f(_,r.u_world),u_image:new l.Uniform1i(_,r.u_image),u_color_ramp:new l.Uniform1i(_,r.u_color_ramp),u_opacity:new l.Uniform1f(_,r.u_opacity)}),hillshade:(_,r)=>({u_matrix:new l.UniformMatrix4f(_,r.u_matrix),u_image:new l.Uniform1i(_,r.u_image),u_latrange:new l.Uniform2f(_,r.u_latrange),u_light:new l.Uniform2f(_,r.u_light),u_shadow:new l.UniformColor(_,r.u_shadow),u_highlight:new l.UniformColor(_,r.u_highlight),u_accent:new l.UniformColor(_,r.u_accent)}),hillshadePrepare:(_,r)=>({u_matrix:new l.UniformMatrix4f(_,r.u_matrix),u_image:new l.Uniform1i(_,r.u_image),u_dimension:new l.Uniform2f(_,r.u_dimension),u_zoom:new l.Uniform1f(_,r.u_zoom),u_unpack:new l.Uniform4f(_,r.u_unpack)}),line:(_,r)=>({u_matrix:new l.UniformMatrix4f(_,r.u_matrix),u_ratio:new l.Uniform1f(_,r.u_ratio),u_device_pixel_ratio:new l.Uniform1f(_,r.u_device_pixel_ratio),u_units_to_pixels:new l.Uniform2f(_,r.u_units_to_pixels)}),lineGradient:(_,r)=>({u_matrix:new l.UniformMatrix4f(_,r.u_matrix),u_ratio:new l.Uniform1f(_,r.u_ratio),u_device_pixel_ratio:new l.Uniform1f(_,r.u_device_pixel_ratio),u_units_to_pixels:new l.Uniform2f(_,r.u_units_to_pixels),u_image:new l.Uniform1i(_,r.u_image),u_image_height:new l.Uniform1f(_,r.u_image_height)}),linePattern:(_,r)=>({u_matrix:new l.UniformMatrix4f(_,r.u_matrix),u_texsize:new l.Uniform2f(_,r.u_texsize),u_ratio:new l.Uniform1f(_,r.u_ratio),u_device_pixel_ratio:new l.Uniform1f(_,r.u_device_pixel_ratio),u_image:new l.Uniform1i(_,r.u_image),u_units_to_pixels:new l.Uniform2f(_,r.u_units_to_pixels),u_scale:new l.Uniform3f(_,r.u_scale),u_fade:new l.Uniform1f(_,r.u_fade)}),lineSDF:(_,r)=>({u_matrix:new l.UniformMatrix4f(_,r.u_matrix),u_ratio:new l.Uniform1f(_,r.u_ratio),u_device_pixel_ratio:new l.Uniform1f(_,r.u_device_pixel_ratio),u_units_to_pixels:new l.Uniform2f(_,r.u_units_to_pixels),u_patternscale_a:new l.Uniform2f(_,r.u_patternscale_a),u_patternscale_b:new l.Uniform2f(_,r.u_patternscale_b),u_sdfgamma:new l.Uniform1f(_,r.u_sdfgamma),u_image:new l.Uniform1i(_,r.u_image),u_tex_y_a:new l.Uniform1f(_,r.u_tex_y_a),u_tex_y_b:new l.Uniform1f(_,r.u_tex_y_b),u_mix:new l.Uniform1f(_,r.u_mix)}),raster:(_,r)=>({u_matrix:new l.UniformMatrix4f(_,r.u_matrix),u_tl_parent:new l.Uniform2f(_,r.u_tl_parent),u_scale_parent:new l.Uniform1f(_,r.u_scale_parent),u_buffer_scale:new l.Uniform1f(_,r.u_buffer_scale),u_fade_t:new l.Uniform1f(_,r.u_fade_t),u_opacity:new l.Uniform1f(_,r.u_opacity),u_image0:new l.Uniform1i(_,r.u_image0),u_image1:new l.Uniform1i(_,r.u_image1),u_brightness_low:new l.Uniform1f(_,r.u_brightness_low),u_brightness_high:new l.Uniform1f(_,r.u_brightness_high),u_saturation_factor:new l.Uniform1f(_,r.u_saturation_factor),u_contrast_factor:new l.Uniform1f(_,r.u_contrast_factor),u_spin_weights:new l.Uniform3f(_,r.u_spin_weights)}),symbolIcon:(_,r)=>({u_is_size_zoom_constant:new l.Uniform1i(_,r.u_is_size_zoom_constant),u_is_size_feature_constant:new l.Uniform1i(_,r.u_is_size_feature_constant),u_size_t:new l.Uniform1f(_,r.u_size_t),u_size:new l.Uniform1f(_,r.u_size),u_camera_to_center_distance:new l.Uniform1f(_,r.u_camera_to_center_distance),u_pitch:new l.Uniform1f(_,r.u_pitch),u_rotate_symbol:new l.Uniform1i(_,r.u_rotate_symbol),u_aspect_ratio:new l.Uniform1f(_,r.u_aspect_ratio),u_fade_change:new l.Uniform1f(_,r.u_fade_change),u_matrix:new l.UniformMatrix4f(_,r.u_matrix),u_label_plane_matrix:new l.UniformMatrix4f(_,r.u_label_plane_matrix),u_coord_matrix:new l.UniformMatrix4f(_,r.u_coord_matrix),u_is_text:new l.Uniform1i(_,r.u_is_text),u_pitch_with_map:new l.Uniform1i(_,r.u_pitch_with_map),u_texsize:new l.Uniform2f(_,r.u_texsize),u_texture:new l.Uniform1i(_,r.u_texture)}),symbolSDF:(_,r)=>({u_is_size_zoom_constant:new l.Uniform1i(_,r.u_is_size_zoom_constant),u_is_size_feature_constant:new l.Uniform1i(_,r.u_is_size_feature_constant),u_size_t:new l.Uniform1f(_,r.u_size_t),u_size:new l.Uniform1f(_,r.u_size),u_camera_to_center_distance:new l.Uniform1f(_,r.u_camera_to_center_distance),u_pitch:new l.Uniform1f(_,r.u_pitch),u_rotate_symbol:new l.Uniform1i(_,r.u_rotate_symbol),u_aspect_ratio:new l.Uniform1f(_,r.u_aspect_ratio),u_fade_change:new l.Uniform1f(_,r.u_fade_change),u_matrix:new l.UniformMatrix4f(_,r.u_matrix),u_label_plane_matrix:new l.UniformMatrix4f(_,r.u_label_plane_matrix),u_coord_matrix:new l.UniformMatrix4f(_,r.u_coord_matrix),u_is_text:new l.Uniform1i(_,r.u_is_text),u_pitch_with_map:new l.Uniform1i(_,r.u_pitch_with_map),u_texsize:new l.Uniform2f(_,r.u_texsize),u_texture:new l.Uniform1i(_,r.u_texture),u_gamma_scale:new l.Uniform1f(_,r.u_gamma_scale),u_device_pixel_ratio:new l.Uniform1f(_,r.u_device_pixel_ratio),u_is_halo:new l.Uniform1i(_,r.u_is_halo)}),symbolTextAndIcon:(_,r)=>({u_is_size_zoom_constant:new l.Uniform1i(_,r.u_is_size_zoom_constant),u_is_size_feature_constant:new l.Uniform1i(_,r.u_is_size_feature_constant),u_size_t:new l.Uniform1f(_,r.u_size_t),u_size:new l.Uniform1f(_,r.u_size),u_camera_to_center_distance:new l.Uniform1f(_,r.u_camera_to_center_distance),u_pitch:new l.Uniform1f(_,r.u_pitch),u_rotate_symbol:new l.Uniform1i(_,r.u_rotate_symbol),u_aspect_ratio:new l.Uniform1f(_,r.u_aspect_ratio),u_fade_change:new l.Uniform1f(_,r.u_fade_change),u_matrix:new l.UniformMatrix4f(_,r.u_matrix),u_label_plane_matrix:new l.UniformMatrix4f(_,r.u_label_plane_matrix),u_coord_matrix:new l.UniformMatrix4f(_,r.u_coord_matrix),u_is_text:new l.Uniform1i(_,r.u_is_text),u_pitch_with_map:new l.Uniform1i(_,r.u_pitch_with_map),u_texsize:new l.Uniform2f(_,r.u_texsize),u_texsize_icon:new l.Uniform2f(_,r.u_texsize_icon),u_texture:new l.Uniform1i(_,r.u_texture),u_texture_icon:new l.Uniform1i(_,r.u_texture_icon),u_gamma_scale:new l.Uniform1f(_,r.u_gamma_scale),u_device_pixel_ratio:new l.Uniform1f(_,r.u_device_pixel_ratio),u_is_halo:new l.Uniform1i(_,r.u_is_halo)}),background:(_,r)=>({u_matrix:new l.UniformMatrix4f(_,r.u_matrix),u_opacity:new l.Uniform1f(_,r.u_opacity),u_color:new l.UniformColor(_,r.u_color)}),backgroundPattern:(_,r)=>({u_matrix:new l.UniformMatrix4f(_,r.u_matrix),u_opacity:new l.Uniform1f(_,r.u_opacity),u_image:new l.Uniform1i(_,r.u_image),u_pattern_tl_a:new l.Uniform2f(_,r.u_pattern_tl_a),u_pattern_br_a:new l.Uniform2f(_,r.u_pattern_br_a),u_pattern_tl_b:new l.Uniform2f(_,r.u_pattern_tl_b),u_pattern_br_b:new l.Uniform2f(_,r.u_pattern_br_b),u_texsize:new l.Uniform2f(_,r.u_texsize),u_mix:new l.Uniform1f(_,r.u_mix),u_pattern_size_a:new l.Uniform2f(_,r.u_pattern_size_a),u_pattern_size_b:new l.Uniform2f(_,r.u_pattern_size_b),u_scale_a:new l.Uniform1f(_,r.u_scale_a),u_scale_b:new l.Uniform1f(_,r.u_scale_b),u_pixel_coord_upper:new l.Uniform2f(_,r.u_pixel_coord_upper),u_pixel_coord_lower:new l.Uniform2f(_,r.u_pixel_coord_lower),u_tile_units_to_pixels:new l.Uniform1f(_,r.u_tile_units_to_pixels)}),terrain:(_,r)=>({u_matrix:new l.UniformMatrix4f(_,r.u_matrix),u_texture:new l.Uniform1i(_,r.u_texture),u_ele_delta:new l.Uniform1f(_,r.u_ele_delta)}),terrainDepth:(_,r)=>({u_matrix:new l.UniformMatrix4f(_,r.u_matrix),u_ele_delta:new l.Uniform1f(_,r.u_ele_delta)}),terrainCoords:(_,r)=>({u_matrix:new l.UniformMatrix4f(_,r.u_matrix),u_texture:new l.Uniform1i(_,r.u_texture),u_terrain_coords_id:new l.Uniform1f(_,r.u_terrain_coords_id),u_ele_delta:new l.Uniform1f(_,r.u_ele_delta)})};class Ar{constructor(r,u,f){this.context=r;const g=r.gl;this.buffer=g.createBuffer(),this.dynamicDraw=!!f,this.context.unbindVAO(),r.bindElementBuffer.set(this.buffer),g.bufferData(g.ELEMENT_ARRAY_BUFFER,u.arrayBuffer,this.dynamicDraw?g.DYNAMIC_DRAW:g.STATIC_DRAW),this.dynamicDraw||delete u.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(r){const u=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),u.bufferSubData(u.ELEMENT_ARRAY_BUFFER,0,r.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const ku={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class Jl{constructor(r,u,f,g){this.length=u.length,this.attributes=f,this.itemSize=u.bytesPerElement,this.dynamicDraw=g,this.context=r;const v=r.gl;this.buffer=v.createBuffer(),r.bindVertexBuffer.set(this.buffer),v.bufferData(v.ARRAY_BUFFER,u.arrayBuffer,this.dynamicDraw?v.DYNAMIC_DRAW:v.STATIC_DRAW),this.dynamicDraw||delete u.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(r){if(r.length!==this.length)throw new Error(`Length of new data is ${r.length}, which doesn't match current length of ${this.length}`);const u=this.context.gl;this.bind(),u.bufferSubData(u.ARRAY_BUFFER,0,r.arrayBuffer)}enableAttributes(r,u){for(let f=0;f<this.attributes.length;f++){const g=u.attributes[this.attributes[f].name];g!==void 0&&r.enableVertexAttribArray(g)}}setVertexAttribPointers(r,u,f){for(let g=0;g<this.attributes.length;g++){const v=this.attributes[g],E=u.attributes[v.name];E!==void 0&&r.vertexAttribPointer(E,v.components,r[ku[v.type]],!1,this.itemSize,v.offset+this.itemSize*(f||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const ro=new WeakMap;function so(_){if(ro.has(_))return ro.get(_);{const r=_.getParameter(_.VERSION).startsWith("WebGL 2.0");return ro.set(_,r),r}}class xn{constructor(r){this.gl=r.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(r){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class Ql extends xn{getDefault(){return l.Color.transparent}set(r){const u=this.current;(r.r!==u.r||r.g!==u.g||r.b!==u.b||r.a!==u.a||this.dirty)&&(this.gl.clearColor(r.r,r.g,r.b,r.a),this.current=r,this.dirty=!1)}}class Au extends xn{getDefault(){return 1}set(r){(r!==this.current||this.dirty)&&(this.gl.clearDepth(r),this.current=r,this.dirty=!1)}}class Pu extends xn{getDefault(){return 0}set(r){(r!==this.current||this.dirty)&&(this.gl.clearStencil(r),this.current=r,this.dirty=!1)}}class ec extends xn{getDefault(){return[!0,!0,!0,!0]}set(r){const u=this.current;(r[0]!==u[0]||r[1]!==u[1]||r[2]!==u[2]||r[3]!==u[3]||this.dirty)&&(this.gl.colorMask(r[0],r[1],r[2],r[3]),this.current=r,this.dirty=!1)}}class Vd extends xn{getDefault(){return!0}set(r){(r!==this.current||this.dirty)&&(this.gl.depthMask(r),this.current=r,this.dirty=!1)}}class jd extends xn{getDefault(){return 255}set(r){(r!==this.current||this.dirty)&&(this.gl.stencilMask(r),this.current=r,this.dirty=!1)}}class ao extends xn{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(r){const u=this.current;(r.func!==u.func||r.ref!==u.ref||r.mask!==u.mask||this.dirty)&&(this.gl.stencilFunc(r.func,r.ref,r.mask),this.current=r,this.dirty=!1)}}class qm extends xn{getDefault(){const r=this.gl;return[r.KEEP,r.KEEP,r.KEEP]}set(r){const u=this.current;(r[0]!==u[0]||r[1]!==u[1]||r[2]!==u[2]||this.dirty)&&(this.gl.stencilOp(r[0],r[1],r[2]),this.current=r,this.dirty=!1)}}class Hm extends xn{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const u=this.gl;r?u.enable(u.STENCIL_TEST):u.disable(u.STENCIL_TEST),this.current=r,this.dirty=!1}}class Zm extends xn{getDefault(){return[0,1]}set(r){const u=this.current;(r[0]!==u[0]||r[1]!==u[1]||this.dirty)&&(this.gl.depthRange(r[0],r[1]),this.current=r,this.dirty=!1)}}class Wm extends xn{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const u=this.gl;r?u.enable(u.DEPTH_TEST):u.disable(u.DEPTH_TEST),this.current=r,this.dirty=!1}}class Ym extends xn{getDefault(){return this.gl.LESS}set(r){(r!==this.current||this.dirty)&&(this.gl.depthFunc(r),this.current=r,this.dirty=!1)}}class Xm extends xn{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const u=this.gl;r?u.enable(u.BLEND):u.disable(u.BLEND),this.current=r,this.dirty=!1}}class Ru extends xn{getDefault(){const r=this.gl;return[r.ONE,r.ZERO]}set(r){const u=this.current;(r[0]!==u[0]||r[1]!==u[1]||this.dirty)&&(this.gl.blendFunc(r[0],r[1]),this.current=r,this.dirty=!1)}}class tc extends xn{getDefault(){return l.Color.transparent}set(r){const u=this.current;(r.r!==u.r||r.g!==u.g||r.b!==u.b||r.a!==u.a||this.dirty)&&(this.gl.blendColor(r.r,r.g,r.b,r.a),this.current=r,this.dirty=!1)}}class Mu extends xn{getDefault(){return this.gl.FUNC_ADD}set(r){(r!==this.current||this.dirty)&&(this.gl.blendEquation(r),this.current=r,this.dirty=!1)}}class Du extends xn{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const u=this.gl;r?u.enable(u.CULL_FACE):u.disable(u.CULL_FACE),this.current=r,this.dirty=!1}}class oo extends xn{getDefault(){return this.gl.BACK}set(r){(r!==this.current||this.dirty)&&(this.gl.cullFace(r),this.current=r,this.dirty=!1)}}class Gd extends xn{getDefault(){return this.gl.CCW}set(r){(r!==this.current||this.dirty)&&(this.gl.frontFace(r),this.current=r,this.dirty=!1)}}class qd extends xn{getDefault(){return null}set(r){(r!==this.current||this.dirty)&&(this.gl.useProgram(r),this.current=r,this.dirty=!1)}}class Lu extends xn{getDefault(){return this.gl.TEXTURE0}set(r){(r!==this.current||this.dirty)&&(this.gl.activeTexture(r),this.current=r,this.dirty=!1)}}class Ta extends xn{getDefault(){const r=this.gl;return[0,0,r.drawingBufferWidth,r.drawingBufferHeight]}set(r){const u=this.current;(r[0]!==u[0]||r[1]!==u[1]||r[2]!==u[2]||r[3]!==u[3]||this.dirty)&&(this.gl.viewport(r[0],r[1],r[2],r[3]),this.current=r,this.dirty=!1)}}class Hd extends xn{getDefault(){return null}set(r){if(r===this.current&&!this.dirty)return;const u=this.gl;u.bindFramebuffer(u.FRAMEBUFFER,r),this.current=r,this.dirty=!1}}class lo extends xn{getDefault(){return null}set(r){if(r===this.current&&!this.dirty)return;const u=this.gl;u.bindRenderbuffer(u.RENDERBUFFER,r),this.current=r,this.dirty=!1}}class co extends xn{getDefault(){return null}set(r){if(r===this.current&&!this.dirty)return;const u=this.gl;u.bindTexture(u.TEXTURE_2D,r),this.current=r,this.dirty=!1}}class Zd extends xn{getDefault(){return null}set(r){if(r===this.current&&!this.dirty)return;const u=this.gl;u.bindBuffer(u.ARRAY_BUFFER,r),this.current=r,this.dirty=!1}}class zu extends xn{getDefault(){return null}set(r){const u=this.gl;u.bindBuffer(u.ELEMENT_ARRAY_BUFFER,r),this.current=r,this.dirty=!1}}class Cn extends xn{getDefault(){return null}set(r){var u;if(r===this.current&&!this.dirty)return;const f=this.gl;so(f)?f.bindVertexArray(r):(u=f.getExtension("OES_vertex_array_object"))===null||u===void 0||u.bindVertexArrayOES(r),this.current=r,this.dirty=!1}}class nc extends xn{getDefault(){return 4}set(r){if(r===this.current&&!this.dirty)return;const u=this.gl;u.pixelStorei(u.UNPACK_ALIGNMENT,r),this.current=r,this.dirty=!1}}class Km extends xn{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const u=this.gl;u.pixelStorei(u.UNPACK_PREMULTIPLY_ALPHA_WEBGL,r),this.current=r,this.dirty=!1}}class Wd extends xn{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const u=this.gl;u.pixelStorei(u.UNPACK_FLIP_Y_WEBGL,r),this.current=r,this.dirty=!1}}class Ca extends xn{constructor(r,u){super(r),this.context=r,this.parent=u}getDefault(){return null}}class Jm extends Ca{setDirty(){this.dirty=!0}set(r){if(r===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const u=this.gl;u.framebufferTexture2D(u.FRAMEBUFFER,u.COLOR_ATTACHMENT0,u.TEXTURE_2D,r,0),this.current=r,this.dirty=!1}}class Qm extends Ca{set(r){if(r===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const u=this.gl;u.framebufferRenderbuffer(u.FRAMEBUFFER,u.DEPTH_ATTACHMENT,u.RENDERBUFFER,r),this.current=r,this.dirty=!1}}class Yd extends Ca{set(r){if(r===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const u=this.gl;u.framebufferRenderbuffer(u.FRAMEBUFFER,u.DEPTH_STENCIL_ATTACHMENT,u.RENDERBUFFER,r),this.current=r,this.dirty=!1}}class eg{constructor(r,u,f,g,v){this.context=r,this.width=u,this.height=f;const E=r.gl,T=this.framebuffer=E.createFramebuffer();if(this.colorAttachment=new Jm(r,T),g)this.depthAttachment=v?new Yd(r,T):new Qm(r,T);else if(v)throw new Error("Stencil cannot be setted without depth");if(E.checkFramebufferStatus(E.FRAMEBUFFER)!==E.FRAMEBUFFER_COMPLETE)throw new Error("Framebuffer is not complete")}destroy(){const r=this.context.gl,u=this.colorAttachment.get();if(u&&r.deleteTexture(u),this.depthAttachment){const f=this.depthAttachment.get();f&&r.deleteRenderbuffer(f)}r.deleteFramebuffer(this.framebuffer)}}class ni{constructor(r,u,f){this.blendFunction=r,this.blendColor=u,this.mask=f}}ni.Replace=[1,0],ni.disabled=new ni(ni.Replace,l.Color.transparent,[!1,!1,!1,!1]),ni.unblended=new ni(ni.Replace,l.Color.transparent,[!0,!0,!0,!0]),ni.alphaBlended=new ni([1,771],l.Color.transparent,[!0,!0,!0,!0]);class ic{constructor(r){var u,f;if(this.gl=r,this.clearColor=new Ql(this),this.clearDepth=new Au(this),this.clearStencil=new Pu(this),this.colorMask=new ec(this),this.depthMask=new Vd(this),this.stencilMask=new jd(this),this.stencilFunc=new ao(this),this.stencilOp=new qm(this),this.stencilTest=new Hm(this),this.depthRange=new Zm(this),this.depthTest=new Wm(this),this.depthFunc=new Ym(this),this.blend=new Xm(this),this.blendFunc=new Ru(this),this.blendColor=new tc(this),this.blendEquation=new Mu(this),this.cullFace=new Du(this),this.cullFaceSide=new oo(this),this.frontFace=new Gd(this),this.program=new qd(this),this.activeTexture=new Lu(this),this.viewport=new Ta(this),this.bindFramebuffer=new Hd(this),this.bindRenderbuffer=new lo(this),this.bindTexture=new co(this),this.bindVertexBuffer=new Zd(this),this.bindElementBuffer=new zu(this),this.bindVertexArray=new Cn(this),this.pixelStoreUnpack=new nc(this),this.pixelStoreUnpackPremultiplyAlpha=new Km(this),this.pixelStoreUnpackFlipY=new Wd(this),this.extTextureFilterAnisotropic=r.getExtension("EXT_texture_filter_anisotropic")||r.getExtension("MOZ_EXT_texture_filter_anisotropic")||r.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=r.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.maxTextureSize=r.getParameter(r.MAX_TEXTURE_SIZE),so(r)){this.HALF_FLOAT=r.HALF_FLOAT;const g=r.getExtension("EXT_color_buffer_half_float");this.RGBA16F=(u=r.RGBA16F)!==null&&u!==void 0?u:g==null?void 0:g.RGBA16F_EXT,this.RGB16F=(f=r.RGB16F)!==null&&f!==void 0?f:g==null?void 0:g.RGB16F_EXT,r.getExtension("EXT_color_buffer_float")}else{r.getExtension("EXT_color_buffer_half_float"),r.getExtension("OES_texture_half_float_linear");const g=r.getExtension("OES_texture_half_float");this.HALF_FLOAT=g==null?void 0:g.HALF_FLOAT_OES}}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArray.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(r,u){return new Ar(this,r,u)}createVertexBuffer(r,u,f){return new Jl(this,r,u,f)}createRenderbuffer(r,u,f){const g=this.gl,v=g.createRenderbuffer();return this.bindRenderbuffer.set(v),g.renderbufferStorage(g.RENDERBUFFER,r,u,f),this.bindRenderbuffer.set(null),v}createFramebuffer(r,u,f,g){return new eg(this,r,u,f,g)}clear({color:r,depth:u,stencil:f}){const g=this.gl;let v=0;r&&(v|=g.COLOR_BUFFER_BIT,this.clearColor.set(r),this.colorMask.set([!0,!0,!0,!0])),u!==void 0&&(v|=g.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(u),this.depthMask.set(!0)),f!==void 0&&(v|=g.STENCIL_BUFFER_BIT,this.clearStencil.set(f),this.stencilMask.set(255)),g.clear(v)}setCullFace(r){r.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(r.mode),this.frontFace.set(r.frontFace))}setDepthMode(r){r.func!==this.gl.ALWAYS||r.mask?(this.depthTest.set(!0),this.depthFunc.set(r.func),this.depthMask.set(r.mask),this.depthRange.set(r.range)):this.depthTest.set(!1)}setStencilMode(r){r.test.func!==this.gl.ALWAYS||r.mask?(this.stencilTest.set(!0),this.stencilMask.set(r.mask),this.stencilOp.set([r.fail,r.depthFail,r.pass]),this.stencilFunc.set({func:r.test.func,ref:r.ref,mask:r.test.mask})):this.stencilTest.set(!1)}setColorMode(r){l.deepEqual(r.blendFunction,ni.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(r.blendFunction),this.blendColor.set(r.blendColor)),this.colorMask.set(r.mask)}createVertexArray(){var r;return so(this.gl)?this.gl.createVertexArray():(r=this.gl.getExtension("OES_vertex_array_object"))===null||r===void 0?void 0:r.createVertexArrayOES()}deleteVertexArray(r){var u;return so(this.gl)?this.gl.deleteVertexArray(r):(u=this.gl.getExtension("OES_vertex_array_object"))===null||u===void 0?void 0:u.deleteVertexArrayOES(r)}unbindVAO(){this.bindVertexArray.set(null)}}class ln{constructor(r,u,f){this.func=r,this.mask=u,this.range=f}}ln.ReadOnly=!1,ln.ReadWrite=!0,ln.disabled=new ln(519,ln.ReadOnly,[0,1]);const sl=7680;class $n{constructor(r,u,f,g,v,E){this.test=r,this.ref=u,this.mask=f,this.fail=g,this.depthFail=v,this.pass=E}}$n.disabled=new $n({func:519,mask:0},0,0,sl,sl,sl);class Vn{constructor(r,u,f){this.enable=r,this.mode=u,this.frontFace=f}}let Ia;function al(_,r,u,f,g,v,E){const T=_.context,A=T.gl,R=_.useProgram("collisionBox"),D=[];let z=0,G=0;for(let se=0;se<f.length;se++){const we=f[se],Ne=r.getTile(we),$e=Ne.getBucket(u);if(!$e)continue;let We=we.posMatrix;g[0]===0&&g[1]===0||(We=_.translatePosMatrix(we.posMatrix,Ne,g,v));const ot=E?$e.textCollisionBox:$e.iconCollisionBox,Je=$e.collisionCircleArray;if(Je.length>0){const dt=l.create(),Mt=We;l.mul(dt,$e.placementInvProjMatrix,_.transform.glCoordMatrix),l.mul(dt,dt,$e.placementViewportMatrix),D.push({circleArray:Je,circleOffset:G,transform:Mt,invTransform:dt,coord:we}),z+=Je.length/4,G=z}ot&&R.draw(T,A.LINES,ln.disabled,$n.disabled,_.colorModeForRenderPass(),Vn.disabled,Bd(We,_.transform,Ne),_.style.map.terrain&&_.style.map.terrain.getTerrainData(we),u.id,ot.layoutVertexBuffer,ot.indexBuffer,ot.segments,null,_.transform.zoom,null,null,ot.collisionVertexBuffer)}if(!E||!D.length)return;const Q=_.useProgram("collisionCircle"),J=new l.CollisionCircleLayoutArray;J.resize(4*z),J._trim();let te=0;for(const se of D)for(let we=0;we<se.circleArray.length/4;we++){const Ne=4*we,$e=se.circleArray[Ne+0],We=se.circleArray[Ne+1],ot=se.circleArray[Ne+2],Je=se.circleArray[Ne+3];J.emplace(te++,$e,We,ot,Je,0),J.emplace(te++,$e,We,ot,Je,1),J.emplace(te++,$e,We,ot,Je,2),J.emplace(te++,$e,We,ot,Je,3)}(!Ia||Ia.length<2*z)&&(Ia=function(se){const we=2*se,Ne=new l.QuadTriangleArray;Ne.resize(we),Ne._trim();for(let $e=0;$e<we;$e++){const We=6*$e;Ne.uint16[We+0]=4*$e+0,Ne.uint16[We+1]=4*$e+1,Ne.uint16[We+2]=4*$e+2,Ne.uint16[We+3]=4*$e+2,Ne.uint16[We+4]=4*$e+3,Ne.uint16[We+5]=4*$e+0}return Ne}(z));const K=T.createIndexBuffer(Ia,!0),ve=T.createVertexBuffer(J,l.collisionCircleLayout.members,!0);for(const se of D){const we={u_matrix:se.transform,u_inv_matrix:se.invTransform,u_camera_to_center_distance:(Me=_.transform).cameraToCenterDistance,u_viewport_size:[Me.width,Me.height]};Q.draw(T,A.TRIANGLES,ln.disabled,$n.disabled,_.colorModeForRenderPass(),Vn.disabled,we,_.style.map.terrain&&_.style.map.terrain.getTerrainData(se.coord),u.id,ve,K,l.SegmentVector.simpleSegment(0,2*se.circleOffset,se.circleArray.length,se.circleArray.length/2),null,_.transform.zoom,null,null,null)}var Me;ve.destroy(),K.destroy()}Vn.disabled=new Vn(!1,1029,2305),Vn.backCCW=new Vn(!0,1029,2305);const Ou=l.identity(new Float32Array(16));function tg(_,r,u,f,g,v){const{horizontalAlign:E,verticalAlign:T}=l.getAnchorAlignment(_);return new l.Point((-(E-.5)*r/g+f[0])*v,(-(T-.5)*u/g+f[1])*v)}function Bu(_,r,u,f,g,v,E,T,A,R,D){const z=_.text.placedSymbolArray,G=_.text.dynamicLayoutVertexArray,Q=_.icon.dynamicLayoutVertexArray,J={};G.clear();for(let te=0;te<z.length;te++){const K=z.get(te),ve=K.hidden||!K.crossTileID||_.allowVerticalPlacement&&!K.placedOrientation?null:f[K.crossTileID];if(ve){const Me=new l.Point(K.anchorX,K.anchorY),se=It(Me,u?E:v,D),we=Hn(g.cameraToCenterDistance,se.signedDistanceFromCamera);let Ne=l.evaluateSizeForFeature(_.textSizeData,A,K)*we/l.ONE_EM;u&&(Ne*=_.tilePixelRatio/T);const{width:$e,height:We,anchor:ot,textOffset:Je,textBoxScale:dt}=ve,Mt=tg(ot,$e,We,Je,dt,Ne),cn=u?It(Me.add(Mt),v,D).point:se.point.add(r?Mt.rotate(-g.angle):Mt),_t=_.allowVerticalPlacement&&K.placedOrientation===l.WritingMode.vertical?Math.PI/2:0;for(let Ht=0;Ht<K.numGlyphs;Ht++)l.addDynamicAttributes(G,cn,_t);R&&K.associatedIconIndex>=0&&(J[K.associatedIconIndex]={shiftedAnchor:cn,angle:_t})}else Y(K.numGlyphs,G)}if(R){Q.clear();const te=_.icon.placedSymbolArray;for(let K=0;K<te.length;K++){const ve=te.get(K);if(ve.hidden)Y(ve.numGlyphs,Q);else{const Me=J[K];if(Me)for(let se=0;se<ve.numGlyphs;se++)l.addDynamicAttributes(Q,Me.shiftedAnchor,Me.angle);else Y(ve.numGlyphs,Q)}}_.icon.dynamicLayoutVertexBuffer.updateData(Q)}_.text.dynamicLayoutVertexBuffer.updateData(G)}function ng(_,r,u){return u.iconsInText&&r?"symbolTextAndIcon":_?"symbolSDF":"symbolIcon"}function Fu(_,r,u,f,g,v,E,T,A,R,D,z){const G=_.context,Q=G.gl,J=_.transform,te=T==="map",K=A==="map",ve=T!=="viewport"&&u.layout.get("symbol-placement")!=="point",Me=te&&!K&&!ve,se=!u.layout.get("symbol-sort-key").isConstant();let we=!1;const Ne=_.depthModeForSublayer(0,ln.ReadOnly),$e=u._unevaluatedLayout.hasValue("text-variable-anchor")||u._unevaluatedLayout.hasValue("text-variable-anchor-offset"),We=[];for(const ot of f){const Je=r.getTile(ot),dt=Je.getBucket(u);if(!dt)continue;const Mt=g?dt.text:dt.icon;if(!Mt||!Mt.segments.get().length||!Mt.hasVisibleVertices)continue;const cn=Mt.programConfigurations.get(u.id),_t=g||dt.sdfIcons,Ht=g?dt.textSizeData:dt.iconSizeData,Ct=K||J.pitch!==0,Fn=_.useProgram(ng(_t,g,dt),cn),sn=l.evaluateSizeForZoom(Ht,J.zoom),nn=_.style.map.terrain&&_.style.map.terrain.getTerrainData(ot);let Zt,oi,Rn,ir,Li=[0,0],yi=null;if(g)oi=Je.glyphAtlasTexture,Rn=Q.LINEAR,Zt=Je.glyphAtlasTexture.size,dt.iconsInText&&(Li=Je.imageAtlasTexture.size,yi=Je.imageAtlasTexture,ir=Ct||_.options.rotating||_.options.zooming||Ht.kind==="composite"||Ht.kind==="camera"?Q.LINEAR:Q.NEAREST);else{const wi=u.layout.get("icon-size").constantOr(0)!==1||dt.iconsNeedLinear;oi=Je.imageAtlasTexture,Rn=_t||_.options.rotating||_.options.zooming||wi||Ct?Q.LINEAR:Q.NEAREST,Zt=Je.imageAtlasTexture.size}const pr=pe(Je,1,_.transform.zoom),is=On(ot.posMatrix,K,te,_.transform,pr),Rs=qn(ot.posMatrix,K,te,_.transform,pr),Ms=$e&&dt.hasTextData(),na=u.layout.get("icon-text-fit")!=="none"&&Ms&&dt.hasIconData();if(ve){const wi=_.style.map.terrain?(mr,ri)=>_.style.map.terrain.getElevation(ot,mr,ri):null,Bi=u.layout.get("text-rotation-alignment")==="map";Ys(dt,ot.posMatrix,_,g,is,Rs,K,R,Bi,wi)}const za=_.translatePosMatrix(ot.posMatrix,Je,v,E),ia=ve||g&&$e||na?Ou:is,zi=_.translatePosMatrix(Rs,Je,v,E,!0),li=_t&&u.paint.get(g?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let Oi;Oi=_t?dt.iconsInText?rl(Ht.kind,sn,Me,K,_,za,ia,zi,Zt,Li):il(Ht.kind,sn,Me,K,_,za,ia,zi,g,Zt,!0):nl(Ht.kind,sn,Me,K,_,za,ia,zi,g,Zt);const go={program:Fn,buffers:Mt,uniformValues:Oi,atlasTexture:oi,atlasTextureIcon:yi,atlasInterpolation:Rn,atlasInterpolationIcon:ir,isSDF:_t,hasHalo:li};if(se&&dt.canOverlap){we=!0;const wi=Mt.segments.get();for(const Bi of wi)We.push({segments:new l.SegmentVector([Bi]),sortKey:Bi.sortKey,state:go,terrainData:nn})}else We.push({segments:Mt.segments,sortKey:0,state:go,terrainData:nn})}we&&We.sort((ot,Je)=>ot.sortKey-Je.sortKey);for(const ot of We){const Je=ot.state;if(G.activeTexture.set(Q.TEXTURE0),Je.atlasTexture.bind(Je.atlasInterpolation,Q.CLAMP_TO_EDGE),Je.atlasTextureIcon&&(G.activeTexture.set(Q.TEXTURE1),Je.atlasTextureIcon&&Je.atlasTextureIcon.bind(Je.atlasInterpolationIcon,Q.CLAMP_TO_EDGE)),Je.isSDF){const dt=Je.uniformValues;Je.hasHalo&&(dt.u_is_halo=1,ol(Je.buffers,ot.segments,u,_,Je.program,Ne,D,z,dt,ot.terrainData)),dt.u_is_halo=0}ol(Je.buffers,ot.segments,u,_,Je.program,Ne,D,z,Je.uniformValues,ot.terrainData)}}function ol(_,r,u,f,g,v,E,T,A,R){const D=f.context;g.draw(D,D.gl.TRIANGLES,v,E,T,Vn.disabled,A,R,u.id,_.layoutVertexBuffer,_.indexBuffer,r,u.paint,f.transform.zoom,_.programConfigurations.get(u.id),_.dynamicLayoutVertexBuffer,_.opacityVertexBuffer)}function rc(_,r,u,f,g){if(!u||!f||!f.imageAtlas)return;const v=f.imageAtlas.patternPositions;let E=v[u.to.toString()],T=v[u.from.toString()];if(!E||!T){const A=g.getPaintProperty(r);E=v[A],T=v[A]}E&&T&&_.setConstantPatternPositions(E,T)}function Nu(_,r,u,f,g,v,E){const T=_.context.gl,A="fill-pattern",R=u.paint.get(A),D=R&&R.constantOr(1),z=u.getCrossfadeParameters();let G,Q,J,te,K;E?(Q=D&&!u.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",G=T.LINES):(Q=D?"fillPattern":"fill",G=T.TRIANGLES);const ve=R.constantOr(null);for(const Me of f){const se=r.getTile(Me);if(D&&!se.patternsLoaded())continue;const we=se.getBucket(u);if(!we)continue;const Ne=we.programConfigurations.get(u.id),$e=_.useProgram(Q,Ne),We=_.style.map.terrain&&_.style.map.terrain.getTerrainData(Me);D&&(_.context.activeTexture.set(T.TEXTURE0),se.imageAtlasTexture.bind(T.LINEAR,T.CLAMP_TO_EDGE),Ne.updatePaintBuffers(z)),rc(Ne,A,ve,se,u);const ot=We?Me:null,Je=_.translatePosMatrix(ot?ot.posMatrix:Me.posMatrix,se,u.paint.get("fill-translate"),u.paint.get("fill-translate-anchor"));if(E){te=we.indexBuffer2,K=we.segments2;const dt=[T.drawingBufferWidth,T.drawingBufferHeight];J=Q==="fillOutlinePattern"&&D?Od(Je,_,z,se,dt):jm(Je,dt)}else te=we.indexBuffer,K=we.segments,J=D?Hl(Je,_,z,se):zd(Je);$e.draw(_.context,G,g,_.stencilModeForClipping(Me),v,Vn.disabled,J,We,u.id,we.layoutVertexBuffer,te,K,u.paint,_.transform.zoom,Ne)}}function sc(_,r,u,f,g,v,E){const T=_.context,A=T.gl,R="fill-extrusion-pattern",D=u.paint.get(R),z=D.constantOr(1),G=u.getCrossfadeParameters(),Q=u.paint.get("fill-extrusion-opacity"),J=D.constantOr(null);for(const te of f){const K=r.getTile(te),ve=K.getBucket(u);if(!ve)continue;const Me=_.style.map.terrain&&_.style.map.terrain.getTerrainData(te),se=ve.programConfigurations.get(u.id),we=_.useProgram(z?"fillExtrusionPattern":"fillExtrusion",se);z&&(_.context.activeTexture.set(A.TEXTURE0),K.imageAtlasTexture.bind(A.LINEAR,A.CLAMP_TO_EDGE),se.updatePaintBuffers(G)),rc(se,R,J,K,u);const Ne=_.translatePosMatrix(te.posMatrix,K,u.paint.get("fill-extrusion-translate"),u.paint.get("fill-extrusion-translate-anchor")),$e=u.paint.get("fill-extrusion-vertical-gradient"),We=z?Vm(Ne,_,$e,Q,te,G,K):Qo(Ne,_,$e,Q);we.draw(T,T.gl.TRIANGLES,g,v,E,Vn.backCCW,We,Me,u.id,ve.layoutVertexBuffer,ve.indexBuffer,ve.segments,u.paint,_.transform.zoom,se,_.style.map.terrain&&ve.centroidVertexBuffer)}}function ac(_,r,u,f,g,v,E){const T=_.context,A=T.gl,R=u.fbo;if(!R)return;const D=_.useProgram("hillshade"),z=_.style.map.terrain&&_.style.map.terrain.getTerrainData(r);T.activeTexture.set(A.TEXTURE0),A.bindTexture(A.TEXTURE_2D,R.colorAttachment.get()),D.draw(T,A.TRIANGLES,g,v,E,Vn.disabled,((G,Q,J,te)=>{const K=J.paint.get("hillshade-shadow-color"),ve=J.paint.get("hillshade-highlight-color"),Me=J.paint.get("hillshade-accent-color");let se=J.paint.get("hillshade-illumination-direction")*(Math.PI/180);J.paint.get("hillshade-illumination-anchor")==="viewport"&&(se-=G.transform.angle);const we=!G.options.moving;return{u_matrix:te?te.posMatrix:G.transform.calculatePosMatrix(Q.tileID.toUnwrapped(),we),u_image:0,u_latrange:Ud(0,Q.tileID),u_light:[J.paint.get("hillshade-exaggeration"),se],u_shadow:K,u_highlight:ve,u_accent:Me}})(_,u,f,z?r:null),z,f.id,_.rasterBoundsBuffer,_.quadTriangleIndexBuffer,_.rasterBoundsSegments)}function Uu(_,r,u,f,g,v){const E=_.context,T=E.gl,A=r.dem;if(A&&A.data){const R=A.dim,D=A.stride,z=A.getPixels();if(E.activeTexture.set(T.TEXTURE1),E.pixelStoreUnpackPremultiplyAlpha.set(!1),r.demTexture=r.demTexture||_.getTileTexture(D),r.demTexture){const Q=r.demTexture;Q.update(z,{premultiply:!1}),Q.bind(T.NEAREST,T.CLAMP_TO_EDGE)}else r.demTexture=new ae(E,z,T.RGBA,{premultiply:!1}),r.demTexture.bind(T.NEAREST,T.CLAMP_TO_EDGE);E.activeTexture.set(T.TEXTURE0);let G=r.fbo;if(!G){const Q=new ae(E,{width:R,height:R,data:null},T.RGBA);Q.bind(T.LINEAR,T.CLAMP_TO_EDGE),G=r.fbo=E.createFramebuffer(R,R,!0,!1),G.colorAttachment.set(Q.texture)}E.bindFramebuffer.set(G.framebuffer),E.viewport.set([0,0,R,R]),_.useProgram("hillshadePrepare").draw(E,T.TRIANGLES,f,g,v,Vn.disabled,((Q,J)=>{const te=J.stride,K=l.create();return l.ortho(K,0,l.EXTENT,-l.EXTENT,0,0,1),l.translate(K,K,[0,-l.EXTENT,0]),{u_matrix:K,u_image:1,u_dimension:[te,te],u_zoom:Q.overscaledZ,u_unpack:J.getUnpackVector()}})(r.tileID,A),null,u.id,_.rasterBoundsBuffer,_.quadTriangleIndexBuffer,_.rasterBoundsSegments),r.needsHillshadePrepare=!1}}function ig(_,r,u,f,g,v){const E=f.paint.get("raster-fade-duration");if(!v&&E>0){const T=l.browser.now(),A=(T-_.timeAdded)/E,R=r?(T-r.timeAdded)/E:-1,D=u.getSource(),z=g.coveringZoomLevel({tileSize:D.tileSize,roundZoom:D.roundZoom}),G=!r||Math.abs(r.tileID.overscaledZ-z)>Math.abs(_.tileID.overscaledZ-z),Q=G&&_.refreshedUponExpiration?1:l.clamp(G?A:1-R,0,1);return _.refreshedUponExpiration&&A>=1&&(_.refreshedUponExpiration=!1),r?{opacity:1,mix:1-Q}:{opacity:Q,mix:0}}return{opacity:1,mix:0}}const Xd=new l.Color(1,0,0,1),mi=new l.Color(0,1,0,1),ka=new l.Color(0,0,1,1),qr=new l.Color(1,0,1,1),$u=new l.Color(0,1,1,1);function oc(_,r,u,f){Is(_,0,r+u/2,_.transform.width,u,f)}function Vu(_,r,u,f){Is(_,r-u/2,0,u,_.transform.height,f)}function Is(_,r,u,f,g,v){const E=_.context,T=E.gl;T.enable(T.SCISSOR_TEST),T.scissor(r*_.pixelRatio,u*_.pixelRatio,f*_.pixelRatio,g*_.pixelRatio),E.clear({color:v}),T.disable(T.SCISSOR_TEST)}function ll(_,r,u){const f=_.context,g=f.gl,v=u.posMatrix,E=_.useProgram("debug"),T=ln.disabled,A=$n.disabled,R=_.colorModeForRenderPass(),D="$debug",z=_.style.map.terrain&&_.style.map.terrain.getTerrainData(u);f.activeTexture.set(g.TEXTURE0);const G=r.getTileByID(u.key).latestRawTileData,Q=Math.floor((G&&G.byteLength||0)/1024),J=r.getTile(u).tileSize,te=512/Math.min(J,512)*(u.overscaledZ/_.transform.zoom)*.5;let K=u.canonical.toString();u.overscaledZ!==u.canonical.z&&(K+=` => ${u.overscaledZ}`),function(ve,Me){ve.initDebugOverlayCanvas();const se=ve.debugOverlayCanvas,we=ve.context.gl,Ne=ve.debugOverlayCanvas.getContext("2d");Ne.clearRect(0,0,se.width,se.height),Ne.shadowColor="white",Ne.shadowBlur=2,Ne.lineWidth=1.5,Ne.strokeStyle="white",Ne.textBaseline="top",Ne.font="bold 36px Open Sans, sans-serif",Ne.fillText(Me,5,5),Ne.strokeText(Me,5,5),ve.debugOverlayTexture.update(se),ve.debugOverlayTexture.bind(we.LINEAR,we.CLAMP_TO_EDGE)}(_,`${K} ${Q}kB`),E.draw(f,g.TRIANGLES,T,A,ni.alphaBlended,Vn.disabled,Fd(v,l.Color.transparent,te),null,D,_.debugBuffer,_.quadTriangleIndexBuffer,_.debugSegments),E.draw(f,g.LINE_STRIP,T,A,R,Vn.disabled,Fd(v,l.Color.red),z,D,_.debugBuffer,_.tileBorderIndexBuffer,_.debugSegments)}function lc(_,r,u){const f=_.context,g=f.gl,v=_.colorModeForRenderPass(),E=new ln(g.LEQUAL,ln.ReadWrite,_.depthRangeFor3D),T=_.useProgram("terrain"),A=r.getTerrainMesh();f.bindFramebuffer.set(null),f.viewport.set([0,0,_.width,_.height]);for(const R of u){const D=_.renderToTexture.getTexture(R),z=r.getTerrainData(R.tileID);f.activeTexture.set(g.TEXTURE0),g.bindTexture(g.TEXTURE_2D,D.texture);const G={u_matrix:_.transform.calculatePosMatrix(R.tileID.toUnwrapped()),u_texture:0,u_ele_delta:r.getMeshFrameDelta(_.transform.zoom)};T.draw(f,g.TRIANGLES,E,$n.disabled,v,Vn.backCCW,G,z,"terrain",A.vertexBuffer,A.indexBuffer,A.segments)}}class Kd{constructor(r,u){this.context=new ic(r),this.transform=u,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:l.create(),renderTime:0},this.setup(),this.numSublayers=ut.maxUnderzooming+ut.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new fi}resize(r,u,f){if(this.width=Math.floor(r*f),this.height=Math.floor(u*f),this.pixelRatio=f,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const g of this.style._order)this.style._layers[g].resize()}setup(){const r=this.context,u=new l.PosArray;u.emplaceBack(0,0),u.emplaceBack(l.EXTENT,0),u.emplaceBack(0,l.EXTENT),u.emplaceBack(l.EXTENT,l.EXTENT),this.tileExtentBuffer=r.createVertexBuffer(u,jl.members),this.tileExtentSegments=l.SegmentVector.simpleSegment(0,0,4,2);const f=new l.PosArray;f.emplaceBack(0,0),f.emplaceBack(l.EXTENT,0),f.emplaceBack(0,l.EXTENT),f.emplaceBack(l.EXTENT,l.EXTENT),this.debugBuffer=r.createVertexBuffer(f,jl.members),this.debugSegments=l.SegmentVector.simpleSegment(0,0,4,5);const g=new l.RasterBoundsArray;g.emplaceBack(0,0,0,0),g.emplaceBack(l.EXTENT,0,l.EXTENT,0),g.emplaceBack(0,l.EXTENT,0,l.EXTENT),g.emplaceBack(l.EXTENT,l.EXTENT,l.EXTENT,l.EXTENT),this.rasterBoundsBuffer=r.createVertexBuffer(g,Ge.members),this.rasterBoundsSegments=l.SegmentVector.simpleSegment(0,0,4,2);const v=new l.PosArray;v.emplaceBack(0,0),v.emplaceBack(1,0),v.emplaceBack(0,1),v.emplaceBack(1,1),this.viewportBuffer=r.createVertexBuffer(v,jl.members),this.viewportSegments=l.SegmentVector.simpleSegment(0,0,4,2);const E=new l.LineStripIndexArray;E.emplaceBack(0),E.emplaceBack(1),E.emplaceBack(3),E.emplaceBack(2),E.emplaceBack(0),this.tileBorderIndexBuffer=r.createIndexBuffer(E);const T=new l.TriangleIndexArray;T.emplaceBack(0,1,2),T.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=r.createIndexBuffer(T);const A=this.context.gl;this.stencilClearMode=new $n({func:A.ALWAYS,mask:0},0,255,A.ZERO,A.ZERO,A.ZERO)}clearStencil(){const r=this.context,u=r.gl;this.nextStencilID=1,this.currentStencilSource=void 0;const f=l.create();l.ortho(f,0,this.width,this.height,0,0,1),l.scale(f,f,[u.drawingBufferWidth,u.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(r,u.TRIANGLES,ln.disabled,this.stencilClearMode,ni.disabled,Vn.disabled,Zl(f),null,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(r,u){if(this.currentStencilSource===r.source||!r.isTileClipped()||!u||!u.length)return;this.currentStencilSource=r.source;const f=this.context,g=f.gl;this.nextStencilID+u.length>256&&this.clearStencil(),f.setColorMode(ni.disabled),f.setDepthMode(ln.disabled);const v=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const E of u){const T=this._tileClippingMaskIDs[E.key]=this.nextStencilID++,A=this.style.map.terrain&&this.style.map.terrain.getTerrainData(E);v.draw(f,g.TRIANGLES,ln.disabled,new $n({func:g.ALWAYS,mask:0},T,255,g.KEEP,g.KEEP,g.REPLACE),ni.disabled,Vn.disabled,Zl(E.posMatrix),A,"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const r=this.nextStencilID++,u=this.context.gl;return new $n({func:u.NOTEQUAL,mask:255},r,255,u.KEEP,u.KEEP,u.REPLACE)}stencilModeForClipping(r){const u=this.context.gl;return new $n({func:u.EQUAL,mask:255},this._tileClippingMaskIDs[r.key],0,u.KEEP,u.KEEP,u.REPLACE)}stencilConfigForOverlap(r){const u=this.context.gl,f=r.sort((E,T)=>T.overscaledZ-E.overscaledZ),g=f[f.length-1].overscaledZ,v=f[0].overscaledZ-g+1;if(v>1){this.currentStencilSource=void 0,this.nextStencilID+v>256&&this.clearStencil();const E={};for(let T=0;T<v;T++)E[T+g]=new $n({func:u.GEQUAL,mask:255},T+this.nextStencilID,255,u.KEEP,u.KEEP,u.REPLACE);return this.nextStencilID+=v,[E,f]}return[{[g]:$n.disabled},f]}colorModeForRenderPass(){const r=this.context.gl;return this._showOverdrawInspector?new ni([r.CONSTANT_COLOR,r.ONE],new l.Color(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?ni.unblended:ni.alphaBlended}depthModeForSublayer(r,u,f){if(!this.opaquePassEnabledForLayer())return ln.disabled;const g=1-((1+this.currentLayer)*this.numSublayers+r)*this.depthEpsilon;return new ln(f||this.context.gl.LEQUAL,u,[g,g])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(r,u){this.style=r,this.options=u,this.lineAtlas=r.lineAtlas,this.imageManager=r.imageManager,this.glyphManager=r.glyphManager,this.symbolFadeChange=r.placement.symbolFadeChange(l.browser.now()),this.imageManager.beginFrame();const f=this.style._order,g=this.style.sourceCaches,v={},E={},T={};for(const A in g){const R=g[A];R.used&&R.prepare(this.context),v[A]=R.getVisibleCoordinates(),E[A]=v[A].slice().reverse(),T[A]=R.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let A=0;A<f.length;A++)if(this.style._layers[f[A]].is3D()){this.opaquePassCutoff=A;break}if(this.renderToTexture){this.renderToTexture.prepareForRender(this.style,this.transform.zoom),this.opaquePassCutoff=0;const A=this.style.map.terrain.sourceCache.tilesAfterTime(this.terrainFacilitator.renderTime);(this.terrainFacilitator.dirty||!l.equals(this.terrainFacilitator.matrix,this.transform.projMatrix)||A.length)&&(l.copy(this.terrainFacilitator.matrix,this.transform.projMatrix),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,function(R,D){const z=R.context,G=z.gl,Q=ni.unblended,J=new ln(G.LEQUAL,ln.ReadWrite,[0,1]),te=D.getTerrainMesh(),K=D.sourceCache.getRenderableTiles(),ve=R.useProgram("terrainDepth");z.bindFramebuffer.set(D.getFramebuffer("depth").framebuffer),z.viewport.set([0,0,R.width/devicePixelRatio,R.height/devicePixelRatio]),z.clear({color:l.Color.transparent,depth:1});for(const Me of K){const se=D.getTerrainData(Me.tileID),we={u_matrix:R.transform.calculatePosMatrix(Me.tileID.toUnwrapped()),u_ele_delta:D.getMeshFrameDelta(R.transform.zoom)};ve.draw(z,G.TRIANGLES,J,$n.disabled,Q,Vn.backCCW,we,se,"terrain",te.vertexBuffer,te.indexBuffer,te.segments)}z.bindFramebuffer.set(null),z.viewport.set([0,0,R.width,R.height])}(this,this.style.map.terrain),function(R,D){const z=R.context,G=z.gl,Q=ni.unblended,J=new ln(G.LEQUAL,ln.ReadWrite,[0,1]),te=D.getTerrainMesh(),K=D.getCoordsTexture(),ve=D.sourceCache.getRenderableTiles(),Me=R.useProgram("terrainCoords");z.bindFramebuffer.set(D.getFramebuffer("coords").framebuffer),z.viewport.set([0,0,R.width/devicePixelRatio,R.height/devicePixelRatio]),z.clear({color:l.Color.transparent,depth:1}),D.coordsIndex=[];for(const se of ve){const we=D.getTerrainData(se.tileID);z.activeTexture.set(G.TEXTURE0),G.bindTexture(G.TEXTURE_2D,K.texture);const Ne={u_matrix:R.transform.calculatePosMatrix(se.tileID.toUnwrapped()),u_terrain_coords_id:(255-D.coordsIndex.length)/255,u_texture:0,u_ele_delta:D.getMeshFrameDelta(R.transform.zoom)};Me.draw(z,G.TRIANGLES,J,$n.disabled,Q,Vn.backCCW,Ne,we,"terrain",te.vertexBuffer,te.indexBuffer,te.segments),D.coordsIndex.push(se.tileID.key)}z.bindFramebuffer.set(null),z.viewport.set([0,0,R.width,R.height])}(this,this.style.map.terrain))}this.renderPass="offscreen";for(const A of f){const R=this.style._layers[A];if(!R.hasOffscreenPass()||R.isHidden(this.transform.zoom))continue;const D=E[R.source];(R.type==="custom"||D.length)&&this.renderLayer(this,g[R.source],R,D)}if(this.context.bindFramebuffer.set(null),this.context.clear({color:u.showOverdrawInspector?l.Color.black:l.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=u.showOverdrawInspector,this.depthRangeFor3D=[0,1-(r._order.length+2)*this.numSublayers*this.depthEpsilon],!this.renderToTexture)for(this.renderPass="opaque",this.currentLayer=f.length-1;this.currentLayer>=0;this.currentLayer--){const A=this.style._layers[f[this.currentLayer]],R=g[A.source],D=v[A.source];this._renderTileClippingMasks(A,D),this.renderLayer(this,R,A,D)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<f.length;this.currentLayer++){const A=this.style._layers[f[this.currentLayer]],R=g[A.source];if(this.renderToTexture&&this.renderToTexture.renderLayer(A))continue;const D=(A.type==="symbol"?T:E)[A.source];this._renderTileClippingMasks(A,v[A.source]),this.renderLayer(this,R,A,D)}if(this.options.showTileBoundaries){const A=function(R,D){let z=null;const G=Object.values(R._layers).flatMap(K=>K.source&&!K.isHidden(D)?[R.sourceCaches[K.source]]:[]),Q=G.filter(K=>K.getSource().type==="vector"),J=G.filter(K=>K.getSource().type!=="vector"),te=K=>{(!z||z.getSource().maxzoom<K.getSource().maxzoom)&&(z=K)};return Q.forEach(K=>te(K)),z||J.forEach(K=>te(K)),z}(this.style,this.transform.zoom);A&&function(R,D,z){for(let G=0;G<z.length;G++)ll(R,D,z[G])}(this,A,A.getVisibleCoordinates())}this.options.showPadding&&function(A){const R=A.transform.padding;oc(A,A.transform.height-(R.top||0),3,Xd),oc(A,R.bottom||0,3,mi),Vu(A,R.left||0,3,ka),Vu(A,A.transform.width-(R.right||0),3,qr);const D=A.transform.centerPoint;(function(z,G,Q,J){Is(z,G-1,Q-10,2,20,J),Is(z,G-10,Q-1,20,2,J)})(A,D.x,A.transform.height-D.y,$u)}(this),this.context.setDefault()}renderLayer(r,u,f,g){if(!f.isHidden(this.transform.zoom)&&(f.type==="background"||f.type==="custom"||(g||[]).length))switch(this.id=f.id,f.type){case"symbol":(function(v,E,T,A,R){if(v.renderPass!=="translucent")return;const D=$n.disabled,z=v.colorModeForRenderPass();(T._unevaluatedLayout.hasValue("text-variable-anchor")||T._unevaluatedLayout.hasValue("text-variable-anchor-offset"))&&function(G,Q,J,te,K,ve,Me){const se=Q.transform,we=K==="map",Ne=ve==="map";for(const $e of G){const We=te.getTile($e),ot=We.getBucket(J);if(!ot||!ot.text||!ot.text.segments.get().length)continue;const Je=l.evaluateSizeForZoom(ot.textSizeData,se.zoom),dt=pe(We,1,Q.transform.zoom),Mt=On($e.posMatrix,Ne,we,Q.transform,dt),cn=J.layout.get("icon-text-fit")!=="none"&&ot.hasIconData();if(Je){const _t=Math.pow(2,se.zoom-We.tileID.overscaledZ);Bu(ot,we,Ne,Me,se,Mt,$e.posMatrix,_t,Je,cn,Q.style.map.terrain?(Ht,Ct)=>Q.style.map.terrain.getElevation($e,Ht,Ct):null)}}}(A,v,T,E,T.layout.get("text-rotation-alignment"),T.layout.get("text-pitch-alignment"),R),T.paint.get("icon-opacity").constantOr(1)!==0&&Fu(v,E,T,A,!1,T.paint.get("icon-translate"),T.paint.get("icon-translate-anchor"),T.layout.get("icon-rotation-alignment"),T.layout.get("icon-pitch-alignment"),T.layout.get("icon-keep-upright"),D,z),T.paint.get("text-opacity").constantOr(1)!==0&&Fu(v,E,T,A,!0,T.paint.get("text-translate"),T.paint.get("text-translate-anchor"),T.layout.get("text-rotation-alignment"),T.layout.get("text-pitch-alignment"),T.layout.get("text-keep-upright"),D,z),E.map.showCollisionBoxes&&(al(v,E,T,A,T.paint.get("text-translate"),T.paint.get("text-translate-anchor"),!0),al(v,E,T,A,T.paint.get("icon-translate"),T.paint.get("icon-translate-anchor"),!1))})(r,u,f,g,this.style.placement.variableOffsets);break;case"circle":(function(v,E,T,A){if(v.renderPass!=="translucent")return;const R=T.paint.get("circle-opacity"),D=T.paint.get("circle-stroke-width"),z=T.paint.get("circle-stroke-opacity"),G=!T.layout.get("circle-sort-key").isConstant();if(R.constantOr(1)===0&&(D.constantOr(1)===0||z.constantOr(1)===0))return;const Q=v.context,J=Q.gl,te=v.depthModeForSublayer(0,ln.ReadOnly),K=$n.disabled,ve=v.colorModeForRenderPass(),Me=[];for(let se=0;se<A.length;se++){const we=A[se],Ne=E.getTile(we),$e=Ne.getBucket(T);if(!$e)continue;const We=$e.programConfigurations.get(T.id),ot=v.useProgram("circle",We),Je=$e.layoutVertexBuffer,dt=$e.indexBuffer,Mt=v.style.map.terrain&&v.style.map.terrain.getTerrainData(we),cn={programConfiguration:We,program:ot,layoutVertexBuffer:Je,indexBuffer:dt,uniformValues:Gm(v,we,Ne,T),terrainData:Mt};if(G){const _t=$e.segments.get();for(const Ht of _t)Me.push({segments:new l.SegmentVector([Ht]),sortKey:Ht.sortKey,state:cn})}else Me.push({segments:$e.segments,sortKey:0,state:cn})}G&&Me.sort((se,we)=>se.sortKey-we.sortKey);for(const se of Me){const{programConfiguration:we,program:Ne,layoutVertexBuffer:$e,indexBuffer:We,uniformValues:ot,terrainData:Je}=se.state;Ne.draw(Q,J.TRIANGLES,te,K,ve,Vn.disabled,ot,Je,T.id,$e,We,se.segments,T.paint,v.transform.zoom,we)}})(r,u,f,g);break;case"heatmap":(function(v,E,T,A){if(T.paint.get("heatmap-opacity")!==0)if(v.renderPass==="offscreen"){const R=v.context,D=R.gl,z=$n.disabled,G=new ni([D.ONE,D.ONE],l.Color.transparent,[!0,!0,!0,!0]);(function(Q,J,te){const K=Q.gl;Q.activeTexture.set(K.TEXTURE1),Q.viewport.set([0,0,J.width/4,J.height/4]);let ve=te.heatmapFbo;if(ve)K.bindTexture(K.TEXTURE_2D,ve.colorAttachment.get()),Q.bindFramebuffer.set(ve.framebuffer);else{const Me=K.createTexture();K.bindTexture(K.TEXTURE_2D,Me),K.texParameteri(K.TEXTURE_2D,K.TEXTURE_WRAP_S,K.CLAMP_TO_EDGE),K.texParameteri(K.TEXTURE_2D,K.TEXTURE_WRAP_T,K.CLAMP_TO_EDGE),K.texParameteri(K.TEXTURE_2D,K.TEXTURE_MIN_FILTER,K.LINEAR),K.texParameteri(K.TEXTURE_2D,K.TEXTURE_MAG_FILTER,K.LINEAR),ve=te.heatmapFbo=Q.createFramebuffer(J.width/4,J.height/4,!1,!1),function(se,we,Ne,$e){var We,ot;const Je=se.gl,dt=(We=se.HALF_FLOAT)!==null&&We!==void 0?We:Je.UNSIGNED_BYTE,Mt=(ot=se.RGBA16F)!==null&&ot!==void 0?ot:Je.RGBA;Je.texImage2D(Je.TEXTURE_2D,0,Mt,we.width/4,we.height/4,0,Je.RGBA,dt,null),$e.colorAttachment.set(Ne)}(Q,J,Me,ve)}})(R,v,T),R.clear({color:l.Color.transparent});for(let Q=0;Q<A.length;Q++){const J=A[Q];if(E.hasRenderableParent(J))continue;const te=E.getTile(J),K=te.getBucket(T);if(!K)continue;const ve=K.programConfigurations.get(T.id),Me=v.useProgram("heatmap",ve),{zoom:se}=v.transform;Me.draw(R,D.TRIANGLES,ln.disabled,z,G,Vn.disabled,Nd(J.posMatrix,te,se,T.paint.get("heatmap-intensity")),null,T.id,K.layoutVertexBuffer,K.indexBuffer,K.segments,T.paint,v.transform.zoom,ve)}R.viewport.set([0,0,v.width,v.height])}else v.renderPass==="translucent"&&(v.context.setColorMode(v.colorModeForRenderPass()),function(R,D){const z=R.context,G=z.gl,Q=D.heatmapFbo;if(!Q)return;z.activeTexture.set(G.TEXTURE0),G.bindTexture(G.TEXTURE_2D,Q.colorAttachment.get()),z.activeTexture.set(G.TEXTURE1);let J=D.colorRampTexture;J||(J=D.colorRampTexture=new ae(z,D.colorRamp,G.RGBA)),J.bind(G.LINEAR,G.CLAMP_TO_EDGE),R.useProgram("heatmapTexture").draw(z,G.TRIANGLES,ln.disabled,$n.disabled,R.colorModeForRenderPass(),Vn.disabled,((te,K,ve,Me)=>{const se=l.create();l.ortho(se,0,te.width,te.height,0,0,1);const we=te.context.gl;return{u_matrix:se,u_world:[we.drawingBufferWidth,we.drawingBufferHeight],u_image:0,u_color_ramp:1,u_opacity:K.paint.get("heatmap-opacity")}})(R,D),null,D.id,R.viewportBuffer,R.quadTriangleIndexBuffer,R.viewportSegments,D.paint,R.transform.zoom)}(v,T))})(r,u,f,g);break;case"line":(function(v,E,T,A){if(v.renderPass!=="translucent")return;const R=T.paint.get("line-opacity"),D=T.paint.get("line-width");if(R.constantOr(1)===0||D.constantOr(1)===0)return;const z=v.depthModeForSublayer(0,ln.ReadOnly),G=v.colorModeForRenderPass(),Q=T.paint.get("line-dasharray"),J=T.paint.get("line-pattern"),te=J.constantOr(1),K=T.paint.get("line-gradient"),ve=T.getCrossfadeParameters(),Me=te?"linePattern":Q?"lineSDF":K?"lineGradient":"line",se=v.context,we=se.gl;let Ne=!0;for(const $e of A){const We=E.getTile($e);if(te&&!We.patternsLoaded())continue;const ot=We.getBucket(T);if(!ot)continue;const Je=ot.programConfigurations.get(T.id),dt=v.context.program.get(),Mt=v.useProgram(Me,Je),cn=Ne||Mt.program!==dt,_t=v.style.map.terrain&&v.style.map.terrain.getTerrainData($e),Ht=J.constantOr(null);if(Ht&&We.imageAtlas){const sn=We.imageAtlas,nn=sn.patternPositions[Ht.to.toString()],Zt=sn.patternPositions[Ht.from.toString()];nn&&Zt&&Je.setConstantPatternPositions(nn,Zt)}const Ct=_t?$e:null,Fn=te?Sa(v,We,T,ve,Ct):Q?Yl(v,We,T,Q,ve,Ct):K?$d(v,We,T,ot.lineClipsArray.length,Ct):Wl(v,We,T,Ct);if(te)se.activeTexture.set(we.TEXTURE0),We.imageAtlasTexture.bind(we.LINEAR,we.CLAMP_TO_EDGE),Je.updatePaintBuffers(ve);else if(Q&&(cn||v.lineAtlas.dirty))se.activeTexture.set(we.TEXTURE0),v.lineAtlas.bind(se);else if(K){const sn=ot.gradients[T.id];let nn=sn.texture;if(T.gradientVersion!==sn.version){let Zt=256;if(T.stepInterpolant){const oi=E.getSource().maxzoom,Rn=$e.canonical.z===oi?Math.ceil(1<<v.transform.maxZoom-$e.canonical.z):1;Zt=l.clamp(l.nextPowerOfTwo(ot.maxLineLength/l.EXTENT*1024*Rn),256,se.maxTextureSize)}sn.gradient=l.renderColorRamp({expression:T.gradientExpression(),evaluationKey:"lineProgress",resolution:Zt,image:sn.gradient||void 0,clips:ot.lineClipsArray}),sn.texture?sn.texture.update(sn.gradient):sn.texture=new ae(se,sn.gradient,we.RGBA),sn.version=T.gradientVersion,nn=sn.texture}se.activeTexture.set(we.TEXTURE0),nn.bind(T.stepInterpolant?we.NEAREST:we.LINEAR,we.CLAMP_TO_EDGE)}Mt.draw(se,we.TRIANGLES,z,v.stencilModeForClipping($e),G,Vn.disabled,Fn,_t,T.id,ot.layoutVertexBuffer,ot.indexBuffer,ot.segments,T.paint,v.transform.zoom,Je,ot.layoutVertexBuffer2),Ne=!1}})(r,u,f,g);break;case"fill":(function(v,E,T,A){const R=T.paint.get("fill-color"),D=T.paint.get("fill-opacity");if(D.constantOr(1)===0)return;const z=v.colorModeForRenderPass(),G=T.paint.get("fill-pattern"),Q=v.opaquePassEnabledForLayer()&&!G.constantOr(1)&&R.constantOr(l.Color.transparent).a===1&&D.constantOr(0)===1?"opaque":"translucent";if(v.renderPass===Q){const J=v.depthModeForSublayer(1,v.renderPass==="opaque"?ln.ReadWrite:ln.ReadOnly);Nu(v,E,T,A,J,z,!1)}if(v.renderPass==="translucent"&&T.paint.get("fill-antialias")){const J=v.depthModeForSublayer(T.getPaintProperty("fill-outline-color")?2:0,ln.ReadOnly);Nu(v,E,T,A,J,z,!0)}})(r,u,f,g);break;case"fill-extrusion":(function(v,E,T,A){const R=T.paint.get("fill-extrusion-opacity");if(R!==0&&v.renderPass==="translucent"){const D=new ln(v.context.gl.LEQUAL,ln.ReadWrite,v.depthRangeFor3D);if(R!==1||T.paint.get("fill-extrusion-pattern").constantOr(1))sc(v,E,T,A,D,$n.disabled,ni.disabled),sc(v,E,T,A,D,v.stencilModeFor3D(),v.colorModeForRenderPass());else{const z=v.colorModeForRenderPass();sc(v,E,T,A,D,$n.disabled,z)}}})(r,u,f,g);break;case"hillshade":(function(v,E,T,A){if(v.renderPass!=="offscreen"&&v.renderPass!=="translucent")return;const R=v.context,D=v.depthModeForSublayer(0,ln.ReadOnly),z=v.colorModeForRenderPass(),[G,Q]=v.renderPass==="translucent"?v.stencilConfigForOverlap(A):[{},A];for(const J of Q){const te=E.getTile(J);te.needsHillshadePrepare!==void 0&&te.needsHillshadePrepare&&v.renderPass==="offscreen"?Uu(v,te,T,D,$n.disabled,z):v.renderPass==="translucent"&&ac(v,J,te,T,D,G[J.overscaledZ],z)}R.viewport.set([0,0,v.width,v.height])})(r,u,f,g);break;case"raster":(function(v,E,T,A){if(v.renderPass!=="translucent"||T.paint.get("raster-opacity")===0||!A.length)return;const R=v.context,D=R.gl,z=E.getSource(),G=v.useProgram("raster"),Q=v.colorModeForRenderPass(),[J,te]=z instanceof ft?[{},A]:v.stencilConfigForOverlap(A),K=te[te.length-1].overscaledZ,ve=!v.options.moving;for(const Me of te){const se=v.depthModeForSublayer(Me.overscaledZ-K,T.paint.get("raster-opacity")===1?ln.ReadWrite:ln.ReadOnly,D.LESS),we=E.getTile(Me);we.registerFadeDuration(T.paint.get("raster-fade-duration"));const Ne=E.findLoadedParent(Me,0),$e=ig(we,Ne,E,T,v.transform,v.style.map.terrain);let We,ot;const Je=T.paint.get("raster-resampling")==="nearest"?D.NEAREST:D.LINEAR;R.activeTexture.set(D.TEXTURE0),we.texture.bind(Je,D.CLAMP_TO_EDGE,D.LINEAR_MIPMAP_NEAREST),R.activeTexture.set(D.TEXTURE1),Ne?(Ne.texture.bind(Je,D.CLAMP_TO_EDGE,D.LINEAR_MIPMAP_NEAREST),We=Math.pow(2,Ne.tileID.overscaledZ-we.tileID.overscaledZ),ot=[we.tileID.canonical.x*We%1,we.tileID.canonical.y*We%1]):we.texture.bind(Je,D.CLAMP_TO_EDGE,D.LINEAR_MIPMAP_NEAREST);const dt=v.style.map.terrain&&v.style.map.terrain.getTerrainData(Me),Mt=dt?Me:null,cn=Mt?Mt.posMatrix:v.transform.calculatePosMatrix(Me.toUnwrapped(),ve),_t=Xl(cn,ot||[0,0],We||1,$e,T);z instanceof ft?G.draw(R,D.TRIANGLES,se,$n.disabled,Q,Vn.disabled,_t,dt,T.id,z.boundsBuffer,v.quadTriangleIndexBuffer,z.boundsSegments):G.draw(R,D.TRIANGLES,se,J[Me.overscaledZ],Q,Vn.disabled,_t,dt,T.id,v.rasterBoundsBuffer,v.quadTriangleIndexBuffer,v.rasterBoundsSegments)}})(r,u,f,g);break;case"background":(function(v,E,T,A){const R=T.paint.get("background-color"),D=T.paint.get("background-opacity");if(D===0)return;const z=v.context,G=z.gl,Q=v.transform,J=Q.tileSize,te=T.paint.get("background-pattern");if(v.isPatternMissing(te))return;const K=!te&&R.a===1&&D===1&&v.opaquePassEnabledForLayer()?"opaque":"translucent";if(v.renderPass!==K)return;const ve=$n.disabled,Me=v.depthModeForSublayer(0,K==="opaque"?ln.ReadWrite:ln.ReadOnly),se=v.colorModeForRenderPass(),we=v.useProgram(te?"backgroundPattern":"background"),Ne=A||Q.coveringTiles({tileSize:J,terrain:v.style.map.terrain});te&&(z.activeTexture.set(G.TEXTURE0),v.imageManager.bind(v.context));const $e=T.getCrossfadeParameters();for(const We of Ne){const ot=A?We.posMatrix:v.transform.calculatePosMatrix(We.toUnwrapped()),Je=te?Kl(ot,D,v,te,{tileID:We,tileSize:J},$e):Ea(ot,D,R),dt=v.style.map.terrain&&v.style.map.terrain.getTerrainData(We);we.draw(z,G.TRIANGLES,Me,ve,se,Vn.disabled,Je,dt,T.id,v.tileExtentBuffer,v.quadTriangleIndexBuffer,v.tileExtentSegments)}})(r,0,f,g);break;case"custom":(function(v,E,T){const A=v.context,R=T.implementation;if(v.renderPass==="offscreen"){const D=R.prerender;D&&(v.setCustomLayerDefaults(),A.setColorMode(v.colorModeForRenderPass()),D.call(R,A.gl,v.transform.customLayerMatrix()),A.setDirty(),v.setBaseState())}else if(v.renderPass==="translucent"){v.setCustomLayerDefaults(),A.setColorMode(v.colorModeForRenderPass()),A.setStencilMode($n.disabled);const D=R.renderingMode==="3d"?new ln(v.context.gl.LEQUAL,ln.ReadWrite,v.depthRangeFor3D):v.depthModeForSublayer(0,ln.ReadOnly);A.setDepthMode(D),R.render(A.gl,v.transform.customLayerMatrix()),A.setDirty(),v.setBaseState(),A.bindFramebuffer.set(null)}})(r,0,f)}}translatePosMatrix(r,u,f,g,v){if(!f[0]&&!f[1])return r;const E=v?g==="map"?this.transform.angle:0:g==="viewport"?-this.transform.angle:0;if(E){const R=Math.sin(E),D=Math.cos(E);f=[f[0]*D-f[1]*R,f[0]*R+f[1]*D]}const T=[v?f[0]:pe(u,f[0],this.transform.zoom),v?f[1]:pe(u,f[1],this.transform.zoom),0],A=new Float32Array(16);return l.translate(A,r,T),A}saveTileTexture(r){const u=this._tileTextures[r.size[0]];u?u.push(r):this._tileTextures[r.size[0]]=[r]}getTileTexture(r){const u=this._tileTextures[r];return u&&u.length>0?u.pop():null}isPatternMissing(r){if(!r)return!1;if(!r.from||!r.to)return!0;const u=this.imageManager.getPattern(r.from.toString()),f=this.imageManager.getPattern(r.to.toString());return!u||!f}useProgram(r,u){this.cache=this.cache||{};const f=r+(u?u.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"")+(this.style.map.terrain?"/terrain":"");return this.cache[f]||(this.cache[f]=new Js(this.context,Jo[r],u,kr[r],this._showOverdrawInspector,this.style.map.terrain)),this.cache[f]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const r=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(r.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new ae(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}overLimit(){const{drawingBufferWidth:r,drawingBufferHeight:u}=this.context.gl;return this.width!==r||this.height!==u}}class cc{constructor(r,u){this.points=r,this.planes=u}static fromInvProjectionMatrix(r,u,f){const g=Math.pow(2,f),v=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(T=>{const A=1/(T=l.transformMat4([],T,r))[3]/u*g;return l.mul$1(T,T,[A,A,1/T[3],A])}),E=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(T=>{const A=function(G,Q){var J=Q[0],te=Q[1],K=Q[2],ve=J*J+te*te+K*K;return ve>0&&(ve=1/Math.sqrt(ve)),G[0]=Q[0]*ve,G[1]=Q[1]*ve,G[2]=Q[2]*ve,G}([],function(G,Q,J){var te=Q[0],K=Q[1],ve=Q[2],Me=J[0],se=J[1],we=J[2];return G[0]=K*we-ve*se,G[1]=ve*Me-te*we,G[2]=te*se-K*Me,G}([],Oe([],v[T[0]],v[T[1]]),Oe([],v[T[2]],v[T[1]]))),R=-((D=A)[0]*(z=v[T[1]])[0]+D[1]*z[1]+D[2]*z[2]);var D,z;return A.concat(R)});return new cc(v,E)}}class cl{constructor(r,u){this.min=r,this.max=u,this.center=function(f,g,v){return f[0]=.5*g[0],f[1]=.5*g[1],f[2]=.5*g[2],f}([],function(f,g,v){return f[0]=g[0]+v[0],f[1]=g[1]+v[1],f[2]=g[2]+v[2],f}([],this.min,this.max))}quadrant(r){const u=[r%2==0,r<2],f=Pe(this.min),g=Pe(this.max);for(let v=0;v<u.length;v++)f[v]=u[v]?this.min[v]:this.center[v],g[v]=u[v]?this.center[v]:this.max[v];return g[2]=this.max[2],new cl(f,g)}distanceX(r){return Math.max(Math.min(this.max[0],r[0]),this.min[0])-r[0]}distanceY(r){return Math.max(Math.min(this.max[1],r[1]),this.min[1])-r[1]}intersects(r){const u=[[this.min[0],this.min[1],this.min[2],1],[this.max[0],this.min[1],this.min[2],1],[this.max[0],this.max[1],this.min[2],1],[this.min[0],this.max[1],this.min[2],1],[this.min[0],this.min[1],this.max[2],1],[this.max[0],this.min[1],this.max[2],1],[this.max[0],this.max[1],this.max[2],1],[this.min[0],this.max[1],this.max[2],1]];let f=!0;for(let g=0;g<r.planes.length;g++){const v=r.planes[g];let E=0;for(let T=0;T<u.length;T++)l.dot(v,u[T])>=0&&E++;if(E===0)return 0;E!==u.length&&(f=!1)}if(f)return 2;for(let g=0;g<3;g++){let v=Number.MAX_VALUE,E=-Number.MAX_VALUE;for(let T=0;T<r.points.length;T++){const A=r.points[T][g]-this.min[g];v=Math.min(v,A),E=Math.max(E,A)}if(E<0||v>this.max[g]-this.min[g])return 0}return 1}}class uc{constructor(r=0,u=0,f=0,g=0){if(isNaN(r)||r<0||isNaN(u)||u<0||isNaN(f)||f<0||isNaN(g)||g<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=r,this.bottom=u,this.left=f,this.right=g}interpolate(r,u,f){return u.top!=null&&r.top!=null&&(this.top=l.interpolate.number(r.top,u.top,f)),u.bottom!=null&&r.bottom!=null&&(this.bottom=l.interpolate.number(r.bottom,u.bottom,f)),u.left!=null&&r.left!=null&&(this.left=l.interpolate.number(r.left,u.left,f)),u.right!=null&&r.right!=null&&(this.right=l.interpolate.number(r.right,u.right,f)),this}getCenter(r,u){const f=l.clamp((this.left+r-this.right)/2,0,r),g=l.clamp((this.top+u-this.bottom)/2,0,u);return new l.Point(f,g)}equals(r){return this.top===r.top&&this.bottom===r.bottom&&this.left===r.left&&this.right===r.right}clone(){return new uc(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}class hc{constructor(r,u,f,g,v){this.tileSize=512,this.maxValidLatitude=85.051129,this._renderWorldCopies=v===void 0||!!v,this._minZoom=r||0,this._maxZoom=u||22,this._minPitch=f??0,this._maxPitch=g??60,this.setMaxBounds(),this.width=0,this.height=0,this._center=new l.LngLat(0,0),this._elevation=0,this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new uc,this._posMatrixCache={},this._alignedPosMatrixCache={},this._minEleveationForCurrentTile=0}clone(){const r=new hc(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return r.apply(this),r}apply(r){this.tileSize=r.tileSize,this.latRange=r.latRange,this.width=r.width,this.height=r.height,this._center=r._center,this._elevation=r._elevation,this._minEleveationForCurrentTile=r._minEleveationForCurrentTile,this.zoom=r.zoom,this.angle=r.angle,this._fov=r._fov,this._pitch=r._pitch,this._unmodified=r._unmodified,this._edgeInsets=r._edgeInsets.clone(),this._calcMatrices()}get minZoom(){return this._minZoom}set minZoom(r){this._minZoom!==r&&(this._minZoom=r,this.zoom=Math.max(this.zoom,r))}get maxZoom(){return this._maxZoom}set maxZoom(r){this._maxZoom!==r&&(this._maxZoom=r,this.zoom=Math.min(this.zoom,r))}get minPitch(){return this._minPitch}set minPitch(r){this._minPitch!==r&&(this._minPitch=r,this.pitch=Math.max(this.pitch,r))}get maxPitch(){return this._maxPitch}set maxPitch(r){this._maxPitch!==r&&(this._maxPitch=r,this.pitch=Math.min(this.pitch,r))}get renderWorldCopies(){return this._renderWorldCopies}set renderWorldCopies(r){r===void 0?r=!0:r===null&&(r=!1),this._renderWorldCopies=r}get worldSize(){return this.tileSize*this.scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new l.Point(this.width,this.height)}get bearing(){return-this.angle/Math.PI*180}set bearing(r){const u=-l.wrap(r,-180,180)*Math.PI/180;this.angle!==u&&(this._unmodified=!1,this.angle=u,this._calcMatrices(),this.rotationMatrix=function(){var f=new l.ARRAY_TYPE(4);return l.ARRAY_TYPE!=Float32Array&&(f[1]=0,f[2]=0),f[0]=1,f[3]=1,f}(),function(f,g,v){var E=g[0],T=g[1],A=g[2],R=g[3],D=Math.sin(v),z=Math.cos(v);f[0]=E*z+A*D,f[1]=T*z+R*D,f[2]=E*-D+A*z,f[3]=T*-D+R*z}(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(r){const u=l.clamp(r,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==u&&(this._unmodified=!1,this._pitch=u,this._calcMatrices())}get fov(){return this._fov/Math.PI*180}set fov(r){r=Math.max(.01,Math.min(60,r)),this._fov!==r&&(this._unmodified=!1,this._fov=r/180*Math.PI,this._calcMatrices())}get zoom(){return this._zoom}set zoom(r){const u=Math.min(Math.max(r,this.minZoom),this.maxZoom);this._zoom!==u&&(this._unmodified=!1,this._zoom=u,this.tileZoom=Math.max(0,Math.floor(u)),this.scale=this.zoomScale(u),this._constrain(),this._calcMatrices())}get center(){return this._center}set center(r){r.lat===this._center.lat&&r.lng===this._center.lng||(this._unmodified=!1,this._center=r,this._constrain(),this._calcMatrices())}get elevation(){return this._elevation}set elevation(r){r!==this._elevation&&(this._elevation=r,this._constrain(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}set padding(r){this._edgeInsets.equals(r)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,r,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}isPaddingEqual(r){return this._edgeInsets.equals(r)}interpolatePadding(r,u,f){this._unmodified=!1,this._edgeInsets.interpolate(r,u,f),this._constrain(),this._calcMatrices()}coveringZoomLevel(r){const u=(r.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/r.tileSize));return Math.max(0,u)}getVisibleUnwrappedCoordinates(r){const u=[new l.UnwrappedTileID(0,r)];if(this._renderWorldCopies){const f=this.pointCoordinate(new l.Point(0,0)),g=this.pointCoordinate(new l.Point(this.width,0)),v=this.pointCoordinate(new l.Point(this.width,this.height)),E=this.pointCoordinate(new l.Point(0,this.height)),T=Math.floor(Math.min(f.x,g.x,v.x,E.x)),A=Math.floor(Math.max(f.x,g.x,v.x,E.x)),R=1;for(let D=T-R;D<=A+R;D++)D!==0&&u.push(new l.UnwrappedTileID(D,r))}return u}coveringTiles(r){var u,f;let g=this.coveringZoomLevel(r);const v=g;if(r.minzoom!==void 0&&g<r.minzoom)return[];r.maxzoom!==void 0&&g>r.maxzoom&&(g=r.maxzoom);const E=this.pointCoordinate(this.getCameraPoint()),T=l.MercatorCoordinate.fromLngLat(this.center),A=Math.pow(2,g),R=[A*E.x,A*E.y,0],D=[A*T.x,A*T.y,0],z=cc.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,g);let G=r.minzoom||0;!r.terrain&&this.pitch<=60&&this._edgeInsets.top<.1&&(G=g);const Q=r.terrain?2/Math.min(this.tileSize,r.tileSize)*this.tileSize:3,J=se=>({aabb:new cl([se*A,0,0],[(se+1)*A,A,0]),zoom:0,x:0,y:0,wrap:se,fullyVisible:!1}),te=[],K=[],ve=g,Me=r.reparseOverscaled?v:g;if(this._renderWorldCopies)for(let se=1;se<=3;se++)te.push(J(-se)),te.push(J(se));for(te.push(J(0));te.length>0;){const se=te.pop(),we=se.x,Ne=se.y;let $e=se.fullyVisible;if(!$e){const Mt=se.aabb.intersects(z);if(Mt===0)continue;$e=Mt===2}const We=r.terrain?R:D,ot=se.aabb.distanceX(We),Je=se.aabb.distanceY(We),dt=Math.max(Math.abs(ot),Math.abs(Je));if(se.zoom===ve||dt>Q+(1<<ve-se.zoom)-2&&se.zoom>=G){const Mt=ve-se.zoom,cn=R[0]-.5-(we<<Mt),_t=R[1]-.5-(Ne<<Mt);K.push({tileID:new l.OverscaledTileID(se.zoom===ve?Me:se.zoom,se.wrap,se.zoom,we,Ne),distanceSq:Te([D[0]-.5-we,D[1]-.5-Ne]),tileDistanceToCamera:Math.sqrt(cn*cn+_t*_t)})}else for(let Mt=0;Mt<4;Mt++){const cn=(we<<1)+Mt%2,_t=(Ne<<1)+(Mt>>1),Ht=se.zoom+1;let Ct=se.aabb.quadrant(Mt);if(r.terrain){const Fn=new l.OverscaledTileID(Ht,se.wrap,Ht,cn,_t),sn=r.terrain.getMinMaxElevation(Fn),nn=(u=sn.minElevation)!==null&&u!==void 0?u:this.elevation,Zt=(f=sn.maxElevation)!==null&&f!==void 0?f:this.elevation;Ct=new cl([Ct.min[0],Ct.min[1],nn],[Ct.max[0],Ct.max[1],Zt])}te.push({aabb:Ct,zoom:Ht,x:cn,y:_t,wrap:se.wrap,fullyVisible:$e})}}return K.sort((se,we)=>se.distanceSq-we.distanceSq).map(se=>se.tileID)}resize(r,u){this.width=r,this.height=u,this.pixelsToGLUnits=[2/r,-2/u],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(r){return Math.pow(2,r)}scaleZoom(r){return Math.log(r)/Math.LN2}project(r){const u=l.clamp(r.lat,-this.maxValidLatitude,this.maxValidLatitude);return new l.Point(l.mercatorXfromLng(r.lng)*this.worldSize,l.mercatorYfromLat(u)*this.worldSize)}unproject(r){return new l.MercatorCoordinate(r.x/this.worldSize,r.y/this.worldSize).toLngLat()}get point(){return this.project(this.center)}getCameraPosition(){return{lngLat:this.pointLocation(this.getCameraPoint()),altitude:Math.cos(this._pitch)*this.cameraToCenterDistance/this._pixelPerMeter+this.elevation}}recalculateZoom(r){const u=this.pointLocation(this.centerPoint,r),f=r.getElevationForLngLatZoom(u,this.tileZoom);if(!(this.elevation-f))return;const g=this.getCameraPosition(),v=l.MercatorCoordinate.fromLngLat(g.lngLat,g.altitude),E=l.MercatorCoordinate.fromLngLat(u,f),T=v.x-E.x,A=v.y-E.y,R=v.z-E.z,D=Math.sqrt(T*T+A*A+R*R),z=this.scaleZoom(this.cameraToCenterDistance/D/this.tileSize);this._elevation=f,this._center=u,this.zoom=z}setLocationAtPoint(r,u){const f=this.pointCoordinate(u),g=this.pointCoordinate(this.centerPoint),v=this.locationCoordinate(r),E=new l.MercatorCoordinate(v.x-(f.x-g.x),v.y-(f.y-g.y));this.center=this.coordinateLocation(E),this._renderWorldCopies&&(this.center=this.center.wrap())}locationPoint(r,u){return u?this.coordinatePoint(this.locationCoordinate(r),u.getElevationForLngLatZoom(r,this.tileZoom),this.pixelMatrix3D):this.coordinatePoint(this.locationCoordinate(r))}pointLocation(r,u){return this.coordinateLocation(this.pointCoordinate(r,u))}locationCoordinate(r){return l.MercatorCoordinate.fromLngLat(r)}coordinateLocation(r){return r&&r.toLngLat()}pointCoordinate(r,u){if(u){const G=u.pointCoordinate(r);if(G!=null)return G}const f=[r.x,r.y,0,1],g=[r.x,r.y,1,1];l.transformMat4(f,f,this.pixelMatrixInverse),l.transformMat4(g,g,this.pixelMatrixInverse);const v=f[3],E=g[3],T=f[1]/v,A=g[1]/E,R=f[2]/v,D=g[2]/E,z=R===D?0:(0-R)/(D-R);return new l.MercatorCoordinate(l.interpolate.number(f[0]/v,g[0]/E,z)/this.worldSize,l.interpolate.number(T,A,z)/this.worldSize)}coordinatePoint(r,u=0,f=this.pixelMatrix){const g=[r.x*this.worldSize,r.y*this.worldSize,u,1];return l.transformMat4(g,g,f),new l.Point(g[0]/g[3],g[1]/g[3])}getBounds(){const r=Math.max(0,this.height/2-this.getHorizon());return new Pt().extend(this.pointLocation(new l.Point(0,r))).extend(this.pointLocation(new l.Point(this.width,r))).extend(this.pointLocation(new l.Point(this.width,this.height))).extend(this.pointLocation(new l.Point(0,this.height)))}getMaxBounds(){return this.latRange&&this.latRange.length===2&&this.lngRange&&this.lngRange.length===2?new Pt([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null}getHorizon(){return Math.tan(Math.PI/2-this._pitch)*this.cameraToCenterDistance*.85}setMaxBounds(r){r?(this.lngRange=[r.getWest(),r.getEast()],this.latRange=[r.getSouth(),r.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])}calculatePosMatrix(r,u=!1){const f=r.key,g=u?this._alignedPosMatrixCache:this._posMatrixCache;if(g[f])return g[f];const v=r.canonical,E=this.worldSize/this.zoomScale(v.z),T=v.x+Math.pow(2,v.z)*r.wrap,A=l.identity(new Float64Array(16));return l.translate(A,A,[T*E,v.y*E,0]),l.scale(A,A,[E/l.EXTENT,E/l.EXTENT,1]),l.multiply(A,u?this.alignedProjMatrix:this.projMatrix,A),g[f]=new Float32Array(A),g[f]}customLayerMatrix(){return this.mercatorMatrix.slice()}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;let r,u,f,g,v=-90,E=90,T=-180,A=180;const R=this.size,D=this._unmodified;if(this.latRange){const Q=this.latRange;v=l.mercatorYfromLat(Q[1])*this.worldSize,E=l.mercatorYfromLat(Q[0])*this.worldSize,r=E-v<R.y?R.y/(E-v):0}if(this.lngRange){const Q=this.lngRange;T=l.wrap(l.mercatorXfromLng(Q[0])*this.worldSize,0,this.worldSize),A=l.wrap(l.mercatorXfromLng(Q[1])*this.worldSize,0,this.worldSize),A<T&&(A+=this.worldSize),u=A-T<R.x?R.x/(A-T):0}const z=this.point,G=Math.max(u||0,r||0);if(G)return this.center=this.unproject(new l.Point(u?(A+T)/2:z.x,r?(E+v)/2:z.y)),this.zoom+=this.scaleZoom(G),this._unmodified=D,void(this._constraining=!1);if(this.latRange){const Q=z.y,J=R.y/2;Q-J<v&&(g=v+J),Q+J>E&&(g=E-J)}if(this.lngRange){const Q=(T+A)/2,J=l.wrap(z.x,Q-this.worldSize/2,Q+this.worldSize/2),te=R.x/2;J-te<T&&(f=T+te),J+te>A&&(f=A-te)}f===void 0&&g===void 0||(this.center=this.unproject(new l.Point(f!==void 0?f:z.x,g!==void 0?g:z.y)).wrap()),this._unmodified=D,this._constraining=!1}_calcMatrices(){if(!this.height)return;const r=this.centerOffset,u=this.point.x,f=this.point.y;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height,this._pixelPerMeter=l.mercatorZfromAltitude(1,this.center.lat)*this.worldSize;let g=l.identity(new Float64Array(16));l.scale(g,g,[this.width/2,-this.height/2,1]),l.translate(g,g,[1,-1,0]),this.labelPlaneMatrix=g,g=l.identity(new Float64Array(16)),l.scale(g,g,[1,-1,1]),l.translate(g,g,[-1,-1,0]),l.scale(g,g,[2/this.width,2/this.height,1]),this.glCoordMatrix=g;const v=this.cameraToCenterDistance+this._elevation*this._pixelPerMeter/Math.cos(this._pitch),E=Math.min(this.elevation,this._minEleveationForCurrentTile),T=v-E*this._pixelPerMeter/Math.cos(this._pitch),A=E<0?T:v,R=Math.PI/2+this._pitch,D=this._fov*(.5+r.y/this.height),z=Math.sin(D)*A/Math.sin(l.clamp(Math.PI-R-D,.01,Math.PI-.01)),G=this.getHorizon(),Q=2*Math.atan(G/this.cameraToCenterDistance)*(.5+r.y/(2*G)),J=Math.sin(Q)*A/Math.sin(l.clamp(Math.PI-R-Q,.01,Math.PI-.01)),te=Math.min(z,J),K=1.01*(Math.cos(Math.PI/2-this._pitch)*te+A),ve=this.height/50;g=new Float64Array(16),l.perspective(g,this._fov,this.width/this.height,ve,K),g[8]=2*-r.x/this.width,g[9]=2*r.y/this.height,l.scale(g,g,[1,-1,1]),l.translate(g,g,[0,0,-this.cameraToCenterDistance]),l.rotateX(g,g,this._pitch),l.rotateZ(g,g,this.angle),l.translate(g,g,[-u,-f,0]),this.mercatorMatrix=l.scale([],g,[this.worldSize,this.worldSize,this.worldSize]),l.scale(g,g,[1,1,this._pixelPerMeter]),this.pixelMatrix=l.multiply(new Float64Array(16),this.labelPlaneMatrix,g),l.translate(g,g,[0,0,-this.elevation]),this.projMatrix=g,this.invProjMatrix=l.invert([],g),this.pixelMatrix3D=l.multiply(new Float64Array(16),this.labelPlaneMatrix,g);const Me=this.width%2/2,se=this.height%2/2,we=Math.cos(this.angle),Ne=Math.sin(this.angle),$e=u-Math.round(u)+we*Me+Ne*se,We=f-Math.round(f)+we*se+Ne*Me,ot=new Float64Array(g);if(l.translate(ot,ot,[$e>.5?$e-1:$e,We>.5?We-1:We,0]),this.alignedProjMatrix=ot,g=l.invert(new Float64Array(16),this.pixelMatrix),!g)throw new Error("failed to invert matrix");this.pixelMatrixInverse=g,this._posMatrixCache={},this._alignedPosMatrixCache={}}maxPitchScaleFactor(){if(!this.pixelMatrixInverse)return 1;const r=this.pointCoordinate(new l.Point(0,0)),u=[r.x*this.worldSize,r.y*this.worldSize,0,1];return l.transformMat4(u,u,this.pixelMatrix)[3]/this.cameraToCenterDistance}getCameraPoint(){const r=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new l.Point(0,r))}getCameraQueryGeometry(r){const u=this.getCameraPoint();if(r.length===1)return[r[0],u];{let f=u.x,g=u.y,v=u.x,E=u.y;for(const T of r)f=Math.min(f,T.x),g=Math.min(g,T.y),v=Math.max(v,T.x),E=Math.max(E,T.y);return[new l.Point(f,g),new l.Point(v,g),new l.Point(v,E),new l.Point(f,E),new l.Point(f,g)]}}}class Aa{constructor(r){this._getCurrentHash=()=>{const u=window.location.hash.replace("#","");if(this._hashName){let f;return u.split("&").map(g=>g.split("=")).forEach(g=>{g[0]===this._hashName&&(f=g)}),(f&&f[1]||"").split("/")}return u.split("/")},this._onHashChange=()=>{const u=this._getCurrentHash();if(u.length>=3&&!u.some(f=>isNaN(f))){const f=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(u[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+u[2],+u[1]],zoom:+u[0],bearing:f,pitch:+(u[4]||0)}),!0}return!1},this._updateHashUnthrottled=()=>{const u=window.location.href.replace(/(#.+)?$/,this.getHashString());try{window.history.replaceState(window.history.state,null,u)}catch{}},this._updateHash=function(u,f){let g=!1,v=null;const E=()=>{v=null,g&&(u(),v=setTimeout(E,300),g=!1)};return()=>(g=!0,v||E(),v)}(this._updateHashUnthrottled),this._hashName=r&&encodeURIComponent(r)}addTo(r){return this._map=r,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this}getHashString(r){const u=this._map.getCenter(),f=Math.round(100*this._map.getZoom())/100,g=Math.ceil((f*Math.LN2+Math.log(512/360/.5))/Math.LN10),v=Math.pow(10,g),E=Math.round(u.lng*v)/v,T=Math.round(u.lat*v)/v,A=this._map.getBearing(),R=this._map.getPitch();let D="";if(D+=r?`/${E}/${T}/${f}`:`${f}/${T}/${E}`,(A||R)&&(D+="/"+Math.round(10*A)/10),R&&(D+=`/${Math.round(R)}`),this._hashName){const z=this._hashName;let G=!1;const Q=window.location.hash.slice(1).split("&").map(J=>{const te=J.split("=")[0];return te===z?(G=!0,`${te}=${D}`):J}).filter(J=>J);return G||Q.push(`${z}=${D}`),`#${Q.join("&")}`}return`#${D}`}}const ul={linearity:.3,easing:l.bezier(0,0,.3,1)},Jd=l.extend({deceleration:2500,maxSpeed:1400},ul),Qd=l.extend({deceleration:20,maxSpeed:1400},ul),ef=l.extend({deceleration:1e3,maxSpeed:360},ul),tf=l.extend({deceleration:1e3,maxSpeed:90},ul);class nf{constructor(r){this._map=r,this.clear()}clear(){this._inertiaBuffer=[]}record(r){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:l.browser.now(),settings:r})}_drainInertiaBuffer(){const r=this._inertiaBuffer,u=l.browser.now();for(;r.length>0&&u-r[0].time>160;)r.shift()}_onMoveEnd(r){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const u={zoom:0,bearing:0,pitch:0,pan:new l.Point(0,0),pinchAround:void 0,around:void 0};for(const{settings:v}of this._inertiaBuffer)u.zoom+=v.zoomDelta||0,u.bearing+=v.bearingDelta||0,u.pitch+=v.pitchDelta||0,v.panDelta&&u.pan._add(v.panDelta),v.around&&(u.around=v.around),v.pinchAround&&(u.pinchAround=v.pinchAround);const f=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,g={};if(u.pan.mag()){const v=hl(u.pan.mag(),f,l.extend({},Jd,r||{}));g.offset=u.pan.mult(v.amount/u.pan.mag()),g.center=this._map.transform.center,Qs(g,v)}if(u.zoom){const v=hl(u.zoom,f,Qd);g.zoom=this._map.transform.zoom+v.amount,Qs(g,v)}if(u.bearing){const v=hl(u.bearing,f,ef);g.bearing=this._map.transform.bearing+l.clamp(v.amount,-179,179),Qs(g,v)}if(u.pitch){const v=hl(u.pitch,f,tf);g.pitch=this._map.transform.pitch+v.amount,Qs(g,v)}if(g.zoom||g.bearing){const v=u.pinchAround===void 0?u.around:u.pinchAround;g.around=v?this._map.unproject(v):this._map.getCenter()}return this.clear(),l.extend(g,{noMoveStart:!0})}}function Qs(_,r){(!_.duration||_.duration<r.duration)&&(_.duration=r.duration,_.easing=r.easing)}function hl(_,r,u){const{maxSpeed:f,linearity:g,deceleration:v}=u,E=l.clamp(_*g/(r/1e3),-f,f),T=Math.abs(E)/(v*g);return{easing:u.easing,duration:1e3*T,amount:E*(T/2)}}class gi extends l.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(r,u,f,g={}){const v=w.mousePos(u.getCanvasContainer(),f),E=u.unproject(v);super(r,l.extend({point:v,lngLat:E,originalEvent:f},g)),this._defaultPrevented=!1,this.target=u}}class Hr extends l.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(r,u,f){const g=r==="touchend"?f.changedTouches:f.touches,v=w.touchPos(u.getCanvasContainer(),g),E=v.map(A=>u.unproject(A)),T=v.reduce((A,R,D,z)=>A.add(R.div(z.length)),new l.Point(0,0));super(r,{points:v,point:T,lngLats:E,lngLat:u.unproject(T),originalEvent:f}),this._defaultPrevented=!1}}class rf extends l.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(r,u,f){super(r,{originalEvent:f}),this._defaultPrevented=!1}}class ks{constructor(r,u){this._map=r,this._clickTolerance=u.clickTolerance}reset(){delete this._mousedownPos}wheel(r){return this._firePreventable(new rf(r.type,this._map,r))}mousedown(r,u){return this._mousedownPos=u,this._firePreventable(new gi(r.type,this._map,r))}mouseup(r){this._map.fire(new gi(r.type,this._map,r))}click(r,u){this._mousedownPos&&this._mousedownPos.dist(u)>=this._clickTolerance||this._map.fire(new gi(r.type,this._map,r))}dblclick(r){return this._firePreventable(new gi(r.type,this._map,r))}mouseover(r){this._map.fire(new gi(r.type,this._map,r))}mouseout(r){this._map.fire(new gi(r.type,this._map,r))}touchstart(r){return this._firePreventable(new Hr(r.type,this._map,r))}touchmove(r){this._map.fire(new Hr(r.type,this._map,r))}touchend(r){this._map.fire(new Hr(r.type,this._map,r))}touchcancel(r){this._map.fire(new Hr(r.type,this._map,r))}_firePreventable(r){if(this._map.fire(r),r.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class dl{constructor(r){this._map=r}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(r){this._map.fire(new gi(r.type,this._map,r))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new gi("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(r){this._delayContextMenu?this._contextMenuEvent=r:this._ignoreContextMenu||this._map.fire(new gi(r.type,this._map,r)),this._map.listens("contextmenu")&&r.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class fl{constructor(r){this._map=r}get transform(){return this._map._requestedCameraState||this._map.transform}get center(){return{lng:this.transform.center.lng,lat:this.transform.center.lat}}get zoom(){return this.transform.zoom}get pitch(){return this.transform.pitch}get bearing(){return this.transform.bearing}unproject(r){return this.transform.pointLocation(l.Point.convert(r),this._map.terrain)}}class rg{constructor(r,u){this._map=r,this._tr=new fl(r),this._el=r.getCanvasContainer(),this._container=r.getContainer(),this._clickTolerance=u.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(r,u){this.isEnabled()&&r.shiftKey&&r.button===0&&(w.disableDrag(),this._startPos=this._lastPos=u,this._active=!0)}mousemoveWindow(r,u){if(!this._active)return;const f=u;if(this._lastPos.equals(f)||!this._box&&f.dist(this._startPos)<this._clickTolerance)return;const g=this._startPos;this._lastPos=f,this._box||(this._box=w.create("div","maplibregl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair"),this._fireEvent("boxzoomstart",r));const v=Math.min(g.x,f.x),E=Math.max(g.x,f.x),T=Math.min(g.y,f.y),A=Math.max(g.y,f.y);w.setTransform(this._box,`translate(${v}px,${T}px)`),this._box.style.width=E-v+"px",this._box.style.height=A-T+"px"}mouseupWindow(r,u){if(!this._active||r.button!==0)return;const f=this._startPos,g=u;if(this.reset(),w.suppressClick(),f.x!==g.x||f.y!==g.y)return this._map.fire(new l.Event("boxzoomend",{originalEvent:r})),{cameraAnimation:v=>v.fitScreenCoordinates(f,g,this._tr.bearing,{linear:!0})};this._fireEvent("boxzoomcancel",r)}keydown(r){this._active&&r.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",r))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair"),this._box&&(w.remove(this._box),this._box=null),w.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(r,u){return this._map.fire(new l.Event(r,{originalEvent:u}))}}function ju(_,r){if(_.length!==r.length)throw new Error(`The number of touches and points are not equal - touches ${_.length}, points ${r.length}`);const u={};for(let f=0;f<_.length;f++)u[_[f].identifier]=r[f];return u}class sf{constructor(r){this.reset(),this.numTouches=r.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(r,u,f){(this.centroid||f.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=r.timeStamp),f.length===this.numTouches&&(this.centroid=function(g){const v=new l.Point(0,0);for(const E of g)v._add(E);return v.div(g.length)}(u),this.touches=ju(f,u)))}touchmove(r,u,f){if(this.aborted||!this.centroid)return;const g=ju(f,u);for(const v in this.touches){const E=g[v];(!E||E.dist(this.touches[v])>30)&&(this.aborted=!0)}}touchend(r,u,f){if((!this.centroid||r.timeStamp-this.startTime>500)&&(this.aborted=!0),f.length===0){const g=!this.aborted&&this.centroid;if(this.reset(),g)return g}}}class Pa{constructor(r){this.singleTap=new sf(r),this.numTaps=r.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(r,u,f){this.singleTap.touchstart(r,u,f)}touchmove(r,u,f){this.singleTap.touchmove(r,u,f)}touchend(r,u,f){const g=this.singleTap.touchend(r,u,f);if(g){const v=r.timeStamp-this.lastTime<500,E=!this.lastTap||this.lastTap.dist(g)<30;if(v&&E||this.reset(),this.count++,this.lastTime=r.timeStamp,this.lastTap=g,this.count===this.numTaps)return this.reset(),g}}}class ea{constructor(r){this._tr=new fl(r),this._zoomIn=new Pa({numTouches:1,numTaps:2}),this._zoomOut=new Pa({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(r,u,f){this._zoomIn.touchstart(r,u,f),this._zoomOut.touchstart(r,u,f)}touchmove(r,u,f){this._zoomIn.touchmove(r,u,f),this._zoomOut.touchmove(r,u,f)}touchend(r,u,f){const g=this._zoomIn.touchend(r,u,f),v=this._zoomOut.touchend(r,u,f),E=this._tr;return g?(this._active=!0,r.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:T=>T.easeTo({duration:300,zoom:E.zoom+1,around:E.unproject(g)},{originalEvent:r})}):v?(this._active=!0,r.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:T=>T.easeTo({duration:300,zoom:E.zoom-1,around:E.unproject(v)},{originalEvent:r})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class St{constructor(r){this._enabled=!!r.enable,this._moveStateManager=r.moveStateManager,this._clickTolerance=r.clickTolerance||1,this._moveFunction=r.move,this._activateOnStart=!!r.activateOnStart,r.assignEvents(this),this.reset()}reset(r){this._active=!1,this._moved=!1,delete this._lastPoint,this._moveStateManager.endMove(r)}_move(...r){const u=this._moveFunction(...r);if(u.bearingDelta||u.pitchDelta||u.around||u.panDelta)return this._active=!0,u}dragStart(r,u){this.isEnabled()&&!this._lastPoint&&this._moveStateManager.isValidStartEvent(r)&&(this._moveStateManager.startMove(r),this._lastPoint=u.length?u[0]:u,this._activateOnStart&&this._lastPoint&&(this._active=!0))}dragMove(r,u){if(!this.isEnabled())return;const f=this._lastPoint;if(!f)return;if(r.preventDefault(),!this._moveStateManager.isValidMoveEvent(r))return void this.reset(r);const g=u.length?u[0]:u;return!this._moved&&g.dist(f)<this._clickTolerance?void 0:(this._moved=!0,this._lastPoint=g,this._move(f,g))}dragEnd(r){this.isEnabled()&&this._lastPoint&&this._moveStateManager.isValidEndEvent(r)&&(this._moved&&w.suppressClick(),this.reset(r))}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}getClickTolerance(){return this._clickTolerance}}const af={0:1,2:2};class Ra{constructor(r){this._correctEvent=r.checkCorrectEvent}startMove(r){const u=w.mouseButton(r);this._eventButton=u}endMove(r){delete this._eventButton}isValidStartEvent(r){return this._correctEvent(r)}isValidMoveEvent(r){return!function(u,f){const g=af[f];return u.buttons===void 0||(u.buttons&g)!==g}(r,this._eventButton)}isValidEndEvent(r){return w.mouseButton(r)===this._eventButton}}class uo{constructor(){this._firstTouch=void 0}_isOneFingerTouch(r){return r.targetTouches.length===1}_isSameTouchEvent(r){return r.targetTouches[0].identifier===this._firstTouch}startMove(r){this._firstTouch=r.targetTouches[0].identifier}endMove(r){delete this._firstTouch}isValidStartEvent(r){return this._isOneFingerTouch(r)}isValidMoveEvent(r){return this._isOneFingerTouch(r)&&this._isSameTouchEvent(r)}isValidEndEvent(r){return this._isOneFingerTouch(r)&&this._isSameTouchEvent(r)}}const dc=_=>{_.mousedown=_.dragStart,_.mousemoveWindow=_.dragMove,_.mouseup=_.dragEnd,_.contextmenu=function(r){r.preventDefault()}},bt=({enable:_,clickTolerance:r,bearingDegreesPerPixelMoved:u=.8})=>{const f=new Ra({checkCorrectEvent:g=>w.mouseButton(g)===0&&g.ctrlKey||w.mouseButton(g)===2});return new St({clickTolerance:r,move:(g,v)=>({bearingDelta:(v.x-g.x)*u}),moveStateManager:f,enable:_,assignEvents:dc})},fc=({enable:_,clickTolerance:r,pitchDegreesPerPixelMoved:u=-.5})=>{const f=new Ra({checkCorrectEvent:g=>w.mouseButton(g)===0&&g.ctrlKey||w.mouseButton(g)===2});return new St({clickTolerance:r,move:(g,v)=>({pitchDelta:(v.y-g.y)*u}),moveStateManager:f,enable:_,assignEvents:dc})};class sg{constructor(r,u){this._minTouches=r.cooperativeGestures?2:1,this._clickTolerance=r.clickTolerance||1,this._map=u,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new l.Point(0,0),setTimeout(()=>{this._cancelCooperativeMessage=!1},200)}touchstart(r,u,f){return this._calculateTransform(r,u,f)}touchmove(r,u,f){if(this._map._cooperativeGestures&&(this._minTouches===2&&f.length<2&&!this._cancelCooperativeMessage?this._map._onCooperativeGesture(r,!1,f.length):this._cancelCooperativeMessage||(this._cancelCooperativeMessage=!0)),this._active&&!(f.length<this._minTouches))return r.preventDefault(),this._calculateTransform(r,u,f)}touchend(r,u,f){this._calculateTransform(r,u,f),this._active&&f.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(r,u,f){f.length>0&&(this._active=!0);const g=ju(f,u),v=new l.Point(0,0),E=new l.Point(0,0);let T=0;for(const R in g){const D=g[R],z=this._touches[R];z&&(v._add(D),E._add(D.sub(z)),T++,g[R]=D)}if(this._touches=g,T<this._minTouches||!E.mag())return;const A=E.div(T);return this._sum._add(A),this._sum.mag()<this._clickTolerance?void 0:{around:v.div(T),panDelta:A}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Gu{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}touchstart(r,u,f){this._firstTwoTouches||f.length<2||(this._firstTwoTouches=[f[0].identifier,f[1].identifier],this._start([u[0],u[1]]))}touchmove(r,u,f){if(!this._firstTwoTouches)return;r.preventDefault();const[g,v]=this._firstTwoTouches,E=ho(f,u,g),T=ho(f,u,v);if(!E||!T)return;const A=this._aroundCenter?null:E.add(T).div(2);return this._move([E,T],A,r)}touchend(r,u,f){if(!this._firstTwoTouches)return;const[g,v]=this._firstTwoTouches,E=ho(f,u,g),T=ho(f,u,v);E&&T||(this._active&&w.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(r){this._enabled=!0,this._aroundCenter=!!r&&r.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function ho(_,r,u){for(let f=0;f<_.length;f++)if(_[f].identifier===u)return r[f]}function qu(_,r){return Math.log(_/r)/Math.LN2}class of extends Gu{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(r){this._startDistance=this._distance=r[0].dist(r[1])}_move(r,u){const f=this._distance;if(this._distance=r[0].dist(r[1]),this._active||!(Math.abs(qu(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:qu(this._distance,f),pinchAround:u}}}function lf(_,r){return 180*_.angleWith(r)/Math.PI}class ag extends Gu{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(r){this._startVector=this._vector=r[0].sub(r[1]),this._minDiameter=r[0].dist(r[1])}_move(r,u){const f=this._vector;if(this._vector=r[0].sub(r[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:lf(this._vector,f),pinchAround:u}}_isBelowThreshold(r){this._minDiameter=Math.min(this._minDiameter,r.mag());const u=25/(Math.PI*this._minDiameter)*360,f=lf(r,this._startVector);return Math.abs(f)<u}}function pl(_){return Math.abs(_.y)>Math.abs(_.x)}class Hu extends Gu{constructor(r){super(),this._map=r}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(r,u,f){super.touchstart(r,u,f),this._currentTouchCount=f.length}_start(r){this._lastPoints=r,pl(r[0].sub(r[1]))&&(this._valid=!1)}_move(r,u,f){if(this._map._cooperativeGestures&&this._currentTouchCount<3)return;const g=r[0].sub(this._lastPoints[0]),v=r[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(g,v,f.timeStamp),this._valid?(this._lastPoints=r,this._active=!0,{pitchDelta:(g.y+v.y)/2*-.5}):void 0}gestureBeginsVertically(r,u,f){if(this._valid!==void 0)return this._valid;const g=r.mag()>=2,v=u.mag()>=2;if(!g&&!v)return;if(!g||!v)return this._firstMove===void 0&&(this._firstMove=f),f-this._firstMove<100&&void 0;const E=r.y>0==u.y>0;return pl(r)&&pl(u)&&E}}const Zu={panStep:100,bearingStep:15,pitchStep:10};class Wu{constructor(r){this._tr=new fl(r);const u=Zu;this._panStep=u.panStep,this._bearingStep=u.bearingStep,this._pitchStep=u.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(r){if(r.altKey||r.ctrlKey||r.metaKey)return;let u=0,f=0,g=0,v=0,E=0;switch(r.keyCode){case 61:case 107:case 171:case 187:u=1;break;case 189:case 109:case 173:u=-1;break;case 37:r.shiftKey?f=-1:(r.preventDefault(),v=-1);break;case 39:r.shiftKey?f=1:(r.preventDefault(),v=1);break;case 38:r.shiftKey?g=1:(r.preventDefault(),E=-1);break;case 40:r.shiftKey?g=-1:(r.preventDefault(),E=1);break;default:return}return this._rotationDisabled&&(f=0,g=0),{cameraAnimation:T=>{const A=this._tr;T.easeTo({duration:300,easeId:"keyboardHandler",easing:fr,zoom:u?Math.round(A.zoom)+u*(r.shiftKey?2:1):A.zoom,bearing:A.bearing+f*this._bearingStep,pitch:A.pitch+g*this._pitchStep,offset:[-v*this._panStep,-E*this._panStep],center:A.center},{originalEvent:r})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function fr(_){return _*(2-_)}const As=4.000244140625;class cf{constructor(r,u){this._onTimeout=f=>{this._type="wheel",this._delta-=this._lastValue,this._active||this._start(f)},this._map=r,this._tr=new fl(r),this._el=r.getCanvasContainer(),this._triggerRenderFrame=u,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222}setZoomRate(r){this._defaultZoomRate=r}setWheelZoomRate(r){this._wheelZoomRate=r}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(r){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!r&&r.around==="center")}disable(){this.isEnabled()&&(this._enabled=!1)}wheel(r){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!r[this._map._metaKey])return;r.preventDefault()}let u=r.deltaMode===WheelEvent.DOM_DELTA_LINE?40*r.deltaY:r.deltaY;const f=l.browser.now(),g=f-(this._lastWheelEventTime||0);this._lastWheelEventTime=f,u!==0&&u%As==0?this._type="wheel":u!==0&&Math.abs(u)<4?this._type="trackpad":g>400?(this._type=null,this._lastValue=u,this._timeout=setTimeout(this._onTimeout,40,r)):this._type||(this._type=Math.abs(g*u)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,u+=this._lastValue)),r.shiftKey&&u&&(u/=4),this._type&&(this._lastWheelEvent=r,this._delta-=u,this._active||this._start(r)),r.preventDefault()}_start(r){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const u=w.mousePos(this._el,r),f=this._tr;this._around=l.LngLat.convert(this._aroundCenter?f.center:f.unproject(u)),this._aroundPoint=f.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const r=this._tr.transform;if(this._delta!==0){const T=this._type==="wheel"&&Math.abs(this._delta)>As?this._wheelZoomRate:this._defaultZoomRate;let A=2/(1+Math.exp(-Math.abs(this._delta*T)));this._delta<0&&A!==0&&(A=1/A);const R=typeof this._targetZoom=="number"?r.zoomScale(this._targetZoom):r.scale;this._targetZoom=Math.min(r.maxZoom,Math.max(r.minZoom,r.scaleZoom(R*A))),this._type==="wheel"&&(this._startZoom=r.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}const u=typeof this._targetZoom=="number"?this._targetZoom:r.zoom,f=this._startZoom,g=this._easing;let v,E=!1;if(this._type==="wheel"&&f&&g){const T=Math.min((l.browser.now()-this._lastWheelEventTime)/200,1),A=g(T);v=l.interpolate.number(f,u,A),T<1?this._frameId||(this._frameId=!0):E=!0}else v=u,E=!0;return this._active=!0,E&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!E,zoomDelta:v-r.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(r){let u=l.defaultEasing;if(this._prevEase){const f=this._prevEase,g=(l.browser.now()-f.start)/f.duration,v=f.easing(g+.01)-f.easing(g),E=.27/Math.sqrt(v*v+1e-4)*.01,T=Math.sqrt(.0729-E*E);u=l.bezier(E,T,.25,1)}return this._prevEase={start:l.browser.now(),duration:r,easing:u},u}reset(){this._active=!1}}class Yu{constructor(r,u){this._clickZoom=r,this._tapZoom=u}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class Xu{constructor(r){this._tr=new fl(r),this.reset()}reset(){this._active=!1}dblclick(r,u){return r.preventDefault(),{cameraAnimation:f=>{f.easeTo({duration:300,zoom:this._tr.zoom+(r.shiftKey?-1:1),around:this._tr.unproject(u)},{originalEvent:r})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Ku{constructor(){this._tap=new Pa({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,delete this._tapPoint,this._tap.reset()}touchstart(r,u,f){if(!this._swipePoint)if(this._tapTime){const g=u[0],v=r.timeStamp-this._tapTime<500,E=this._tapPoint.dist(g)<30;v&&E?f.length>0&&(this._swipePoint=g,this._swipeTouch=f[0].identifier):this.reset()}else this._tap.touchstart(r,u,f)}touchmove(r,u,f){if(this._tapTime){if(this._swipePoint){if(f[0].identifier!==this._swipeTouch)return;const g=u[0],v=g.y-this._swipePoint.y;return this._swipePoint=g,r.preventDefault(),this._active=!0,{zoomDelta:v/128}}}else this._tap.touchmove(r,u,f)}touchend(r,u,f){if(this._tapTime)this._swipePoint&&f.length===0&&this.reset();else{const g=this._tap.touchend(r,u,f);g&&(this._tapTime=r.timeStamp,this._tapPoint=g)}}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class uf{constructor(r,u,f){this._el=r,this._mousePan=u,this._touchPan=f}enable(r){this._inertiaOptions=r||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class Zr{constructor(r,u,f){this._pitchWithRotate=r.pitchWithRotate,this._mouseRotate=u,this._mousePitch=f}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class Zn{constructor(r,u,f,g){this._el=r,this._touchZoom=u,this._touchRotate=f,this._tapDragZoom=g,this._rotationDisabled=!1,this._enabled=!0}enable(r){this._touchZoom.enable(r),this._rotationDisabled||this._touchRotate.enable(r),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const Ma=_=>_.zoom||_.drag||_.pitch||_.rotate;class Ju extends l.Event{}function pc(_){return _.panDelta&&_.panDelta.mag()||_.zoomDelta||_.bearingDelta||_.pitchDelta}class hf{constructor(r,u){this.handleWindowEvent=g=>{this.handleEvent(g,`${g.type}Window`)},this.handleEvent=(g,v)=>{if(g.type==="blur")return void this.stop(!0);this._updatingCamera=!0;const E=g.type==="renderFrame"?void 0:g,T={needsRenderFrame:!1},A={},R={},D=g.touches,z=D?this._getMapTouches(D):void 0,G=z?w.touchPos(this._el,z):w.mousePos(this._el,g);for(const{handlerName:te,handler:K,allowed:ve}of this._handlers){if(!K.isEnabled())continue;let Me;this._blockedByActive(R,ve,te)?K.reset():K[v||g.type]&&(Me=K[v||g.type](g,G,z),this.mergeHandlerResult(T,A,Me,te,E),Me&&Me.needsRenderFrame&&this._triggerRenderFrame()),(Me||K.isActive())&&(R[te]=K)}const Q={};for(const te in this._previousActiveHandlers)R[te]||(Q[te]=E);this._previousActiveHandlers=R,(Object.keys(Q).length||pc(T))&&(this._changes.push([T,A,Q]),this._triggerRenderFrame()),(Object.keys(R).length||pc(T))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:J}=T;J&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],J(this._map))},this._map=r,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new nf(r),this._bearingSnap=u.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(u);const f=this._el;this._listeners=[[f,"touchstart",{passive:!0}],[f,"touchmove",{passive:!1}],[f,"touchend",void 0],[f,"touchcancel",void 0],[f,"mousedown",void 0],[f,"mousemove",void 0],[f,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[f,"mouseover",void 0],[f,"mouseout",void 0],[f,"dblclick",void 0],[f,"click",void 0],[f,"keydown",{capture:!1}],[f,"keyup",void 0],[f,"wheel",{passive:!1}],[f,"contextmenu",void 0],[window,"blur",void 0]];for(const[g,v,E]of this._listeners)w.addEventListener(g,v,g===document?this.handleWindowEvent:this.handleEvent,E)}destroy(){for(const[r,u,f]of this._listeners)w.removeEventListener(r,u,r===document?this.handleWindowEvent:this.handleEvent,f)}_addDefaultHandlers(r){const u=this._map,f=u.getCanvasContainer();this._add("mapEvent",new ks(u,r));const g=u.boxZoom=new rg(u,r);this._add("boxZoom",g),r.interactive&&r.boxZoom&&g.enable();const v=new ea(u),E=new Xu(u);u.doubleClickZoom=new Yu(E,v),this._add("tapZoom",v),this._add("clickZoom",E),r.interactive&&r.doubleClickZoom&&u.doubleClickZoom.enable();const T=new Ku;this._add("tapDragZoom",T);const A=u.touchPitch=new Hu(u);this._add("touchPitch",A),r.interactive&&r.touchPitch&&u.touchPitch.enable(r.touchPitch);const R=bt(r),D=fc(r);u.dragRotate=new Zr(r,R,D),this._add("mouseRotate",R,["mousePitch"]),this._add("mousePitch",D,["mouseRotate"]),r.interactive&&r.dragRotate&&u.dragRotate.enable();const z=(({enable:ve,clickTolerance:Me})=>{const se=new Ra({checkCorrectEvent:we=>w.mouseButton(we)===0&&!we.ctrlKey});return new St({clickTolerance:Me,move:(we,Ne)=>({around:Ne,panDelta:Ne.sub(we)}),activateOnStart:!0,moveStateManager:se,enable:ve,assignEvents:dc})})(r),G=new sg(r,u);u.dragPan=new uf(f,z,G),this._add("mousePan",z),this._add("touchPan",G,["touchZoom","touchRotate"]),r.interactive&&r.dragPan&&u.dragPan.enable(r.dragPan);const Q=new ag,J=new of;u.touchZoomRotate=new Zn(f,J,Q,T),this._add("touchRotate",Q,["touchPan","touchZoom"]),this._add("touchZoom",J,["touchPan","touchRotate"]),r.interactive&&r.touchZoomRotate&&u.touchZoomRotate.enable(r.touchZoomRotate);const te=u.scrollZoom=new cf(u,()=>this._triggerRenderFrame());this._add("scrollZoom",te,["mousePan"]),r.interactive&&r.scrollZoom&&u.scrollZoom.enable(r.scrollZoom);const K=u.keyboard=new Wu(u);this._add("keyboard",K),r.interactive&&r.keyboard&&u.keyboard.enable(),this._add("blockableMapEvent",new dl(u))}_add(r,u,f){this._handlers.push({handlerName:r,handler:u,allowed:f}),this._handlersById[r]=u}stop(r){if(!this._updatingCamera){for(const{handler:u}of this._handlers)u.reset();this._inertia.clear(),this._fireEvents({},{},r),this._changes=[]}}isActive(){for(const{handler:r}of this._handlers)if(r.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!Ma(this._eventsInProgress)||this.isZooming()}_blockedByActive(r,u,f){for(const g in r)if(g!==f&&(!u||u.indexOf(g)<0))return!0;return!1}_getMapTouches(r){const u=[];for(const f of r)this._el.contains(f.target)&&u.push(f);return u}mergeHandlerResult(r,u,f,g,v){if(!f)return;l.extend(r,f);const E={handlerName:g,originalEvent:f.originalEvent||v};f.zoomDelta!==void 0&&(u.zoom=E),f.panDelta!==void 0&&(u.drag=E),f.pitchDelta!==void 0&&(u.pitch=E),f.bearingDelta!==void 0&&(u.rotate=E)}_applyChanges(){const r={},u={},f={};for(const[g,v,E]of this._changes)g.panDelta&&(r.panDelta=(r.panDelta||new l.Point(0,0))._add(g.panDelta)),g.zoomDelta&&(r.zoomDelta=(r.zoomDelta||0)+g.zoomDelta),g.bearingDelta&&(r.bearingDelta=(r.bearingDelta||0)+g.bearingDelta),g.pitchDelta&&(r.pitchDelta=(r.pitchDelta||0)+g.pitchDelta),g.around!==void 0&&(r.around=g.around),g.pinchAround!==void 0&&(r.pinchAround=g.pinchAround),g.noInertia&&(r.noInertia=g.noInertia),l.extend(u,v),l.extend(f,E);this._updateMapTransform(r,u,f),this._changes=[]}_updateMapTransform(r,u,f){const g=this._map,v=g._getTransformForUpdate(),E=g.terrain;if(!(pc(r)||E&&this._terrainMovement))return this._fireEvents(u,f,!0);let{panDelta:T,zoomDelta:A,bearingDelta:R,pitchDelta:D,around:z,pinchAround:G}=r;G!==void 0&&(z=G),g._stop(!0),z=z||g.transform.centerPoint;const Q=v.pointLocation(T?z.sub(T):z);R&&(v.bearing+=R),D&&(v.pitch+=D),A&&(v.zoom+=A),E?this._terrainMovement||!u.drag&&!u.zoom?u.drag&&this._terrainMovement?v.center=v.pointLocation(v.centerPoint.sub(T)):v.setLocationAtPoint(Q,z):(this._terrainMovement=!0,this._map._elevationFreeze=!0,v.setLocationAtPoint(Q,z),this._map.once("moveend",()=>{this._map._elevationFreeze=!1,this._terrainMovement=!1,v.recalculateZoom(g.terrain)})):v.setLocationAtPoint(Q,z),g._applyUpdatedTransform(v),this._map._update(),r.noInertia||this._inertia.record(r),this._fireEvents(u,f,!0)}_fireEvents(r,u,f){const g=Ma(this._eventsInProgress),v=Ma(r),E={};for(const D in r){const{originalEvent:z}=r[D];this._eventsInProgress[D]||(E[`${D}start`]=z),this._eventsInProgress[D]=r[D]}!g&&v&&this._fireEvent("movestart",v.originalEvent);for(const D in E)this._fireEvent(D,E[D]);v&&this._fireEvent("move",v.originalEvent);for(const D in r){const{originalEvent:z}=r[D];this._fireEvent(D,z)}const T={};let A;for(const D in this._eventsInProgress){const{handlerName:z,originalEvent:G}=this._eventsInProgress[D];this._handlersById[z].isActive()||(delete this._eventsInProgress[D],A=u[z]||G,T[`${D}end`]=A)}for(const D in T)this._fireEvent(D,T[D]);const R=Ma(this._eventsInProgress);if(f&&(g||v)&&!R){this._updatingCamera=!0;const D=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),z=G=>G!==0&&-this._bearingSnap<G&&G<this._bearingSnap;D?(z(D.bearing||this._map.getBearing())&&(D.bearing=0),D.freezeElevation=!0,this._map.easeTo(D,{originalEvent:A})):(this._map.fire(new l.Event("moveend",{originalEvent:A})),z(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(r,u){this._map.fire(new l.Event(r,u?{originalEvent:u}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(r=>{delete this._frameId,this.handleEvent(new Ju("renderFrame",{timeStamp:r})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}class df extends l.Evented{constructor(r,u){super(),this._renderFrameCallback=()=>{const f=Math.min((l.browser.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(f)),f<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},this._moving=!1,this._zooming=!1,this.transform=r,this._bearingSnap=u.bearingSnap,this.on("moveend",()=>{delete this._requestedCameraState})}getCenter(){return new l.LngLat(this.transform.center.lng,this.transform.center.lat)}setCenter(r,u){return this.jumpTo({center:r},u)}panBy(r,u,f){return r=l.Point.convert(r).mult(-1),this.panTo(this.transform.center,l.extend({offset:r},u),f)}panTo(r,u,f){return this.easeTo(l.extend({center:r},u),f)}getZoom(){return this.transform.zoom}setZoom(r,u){return this.jumpTo({zoom:r},u),this}zoomTo(r,u,f){return this.easeTo(l.extend({zoom:r},u),f)}zoomIn(r,u){return this.zoomTo(this.getZoom()+1,r,u),this}zoomOut(r,u){return this.zoomTo(this.getZoom()-1,r,u),this}getBearing(){return this.transform.bearing}setBearing(r,u){return this.jumpTo({bearing:r},u),this}getPadding(){return this.transform.padding}setPadding(r,u){return this.jumpTo({padding:r},u),this}rotateTo(r,u,f){return this.easeTo(l.extend({bearing:r},u),f)}resetNorth(r,u){return this.rotateTo(0,l.extend({duration:1e3},r),u),this}resetNorthPitch(r,u){return this.easeTo(l.extend({bearing:0,pitch:0,duration:1e3},r),u),this}snapToNorth(r,u){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(r,u):this}getPitch(){return this.transform.pitch}setPitch(r,u){return this.jumpTo({pitch:r},u),this}cameraForBounds(r,u){r=Pt.convert(r);const f=u&&u.bearing||0;return this._cameraForBoxAndBearing(r.getNorthWest(),r.getSouthEast(),f,u)}_cameraForBoxAndBearing(r,u,f,g){const v={top:0,bottom:0,right:0,left:0};if(typeof(g=l.extend({padding:v,offset:[0,0],maxZoom:this.transform.maxZoom},g)).padding=="number"){const Ne=g.padding;g.padding={top:Ne,bottom:Ne,right:Ne,left:Ne}}g.padding=l.extend(v,g.padding);const E=this.transform,T=E.padding,A=E.project(l.LngLat.convert(r)),R=E.project(l.LngLat.convert(u)),D=A.rotate(-f*Math.PI/180),z=R.rotate(-f*Math.PI/180),G=new l.Point(Math.max(D.x,z.x),Math.max(D.y,z.y)),Q=new l.Point(Math.min(D.x,z.x),Math.min(D.y,z.y)),J=G.sub(Q),te=(E.width-(T.left+T.right+g.padding.left+g.padding.right))/J.x,K=(E.height-(T.top+T.bottom+g.padding.top+g.padding.bottom))/J.y;if(K<0||te<0)return void l.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.");const ve=Math.min(E.scaleZoom(E.scale*Math.min(te,K)),g.maxZoom),Me=l.Point.convert(g.offset),se=new l.Point((g.padding.left-g.padding.right)/2,(g.padding.top-g.padding.bottom)/2).rotate(f*Math.PI/180),we=Me.add(se).mult(E.scale/E.zoomScale(ve));return{center:E.unproject(A.add(R).div(2).sub(we)),zoom:ve,bearing:f}}fitBounds(r,u,f){return this._fitInternal(this.cameraForBounds(r,u),u,f)}fitScreenCoordinates(r,u,f,g,v){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(l.Point.convert(r)),this.transform.pointLocation(l.Point.convert(u)),f,g),g,v)}_fitInternal(r,u,f){return r?(delete(u=l.extend(r,u)).padding,u.linear?this.easeTo(u,f):this.flyTo(u,f)):this}jumpTo(r,u){this.stop();const f=this._getTransformForUpdate();let g=!1,v=!1,E=!1;return"zoom"in r&&f.zoom!==+r.zoom&&(g=!0,f.zoom=+r.zoom),r.center!==void 0&&(f.center=l.LngLat.convert(r.center)),"bearing"in r&&f.bearing!==+r.bearing&&(v=!0,f.bearing=+r.bearing),"pitch"in r&&f.pitch!==+r.pitch&&(E=!0,f.pitch=+r.pitch),r.padding==null||f.isPaddingEqual(r.padding)||(f.padding=r.padding),this._applyUpdatedTransform(f),this.fire(new l.Event("movestart",u)).fire(new l.Event("move",u)),g&&this.fire(new l.Event("zoomstart",u)).fire(new l.Event("zoom",u)).fire(new l.Event("zoomend",u)),v&&this.fire(new l.Event("rotatestart",u)).fire(new l.Event("rotate",u)).fire(new l.Event("rotateend",u)),E&&this.fire(new l.Event("pitchstart",u)).fire(new l.Event("pitch",u)).fire(new l.Event("pitchend",u)),this.fire(new l.Event("moveend",u))}calculateCameraOptionsFromTo(r,u,f,g=0){const v=l.MercatorCoordinate.fromLngLat(r,u),E=l.MercatorCoordinate.fromLngLat(f,g),T=E.x-v.x,A=E.y-v.y,R=E.z-v.z,D=Math.hypot(T,A,R);if(D===0)throw new Error("Can't calculate camera options with same From and To");const z=Math.hypot(T,A),G=this.transform.scaleZoom(this.transform.cameraToCenterDistance/D/this.transform.tileSize),Q=180*Math.atan2(T,-A)/Math.PI;let J=180*Math.acos(z/D)/Math.PI;return J=R<0?90-J:90+J,{center:E.toLngLat(),zoom:G,pitch:J,bearing:Q}}easeTo(r,u){this._stop(!1,r.easeId),((r=l.extend({offset:[0,0],duration:500,easing:l.defaultEasing},r)).animate===!1||!r.essential&&l.browser.prefersReducedMotion)&&(r.duration=0);const f=this._getTransformForUpdate(),g=this.getZoom(),v=this.getBearing(),E=this.getPitch(),T=this.getPadding(),A="zoom"in r?+r.zoom:g,R="bearing"in r?this._normalizeBearing(r.bearing,v):v,D="pitch"in r?+r.pitch:E,z="padding"in r?r.padding:f.padding,G=l.Point.convert(r.offset);let Q=f.centerPoint.add(G);const J=f.pointLocation(Q),te=l.LngLat.convert(r.center||J);this._normalizeCenter(te);const K=f.project(J),ve=f.project(te).sub(K),Me=f.zoomScale(A-g);let se,we;r.around&&(se=l.LngLat.convert(r.around),we=f.locationPoint(se));const Ne={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||A!==g,this._rotating=this._rotating||v!==R,this._pitching=this._pitching||D!==E,this._padding=!f.isPaddingEqual(z),this._easeId=r.easeId,this._prepareEase(u,r.noMoveStart,Ne),this.terrain&&this._prepareElevation(te),this._ease($e=>{if(this._zooming&&(f.zoom=l.interpolate.number(g,A,$e)),this._rotating&&(f.bearing=l.interpolate.number(v,R,$e)),this._pitching&&(f.pitch=l.interpolate.number(E,D,$e)),this._padding&&(f.interpolatePadding(T,z,$e),Q=f.centerPoint.add(G)),this.terrain&&!r.freezeElevation&&this._updateElevation($e),se)f.setLocationAtPoint(se,we);else{const We=f.zoomScale(f.zoom-g),ot=A>g?Math.min(2,Me):Math.max(.5,Me),Je=Math.pow(ot,1-$e),dt=f.unproject(K.add(ve.mult($e*Je)).mult(We));f.setLocationAtPoint(f.renderWorldCopies?dt.wrap():dt,Q)}this._applyUpdatedTransform(f),this._fireMoveEvents(u)},$e=>{this.terrain&&this._finalizeElevation(),this._afterEase(u,$e)},r),this}_prepareEase(r,u,f={}){this._moving=!0,u||f.moving||this.fire(new l.Event("movestart",r)),this._zooming&&!f.zooming&&this.fire(new l.Event("zoomstart",r)),this._rotating&&!f.rotating&&this.fire(new l.Event("rotatestart",r)),this._pitching&&!f.pitching&&this.fire(new l.Event("pitchstart",r))}_prepareElevation(r){this._elevationCenter=r,this._elevationStart=this.transform.elevation,this._elevationTarget=this.terrain.getElevationForLngLatZoom(r,this.transform.tileZoom),this._elevationFreeze=!0}_updateElevation(r){this.transform._minEleveationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);const u=this.terrain.getElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);if(r<1&&u!==this._elevationTarget){const f=this._elevationTarget-this._elevationStart;this._elevationStart+=r*(f-(u-(f*r+this._elevationStart))/(1-r)),this._elevationTarget=u}this.transform.elevation=l.interpolate.number(this._elevationStart,this._elevationTarget,r)}_finalizeElevation(){this._elevationFreeze=!1,this.transform.recalculateZoom(this.terrain)}_getTransformForUpdate(){return this.transformCameraUpdate?(this._requestedCameraState||(this._requestedCameraState=this.transform.clone()),this._requestedCameraState):this.transform}_applyUpdatedTransform(r){if(!this.transformCameraUpdate)return;const u=r.clone(),{center:f,zoom:g,pitch:v,bearing:E,elevation:T}=this.transformCameraUpdate(u);f&&(u.center=f),g!==void 0&&(u.zoom=g),v!==void 0&&(u.pitch=v),E!==void 0&&(u.bearing=E),T!==void 0&&(u.elevation=T),this.transform.apply(u)}_fireMoveEvents(r){this.fire(new l.Event("move",r)),this._zooming&&this.fire(new l.Event("zoom",r)),this._rotating&&this.fire(new l.Event("rotate",r)),this._pitching&&this.fire(new l.Event("pitch",r))}_afterEase(r,u){if(this._easeId&&u&&this._easeId===u)return;delete this._easeId;const f=this._zooming,g=this._rotating,v=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,f&&this.fire(new l.Event("zoomend",r)),g&&this.fire(new l.Event("rotateend",r)),v&&this.fire(new l.Event("pitchend",r)),this.fire(new l.Event("moveend",r))}flyTo(r,u){if(!r.essential&&l.browser.prefersReducedMotion){const Ct=l.pick(r,["center","zoom","bearing","pitch","around"]);return this.jumpTo(Ct,u)}this.stop(),r=l.extend({offset:[0,0],speed:1.2,curve:1.42,easing:l.defaultEasing},r);const f=this._getTransformForUpdate(),g=this.getZoom(),v=this.getBearing(),E=this.getPitch(),T=this.getPadding(),A="zoom"in r?l.clamp(+r.zoom,f.minZoom,f.maxZoom):g,R="bearing"in r?this._normalizeBearing(r.bearing,v):v,D="pitch"in r?+r.pitch:E,z="padding"in r?r.padding:f.padding,G=f.zoomScale(A-g),Q=l.Point.convert(r.offset);let J=f.centerPoint.add(Q);const te=f.pointLocation(J),K=l.LngLat.convert(r.center||te);this._normalizeCenter(K);const ve=f.project(te),Me=f.project(K).sub(ve);let se=r.curve;const we=Math.max(f.width,f.height),Ne=we/G,$e=Me.mag();if("minZoom"in r){const Ct=l.clamp(Math.min(r.minZoom,g,A),f.minZoom,f.maxZoom),Fn=we/f.zoomScale(Ct-g);se=Math.sqrt(Fn/$e*2)}const We=se*se;function ot(Ct){const Fn=(Ne*Ne-we*we+(Ct?-1:1)*We*We*$e*$e)/(2*(Ct?Ne:we)*We*$e);return Math.log(Math.sqrt(Fn*Fn+1)-Fn)}function Je(Ct){return(Math.exp(Ct)-Math.exp(-Ct))/2}function dt(Ct){return(Math.exp(Ct)+Math.exp(-Ct))/2}const Mt=ot(!1);let cn=function(Ct){return dt(Mt)/dt(Mt+se*Ct)},_t=function(Ct){return we*((dt(Mt)*(Je(Fn=Mt+se*Ct)/dt(Fn))-Je(Mt))/We)/$e;var Fn},Ht=(ot(!0)-Mt)/se;if(Math.abs($e)<1e-6||!isFinite(Ht)){if(Math.abs(we-Ne)<1e-6)return this.easeTo(r,u);const Ct=Ne<we?-1:1;Ht=Math.abs(Math.log(Ne/we))/se,_t=function(){return 0},cn=function(Fn){return Math.exp(Ct*se*Fn)}}return r.duration="duration"in r?+r.duration:1e3*Ht/("screenSpeed"in r?+r.screenSpeed/se:+r.speed),r.maxDuration&&r.duration>r.maxDuration&&(r.duration=0),this._zooming=!0,this._rotating=v!==R,this._pitching=D!==E,this._padding=!f.isPaddingEqual(z),this._prepareEase(u,!1),this.terrain&&this._prepareElevation(K),this._ease(Ct=>{const Fn=Ct*Ht,sn=1/cn(Fn);f.zoom=Ct===1?A:g+f.scaleZoom(sn),this._rotating&&(f.bearing=l.interpolate.number(v,R,Ct)),this._pitching&&(f.pitch=l.interpolate.number(E,D,Ct)),this._padding&&(f.interpolatePadding(T,z,Ct),J=f.centerPoint.add(Q)),this.terrain&&!r.freezeElevation&&this._updateElevation(Ct);const nn=Ct===1?K:f.unproject(ve.add(Me.mult(_t(Fn))).mult(sn));f.setLocationAtPoint(f.renderWorldCopies?nn.wrap():nn,J),this._applyUpdatedTransform(f),this._fireMoveEvents(u)},()=>{this.terrain&&this._finalizeElevation(),this._afterEase(u)},r),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(r,u){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const f=this._onEaseEnd;delete this._onEaseEnd,f.call(this,u)}if(!r){const f=this.handlers;f&&f.stop(!1)}return this}_ease(r,u,f){f.animate===!1||f.duration===0?(r(1),u()):(this._easeStart=l.browser.now(),this._easeOptions=f,this._onEaseFrame=r,this._onEaseEnd=u,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_normalizeBearing(r,u){r=l.wrap(r,-180,180);const f=Math.abs(r-u);return Math.abs(r-360-u)<f&&(r-=360),Math.abs(r+360-u)<f&&(r+=360),r}_normalizeCenter(r){const u=this.transform;if(!u.renderWorldCopies||u.lngRange)return;const f=r.lng-u.center.lng;r.lng+=f>180?-360:f<-180?360:0}queryTerrainElevation(r){return this.terrain?this.terrain.getElevationForLngLatZoom(l.LngLat.convert(r),this.transform.tileZoom)-this.transform.elevation:null}}class ff{constructor(r={}){this._toggleAttribution=()=>{this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show")):(this._container.classList.add("maplibregl-compact-show"),this._container.removeAttribute("open")))},this._updateData=u=>{!u||u.sourceDataType!=="metadata"&&u.sourceDataType!=="visibility"&&u.dataType!=="style"&&u.type!=="terrain"||this._updateAttributions()},this._updateCompact=()=>{this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact===!1?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","maplibregl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show"))},this._updateCompactMinimize=()=>{this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show")},this.options=r}getDefaultPosition(){return"bottom-right"}onAdd(r){return this._map=r,this._compact=this.options&&this.options.compact,this._container=w.create("details","maplibregl-ctrl maplibregl-ctrl-attrib"),this._compactButton=w.create("summary","maplibregl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=w.create("div","maplibregl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){w.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(r,u){const f=this._map._getUIString(`AttributionControl.${u}`);r.title=f,r.setAttribute("aria-label",f)}_updateAttributions(){if(!this._map.style)return;let r=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?r=r.concat(this.options.customAttribution.map(g=>typeof g!="string"?"":g)):typeof this.options.customAttribution=="string"&&r.push(this.options.customAttribution)),this._map.style.stylesheet){const g=this._map.style.stylesheet;this.styleOwner=g.owner,this.styleId=g.id}const u=this._map.style.sourceCaches;for(const g in u){const v=u[g];if(v.used||v.usedForTerrain){const E=v.getSource();E.attribution&&r.indexOf(E.attribution)<0&&r.push(E.attribution)}}r=r.filter(g=>String(g).trim()),r.sort((g,v)=>g.length-v.length),r=r.filter((g,v)=>{for(let E=v+1;E<r.length;E++)if(r[E].indexOf(g)>=0)return!1;return!0});const f=r.join(" | ");f!==this._attribHTML&&(this._attribHTML=f,r.length?(this._innerContainer.innerHTML=f,this._container.classList.remove("maplibregl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty"),this._updateCompact(),this._editLink=null)}}class ns{constructor(r={}){this._updateCompact=()=>{const u=this._container.children;if(u.length){const f=u[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact!==!1&&f.classList.add("maplibregl-compact"):f.classList.remove("maplibregl-compact")}},this.options=r}getDefaultPosition(){return"bottom-left"}onAdd(r){this._map=r,this._compact=this.options&&this.options.compact,this._container=w.create("div","maplibregl-ctrl");const u=w.create("a","maplibregl-ctrl-logo");return u.target="_blank",u.rel="noopener nofollow",u.href="https://maplibre.org/",u.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),u.setAttribute("rel","noopener nofollow"),this._container.appendChild(u),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){w.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}}class mc{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(r){const u=++this._id;return this._queue.push({callback:r,id:u,cancelled:!1}),u}remove(r){const u=this._currentlyRunning,f=u?this._queue.concat(u):this._queue;for(const g of f)if(g.id===r)return void(g.cancelled=!0)}run(r=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");const u=this._currentlyRunning=this._queue;this._queue=[];for(const f of u)if(!f.cancelled&&(f.callback(r),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}const Ot={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","TerrainControl.enableTerrain":"Enable terrain","TerrainControl.disableTerrain":"Disable terrain"};var qt=l.createLayout([{name:"a_pos3d",type:"Int16",components:3}]);class gc extends l.Evented{constructor(r){super(),this.sourceCache=r,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.deltaZoom=1,r.usedForTerrain=!0,r.tileSize=this.tileSize*2**this.deltaZoom}destruct(){this.sourceCache.usedForTerrain=!1,this.sourceCache.tileSize=null}update(r,u){this.sourceCache.update(r,u),this._renderableTilesKeys=[];const f={};for(const g of r.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:u}))f[g.key]=!0,this._renderableTilesKeys.push(g.key),this._tiles[g.key]||(g.posMatrix=new Float64Array(16),l.ortho(g.posMatrix,0,l.EXTENT,0,l.EXTENT,0,1),this._tiles[g.key]=new ct(g,this.tileSize));for(const g in this._tiles)f[g]||delete this._tiles[g]}freeRtt(r){for(const u in this._tiles){const f=this._tiles[u];(!r||f.tileID.equals(r)||f.tileID.isChildOf(r)||r.isChildOf(f.tileID))&&(f.rtt=[])}}getRenderableTiles(){return this._renderableTilesKeys.map(r=>this.getTileByID(r))}getTileByID(r){return this._tiles[r]}getTerrainCoords(r){const u={};for(const f of this._renderableTilesKeys){const g=this._tiles[f].tileID;if(g.canonical.equals(r.canonical)){const v=r.clone();v.posMatrix=new Float64Array(16),l.ortho(v.posMatrix,0,l.EXTENT,0,l.EXTENT,0,1),u[f]=v}else if(g.canonical.isChildOf(r.canonical)){const v=r.clone();v.posMatrix=new Float64Array(16);const E=g.canonical.z-r.canonical.z,T=g.canonical.x-(g.canonical.x>>E<<E),A=g.canonical.y-(g.canonical.y>>E<<E),R=l.EXTENT>>E;l.ortho(v.posMatrix,0,R,0,R,0,1),l.translate(v.posMatrix,v.posMatrix,[-T*R,-A*R,0]),u[f]=v}else if(r.canonical.isChildOf(g.canonical)){const v=r.clone();v.posMatrix=new Float64Array(16);const E=r.canonical.z-g.canonical.z,T=r.canonical.x-(r.canonical.x>>E<<E),A=r.canonical.y-(r.canonical.y>>E<<E),R=l.EXTENT>>E;l.ortho(v.posMatrix,0,l.EXTENT,0,l.EXTENT,0,1),l.translate(v.posMatrix,v.posMatrix,[T*R,A*R,0]),l.scale(v.posMatrix,v.posMatrix,[1/2**E,1/2**E,0]),u[f]=v}}return u}getSourceTile(r,u){const f=this.sourceCache._source;let g=r.overscaledZ-this.deltaZoom;if(g>f.maxzoom&&(g=f.maxzoom),g<f.minzoom)return null;this._sourceTileCache[r.key]||(this._sourceTileCache[r.key]=r.scaledTo(g).key);let v=this.sourceCache.getTileByID(this._sourceTileCache[r.key]);if((!v||!v.dem)&&u)for(;g>=f.minzoom&&(!v||!v.dem);)v=this.sourceCache.getTileByID(r.scaledTo(g--).key);return v}tilesAfterTime(r=Date.now()){return Object.values(this._tiles).filter(u=>u.timeAdded>=r)}}class Qu{constructor(r,u,f){this.painter=r,this.sourceCache=new gc(u),this.options=f,this.exaggeration=typeof f.exaggeration=="number"?f.exaggeration:1,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024}getDEMElevation(r,u,f,g=l.EXTENT){var v;if(!(u>=0&&u<g&&f>=0&&f<g))return 0;const E=this.getTerrainData(r),T=(v=E.tile)===null||v===void 0?void 0:v.dem;if(!T)return 0;const A=function(J,te,K){var ve=te[0],Me=te[1];return J[0]=K[0]*ve+K[4]*Me+K[12],J[1]=K[1]*ve+K[5]*Me+K[13],J}([],[u/g*l.EXTENT,f/g*l.EXTENT],E.u_terrain_matrix),R=[A[0]*T.dim,A[1]*T.dim],D=Math.floor(R[0]),z=Math.floor(R[1]),G=R[0]-D,Q=R[1]-z;return T.get(D,z)*(1-G)*(1-Q)+T.get(D+1,z)*G*(1-Q)+T.get(D,z+1)*(1-G)*Q+T.get(D+1,z+1)*G*Q}getElevationForLngLatZoom(r,u){const{tileID:f,mercatorX:g,mercatorY:v}=this._getOverscaledTileIDFromLngLatZoom(r,u);return this.getElevation(f,g%l.EXTENT,v%l.EXTENT,l.EXTENT)}getElevation(r,u,f,g=l.EXTENT){return this.getDEMElevation(r,u,f,g)*this.exaggeration}getTerrainData(r){if(!this._emptyDemTexture){const g=this.painter.context,v=new l.RGBAImage({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new ae(g,v,g.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new ae(g,new l.RGBAImage({width:1,height:1}),g.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(g.gl.NEAREST,g.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=l.identity([])}const u=this.sourceCache.getSourceTile(r,!0);if(u&&u.dem&&(!u.demTexture||u.needsTerrainPrepare)){const g=this.painter.context;u.demTexture=this.painter.getTileTexture(u.dem.stride),u.demTexture?u.demTexture.update(u.dem.getPixels(),{premultiply:!1}):u.demTexture=new ae(g,u.dem.getPixels(),g.gl.RGBA,{premultiply:!1}),u.demTexture.bind(g.gl.NEAREST,g.gl.CLAMP_TO_EDGE),u.needsTerrainPrepare=!1}const f=u&&u+u.tileID.key+r.key;if(f&&!this._demMatrixCache[f]){const g=this.sourceCache.sourceCache._source.maxzoom;let v=r.canonical.z-u.tileID.canonical.z;r.overscaledZ>r.canonical.z&&(r.canonical.z>=g?v=r.canonical.z-g:l.warnOnce("cannot calculate elevation if elevation maxzoom > source.maxzoom"));const E=r.canonical.x-(r.canonical.x>>v<<v),T=r.canonical.y-(r.canonical.y>>v<<v),A=l.fromScaling(new Float64Array(16),[1/(l.EXTENT<<v),1/(l.EXTENT<<v),0]);l.translate(A,A,[E*l.EXTENT,T*l.EXTENT,0]),this._demMatrixCache[r.key]={matrix:A,coord:r}}return{u_depth:2,u_terrain:3,u_terrain_dim:u&&u.dem&&u.dem.dim||1,u_terrain_matrix:f?this._demMatrixCache[r.key].matrix:this._emptyDemMatrix,u_terrain_unpack:u&&u.dem&&u.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_exaggeration:this.exaggeration,texture:(u&&u.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:u}}getFramebuffer(r){const u=this.painter,f=u.width/devicePixelRatio,g=u.height/devicePixelRatio;return!this._fbo||this._fbo.width===f&&this._fbo.height===g||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new ae(u.context,{width:f,height:g,data:null},u.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(u.context.gl.NEAREST,u.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new ae(u.context,{width:f,height:g,data:null},u.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(u.context.gl.NEAREST,u.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=u.context.createFramebuffer(f,g,!0,!1),this._fbo.depthAttachment.set(u.context.createRenderbuffer(u.context.gl.DEPTH_COMPONENT16,f,g))),this._fbo.colorAttachment.set(r==="coords"?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){const r=this.painter.context;if(this._coordsTexture)return this._coordsTexture;const u=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let v=0,E=0;v<this._coordsTextureSize;v++)for(let T=0;T<this._coordsTextureSize;T++,E+=4)u[E+0]=255&T,u[E+1]=255&v,u[E+2]=T>>8<<4|v>>8,u[E+3]=0;const f=new l.RGBAImage({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(u.buffer)),g=new ae(r,f,r.gl.RGBA,{premultiply:!1});return g.bind(r.gl.NEAREST,r.gl.CLAMP_TO_EDGE),this._coordsTexture=g,g}pointCoordinate(r){const u=new Uint8Array(4),f=this.painter.context,g=f.gl;f.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),g.readPixels(r.x,this.painter.height/devicePixelRatio-r.y-1,1,1,g.RGBA,g.UNSIGNED_BYTE,u),f.bindFramebuffer.set(null);const v=u[0]+(u[2]>>4<<8),E=u[1]+((15&u[2])<<8),T=this.coordsIndex[255-u[3]],A=T&&this.sourceCache.getTileByID(T);if(!A)return null;const R=this._coordsTextureSize,D=(1<<A.tileID.canonical.z)*R;return new l.MercatorCoordinate((A.tileID.canonical.x*R+v)/D,(A.tileID.canonical.y*R+E)/D,this.getElevation(A.tileID,v,E,R))}getTerrainMesh(){if(this._mesh)return this._mesh;const r=this.painter.context,u=new l.Pos3dArray,f=new l.TriangleIndexArray,g=this.meshSize,v=l.EXTENT/g,E=g*g;for(let z=0;z<=g;z++)for(let G=0;G<=g;G++)u.emplaceBack(G*v,z*v,0);for(let z=0;z<E;z+=g+1)for(let G=0;G<g;G++)f.emplaceBack(G+z,g+G+z+1,g+G+z+2),f.emplaceBack(G+z,g+G+z+2,G+z+1);const T=u.length,A=T+2*(g+1);for(const z of[0,1])for(let G=0;G<=g;G++)for(const Q of[0,1])u.emplaceBack(G*v,z*l.EXTENT,Q);for(let z=0;z<2*g;z+=2)f.emplaceBack(A+z,A+z+1,A+z+3),f.emplaceBack(A+z,A+z+3,A+z+2),f.emplaceBack(T+z,T+z+3,T+z+1),f.emplaceBack(T+z,T+z+2,T+z+3);const R=u.length,D=R+2*(g+1);for(const z of[0,1])for(let G=0;G<=g;G++)for(const Q of[0,1])u.emplaceBack(z*l.EXTENT,G*v,Q);for(let z=0;z<2*g;z+=2)f.emplaceBack(R+z,R+z+1,R+z+3),f.emplaceBack(R+z,R+z+3,R+z+2),f.emplaceBack(D+z,D+z+3,D+z+1),f.emplaceBack(D+z,D+z+2,D+z+3);return this._mesh={indexBuffer:r.createIndexBuffer(f),vertexBuffer:r.createVertexBuffer(u,qt.members),segments:l.SegmentVector.simpleSegment(0,0,u.length,f.length)},this._mesh}getMeshFrameDelta(r){return 2*Math.PI*l.earthRadius/Math.pow(2,r)/5}getMinTileElevationForLngLatZoom(r,u){var f;const{tileID:g}=this._getOverscaledTileIDFromLngLatZoom(r,u);return(f=this.getMinMaxElevation(g).minElevation)!==null&&f!==void 0?f:0}getMinMaxElevation(r){const u=this.getTerrainData(r).tile,f={minElevation:null,maxElevation:null};return u&&u.dem&&(f.minElevation=u.dem.min*this.exaggeration,f.maxElevation=u.dem.max*this.exaggeration),f}_getOverscaledTileIDFromLngLatZoom(r,u){const f=l.MercatorCoordinate.fromLngLat(r.wrap()),g=(1<<u)*l.EXTENT,v=f.x*g,E=f.y*g,T=Math.floor(v/l.EXTENT),A=Math.floor(E/l.EXTENT);return{tileID:new l.OverscaledTileID(u,0,u,T,A),mercatorX:v,mercatorY:E}}}class eh{constructor(r,u,f){this._context=r,this._size=u,this._tileSize=f,this._objects=[],this._recentlyUsed=[],this._stamp=0}destruct(){for(const r of this._objects)r.texture.destroy(),r.fbo.destroy()}_createObject(r){const u=this._context.createFramebuffer(this._tileSize,this._tileSize,!0,!0),f=new ae(this._context,{width:this._tileSize,height:this._tileSize,data:null},this._context.gl.RGBA);return f.bind(this._context.gl.LINEAR,this._context.gl.CLAMP_TO_EDGE),u.depthAttachment.set(this._context.createRenderbuffer(this._context.gl.DEPTH_STENCIL,this._tileSize,this._tileSize)),u.colorAttachment.set(f.texture),{id:r,fbo:u,texture:f,stamp:-1,inUse:!1}}getObjectForId(r){return this._objects[r]}useObject(r){r.inUse=!0,this._recentlyUsed=this._recentlyUsed.filter(u=>r.id!==u),this._recentlyUsed.push(r.id)}stampObject(r){r.stamp=++this._stamp}getOrCreateFreeObject(){for(const u of this._recentlyUsed)if(!this._objects[u].inUse)return this._objects[u];if(this._objects.length>=this._size)throw new Error("No free RenderPool available, call freeAllObjects() required!");const r=this._createObject(this._objects.length);return this._objects.push(r),r}freeObject(r){r.inUse=!1}freeAllObjects(){for(const r of this._objects)this.freeObject(r)}isFull(){return!(this._objects.length<this._size)&&this._objects.some(r=>!r.inUse)===!1}}const ki={background:!0,fill:!0,line:!0,raster:!0,hillshade:!0};class pf{constructor(r,u){this.painter=r,this.terrain=u,this.pool=new eh(r.context,30,u.sourceCache.tileSize*u.qualityFactor)}destruct(){this.pool.destruct()}getTexture(r){return this.pool.getObjectForId(r.rtt[this._stacks.length-1].id).texture}prepareForRender(r,u){this._stacks=[],this._prevType=null,this._rttTiles=[],this._renderableTiles=this.terrain.sourceCache.getRenderableTiles(),this._renderableLayerIds=r._order.filter(f=>!r._layers[f].isHidden(u)),this._coordsDescendingInv={};for(const f in r.sourceCaches){this._coordsDescendingInv[f]={};const g=r.sourceCaches[f].getVisibleCoordinates();for(const v of g){const E=this.terrain.sourceCache.getTerrainCoords(v);for(const T in E)this._coordsDescendingInv[f][T]||(this._coordsDescendingInv[f][T]=[]),this._coordsDescendingInv[f][T].push(E[T])}}this._coordsDescendingInvStr={};for(const f of r._order){const g=r._layers[f],v=g.source;if(ki[g.type]&&!this._coordsDescendingInvStr[v]){this._coordsDescendingInvStr[v]={};for(const E in this._coordsDescendingInv[v])this._coordsDescendingInvStr[v][E]=this._coordsDescendingInv[v][E].map(T=>T.key).sort().join()}}for(const f of this._renderableTiles)for(const g in this._coordsDescendingInvStr){const v=this._coordsDescendingInvStr[g][f.tileID.key];v&&v!==f.rttCoords[g]&&(f.rtt=[])}}renderLayer(r){if(r.isHidden(this.painter.transform.zoom))return!1;const u=r.type,f=this.painter,g=this._renderableLayerIds[this._renderableLayerIds.length-1]===r.id;if(ki[u]&&(this._prevType&&ki[this._prevType]||this._stacks.push([]),this._prevType=u,this._stacks[this._stacks.length-1].push(r.id),!g))return!0;if(ki[this._prevType]||ki[u]&&g){this._prevType=u;const v=this._stacks.length-1,E=this._stacks[v]||[];for(const T of this._renderableTiles){if(this.pool.isFull()&&(lc(this.painter,this.terrain,this._rttTiles),this._rttTiles=[],this.pool.freeAllObjects()),this._rttTiles.push(T),T.rtt[v]){const R=this.pool.getObjectForId(T.rtt[v].id);if(R.stamp===T.rtt[v].stamp){this.pool.useObject(R);continue}}const A=this.pool.getOrCreateFreeObject();this.pool.useObject(A),this.pool.stampObject(A),T.rtt[v]={id:A.id,stamp:A.stamp},f.context.bindFramebuffer.set(A.fbo.framebuffer),f.context.clear({color:l.Color.transparent,stencil:0}),f.currentStencilSource=void 0;for(let R=0;R<E.length;R++){const D=f.style._layers[E[R]],z=D.source?this._coordsDescendingInv[D.source][T.tileID.key]:[T.tileID];f.context.viewport.set([0,0,A.fbo.width,A.fbo.height]),f._renderTileClippingMasks(D,z),f.renderLayer(f,f.style.sourceCaches[D.source],D,z),D.source&&(T.rttCoords[D.source]=this._coordsDescendingInvStr[D.source][T.tileID.key])}}return lc(this.painter,this.terrain,this._rttTiles),this._rttTiles=[],this.pool.freeAllObjects(),ki[u]}return!1}}const ys=b,og={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:void 0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,maplibreLogo:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,maxTileCacheZoomLevels:l.config.MAX_TILE_CACHE_ZOOM_LEVELS,localIdeographFontFamily:"sans-serif",transformRequest:null,transformCameraUpdate:null,fadeDuration:300,crossSourceCollisions:!0,validateStyle:!0,maxCanvasSize:[4096,4096]},fo=_=>{_.touchstart=_.dragStart,_.touchmoveWindow=_.dragMove,_.touchend=_.dragEnd},ii={showCompass:!0,showZoom:!0,visualizePitch:!1};class _i{constructor(r,u,f=!1){this.mousedown=E=>{this.startMouse(l.extend({},E,{ctrlKey:!0,preventDefault:()=>E.preventDefault()}),w.mousePos(this.element,E)),w.addEventListener(window,"mousemove",this.mousemove),w.addEventListener(window,"mouseup",this.mouseup)},this.mousemove=E=>{this.moveMouse(E,w.mousePos(this.element,E))},this.mouseup=E=>{this.mouseRotate.dragEnd(E),this.mousePitch&&this.mousePitch.dragEnd(E),this.offTemp()},this.touchstart=E=>{E.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=w.touchPos(this.element,E.targetTouches)[0],this.startTouch(E,this._startPos),w.addEventListener(window,"touchmove",this.touchmove,{passive:!1}),w.addEventListener(window,"touchend",this.touchend))},this.touchmove=E=>{E.targetTouches.length!==1?this.reset():(this._lastPos=w.touchPos(this.element,E.targetTouches)[0],this.moveTouch(E,this._lastPos))},this.touchend=E=>{E.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),delete this._startPos,delete this._lastPos,this.offTemp()},this.reset=()=>{this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),this.touchRotate.reset(),this.touchPitch&&this.touchPitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()},this._clickTolerance=10;const g=r.dragRotate._mouseRotate.getClickTolerance(),v=r.dragRotate._mousePitch.getClickTolerance();this.element=u,this.mouseRotate=bt({clickTolerance:g,enable:!0}),this.touchRotate=(({enable:E,clickTolerance:T,bearingDegreesPerPixelMoved:A=.8})=>{const R=new uo;return new St({clickTolerance:T,move:(D,z)=>({bearingDelta:(z.x-D.x)*A}),moveStateManager:R,enable:E,assignEvents:fo})})({clickTolerance:g,enable:!0}),this.map=r,f&&(this.mousePitch=fc({clickTolerance:v,enable:!0}),this.touchPitch=(({enable:E,clickTolerance:T,pitchDegreesPerPixelMoved:A=-.5})=>{const R=new uo;return new St({clickTolerance:T,move:(D,z)=>({pitchDelta:(z.y-D.y)*A}),moveStateManager:R,enable:E,assignEvents:fo})})({clickTolerance:v,enable:!0})),w.addEventListener(u,"mousedown",this.mousedown),w.addEventListener(u,"touchstart",this.touchstart,{passive:!1}),w.addEventListener(u,"touchcancel",this.reset)}startMouse(r,u){this.mouseRotate.dragStart(r,u),this.mousePitch&&this.mousePitch.dragStart(r,u),w.disableDrag()}startTouch(r,u){this.touchRotate.dragStart(r,u),this.touchPitch&&this.touchPitch.dragStart(r,u),w.disableDrag()}moveMouse(r,u){const f=this.map,{bearingDelta:g}=this.mouseRotate.dragMove(r,u)||{};if(g&&f.setBearing(f.getBearing()+g),this.mousePitch){const{pitchDelta:v}=this.mousePitch.dragMove(r,u)||{};v&&f.setPitch(f.getPitch()+v)}}moveTouch(r,u){const f=this.map,{bearingDelta:g}=this.touchRotate.dragMove(r,u)||{};if(g&&f.setBearing(f.getBearing()+g),this.touchPitch){const{pitchDelta:v}=this.touchPitch.dragMove(r,u)||{};v&&f.setPitch(f.getPitch()+v)}}off(){const r=this.element;w.removeEventListener(r,"mousedown",this.mousedown),w.removeEventListener(r,"touchstart",this.touchstart,{passive:!1}),w.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),w.removeEventListener(window,"touchend",this.touchend),w.removeEventListener(r,"touchcancel",this.reset),this.offTemp()}offTemp(){w.enableDrag(),w.removeEventListener(window,"mousemove",this.mousemove),w.removeEventListener(window,"mouseup",this.mouseup),w.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),w.removeEventListener(window,"touchend",this.touchend)}}let Ps;function po(_,r,u){if(_=new l.LngLat(_.lng,_.lat),r){const f=new l.LngLat(_.lng-360,_.lat),g=new l.LngLat(_.lng+360,_.lat),v=u.locationPoint(_).distSqr(r);u.locationPoint(f).distSqr(r)<v?_=f:u.locationPoint(g).distSqr(r)<v&&(_=g)}for(;Math.abs(_.lng-u.center.lng)>180;){const f=u.locationPoint(_);if(f.x>=0&&f.y>=0&&f.x<=u.width&&f.y<=u.height)break;_.lng>u.center.lng?_.lng-=360:_.lng+=360}return _}const mo={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function _c(_,r,u){const f=_.classList;for(const g in mo)f.remove(`maplibregl-${u}-anchor-${g}`);f.add(`maplibregl-${u}-anchor-${r}`)}class ml extends l.Evented{constructor(r){if(super(),this._onKeyPress=u=>{const f=u.code,g=u.charCode||u.keyCode;f!=="Space"&&f!=="Enter"&&g!==32&&g!==13||this.togglePopup()},this._onMapClick=u=>{const f=u.originalEvent.target,g=this._element;this._popup&&(f===g||g.contains(f))&&this.togglePopup()},this._update=u=>{if(!this._map)return;this._map.transform.renderWorldCopies&&(this._lngLat=po(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._offset);let f="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?f=`rotateZ(${this._rotation}deg)`:this._rotationAlignment==="map"&&(f=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let g="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?g="rotateX(0deg)":this._pitchAlignment==="map"&&(g=`rotateX(${this._map.getPitch()}deg)`),u&&u.type!=="moveend"||(this._pos=this._pos.round()),w.setTransform(this._element,`${mo[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${g} ${f}`),this._map.terrain&&!this._opacityTimeout&&(this._opacityTimeout=setTimeout(()=>{const v=this._map.unproject(this._pos),E=40075016686e-3*Math.abs(Math.cos(this._lngLat.lat*Math.PI/180))/Math.pow(2,this._map.transform.tileZoom+8);this._element.style.opacity=v.distanceTo(this._lngLat)>20*E?"0.2":"1.0",this._opacityTimeout=null},100))},this._onMove=u=>{if(!this._isDragging){const f=this._clickTolerance||this._map._clickTolerance;this._isDragging=u.point.dist(this._pointerdownPos)>=f}this._isDragging&&(this._pos=u.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new l.Event("dragstart"))),this.fire(new l.Event("drag")))},this._onUp=()=>{this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new l.Event("dragend")),this._state="inactive"},this._addDragHandler=u=>{this._element.contains(u.originalEvent.target)&&(u.preventDefault(),this._positionDelta=u.point.sub(this._pos).add(this._offset),this._pointerdownPos=u.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},this._anchor=r&&r.anchor||"center",this._color=r&&r.color||"#3FB1CE",this._scale=r&&r.scale||1,this._draggable=r&&r.draggable||!1,this._clickTolerance=r&&r.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=r&&r.rotation||0,this._rotationAlignment=r&&r.rotationAlignment||"auto",this._pitchAlignment=r&&r.pitchAlignment&&r.pitchAlignment!=="auto"?r.pitchAlignment:this._rotationAlignment,r&&r.element)this._element=r.element,this._offset=l.Point.convert(r&&r.offset||[0,0]);else{this._defaultMarker=!0,this._element=w.create("div"),this._element.setAttribute("aria-label","Map marker");const u=w.createNS("http://www.w3.org/2000/svg","svg"),f=41,g=27;u.setAttributeNS(null,"display","block"),u.setAttributeNS(null,"height",`${f}px`),u.setAttributeNS(null,"width",`${g}px`),u.setAttributeNS(null,"viewBox",`0 0 ${g} ${f}`);const v=w.createNS("http://www.w3.org/2000/svg","g");v.setAttributeNS(null,"stroke","none"),v.setAttributeNS(null,"stroke-width","1"),v.setAttributeNS(null,"fill","none"),v.setAttributeNS(null,"fill-rule","evenodd");const E=w.createNS("http://www.w3.org/2000/svg","g");E.setAttributeNS(null,"fill-rule","nonzero");const T=w.createNS("http://www.w3.org/2000/svg","g");T.setAttributeNS(null,"transform","translate(3.0, 29.0)"),T.setAttributeNS(null,"fill","#000000");const A=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const ve of A){const Me=w.createNS("http://www.w3.org/2000/svg","ellipse");Me.setAttributeNS(null,"opacity","0.04"),Me.setAttributeNS(null,"cx","10.5"),Me.setAttributeNS(null,"cy","5.80029008"),Me.setAttributeNS(null,"rx",ve.rx),Me.setAttributeNS(null,"ry",ve.ry),T.appendChild(Me)}const R=w.createNS("http://www.w3.org/2000/svg","g");R.setAttributeNS(null,"fill",this._color);const D=w.createNS("http://www.w3.org/2000/svg","path");D.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),R.appendChild(D);const z=w.createNS("http://www.w3.org/2000/svg","g");z.setAttributeNS(null,"opacity","0.25"),z.setAttributeNS(null,"fill","#000000");const G=w.createNS("http://www.w3.org/2000/svg","path");G.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),z.appendChild(G);const Q=w.createNS("http://www.w3.org/2000/svg","g");Q.setAttributeNS(null,"transform","translate(6.0, 7.0)"),Q.setAttributeNS(null,"fill","#FFFFFF");const J=w.createNS("http://www.w3.org/2000/svg","g");J.setAttributeNS(null,"transform","translate(8.0, 8.0)");const te=w.createNS("http://www.w3.org/2000/svg","circle");te.setAttributeNS(null,"fill","#000000"),te.setAttributeNS(null,"opacity","0.25"),te.setAttributeNS(null,"cx","5.5"),te.setAttributeNS(null,"cy","5.5"),te.setAttributeNS(null,"r","5.4999962");const K=w.createNS("http://www.w3.org/2000/svg","circle");K.setAttributeNS(null,"fill","#FFFFFF"),K.setAttributeNS(null,"cx","5.5"),K.setAttributeNS(null,"cy","5.5"),K.setAttributeNS(null,"r","5.4999962"),J.appendChild(te),J.appendChild(K),E.appendChild(T),E.appendChild(R),E.appendChild(z),E.appendChild(Q),E.appendChild(J),u.appendChild(E),u.setAttributeNS(null,"height",f*this._scale+"px"),u.setAttributeNS(null,"width",g*this._scale+"px"),this._element.appendChild(u),this._offset=l.Point.convert(r&&r.offset||[0,-14])}if(this._element.classList.add("maplibregl-marker"),this._element.addEventListener("dragstart",u=>{u.preventDefault()}),this._element.addEventListener("mousedown",u=>{u.preventDefault()}),_c(this._element,this._anchor,"marker"),r&&r.className)for(const u of r.className.split(" "))this._element.classList.add(u);this._popup=null}addTo(r){return this.remove(),this._map=r,r.getCanvasContainer().appendChild(this._element),r.on("move",this._update),r.on("moveend",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),w.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(r){return this._lngLat=l.LngLat.convert(r),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(r){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),r){if(!("offset"in r.options)){const g=Math.sqrt(Math.pow(13.5,2)/2);r.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[g,-1*(38.1-13.5+g)],"bottom-right":[-g,-1*(38.1-13.5+g)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=r,this._lngLat&&this._popup.setLngLat(this._lngLat),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}getPopup(){return this._popup}togglePopup(){const r=this._popup;return r?(r.isOpen()?r.remove():r.addTo(this._map),this):this}getOffset(){return this._offset}setOffset(r){return this._offset=l.Point.convert(r),this._update(),this}addClassName(r){this._element.classList.add(r)}removeClassName(r){this._element.classList.remove(r)}toggleClassName(r){return this._element.classList.toggle(r)}setDraggable(r){return this._draggable=!!r,this._map&&(r?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(r){return this._rotation=r||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(r){return this._rotationAlignment=r||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(r){return this._pitchAlignment=r&&r!=="auto"?r:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}}const th={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let ta=0,Da=!1;const nh={maxWidth:100,unit:"metric"};function yc(_,r,u){const f=u&&u.maxWidth||100,g=_._container.clientHeight/2,v=_.unproject([0,g]),E=_.unproject([f,g]),T=v.distanceTo(E);if(u&&u.unit==="imperial"){const A=3.2808*T;A>5280?La(r,f,A/5280,_._getUIString("ScaleControl.Miles")):La(r,f,A,_._getUIString("ScaleControl.Feet"))}else u&&u.unit==="nautical"?La(r,f,T/1852,_._getUIString("ScaleControl.NauticalMiles")):T>=1e3?La(r,f,T/1e3,_._getUIString("ScaleControl.Kilometers")):La(r,f,T,_._getUIString("ScaleControl.Meters"))}function La(_,r,u,f){const g=function(v){const E=Math.pow(10,`${Math.floor(v)}`.length-1);let T=v/E;return T=T>=10?10:T>=5?5:T>=3?3:T>=2?2:T>=1?1:function(A){const R=Math.pow(10,Math.ceil(-Math.log(A)/Math.LN10));return Math.round(A*R)/R}(T),E*T}(u);_.style.width=r*(g/u)+"px",_.innerHTML=`${g}&nbsp;${f}`}const ih={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},rh=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function vc(_){if(_){if(typeof _=="number"){const r=Math.round(Math.sqrt(.5*Math.pow(_,2)));return{center:new l.Point(0,0),top:new l.Point(0,_),"top-left":new l.Point(r,r),"top-right":new l.Point(-r,r),bottom:new l.Point(0,-_),"bottom-left":new l.Point(r,-r),"bottom-right":new l.Point(-r,-r),left:new l.Point(_,0),right:new l.Point(-_,0)}}if(_ instanceof l.Point||Array.isArray(_)){const r=l.Point.convert(_);return{center:r,top:r,"top-left":r,"top-right":r,bottom:r,"bottom-left":r,"bottom-right":r,left:r,right:r}}return{center:l.Point.convert(_.center||[0,0]),top:l.Point.convert(_.top||[0,0]),"top-left":l.Point.convert(_["top-left"]||[0,0]),"top-right":l.Point.convert(_["top-right"]||[0,0]),bottom:l.Point.convert(_.bottom||[0,0]),"bottom-left":l.Point.convert(_["bottom-left"]||[0,0]),"bottom-right":l.Point.convert(_["bottom-right"]||[0,0]),left:l.Point.convert(_.left||[0,0]),right:l.Point.convert(_.right||[0,0])}}return vc(new l.Point(0,0))}const sh={extend:(_,...r)=>l.extend(_,...r),run(_){_()},logToElement(_,r=!1,u="log"){const f=window.document.getElementById(u);f&&(r&&(f.innerHTML=""),f.innerHTML+=`<br>${_}`)}},xc=b;class Tn{static get version(){return xc}static get workerCount(){return jt.workerCount}static set workerCount(r){jt.workerCount=r}static get maxParallelImageRequests(){return l.config.MAX_PARALLEL_IMAGE_REQUESTS}static set maxParallelImageRequests(r){l.config.MAX_PARALLEL_IMAGE_REQUESTS=r}static get workerUrl(){return l.config.WORKER_URL}static set workerUrl(r){l.config.WORKER_URL=r}static addProtocol(r,u){l.config.REGISTERED_PROTOCOLS[r]=u}static removeProtocol(r){delete l.config.REGISTERED_PROTOCOLS[r]}}return Tn.Map=class extends df{constructor(_){if(l.PerformanceUtils.mark(l.PerformanceMarkers.create),(_=l.extend({},og,_)).minZoom!=null&&_.maxZoom!=null&&_.minZoom>_.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(_.minPitch!=null&&_.maxPitch!=null&&_.minPitch>_.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(_.minPitch!=null&&_.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(_.maxPitch!=null&&_.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(super(new hc(_.minZoom,_.maxZoom,_.minPitch,_.maxPitch,_.renderWorldCopies),{bearingSnap:_.bearingSnap}),this._cooperativeGesturesOnWheel=r=>{this._onCooperativeGesture(r,r[this._metaKey],1)},this._contextLost=r=>{r.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new l.Event("webglcontextlost",{originalEvent:r}))},this._contextRestored=r=>{this._setupPainter(),this.resize(),this._update(),this.fire(new l.Event("webglcontextrestored",{originalEvent:r}))},this._onMapScroll=r=>{if(r.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},this._onWindowOnline=()=>{this._update()},this._interactive=_.interactive,this._cooperativeGestures=_.cooperativeGestures,this._metaKey=navigator.platform.indexOf("Mac")===0?"metaKey":"ctrlKey",this._maxTileCacheSize=_.maxTileCacheSize,this._maxTileCacheZoomLevels=_.maxTileCacheZoomLevels,this._failIfMajorPerformanceCaveat=_.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=_.preserveDrawingBuffer,this._antialias=_.antialias,this._trackResize=_.trackResize,this._bearingSnap=_.bearingSnap,this._refreshExpiredTiles=_.refreshExpiredTiles,this._fadeDuration=_.fadeDuration,this._crossSourceCollisions=_.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=_.collectResourceTiming,this._renderTaskQueue=new mc,this._controls=[],this._mapId=l.uniqueId(),this._locale=l.extend({},Ot,_.locale),this._clickTolerance=_.clickTolerance,this._overridePixelRatio=_.pixelRatio,this._maxCanvasSize=_.maxCanvasSize,this.transformCameraUpdate=_.transformCameraUpdate,this._imageQueueHandle=le.addThrottleControl(()=>this.isMoving()),this._requestManager=new be(_.transformRequest),typeof _.container=="string"){if(this._container=document.getElementById(_.container),!this._container)throw new Error(`Container '${_.container}' not found.`)}else{if(!(_.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=_.container}if(_.maxBounds&&this.setMaxBounds(_.maxBounds),this._setupContainer(),this._setupPainter(),this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),this.on("terrain",()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)}),this.once("idle",()=>{this._idleTriggered=!0}),typeof window<"u"){addEventListener("online",this._onWindowOnline,!1);let r=!1;this._resizeObserver=new ResizeObserver(u=>{r?this._trackResize&&this.resize(u)._update():r=!0}),this._resizeObserver.observe(this._container)}this.handlers=new hf(this,_),this._cooperativeGestures&&this._setupCooperativeGestures(),this._hash=_.hash&&new Aa(typeof _.hash=="string"&&_.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:_.center,zoom:_.zoom,bearing:_.bearing,pitch:_.pitch}),_.bounds&&(this.resize(),this.fitBounds(_.bounds,l.extend({},_.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=_.localIdeographFontFamily,this._validateStyle=_.validateStyle,_.style&&this.setStyle(_.style,{localIdeographFontFamily:_.localIdeographFontFamily}),_.attributionControl&&this.addControl(new ff({customAttribution:_.customAttribution})),_.maplibreLogo&&this.addControl(new ns,_.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",r=>{this._update(r.dataType==="style"),this.fire(new l.Event(`${r.dataType}data`,r))}),this.on("dataloading",r=>{this.fire(new l.Event(`${r.dataType}dataloading`,r))}),this.on("dataabort",r=>{this.fire(new l.Event("sourcedataabort",r))})}_getMapId(){return this._mapId}addControl(_,r){if(r===void 0&&(r=_.getDefaultPosition?_.getDefaultPosition():"top-right"),!_||!_.onAdd)return this.fire(new l.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const u=_.onAdd(this);this._controls.push(_);const f=this._controlPositions[r];return r.indexOf("bottom")!==-1?f.insertBefore(u,f.firstChild):f.appendChild(u),this}removeControl(_){if(!_||!_.onRemove)return this.fire(new l.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const r=this._controls.indexOf(_);return r>-1&&this._controls.splice(r,1),_.onRemove(this),this}hasControl(_){return this._controls.indexOf(_)>-1}calculateCameraOptionsFromTo(_,r,u,f){return f==null&&this.terrain&&(f=this.terrain.getElevationForLngLatZoom(u,this.transform.tileZoom)),super.calculateCameraOptionsFromTo(_,r,u,f)}resize(_){var r;const u=this._containerDimensions(),f=u[0],g=u[1],v=this._getClampedPixelRatio(f,g);if(this._resizeCanvas(f,g,v),this.painter.resize(f,g,v),this.painter.overLimit()){const T=this.painter.context.gl;this._maxCanvasSize=[T.drawingBufferWidth,T.drawingBufferHeight];const A=this._getClampedPixelRatio(f,g);this._resizeCanvas(f,g,A),this.painter.resize(f,g,A)}this.transform.resize(f,g),(r=this._requestedCameraState)===null||r===void 0||r.resize(f,g);const E=!this._moving;return E&&(this.stop(),this.fire(new l.Event("movestart",_)).fire(new l.Event("move",_))),this.fire(new l.Event("resize",_)),E&&this.fire(new l.Event("moveend",_)),this}_getClampedPixelRatio(_,r){const{0:u,1:f}=this._maxCanvasSize,g=this.getPixelRatio(),v=_*g,E=r*g;return Math.min(v>u?u/v:1,E>f?f/E:1)*g}getPixelRatio(){var _;return(_=this._overridePixelRatio)!==null&&_!==void 0?_:devicePixelRatio}setPixelRatio(_){this._overridePixelRatio=_,this.resize()}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(_){return this.transform.setMaxBounds(Pt.convert(_)),this._update()}setMinZoom(_){if((_=_??-2)>=-2&&_<=this.transform.maxZoom)return this.transform.minZoom=_,this._update(),this.getZoom()<_&&this.setZoom(_),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(_){if((_=_??22)>=this.transform.minZoom)return this.transform.maxZoom=_,this._update(),this.getZoom()>_&&this.setZoom(_),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(_){if((_=_??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(_>=0&&_<=this.transform.maxPitch)return this.transform.minPitch=_,this._update(),this.getPitch()<_&&this.setPitch(_),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(_){if((_=_??60)>85)throw new Error("maxPitch must be less than or equal to 85");if(_>=this.transform.minPitch)return this.transform.maxPitch=_,this._update(),this.getPitch()>_&&this.setPitch(_),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(_){return this.transform.renderWorldCopies=_,this._update()}getCooperativeGestures(){return this._cooperativeGestures}setCooperativeGestures(_){return this._cooperativeGestures=_,this._cooperativeGestures?this._setupCooperativeGestures():this._destroyCooperativeGestures(),this}project(_){return this.transform.locationPoint(l.LngLat.convert(_),this.style&&this.terrain)}unproject(_){return this.transform.pointLocation(l.Point.convert(_),this.terrain)}isMoving(){var _;return this._moving||((_=this.handlers)===null||_===void 0?void 0:_.isMoving())}isZooming(){var _;return this._zooming||((_=this.handlers)===null||_===void 0?void 0:_.isZooming())}isRotating(){var _;return this._rotating||((_=this.handlers)===null||_===void 0?void 0:_.isRotating())}_createDelegatedListener(_,r,u){if(_==="mouseenter"||_==="mouseover"){let f=!1;return{layer:r,listener:u,delegates:{mousemove:v=>{const E=this.getLayer(r)?this.queryRenderedFeatures(v.point,{layers:[r]}):[];E.length?f||(f=!0,u.call(this,new gi(_,this,v.originalEvent,{features:E}))):f=!1},mouseout:()=>{f=!1}}}}if(_==="mouseleave"||_==="mouseout"){let f=!1;return{layer:r,listener:u,delegates:{mousemove:E=>{(this.getLayer(r)?this.queryRenderedFeatures(E.point,{layers:[r]}):[]).length?f=!0:f&&(f=!1,u.call(this,new gi(_,this,E.originalEvent)))},mouseout:E=>{f&&(f=!1,u.call(this,new gi(_,this,E.originalEvent)))}}}}{const f=g=>{const v=this.getLayer(r)?this.queryRenderedFeatures(g.point,{layers:[r]}):[];v.length&&(g.features=v,u.call(this,g),delete g.features)};return{layer:r,listener:u,delegates:{[_]:f}}}}on(_,r,u){if(u===void 0)return super.on(_,r);const f=this._createDelegatedListener(_,r,u);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[_]=this._delegatedListeners[_]||[],this._delegatedListeners[_].push(f);for(const g in f.delegates)this.on(g,f.delegates[g]);return this}once(_,r,u){if(u===void 0)return super.once(_,r);const f=this._createDelegatedListener(_,r,u);for(const g in f.delegates)this.once(g,f.delegates[g]);return this}off(_,r,u){return u===void 0?super.off(_,r):(this._delegatedListeners&&this._delegatedListeners[_]&&(f=>{const g=this._delegatedListeners[_];for(let v=0;v<g.length;v++){const E=g[v];if(E.layer===r&&E.listener===u){for(const T in E.delegates)this.off(T,E.delegates[T]);return g.splice(v,1),this}}})(),this)}queryRenderedFeatures(_,r){if(!this.style)return[];let u;const f=_ instanceof l.Point||Array.isArray(_),g=f?_:[[0,0],[this.transform.width,this.transform.height]];if(r=r||(f?{}:_)||{},g instanceof l.Point||typeof g[0]=="number")u=[l.Point.convert(g)];else{const v=l.Point.convert(g[0]),E=l.Point.convert(g[1]);u=[v,new l.Point(E.x,v.y),E,new l.Point(v.x,E.y),v]}return this.style.queryRenderedFeatures(u,r,this.transform)}querySourceFeatures(_,r){return this.style.querySourceFeatures(_,r)}setStyle(_,r){return(r=l.extend({},{localIdeographFontFamily:this._localIdeographFontFamily,validate:this._validateStyle},r)).diff!==!1&&r.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&_?(this._diffStyle(_,r),this):(this._localIdeographFontFamily=r.localIdeographFontFamily,this._updateStyle(_,r))}setTransformRequest(_){return this._requestManager.setTransformRequest(_),this}_getUIString(_){const r=this._locale[_];if(r==null)throw new Error(`Missing UI string '${_}'`);return r}_updateStyle(_,r){if(r.transformStyle&&this.style&&!this.style._loaded)return void this.style.once("style.load",()=>this._updateStyle(_,r));const u=this.style&&r.transformStyle?this.style.serialize():void 0;return this.style&&(this.style.setEventedParent(null),this.style._remove(!_)),_?(this.style=new Wi(this,r||{}),this.style.setEventedParent(this,{style:this.style}),typeof _=="string"?this.style.loadURL(_,r,u):this.style.loadJSON(_,r,u),this):(delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new Wi(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(_,r){if(typeof _=="string"){const u=this._requestManager.transformRequest(_,he.Style);l.getJSON(u,(f,g)=>{f?this.fire(new l.ErrorEvent(f)):g&&this._updateDiff(g,r)})}else typeof _=="object"&&this._updateDiff(_,r)}_updateDiff(_,r){try{this.style.setState(_,r)&&this._update(!0)}catch(u){l.warnOnce(`Unable to perform style diff: ${u.message||u.error||u}.  Rebuilding the style from scratch.`),this._updateStyle(_,r)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():l.warnOnce("There is no style added to the map.")}addSource(_,r){return this._lazyInitEmptyStyle(),this.style.addSource(_,r),this._update(!0)}isSourceLoaded(_){const r=this.style&&this.style.sourceCaches[_];if(r!==void 0)return r.loaded();this.fire(new l.ErrorEvent(new Error(`There is no source with ID '${_}'`)))}setTerrain(_){if(this.style._checkLoaded(),this._terrainDataCallback&&this.style.off("data",this._terrainDataCallback),_){const r=this.style.sourceCaches[_.source];if(!r)throw new Error(`cannot load terrain, because there exists no source with ID: ${_.source}`);for(const u in this.style._layers){const f=this.style._layers[u];f.type==="hillshade"&&f.source===_.source&&l.warnOnce("You are using the same source for a hillshade layer and for 3D terrain. Please consider using two separate sources to improve rendering quality.")}this.terrain=new Qu(this.painter,r,_),this.painter.renderToTexture=new pf(this.painter,this.terrain),this.transform._minEleveationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this._terrainDataCallback=u=>{u.dataType==="style"?this.terrain.sourceCache.freeRtt():u.dataType==="source"&&u.tile&&(u.sourceId!==_.source||this._elevationFreeze||(this.transform._minEleveationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this.terrain.sourceCache.freeRtt(u.tile.tileID))},this.style.on("data",this._terrainDataCallback)}else this.terrain&&this.terrain.sourceCache.destruct(),this.terrain=null,this.painter.renderToTexture&&this.painter.renderToTexture.destruct(),this.painter.renderToTexture=null,this.transform._minEleveationForCurrentTile=0,this.transform.elevation=0;return this.fire(new l.Event("terrain",{terrain:_})),this}getTerrain(){return this.terrain&&this.terrain.options}areTilesLoaded(){const _=this.style&&this.style.sourceCaches;for(const r in _){const u=_[r]._tiles;for(const f in u){const g=u[f];if(g.state!=="loaded"&&g.state!=="errored")return!1}}return!0}addSourceType(_,r,u){return this._lazyInitEmptyStyle(),this.style.addSourceType(_,r,u)}removeSource(_){return this.style.removeSource(_),this._update(!0)}getSource(_){return this.style.getSource(_)}addImage(_,r,u={}){const{pixelRatio:f=1,sdf:g=!1,stretchX:v,stretchY:E,content:T}=u;if(this._lazyInitEmptyStyle(),!(r instanceof HTMLImageElement||l.isImageBitmap(r))){if(r.width===void 0||r.height===void 0)return this.fire(new l.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:A,height:R,data:D}=r,z=r;return this.style.addImage(_,{data:new l.RGBAImage({width:A,height:R},new Uint8Array(D)),pixelRatio:f,stretchX:v,stretchY:E,content:T,sdf:g,version:0,userImage:z}),z.onAdd&&z.onAdd(this,_),this}}{const{width:A,height:R,data:D}=l.browser.getImageData(r);this.style.addImage(_,{data:new l.RGBAImage({width:A,height:R},D),pixelRatio:f,stretchX:v,stretchY:E,content:T,sdf:g,version:0})}}updateImage(_,r){const u=this.style.getImage(_);if(!u)return this.fire(new l.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const f=r instanceof HTMLImageElement||l.isImageBitmap(r)?l.browser.getImageData(r):r,{width:g,height:v,data:E}=f;if(g===void 0||v===void 0)return this.fire(new l.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(g!==u.data.width||v!==u.data.height)return this.fire(new l.ErrorEvent(new Error("The width and height of the updated image must be that same as the previous version of the image")));const T=!(r instanceof HTMLImageElement||l.isImageBitmap(r));return u.data.replace(E,T),this.style.updateImage(_,u),this}getImage(_){return this.style.getImage(_)}hasImage(_){return _?!!this.style.getImage(_):(this.fire(new l.ErrorEvent(new Error("Missing required image id"))),!1)}removeImage(_){this.style.removeImage(_)}loadImage(_,r){le.getImage(this._requestManager.transformRequest(_,he.Image),r)}listImages(){return this.style.listImages()}addLayer(_,r){return this._lazyInitEmptyStyle(),this.style.addLayer(_,r),this._update(!0)}moveLayer(_,r){return this.style.moveLayer(_,r),this._update(!0)}removeLayer(_){return this.style.removeLayer(_),this._update(!0)}getLayer(_){return this.style.getLayer(_)}setLayerZoomRange(_,r,u){return this.style.setLayerZoomRange(_,r,u),this._update(!0)}setFilter(_,r,u={}){return this.style.setFilter(_,r,u),this._update(!0)}getFilter(_){return this.style.getFilter(_)}setPaintProperty(_,r,u,f={}){return this.style.setPaintProperty(_,r,u,f),this._update(!0)}getPaintProperty(_,r){return this.style.getPaintProperty(_,r)}setLayoutProperty(_,r,u,f={}){return this.style.setLayoutProperty(_,r,u,f),this._update(!0)}getLayoutProperty(_,r){return this.style.getLayoutProperty(_,r)}setGlyphs(_,r={}){return this._lazyInitEmptyStyle(),this.style.setGlyphs(_,r),this._update(!0)}getGlyphs(){return this.style.getGlyphsUrl()}addSprite(_,r,u={}){return this._lazyInitEmptyStyle(),this.style.addSprite(_,r,u,f=>{f||this._update(!0)}),this}removeSprite(_){return this._lazyInitEmptyStyle(),this.style.removeSprite(_),this._update(!0)}getSprite(){return this.style.getSprite()}setSprite(_,r={}){return this._lazyInitEmptyStyle(),this.style.setSprite(_,r,u=>{u||this._update(!0)}),this}setLight(_,r={}){return this._lazyInitEmptyStyle(),this.style.setLight(_,r),this._update(!0)}getLight(){return this.style.getLight()}setFeatureState(_,r){return this.style.setFeatureState(_,r),this._update()}removeFeatureState(_,r){return this.style.removeFeatureState(_,r),this._update()}getFeatureState(_){return this.style.getFeatureState(_)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let _=0,r=0;return this._container&&(_=this._container.clientWidth||400,r=this._container.clientHeight||300),[_,r]}_setupContainer(){const _=this._container;_.classList.add("maplibregl-map");const r=this._canvasContainer=w.create("div","maplibregl-canvas-container",_);this._interactive&&r.classList.add("maplibregl-interactive"),this._canvas=w.create("canvas","maplibregl-canvas",r),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map"),this._canvas.setAttribute("role","region");const u=this._containerDimensions(),f=this._getClampedPixelRatio(u[0],u[1]);this._resizeCanvas(u[0],u[1],f);const g=this._controlContainer=w.create("div","maplibregl-control-container",_),v=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(E=>{v[E]=w.create("div",`maplibregl-ctrl-${E} `,g)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_setupCooperativeGestures(){this._cooperativeGesturesScreen=w.create("div","maplibregl-cooperative-gesture-screen",this._container);let _=typeof this._cooperativeGestures!="boolean"&&this._cooperativeGestures.windowsHelpText?this._cooperativeGestures.windowsHelpText:"Use Ctrl + scroll to zoom the map";navigator.platform.indexOf("Mac")===0&&(_=typeof this._cooperativeGestures!="boolean"&&this._cooperativeGestures.macHelpText?this._cooperativeGestures.macHelpText:"Use ⌘ + scroll to zoom the map"),this._cooperativeGesturesScreen.innerHTML=`
            <div class="maplibregl-desktop-message">${_}</div>
            <div class="maplibregl-mobile-message">${typeof this._cooperativeGestures!="boolean"&&this._cooperativeGestures.mobileHelpText?this._cooperativeGestures.mobileHelpText:"Use two fingers to move the map"}</div>
        `,this._cooperativeGesturesScreen.setAttribute("aria-hidden","true"),this._canvasContainer.addEventListener("wheel",this._cooperativeGesturesOnWheel,!1),this._canvasContainer.classList.add("maplibregl-cooperative-gestures")}_destroyCooperativeGestures(){w.remove(this._cooperativeGesturesScreen),this._canvasContainer.removeEventListener("wheel",this._cooperativeGesturesOnWheel,!1),this._canvasContainer.classList.remove("maplibregl-cooperative-gestures")}_resizeCanvas(_,r,u){this._canvas.width=Math.floor(u*_),this._canvas.height=Math.floor(u*r),this._canvas.style.width=`${_}px`,this._canvas.style.height=`${r}px`}_setupPainter(){const _={alpha:!0,stencil:!0,depth:!0,failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1};let r=null;this._canvas.addEventListener("webglcontextcreationerror",f=>{r={requestedAttributes:_},f&&(r.statusMessage=f.statusMessage,r.type=f.type)},{once:!0});const u=this._canvas.getContext("webgl2",_)||this._canvas.getContext("webgl",_);if(!u){const f="Failed to initialize WebGL";throw r?(r.message=f,new Error(JSON.stringify(r))):new Error(f)}this.painter=new Kd(u,this.transform),C.testSupport(u)}_onCooperativeGesture(_,r,u){return!r&&u<2&&(this._cooperativeGesturesScreen.classList.add("maplibregl-show"),setTimeout(()=>{this._cooperativeGesturesScreen.classList.remove("maplibregl-show")},100)),!1}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(_){return this.style&&this.style._loaded?(this._styleDirty=this._styleDirty||_,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(_){return this._update(),this._renderTaskQueue.add(_)}_cancelRenderFrame(_){this._renderTaskQueue.remove(_)}_render(_){const r=this._idleTriggered?this._fadeDuration:0;if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(_),this._removed)return;let u=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;const g=this.transform.zoom,v=l.browser.now();this.style.zoomHistory.update(g,v);const E=new l.EvaluationParameters(g,{now:v,fadeDuration:r,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),T=E.crossFadingFactor();T===1&&T===this._crossFadingFactor||(u=!0,this._crossFadingFactor=T),this.style.update(E)}this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.terrain?(this.terrain.sourceCache.update(this.transform,this.terrain),this.transform._minEleveationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this._elevationFreeze||(this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))):(this.transform._minEleveationForCurrentTile=0,this.transform.elevation=0),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,r,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:r,showPadding:this.showPadding}),this.fire(new l.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,l.PerformanceUtils.mark(l.PerformanceMarkers.load),this.fire(new l.Event("load"))),this.style&&(this.style.hasTransitions()||u)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles();const f=this._sourcesDirty||this._styleDirty||this._placementDirty;return f||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new l.Event("idle")),!this._loaded||this._fullyLoaded||f||(this._fullyLoaded=!0,l.PerformanceUtils.mark(l.PerformanceMarkers.fullLoad)),this}redraw(){return this.style&&(this._frame&&(this._frame.cancel(),this._frame=null),this._render(0)),this}remove(){var _;this._hash&&this._hash.remove();for(const u of this._controls)u.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof window<"u"&&removeEventListener("online",this._onWindowOnline,!1),le.removeThrottleControl(this._imageQueueHandle),(_=this._resizeObserver)===null||_===void 0||_.disconnect();const r=this.painter.context.gl.getExtension("WEBGL_lose_context");r&&r.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),w.remove(this._canvasContainer),w.remove(this._controlContainer),this._cooperativeGestures&&this._destroyCooperativeGestures(),this._container.classList.remove("maplibregl-map"),l.PerformanceUtils.clearMetrics(),this._removed=!0,this.fire(new l.Event("remove"))}triggerRepaint(){this.style&&!this._frame&&(this._frame=l.browser.frame(_=>{l.PerformanceUtils.frame(_),this._frame=null,this._render(_)}))}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(_){this._showTileBoundaries!==_&&(this._showTileBoundaries=_,this._update())}get showPadding(){return!!this._showPadding}set showPadding(_){this._showPadding!==_&&(this._showPadding=_,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(_){this._showCollisionBoxes!==_&&(this._showCollisionBoxes=_,_?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(_){this._showOverdrawInspector!==_&&(this._showOverdrawInspector=_,this._update())}get repaint(){return!!this._repaint}set repaint(_){this._repaint!==_&&(this._repaint=_,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(_){this._vertices=_,this._update()}get version(){return ys}getCameraTargetElevation(){return this.transform.elevation}},Tn.NavigationControl=class{constructor(_){this._updateZoomButtons=()=>{const r=this._map.getZoom(),u=r===this._map.getMaxZoom(),f=r===this._map.getMinZoom();this._zoomInButton.disabled=u,this._zoomOutButton.disabled=f,this._zoomInButton.setAttribute("aria-disabled",u.toString()),this._zoomOutButton.setAttribute("aria-disabled",f.toString())},this._rotateCompassArrow=()=>{const r=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${this._map.transform.angle*(180/Math.PI)}deg)`:`rotate(${this._map.transform.angle*(180/Math.PI)}deg)`;this._compassIcon.style.transform=r},this._setButtonTitle=(r,u)=>{const f=this._map._getUIString(`NavigationControl.${u}`);r.title=f,r.setAttribute("aria-label",f)},this.options=l.extend({},ii,_),this._container=w.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._container.addEventListener("contextmenu",r=>r.preventDefault()),this.options.showZoom&&(this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in",r=>this._map.zoomIn({},{originalEvent:r})),w.create("span","maplibregl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out",r=>this._map.zoomOut({},{originalEvent:r})),w.create("span","maplibregl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(this._compass=this._createButton("maplibregl-ctrl-compass",r=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:r}):this._map.resetNorth({},{originalEvent:r})}),this._compassIcon=w.create("span","maplibregl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}onAdd(_){return this._map=_,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new _i(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){w.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(_,r){const u=w.create("button",_,this._container);return u.type="button",u.addEventListener("click",r),u}},Tn.GeolocateControl=class extends l.Evented{constructor(_){super(),this._onSuccess=r=>{if(this._map){if(this._isOutOfMapMaxBounds(r))return this._setErrorState(),this.fire(new l.Event("outofmaxbounds",r)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=r,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(r),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(r),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale"),this.fire(new l.Event("geolocate",r)),this._finish()}},this._updateCamera=r=>{const u=new l.LngLat(r.coords.longitude,r.coords.latitude),f=r.coords.accuracy,g=this._map.getBearing(),v=l.extend({bearing:g},this.options.fitBoundsOptions),E=Pt.fromLngLat(u,f);this._map.fitBounds(E,v,{geolocateSource:!0})},this._updateMarker=r=>{if(r){const u=new l.LngLat(r.coords.longitude,r.coords.latitude);this._accuracyCircleMarker.setLngLat(u).addTo(this._map),this._userLocationDotMarker.setLngLat(u).addTo(this._map),this._accuracy=r.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},this._onZoom=()=>{this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},this._onError=r=>{if(this._map){if(this.options.trackUserLocation)if(r.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const u=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=u,this._geolocateButton.setAttribute("aria-label",u),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(r.code===3&&Da)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale"),this.fire(new l.Event("error",r)),this._finish()}},this._finish=()=>{this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},this._setupUI=r=>{if(this._map){if(this._container.addEventListener("contextmenu",u=>u.preventDefault()),this._geolocateButton=w.create("button","maplibregl-ctrl-geolocate",this._container),w.create("span","maplibregl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",r===!1){l.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");const u=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=u,this._geolocateButton.setAttribute("aria-label",u)}else{const u=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=u,this._geolocateButton.setAttribute("aria-label",u)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=w.create("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new ml({element:this._dotElement}),this._circleElement=w.create("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new ml({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",u=>{u.geolocateSource||this._watchState!=="ACTIVE_LOCK"||u.originalEvent&&u.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new l.Event("trackuserlocationend")))})}},this.options=l.extend({},th,_)}onAdd(_){return this._map=_,this._container=w.create("div","maplibregl-ctrl maplibregl-ctrl-group"),function(r,u=!1){Ps===void 0||u?window.navigator.permissions!==void 0?window.navigator.permissions.query({name:"geolocation"}).then(f=>{Ps=f.state!=="denied",r(Ps)}).catch(()=>{Ps=!!window.navigator.geolocation,r(Ps)}):(Ps=!!window.navigator.geolocation,r(Ps)):r(Ps)}(this._setupUI),this._container}onRemove(){this._geolocationWatchID!==void 0&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),w.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,ta=0,Da=!1}_isOutOfMapMaxBounds(_){const r=this._map.getMaxBounds(),u=_.coords;return r&&(u.longitude<r.getWest()||u.longitude>r.getEast()||u.latitude<r.getSouth()||u.latitude>r.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_updateCircleRadius(){const _=this._map.getBounds(),r=_.getSouthEast(),u=_.getNorthEast(),f=r.distanceTo(u),g=Math.ceil(this._accuracy/(f/this._map._container.clientHeight)*2);this._circleElement.style.width=`${g}px`,this._circleElement.style.height=`${g}px`}trigger(){if(!this._setup)return l.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new l.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":ta--,Da=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this.fire(new l.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new l.Event("trackuserlocationstart"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let _;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),ta++,ta>1?(_={maximumAge:6e5,timeout:0},Da=!0):(_=this.options.positionOptions,Da=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,_)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},Tn.AttributionControl=ff,Tn.LogoControl=ns,Tn.ScaleControl=class{constructor(_){this._onMove=()=>{yc(this._map,this._container,this.options)},this.setUnit=r=>{this.options.unit=r,yc(this._map,this._container,this.options)},this.options=l.extend({},nh,_)}getDefaultPosition(){return"bottom-left"}onAdd(_){return this._map=_,this._container=w.create("div","maplibregl-ctrl maplibregl-ctrl-scale",_.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){w.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}},Tn.FullscreenControl=class extends l.Evented{constructor(_={}){super(),this._onFullscreenChange=()=>{(window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement)===this._container!==this._fullscreen&&this._handleFullscreenChange()},this._onClickFullscreen=()=>{this._isFullscreen()?this._exitFullscreen():this._requestFullscreen()},this._fullscreen=!1,_&&_.container&&(_.container instanceof HTMLElement?this._container=_.container:l.warnOnce("Full screen control 'container' must be a DOM element.")),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(_){return this._map=_,this._container||(this._container=this._map.getContainer()),this._controlContainer=w.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),this._controlContainer}onRemove(){w.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._onFullscreenChange)}_setupUI(){const _=this._fullscreenButton=w.create("button","maplibregl-ctrl-fullscreen",this._controlContainer);w.create("span","maplibregl-ctrl-icon",_).setAttribute("aria-hidden","true"),_.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._onFullscreenChange)}_updateTitle(){const _=this._getTitle();this._fullscreenButton.setAttribute("aria-label",_),this._fullscreenButton.title=_}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_handleFullscreenChange(){this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._updateTitle(),this._fullscreen?(this.fire(new l.Event("fullscreenstart")),this._map._cooperativeGestures&&(this._prevCooperativeGestures=this._map._cooperativeGestures,this._map.setCooperativeGestures())):(this.fire(new l.Event("fullscreenend")),this._prevCooperativeGestures&&(this._map.setCooperativeGestures(this._prevCooperativeGestures),delete this._prevCooperativeGestures))}_exitFullscreen(){window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen?window.document.webkitCancelFullScreen():this._togglePseudoFullScreen()}_requestFullscreen(){this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen?this._container.webkitRequestFullscreen():this._togglePseudoFullScreen()}_togglePseudoFullScreen(){this._container.classList.toggle("maplibregl-pseudo-fullscreen"),this._handleFullscreenChange(),this._map.resize()}},Tn.TerrainControl=class{constructor(_){this._toggleTerrain=()=>{this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()},this._updateTerrainIcon=()=>{this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.disableTerrain")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.enableTerrain"))},this.options=_}onAdd(_){return this._map=_,this._container=w.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=w.create("button","maplibregl-ctrl-terrain",this._container),w.create("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){w.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}},Tn.Popup=class extends l.Evented{constructor(_){super(),this.remove=()=>(this._content&&w.remove(this._content),this._container&&(w.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),delete this._map),this.fire(new l.Event("close")),this),this._onMouseUp=r=>{this._update(r.point)},this._onMouseMove=r=>{this._update(r.point)},this._onDrag=r=>{this._update(r.point)},this._update=r=>{if(!this._map||!this._lngLat&&!this._trackPointer||!this._content)return;if(!this._container){if(this._container=w.create("div","maplibregl-popup",this._map.getContainer()),this._tip=w.create("div","maplibregl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className)for(const E of this.options.className.split(" "))this._container.classList.add(E);this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer")}if(this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=po(this._lngLat,this._pos,this._map.transform)),this._trackPointer&&!r)return;const u=this._pos=this._trackPointer&&r?r:this._map.project(this._lngLat);let f=this.options.anchor;const g=vc(this.options.offset);if(!f){const E=this._container.offsetWidth,T=this._container.offsetHeight;let A;A=u.y+g.bottom.y<T?["top"]:u.y>this._map.transform.height-T?["bottom"]:[],u.x<E/2?A.push("left"):u.x>this._map.transform.width-E/2&&A.push("right"),f=A.length===0?"bottom":A.join("-")}const v=u.add(g[f]).round();w.setTransform(this._container,`${mo[f]} translate(${v.x}px,${v.y}px)`),_c(this._container,f,"popup")},this._onClose=()=>{this.remove()},this.options=l.extend(Object.create(ih),_)}addTo(_){return this._map&&this.remove(),this._map=_,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")):this._map.on("move",this._update),this.fire(new l.Event("open")),this}isOpen(){return!!this._map}getLngLat(){return this._lngLat}setLngLat(_){return this._lngLat=l.LngLat.convert(_),this._pos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")),this}getElement(){return this._container}setText(_){return this.setDOMContent(document.createTextNode(_))}setHTML(_){const r=document.createDocumentFragment(),u=document.createElement("body");let f;for(u.innerHTML=_;f=u.firstChild,f;)r.appendChild(f);return this.setDOMContent(r)}getMaxWidth(){var _;return(_=this._container)===null||_===void 0?void 0:_.style.maxWidth}setMaxWidth(_){return this.options.maxWidth=_,this._update(),this}setDOMContent(_){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=w.create("div","maplibregl-popup-content",this._container);return this._content.appendChild(_),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(_){this._container&&this._container.classList.add(_)}removeClassName(_){this._container&&this._container.classList.remove(_)}setOffset(_){return this.options.offset=_,this._update(),this}toggleClassName(_){if(this._container)return this._container.classList.toggle(_)}_createCloseButton(){this.options.closeButton&&(this._closeButton=w.create("button","maplibregl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const _=this._container.querySelector(rh);_&&_.focus()}},Tn.Marker=ml,Tn.Style=Wi,Tn.LngLat=l.LngLat,Tn.LngLatBounds=Pt,Tn.Point=l.Point,Tn.MercatorCoordinate=l.MercatorCoordinate,Tn.Evented=l.Evented,Tn.AJAXError=l.AJAXError,Tn.config=l.config,Tn.CanvasSource=U,Tn.GeoJSONSource=Fe,Tn.ImageSource=ft,Tn.RasterDEMTileSource=Ke,Tn.RasterTileSource=xe,Tn.VectorTileSource=He,Tn.VideoSource=X,Tn.setRTLTextPlugin=l.setRTLTextPlugin,Tn.getRTLTextPluginStatus=l.getRTLTextPluginStatus,Tn.prewarm=function(){fn().acquire(Be)},Tn.clearPrewarmedResources=function(){const _=tn;_&&(_.isPreloaded()&&_.numActive()===1?(_.release(Be),tn=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},sh.extend(Tn,{isSafari:l.isSafari,getPerformanceMetrics:l.PerformanceUtils.getPerformanceMetrics}),Tn});var m=c;return m})})(IE);var WM=IE.exports;const Mh=ZM(WM);class f1{static getGeoJSON(){const t=[];return Array.prototype.forEach.call(Ni().filteredAssociationsWithoutMapFilter,i=>{t.push({id:i.id,properties:{id:i.id,name:i.name,country:i.country},geometry:{type:"Point",coordinates:[i.coords.y,i.coords.x]}})}),{type:"FeatureCollection",features:t}}static getBounds(t){const i=t.map(a=>a.geometry.coordinates);return i.reduce((a,c)=>a.extend(c),new Mh.LngLatBounds(i[0],i[0]))}}class YM{constructor(){Qn(this,"_map");Qn(this,"_container")}onAdd(t){this._map=t,this._container=document.createElement("div"),this._container.className="maplibregl-ctrl maplibregl-ctrl-group";const i=document.createElement("button");i.className="maplibregl-ctrl-zoom-extent";const a=document.createElement("span");return a.className="maplibregl-ctrl-icon",i.appendChild(a),this._container.appendChild(i),this._container.addEventListener("click",()=>{xi().triggerZoomReset=!xi().triggerZoomReset}),this._container}onRemove(){this._container.parentNode.removeChild(this._container),this._map=void 0}}var XM=Object.defineProperty,KM=Object.getOwnPropertyDescriptor,Xo=(e,t,i,a)=>{for(var c=a>1?void 0:a?KM(t,i):t,d=e.length-1,m;d>=0;d--)(m=e[d])&&(c=(a?m(t,i,c):m(c))||c);return a&&c&&XM(t,i,c),c};let va=class extends $r{constructor(){super(...arguments);Qn(this,"map",null);Qn(this,"geojsonData",null);Qn(this,"defaultZoomExtent",null);Qn(this,"layers",{ASSOC:"association",ASSOC_CLUSTER:"association-cluster",ASSOC_CLUSTER_COUNT:"association-cluster-count",ASSOC_CLUSTER_BG:"association-cluster-bg",UNCLUSTERED_POINT:"unclustered-point"})}async mounted(){this.map=new Mh.Map({container:"map",style:"https://api.maptiler.com/maps/dataviz/style.json?key=0tupl15DKhXOvwp27x8c",center:[0,0],zoom:1}),this.setMapPadding(),this.map.dragRotate.disable(),this.map.touchZoomRotate.disableRotation();var i=new Mh.NavigationControl({showCompass:!1});this.map.addControl(i,"top-right"),this.map.addControl(new YM);const a=document.querySelector("body");a!==null&&this.map.addControl(new Mh.FullscreenControl({container:a})),this.initMapSyncFilter()}get filterPin(){return["case",["in",["get","id"],["literal",[this.hoveredAssociationId,this.activeAssociationId].filter(i=>i)]],"marker-active","marker"]}updatePins(){this.map.getLayer(this.layers.UNCLUSTERED_POINT)!==void 0&&this.map.setLayoutProperty(this.layers.UNCLUSTERED_POINT,"icon-image",this.filterPin)}activeAssociationIdWatcher(){this.activeAssociation!==null&&this.zoomToAssociation(this.activeAssociation),this.updatePins()}hoveredAssociationIdWatcher(){this.updatePins()}infoPanelWatcher(){this.setMapPadding()}associationsWatcher(){this.updateOscMap()}zoomResetWatcher(){this.fitBounds(!0)}filteredAssociationsWithoutMapFilterWatcher(i,a){i!==a&&(Yn().isMapSynced?this.setMapFilter():this.fitBounds())}filteredAssociationsWatcher(){this.addOscSource()}get isInfoPanelShown(){return xi().isInfoPanelShown}get associations(){return Ni().associations}get filteredAssociations(){return Ni().filteredAssociations}get filteredAssociationsWithoutMapFilter(){return Ni().filteredAssociationsWithoutMapFilter}get filteredAssociationsId(){return this.filteredAssociations.map(i=>i.id)}get activeAssociationId(){return Ni().activeAssociationId}get hoveredAssociationId(){return Ni().hoveredAssociationId}get activeAssociation(){return Ni().activeAssociation}get triggerZoomReset(){return xi().triggerZoomReset}get padding(){return{top:30,bottom:30,left:30,right:(this.isInfoPanelShown?360:0)+30}}get geojson(){return f1.getGeoJSON()}setMapPadding(){this.map.easeTo({padding:this.padding,duration:300})}async setMapFilter(){if(this.map.getLayer(this.layers.UNCLUSTERED_POINT)!==void 0){const i=this.map.queryRenderedFeatures({layers:[this.layers.UNCLUSTERED_POINT,this.layers.ASSOC_CLUSTER]}),a=this.map.getSource(this.layers.ASSOC);let c=[];await i.forEach(async d=>{const m=d.properties.cluster_id,l=d.properties.point_count;m!==void 0?await a.getClusterLeaves(m,l,0,(b,w)=>{if(w!==void 0){let C=w.map(k=>k.id);c.push(...C)}}):await c.push(d.id)}),setTimeout(()=>Yn().mapShownAssociations=c,200)}}initMapSyncFilter(){this.map.on("moveend",async()=>{await this.setMapFilter()})}initMap(){this.updateOscMap()}updateOscMap(){this.addOscSource(),this.addOscLayer(),this.addClusterClickEvent(),this.addTooltipOnHover(),this.updateAssociationOnClick(),this.fitBounds()}addOscSource(){let i=this.geojson;this.map.getSource(this.layers.ASSOC)?this.map.getSource(this.layers.ASSOC).setData(this.geojson):this.map.addSource(this.layers.ASSOC,{type:"geojson",data:i,cluster:!0,clusterMaxZoom:11,clusterRadius:50,attribution:'Developed by <b><a href="https://cartong.org" target="_blank">CartONG</a></b>'})}addOscLayer(){this.map.getLayer(this.layers.ASSOC)===void 0&&(this.map.addLayer({id:this.layers.ASSOC_CLUSTER_BG,type:"circle",source:this.layers.ASSOC,filter:["has","point_count"],paint:{"circle-color":"#558B2F","circle-radius":40,"circle-opacity":.15}}),this.map.addLayer({id:this.layers.ASSOC_CLUSTER,type:"circle",source:this.layers.ASSOC,filter:["has","point_count"],paint:{"circle-color":"#558B2F","circle-radius":20}}),this.map.addLayer({id:this.layers.ASSOC_CLUSTER_COUNT,type:"symbol",source:this.layers.ASSOC,filter:["has","point_count"],layout:{"text-field":"{point_count_abbreviated}","text-size":12,"text-font":["Open Sans Bold","Arial Unicode MS Bold"]},paint:{"text-color":"#fff"}}),this.map.loadImage("./img/pins/pin_active.png",(i,a)=>{if(i)throw i;this.map.addImage("marker-active",a)}),this.map.loadImage("./img/pins/pin_orange.png",(i,a)=>{if(i)throw i;this.map.addImage("marker",a),this.map.addLayer({id:this.layers.UNCLUSTERED_POINT,type:"symbol",source:this.layers.ASSOC,filter:["!",["has","point_count"]],layout:{"icon-image":this.filterPin,"icon-allow-overlap":!0}})}))}updateAssociationOnClick(){this.map.on("click",this.layers.UNCLUSTERED_POINT,i=>{Ni().activeAssociationId=i.features[0].properties.id})}addClusterClickEvent(){this.map.on("click",this.layers.ASSOC_CLUSTER,i=>{const a=this.map.queryRenderedFeatures(i.point,{layers:[this.layers.ASSOC_CLUSTER]}),c=a[0].properties.cluster_id;this.map.getSource(this.layers.ASSOC).getClusterExpansionZoom(c,(d,m)=>{d||this.map.easeTo({center:a[0].geometry.coordinates,zoom:m})})}),this.map.on("mouseenter",this.layers.ASSOC_CLUSTER,i=>{this.map.getCanvas().style.cursor="pointer"}),this.map.on("mouseleave",this.layers.ASSOC_CLUSTER,()=>{this.map.getCanvas().style.cursor=""})}zoomToAssociation(i){const a=this.map.getZoom(),c=12;this.map.flyTo({center:[i.coords.y,i.coords.x],zoom:a<c?c:a,padding:this.padding,bearing:0,speed:3,curve:1,easing:function(d){return d},essential:!0})}addTooltipOnHover(){const i=new Mh.Popup({closeButton:!1,closeOnClick:!1});this.map.on("mouseenter",this.layers.UNCLUSTERED_POINT,a=>{this.map.getCanvas().style.cursor="pointer";for(var c=a.features[0].geometry.coordinates.slice(),d=a.features[0].properties.name;Math.abs(a.lngLat.lng-c[0])>180;)c[0]+=a.lngLat.lng>c[0]?360:-360;const m=`<h3>${d}</h3><span>Cliquez pour plus d'informations</span>`;i.setLngLat(c).setHTML(m).addTo(this.map),i.addClassName("show"),Ni().hoveredAssociationId=a.features[0].properties.id}),this.map.on("mouseleave",this.layers.UNCLUSTERED_POINT,()=>{this.map.getCanvas().style.cursor="",i.removeClassName("show"),Ni().hoveredAssociationId=null})}fitBounds(i=!1){let a=this.geojson.features;if(a.length){const c=f1.getBounds(a);this.defaultZoomExtent===null&&(this.defaultZoomExtent=c),this.map.fitBounds(i?this.defaultZoomExtent:c,{padding:30})}}};Xo([Ws("activeAssociationId")],va.prototype,"activeAssociationIdWatcher",1);Xo([Ws("hoveredAssociationId")],va.prototype,"hoveredAssociationIdWatcher",1);Xo([Ws("isInfoPanelShown")],va.prototype,"infoPanelWatcher",1);Xo([Ws("associations")],va.prototype,"associationsWatcher",1);Xo([Ws("triggerZoomReset")],va.prototype,"zoomResetWatcher",1);Xo([Ws("filteredAssociationsWithoutMapFilter")],va.prototype,"filteredAssociationsWithoutMapFilterWatcher",1);Xo([Ws("filteredAssociations",{deep:!0})],va.prototype,"filteredAssociationsWatcher",1);va=Xo([Ur({})],va);const Vr=(e,t)=>{const i=e.__vccOpts||e;for(const[a,c]of t)i[a]=c;return i},JM={id:"map"};function QM(e,t,i,a,c,d){return un(),mn("div",JM)}const eD=Vr(va,[["render",QM]]);var tD=Object.defineProperty,nD=Object.getOwnPropertyDescriptor,Nl=(e,t,i,a)=>{for(var c=a>1?void 0:a?nD(t,i):t,d=e.length-1,m;d>=0;d--)(m=e[d])&&(c=(a?m(t,i,c):m(c))||c);return a&&c&&tD(t,i,c),c};let Xa=class extends $r{constructor(){super(...arguments);Qn(this,"label");Qn(this,"fill");Qn(this,"toggled");Qn(this,"uppercase");Qn(this,"small");Qn(this,"icon")}get iconUrl(){return"./img/icons/"+this.icon+".svg"}};Nl([ts({default:"Button label"})],Xa.prototype,"label",2);Nl([ts({default:!1})],Xa.prototype,"fill",2);Nl([ts({default:null})],Xa.prototype,"toggled",2);Nl([ts({default:!1})],Xa.prototype,"uppercase",2);Nl([ts({default:!1})],Xa.prototype,"small",2);Nl([ts({default:null})],Xa.prototype,"icon",2);Xa=Nl([Ur({})],Xa);const iD=["uppercase","fill","small","toggled"],rD=["src","alt"];function sD(e,t,i,a,c,d){return un(),mn("button",{class:"Button",uppercase:e.uppercase,fill:e.fill,small:e.small,toggled:e.toggled},[e.icon!==null?(un(),mn("img",{key:0,src:e.iconUrl,alt:e.icon},null,8,rD)):or("",!0),Bt("span",null,ji(e.label),1)],8,iD)}const Cd=Vr(Xa,[["render",sD]]);var aD=Object.defineProperty,oD=Object.getOwnPropertyDescriptor,AE=(e,t,i,a)=>{for(var c=a>1?void 0:a?oD(t,i):t,d=e.length-1,m;d>=0;d--)(m=e[d])&&(c=(a?m(t,i,c):m(c))||c);return a&&c&&aD(t,i,c),c};let Dp=class extends $r{constructor(){super(...arguments);Qn(this,"label");Qn(this,"copying",!1)}get iconUrl(){return"./img/icons/"+(this.copying?"done":"mdi-content-copy")+".svg"}copyToClipboard(){const i=this;function a(c){i.copying=!0,setTimeout(()=>i.copying=!1,1500),c.clipboardData.setData("text/html",i.label),c.clipboardData.setData("text/plain",i.label),c.preventDefault()}document.addEventListener("copy",a),document.execCommand("copy"),document.removeEventListener("copy",a)}};AE([ts({default:""})],Dp.prototype,"label",2);Dp=AE([Ur({})],Dp);const lD={class:"CopyToClipboard"},cD=["src"];function uD(e,t,i,a,c,d){return un(),mn("div",lD,[Bt("span",null,ji(e.label),1),Bt("img",{src:e.iconUrl,alt:"Copier",onClick:t[0]||(t[0]=(...m)=>e.copyToClipboard&&e.copyToClipboard(...m))},null,8,cD)])}const hD=Vr(Dp,[["render",uD]]);var dD=Object.defineProperty,fD=Object.getOwnPropertyDescriptor,PE=(e,t,i,a)=>{for(var c=a>1?void 0:a?fD(t,i):t,d=e.length-1,m;d>=0;d--)(m=e[d])&&(c=(a?m(t,i,c):m(c))||c);return a&&c&&dD(t,i,c),c};let Lp=class extends $r{associationWatcher(){this.association!==null&&(xi().isInfoPanelShown=!0)}get isInfoPanelShown(){return xi().isInfoPanelShown}get association(){return Ni().activeAssociation}getIconUrl(t){return"./img/icons/"+t+".svg"}getThematic(t){return Yn().getThematicName(t)}closeInfoPanel(){xi().isInfoPanelShown=!1,setTimeout(()=>Ni().activeAssociationId=null,300)}};PE([Ws("association")],Lp.prototype,"associationWatcher",1);Lp=PE([Ur({components:{CopyToClipboard:hD}})],Lp);const pD=["shown"],mD=["src"],gD={class:"InfoPanel__head"},_D=["href"],yD=["src"],vD={key:0,class:"InfoPanel__email"},xD={key:0,class:"InfoPanel__otherEmailCtn"},bD={class:"InfoPanel__otherEmail"},wD={class:"InfoPanel__scrollableCtn"},SD={class:"InfoPanel__statusCtn"},ED={key:0},TD={class:"InfoPanel__statusRow"},CD={key:0,class:"InfoPanel__creationDate"},ID={key:1,class:"InfoPanel__cost"},kD=["src"],AD=Bt("span",{class:"InfoPanel__costTooltip"},"Budget moyen (fonctionnement et activités) au cours des 10 dernières années",-1),PD=Bt("div",{class:"InfoPanel__divider"},null,-1),RD={class:"InfoPanel__descCtn"},MD={key:0,class:"InfoPanel__descItem"},DD=Bt("h2",null,"Territoires d’intervention",-1),LD={key:1,class:"InfoPanel__descItem"},zD=Bt("h2",null,"Liens et dialogue avec des institutions",-1),OD={key:2,class:"InfoPanel__descItem"},BD=Bt("h2",null,"Thématiques d’intervention",-1),FD=Bt("div",{class:"InfoPanel__divider"},null,-1),ND={key:0,class:"InfoPanel__location"},UD=["src"],$D={key:1,class:"InfoPanel__updatedAt"};function VD(e,t,i,a,c,d){const m=cr("CopyToClipboard");return e.association!=null?(un(),mn("div",{key:0,class:"InfoPanel",shown:e.isInfoPanelShown&&e.association!=null},[Bt("img",{class:"InfoPanel__closeIcon",src:e.getIconUrl("mdi-window-close-white"),alt:"Fermer le panneau",onClick:t[0]||(t[0]=(...l)=>e.closeInfoPanel&&e.closeInfoPanel(...l))},null,8,mD),Bt("div",gD,[Bt("h1",null,ji(e.association.name),1),e.association.websiteUrl?(un(),mn("a",{key:0,href:e.association.websiteUrl,target:"_blank"},[Vo(ji(e.association.websiteUrl)+" ",1),Bt("img",{src:e.getIconUrl("mdi-open-in-new"),alt:"Nouvel onglet"},null,8,yD)],8,_D)):or("",!0)]),e.association.emails&&e.association.emails.length&&e.association.emails[0]!=""?(un(),mn("div",vD,[ue(m,{label:e.association.emails[0]},null,8,["label"]),e.association.emails.length>1?(un(),mn("div",xD,[(un(!0),mn(yn,null,Wc(e.association.emails.slice(1),l=>(un(),mn("span",bD,ji(l),1))),256))])):or("",!0)])):or("",!0),Bt("div",wD,[Bt("div",SD,[e.association.status?(un(),mn("h2",ED,ji(e.association.status),1)):or("",!0),Bt("div",TD,[e.association.year?(un(),mn("span",CD,"Créée en "+ji(e.association.year),1)):or("",!0),e.association.budget?(un(),mn("span",ID,[Vo(ji(e.association.budget)+" ",1),Bt("img",{src:e.getIconUrl("mdi-information-variant-circle-outline-white"),alt:"Localisation icon"},null,8,kD),AD])):or("",!0)])]),PD,Bt("div",RD,[e.association.intervention?(un(),mn("div",MD,[DD,Bt("span",null,ji(e.association.intervention),1)])):or("",!0),e.association.dialog?(un(),mn("div",LD,[zD,Bt("span",null,ji(e.association.dialog),1)])):or("",!0),e.association.thematics.length?(un(),mn("div",OD,[BD,Bt("ul",null,[(un(!0),mn(yn,null,Wc(e.association.thematics,(l,b)=>(un(),mn("li",{key:b},ji(e.getThematic(l)),1))),128))])])):or("",!0)]),FD,e.association.adress?(un(),mn("div",ND,[Bt("img",{src:e.getIconUrl("map-marker"),alt:"Localisation icon"},null,8,UD),Bt("span",null,ji(e.association.adress),1)])):or("",!0),e.association.updatedAt?(un(),mn("div",$D,"Mise à jour "+ji(e.association.updatedAt),1)):or("",!0)])],8,pD)):or("",!0)}const jD=Vr(Lp,[["render",VD]]);var GD=Object.defineProperty,qD=Object.getOwnPropertyDescriptor,HD=(e,t,i,a)=>{for(var c=a>1?void 0:a?qD(t,i):t,d=e.length-1,m;d>=0;d--)(m=e[d])&&(c=(a?m(t,i,c):m(c))||c);return a&&c&&GD(t,i,c),c};let X_=class extends $r{openInfoPanel(){xi().isInfoPanelShown=!0}openRedirectionModal(){xi().isRedirectionModalShown=!0}get isInfoPanelShown(){return xi().isInfoPanelShown}};X_=HD([Ur({components:{Map:eD,Button:Cd,InfoPanel:jD}})],X_);const ZD=["info-panel-shown"];function WD(e,t,i,a,c,d){const m=cr("InfoPanel"),l=cr("Map"),b=cr("Button");return un(),mn("div",{class:"OSCMap","info-panel-shown":e.isInfoPanelShown},[ue(m),ue(l),ue(b,{label:"Renseigner une association",class:"OSCMap__newAssocBtn",uppercase:!0,icon:"mdi-add",fill:!0,onClick:e.openRedirectionModal},null,8,["onClick"])],8,ZD)}const YD=Vr(X_,[["render",WD]]);var XD=Object.defineProperty,KD=Object.getOwnPropertyDescriptor,kv=(e,t,i,a)=>{for(var c=a>1?void 0:a?KD(t,i):t,d=e.length-1,m;d>=0;d--)(m=e[d])&&(c=(a?m(t,i,c):m(c))||c);return a&&c&&XD(t,i,c),c};let sd=class extends $r{constructor(){super(...arguments);Qn(this,"index");Qn(this,"association")}get activeAssociationId(){return Ni().activeAssociationId}get isActive(){return this.activeAssociationId===this.association.id}updateActiveAssociation(i){i===this.activeAssociationId?(xi().isInfoPanelShown=!1,setTimeout(()=>Ni().activeAssociationId=null,300)):Ni().activeAssociationId=i}updateHoveredAssociation(i){Ni().hoveredAssociationId=i}};kv([ts({default:0})],sd.prototype,"index",2);kv([ts({default:{}})],sd.prototype,"association",2);sd=kv([Ur({})],sd);const JD=["active"];function QD(e,t,i,a,c,d){return e.association!==void 0?(un(),mn("div",{key:0,class:"AssociationListItem",active:e.isActive,onClick:t[0]||(t[0]=m=>e.updateActiveAssociation(e.association.id)),onMouseover:t[1]||(t[1]=m=>e.updateHoveredAssociation(e.association.id)),onMouseleave:t[2]||(t[2]=m=>e.updateHoveredAssociation(null))},ji(e.association.name),41,JD)):or("",!0)}const eL=Vr(sd,[["render",QD]]);var tL=Object.defineProperty,nL=Object.getOwnPropertyDescriptor,Av=(e,t,i,a)=>{for(var c=a>1?void 0:a?nL(t,i):t,d=e.length-1,m;d>=0;d--)(m=e[d])&&(c=(a?m(t,i,c):m(c))||c);return a&&c&&tL(t,i,c),c};let ad=class extends $r{constructor(){super(...arguments);Qn(this,"associationlist")}get associations(){return Ni().filteredAssociations}associationsWatcher(){this.associationlist&&(this.associationlist.scrollTop=0)}};Av([MM],ad.prototype,"associationlist",2);Av([Ws("associations")],ad.prototype,"associationsWatcher",1);ad=Av([Ur({components:{AssociationListItem:eL}})],ad);const iL={class:"AssociationList",ref:"associationlist"};function rL(e,t,i,a,c,d){const m=cr("AssociationListItem");return un(),mn("div",iL,[(un(!0),mn(yn,null,Wc(e.associations,(l,b)=>(un(),dm(m,{association:l,key:b,index:b},null,8,["association","index"]))),128))],512)}const sL=Vr(ad,[["render",rL]]);var aL=Object.defineProperty,oL=Object.getOwnPropertyDescriptor,RE=(e,t,i,a)=>{for(var c=a>1?void 0:a?oL(t,i):t,d=e.length-1,m;d>=0;d--)(m=e[d])&&(c=(a?m(t,i,c):m(c))||c);return a&&c&&aL(t,i,c),c};let zp=class extends $r{constructor(){super(...arguments);Qn(this,"placeholder")}get filterStore(){return Yn()}updateSearch(i){Yn().search=i.target.value}};RE([ts({default:"Rechercher une association"})],zp.prototype,"placeholder",2);zp=RE([Ur({})],zp);const lL=["placeholder"];function cL(e,t,i,a,c,d){return ps((un(),mn("input",{class:"InputSearch",type:"search",placeholder:e.placeholder,onKeyup:t[0]||(t[0]=(...m)=>e.updateSearch&&e.updateSearch(...m)),"onUpdate:modelValue":t[1]||(t[1]=m=>e.filterStore.search=m)},null,40,lL)),[[NP,e.filterStore.search]])}const uL=Vr(zp,[["render",cL]]);var hL=Object.defineProperty,dL=Object.getOwnPropertyDescriptor,fL=(e,t,i,a)=>{for(var c=a>1?void 0:a?dL(t,i):t,d=e.length-1,m;d>=0;d--)(m=e[d])&&(c=(a?m(t,i,c):m(c))||c);return a&&c&&hL(t,i,c),c};let K_=class extends $r{get associations(){return Ni().associations}get filteredAssociations(){return Ni().filteredAssociations}get associationsCount(){return this.associations.length}get filteredAssociationsCount(){return this.filteredAssociations.length}get associationsCountLabel(){return this.filteredAssociationsCount+" association"+(this.filteredAssociationsCount>1?"s":"")+" sur "+this.associationsCount}get logoPath(){return"./img/logos/forim-subtitle.jpg"}get isFiltersBarShown(){return xi().isFiltersBarShown}get isMapSynced(){return Yn().isMapSynced}get filterStore(){return Yn()}get toggleFiltersLabel(){return this.isFiltersBarShown?"Masquer":"Filtrer"}get toggleFiltersIcon(){return this.isFiltersBarShown?"mdi-window-close":"mdi-filter-variant"}toggleFiltersBar(){xi().isFiltersBarShown=!this.isFiltersBarShown}openAboutModal(){xi().isAboutModalShown=!0}};K_=fL([Ur({components:{AssociationList:sL,Button:Cd,InputSearch:uL}})],K_);function Pv(e){return _v(()=>{const t=[],i={};return e.value.background&&(jb(e.value.background)?i.backgroundColor=e.value.background:t.push(`bg-${e.value.background}`)),e.value.text&&(jb(e.value.text)?(i.color=e.value.text,i.caretColor=e.value.text):t.push(`text-${e.value.text}`)),{colorClasses:t,colorStyles:i}})}function xa(e,t){const i=Ie(()=>({text:Kn(e)?e.value:t?e[t]:null})),{colorClasses:a,colorStyles:c}=Pv(i);return{textColorClasses:a,textColorStyles:c}}function od(e,t){const i=Ie(()=>({background:Kn(e)?e.value:t?e[t]:null})),{colorClasses:a,colorStyles:c}=Pv(i);return{backgroundColorClasses:a,backgroundColorStyles:c}}const pL=["x-small","small","default","large","x-large"],vm=$t({size:{type:[String,Number],default:"default"}},"size");function xm(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Yo();return _v(()=>{let i,a;return Cp(pL,e.size)?i=`${t}--size-${e.size}`:e.size&&(a={width:gn(e.size),height:gn(e.size)}),{sizeClasses:i,sizeStyles:a}})}const ba=$t({tag:{type:String,default:"div"}},"tag"),mL=$t({color:String,start:Boolean,end:Boolean,icon:Mi,...hi(),...vm(),...ba({tag:"i"}),...es()},"VIcon"),ds=En()({name:"VIcon",props:mL(),setup(e,t){let{attrs:i,slots:a}=t;const c=Jt(),{themeClasses:d}=Cs(e),{iconData:m}=zR(Ie(()=>c.value||e.icon)),{sizeClasses:l}=xm(e),{textColorClasses:b,textColorStyles:w}=xa(bn(e,"color"));return Gn(()=>{var k,M;const C=(k=a.default)==null?void 0:k.call(a);return C&&(c.value=(M=iE(C).filter(O=>O.type===Sd&&O.children&&typeof O.children=="string")[0])==null?void 0:M.children),ue(m.value.component,{tag:e.tag,icon:m.value.icon,class:["v-icon","notranslate",d.value,l.value,b.value,{"v-icon--clickable":!!i.onClick,"v-icon--start":e.start,"v-icon--end":e.end},e.class],style:[l.value?void 0:{fontSize:gn(e.size),height:gn(e.size),width:gn(e.size)},w.value,e.style],role:i.onClick?"button":void 0,"aria-hidden":!i.onClick},{default:()=>[C]})}),{}}});function ME(e){const{t}=_m();function i(a){let{name:c}=a;const d={prepend:"prependAction",prependInner:"prependAction",append:"appendAction",appendInner:"appendAction",clear:"clear"}[c],m=e[`onClick:${c}`],l=m&&d?t(`$vuetify.input.${d}`,e.label??""):void 0;return ue(ds,{icon:e[`${c}Icon`],"aria-label":l,onClick:m},null)}return{InputIcon:i}}const gL=$t({disabled:Boolean,group:Boolean,hideOnLeave:Boolean,leaveAbsolute:Boolean,mode:String,origin:String},"transition");function ms(e,t,i){return En()({name:e,props:gL({mode:i,origin:t}),setup(a,c){let{slots:d}=c;const m={onBeforeEnter(l){a.origin&&(l.style.transformOrigin=a.origin)},onLeave(l){if(a.leaveAbsolute){const{offsetTop:b,offsetLeft:w,offsetWidth:C,offsetHeight:k}=l;l._transitionInitialStyles={position:l.style.position,top:l.style.top,left:l.style.left,width:l.style.width,height:l.style.height},l.style.position="absolute",l.style.top=`${b}px`,l.style.left=`${w}px`,l.style.width=`${C}px`,l.style.height=`${k}px`}a.hideOnLeave&&l.style.setProperty("display","none","important")},onAfterLeave(l){if(a.leaveAbsolute&&(l!=null&&l._transitionInitialStyles)){const{position:b,top:w,left:C,width:k,height:M}=l._transitionInitialStyles;delete l._transitionInitialStyles,l.style.position=b||"",l.style.top=w||"",l.style.left=C||"",l.style.width=k||"",l.style.height=M||""}}};return()=>{const l=a.group?DP:Ya;return Wo(l,{name:a.disabled?"":e,css:!a.disabled,...a.group?void 0:{mode:a.mode},...a.disabled?{}:m},d.default)}}})}function DE(e,t){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"in-out";return En()({name:e,props:{mode:{type:String,default:i},disabled:Boolean},setup(a,c){let{slots:d}=c;return()=>Wo(Ya,{name:a.disabled?"":e,css:!a.disabled,...a.disabled?{}:t},d.default)}})}function LE(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";const i=(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1)?"width":"height",a=Ts(`offset-${i}`);return{onBeforeEnter(m){m._parent=m.parentNode,m._initialStyle={transition:m.style.transition,overflow:m.style.overflow,[i]:m.style[i]}},onEnter(m){const l=m._initialStyle;m.style.setProperty("transition","none","important"),m.style.overflow="hidden";const b=`${m[a]}px`;m.style[i]="0",m.offsetHeight,m.style.transition=l.transition,e&&m._parent&&m._parent.classList.add(e),requestAnimationFrame(()=>{m.style[i]=b})},onAfterEnter:d,onEnterCancelled:d,onLeave(m){m._initialStyle={transition:"",overflow:m.style.overflow,[i]:m.style[i]},m.style.overflow="hidden",m.style[i]=`${m[a]}px`,m.offsetHeight,requestAnimationFrame(()=>m.style[i]="0")},onAfterLeave:c,onLeaveCancelled:c};function c(m){e&&m._parent&&m._parent.classList.remove(e),d(m)}function d(m){const l=m._initialStyle[i];m.style.overflow=m._initialStyle.overflow,l!=null&&(m.style[i]=l),delete m._initialStyle}}const _L=$t({target:Object},"v-dialog-transition"),zE=En()({name:"VDialogTransition",props:_L(),setup(e,t){let{slots:i}=t;const a={onBeforeEnter(c){c.style.pointerEvents="none",c.style.visibility="hidden"},async onEnter(c,d){var M;await new Promise(O=>requestAnimationFrame(O)),await new Promise(O=>requestAnimationFrame(O)),c.style.visibility="";const{x:m,y:l,sx:b,sy:w,speed:C}=m1(e.target,c),k=Vc(c,[{transform:`translate(${m}px, ${l}px) scale(${b}, ${w})`,opacity:0},{}],{duration:225*C,easing:vR});(M=p1(c))==null||M.forEach(O=>{Vc(O,[{opacity:0},{opacity:0,offset:.33},{}],{duration:225*2*C,easing:Ap})}),k.finished.then(()=>d())},onAfterEnter(c){c.style.removeProperty("pointer-events")},onBeforeLeave(c){c.style.pointerEvents="none"},async onLeave(c,d){var M;await new Promise(O=>requestAnimationFrame(O));const{x:m,y:l,sx:b,sy:w,speed:C}=m1(e.target,c);Vc(c,[{},{transform:`translate(${m}px, ${l}px) scale(${b}, ${w})`,opacity:0}],{duration:125*C,easing:xR}).finished.then(()=>d()),(M=p1(c))==null||M.forEach(O=>{Vc(O,[{},{opacity:0,offset:.2},{opacity:0}],{duration:125*2*C,easing:Ap})})},onAfterLeave(c){c.style.removeProperty("pointer-events")}};return()=>e.target?ue(Ya,kn({name:"dialog-transition"},a,{css:!1}),i):ue(Ya,{name:"dialog-transition"},i)}});function p1(e){var i;const t=(i=e.querySelector(":scope > .v-card, :scope > .v-sheet, :scope > .v-list"))==null?void 0:i.children;return t&&[...t]}function m1(e,t){const i=e.getBoundingClientRect(),a=vv(t),[c,d]=getComputedStyle(t).transformOrigin.split(" ").map(he=>parseFloat(he)),[m,l]=getComputedStyle(t).getPropertyValue("--v-overlay-anchor-origin").split(" ");let b=i.left+i.width/2;m==="left"||l==="left"?b-=i.width/2:(m==="right"||l==="right")&&(b+=i.width/2);let w=i.top+i.height/2;m==="top"||l==="top"?w-=i.height/2:(m==="bottom"||l==="bottom")&&(w+=i.height/2);const C=i.width/a.width,k=i.height/a.height,M=Math.max(1,C,k),O=C/M||0,j=k/M||0,W=a.width*a.height/(window.innerWidth*window.innerHeight),le=W>.12?Math.min(1.5,(W-.12)*10+1):1;return{x:b-(c+a.left),y:w-(d+a.top),sx:O,sy:j,speed:le}}ms("fab-transition","center center","out-in");ms("dialog-bottom-transition");ms("dialog-top-transition");ms("fade-transition");ms("scale-transition");ms("scroll-x-transition");ms("scroll-x-reverse-transition");ms("scroll-y-transition");ms("scroll-y-reverse-transition");ms("slide-x-transition");ms("slide-x-reverse-transition");const OE=ms("slide-y-transition");ms("slide-y-reverse-transition");const yL=DE("expand-transition",LE()),BE=DE("expand-x-transition",LE("",!0)),vu=$t({transition:{type:[Boolean,String,Object],default:"fade-transition",validator:e=>e!==!0}},"transition"),zo=(e,t)=>{let{slots:i}=t;const{transition:a,disabled:c,...d}=e,{component:m=Ya,...l}=typeof a=="object"?a:{};return Wo(m,kn(typeof a=="string"?{name:c?"":a}:l,d,{disabled:c}),i)},vL=$t({active:Boolean,color:String,messages:{type:[Array,String],default:()=>[]},...hi(),...vu({transition:{component:OE,leaveAbsolute:!0,group:!0}})},"VMessages"),xL=En()({name:"VMessages",props:vL(),setup(e,t){let{slots:i}=t;const a=Ie(()=>ga(e.messages)),{textColorClasses:c,textColorStyles:d}=xa(Ie(()=>e.color));return Gn(()=>ue(zo,{transition:e.transition,tag:"div",class:["v-messages",c.value,e.class],style:[d.value,e.style],role:"alert","aria-live":"polite"},{default:()=>[e.active&&a.value.map((m,l)=>ue("div",{class:"v-messages__message",key:`${l}-${a.value}`},[i.message?i.message({message:m}):m]))]})),{}}}),bL=[null,"default","comfortable","compact"],xu=$t({density:{type:String,default:"default",validator:e=>bL.includes(e)}},"density");function bu(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Yo();return{densityClasses:Ie(()=>`${t}--density-${e.density}`)}}const FE=$t({focused:Boolean,"onUpdate:focused":_a()},"focus");function Rv(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Yo();const i=Ci(e,"focused"),a=Ie(()=>({[`${t}--focused`]:i.value}));function c(){i.value=!0}function d(){i.value=!1}return{focusClasses:a,isFocused:i,focus:c,blur:d}}const wL=Symbol.for("vuetify:form");function Mv(){return Jn(wL,null)}const SL=$t({disabled:{type:Boolean,default:null},error:Boolean,errorMessages:{type:[Array,String],default:()=>[]},maxErrors:{type:[Number,String],default:1},name:String,label:String,readonly:{type:Boolean,default:null},rules:{type:Array,default:()=>[]},modelValue:null,validateOn:String,validationValue:null,...FE()},"validation");function EL(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Yo(),i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Zs();const a=Ci(e,"modelValue"),c=Ie(()=>e.validationValue===void 0?a.value:e.validationValue),d=Mv(),m=Jt([]),l=wn(!0),b=Ie(()=>!!(ga(a.value===""?null:a.value).length||ga(c.value===""?null:c.value).length)),w=Ie(()=>!!(e.disabled??(d==null?void 0:d.isDisabled.value))),C=Ie(()=>!!(e.readonly??(d==null?void 0:d.isReadonly.value))),k=Ie(()=>e.errorMessages.length?ga(e.errorMessages).slice(0,Math.max(0,+e.maxErrors)):m.value),M=Ie(()=>{let Pe=(e.validateOn??(d==null?void 0:d.validateOn.value))||"input";Pe==="lazy"&&(Pe="input lazy");const Ue=new Set((Pe==null?void 0:Pe.split(" "))??[]);return{blur:Ue.has("blur")||Ue.has("input"),input:Ue.has("input"),submit:Ue.has("submit"),lazy:Ue.has("lazy")}}),O=Ie(()=>e.error||e.errorMessages.length?!1:e.rules.length?l.value?m.value.length||M.value.lazy?null:!0:!m.value.length:!0),j=wn(!1),W=Ie(()=>({[`${t}--error`]:O.value===!1,[`${t}--dirty`]:b.value,[`${t}--disabled`]:w.value,[`${t}--readonly`]:C.value})),le=Ie(()=>e.name??hr(i));sv(()=>{d==null||d.register({id:le.value,validate:ge,reset:he,resetValidation:be})}),no(()=>{d==null||d.unregister(le.value)}),Fl(async()=>{M.value.lazy||await ge(!0),d==null||d.update(le.value,O.value,k.value)}),zl(()=>M.value.input,()=>{Sn(c,()=>{if(c.value!=null)ge();else if(e.focused){const Pe=Sn(()=>e.focused,Ue=>{Ue||ge(),Pe()})}})}),zl(()=>M.value.blur,()=>{Sn(()=>e.focused,Pe=>{Pe||ge()})}),Sn(O,()=>{d==null||d.update(le.value,O.value,k.value)});function he(){a.value=null,Er(be)}function be(){l.value=!0,M.value.lazy?m.value=[]:ge(!0)}async function ge(){let Pe=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const Ue=[];j.value=!0;for(const Oe of e.rules){if(Ue.length>=+(e.maxErrors??1))break;const V=await(typeof Oe=="function"?Oe:()=>Oe)(c.value);if(V!==!0){if(V!==!1&&typeof V!="string"){console.warn(`${V} is not a valid value. Rule functions must return boolean true or a string.`);continue}Ue.push(V||"")}}return m.value=Ue,j.value=!1,l.value=Pe,m.value}return{errorMessages:k,isDirty:b,isDisabled:w,isReadonly:C,isPristine:l,isValid:O,isValidating:j,reset:he,resetValidation:be,validate:ge,validationClasses:W}}const Dv=$t({id:String,appendIcon:Mi,centerAffix:{type:Boolean,default:!0},prependIcon:Mi,hideDetails:[Boolean,String],hint:String,persistentHint:Boolean,messages:{type:[Array,String],default:()=>[]},direction:{type:String,default:"horizontal",validator:e=>["horizontal","vertical"].includes(e)},"onClick:prepend":_a(),"onClick:append":_a(),...hi(),...xu(),...SL()},"VInput"),Op=En()({name:"VInput",props:{...Dv()},emits:{"update:modelValue":e=>!0},setup(e,t){let{attrs:i,slots:a,emit:c}=t;const{densityClasses:d}=bu(e),{rtlClasses:m}=yu(),{InputIcon:l}=ME(e),b=Zs(),w=Ie(()=>e.id||`input-${b}`),C=Ie(()=>`${w.value}-messages`),{errorMessages:k,isDirty:M,isDisabled:O,isReadonly:j,isPristine:W,isValid:le,isValidating:he,reset:be,resetValidation:ge,validate:Pe,validationClasses:Ue}=EL(e,"v-input",w),Oe=Ie(()=>({id:w,messagesId:C,isDirty:M,isDisabled:O,isReadonly:j,isPristine:W,isValid:le,isValidating:he,reset:be,resetValidation:ge,validate:Pe})),Te=Ie(()=>{var V;return(V=e.errorMessages)!=null&&V.length||!W.value&&k.value.length?k.value:e.hint&&(e.persistentHint||e.focused)?e.hint:e.messages});return Gn(()=>{var _e,oe,Re,nt;const V=!!(a.prepend||e.prependIcon),Z=!!(a.append||e.appendIcon),ae=Te.value.length>0,ke=!e.hideDetails||e.hideDetails==="auto"&&(ae||!!a.details);return ue("div",{class:["v-input",`v-input--${e.direction}`,{"v-input--center-affix":e.centerAffix},d.value,m.value,Ue.value,e.class],style:e.style},[V&&ue("div",{key:"prepend",class:"v-input__prepend"},[(_e=a.prepend)==null?void 0:_e.call(a,Oe.value),e.prependIcon&&ue(l,{key:"prepend-icon",name:"prepend"},null)]),a.default&&ue("div",{class:"v-input__control"},[(oe=a.default)==null?void 0:oe.call(a,Oe.value)]),Z&&ue("div",{key:"append",class:"v-input__append"},[e.appendIcon&&ue(l,{key:"append-icon",name:"append"},null),(Re=a.append)==null?void 0:Re.call(a,Oe.value)]),ke&&ue("div",{class:"v-input__details"},[ue(xL,{id:C.value,active:ae,messages:Te.value},{message:a.message}),(nt=a.details)==null?void 0:nt.call(a,Oe.value)])])}),{reset:be,resetValidation:ge,validate:Pe}}});function NE(e,t){const i=Jt(),a=wn(!1);if(wv){const c=new IntersectionObserver(d=>{e==null||e(d,c),a.value=!!d.find(m=>m.isIntersecting)},t);no(()=>{c.disconnect()}),Sn(i,(d,m)=>{m&&(c.unobserve(m),a.value=!1),d&&c.observe(d)},{flush:"post"})}return{intersectionRef:i,isIntersecting:a}}const TL=$t({bgColor:String,color:String,indeterminate:[Boolean,String],modelValue:{type:[Number,String],default:0},rotate:{type:[Number,String],default:0},width:{type:[Number,String],default:4},...hi(),...vm(),...ba({tag:"div"}),...es()},"VProgressCircular"),CL=En()({name:"VProgressCircular",props:TL(),setup(e,t){let{slots:i}=t;const a=20,c=2*Math.PI*a,d=Jt(),{themeClasses:m}=Cs(e),{sizeClasses:l,sizeStyles:b}=xm(e),{textColorClasses:w,textColorStyles:C}=xa(bn(e,"color")),{textColorClasses:k,textColorStyles:M}=xa(bn(e,"bgColor")),{intersectionRef:O,isIntersecting:j}=NE(),{resizeRef:W,contentRect:le}=xE(),he=Ie(()=>Math.max(0,Math.min(100,parseFloat(e.modelValue)))),be=Ie(()=>Number(e.width)),ge=Ie(()=>b.value?Number(e.size):le.value?le.value.width:Math.max(be.value,32)),Pe=Ie(()=>a/(1-be.value/ge.value)*2),Ue=Ie(()=>be.value/ge.value*Pe.value),Oe=Ie(()=>gn((100-he.value)/100*c));return eo(()=>{O.value=d.value,W.value=d.value}),Gn(()=>ue(e.tag,{ref:d,class:["v-progress-circular",{"v-progress-circular--indeterminate":!!e.indeterminate,"v-progress-circular--visible":j.value,"v-progress-circular--disable-shrink":e.indeterminate==="disable-shrink"},m.value,l.value,w.value,e.class],style:[b.value,C.value,e.style],role:"progressbar","aria-valuemin":"0","aria-valuemax":"100","aria-valuenow":e.indeterminate?void 0:he.value},{default:()=>[ue("svg",{style:{transform:`rotate(calc(-90deg + ${Number(e.rotate)}deg))`},xmlns:"http://www.w3.org/2000/svg",viewBox:`0 0 ${Pe.value} ${Pe.value}`},[ue("circle",{class:["v-progress-circular__underlay",k.value],style:M.value,fill:"transparent",cx:"50%",cy:"50%",r:a,"stroke-width":Ue.value,"stroke-dasharray":c,"stroke-dashoffset":0},null),ue("circle",{class:"v-progress-circular__overlay",fill:"transparent",cx:"50%",cy:"50%",r:a,"stroke-width":Ue.value,"stroke-dasharray":c,"stroke-dashoffset":Oe.value},null)]),i.default&&ue("div",{class:"v-progress-circular__content"},[i.default({value:he.value})])]})),{}}}),IL=$t({text:String,clickable:Boolean,...hi(),...es()},"VLabel"),UE=En()({name:"VLabel",props:IL(),setup(e,t){let{slots:i}=t;return Gn(()=>{var a;return ue("label",{class:["v-label",{"v-label--clickable":e.clickable},e.class],style:e.style},[e.text,(a=i.default)==null?void 0:a.call(i)])}),{}}}),$E=Symbol.for("vuetify:selection-control-group"),VE=$t({color:String,disabled:Boolean,defaultsTarget:String,error:Boolean,id:String,inline:Boolean,falseIcon:Mi,trueIcon:Mi,ripple:{type:Boolean,default:!0},multiple:{type:Boolean,default:null},name:String,readonly:Boolean,modelValue:null,type:String,valueComparator:{type:Function,default:gu},...hi(),...xu(),...es()},"SelectionControlGroup"),kL=$t({...VE({defaultsTarget:"VSelectionControl"})},"VSelectionControlGroup");En()({name:"VSelectionControlGroup",props:kL(),emits:{"update:modelValue":e=>!0},setup(e,t){let{slots:i}=t;const a=Ci(e,"modelValue"),c=Zs(),d=Ie(()=>e.id||`v-selection-control-group-${c}`),m=Ie(()=>e.name||d.value),l=new Set;return Sr($E,{modelValue:a,forceUpdate:()=>{l.forEach(b=>b())},onForceUpdate:b=>{l.add(b),Jr(()=>{l.delete(b)})}}),Td({[e.defaultsTarget]:{color:bn(e,"color"),disabled:bn(e,"disabled"),density:bn(e,"density"),error:bn(e,"error"),inline:bn(e,"inline"),modelValue:a,multiple:Ie(()=>!!e.multiple||e.multiple==null&&Array.isArray(a.value)),name:m,falseIcon:bn(e,"falseIcon"),trueIcon:bn(e,"trueIcon"),readonly:bn(e,"readonly"),ripple:bn(e,"ripple"),type:bn(e,"type"),valueComparator:bn(e,"valueComparator")}}),Gn(()=>{var b;return ue("div",{class:["v-selection-control-group",{"v-selection-control-group--inline":e.inline},e.class],style:e.style,role:e.type==="radio"?"radiogroup":void 0},[(b=i.default)==null?void 0:b.call(i)])}),{}}});const J_=Symbol("rippleStop"),AL=80;function g1(e,t){e.style.transform=t,e.style.webkitTransform=t}function Q_(e){return e.constructor.name==="TouchEvent"}function jE(e){return e.constructor.name==="KeyboardEvent"}const PL=function(e,t){var k;let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},a=0,c=0;if(!jE(e)){const M=t.getBoundingClientRect(),O=Q_(e)?e.touches[e.touches.length-1]:e;a=O.clientX-M.left,c=O.clientY-M.top}let d=0,m=.3;(k=t._ripple)!=null&&k.circle?(m=.15,d=t.clientWidth/2,d=i.center?d:d+Math.sqrt((a-d)**2+(c-d)**2)/4):d=Math.sqrt(t.clientWidth**2+t.clientHeight**2)/2;const l=`${(t.clientWidth-d*2)/2}px`,b=`${(t.clientHeight-d*2)/2}px`,w=i.center?l:`${a-d}px`,C=i.center?b:`${c-d}px`;return{radius:d,scale:m,x:w,y:C,centerX:l,centerY:b}},Bp={show(e,t){var O;let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(!((O=t==null?void 0:t._ripple)!=null&&O.enabled))return;const a=document.createElement("span"),c=document.createElement("span");a.appendChild(c),a.className="v-ripple__container",i.class&&(a.className+=` ${i.class}`);const{radius:d,scale:m,x:l,y:b,centerX:w,centerY:C}=PL(e,t,i),k=`${d*2}px`;c.className="v-ripple__animation",c.style.width=k,c.style.height=k,t.appendChild(a);const M=window.getComputedStyle(t);M&&M.position==="static"&&(t.style.position="relative",t.dataset.previousPosition="static"),c.classList.add("v-ripple__animation--enter"),c.classList.add("v-ripple__animation--visible"),g1(c,`translate(${l}, ${b}) scale3d(${m},${m},${m})`),c.dataset.activated=String(performance.now()),setTimeout(()=>{c.classList.remove("v-ripple__animation--enter"),c.classList.add("v-ripple__animation--in"),g1(c,`translate(${w}, ${C}) scale3d(1,1,1)`)},0)},hide(e){var d;if(!((d=e==null?void 0:e._ripple)!=null&&d.enabled))return;const t=e.getElementsByClassName("v-ripple__animation");if(t.length===0)return;const i=t[t.length-1];if(i.dataset.isHiding)return;i.dataset.isHiding="true";const a=performance.now()-Number(i.dataset.activated),c=Math.max(250-a,0);setTimeout(()=>{i.classList.remove("v-ripple__animation--in"),i.classList.add("v-ripple__animation--out"),setTimeout(()=>{var l;e.getElementsByClassName("v-ripple__animation").length===1&&e.dataset.previousPosition&&(e.style.position=e.dataset.previousPosition,delete e.dataset.previousPosition),((l=i.parentNode)==null?void 0:l.parentNode)===e&&e.removeChild(i.parentNode)},300)},c)}};function GE(e){return typeof e>"u"||!!e}function ld(e){const t={},i=e.currentTarget;if(!(!(i!=null&&i._ripple)||i._ripple.touched||e[J_])){if(e[J_]=!0,Q_(e))i._ripple.touched=!0,i._ripple.isTouch=!0;else if(i._ripple.isTouch)return;if(t.center=i._ripple.centered||jE(e),i._ripple.class&&(t.class=i._ripple.class),Q_(e)){if(i._ripple.showTimerCommit)return;i._ripple.showTimerCommit=()=>{Bp.show(e,i,t)},i._ripple.showTimer=window.setTimeout(()=>{var a;(a=i==null?void 0:i._ripple)!=null&&a.showTimerCommit&&(i._ripple.showTimerCommit(),i._ripple.showTimerCommit=null)},AL)}else Bp.show(e,i,t)}}function _1(e){e[J_]=!0}function hs(e){const t=e.currentTarget;if(t!=null&&t._ripple){if(window.clearTimeout(t._ripple.showTimer),e.type==="touchend"&&t._ripple.showTimerCommit){t._ripple.showTimerCommit(),t._ripple.showTimerCommit=null,t._ripple.showTimer=window.setTimeout(()=>{hs(e)});return}window.setTimeout(()=>{t._ripple&&(t._ripple.touched=!1)}),Bp.hide(t)}}function qE(e){const t=e.currentTarget;t!=null&&t._ripple&&(t._ripple.showTimerCommit&&(t._ripple.showTimerCommit=null),window.clearTimeout(t._ripple.showTimer))}let cd=!1;function HE(e){!cd&&(e.keyCode===Ob.enter||e.keyCode===Ob.space)&&(cd=!0,ld(e))}function ZE(e){cd=!1,hs(e)}function WE(e){cd&&(cd=!1,hs(e))}function YE(e,t,i){const{value:a,modifiers:c}=t,d=GE(a);if(d||Bp.hide(e),e._ripple=e._ripple??{},e._ripple.enabled=d,e._ripple.centered=c.center,e._ripple.circle=c.circle,$_(a)&&a.class&&(e._ripple.class=a.class),d&&!i){if(c.stop){e.addEventListener("touchstart",_1,{passive:!0}),e.addEventListener("mousedown",_1);return}e.addEventListener("touchstart",ld,{passive:!0}),e.addEventListener("touchend",hs,{passive:!0}),e.addEventListener("touchmove",qE,{passive:!0}),e.addEventListener("touchcancel",hs),e.addEventListener("mousedown",ld),e.addEventListener("mouseup",hs),e.addEventListener("mouseleave",hs),e.addEventListener("keydown",HE),e.addEventListener("keyup",ZE),e.addEventListener("blur",WE),e.addEventListener("dragstart",hs,{passive:!0})}else!d&&i&&XE(e)}function XE(e){e.removeEventListener("mousedown",ld),e.removeEventListener("touchstart",ld),e.removeEventListener("touchend",hs),e.removeEventListener("touchmove",qE),e.removeEventListener("touchcancel",hs),e.removeEventListener("mouseup",hs),e.removeEventListener("mouseleave",hs),e.removeEventListener("keydown",HE),e.removeEventListener("keyup",ZE),e.removeEventListener("dragstart",hs),e.removeEventListener("blur",WE)}function RL(e,t){YE(e,t,!1)}function ML(e){delete e._ripple,XE(e)}function DL(e,t){if(t.value===t.oldValue)return;const i=GE(t.oldValue);YE(e,t,i)}const Lv={mounted:RL,unmounted:ML,updated:DL},zv=$t({label:String,trueValue:null,falseValue:null,value:null,...hi(),...VE()},"VSelectionControl");function LL(e){const t=Jn($E,void 0),{densityClasses:i}=bu(e),a=Ci(e,"modelValue"),c=Ie(()=>e.trueValue!==void 0?e.trueValue:e.value!==void 0?e.value:!0),d=Ie(()=>e.falseValue!==void 0?e.falseValue:!1),m=Ie(()=>!!e.multiple||e.multiple==null&&Array.isArray(a.value)),l=Ie({get(){const k=t?t.modelValue.value:a.value;return m.value?k.some(M=>e.valueComparator(M,c.value)):e.valueComparator(k,c.value)},set(k){if(e.readonly)return;const M=k?c.value:d.value;let O=M;m.value&&(O=k?[...ga(a.value),M]:ga(a.value).filter(j=>!e.valueComparator(j,c.value))),t?t.modelValue.value=O:a.value=O}}),{textColorClasses:b,textColorStyles:w}=xa(Ie(()=>l.value&&!e.error&&!e.disabled?e.color:void 0)),C=Ie(()=>l.value?e.trueIcon:e.falseIcon);return{group:t,densityClasses:i,trueValue:c,falseValue:d,model:l,textColorClasses:b,textColorStyles:w,icon:C}}const ey=En()({name:"VSelectionControl",directives:{Ripple:Lv},inheritAttrs:!1,props:zv(),emits:{"update:modelValue":e=>!0},setup(e,t){let{attrs:i,slots:a}=t;const{group:c,densityClasses:d,icon:m,model:l,textColorClasses:b,textColorStyles:w,trueValue:C}=LL(e),k=Zs(),M=Ie(()=>e.id||`input-${k}`),O=wn(!1),j=wn(!1),W=Jt();c==null||c.onForceUpdate(()=>{W.value&&(W.value.checked=l.value)});function le(ge){O.value=!0,(!q_||q_&&ge.target.matches(":focus-visible"))&&(j.value=!0)}function he(){O.value=!1,j.value=!1}function be(ge){e.readonly&&c&&Er(()=>c.forceUpdate()),l.value=ge.target.checked}return Gn(()=>{var Oe,Te;const ge=a.label?a.label({label:e.label,props:{for:M.value}}):e.label,[Pe,Ue]=gv(i);return ue("div",kn({class:["v-selection-control",{"v-selection-control--dirty":l.value,"v-selection-control--disabled":e.disabled,"v-selection-control--error":e.error,"v-selection-control--focused":O.value,"v-selection-control--focus-visible":j.value,"v-selection-control--inline":e.inline},d.value,e.class]},Pe,{style:e.style}),[ue("div",{class:["v-selection-control__wrapper",b.value],style:w.value},[(Oe=a.default)==null?void 0:Oe.call(a),ps(ue("div",{class:["v-selection-control__input"]},[m.value&&ue(ds,{key:"icon",icon:m.value},null),ue("input",kn({ref:W,checked:l.value,disabled:e.disabled,id:M.value,onBlur:he,onFocus:le,onInput:be,"aria-disabled":e.readonly,type:e.type,value:C.value,name:e.name,"aria-checked":e.type==="checkbox"?l.value:void 0},Ue),null),(Te=a.input)==null?void 0:Te.call(a,{model:l,textColorClasses:b,textColorStyles:w,props:{onFocus:le,onBlur:he,id:M.value}})]),[[Ll("ripple"),e.ripple&&[!e.disabled&&!e.readonly,null,["center","circle"]]]])]),ge&&ue(UE,{for:M.value,clickable:!0},{default:()=>[ge]})])}),{isFocused:O,input:W}}}),y1={center:"center",top:"bottom",bottom:"top",left:"right",right:"left"},zL=$t({location:String},"location");function OL(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=arguments.length>2?arguments[2]:void 0;const{isRtl:a}=yu();return{locationStyles:Ie(()=>{if(!e.location)return{};const{side:d,align:m}=G_(e.location.split(" ").length>1?e.location:`${e.location} center`,a.value);function l(w){return i?i(w):0}const b={};return d!=="center"&&(t?b[y1[d]]=`calc(100% - ${l(d)}px)`:b[d]=0),m!=="center"?t?b[y1[m]]=`calc(100% - ${l(m)}px)`:b[m]=0:(d==="center"?b.top=b.left="50%":b[{top:"left",bottom:"left",left:"top",right:"top"}[d]]="50%",b.transform={top:"translateX(-50%)",bottom:"translateX(-50%)",left:"translateY(-50%)",right:"translateY(-50%)",center:"translate(-50%, -50%)"}[d]),b})}}const wu=$t({rounded:{type:[Boolean,Number,String],default:void 0}},"rounded");function Su(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Yo();return{roundedClasses:Ie(()=>{const a=Kn(e)?e.value:e.rounded,c=[];if(a===!0||a==="")c.push(`${t}--rounded`);else if(typeof a=="string"||a===0)for(const d of String(a).split(" "))c.push(`rounded-${d}`);return c})}}const BL=$t({absolute:Boolean,active:{type:Boolean,default:!0},bgColor:String,bgOpacity:[Number,String],bufferValue:{type:[Number,String],default:0},clickable:Boolean,color:String,height:{type:[Number,String],default:4},indeterminate:Boolean,max:{type:[Number,String],default:100},modelValue:{type:[Number,String],default:0},reverse:Boolean,stream:Boolean,striped:Boolean,roundedBar:Boolean,...hi(),...zL({location:"top"}),...wu(),...ba(),...es()},"VProgressLinear"),FL=En()({name:"VProgressLinear",props:BL(),emits:{"update:modelValue":e=>!0},setup(e,t){let{slots:i}=t;const a=Ci(e,"modelValue"),{isRtl:c,rtlClasses:d}=yu(),{themeClasses:m}=Cs(e),{locationStyles:l}=OL(e),{textColorClasses:b,textColorStyles:w}=xa(e,"color"),{backgroundColorClasses:C,backgroundColorStyles:k}=od(Ie(()=>e.bgColor||e.color)),{backgroundColorClasses:M,backgroundColorStyles:O}=od(e,"color"),{roundedClasses:j}=Su(e),{intersectionRef:W,isIntersecting:le}=NE(),he=Ie(()=>parseInt(e.max,10)),be=Ie(()=>parseInt(e.height,10)),ge=Ie(()=>parseFloat(e.bufferValue)/he.value*100),Pe=Ie(()=>parseFloat(a.value)/he.value*100),Ue=Ie(()=>c.value!==e.reverse),Oe=Ie(()=>e.indeterminate?"fade-transition":"slide-x-transition"),Te=Ie(()=>e.bgOpacity==null?e.bgOpacity:parseFloat(e.bgOpacity));function V(Z){if(!W.value)return;const{left:ae,right:ke,width:_e}=W.value.getBoundingClientRect(),oe=Ue.value?_e-Z.clientX+(ke-_e):Z.clientX-ae;a.value=Math.round(oe/_e*he.value)}return Gn(()=>ue(e.tag,{ref:W,class:["v-progress-linear",{"v-progress-linear--absolute":e.absolute,"v-progress-linear--active":e.active&&le.value,"v-progress-linear--reverse":Ue.value,"v-progress-linear--rounded":e.rounded,"v-progress-linear--rounded-bar":e.roundedBar,"v-progress-linear--striped":e.striped},j.value,m.value,d.value,e.class],style:[{bottom:e.location==="bottom"?0:void 0,top:e.location==="top"?0:void 0,height:e.active?gn(be.value):0,"--v-progress-linear-height":gn(be.value),...l.value},e.style],role:"progressbar","aria-hidden":e.active?"false":"true","aria-valuemin":"0","aria-valuemax":e.max,"aria-valuenow":e.indeterminate?void 0:Pe.value,onClick:e.clickable&&V},{default:()=>[e.stream&&ue("div",{key:"stream",class:["v-progress-linear__stream",b.value],style:{...w.value,[Ue.value?"left":"right"]:gn(-be.value),borderTop:`${gn(be.value/2)} dotted`,opacity:Te.value,top:`calc(50% - ${gn(be.value/4)})`,width:gn(100-ge.value,"%"),"--v-progress-linear-stream-to":gn(be.value*(Ue.value?1:-1))}},null),ue("div",{class:["v-progress-linear__background",C.value],style:[k.value,{opacity:Te.value,width:gn(e.stream?ge.value:100,"%")}]},null),ue(Ya,{name:Oe.value},{default:()=>[e.indeterminate?ue("div",{class:"v-progress-linear__indeterminate"},[["long","short"].map(Z=>ue("div",{key:Z,class:["v-progress-linear__indeterminate",Z,M.value],style:O.value},null))]):ue("div",{class:["v-progress-linear__determinate",M.value],style:[O.value,{width:gn(Pe.value,"%")}]},null)]}),i.default&&ue("div",{class:"v-progress-linear__content"},[i.default({value:Pe.value,buffer:ge.value})])]})),{}}}),NL=$t({loading:[Boolean,String]},"loader");function KE(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Yo();return{loaderClasses:Ie(()=>({[`${t}--loading`]:e.loading}))}}function JE(e,t){var a;let{slots:i}=t;return ue("div",{class:`${e.name}__loader`},[((a=i.default)==null?void 0:a.call(i,{color:e.color,isActive:e.active}))||ue(FL,{active:e.active,color:e.color,height:"2",indeterminate:!0},null)])}const UL=$t({indeterminate:Boolean,inset:Boolean,flat:Boolean,loading:{type:[Boolean,String],default:!1},...Dv(),...zv()},"VSwitch"),$L=En()({name:"VSwitch",inheritAttrs:!1,props:UL(),emits:{"update:focused":e=>!0,"update:modelValue":()=>!0,"update:indeterminate":e=>!0},setup(e,t){let{attrs:i,slots:a}=t;const c=Ci(e,"indeterminate"),d=Ci(e,"modelValue"),{loaderClasses:m}=KE(e),{isFocused:l,focus:b,blur:w}=Rv(e),C=Ie(()=>typeof e.loading=="string"&&e.loading!==""?e.loading:e.color),k=Zs(),M=Ie(()=>e.id||`switch-${k}`);function O(){c.value&&(c.value=!1)}return Gn(()=>{const[j,W]=gv(i),[le,he]=Op.filterProps(e),[be,ge]=ey.filterProps(e),Pe=Jt();function Ue(Oe){var Te,V;Oe.stopPropagation(),Oe.preventDefault(),(V=(Te=Pe.value)==null?void 0:Te.input)==null||V.click()}return ue(Op,kn({class:["v-switch",{"v-switch--inset":e.inset},{"v-switch--indeterminate":c.value},m.value,e.class],style:e.style},j,le,{id:M.value,focused:l.value}),{...a,default:Oe=>{let{id:Te,messagesId:V,isDisabled:Z,isReadonly:ae,isValid:ke}=Oe;return ue(ey,kn({ref:Pe},be,{modelValue:d.value,"onUpdate:modelValue":[_e=>d.value=_e,O],id:Te.value,"aria-describedby":V.value,type:"checkbox","aria-checked":c.value?"mixed":void 0,disabled:Z.value,readonly:ae.value,onFocus:b,onBlur:w},W),{...a,default:()=>ue("div",{class:"v-switch__track",onClick:Ue},null),input:_e=>{let{textColorClasses:oe,textColorStyles:Re}=_e;return ue("div",{class:["v-switch__thumb",oe.value],style:Re.value},[e.loading&&ue(JE,{name:"v-switch",active:!0,color:ke.value===!1?void 0:C.value},{default:nt=>a.loader?a.loader(nt):ue(CL,{active:nt.isActive,color:nt.color,indeterminate:!0,size:"16",width:"2"},null)})])}})}})}),{}}}),VL={class:"AssociationBar"},jL={class:"AssociationBar__ctn AssociationBar__ctn--top"},GL={class:"AssociationBar__head"},qL={class:"AssociationBar__count"},HL={class:"AssociationBar__ctn AssociationBar__ctn--bottom"},ZL=Bt("div",{class:"AssociationBar__divider"},null,-1),WL=["src"];function YL(e,t,i,a,c,d){const m=cr("Button"),l=cr("InputSearch"),b=cr("AssociationList");return un(),mn("div",VL,[Bt("div",jL,[Bt("div",GL,[Bt("h3",qL,ji(e.associationsCountLabel),1),ue(m,{onClick:e.toggleFiltersBar,class:"AssociationBar__toggleFiltersBtn",label:e.toggleFiltersLabel,uppercase:!0,small:!0,toggled:e.isFiltersBarShown,icon:e.toggleFiltersIcon},null,8,["onClick","label","toggled","icon"])]),ue(l),ue(b),ue($L,{class:im("AssociationBar__switchMap"+(e.isMapSynced?" active":"")),label:"Synchroniser avec la carte",inset:"","hide-details":"auto",modelValue:e.filterStore.isMapSynced,"onUpdate:modelValue":t[0]||(t[0]=w=>e.filterStore.isMapSynced=w)},null,8,["class","modelValue"])]),Bt("div",HL,[ZL,Bt("img",{src:e.logoPath,alt:"Logo CRPM",class:"AssociationBar__crpmLogo"},null,8,WL),ue(m,{onClick:e.openAboutModal,class:"AssociationBar__aboutBtn",label:"À propos du projet",uppercase:!0,icon:"mdi-information-variant-circle-outline"},null,8,["onClick"])])])}const XL=Vr(K_,[["render",YL]]);var KL=Object.defineProperty,JL=Object.getOwnPropertyDescriptor,Ul=(e,t,i,a)=>{for(var c=a>1?void 0:a?JL(t,i):t,d=e.length-1,m;d>=0;d--)(m=e[d])&&(c=(a?m(t,i,c):m(c))||c);return a&&c&&KL(t,i,c),c};let Ka=class extends $r{constructor(){super(...arguments);Qn(this,"selected",[]);Qn(this,"label");Qn(this,"data");Qn(this,"reset")}selectedWatcher(){this.onSelected()}resetWatcher(){this.selected=[]}onSelected(){return this.selected}};Ul([ts({default:"Button label"})],Ka.prototype,"label",2);Ul([ts({default:[]})],Ka.prototype,"data",2);Ul([ts({default:!1})],Ka.prototype,"reset",2);Ul([Ws("selected")],Ka.prototype,"selectedWatcher",1);Ul([Ws("reset")],Ka.prototype,"resetWatcher",1);Ul([FM()],Ka.prototype,"onSelected",1);Ka=Ul([Ur({})],Ka);const QL=$t({indeterminate:Boolean,indeterminateIcon:{type:Mi,default:"$checkboxIndeterminate"},...zv({falseIcon:"$checkboxOff",trueIcon:"$checkboxOn"})},"VCheckboxBtn"),QE=En()({name:"VCheckboxBtn",props:QL(),emits:{"update:modelValue":e=>!0,"update:indeterminate":e=>!0},setup(e,t){let{slots:i}=t;const a=Ci(e,"indeterminate"),c=Ci(e,"modelValue");function d(b){a.value&&(a.value=!1)}const m=Ie(()=>a.value?e.indeterminateIcon:e.falseIcon),l=Ie(()=>a.value?e.indeterminateIcon:e.trueIcon);return Gn(()=>ue(ey,kn(e,{modelValue:c.value,"onUpdate:modelValue":[b=>c.value=b,d],class:["v-checkbox-btn",e.class],style:e.style,type:"checkbox",falseIcon:m.value,trueIcon:l.value,"aria-checked":a.value?"mixed":void 0}),i)),{}}}),bm=$t({height:[Number,String],maxHeight:[Number,String],maxWidth:[Number,String],minHeight:[Number,String],minWidth:[Number,String],width:[Number,String]},"dimension");function wm(e){return{dimensionStyles:Ie(()=>({height:gn(e.height),maxHeight:gn(e.maxHeight),maxWidth:gn(e.maxWidth),minHeight:gn(e.minHeight),minWidth:gn(e.minWidth),width:gn(e.width)}))}}function ez(e){return{aspectStyles:Ie(()=>{const t=Number(e.aspectRatio);return t?{paddingBottom:String(1/t*100)+"%"}:void 0})}}const eT=$t({aspectRatio:[String,Number],contentClass:String,inline:Boolean,...hi(),...bm()},"VResponsive"),v1=En()({name:"VResponsive",props:eT(),setup(e,t){let{slots:i}=t;const{aspectStyles:a}=ez(e),{dimensionStyles:c}=wm(e);return Gn(()=>{var d;return ue("div",{class:["v-responsive",{"v-responsive--inline":e.inline},e.class],style:[c.value,e.style]},[ue("div",{class:"v-responsive__sizer",style:a.value},null),(d=i.additional)==null?void 0:d.call(i),i.default&&ue("div",{class:["v-responsive__content",e.contentClass]},[i.default()])])}),{}}});function tz(e,t){if(!wv)return;const i=t.modifiers||{},a=t.value,{handler:c,options:d}=typeof a=="object"?a:{handler:a,options:{}},m=new IntersectionObserver(function(){var k;let l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],b=arguments.length>1?arguments[1]:void 0;const w=(k=e._observe)==null?void 0:k[t.instance.$.uid];if(!w)return;const C=l.some(M=>M.isIntersecting);c&&(!i.quiet||w.init)&&(!i.once||C||w.init)&&c(C,l,b),C&&i.once?tT(e,t):w.init=!0},d);e._observe=Object(e._observe),e._observe[t.instance.$.uid]={init:!1,observer:m},m.observe(e)}function tT(e,t){var a;const i=(a=e._observe)==null?void 0:a[t.instance.$.uid];i&&(i.observer.unobserve(e),delete e._observe[t.instance.$.uid])}const nz={mounted:tz,unmounted:tT},nT=nz,iz=$t({alt:String,cover:Boolean,eager:Boolean,gradient:String,lazySrc:String,options:{type:Object,default:()=>({root:void 0,rootMargin:void 0,threshold:void 0})},sizes:String,src:{type:[String,Object],default:""},srcset:String,...eT(),...hi(),...vu()},"VImg"),rz=En()({name:"VImg",directives:{intersect:nT},props:iz(),emits:{loadstart:e=>!0,load:e=>!0,error:e=>!0},setup(e,t){let{emit:i,slots:a}=t;const c=wn(""),d=Jt(),m=wn(e.eager?"loading":"idle"),l=wn(),b=wn(),w=Ie(()=>e.src&&typeof e.src=="object"?{src:e.src.src,srcset:e.srcset||e.src.srcset,lazySrc:e.lazySrc||e.src.lazySrc,aspect:Number(e.aspectRatio||e.src.aspect||0)}:{src:e.src,srcset:e.srcset,lazySrc:e.lazySrc,aspect:Number(e.aspectRatio||0)}),C=Ie(()=>w.value.aspect||l.value/b.value||0);Sn(()=>e.src,()=>{k(m.value!=="idle")}),Sn(C,(V,Z)=>{!V&&Z&&d.value&&le(d.value)}),sv(()=>k());function k(V){if(!(e.eager&&V)&&!(wv&&!V&&!e.eager)){if(m.value="loading",w.value.lazySrc){const Z=new Image;Z.src=w.value.lazySrc,le(Z,null)}w.value.src&&Er(()=>{var Z,ae;if(i("loadstart",((Z=d.value)==null?void 0:Z.currentSrc)||w.value.src),(ae=d.value)!=null&&ae.complete){if(d.value.naturalWidth||O(),m.value==="error")return;C.value||le(d.value,null),M()}else C.value||le(d.value),j()})}}function M(){var V;j(),m.value="loaded",i("load",((V=d.value)==null?void 0:V.currentSrc)||w.value.src)}function O(){var V;m.value="error",i("error",((V=d.value)==null?void 0:V.currentSrc)||w.value.src)}function j(){const V=d.value;V&&(c.value=V.currentSrc||V.src)}let W=-1;function le(V){let Z=arguments.length>1&&arguments[1]!==void 0?arguments[1]:100;const ae=()=>{clearTimeout(W);const{naturalHeight:ke,naturalWidth:_e}=V;ke||_e?(l.value=_e,b.value=ke):!V.complete&&m.value==="loading"&&Z!=null?W=window.setTimeout(ae,Z):(V.currentSrc.endsWith(".svg")||V.currentSrc.startsWith("data:image/svg+xml"))&&(l.value=1,b.value=1)};ae()}const he=Ie(()=>({"v-img__img--cover":e.cover,"v-img__img--contain":!e.cover})),be=()=>{var ae;if(!w.value.src||m.value==="idle")return null;const V=ue("img",{class:["v-img__img",he.value],src:w.value.src,srcset:w.value.srcset,alt:e.alt,sizes:e.sizes,ref:d,onLoad:M,onError:O},null),Z=(ae=a.sources)==null?void 0:ae.call(a);return ue(zo,{transition:e.transition,appear:!0},{default:()=>[ps(Z?ue("picture",{class:"v-img__picture"},[Z,V]):V,[[mu,m.value==="loaded"]])]})},ge=()=>ue(zo,{transition:e.transition},{default:()=>[w.value.lazySrc&&m.value!=="loaded"&&ue("img",{class:["v-img__img","v-img__img--preload",he.value],src:w.value.lazySrc,alt:e.alt},null)]}),Pe=()=>a.placeholder?ue(zo,{transition:e.transition,appear:!0},{default:()=>[(m.value==="loading"||m.value==="error"&&!a.error)&&ue("div",{class:"v-img__placeholder"},[a.placeholder()])]}):null,Ue=()=>a.error?ue(zo,{transition:e.transition,appear:!0},{default:()=>[m.value==="error"&&ue("div",{class:"v-img__error"},[a.error()])]}):null,Oe=()=>e.gradient?ue("div",{class:"v-img__gradient",style:{backgroundImage:`linear-gradient(${e.gradient})`}},null):null,Te=wn(!1);{const V=Sn(C,Z=>{Z&&(requestAnimationFrame(()=>{requestAnimationFrame(()=>{Te.value=!0})}),V())})}return Gn(()=>{const[V]=v1.filterProps(e);return ps(ue(v1,kn({class:["v-img",{"v-img--booting":!Te.value},e.class],style:e.style},V,{aspectRatio:C.value,"aria-label":e.alt,role:e.alt?"img":void 0}),{additional:()=>ue(yn,null,[ue(be,null,null),ue(ge,null,null),ue(Oe,null,null),ue(Pe,null,null),ue(Ue,null,null)]),default:a.default}),[[Ll("intersect"),{handler:k,options:e.options},null,{once:!0}]])}),{currentSrc:c,image:d,state:m,naturalWidth:l,naturalHeight:b}}}),sz=["elevated","flat","tonal","outlined","text","plain"];function Ov(e,t){return ue(yn,null,[e&&ue("span",{key:"overlay",class:`${t}__overlay`},null),ue("span",{key:"underlay",class:`${t}__underlay`},null)])}const Id=$t({color:String,variant:{type:String,default:"elevated",validator:e=>sz.includes(e)}},"variant");function Bv(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Yo();const i=Ie(()=>{const{variant:d}=hr(e);return`${t}--variant-${d}`}),{colorClasses:a,colorStyles:c}=Pv(Ie(()=>{const{variant:d,color:m}=hr(e);return{[["elevated","flat"].includes(d)?"background":"text"]:m}}));return{colorClasses:a,colorStyles:c,variantClasses:i}}const az=$t({start:Boolean,end:Boolean,icon:Mi,image:String,...hi(),...xu(),...wu(),...vm(),...ba(),...es(),...Id({variant:"flat"})},"VAvatar"),Fp=En()({name:"VAvatar",props:az(),setup(e,t){let{slots:i}=t;const{themeClasses:a}=Cs(e),{colorClasses:c,colorStyles:d,variantClasses:m}=Bv(e),{densityClasses:l}=bu(e),{roundedClasses:b}=Su(e),{sizeClasses:w,sizeStyles:C}=xm(e);return Gn(()=>ue(e.tag,{class:["v-avatar",{"v-avatar--start":e.start,"v-avatar--end":e.end},a.value,c.value,l.value,b.value,w.value,m.value,e.class],style:[d.value,C.value,e.style]},{default:()=>{var k;return[e.image?ue(rz,{key:"image",src:e.image,alt:"",cover:!0},null):e.icon?ue(ds,{key:"icon",icon:e.icon},null):(k=i.default)==null?void 0:k.call(i),Ov(!1,"v-avatar")]}})),{}}}),oz=$t({modelValue:{type:null,default:void 0},multiple:Boolean,mandatory:[Boolean,String],max:Number,selectedClass:String,disabled:Boolean},"group"),lz=$t({value:null,disabled:Boolean,selectedClass:String},"group-item");function cz(e,t){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const a=Nr("useGroupItem");if(!a)throw new Error("[Vuetify] useGroupItem composable must be used inside a component setup function");const c=Zs();Sr(Symbol.for(`${t.description}:id`),c);const d=Jn(t,null);if(!d){if(!i)return d;throw new Error(`[Vuetify] Could not find useGroup injection with symbol ${t.description}`)}const m=bn(e,"value"),l=Ie(()=>d.disabled.value||e.disabled);d.register({id:c,value:m,disabled:l},a),no(()=>{d.unregister(c)});const b=Ie(()=>d.isSelected(c)),w=Ie(()=>b.value&&[d.selectedClass.value,e.selectedClass]);return Sn(b,C=>{a.emit("group:selected",{value:C})}),{id:c,isSelected:b,toggle:()=>d.select(c,!b.value),select:C=>d.select(c,C),selectedClass:w,value:m,disabled:l,group:d}}function uz(e,t){let i=!1;const a=er([]),c=Ci(e,"modelValue",[],M=>M==null?[]:iT(a,ga(M)),M=>{const O=dz(a,M);return e.multiple?O:O[0]}),d=Nr("useGroup");function m(M,O){const j=M,W=Symbol.for(`${t.description}:id`),he=Nh(W,d==null?void 0:d.vnode).indexOf(O);he>-1?a.splice(he,0,j):a.push(j)}function l(M){if(i)return;b();const O=a.findIndex(j=>j.id===M);a.splice(O,1)}function b(){const M=a.find(O=>!O.disabled);M&&e.mandatory==="force"&&!c.value.length&&(c.value=[M.id])}Fl(()=>{b()}),no(()=>{i=!0});function w(M,O){const j=a.find(W=>W.id===M);if(!(O&&(j!=null&&j.disabled)))if(e.multiple){const W=c.value.slice(),le=W.findIndex(be=>be===M),he=~le;if(O=O??!he,he&&e.mandatory&&W.length<=1||!he&&e.max!=null&&W.length+1>e.max)return;le<0&&O?W.push(M):le>=0&&!O&&W.splice(le,1),c.value=W}else{const W=c.value.includes(M);if(e.mandatory&&W)return;c.value=O??!W?[M]:[]}}function C(M){if(e.multiple,c.value.length){const O=c.value[0],j=a.findIndex(he=>he.id===O);let W=(j+M)%a.length,le=a[W];for(;le.disabled&&W!==j;)W=(W+M)%a.length,le=a[W];if(le.disabled)return;c.value=[a[W].id]}else{const O=a.find(j=>!j.disabled);O&&(c.value=[O.id])}}const k={register:m,unregister:l,selected:c,select:w,disabled:bn(e,"disabled"),prev:()=>C(a.length-1),next:()=>C(1),isSelected:M=>c.value.includes(M),selectedClass:Ie(()=>e.selectedClass),items:Ie(()=>a),getItemIndex:M=>hz(a,M)};return Sr(t,k),k}function hz(e,t){const i=iT(e,[t]);return i.length?e.findIndex(a=>a.id===i[0]):-1}function iT(e,t){const i=[];return t.forEach(a=>{const c=e.find(m=>gu(a,m.value)),d=e[a];(c==null?void 0:c.value)!=null?i.push(c.id):d!=null&&i.push(d.id)}),i}function dz(e,t){const i=[];return t.forEach(a=>{const c=e.findIndex(d=>d.id===a);if(~c){const d=e[c];i.push(d.value!=null?d.value:c)}}),i}const rT=Symbol.for("vuetify:v-chip-group"),fz=$t({column:Boolean,filter:Boolean,valueComparator:{type:Function,default:gu},...hi(),...oz({selectedClass:"v-chip--selected"}),...ba(),...es(),...Id({variant:"tonal"})},"VChipGroup");En()({name:"VChipGroup",props:fz(),emits:{"update:modelValue":e=>!0},setup(e,t){let{slots:i}=t;const{themeClasses:a}=Cs(e),{isSelected:c,select:d,next:m,prev:l,selected:b}=uz(e,rT);return Td({VChip:{color:bn(e,"color"),disabled:bn(e,"disabled"),filter:bn(e,"filter"),variant:bn(e,"variant")}}),Gn(()=>ue(e.tag,{class:["v-chip-group",{"v-chip-group--column":e.column},a.value,e.class],style:e.style},{default:()=>{var w;return[(w=i.default)==null?void 0:w.call(i,{isSelected:c,select:d,next:m,prev:l,selected:b.value})]}})),{}}});const pz=$t({defaults:Object,disabled:Boolean,reset:[Number,String],root:[Boolean,String],scoped:Boolean},"VDefaultsProvider"),ma=En(!1)({name:"VDefaultsProvider",props:pz(),setup(e,t){let{slots:i}=t;const{defaults:a,disabled:c,reset:d,root:m,scoped:l}=am(e);return Td(a,{reset:d,root:m,scoped:l,disabled:c}),()=>{var b;return(b=i.default)==null?void 0:b.call(i)}}}),Fv=$t({border:[Boolean,Number,String]},"border");function Nv(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Yo();return{borderClasses:Ie(()=>{const a=Kn(e)?e.value:e.border,c=[];if(a===!0||a==="")c.push(`${t}--border`);else if(typeof a=="string"||a===0)for(const d of String(a).split(" "))c.push(`border-${d}`);return c})}}const Uv=$t({elevation:{type:[Number,String],validator(e){const t=parseInt(e);return!isNaN(t)&&t>=0&&t<=24}}},"elevation");function $v(e){return{elevationClasses:Ie(()=>{const i=Kn(e)?e.value:e.elevation,a=[];return i==null||a.push(`elevation-${i}`),a})}}function mz(){var e,t;return(t=(e=Nr("useRouter"))==null?void 0:e.proxy)==null?void 0:t.$router}function sT(e,t){const i=PA("RouterLink"),a=Ie(()=>!!(e.href||e.to)),c=Ie(()=>(a==null?void 0:a.value)||Fb(t,"click")||Fb(e,"click"));if(typeof i=="string")return{isLink:a,isClickable:c,href:bn(e,"href")};const d=e.to?i.useLink(e):void 0;return{isLink:a,isClickable:c,route:d==null?void 0:d.route,navigate:d==null?void 0:d.navigate,isActive:d&&Ie(()=>{var m,l;return e.exact?(m=d.isExactActive)==null?void 0:m.value:(l=d.isActive)==null?void 0:l.value}),href:Ie(()=>e.to?d==null?void 0:d.route.value.href:e.href)}}const aT=$t({href:String,replace:Boolean,to:[String,Object],exact:Boolean},"router");let l_=!1;function gz(e,t){let i=!1,a,c;Hi&&(Er(()=>{window.addEventListener("popstate",d),a=e==null?void 0:e.beforeEach((m,l,b)=>{l_?i?t(b):b():setTimeout(()=>i?t(b):b()),l_=!0}),c=e==null?void 0:e.afterEach(()=>{l_=!1})}),Jr(()=>{window.removeEventListener("popstate",d),a==null||a(),c==null||c()}));function d(m){var l;(l=m.state)!=null&&l.replaced||(i=!0,setTimeout(()=>i=!1))}}const _z=$t({activeClass:String,appendAvatar:String,appendIcon:Mi,closable:Boolean,closeIcon:{type:Mi,default:"$delete"},closeLabel:{type:String,default:"$vuetify.close"},draggable:Boolean,filter:Boolean,filterIcon:{type:String,default:"$complete"},label:Boolean,link:{type:Boolean,default:void 0},pill:Boolean,prependAvatar:String,prependIcon:Mi,ripple:{type:[Boolean,Object],default:!0},text:String,modelValue:{type:Boolean,default:!0},onClick:_a(),onClickOnce:_a(),...Fv(),...hi(),...xu(),...Uv(),...lz(),...wu(),...aT(),...vm(),...ba({tag:"span"}),...es(),...Id({variant:"tonal"})},"VChip"),oT=En()({name:"VChip",directives:{Ripple:Lv},props:_z(),emits:{"click:close":e=>!0,"update:modelValue":e=>!0,"group:selected":e=>!0,click:e=>!0},setup(e,t){let{attrs:i,emit:a,slots:c}=t;const{t:d}=_m(),{borderClasses:m}=Nv(e),{colorClasses:l,colorStyles:b,variantClasses:w}=Bv(e),{densityClasses:C}=bu(e),{elevationClasses:k}=$v(e),{roundedClasses:M}=Su(e),{sizeClasses:O}=xm(e),{themeClasses:j}=Cs(e),W=Ci(e,"modelValue"),le=cz(e,rT,!1),he=sT(e,i),be=Ie(()=>e.link!==!1&&he.isLink.value),ge=Ie(()=>!e.disabled&&e.link!==!1&&(!!le||e.link||he.isClickable.value)),Pe=Ie(()=>({"aria-label":d(e.closeLabel),onClick(Te){W.value=!1,a("click:close",Te)}}));function Ue(Te){var V;a("click",Te),ge.value&&((V=he.navigate)==null||V.call(he,Te),le==null||le.toggle())}function Oe(Te){(Te.key==="Enter"||Te.key===" ")&&(Te.preventDefault(),Ue(Te))}return()=>{const Te=he.isLink.value?"a":e.tag,V=!!(e.appendIcon||e.appendAvatar),Z=!!(V||c.append),ae=!!(c.close||e.closable),ke=!!(c.filter||e.filter)&&le,_e=!!(e.prependIcon||e.prependAvatar),oe=!!(_e||c.prepend),Re=!le||le.isSelected.value;return W.value&&ps(ue(Te,{class:["v-chip",{"v-chip--disabled":e.disabled,"v-chip--label":e.label,"v-chip--link":ge.value,"v-chip--filter":ke,"v-chip--pill":e.pill},j.value,m.value,Re?l.value:void 0,C.value,k.value,M.value,O.value,w.value,le==null?void 0:le.selectedClass.value,e.class],style:[Re?b.value:void 0,e.style],disabled:e.disabled||void 0,draggable:e.draggable,href:he.href.value,tabindex:ge.value?0:void 0,onClick:Ue,onKeydown:ge.value&&!be.value&&Oe},{default:()=>{var nt;return[Ov(ge.value,"v-chip"),ke&&ue(BE,{key:"filter"},{default:()=>[ps(ue("div",{class:"v-chip__filter"},[c.filter?ps(ue(ma,{key:"filter-defaults",disabled:!e.filterIcon,defaults:{VIcon:{icon:e.filterIcon}}},null),[[Ll("slot"),c.filter,"default"]]):ue(ds,{key:"filter-icon",icon:e.filterIcon},null)]),[[mu,le.isSelected.value]])]}),oe&&ue("div",{key:"prepend",class:"v-chip__prepend"},[c.prepend?ue(ma,{key:"prepend-defaults",disabled:!_e,defaults:{VAvatar:{image:e.prependAvatar,start:!0},VIcon:{icon:e.prependIcon,start:!0}}},c.prepend):ue(yn,null,[e.prependIcon&&ue(ds,{key:"prepend-icon",icon:e.prependIcon,start:!0},null),e.prependAvatar&&ue(Fp,{key:"prepend-avatar",image:e.prependAvatar,start:!0},null)])]),ue("div",{class:"v-chip__content"},[((nt=c.default)==null?void 0:nt.call(c,{isSelected:le==null?void 0:le.isSelected.value,selectedClass:le==null?void 0:le.selectedClass.value,select:le==null?void 0:le.select,toggle:le==null?void 0:le.toggle,value:le==null?void 0:le.value.value,disabled:e.disabled}))??e.text]),Z&&ue("div",{key:"append",class:"v-chip__append"},[c.append?ue(ma,{key:"append-defaults",disabled:!V,defaults:{VAvatar:{end:!0,image:e.appendAvatar},VIcon:{end:!0,icon:e.appendIcon}}},c.append):ue(yn,null,[e.appendIcon&&ue(ds,{key:"append-icon",end:!0,icon:e.appendIcon},null),e.appendAvatar&&ue(Fp,{key:"append-avatar",end:!0,image:e.appendAvatar},null)])]),ae&&ue("div",kn({key:"close",class:"v-chip__close"},Pe.value),[c.close?ue(ma,{key:"close-defaults",defaults:{VIcon:{icon:e.closeIcon,size:"x-small"}}},c.close):ue(ds,{key:"close-icon",icon:e.closeIcon,size:"x-small"},null)])]}}),[[Ll("ripple"),ge.value&&e.ripple,null]])}}}),ty=Symbol.for("vuetify:list");function lT(){const e=Jn(ty,{hasPrepend:wn(!1),updateHasPrepend:()=>null}),t={hasPrepend:wn(!1),updateHasPrepend:i=>{i&&(t.hasPrepend.value=i)}};return Sr(ty,t),e}function cT(){return Jn(ty,null)}const yz={open:e=>{let{id:t,value:i,opened:a,parents:c}=e;if(i){const d=new Set;d.add(t);let m=c.get(t);for(;m!=null;)d.add(m),m=c.get(m);return d}else return a.delete(t),a},select:()=>null},uT={open:e=>{let{id:t,value:i,opened:a,parents:c}=e;if(i){let d=c.get(t);for(a.add(t);d!=null&&d!==t;)a.add(d),d=c.get(d);return a}else a.delete(t);return a},select:()=>null},vz={open:uT.open,select:e=>{let{id:t,value:i,opened:a,parents:c}=e;if(!i)return a;const d=[];let m=c.get(t);for(;m!=null;)d.push(m),m=c.get(m);return new Set(d)}},Vv=e=>{const t={select:i=>{let{id:a,value:c,selected:d}=i;if(a=an(a),e&&!c){const m=Array.from(d.entries()).reduce((l,b)=>{let[w,C]=b;return C==="on"?[...l,w]:l},[]);if(m.length===1&&m[0]===a)return d}return d.set(a,c?"on":"off"),d},in:(i,a,c)=>{let d=new Map;for(const m of i||[])d=t.select({id:m,value:!0,selected:new Map(d),children:a,parents:c});return d},out:i=>{const a=[];for(const[c,d]of i.entries())d==="on"&&a.push(c);return a}};return t},hT=e=>{const t=Vv(e);return{select:a=>{let{selected:c,id:d,...m}=a;d=an(d);const l=c.has(d)?new Map([[d,c.get(d)]]):new Map;return t.select({...m,id:d,selected:l})},in:(a,c,d)=>{let m=new Map;return a!=null&&a.length&&(m=t.in(a.slice(0,1),c,d)),m},out:(a,c,d)=>t.out(a,c,d)}},xz=e=>{const t=Vv(e);return{select:a=>{let{id:c,selected:d,children:m,...l}=a;return c=an(c),m.has(c)?d:t.select({id:c,selected:d,children:m,...l})},in:t.in,out:t.out}},bz=e=>{const t=hT(e);return{select:a=>{let{id:c,selected:d,children:m,...l}=a;return c=an(c),m.has(c)?d:t.select({id:c,selected:d,children:m,...l})},in:t.in,out:t.out}},wz=e=>{const t={select:i=>{let{id:a,value:c,selected:d,children:m,parents:l}=i;a=an(a);const b=new Map(d),w=[a];for(;w.length;){const k=w.shift();d.set(k,c?"on":"off"),m.has(k)&&w.push(...m.get(k))}let C=l.get(a);for(;C;){const k=m.get(C),M=k.every(j=>d.get(j)==="on"),O=k.every(j=>!d.has(j)||d.get(j)==="off");d.set(C,M?"on":O?"off":"indeterminate"),C=l.get(C)}return e&&!c&&Array.from(d.entries()).reduce((M,O)=>{let[j,W]=O;return W==="on"?[...M,j]:M},[]).length===0?b:d},in:(i,a,c)=>{let d=new Map;for(const m of i||[])d=t.select({id:m,value:!0,selected:new Map(d),children:a,parents:c});return d},out:(i,a)=>{const c=[];for(const[d,m]of i.entries())m==="on"&&!a.has(d)&&c.push(d);return c}};return t},ud=Symbol.for("vuetify:nested"),dT={id:wn(),root:{register:()=>null,unregister:()=>null,parents:Jt(new Map),children:Jt(new Map),open:()=>null,openOnSelect:()=>null,select:()=>null,opened:Jt(new Set),selected:Jt(new Map),selectedValues:Jt([])}},Sz=$t({selectStrategy:[String,Function],openStrategy:[String,Object],opened:Array,selected:Array,mandatory:Boolean},"nested"),Ez=e=>{let t=!1;const i=Jt(new Map),a=Jt(new Map),c=Ci(e,"opened",e.opened,k=>new Set(k),k=>[...k.values()]),d=Ie(()=>{if(typeof e.selectStrategy=="object")return e.selectStrategy;switch(e.selectStrategy){case"single-leaf":return bz(e.mandatory);case"leaf":return xz(e.mandatory);case"independent":return Vv(e.mandatory);case"single-independent":return hT(e.mandatory);case"classic":default:return wz(e.mandatory)}}),m=Ie(()=>{if(typeof e.openStrategy=="object")return e.openStrategy;switch(e.openStrategy){case"list":return vz;case"single":return yz;case"multiple":default:return uT}}),l=Ci(e,"selected",e.selected,k=>d.value.in(k,i.value,a.value),k=>d.value.out(k,i.value,a.value));no(()=>{t=!0});function b(k){const M=[];let O=k;for(;O!=null;)M.unshift(O),O=a.value.get(O);return M}const w=Nr("nested"),C={id:wn(),root:{opened:c,selected:l,selectedValues:Ie(()=>{const k=[];for(const[M,O]of l.value.entries())O==="on"&&k.push(M);return k}),register:(k,M,O)=>{M&&k!==M&&a.value.set(k,M),O&&i.value.set(k,[]),M!=null&&i.value.set(M,[...i.value.get(M)||[],k])},unregister:k=>{if(t)return;i.value.delete(k);const M=a.value.get(k);if(M){const O=i.value.get(M)??[];i.value.set(M,O.filter(j=>j!==k))}a.value.delete(k),c.value.delete(k)},open:(k,M,O)=>{w.emit("click:open",{id:k,value:M,path:b(k),event:O});const j=m.value.open({id:k,value:M,opened:new Set(c.value),children:i.value,parents:a.value,event:O});j&&(c.value=j)},openOnSelect:(k,M,O)=>{const j=m.value.select({id:k,value:M,selected:new Map(l.value),opened:new Set(c.value),children:i.value,parents:a.value,event:O});j&&(c.value=j)},select:(k,M,O)=>{w.emit("click:select",{id:k,value:M,path:b(k),event:O});const j=d.value.select({id:k,value:M,selected:new Map(l.value),children:i.value,parents:a.value,event:O});j&&(l.value=j),C.root.openOnSelect(k,M,O)},children:i,parents:a}};return Sr(ud,C),C.root},fT=(e,t)=>{const i=Jn(ud,dT),a=Symbol(Zs()),c=Ie(()=>e.value!==void 0?e.value:a),d={...i,id:c,open:(m,l)=>i.root.open(c.value,m,l),openOnSelect:(m,l)=>i.root.openOnSelect(c.value,m,l),isOpen:Ie(()=>i.root.opened.value.has(c.value)),parent:Ie(()=>i.root.parents.value.get(c.value)),select:(m,l)=>i.root.select(c.value,m,l),isSelected:Ie(()=>i.root.selected.value.get(an(c.value))==="on"),isIndeterminate:Ie(()=>i.root.selected.value.get(c.value)==="indeterminate"),isLeaf:Ie(()=>!i.root.children.value.get(c.value)),isGroupActivator:i.isGroupActivator};return!i.isGroupActivator&&i.root.register(c.value,i.id.value,t),no(()=>{!i.isGroupActivator&&i.root.unregister(c.value)}),t&&Sr(ud,d),d},Tz=()=>{const e=Jn(ud,dT);Sr(ud,{...e,isGroupActivator:!0})};function Cz(){const e=wn(!1);return Fl(()=>{window.requestAnimationFrame(()=>{e.value=!0})}),{ssrBootStyles:Ie(()=>e.value?void 0:{transition:"none !important"}),isBooted:wd(e)}}const Iz=_u({name:"VListGroupActivator",setup(e,t){let{slots:i}=t;return Tz(),()=>{var a;return(a=i.default)==null?void 0:a.call(i)}}}),kz=$t({activeColor:String,baseColor:String,color:String,collapseIcon:{type:Mi,default:"$collapse"},expandIcon:{type:Mi,default:"$expand"},prependIcon:Mi,appendIcon:Mi,fluid:Boolean,subgroup:Boolean,title:String,value:null,...hi(),...ba()},"VListGroup"),x1=En()({name:"VListGroup",props:kz(),setup(e,t){let{slots:i}=t;const{isOpen:a,open:c,id:d}=fT(bn(e,"value"),!0),m=Ie(()=>`v-list-group--id-${String(d.value)}`),l=cT(),{isBooted:b}=Cz();function w(O){c(!a.value,O)}const C=Ie(()=>({onClick:w,class:"v-list-group__header",id:m.value})),k=Ie(()=>a.value?e.collapseIcon:e.expandIcon),M=Ie(()=>({VListItem:{active:a.value,activeColor:e.activeColor,baseColor:e.baseColor,color:e.color,prependIcon:e.prependIcon||e.subgroup&&k.value,appendIcon:e.appendIcon||!e.subgroup&&k.value,title:e.title,value:e.value}}));return Gn(()=>ue(e.tag,{class:["v-list-group",{"v-list-group--prepend":l==null?void 0:l.hasPrepend.value,"v-list-group--fluid":e.fluid,"v-list-group--subgroup":e.subgroup,"v-list-group--open":a.value},e.class],style:e.style},{default:()=>[i.activator&&ue(ma,{defaults:M.value},{default:()=>[ue(Iz,null,{default:()=>[i.activator({props:C.value,isOpen:a.value})]})]}),ue(zo,{transition:{component:yL},disabled:!b.value},{default:()=>{var O;return[ps(ue("div",{class:"v-list-group__items",role:"group","aria-labelledby":m.value},[(O=i.default)==null?void 0:O.call(i)]),[[mu,a.value]])]}})]})),{}}}),Az=uE("v-list-item-subtitle"),Pz=uE("v-list-item-title"),Rz=$t({active:{type:Boolean,default:void 0},activeClass:String,activeColor:String,appendAvatar:String,appendIcon:Mi,baseColor:String,disabled:Boolean,lines:String,link:{type:Boolean,default:void 0},nav:Boolean,prependAvatar:String,prependIcon:Mi,ripple:{type:[Boolean,Object],default:!0},subtitle:[String,Number,Boolean],title:[String,Number,Boolean],value:null,onClick:_a(),onClickOnce:_a(),...Fv(),...hi(),...xu(),...bm(),...Uv(),...wu(),...aT(),...ba(),...es(),...Id({variant:"text"})},"VListItem"),Qc=En()({name:"VListItem",directives:{Ripple:Lv},props:Rz(),emits:{click:e=>!0},setup(e,t){let{attrs:i,slots:a,emit:c}=t;const d=sT(e,i),m=Ie(()=>e.value===void 0?d.href.value:e.value),{select:l,isSelected:b,isIndeterminate:w,isGroupActivator:C,root:k,parent:M,openOnSelect:O}=fT(m,!1),j=cT(),W=Ie(()=>{var je;return e.active!==!1&&(e.active||((je=d.isActive)==null?void 0:je.value)||b.value)}),le=Ie(()=>e.link!==!1&&d.isLink.value),he=Ie(()=>!e.disabled&&e.link!==!1&&(e.link||d.isClickable.value||e.value!=null&&!!j)),be=Ie(()=>e.rounded||e.nav),ge=Ie(()=>e.color??e.activeColor),Pe=Ie(()=>({color:W.value?ge.value??e.baseColor:e.baseColor,variant:e.variant}));Sn(()=>{var je;return(je=d.isActive)==null?void 0:je.value},je=>{je&&M.value!=null&&k.open(M.value,!0),je&&O(je)},{immediate:!0});const{themeClasses:Ue}=Cs(e),{borderClasses:Oe}=Nv(e),{colorClasses:Te,colorStyles:V,variantClasses:Z}=Bv(Pe),{densityClasses:ae}=bu(e),{dimensionStyles:ke}=wm(e),{elevationClasses:_e}=$v(e),{roundedClasses:oe}=Su(be),Re=Ie(()=>e.lines?`v-list-item--${e.lines}-line`:void 0),nt=Ie(()=>({isActive:W.value,select:l,isSelected:b.value,isIndeterminate:w.value}));function Qe(je){var Ze;c("click",je),!(C||!he.value)&&((Ze=d.navigate)==null||Ze.call(d,je),e.value!=null&&l(!b.value,je))}function qe(je){(je.key==="Enter"||je.key===" ")&&(je.preventDefault(),Qe(je))}return Gn(()=>{const je=le.value?"a":e.tag,Ze=a.title||e.title,kt=a.subtitle||e.subtitle,Et=!!(e.appendAvatar||e.appendIcon),rt=!!(Et||a.append),At=!!(e.prependAvatar||e.prependIcon),Pt=!!(At||a.prepend);return j==null||j.updateHasPrepend(Pt),e.activeColor&&sR("active-color",["color","base-color"]),ps(ue(je,{class:["v-list-item",{"v-list-item--active":W.value,"v-list-item--disabled":e.disabled,"v-list-item--link":he.value,"v-list-item--nav":e.nav,"v-list-item--prepend":!Pt&&(j==null?void 0:j.hasPrepend.value),[`${e.activeClass}`]:e.activeClass&&W.value},Ue.value,Oe.value,Te.value,ae.value,_e.value,Re.value,oe.value,Z.value,e.class],style:[V.value,ke.value,e.style],href:d.href.value,tabindex:he.value?j?-2:0:void 0,onClick:Qe,onKeydown:he.value&&!le.value&&qe},{default:()=>{var Wt;return[Ov(he.value||W.value,"v-list-item"),Pt&&ue("div",{key:"prepend",class:"v-list-item__prepend"},[a.prepend?ue(ma,{key:"prepend-defaults",disabled:!At,defaults:{VAvatar:{density:e.density,image:e.prependAvatar},VIcon:{density:e.density,icon:e.prependIcon},VListItemAction:{start:!0}}},{default:()=>{var He;return[(He=a.prepend)==null?void 0:He.call(a,nt.value)]}}):ue(yn,null,[e.prependAvatar&&ue(Fp,{key:"prepend-avatar",density:e.density,image:e.prependAvatar},null),e.prependIcon&&ue(ds,{key:"prepend-icon",density:e.density,icon:e.prependIcon},null)])]),ue("div",{class:"v-list-item__content","data-no-activator":""},[Ze&&ue(Pz,{key:"title"},{default:()=>{var He;return[((He=a.title)==null?void 0:He.call(a,{title:e.title}))??e.title]}}),kt&&ue(Az,{key:"subtitle"},{default:()=>{var He;return[((He=a.subtitle)==null?void 0:He.call(a,{subtitle:e.subtitle}))??e.subtitle]}}),(Wt=a.default)==null?void 0:Wt.call(a,nt.value)]),rt&&ue("div",{key:"append",class:"v-list-item__append"},[a.append?ue(ma,{key:"append-defaults",disabled:!Et,defaults:{VAvatar:{density:e.density,image:e.appendAvatar},VIcon:{density:e.density,icon:e.appendIcon},VListItemAction:{end:!0}}},{default:()=>{var He;return[(He=a.append)==null?void 0:He.call(a,nt.value)]}}):ue(yn,null,[e.appendIcon&&ue(ds,{key:"append-icon",density:e.density,icon:e.appendIcon},null),e.appendAvatar&&ue(Fp,{key:"append-avatar",density:e.density,image:e.appendAvatar},null)])])]}}),[[Ll("ripple"),he.value&&e.ripple]])}),{}}}),Mz=$t({color:String,inset:Boolean,sticky:Boolean,title:String,...hi(),...ba()},"VListSubheader"),Dz=En()({name:"VListSubheader",props:Mz(),setup(e,t){let{slots:i}=t;const{textColorClasses:a,textColorStyles:c}=xa(bn(e,"color"));return Gn(()=>{const d=!!(i.default||e.title);return ue(e.tag,{class:["v-list-subheader",{"v-list-subheader--inset":e.inset,"v-list-subheader--sticky":e.sticky},a.value,e.class],style:[{textColorStyles:c},e.style]},{default:()=>{var m;return[d&&ue("div",{class:"v-list-subheader__text"},[((m=i.default)==null?void 0:m.call(i))??e.title])]}})}),{}}}),Lz=$t({color:String,inset:Boolean,length:[Number,String],thickness:[Number,String],vertical:Boolean,...hi(),...es()},"VDivider"),zz=En()({name:"VDivider",props:Lz(),setup(e,t){let{attrs:i}=t;const{themeClasses:a}=Cs(e),{textColorClasses:c,textColorStyles:d}=xa(bn(e,"color")),m=Ie(()=>{const l={};return e.length&&(l[e.vertical?"maxHeight":"maxWidth"]=gn(e.length)),e.thickness&&(l[e.vertical?"borderRightWidth":"borderTopWidth"]=gn(e.thickness)),l});return Gn(()=>ue("hr",{class:[{"v-divider":!0,"v-divider--inset":e.inset,"v-divider--vertical":e.vertical},a.value,c.value,e.class],style:[m.value,d.value,e.style],"aria-orientation":!i.role||i.role==="separator"?e.vertical?"vertical":"horizontal":void 0,role:`${i.role||"separator"}`},null)),{}}}),Oz=$t({items:Array},"VListChildren"),pT=En()({name:"VListChildren",props:Oz(),setup(e,t){let{slots:i}=t;return lT(),()=>{var a,c;return((a=i.default)==null?void 0:a.call(i))??((c=e.items)==null?void 0:c.map(d=>{var O,j;let{children:m,props:l,type:b,raw:w}=d;if(b==="divider")return((O=i.divider)==null?void 0:O.call(i,{props:l}))??ue(zz,l,null);if(b==="subheader")return((j=i.subheader)==null?void 0:j.call(i,{props:l}))??ue(Dz,l,null);const C={subtitle:i.subtitle?W=>{var le;return(le=i.subtitle)==null?void 0:le.call(i,{...W,item:w})}:void 0,prepend:i.prepend?W=>{var le;return(le=i.prepend)==null?void 0:le.call(i,{...W,item:w})}:void 0,append:i.append?W=>{var le;return(le=i.append)==null?void 0:le.call(i,{...W,item:w})}:void 0,title:i.title?W=>{var le;return(le=i.title)==null?void 0:le.call(i,{...W,item:w})}:void 0},[k,M]=x1.filterProps(l);return m?ue(x1,kn({value:l==null?void 0:l.value},k),{activator:W=>{let{props:le}=W;return i.header?i.header({props:{...l,...le}}):ue(Qc,kn(l,le),C)},default:()=>ue(pT,{items:m},i)}):i.item?i.item({props:l}):ue(Qc,l,C)}))}}}),mT=$t({items:{type:Array,default:()=>[]},itemTitle:{type:[String,Array,Function],default:"title"},itemValue:{type:[String,Array,Function],default:"value"},itemChildren:{type:[Boolean,String,Array,Function],default:"children"},itemProps:{type:[Boolean,String,Array,Function],default:"props"},returnObject:Boolean},"list-items");function gT(e,t){const i=pa(t,e.itemTitle,t),a=e.returnObject?t:pa(t,e.itemValue,i),c=pa(t,e.itemChildren),d=e.itemProps===!0?typeof t=="object"&&t!=null&&!Array.isArray(t)?"children"in t?Ed(t,["children"])[1]:t:void 0:pa(t,e.itemProps),m={title:i,value:a,...d};return{title:String(m.title??""),value:m.value,props:m,children:Array.isArray(c)?_T(e,c):void 0,raw:t}}function _T(e,t){const i=[];for(const a of t)i.push(gT(e,a));return i}function yT(e){const t=Ie(()=>_T(e,e.items));return Bz(t,i=>gT(e,i))}function Bz(e,t){function i(c){return c.filter(d=>d!==null||e.value.some(m=>m.value===null)).map(d=>e.value.find(l=>gu(d,l.value))??t(d))}function a(c){return c.map(d=>{let{value:m}=d;return m})}return{items:e,transformIn:i,transformOut:a}}function Fz(e){return typeof e=="string"||typeof e=="number"||typeof e=="boolean"}function Nz(e,t){const i=pa(t,e.itemType,"item"),a=Fz(t)?t:pa(t,e.itemTitle),c=pa(t,e.itemValue,void 0),d=pa(t,e.itemChildren),m=e.itemProps===!0?Ed(t,["children"])[1]:pa(t,e.itemProps),l={title:a,value:c,...m};return{type:i,title:l.title,value:l.value,props:l,children:i==="item"&&d?vT(e,d):void 0,raw:t}}function vT(e,t){const i=[];for(const a of t)i.push(Nz(e,a));return i}function Uz(e){return{items:Ie(()=>vT(e,e.items))}}const $z=$t({baseColor:String,activeColor:String,activeClass:String,bgColor:String,disabled:Boolean,lines:{type:[Boolean,String],default:"one"},nav:Boolean,...Sz({selectStrategy:"single-leaf",openStrategy:"list"}),...Fv(),...hi(),...xu(),...bm(),...Uv(),itemType:{type:String,default:"type"},...mT(),...wu(),...ba(),...es(),...Id({variant:"text"})},"VList"),xT=En()({name:"VList",props:$z(),emits:{"update:selected":e=>!0,"update:opened":e=>!0,"click:open":e=>!0,"click:select":e=>!0},setup(e,t){let{slots:i}=t;const{items:a}=Uz(e),{themeClasses:c}=Cs(e),{backgroundColorClasses:d,backgroundColorStyles:m}=od(bn(e,"bgColor")),{borderClasses:l}=Nv(e),{densityClasses:b}=bu(e),{dimensionStyles:w}=wm(e),{elevationClasses:C}=$v(e),{roundedClasses:k}=Su(e),{open:M,select:O}=Ez(e),j=Ie(()=>e.lines?`v-list--${e.lines}-line`:void 0),W=bn(e,"activeColor"),le=bn(e,"baseColor"),he=bn(e,"color");lT(),Td({VListGroup:{activeColor:W,baseColor:le,color:he},VListItem:{activeClass:bn(e,"activeClass"),activeColor:W,baseColor:le,color:he,density:bn(e,"density"),disabled:bn(e,"disabled"),lines:bn(e,"lines"),nav:bn(e,"nav"),variant:bn(e,"variant")}});const be=wn(!1),ge=Jt();function Pe(Z){be.value=!0}function Ue(Z){be.value=!1}function Oe(Z){var ae;!be.value&&!(Z.relatedTarget&&((ae=ge.value)!=null&&ae.contains(Z.relatedTarget)))&&V()}function Te(Z){if(ge.value){if(Z.key==="ArrowDown")V("next");else if(Z.key==="ArrowUp")V("prev");else if(Z.key==="Home")V("first");else if(Z.key==="End")V("last");else return;Z.preventDefault()}}function V(Z){if(ge.value)return Ip(ge.value,Z)}return Gn(()=>ue(e.tag,{ref:ge,class:["v-list",{"v-list--disabled":e.disabled,"v-list--nav":e.nav},c.value,d.value,l.value,b.value,C.value,j.value,k.value,e.class],style:[m.value,w.value,e.style],tabindex:e.disabled||be.value?-1:0,role:"listbox","aria-activedescendant":void 0,onFocusin:Pe,onFocusout:Ue,onFocus:Oe,onKeydown:Te},{default:()=>[ue(pT,{items:a.value},i)]})),{open:M,select:O,focus:V}}});function c_(e,t){return{x:e.x+t.x,y:e.y+t.y}}function Vz(e,t){return{x:e.x-t.x,y:e.y-t.y}}function b1(e,t){if(e.side==="top"||e.side==="bottom"){const{side:i,align:a}=e,c=a==="left"?0:a==="center"?t.width/2:a==="right"?t.width:a,d=i==="top"?0:i==="bottom"?t.height:i;return c_({x:c,y:d},t)}else if(e.side==="left"||e.side==="right"){const{side:i,align:a}=e,c=i==="left"?0:i==="right"?t.width:i,d=a==="top"?0:a==="center"?t.height/2:a==="bottom"?t.height:a;return c_({x:c,y:d},t)}return c_({x:t.width/2,y:t.height/2},t)}const bT={static:qz,connected:Zz},jz=$t({locationStrategy:{type:[String,Function],default:"static",validator:e=>typeof e=="function"||e in bT},location:{type:String,default:"bottom"},origin:{type:String,default:"auto"},offset:[Number,String,Array]},"VOverlay-location-strategies");function Gz(e,t){const i=Jt({}),a=Jt();Hi&&(zl(()=>!!(t.isActive.value&&e.locationStrategy),d=>{var m,l;Sn(()=>e.locationStrategy,d),Jr(()=>{a.value=void 0}),typeof e.locationStrategy=="function"?a.value=(m=e.locationStrategy(t,e,i))==null?void 0:m.updateLocation:a.value=(l=bT[e.locationStrategy](t,e,i))==null?void 0:l.updateLocation}),window.addEventListener("resize",c,{passive:!0}),Jr(()=>{window.removeEventListener("resize",c),a.value=void 0}));function c(d){var m;(m=a.value)==null||m.call(a,d)}return{contentStyles:i,updateLocation:a}}function qz(){}function Hz(e,t){const i=vv(e);return t?i.x+=parseFloat(e.style.right||0):i.x-=parseFloat(e.style.left||0),i.y-=parseFloat(e.style.top||0),i}function Zz(e,t,i){ER(e.activatorEl.value)&&Object.assign(i.value,{position:"fixed",top:0,[e.isRtl.value?"right":"left"]:0});const{preferredAnchor:c,preferredOrigin:d}=_v(()=>{const j=G_(t.location,e.isRtl.value),W=t.origin==="overlap"?j:t.origin==="auto"?s_(j):G_(t.origin,e.isRtl.value);return j.side===W.side&&j.align===a_(W).align?{preferredAnchor:Ub(j),preferredOrigin:Ub(W)}:{preferredAnchor:j,preferredOrigin:W}}),[m,l,b,w]=["minWidth","minHeight","maxWidth","maxHeight"].map(j=>Ie(()=>{const W=parseFloat(t[j]);return isNaN(W)?1/0:W})),C=Ie(()=>{if(Array.isArray(t.offset))return t.offset;if(typeof t.offset=="string"){const j=t.offset.split(" ").map(parseFloat);return j.length<2&&j.push(0),j}return typeof t.offset=="number"?[t.offset,0]:[0,0]});let k=!1;const M=new ResizeObserver(()=>{k&&O()});Sn([e.activatorEl,e.contentEl],(j,W)=>{let[le,he]=j,[be,ge]=W;be&&M.unobserve(be),le&&M.observe(le),ge&&M.unobserve(ge),he&&M.observe(he)},{immediate:!0}),Jr(()=>{M.disconnect()});function O(){if(k=!1,requestAnimationFrame(()=>{requestAnimationFrame(()=>k=!0)}),!e.activatorEl.value||!e.contentEl.value)return;const j=e.activatorEl.value.getBoundingClientRect(),W=Hz(e.contentEl.value,e.isRtl.value),le=Pp(e.contentEl.value),he=12;le.length||(le.push(document.documentElement),e.contentEl.value.style.top&&e.contentEl.value.style.left||(W.x-=parseFloat(document.documentElement.style.getPropertyValue("--v-body-scroll-x")||0),W.y-=parseFloat(document.documentElement.style.getPropertyValue("--v-body-scroll-y")||0)));const be=le.reduce((ke,_e)=>{const oe=_e.getBoundingClientRect(),Re=new Yc({x:_e===document.documentElement?0:oe.x,y:_e===document.documentElement?0:oe.y,width:_e.clientWidth,height:_e.clientHeight});return ke?new Yc({x:Math.max(ke.left,Re.left),y:Math.max(ke.top,Re.top),width:Math.min(ke.right,Re.right)-Math.max(ke.left,Re.left),height:Math.min(ke.bottom,Re.bottom)-Math.max(ke.top,Re.top)}):Re},void 0);be.x+=he,be.y+=he,be.width-=he*2,be.height-=he*2;let ge={anchor:c.value,origin:d.value};function Pe(ke){const _e=new Yc(W),oe=b1(ke.anchor,j),Re=b1(ke.origin,_e);let{x:nt,y:Qe}=Vz(oe,Re);switch(ke.anchor.side){case"top":Qe-=C.value[0];break;case"bottom":Qe+=C.value[0];break;case"left":nt-=C.value[0];break;case"right":nt+=C.value[0];break}switch(ke.anchor.align){case"top":Qe-=C.value[1];break;case"bottom":Qe+=C.value[1];break;case"left":nt-=C.value[1];break;case"right":nt+=C.value[1];break}return _e.x+=nt,_e.y+=Qe,_e.width=Math.min(_e.width,b.value),_e.height=Math.min(_e.height,w.value),{overflows:Vb(_e,be),x:nt,y:Qe}}let Ue=0,Oe=0;const Te={x:0,y:0},V={x:!1,y:!1};let Z=-1;for(;!(Z++>10);){const{x:ke,y:_e,overflows:oe}=Pe(ge);Ue+=ke,Oe+=_e,W.x+=ke,W.y+=_e;{const Re=$b(ge.anchor),nt=oe.x.before||oe.x.after,Qe=oe.y.before||oe.y.after;let qe=!1;if(["x","y"].forEach(je=>{if(je==="x"&&nt&&!V.x||je==="y"&&Qe&&!V.y){const Ze={anchor:{...ge.anchor},origin:{...ge.origin}},kt=je==="x"?Re==="y"?a_:s_:Re==="y"?s_:a_;Ze.anchor=kt(Ze.anchor),Ze.origin=kt(Ze.origin);const{overflows:Et}=Pe(Ze);(Et[je].before<=oe[je].before&&Et[je].after<=oe[je].after||Et[je].before+Et[je].after<(oe[je].before+oe[je].after)/2)&&(ge=Ze,qe=V[je]=!0)}}),qe)continue}oe.x.before&&(Ue+=oe.x.before,W.x+=oe.x.before),oe.x.after&&(Ue-=oe.x.after,W.x-=oe.x.after),oe.y.before&&(Oe+=oe.y.before,W.y+=oe.y.before),oe.y.after&&(Oe-=oe.y.after,W.y-=oe.y.after);{const Re=Vb(W,be);Te.x=be.width-Re.x.before-Re.x.after,Te.y=be.height-Re.y.before-Re.y.after,Ue+=Re.x.before,W.x+=Re.x.before,Oe+=Re.y.before,W.y+=Re.y.before}break}const ae=$b(ge.anchor);return Object.assign(i.value,{"--v-overlay-anchor-origin":`${ge.anchor.side} ${ge.anchor.align}`,transformOrigin:`${ge.origin.side} ${ge.origin.align}`,top:gn(u_(Oe)),left:e.isRtl.value?void 0:gn(u_(Ue)),right:e.isRtl.value?gn(u_(-Ue)):void 0,minWidth:gn(ae==="y"?Math.min(m.value,j.width):m.value),maxWidth:gn(w1(j_(Te.x,m.value===1/0?0:m.value,b.value))),maxHeight:gn(w1(j_(Te.y,l.value===1/0?0:l.value,w.value)))}),{available:Te,contentBox:W}}return Sn(()=>[c.value,d.value,t.offset,t.minWidth,t.minHeight,t.maxWidth,t.maxHeight],()=>O()),Er(()=>{const j=O();if(!j)return;const{available:W,contentBox:le}=j;le.height>W.y&&requestAnimationFrame(()=>{O(),requestAnimationFrame(()=>{O()})})}),{updateLocation:O}}function u_(e){return Math.round(e*devicePixelRatio)/devicePixelRatio}function w1(e){return Math.ceil(e*devicePixelRatio)/devicePixelRatio}let ny=!0;const Np=[];function Wz(e){!ny||Np.length?(Np.push(e),iy()):(ny=!1,e(),iy())}let S1=-1;function iy(){cancelAnimationFrame(S1),S1=requestAnimationFrame(()=>{const e=Np.shift();e&&e(),Np.length?iy():ny=!0})}const mp={none:null,close:Kz,block:Jz,reposition:Qz},Yz=$t({scrollStrategy:{type:[String,Function],default:"block",validator:e=>typeof e=="function"||e in mp}},"VOverlay-scroll-strategies");function Xz(e,t){if(!Hi)return;let i;eo(async()=>{i==null||i.stop(),t.isActive.value&&e.scrollStrategy&&(i=bd(),await Er(),i.active&&i.run(()=>{var a;typeof e.scrollStrategy=="function"?e.scrollStrategy(t,e,i):(a=mp[e.scrollStrategy])==null||a.call(mp,t,e,i)}))}),Jr(()=>{i==null||i.stop()})}function Kz(e){function t(i){e.isActive.value=!1}wT(e.activatorEl.value??e.contentEl.value,t)}function Jz(e,t){var m;const i=(m=e.root.value)==null?void 0:m.offsetParent,a=[...new Set([...Pp(e.activatorEl.value,t.contained?i:void 0),...Pp(e.contentEl.value,t.contained?i:void 0)])].filter(l=>!l.classList.contains("v-overlay-scroll-blocked")),c=window.innerWidth-document.documentElement.offsetWidth,d=(l=>bv(l)&&l)(i||document.documentElement);d&&e.root.value.classList.add("v-overlay--scroll-blocked"),a.forEach((l,b)=>{l.style.setProperty("--v-body-scroll-x",gn(-l.scrollLeft)),l.style.setProperty("--v-body-scroll-y",gn(-l.scrollTop)),l.style.setProperty("--v-scrollbar-offset",gn(c)),l.classList.add("v-overlay-scroll-blocked")}),Jr(()=>{a.forEach((l,b)=>{const w=parseFloat(l.style.getPropertyValue("--v-body-scroll-x")),C=parseFloat(l.style.getPropertyValue("--v-body-scroll-y"));l.style.removeProperty("--v-body-scroll-x"),l.style.removeProperty("--v-body-scroll-y"),l.style.removeProperty("--v-scrollbar-offset"),l.classList.remove("v-overlay-scroll-blocked"),l.scrollLeft=-w,l.scrollTop=-C}),d&&e.root.value.classList.remove("v-overlay--scroll-blocked")})}function Qz(e,t,i){let a=!1,c=-1,d=-1;function m(l){Wz(()=>{var C,k;const b=performance.now();(k=(C=e.updateLocation).value)==null||k.call(C,l),a=(performance.now()-b)/(1e3/60)>2})}d=(typeof requestIdleCallback>"u"?l=>l():requestIdleCallback)(()=>{i.run(()=>{wT(e.activatorEl.value??e.contentEl.value,l=>{a?(cancelAnimationFrame(c),c=requestAnimationFrame(()=>{c=requestAnimationFrame(()=>{m(l)})})):m(l)})})}),Jr(()=>{typeof cancelIdleCallback<"u"&&cancelIdleCallback(d),cancelAnimationFrame(c)})}function wT(e,t){const i=[document,...Pp(e)];i.forEach(a=>{a.addEventListener("scroll",t,{passive:!0})}),Jr(()=>{i.forEach(a=>{a.removeEventListener("scroll",t)})})}const ry=Symbol.for("vuetify:v-menu"),eO=$t({closeDelay:[Number,String],openDelay:[Number,String]},"delay");function tO(e,t){const i={},a=c=>()=>{if(!Hi)return Promise.resolve(!0);const d=c==="openDelay";return i.closeDelay&&window.clearTimeout(i.closeDelay),delete i.closeDelay,i.openDelay&&window.clearTimeout(i.openDelay),delete i.openDelay,new Promise(m=>{const l=parseInt(e[c]??0,10);i[c]=window.setTimeout(()=>{t==null||t(d),m(d)},l)})};return{runCloseDelay:a("closeDelay"),runOpenDelay:a("openDelay")}}const nO=$t({activator:[String,Object],activatorProps:{type:Object,default:()=>({})},openOnClick:{type:Boolean,default:void 0},openOnHover:Boolean,openOnFocus:{type:Boolean,default:void 0},closeOnContentClick:Boolean,...eO()},"VOverlay-activator");function iO(e,t){let{isActive:i,isTop:a}=t;const c=Jt();let d=!1,m=!1,l=!0;const b=Ie(()=>e.openOnFocus||e.openOnFocus==null&&e.openOnHover),w=Ie(()=>e.openOnClick||e.openOnClick==null&&!e.openOnHover&&!b.value),{runOpenDelay:C,runCloseDelay:k}=tO(e,ge=>{ge===(e.openOnHover&&d||b.value&&m)&&!(e.openOnHover&&i.value&&!a.value)&&(i.value!==ge&&(l=!0),i.value=ge)}),M={onClick:ge=>{ge.stopPropagation(),c.value=ge.currentTarget||ge.target,i.value=!i.value},onMouseenter:ge=>{var Pe;(Pe=ge.sourceCapabilities)!=null&&Pe.firesTouchEvents||(d=!0,c.value=ge.currentTarget||ge.target,C())},onMouseleave:ge=>{d=!1,k()},onFocus:ge=>{q_&&!ge.target.matches(":focus-visible")||(m=!0,ge.stopPropagation(),c.value=ge.currentTarget||ge.target,C())},onBlur:ge=>{m=!1,ge.stopPropagation(),k()}},O=Ie(()=>{const ge={};return w.value&&(ge.onClick=M.onClick),e.openOnHover&&(ge.onMouseenter=M.onMouseenter,ge.onMouseleave=M.onMouseleave),b.value&&(ge.onFocus=M.onFocus,ge.onBlur=M.onBlur),ge}),j=Ie(()=>{const ge={};if(e.openOnHover&&(ge.onMouseenter=()=>{d=!0,C()},ge.onMouseleave=()=>{d=!1,k()}),b.value&&(ge.onFocusin=()=>{m=!0,C()},ge.onFocusout=()=>{m=!1,k()}),e.closeOnContentClick){const Pe=Jn(ry,null);ge.onClick=()=>{i.value=!1,Pe==null||Pe.closeParents()}}return ge}),W=Ie(()=>{const ge={};return e.openOnHover&&(ge.onMouseenter=()=>{l&&(d=!0,l=!1,C())},ge.onMouseleave=()=>{d=!1,k()}),ge});Sn(a,ge=>{ge&&(e.openOnHover&&!d&&(!b.value||!m)||b.value&&!m&&(!e.openOnHover||!d))&&(i.value=!1)});const le=Jt();eo(()=>{le.value&&Er(()=>{c.value=V_(le.value)})});const he=Nr("useActivator");let be;return Sn(()=>!!e.activator,ge=>{ge&&Hi?(be=bd(),be.run(()=>{rO(e,he,{activatorEl:c,activatorEvents:O})})):be&&be.stop()},{flush:"post",immediate:!0}),Jr(()=>{be==null||be.stop()}),{activatorEl:c,activatorRef:le,activatorEvents:O,contentEvents:j,scrimEvents:W}}function rO(e,t,i){let{activatorEl:a,activatorEvents:c}=i;Sn(()=>e.activator,(b,w)=>{if(w&&b!==w){const C=l(w);C&&m(C)}b&&Er(()=>d())},{immediate:!0}),Sn(()=>e.activatorProps,()=>{d()}),Jr(()=>{m()});function d(){let b=arguments.length>0&&arguments[0]!==void 0?arguments[0]:l(),w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e.activatorProps;b&&iR(b,kn(c.value,w))}function m(){let b=arguments.length>0&&arguments[0]!==void 0?arguments[0]:l(),w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e.activatorProps;b&&rR(b,kn(c.value,w))}function l(){var C,k;let b=arguments.length>0&&arguments[0]!==void 0?arguments[0]:e.activator,w;if(b)if(b==="parent"){let M=(k=(C=t==null?void 0:t.proxy)==null?void 0:C.$el)==null?void 0:k.parentNode;for(;M.hasAttribute("data-no-activator");)M=M.parentNode;w=M}else typeof b=="string"?w=document.querySelector(b):"$el"in b?w=b.$el:w=b;return a.value=(w==null?void 0:w.nodeType)===Node.ELEMENT_NODE?w:null,a.value}}function sO(){if(!Hi)return wn(!1);const{ssr:e}=PR();if(e){const t=wn(!1);return Fl(()=>{t.value=!0}),t}else return wn(!0)}const aO=$t({eager:Boolean},"lazy");function oO(e,t){const i=wn(!1),a=Ie(()=>i.value||e.eager||t.value);Sn(t,()=>i.value=!0);function c(){e.eager||(i.value=!1)}return{isBooted:i,hasContent:a,onAfterLeave:c}}function ST(){const t=Nr("useScopeId").vnode.scopeId;return{scopeId:t?{[t]:""}:void 0}}const E1=Symbol.for("vuetify:stack"),Ih=er([]);function lO(e,t,i){const a=Nr("useStack"),c=!i,d=Jn(E1,void 0),m=er({activeChildren:new Set});Sr(E1,m);const l=wn(+t.value);zl(e,()=>{var k;const C=(k=Ih.at(-1))==null?void 0:k[1];l.value=C?C+10:+t.value,c&&Ih.push([a.uid,l.value]),d==null||d.activeChildren.add(a.uid),Jr(()=>{if(c){const M=an(Ih).findIndex(O=>O[0]===a.uid);Ih.splice(M,1)}d==null||d.activeChildren.delete(a.uid)})});const b=wn(!0);c&&eo(()=>{var k;const C=((k=Ih.at(-1))==null?void 0:k[0])===a.uid;setTimeout(()=>b.value=C)});const w=Ie(()=>!m.activeChildren.size);return{globalTop:wd(b),localTop:w,stackStyles:Ie(()=>({zIndex:l.value}))}}function cO(e){return{teleportTarget:Ie(()=>{const i=e.value;if(i===!0||!Hi)return;const a=i===!1?document.body:typeof i=="string"?document.querySelector(i):i;if(a==null)return;let c=a.querySelector(":scope > .v-overlay-container");return c||(c=document.createElement("div"),c.className="v-overlay-container",a.appendChild(c)),c})}}function uO(){return!0}function ET(e,t,i){if(!e||TT(e,i)===!1)return!1;const a=hE(t);if(typeof ShadowRoot<"u"&&a instanceof ShadowRoot&&a.host===e.target)return!1;const c=(typeof i.value=="object"&&i.value.include||(()=>[]))();return c.push(t),!c.some(d=>d==null?void 0:d.contains(e.target))}function TT(e,t){return(typeof t.value=="object"&&t.value.closeConditional||uO)(e)}function hO(e,t,i){const a=typeof i.value=="function"?i.value:i.value.handler;t._clickOutside.lastMousedownWasOutside&&ET(e,t,i)&&setTimeout(()=>{TT(e,i)&&a&&a(e)},0)}function T1(e,t){const i=hE(e);t(document),typeof ShadowRoot<"u"&&i instanceof ShadowRoot&&t(i)}const dO={mounted(e,t){const i=c=>hO(c,e,t),a=c=>{e._clickOutside.lastMousedownWasOutside=ET(c,e,t)};T1(e,c=>{c.addEventListener("click",i,!0),c.addEventListener("mousedown",a,!0)}),e._clickOutside||(e._clickOutside={lastMousedownWasOutside:!1}),e._clickOutside[t.instance.$.uid]={onClick:i,onMousedown:a}},unmounted(e,t){e._clickOutside&&(T1(e,i=>{var d;if(!i||!((d=e._clickOutside)!=null&&d[t.instance.$.uid]))return;const{onClick:a,onMousedown:c}=e._clickOutside[t.instance.$.uid];i.removeEventListener("click",a,!0),i.removeEventListener("mousedown",c,!0)}),delete e._clickOutside[t.instance.$.uid])}};function fO(e){const{modelValue:t,color:i,...a}=e;return ue(Ya,{name:"fade-transition",appear:!0},{default:()=>[e.modelValue&&ue("div",kn({class:["v-overlay__scrim",e.color.backgroundColorClasses.value],style:e.color.backgroundColorStyles.value},a),null)]})}const CT=$t({absolute:Boolean,attach:[Boolean,String,Object],closeOnBack:{type:Boolean,default:!0},contained:Boolean,contentClass:null,contentProps:null,disabled:Boolean,noClickAnimation:Boolean,modelValue:Boolean,persistent:Boolean,scrim:{type:[Boolean,String],default:!0},zIndex:{type:[Number,String],default:2e3},...nO(),...hi(),...bm(),...aO(),...jz(),...Yz(),...es(),...vu()},"VOverlay"),C1=En()({name:"VOverlay",directives:{ClickOutside:dO},inheritAttrs:!1,props:{_disableGlobalStack:Boolean,...CT()},emits:{"click:outside":e=>!0,"update:modelValue":e=>!0,afterLeave:()=>!0},setup(e,t){let{slots:i,attrs:a,emit:c}=t;const d=Ci(e,"modelValue"),m=Ie({get:()=>d.value,set:Ze=>{Ze&&e.disabled||(d.value=Ze)}}),{teleportTarget:l}=cO(Ie(()=>e.attach||e.contained)),{themeClasses:b}=Cs(e),{rtlClasses:w,isRtl:C}=yu(),{hasContent:k,onAfterLeave:M}=oO(e,m),O=od(Ie(()=>typeof e.scrim=="string"?e.scrim:null)),{globalTop:j,localTop:W,stackStyles:le}=lO(m,bn(e,"zIndex"),e._disableGlobalStack),{activatorEl:he,activatorRef:be,activatorEvents:ge,contentEvents:Pe,scrimEvents:Ue}=iO(e,{isActive:m,isTop:W}),{dimensionStyles:Oe}=wm(e),Te=sO(),{scopeId:V}=ST();Sn(()=>e.disabled,Ze=>{Ze&&(m.value=!1)});const Z=Jt(),ae=Jt(),{contentStyles:ke,updateLocation:_e}=Gz(e,{isRtl:C,contentEl:ae,activatorEl:he,isActive:m});Xz(e,{root:Z,contentEl:ae,activatorEl:he,isActive:m,updateLocation:_e});function oe(Ze){c("click:outside",Ze),e.persistent?je():m.value=!1}function Re(){return m.value&&j.value}Hi&&Sn(m,Ze=>{Ze?window.addEventListener("keydown",nt):window.removeEventListener("keydown",nt)},{immediate:!0});function nt(Ze){var kt,Et;Ze.key==="Escape"&&j.value&&(e.persistent?je():(m.value=!1,(kt=ae.value)!=null&&kt.contains(document.activeElement)&&((Et=he.value)==null||Et.focus())))}const Qe=mz();zl(()=>e.closeOnBack,()=>{gz(Qe,Ze=>{j.value&&m.value?(Ze(!1),e.persistent?je():m.value=!1):Ze()})});const qe=Jt();Sn(()=>m.value&&(e.absolute||e.contained)&&l.value==null,Ze=>{if(Ze){const kt=bR(Z.value);kt&&kt!==document.scrollingElement&&(qe.value=kt.scrollTop)}});function je(){e.noClickAnimation||ae.value&&Vc(ae.value,[{transformOrigin:"center"},{transform:"scale(1.03)"},{transformOrigin:"center"}],{duration:150,easing:Ap})}return Gn(()=>{var Ze;return ue(yn,null,[(Ze=i.activator)==null?void 0:Ze.call(i,{isActive:m.value,props:kn({ref:be},ge.value,e.activatorProps)}),Te.value&&ue(KA,{disabled:!l.value,to:l.value},{default:()=>[k.value&&ue("div",kn({class:["v-overlay",{"v-overlay--absolute":e.absolute||e.contained,"v-overlay--active":m.value,"v-overlay--contained":e.contained},b.value,w.value,e.class],style:[le.value,{top:gn(qe.value)},e.style],ref:Z},V,a),[ue(fO,kn({color:O,modelValue:m.value&&!!e.scrim},Ue.value),null),ue(zo,{appear:!0,persisted:!0,transition:e.transition,target:he.value,onAfterLeave:()=>{M(),c("afterLeave")}},{default:()=>{var kt;return[ps(ue("div",kn({ref:ae,class:["v-overlay__content",e.contentClass],style:[Oe.value,ke.value]},Pe.value,e.contentProps),[(kt=i.default)==null?void 0:kt.call(i,{isActive:m})]),[[mu,m.value],[Ll("click-outside"),{handler:oe,closeConditional:Re,include:()=>[he.value]}]])]}})])]})])}),{activatorEl:he,animateClick:je,contentEl:ae,globalTop:j,localTop:W,updateLocation:_e}}}),h_=Symbol("Forwarded refs");function d_(e,t){let i=e;for(;i;){const a=Reflect.getOwnPropertyDescriptor(i,t);if(a)return a;i=Object.getPrototypeOf(i)}}function Sm(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),a=1;a<t;a++)i[a-1]=arguments[a];return e[h_]=i,new Proxy(e,{get(c,d){if(Reflect.has(c,d))return Reflect.get(c,d);if(!(typeof d=="symbol"||d.startsWith("__"))){for(const m of i)if(m.value&&Reflect.has(m.value,d)){const l=Reflect.get(m.value,d);return typeof l=="function"?l.bind(m.value):l}}},has(c,d){if(Reflect.has(c,d))return!0;if(typeof d=="symbol"||d.startsWith("__"))return!1;for(const m of i)if(m.value&&Reflect.has(m.value,d))return!0;return!1},getOwnPropertyDescriptor(c,d){var l;const m=Reflect.getOwnPropertyDescriptor(c,d);if(m)return m;if(!(typeof d=="symbol"||d.startsWith("__"))){for(const b of i){if(!b.value)continue;const w=d_(b.value,d)??("_"in b.value?d_((l=b.value._)==null?void 0:l.setupState,d):void 0);if(w)return w}for(const b of i){const w=b.value&&b.value[h_];if(!w)continue;const C=w.slice();for(;C.length;){const k=C.shift(),M=d_(k.value,d);if(M)return M;const O=k.value&&k.value[h_];O&&C.push(...O)}}}}})}const pO=$t({id:String,...mv(CT({closeDelay:250,closeOnContentClick:!0,locationStrategy:"connected",openDelay:300,scrim:!1,scrollStrategy:"reposition",transition:{component:zE}}),["absolute"])},"VMenu"),IT=En()({name:"VMenu",props:pO(),emits:{"update:modelValue":e=>!0},setup(e,t){let{slots:i}=t;const a=Ci(e,"modelValue"),{scopeId:c}=ST(),d=Zs(),m=Ie(()=>e.id||`v-menu-${d}`),l=Jt(),b=Jn(ry,null),w=wn(0);Sr(ry,{register(){++w.value},unregister(){--w.value},closeParents(){setTimeout(()=>{w.value||(a.value=!1,b==null||b.closeParents())},40)}}),Sn(a,j=>{j?b==null||b.register():b==null||b.unregister()});function C(){b==null||b.closeParents()}function k(j){var W,le;e.disabled||j.key==="Tab"&&(a.value=!1,(le=(W=l.value)==null?void 0:W.activatorEl)==null||le.focus())}function M(j){var le;if(e.disabled)return;const W=(le=l.value)==null?void 0:le.contentEl;W&&a.value?j.key==="ArrowDown"?(j.preventDefault(),Ip(W,"next")):j.key==="ArrowUp"&&(j.preventDefault(),Ip(W,"prev")):["ArrowDown","ArrowUp"].includes(j.key)&&(a.value=!0,j.preventDefault(),setTimeout(()=>setTimeout(()=>M(j))))}const O=Ie(()=>kn({"aria-haspopup":"menu","aria-expanded":String(a.value),"aria-owns":m.value,onKeydown:M},e.activatorProps));return Gn(()=>{const[j]=C1.filterProps(e);return ue(C1,kn({ref:l,class:["v-menu",e.class],style:e.style},j,{modelValue:a.value,"onUpdate:modelValue":W=>a.value=W,absolute:!0,activatorProps:O.value,"onClick:outside":C,onKeydown:k},c),{activator:i.activator,default:function(){for(var W=arguments.length,le=new Array(W),he=0;he<W;he++)le[he]=arguments[he];return ue(ma,{root:"VMenu"},{default:()=>{var be;return[(be=i.default)==null?void 0:be.call(i,...le)]}})}})}),Sm({id:m,ΨopenChildren:w},l)}}),mO=$t({active:Boolean,max:[Number,String],value:{type:[Number,String],default:0},...hi(),...vu({transition:{component:OE}})},"VCounter"),gO=En()({name:"VCounter",functional:!0,props:mO(),setup(e,t){let{slots:i}=t;const a=Ie(()=>e.max?`${e.value} / ${e.max}`:String(e.value));return Gn(()=>ue(zo,{transition:e.transition},{default:()=>[ps(ue("div",{class:["v-counter",e.class],style:e.style},[i.default?i.default({counter:a.value,max:e.max,value:e.value}):a.value]),[[mu,e.active]])]})),{}}}),_O=$t({floating:Boolean,...hi()},"VFieldLabel"),Zf=En()({name:"VFieldLabel",props:_O(),setup(e,t){let{slots:i}=t;return Gn(()=>ue(UE,{class:["v-field-label",{"v-field-label--floating":e.floating},e.class],style:e.style,"aria-hidden":e.floating||void 0},i)),{}}}),yO=["underlined","outlined","filled","solo","solo-inverted","solo-filled","plain"],kT=$t({appendInnerIcon:Mi,bgColor:String,clearable:Boolean,clearIcon:{type:Mi,default:"$clear"},active:Boolean,centerAffix:{type:Boolean,default:void 0},color:String,baseColor:String,dirty:Boolean,disabled:{type:Boolean,default:null},error:Boolean,flat:Boolean,label:String,persistentClear:Boolean,prependInnerIcon:Mi,reverse:Boolean,singleLine:Boolean,variant:{type:String,default:"filled",validator:e=>yO.includes(e)},"onClick:clear":_a(),"onClick:appendInner":_a(),"onClick:prependInner":_a(),...hi(),...NL(),...wu(),...es()},"VField"),AT=En()({name:"VField",inheritAttrs:!1,props:{id:String,...FE(),...kT()},emits:{"update:focused":e=>!0,"update:modelValue":e=>!0},setup(e,t){let{attrs:i,emit:a,slots:c}=t;const{themeClasses:d}=Cs(e),{loaderClasses:m}=KE(e),{focusClasses:l,isFocused:b,focus:w,blur:C}=Rv(e),{InputIcon:k}=ME(e),{roundedClasses:M}=Su(e),{rtlClasses:O}=yu(),j=Ie(()=>e.dirty||e.active),W=Ie(()=>!e.singleLine&&!!(e.label||c.label)),le=Zs(),he=Ie(()=>e.id||`input-${le}`),be=Ie(()=>`${he.value}-messages`),ge=Jt(),Pe=Jt(),Ue=Jt(),Oe=Ie(()=>["plain","underlined"].includes(e.variant)),{backgroundColorClasses:Te,backgroundColorStyles:V}=od(bn(e,"bgColor")),{textColorClasses:Z,textColorStyles:ae}=xa(Ie(()=>e.error||e.disabled?void 0:j.value&&b.value?e.color:e.baseColor));Sn(j,oe=>{if(W.value){const Re=ge.value.$el,nt=Pe.value.$el;requestAnimationFrame(()=>{const Qe=vv(Re),qe=nt.getBoundingClientRect(),je=qe.x-Qe.x,Ze=qe.y-Qe.y-(Qe.height/2-qe.height/2),kt=qe.width/.75,Et=Math.abs(kt-Qe.width)>1?{maxWidth:gn(kt)}:void 0,rt=getComputedStyle(Re),At=getComputedStyle(nt),Pt=parseFloat(rt.transitionDuration)*1e3||150,Wt=parseFloat(At.getPropertyValue("--v-field-label-scale")),He=At.getPropertyValue("color");Re.style.visibility="visible",nt.style.visibility="hidden",Vc(Re,{transform:`translate(${je}px, ${Ze}px) scale(${Wt})`,color:He,...Et},{duration:Pt,easing:Ap,direction:oe?"normal":"reverse"}).finished.then(()=>{Re.style.removeProperty("visibility"),nt.style.removeProperty("visibility")})})}},{flush:"post"});const ke=Ie(()=>({isActive:j,isFocused:b,controlRef:Ue,blur:C,focus:w}));function _e(oe){oe.target!==document.activeElement&&oe.preventDefault()}return Gn(()=>{var je,Ze,kt;const oe=e.variant==="outlined",Re=c["prepend-inner"]||e.prependInnerIcon,nt=!!(e.clearable||c.clear),Qe=!!(c["append-inner"]||e.appendInnerIcon||nt),qe=c.label?c.label({...ke.value,label:e.label,props:{for:he.value}}):e.label;return ue("div",kn({class:["v-field",{"v-field--active":j.value,"v-field--appended":Qe,"v-field--center-affix":e.centerAffix??!Oe.value,"v-field--disabled":e.disabled,"v-field--dirty":e.dirty,"v-field--error":e.error,"v-field--flat":e.flat,"v-field--has-background":!!e.bgColor,"v-field--persistent-clear":e.persistentClear,"v-field--prepended":Re,"v-field--reverse":e.reverse,"v-field--single-line":e.singleLine,"v-field--no-label":!qe,[`v-field--variant-${e.variant}`]:!0},d.value,Te.value,l.value,m.value,M.value,O.value,e.class],style:[V.value,ae.value,e.style],onClick:_e},i),[ue("div",{class:"v-field__overlay"},null),ue(JE,{name:"v-field",active:!!e.loading,color:e.error?"error":e.color},{default:c.loader}),Re&&ue("div",{key:"prepend",class:"v-field__prepend-inner"},[e.prependInnerIcon&&ue(k,{key:"prepend-icon",name:"prependInner"},null),(je=c["prepend-inner"])==null?void 0:je.call(c,ke.value)]),ue("div",{class:"v-field__field","data-no-activator":""},[["filled","solo","solo-inverted","solo-filled"].includes(e.variant)&&W.value&&ue(Zf,{key:"floating-label",ref:Pe,class:[Z.value],floating:!0,for:he.value},{default:()=>[qe]}),ue(Zf,{ref:ge,for:he.value},{default:()=>[qe]}),(Ze=c.default)==null?void 0:Ze.call(c,{...ke.value,props:{id:he.value,class:"v-field__input","aria-describedby":be.value},focus:w,blur:C})]),nt&&ue(BE,{key:"clear"},{default:()=>[ps(ue("div",{class:"v-field__clearable",onMousedown:Et=>{Et.preventDefault(),Et.stopPropagation()}},[c.clear?c.clear():ue(k,{name:"clear"},null)]),[[mu,e.dirty]])]}),Qe&&ue("div",{key:"append",class:"v-field__append-inner"},[(kt=c["append-inner"])==null?void 0:kt.call(c,ke.value),e.appendInnerIcon&&ue(k,{key:"append-icon",name:"appendInner"},null)]),ue("div",{class:["v-field__outline",Z.value]},[oe&&ue(yn,null,[ue("div",{class:"v-field__outline__start"},null),W.value&&ue("div",{class:"v-field__outline__notch"},[ue(Zf,{ref:Pe,floating:!0,for:he.value},{default:()=>[qe]})]),ue("div",{class:"v-field__outline__end"},null)]),Oe.value&&W.value&&ue(Zf,{ref:Pe,floating:!0,for:he.value},{default:()=>[qe]})])])}),{controlRef:Ue}}});function vO(e){const t=Object.keys(AT.props).filter(i=>!yv(i)&&i!=="class"&&i!=="style");return Ed(e,t)}const xO=["color","file","time","date","datetime-local","week","month"],jv=$t({autofocus:Boolean,counter:[Boolean,Number,String],counterValue:Function,prefix:String,placeholder:String,persistentPlaceholder:Boolean,persistentCounter:Boolean,suffix:String,type:{type:String,default:"text"},modelModifiers:Object,...Dv(),...kT()},"VTextField"),Up=En()({name:"VTextField",directives:{Intersect:nT},inheritAttrs:!1,props:jv(),emits:{"click:control":e=>!0,"mousedown:control":e=>!0,"update:focused":e=>!0,"update:modelValue":e=>!0},setup(e,t){let{attrs:i,emit:a,slots:c}=t;const d=Ci(e,"modelValue"),{isFocused:m,focus:l,blur:b}=Rv(e),w=Ie(()=>typeof e.counterValue=="function"?e.counterValue(d.value):(d.value??"").toString().length),C=Ie(()=>{if(i.maxlength)return i.maxlength;if(!(!e.counter||typeof e.counter!="number"&&typeof e.counter!="string"))return e.counter}),k=Ie(()=>["plain","underlined"].includes(e.variant));function M(Oe,Te){var V,Z;!e.autofocus||!Oe||(Z=(V=Te[0].target)==null?void 0:V.focus)==null||Z.call(V)}const O=Jt(),j=Jt(),W=Jt(),le=Ie(()=>xO.includes(e.type)||e.persistentPlaceholder||m.value||e.active);function he(){var Oe;W.value!==document.activeElement&&((Oe=W.value)==null||Oe.focus()),m.value||l()}function be(Oe){a("mousedown:control",Oe),Oe.target!==W.value&&(he(),Oe.preventDefault())}function ge(Oe){he(),a("click:control",Oe)}function Pe(Oe){Oe.stopPropagation(),he(),Er(()=>{d.value=null,QP(e["onClick:clear"],Oe)})}function Ue(Oe){var V;const Te=Oe.target;if(d.value=Te.value,(V=e.modelModifiers)!=null&&V.trim&&["text","search","password","tel","url"].includes(e.type)){const Z=[Te.selectionStart,Te.selectionEnd];Er(()=>{Te.selectionStart=Z[0],Te.selectionEnd=Z[1]})}}return Gn(()=>{const Oe=!!(c.counter||e.counter||e.counterValue),Te=!!(Oe||c.details),[V,Z]=gv(i),[{modelValue:ae,...ke}]=Op.filterProps(e),[_e]=vO(e);return ue(Op,kn({ref:O,modelValue:d.value,"onUpdate:modelValue":oe=>d.value=oe,class:["v-text-field",{"v-text-field--prefixed":e.prefix,"v-text-field--suffixed":e.suffix,"v-text-field--plain-underlined":["plain","underlined"].includes(e.variant)},e.class],style:e.style},V,ke,{centerAffix:!k.value,focused:m.value}),{...c,default:oe=>{let{id:Re,isDisabled:nt,isDirty:Qe,isReadonly:qe,isValid:je}=oe;return ue(AT,kn({ref:j,onMousedown:be,onClick:ge,"onClick:clear":Pe,"onClick:prependInner":e["onClick:prependInner"],"onClick:appendInner":e["onClick:appendInner"],role:"textbox"},_e,{id:Re.value,active:le.value||Qe.value,dirty:Qe.value||e.dirty,disabled:nt.value,focused:m.value,error:je.value===!1}),{...c,default:Ze=>{let{props:{class:kt,...Et}}=Ze;const rt=ps(ue("input",kn({ref:W,value:d.value,onInput:Ue,autofocus:e.autofocus,readonly:qe.value,disabled:nt.value,name:e.name,placeholder:e.placeholder,size:1,type:e.type,onFocus:he,onBlur:b},Et,Z),null),[[Ll("intersect"),{handler:M},null,{once:!0}]]);return ue(yn,null,[e.prefix&&ue("span",{class:"v-text-field__prefix"},[e.prefix]),ue("div",{class:kt,"data-no-activator":""},[c.default?ue(yn,null,[c.default(),rt]):Wa(rt)]),e.suffix&&ue("span",{class:"v-text-field__suffix"},[e.suffix])])}})},details:Te?oe=>{var Re;return ue(yn,null,[(Re=c.details)==null?void 0:Re.call(c,oe),Oe&&ue(yn,null,[ue("span",null,null),ue(gO,{active:e.persistentCounter||m.value,value:w.value,max:C.value},c.counter)])])}:void 0})}),Sm({},O,j,W)}}),PT=$t({chips:Boolean,closableChips:Boolean,eager:Boolean,hideNoData:Boolean,hideSelected:Boolean,menu:Boolean,menuIcon:{type:Mi,default:"$dropdown"},menuProps:{type:Object},multiple:Boolean,noDataText:{type:String,default:"$vuetify.noDataText"},openOnClear:Boolean,valueComparator:{type:Function,default:gu},...mT({itemChildren:!1})},"Select"),bO=$t({...PT(),...mv(jv({modelValue:null}),["validationValue","dirty","appendInnerIcon"]),...vu({transition:{component:zE}})},"VSelect");En()({name:"VSelect",props:bO(),emits:{"update:focused":e=>!0,"update:modelValue":e=>!0,"update:menu":e=>!0},setup(e,t){let{slots:i}=t;const{t:a}=_m(),c=Jt(),d=Jt(),m=Ci(e,"menu"),l=Ie({get:()=>m.value,set:oe=>{var Re;m.value&&!oe&&((Re=d.value)!=null&&Re.ΨopenChildren)||(m.value=oe)}}),{items:b,transformIn:w,transformOut:C}=yT(e),k=Ci(e,"modelValue",[],oe=>w(oe===null?[null]:ga(oe)),oe=>{const Re=C(oe);return e.multiple?Re:Re[0]??null}),M=Mv(),O=Ie(()=>k.value.map(oe=>b.value.find(Re=>e.valueComparator(Re.value,oe.value))||oe)),j=Ie(()=>O.value.map(oe=>oe.props.value)),W=wn(!1);let le="",he;const be=Ie(()=>e.hideSelected?b.value.filter(oe=>!O.value.some(Re=>Re===oe)):b.value),ge=Ie(()=>e.hideNoData&&!b.value.length||e.readonly||(M==null?void 0:M.isReadonly.value)),Pe=Jt();function Ue(oe){e.openOnClear&&(l.value=!0)}function Oe(){ge.value||(l.value=!l.value)}function Te(oe){var je,Ze;if(e.readonly||M!=null&&M.isReadonly.value)return;["Enter"," ","ArrowDown","ArrowUp","Home","End"].includes(oe.key)&&oe.preventDefault(),["Enter","ArrowDown"," "].includes(oe.key)&&(l.value=!0),["Escape","Tab"].includes(oe.key)&&(l.value=!1),oe.key==="Home"?(je=Pe.value)==null||je.focus("first"):oe.key==="End"&&((Ze=Pe.value)==null||Ze.focus("last"));const Re=1e3;function nt(kt){const Et=kt.key.length===1,rt=!kt.ctrlKey&&!kt.metaKey&&!kt.altKey;return Et&&rt}if(e.multiple||!nt(oe))return;const Qe=performance.now();Qe-he>Re&&(le=""),le+=oe.key.toLowerCase(),he=Qe;const qe=b.value.find(kt=>kt.title.toLowerCase().startsWith(le));qe!==void 0&&(k.value=[qe])}function V(oe){var Re;oe.key==="Tab"&&((Re=c.value)==null||Re.focus())}function Z(oe){if(e.multiple){const Re=j.value.findIndex(nt=>e.valueComparator(nt,oe.value));if(Re===-1)k.value=[...k.value,oe];else{const nt=[...k.value];nt.splice(Re,1),k.value=nt}}else k.value=[oe],l.value=!1}function ae(oe){var Re;(Re=Pe.value)!=null&&Re.$el.contains(oe.relatedTarget)||(l.value=!1)}function ke(){var oe;W.value&&((oe=c.value)==null||oe.focus())}function _e(oe){W.value=!0}return Gn(()=>{const oe=!!(e.chips||i.chip),Re=!!(!e.hideNoData||be.value.length||i["prepend-item"]||i["append-item"]||i["no-data"]),nt=k.value.length>0,[Qe]=Up.filterProps(e),qe=nt||!W.value&&e.label&&!e.persistentPlaceholder?void 0:e.placeholder;return ue(Up,kn({ref:c},Qe,{modelValue:k.value.map(je=>je.props.value).join(", "),"onUpdate:modelValue":je=>{je==null&&(k.value=[])},focused:W.value,"onUpdate:focused":je=>W.value=je,validationValue:k.externalValue,dirty:nt,class:["v-select",{"v-select--active-menu":l.value,"v-select--chips":!!e.chips,[`v-select--${e.multiple?"multiple":"single"}`]:!0,"v-select--selected":k.value.length,"v-select--selection-slot":!!i.selection},e.class],style:e.style,readonly:!0,placeholder:qe,"onClick:clear":Ue,"onMousedown:control":Oe,onBlur:ae,onKeydown:Te}),{...i,default:()=>ue(yn,null,[ue(IT,kn({ref:d,modelValue:l.value,"onUpdate:modelValue":je=>l.value=je,activator:"parent",contentClass:"v-select__content",disabled:ge.value,eager:e.eager,maxHeight:310,openOnClick:!1,closeOnContentClick:!1,transition:e.transition,onAfterLeave:ke},e.menuProps),{default:()=>[Re&&ue(xT,{ref:Pe,selected:j.value,selectStrategy:e.multiple?"independent":"single-independent",onMousedown:je=>je.preventDefault(),onKeydown:V,onFocusin:_e,tabindex:"-1"},{default:()=>{var je,Ze,kt;return[(je=i["prepend-item"])==null?void 0:je.call(i),!be.value.length&&!e.hideNoData&&(((Ze=i["no-data"])==null?void 0:Ze.call(i))??ue(Qc,{title:a(e.noDataText)},null)),be.value.map((Et,rt)=>{var Pt;const At=kn(Et.props,{key:rt,onClick:()=>Z(Et)});return((Pt=i.item)==null?void 0:Pt.call(i,{item:Et,index:rt,props:At}))??ue(Qc,At,{prepend:Wt=>{let{isSelected:He}=Wt;return ue(yn,null,[e.multiple&&!e.hideSelected?ue(QE,{key:Et.value,modelValue:He,ripple:!1,tabindex:"-1"},null):void 0,Et.props.prependIcon&&ue(ds,{icon:Et.props.prependIcon},null)])}})}),(kt=i["append-item"])==null?void 0:kt.call(i)]}})]}),O.value.map((je,Ze)=>{var rt;function kt(At){At.stopPropagation(),At.preventDefault(),Z(je)}const Et={"onClick:close":kt,onMousedown(At){At.preventDefault(),At.stopPropagation()},modelValue:!0,"onUpdate:modelValue":void 0};return ue("div",{key:je.value,class:"v-select__selection"},[oe?i.chip?ue(ma,{key:"chip-defaults",defaults:{VChip:{closable:e.closableChips,size:"small",text:je.title}}},{default:()=>{var At;return[(At=i.chip)==null?void 0:At.call(i,{item:je,index:Ze,props:Et})]}}):ue(oT,kn({key:"chip",closable:e.closableChips,size:"small",text:je.title},Et),null):((rt=i.selection)==null?void 0:rt.call(i,{item:je,index:Ze}))??ue("span",{class:"v-select__selection-text"},[je.title,e.multiple&&Ze<O.value.length-1&&ue("span",{class:"v-select__selection-comma"},[Vo(",")])])])})]),"append-inner":function(){var Et;for(var je=arguments.length,Ze=new Array(je),kt=0;kt<je;kt++)Ze[kt]=arguments[kt];return ue(yn,null,[(Et=i["append-inner"])==null?void 0:Et.call(i,...Ze),e.menuIcon?ue(ds,{class:"v-select__menu-icon",icon:e.menuIcon},null):void 0])}})}),Sm({isFocused:W,menu:l,select:Z},c)}});const wO=(e,t,i)=>e==null||t==null?-1:e.toString().toLocaleLowerCase().indexOf(t.toString().toLocaleLowerCase()),SO=$t({customFilter:Function,customKeyFilter:Object,filterKeys:[Array,String],filterMode:{type:String,default:"intersection"},noFilter:Boolean},"filter");function EO(e,t,i){var l;const a=[],c=(i==null?void 0:i.default)??wO,d=i!=null&&i.filterKeys?ga(i.filterKeys):!1,m=Object.keys((i==null?void 0:i.customKeyFilter)??{}).length;if(!(e!=null&&e.length))return a;e:for(let b=0;b<e.length;b++){const w=e[b],C={},k={};let M=-1;if(t&&!(i!=null&&i.noFilter)){if(typeof w=="object"){const W=d||Object.keys(w);for(const le of W){const he=pa(w,le,w),be=(l=i==null?void 0:i.customKeyFilter)==null?void 0:l[le];if(M=be?be(he,t,w):c(he,t,w),M!==-1&&M!==!1)be?C[le]=M:k[le]=M;else if((i==null?void 0:i.filterMode)==="every")continue e}}else M=c(w,t,w),M!==-1&&M!==!1&&(k.title=M);const O=Object.keys(k).length,j=Object.keys(C).length;if(!O&&!j||(i==null?void 0:i.filterMode)==="union"&&j!==m&&!O||(i==null?void 0:i.filterMode)==="intersection"&&(j!==m||!O))continue}a.push({index:b,matches:{...k,...C}})}return a}function TO(e,t,i,a){const c=Ie(()=>typeof(i==null?void 0:i.value)!="string"&&typeof(i==null?void 0:i.value)!="number"?"":String(i.value)),d=Jt([]),m=Jt(new Map),l=Ie(()=>a!=null&&a.transform?hr(t).map(a==null?void 0:a.transform):hr(t));eo(()=>{d.value=[],m.value=new Map;const w=EO(l.value,c.value,{customKeyFilter:e.customKeyFilter,default:e.customFilter,filterKeys:e.filterKeys,filterMode:e.filterMode,noFilter:e.noFilter}),C=hr(t);w.forEach(k=>{let{index:M,matches:O}=k;const j=C[M];d.value.push(j),m.value.set(j.value,O)})});function b(w){return m.value.get(w.value)}return{filteredItems:d,filteredMatches:m,getMatches:b}}function CO(e,t,i){if(t==null)return e;if(Array.isArray(t))throw new Error("Multiple matches is not implemented");return typeof t=="number"&&~t?ue(yn,null,[ue("span",{class:"v-autocomplete__unmask"},[e.substr(0,t)]),ue("span",{class:"v-autocomplete__mask"},[e.substr(t,i)]),ue("span",{class:"v-autocomplete__unmask"},[e.substr(t+i)])]):e}const IO=$t({autoSelectFirst:{type:[Boolean,String]},search:String,...SO({filterKeys:["title"]}),...PT(),...mv(jv({modelValue:null}),["validationValue","dirty","appendInnerIcon"]),...vu({transition:!1})},"VAutocomplete"),kO=En()({name:"VAutocomplete",props:IO(),emits:{"update:focused":e=>!0,"update:search":e=>!0,"update:modelValue":e=>!0,"update:menu":e=>!0},setup(e,t){let{slots:i}=t;const{t:a}=_m(),c=Jt(),d=wn(!1),m=wn(!0),l=Jt(!1),b=Jt(),w=Ci(e,"menu"),C=Ie({get:()=>w.value,set:He=>{var xe;w.value&&!He&&((xe=b.value)!=null&&xe.ΨopenChildren)||(w.value=He)}}),k=wn(-1),M=Ie(()=>{var He;return(He=c.value)==null?void 0:He.color}),{items:O,transformIn:j,transformOut:W}=yT(e),{textColorClasses:le,textColorStyles:he}=xa(M),be=Ci(e,"search",""),ge=Ci(e,"modelValue",[],He=>j(He===null?[null]:ga(He)),He=>{const xe=W(He);return e.multiple?xe:xe[0]??null}),Pe=Mv(),{filteredItems:Ue,getMatches:Oe}=TO(e,O,Ie(()=>m.value?void 0:be.value)),Te=Ie(()=>ge.value.map(He=>O.value.find(xe=>e.valueComparator(xe.value,He.value))||He)),V=Ie(()=>e.hideSelected?Ue.value.filter(He=>!Te.value.some(xe=>xe.value===He.value)):Ue.value),Z=Ie(()=>Te.value.map(He=>He.props.value)),ae=Ie(()=>Te.value[k.value]),ke=Ie(()=>{var xe;return(e.autoSelectFirst===!0||e.autoSelectFirst==="exact"&&be.value===((xe=V.value[0])==null?void 0:xe.title))&&V.value.length>0&&!m.value&&!l.value}),_e=Ie(()=>e.hideNoData&&!O.value.length||e.readonly||(Pe==null?void 0:Pe.isReadonly.value)),oe=Jt();function Re(He){e.openOnClear&&(C.value=!0),be.value=""}function nt(){_e.value||(C.value=!0)}function Qe(He){_e.value||(d.value&&(He.preventDefault(),He.stopPropagation()),C.value=!C.value)}function qe(He){var Fe,Ge,ft;if(e.readonly||Pe!=null&&Pe.isReadonly.value)return;const xe=c.value.selectionStart,Ke=Z.value.length;if((k.value>-1||["Enter","ArrowDown","ArrowUp"].includes(He.key))&&He.preventDefault(),["Enter","ArrowDown"].includes(He.key)&&(C.value=!0),["Escape"].includes(He.key)&&(C.value=!1),["Enter","Escape","Tab"].includes(He.key)&&(ke.value&&["Enter","Tab"].includes(He.key)&&Wt(Ue.value[0]),m.value=!0),He.key==="ArrowDown"&&ke.value&&((Fe=oe.value)==null||Fe.focus("next")),!!e.multiple){if(["Backspace","Delete"].includes(He.key)){if(k.value<0){He.key==="Backspace"&&!be.value&&(k.value=Ke-1);return}const X=k.value;ae.value&&Wt(ae.value),k.value=X>=Ke-1?Ke-2:X}if(He.key==="ArrowLeft"){if(k.value<0&&xe>0)return;const X=k.value>-1?k.value-1:Ke-1;Te.value[X]?k.value=X:(k.value=-1,c.value.setSelectionRange((Ge=be.value)==null?void 0:Ge.length,(ft=be.value)==null?void 0:ft.length))}if(He.key==="ArrowRight"){if(k.value<0)return;const X=k.value+1;Te.value[X]?k.value=X:(k.value=-1,c.value.setSelectionRange(0,0))}}}function je(He){var xe;He.key==="Tab"&&((xe=c.value)==null||xe.focus())}function Ze(He){be.value=He.target.value}function kt(){var He;d.value&&(m.value=!0,(He=c.value)==null||He.focus())}function Et(He){d.value=!0,setTimeout(()=>{l.value=!0})}function rt(He){l.value=!1}function At(He){(He==null||He===""&&!e.multiple)&&(ge.value=[])}const Pt=wn(!1);function Wt(He){if(e.multiple){const xe=Z.value.findIndex(Ke=>e.valueComparator(Ke,He.value));if(xe===-1)ge.value=[...ge.value,He];else{const Ke=[...ge.value];Ke.splice(xe,1),ge.value=Ke}}else ge.value=[He],Pt.value=!0,be.value=He.title,C.value=!1,m.value=!0,Er(()=>Pt.value=!1)}return Sn(d,(He,xe)=>{var Ke;He!==xe&&(He?(Pt.value=!0,be.value=e.multiple?"":String(((Ke=Te.value.at(-1))==null?void 0:Ke.props.title)??""),m.value=!0,Er(()=>Pt.value=!1)):(!e.multiple&&!be.value?ge.value=[]:ke.value&&!l.value&&!Te.value.some(Fe=>{let{value:Ge}=Fe;return Ge===V.value[0].value})&&Wt(V.value[0]),C.value=!1,be.value="",k.value=-1))}),Sn(be,He=>{!d.value||Pt.value||(He&&(C.value=!0),m.value=!He)}),Gn(()=>{const He=!!(e.chips||i.chip),xe=!!(!e.hideNoData||V.value.length||i["prepend-item"]||i["append-item"]||i["no-data"]),Ke=ge.value.length>0,[Fe]=Up.filterProps(e);return ue(Up,kn({ref:c},Fe,{modelValue:be.value,"onUpdate:modelValue":At,focused:d.value,"onUpdate:focused":Ge=>d.value=Ge,validationValue:ge.externalValue,dirty:Ke,onInput:Ze,class:["v-autocomplete",`v-autocomplete--${e.multiple?"multiple":"single"}`,{"v-autocomplete--active-menu":C.value,"v-autocomplete--chips":!!e.chips,"v-autocomplete--selection-slot":!!i.selection,"v-autocomplete--selecting-index":k.value>-1},e.class],style:e.style,readonly:e.readonly,placeholder:Ke?void 0:e.placeholder,"onClick:clear":Re,"onMousedown:control":nt,onKeydown:qe}),{...i,default:()=>ue(yn,null,[ue(IT,kn({ref:b,modelValue:C.value,"onUpdate:modelValue":Ge=>C.value=Ge,activator:"parent",contentClass:"v-autocomplete__content",disabled:_e.value,eager:e.eager,maxHeight:310,openOnClick:!1,closeOnContentClick:!1,transition:e.transition,onAfterLeave:kt},e.menuProps),{default:()=>[xe&&ue(xT,{ref:oe,selected:Z.value,selectStrategy:e.multiple?"independent":"single-independent",onMousedown:Ge=>Ge.preventDefault(),onKeydown:je,onFocusin:Et,onFocusout:rt,tabindex:"-1"},{default:()=>{var Ge,ft,X;return[(Ge=i["prepend-item"])==null?void 0:Ge.call(i),!V.value.length&&!e.hideNoData&&(((ft=i["no-data"])==null?void 0:ft.call(i))??ue(Qc,{title:a(e.noDataText)},null)),V.value.map((U,ye)=>{var De;const Le=kn(U.props,{key:ye,active:ke.value&&ye===0?!0:void 0,onClick:()=>Wt(U)});return((De=i.item)==null?void 0:De.call(i,{item:U,index:ye,props:Le}))??ue(Qc,Le,{prepend:Ve=>{let{isSelected:ht}=Ve;return ue(yn,null,[e.multiple&&!e.hideSelected?ue(QE,{key:U.value,modelValue:ht,ripple:!1,tabindex:"-1"},null):void 0,U.props.prependIcon&&ue(ds,{icon:U.props.prependIcon},null)])},title:()=>{var Ve,ht;return m.value?U.title:CO(U.title,(Ve=Oe(U))==null?void 0:Ve.title,((ht=be.value)==null?void 0:ht.length)??0)}})}),(X=i["append-item"])==null?void 0:X.call(i)]}})]}),Te.value.map((Ge,ft)=>{var ye;function X(Le){Le.stopPropagation(),Le.preventDefault(),Wt(Ge)}const U={"onClick:close":X,onMousedown(Le){Le.preventDefault(),Le.stopPropagation()},modelValue:!0,"onUpdate:modelValue":void 0};return ue("div",{key:Ge.value,class:["v-autocomplete__selection",ft===k.value&&["v-autocomplete__selection--selected",le.value]],style:ft===k.value?he.value:{}},[He?i.chip?ue(ma,{key:"chip-defaults",defaults:{VChip:{closable:e.closableChips,size:"small",text:Ge.title}}},{default:()=>{var Le;return[(Le=i.chip)==null?void 0:Le.call(i,{item:Ge,index:ft,props:U})]}}):ue(oT,kn({key:"chip",closable:e.closableChips,size:"small",text:Ge.title},U),null):((ye=i.selection)==null?void 0:ye.call(i,{item:Ge,index:ft}))??ue("span",{class:"v-autocomplete__selection-text"},[Ge.title,e.multiple&&ft<Te.value.length-1&&ue("span",{class:"v-autocomplete__selection-comma"},[Vo(",")])])])})]),"append-inner":function(){var U;for(var Ge=arguments.length,ft=new Array(Ge),X=0;X<Ge;X++)ft[X]=arguments[X];return ue(yn,null,[(U=i["append-inner"])==null?void 0:U.call(i,...ft),e.menuIcon?ue(ds,{class:"v-autocomplete__menu-icon",icon:e.menuIcon,onMousedown:Qe,onClick:tR},null):void 0])}})}),Sm({isFocused:d,isPristine:m,menu:C,search:be,filteredItems:Ue,select:Wt},c)}}),AO={class:"AutocompleteFilter"};function PO(e,t,i,a,c,d){return un(),mn("div",AO,[Bt("label",null,ji(e.label),1),ue(kO,{modelValue:e.selected,"onUpdate:modelValue":t[0]||(t[0]=m=>e.selected=m),items:e.data,"item-value":"value","item-title":"label",id:"autocomplete",rounded:"xl",placeholder:"Sélectionner...",variant:"outlined",multiple:"","return-object":""},null,8,["modelValue","items"])])}const RO=Vr(Ka,[["render",PO]]);var MO=Object.defineProperty,DO=Object.getOwnPropertyDescriptor,LO=(e,t,i,a)=>{for(var c=a>1?void 0:a?DO(t,i):t,d=e.length-1,m;d>=0;d--)(m=e[d])&&(c=(a?m(t,i,c):m(c))||c);return a&&c&&MO(t,i,c),c};let sy=class extends $r{get isShown(){return xi().isFiltersBarShown}get filterStore(){return Yn()}get countriesData(){return Yn().countries.map(t=>({label:t,value:t}))}get thematicsData(){return Yn().thematics.map(t=>({label:t.label,value:t.value}))}get resetTrigger(){return Yn().resetTrigger}resetFilters(){Yn().countriesFilter=[],Yn().thematicsFilter=[],Yn().resetTrigger=!this.resetTrigger,Yn().search=""}updateCountries(t){Yn().countriesFilter=t}updateThematics(t){Yn().thematicsFilter=t}};sy=LO([Ur({components:{AutocompleteFilter:RO,Button:Cd}})],sy);const zO=["shown"],OO={class:"FiltersBar__filtersCtn"};function BO(e,t,i,a,c,d){const m=cr("Button"),l=cr("AutocompleteFilter");return e.isShown?(un(),mn("div",{key:0,class:"FiltersBar",shown:e.isShown},[ue(m,{label:"Réinitialiser",uppercase:"true",small:"true",class:"FiltersBar__resetBtn",onClick:e.resetFilters},null,8,["onClick"]),Bt("div",OO,[ue(l,{label:"Pays",reset:e.resetTrigger,data:e.countriesData,onOnSelected:t[0]||(t[0]=b=>e.updateCountries(b.map(w=>w.value)))},null,8,["reset","data"]),ue(l,{label:"Thématique",reset:e.resetTrigger,data:e.thematicsData,onOnSelected:t[1]||(t[1]=b=>e.updateThematics(b.map(w=>w.value)))},null,8,["reset","data"])])],8,zO)):or("",!0)}const FO=Vr(sy,[["render",BO]]);var NO=Object.defineProperty,UO=Object.getOwnPropertyDescriptor,RT=(e,t,i,a)=>{for(var c=a>1?void 0:a?UO(t,i):t,d=e.length-1,m;d>=0;d--)(m=e[d])&&(c=(a?m(t,i,c):m(c))||c);return a&&c&&NO(t,i,c),c};let $p=class extends $r{constructor(){super(...arguments);Qn(this,"downloadReport")}};RT([ts({default:"Button label"})],$p.prototype,"downloadReport",2);$p=RT([Ur({})],$p);const $O=["href"],VO={class:"DownloadReportItem__name"},jO=["src"];function GO(e,t,i,a,c,d){return un(),mn("a",{class:"DownloadReportItem",href:"./reports/"+e.downloadReport.filename,download:""},[Bt("h3",VO,ji(e.downloadReport.name),1),Bt("img",{src:"./img/icons/mdi-download-circle-outline-grey.svg",alt:"Download icon"},null,8,jO)],8,$O)}const qO=Vr($p,[["render",GO]]);var HO=Object.defineProperty,ZO=Object.getOwnPropertyDescriptor,WO=(e,t,i,a)=>{for(var c=a>1?void 0:a?ZO(t,i):t,d=e.length-1,m;d>=0;d--)(m=e[d])&&(c=(a?m(t,i,c):m(c))||c);return a&&c&&HO(t,i,c),c};let ay=class extends $r{constructor(){super(...arguments);Qn(this,"actors",[{category:"Coordination du projet",partners:[{name:"FORIM",logo:"forim.png",link:"https://forim.net/"}]},{category:"Comité de pilotage du projet",partners:[{name:"GRDR",logo:"grdr.svg",link:"https://grdr.org/"},{name:"LOUJNA",logo:"loujna.png",link:"http://loujna-tounkaranke.org/"}]},{category:"Financé par",partners:[{name:"AFD",logo:"afd.svg",link:"https://www.afd.fr/"},{name:"Expertise France",logo:"expertise_france.svg",link:"https://www.expertisefrance.fr/"}]}])}get isAboutModalShown(){return xi().isAboutModalShown}get isDownloadShown(){return xi().isDownloadShown}get downloadReports(){return xi().downloadReports}close(){xi().isAboutModalShown=!1,setTimeout(()=>xi().isDownloadShown=!1,300)}toggleIsDownloadShown(){xi().isDownloadShown=!this.isDownloadShown}};ay=WO([Ur({components:{Button:Cd,DownloadReportItem:qO}})],ay);const YO=["open"],XO={class:"AboutModal__head"},KO={key:0,class:"AboutModal__content"},JO={class:"AboutModal__downloadsCtn"},QO={key:1,class:"AboutModal__content"},eB=Bt("div",{class:"AboutModal__ctn AboutModal__ctn--right"},[Bt("div",{class:"AboutModal__titles"},[Bt("h2",null,"Coopération régionale des politiques migratoires"),Bt("h3",null,"Composante 2 : Société civile :« Améliorer le dialogue entre OSC et pouvoirs publics pour des politiques migratoires justes et pertinentes en Afrique »")]),Bt("div",{class:"AboutModal__contentDesc"},[Bt("p",null,"Financé par l’AFD, Expertise France a lancé en juin 2020 le programme « Coopération Régionale des Politiques Migratoires » qui vise à renforcer le dialogue entre 7 pays africains sur les politiques nationales en matière de migration (Tunisie, Maroc, Sénégal, Mali, Côte d’Ivoire, Guinée et Cameroun)."),Bt("p",null,"La Composante 1 du programme, entend développer, via des points focaux dans les ministères en charge des enjeux migrations dans chaque pays, les capacités de suivi des autorités et l’élaboration de nouveaux indicateurs, ainsi que le partage de pratiques."),Bt("p",{class:"bold"},"La composante 2 du programme se concentre quant à elle sur les organisations de la société civile et ambitionne de créer et pérenniser des mécanismes de dialogue entre les OSC et les autorités nationales et régionales sur les politiques migratoires.")])],-1),tB={class:"AboutModal__ctn AboutModal__ctn--left"},nB={class:"AboutModal__partnersCtn"},iB=["href"],rB=["src","alt"],sB={class:"AboutModal__footer"};function aB(e,t,i,a,c,d){const m=cr("Button"),l=cr("DownloadReportItem");return un(),mn("dialog",{class:"AboutModal",open:e.isAboutModalShown},[Bt("div",XO,[Bt("h1",null,ji(e.isDownloadShown?"Téléchargements":"À propos du projet"),1),ue(m,{label:e.isDownloadShown?"À propos":"Téléchargements",uppercase:!0,icon:e.isDownloadShown?"mdi-information-variant-circle-outline":"mdi-download-circle-outline",onClick:t[0]||(t[0]=b=>e.toggleIsDownloadShown())},null,8,["label","icon"])]),e.isDownloadShown?(un(),mn("div",KO,[Bt("div",JO,[(un(!0),mn(yn,null,Wc(e.downloadReports,(b,w)=>(un(),dm(l,{downloadReport:b,key:w},null,8,["downloadReport"]))),128))])])):or("",!0),e.isDownloadShown?or("",!0):(un(),mn("div",QO,[eB,Bt("div",tB,[(un(!0),mn(yn,null,Wc(e.actors,(b,w)=>(un(),mn("div",{class:"AboutModal__actorsCtn",key:w},[Bt("h3",null,ji(b.category),1),Bt("div",nB,[(un(!0),mn(yn,null,Wc(b.partners,(C,k)=>(un(),mn("a",{href:C.link,target:"_blank",rel:"noopener noreferrer",key:k},[Bt("img",{src:"./img/logos/"+C.logo,alt:C.name+" logo",loading:"lazy"},null,8,rB)],8,iB))),128))])]))),128))])])),Bt("div",sB,[Bt("button",{onClick:t[1]||(t[1]=b=>e.close())},"Fermer")])],8,YO)}const oB=Vr(ay,[["render",aB]]);var lB=Object.defineProperty,cB=Object.getOwnPropertyDescriptor,uB=(e,t,i,a)=>{for(var c=a>1?void 0:a?cB(t,i):t,d=e.length-1,m;d>=0;d--)(m=e[d])&&(c=(a?m(t,i,c):m(c))||c);return a&&c&&lB(t,i,c),c};let oy=class extends $r{get isRedirectionModalShown(){return xi().isRedirectionModalShown}close(){xi().isRedirectionModalShown=!1}};oy=uB([Ur({components:{Button:Cd}})],oy);const hB=["open"],dB=Bt("div",{class:"Modal__head"},[Bt("h1",null,"Renseigner une association")],-1),fB=Bt("div",{class:"Modal__content"},[Bt("p",null,"Si vous souhaitez signaler une nouvelle association ou mettre à jour les informations affichées sur la carte, merci de remplir le questionnaire en ligne. Veillez à bien renseigner le numéro de téléphone et l’adresse électronique : nous vous recontacterons avant la mise en ligne des informations.")],-1),pB={class:"Modal__footer"},mB=Bt("a",{href:"https://ee.kobotoolbox.org/x/1a1GtPyH",target:"_blank"},"Accéder",-1);function gB(e,t,i,a,c,d){return un(),mn("dialog",{class:"Modal",open:e.isRedirectionModalShown},[dB,fB,Bt("div",pB,[Bt("button",{onClick:t[0]||(t[0]=m=>e.close())},"Annuler"),mB])],8,hB)}const _B=Vr(oy,[["render",gB]]);var MT={exports:{}};/* @license
Papa Parse
v5.4.1
https://github.com/mholt/PapaParse
License: MIT
*/(function(e,t){(function(i,a){e.exports=a()})(CE,function i(){var a=typeof self<"u"?self:typeof window<"u"?window:a!==void 0?a:{},c=!a.document&&!!a.postMessage,d=a.IS_PAPA_WORKER||!1,m={},l=0,b={parse:function(V,Z){var ae=(Z=Z||{}).dynamicTyping||!1;if(Te(ae)&&(Z.dynamicTypingFunction=ae,ae={}),Z.dynamicTyping=ae,Z.transform=!!Te(Z.transform)&&Z.transform,Z.worker&&b.WORKERS_SUPPORTED){var ke=function(){if(!b.WORKERS_SUPPORTED)return!1;var oe=(nt=a.URL||a.webkitURL||null,Qe=i.toString(),b.BLOB_URL||(b.BLOB_URL=nt.createObjectURL(new Blob(["var global = (function() { if (typeof self !== 'undefined') { return self; } if (typeof window !== 'undefined') { return window; } if (typeof global !== 'undefined') { return global; } return {}; })(); global.IS_PAPA_WORKER=true; ","(",Qe,")();"],{type:"text/javascript"})))),Re=new a.Worker(oe),nt,Qe;return Re.onmessage=be,Re.id=l++,m[Re.id]=Re}();return ke.userStep=Z.step,ke.userChunk=Z.chunk,ke.userComplete=Z.complete,ke.userError=Z.error,Z.step=Te(Z.step),Z.chunk=Te(Z.chunk),Z.complete=Te(Z.complete),Z.error=Te(Z.error),delete Z.worker,void ke.postMessage({input:V,config:Z,workerId:ke.id})}var _e=null;return b.NODE_STREAM_INPUT,typeof V=="string"?(V=function(oe){return oe.charCodeAt(0)===65279?oe.slice(1):oe}(V),_e=Z.download?new k(Z):new O(Z)):V.readable===!0&&Te(V.read)&&Te(V.on)?_e=new j(Z):(a.File&&V instanceof File||V instanceof Object)&&(_e=new M(Z)),_e.stream(V)},unparse:function(V,Z){var ae=!1,ke=!0,_e=",",oe=`\r
`,Re='"',nt=Re+Re,Qe=!1,qe=null,je=!1;(function(){if(typeof Z=="object"){if(typeof Z.delimiter!="string"||b.BAD_DELIMITERS.filter(function(rt){return Z.delimiter.indexOf(rt)!==-1}).length||(_e=Z.delimiter),(typeof Z.quotes=="boolean"||typeof Z.quotes=="function"||Array.isArray(Z.quotes))&&(ae=Z.quotes),typeof Z.skipEmptyLines!="boolean"&&typeof Z.skipEmptyLines!="string"||(Qe=Z.skipEmptyLines),typeof Z.newline=="string"&&(oe=Z.newline),typeof Z.quoteChar=="string"&&(Re=Z.quoteChar),typeof Z.header=="boolean"&&(ke=Z.header),Array.isArray(Z.columns)){if(Z.columns.length===0)throw new Error("Option columns is empty");qe=Z.columns}Z.escapeChar!==void 0&&(nt=Z.escapeChar+Re),(typeof Z.escapeFormulae=="boolean"||Z.escapeFormulae instanceof RegExp)&&(je=Z.escapeFormulae instanceof RegExp?Z.escapeFormulae:/^[=+\-@\t\r].*$/)}})();var Ze=new RegExp(le(Re),"g");if(typeof V=="string"&&(V=JSON.parse(V)),Array.isArray(V)){if(!V.length||Array.isArray(V[0]))return kt(null,V,Qe);if(typeof V[0]=="object")return kt(qe||Object.keys(V[0]),V,Qe)}else if(typeof V=="object")return typeof V.data=="string"&&(V.data=JSON.parse(V.data)),Array.isArray(V.data)&&(V.fields||(V.fields=V.meta&&V.meta.fields||qe),V.fields||(V.fields=Array.isArray(V.data[0])?V.fields:typeof V.data[0]=="object"?Object.keys(V.data[0]):[]),Array.isArray(V.data[0])||typeof V.data[0]=="object"||(V.data=[V.data])),kt(V.fields||[],V.data||[],Qe);throw new Error("Unable to serialize unrecognized input");function kt(rt,At,Pt){var Wt="";typeof rt=="string"&&(rt=JSON.parse(rt)),typeof At=="string"&&(At=JSON.parse(At));var He=Array.isArray(rt)&&0<rt.length,xe=!Array.isArray(At[0]);if(He&&ke){for(var Ke=0;Ke<rt.length;Ke++)0<Ke&&(Wt+=_e),Wt+=Et(rt[Ke],Ke);0<At.length&&(Wt+=oe)}for(var Fe=0;Fe<At.length;Fe++){var Ge=He?rt.length:At[Fe].length,ft=!1,X=He?Object.keys(At[Fe]).length===0:At[Fe].length===0;if(Pt&&!He&&(ft=Pt==="greedy"?At[Fe].join("").trim()==="":At[Fe].length===1&&At[Fe][0].length===0),Pt==="greedy"&&He){for(var U=[],ye=0;ye<Ge;ye++){var Le=xe?rt[ye]:ye;U.push(At[Fe][Le])}ft=U.join("").trim()===""}if(!ft){for(var De=0;De<Ge;De++){0<De&&!X&&(Wt+=_e);var Ve=He&&xe?rt[De]:De;Wt+=Et(At[Fe][Ve],De)}Fe<At.length-1&&(!Pt||0<Ge&&!X)&&(Wt+=oe)}}return Wt}function Et(rt,At){if(rt==null)return"";if(rt.constructor===Date)return JSON.stringify(rt).slice(1,25);var Pt=!1;je&&typeof rt=="string"&&je.test(rt)&&(rt="'"+rt,Pt=!0);var Wt=rt.toString().replace(Ze,nt);return(Pt=Pt||ae===!0||typeof ae=="function"&&ae(rt,At)||Array.isArray(ae)&&ae[At]||function(He,xe){for(var Ke=0;Ke<xe.length;Ke++)if(-1<He.indexOf(xe[Ke]))return!0;return!1}(Wt,b.BAD_DELIMITERS)||-1<Wt.indexOf(_e)||Wt.charAt(0)===" "||Wt.charAt(Wt.length-1)===" ")?Re+Wt+Re:Wt}}};if(b.RECORD_SEP=String.fromCharCode(30),b.UNIT_SEP=String.fromCharCode(31),b.BYTE_ORDER_MARK="\uFEFF",b.BAD_DELIMITERS=["\r",`
`,'"',b.BYTE_ORDER_MARK],b.WORKERS_SUPPORTED=!c&&!!a.Worker,b.NODE_STREAM_INPUT=1,b.LocalChunkSize=10485760,b.RemoteChunkSize=5242880,b.DefaultDelimiter=",",b.Parser=he,b.ParserHandle=W,b.NetworkStreamer=k,b.FileStreamer=M,b.StringStreamer=O,b.ReadableStreamStreamer=j,a.jQuery){var w=a.jQuery;w.fn.parse=function(V){var Z=V.config||{},ae=[];return this.each(function(oe){if(!(w(this).prop("tagName").toUpperCase()==="INPUT"&&w(this).attr("type").toLowerCase()==="file"&&a.FileReader)||!this.files||this.files.length===0)return!0;for(var Re=0;Re<this.files.length;Re++)ae.push({file:this.files[Re],inputElem:this,instanceConfig:w.extend({},Z)})}),ke(),this;function ke(){if(ae.length!==0){var oe,Re,nt,Qe,qe=ae[0];if(Te(V.before)){var je=V.before(qe.file,qe.inputElem);if(typeof je=="object"){if(je.action==="abort")return oe="AbortError",Re=qe.file,nt=qe.inputElem,Qe=je.reason,void(Te(V.error)&&V.error({name:oe},Re,nt,Qe));if(je.action==="skip")return void _e();typeof je.config=="object"&&(qe.instanceConfig=w.extend(qe.instanceConfig,je.config))}else if(je==="skip")return void _e()}var Ze=qe.instanceConfig.complete;qe.instanceConfig.complete=function(kt){Te(Ze)&&Ze(kt,qe.file,qe.inputElem),_e()},b.parse(qe.file,qe.instanceConfig)}else Te(V.complete)&&V.complete()}function _e(){ae.splice(0,1),ke()}}}function C(V){this._handle=null,this._finished=!1,this._completed=!1,this._halted=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},function(Z){var ae=Ue(Z);ae.chunkSize=parseInt(ae.chunkSize),Z.step||Z.chunk||(ae.chunkSize=null),this._handle=new W(ae),(this._handle.streamer=this)._config=ae}.call(this,V),this.parseChunk=function(Z,ae){if(this.isFirstChunk&&Te(this._config.beforeFirstChunk)){var ke=this._config.beforeFirstChunk(Z);ke!==void 0&&(Z=ke)}this.isFirstChunk=!1,this._halted=!1;var _e=this._partialLine+Z;this._partialLine="";var oe=this._handle.parse(_e,this._baseIndex,!this._finished);if(!this._handle.paused()&&!this._handle.aborted()){var Re=oe.meta.cursor;this._finished||(this._partialLine=_e.substring(Re-this._baseIndex),this._baseIndex=Re),oe&&oe.data&&(this._rowCount+=oe.data.length);var nt=this._finished||this._config.preview&&this._rowCount>=this._config.preview;if(d)a.postMessage({results:oe,workerId:b.WORKER_ID,finished:nt});else if(Te(this._config.chunk)&&!ae){if(this._config.chunk(oe,this._handle),this._handle.paused()||this._handle.aborted())return void(this._halted=!0);oe=void 0,this._completeResults=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(oe.data),this._completeResults.errors=this._completeResults.errors.concat(oe.errors),this._completeResults.meta=oe.meta),this._completed||!nt||!Te(this._config.complete)||oe&&oe.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),nt||oe&&oe.meta.paused||this._nextChunk(),oe}this._halted=!0},this._sendError=function(Z){Te(this._config.error)?this._config.error(Z):d&&this._config.error&&a.postMessage({workerId:b.WORKER_ID,error:Z,finished:!1})}}function k(V){var Z;(V=V||{}).chunkSize||(V.chunkSize=b.RemoteChunkSize),C.call(this,V),this._nextChunk=c?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(ae){this._input=ae,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(Z=new XMLHttpRequest,this._config.withCredentials&&(Z.withCredentials=this._config.withCredentials),c||(Z.onload=Oe(this._chunkLoaded,this),Z.onerror=Oe(this._chunkError,this)),Z.open(this._config.downloadRequestBody?"POST":"GET",this._input,!c),this._config.downloadRequestHeaders){var ae=this._config.downloadRequestHeaders;for(var ke in ae)Z.setRequestHeader(ke,ae[ke])}if(this._config.chunkSize){var _e=this._start+this._config.chunkSize-1;Z.setRequestHeader("Range","bytes="+this._start+"-"+_e)}try{Z.send(this._config.downloadRequestBody)}catch(oe){this._chunkError(oe.message)}c&&Z.status===0&&this._chunkError()}},this._chunkLoaded=function(){Z.readyState===4&&(Z.status<200||400<=Z.status?this._chunkError():(this._start+=this._config.chunkSize?this._config.chunkSize:Z.responseText.length,this._finished=!this._config.chunkSize||this._start>=function(ae){var ke=ae.getResponseHeader("Content-Range");return ke===null?-1:parseInt(ke.substring(ke.lastIndexOf("/")+1))}(Z),this.parseChunk(Z.responseText)))},this._chunkError=function(ae){var ke=Z.statusText||ae;this._sendError(new Error(ke))}}function M(V){var Z,ae;(V=V||{}).chunkSize||(V.chunkSize=b.LocalChunkSize),C.call(this,V);var ke=typeof FileReader<"u";this.stream=function(_e){this._input=_e,ae=_e.slice||_e.webkitSlice||_e.mozSlice,ke?((Z=new FileReader).onload=Oe(this._chunkLoaded,this),Z.onerror=Oe(this._chunkError,this)):Z=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var _e=this._input;if(this._config.chunkSize){var oe=Math.min(this._start+this._config.chunkSize,this._input.size);_e=ae.call(_e,this._start,oe)}var Re=Z.readAsText(_e,this._config.encoding);ke||this._chunkLoaded({target:{result:Re}})},this._chunkLoaded=function(_e){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(_e.target.result)},this._chunkError=function(){this._sendError(Z.error)}}function O(V){var Z;C.call(this,V=V||{}),this.stream=function(ae){return Z=ae,this._nextChunk()},this._nextChunk=function(){if(!this._finished){var ae,ke=this._config.chunkSize;return ke?(ae=Z.substring(0,ke),Z=Z.substring(ke)):(ae=Z,Z=""),this._finished=!Z,this.parseChunk(ae)}}}function j(V){C.call(this,V=V||{});var Z=[],ae=!0,ke=!1;this.pause=function(){C.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){C.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(_e){this._input=_e,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){ke&&Z.length===1&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),Z.length?this.parseChunk(Z.shift()):ae=!0},this._streamData=Oe(function(_e){try{Z.push(typeof _e=="string"?_e:_e.toString(this._config.encoding)),ae&&(ae=!1,this._checkIsFinished(),this.parseChunk(Z.shift()))}catch(oe){this._streamError(oe)}},this),this._streamError=Oe(function(_e){this._streamCleanUp(),this._sendError(_e)},this),this._streamEnd=Oe(function(){this._streamCleanUp(),ke=!0,this._streamData("")},this),this._streamCleanUp=Oe(function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)},this)}function W(V){var Z,ae,ke,_e=Math.pow(2,53),oe=-_e,Re=/^\s*-?(\d+\.?|\.\d+|\d+\.\d+)([eE][-+]?\d+)?\s*$/,nt=/^((\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z)))$/,Qe=this,qe=0,je=0,Ze=!1,kt=!1,Et=[],rt={data:[],errors:[],meta:{}};if(Te(V.step)){var At=V.step;V.step=function(Fe){if(rt=Fe,He())Wt();else{if(Wt(),rt.data.length===0)return;qe+=Fe.data.length,V.preview&&qe>V.preview?ae.abort():(rt.data=rt.data[0],At(rt,Qe))}}}function Pt(Fe){return V.skipEmptyLines==="greedy"?Fe.join("").trim()==="":Fe.length===1&&Fe[0].length===0}function Wt(){return rt&&ke&&(Ke("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+b.DefaultDelimiter+"'"),ke=!1),V.skipEmptyLines&&(rt.data=rt.data.filter(function(Fe){return!Pt(Fe)})),He()&&function(){if(!rt)return;function Fe(ft,X){Te(V.transformHeader)&&(ft=V.transformHeader(ft,X)),Et.push(ft)}if(Array.isArray(rt.data[0])){for(var Ge=0;He()&&Ge<rt.data.length;Ge++)rt.data[Ge].forEach(Fe);rt.data.splice(0,1)}else rt.data.forEach(Fe)}(),function(){if(!rt||!V.header&&!V.dynamicTyping&&!V.transform)return rt;function Fe(ft,X){var U,ye=V.header?{}:[];for(U=0;U<ft.length;U++){var Le=U,De=ft[U];V.header&&(Le=U>=Et.length?"__parsed_extra":Et[U]),V.transform&&(De=V.transform(De,Le)),De=xe(Le,De),Le==="__parsed_extra"?(ye[Le]=ye[Le]||[],ye[Le].push(De)):ye[Le]=De}return V.header&&(U>Et.length?Ke("FieldMismatch","TooManyFields","Too many fields: expected "+Et.length+" fields but parsed "+U,je+X):U<Et.length&&Ke("FieldMismatch","TooFewFields","Too few fields: expected "+Et.length+" fields but parsed "+U,je+X)),ye}var Ge=1;return!rt.data.length||Array.isArray(rt.data[0])?(rt.data=rt.data.map(Fe),Ge=rt.data.length):rt.data=Fe(rt.data,0),V.header&&rt.meta&&(rt.meta.fields=Et),je+=Ge,rt}()}function He(){return V.header&&Et.length===0}function xe(Fe,Ge){return ft=Fe,V.dynamicTypingFunction&&V.dynamicTyping[ft]===void 0&&(V.dynamicTyping[ft]=V.dynamicTypingFunction(ft)),(V.dynamicTyping[ft]||V.dynamicTyping)===!0?Ge==="true"||Ge==="TRUE"||Ge!=="false"&&Ge!=="FALSE"&&(function(X){if(Re.test(X)){var U=parseFloat(X);if(oe<U&&U<_e)return!0}return!1}(Ge)?parseFloat(Ge):nt.test(Ge)?new Date(Ge):Ge===""?null:Ge):Ge;var ft}function Ke(Fe,Ge,ft,X){var U={type:Fe,code:Ge,message:ft};X!==void 0&&(U.row=X),rt.errors.push(U)}this.parse=function(Fe,Ge,ft){var X=V.quoteChar||'"';if(V.newline||(V.newline=function(Le,De){Le=Le.substring(0,1048576);var Ve=new RegExp(le(De)+"([^]*?)"+le(De),"gm"),ht=(Le=Le.replace(Ve,"")).split("\r"),ct=Le.split(`
`),pt=1<ct.length&&ct[0].length<ht[0].length;if(ht.length===1||pt)return`
`;for(var it=0,ut=0;ut<ht.length;ut++)ht[ut][0]===`
`&&it++;return it>=ht.length/2?`\r
`:"\r"}(Fe,X)),ke=!1,V.delimiter)Te(V.delimiter)&&(V.delimiter=V.delimiter(Fe),rt.meta.delimiter=V.delimiter);else{var U=function(Le,De,Ve,ht,ct){var pt,it,ut,yt;ct=ct||[",","	","|",";",b.RECORD_SEP,b.UNIT_SEP];for(var Lt=0;Lt<ct.length;Lt++){var Be=ct[Lt],jt=0,Xt=0,tn=0;ut=void 0;for(var fn=new he({comments:ht,delimiter:Be,newline:De,preview:10}).parse(Le),st=0;st<fn.data.length;st++)if(Ve&&Pt(fn.data[st]))tn++;else{var Ft=fn.data[st].length;Xt+=Ft,ut!==void 0?0<Ft&&(jt+=Math.abs(Ft-ut),ut=Ft):ut=Ft}0<fn.data.length&&(Xt/=fn.data.length-tn),(it===void 0||jt<=it)&&(yt===void 0||yt<Xt)&&1.99<Xt&&(it=jt,pt=Be,yt=Xt)}return{successful:!!(V.delimiter=pt),bestDelimiter:pt}}(Fe,V.newline,V.skipEmptyLines,V.comments,V.delimitersToGuess);U.successful?V.delimiter=U.bestDelimiter:(ke=!0,V.delimiter=b.DefaultDelimiter),rt.meta.delimiter=V.delimiter}var ye=Ue(V);return V.preview&&V.header&&ye.preview++,Z=Fe,ae=new he(ye),rt=ae.parse(Z,Ge,ft),Wt(),Ze?{meta:{paused:!0}}:rt||{meta:{paused:!1}}},this.paused=function(){return Ze},this.pause=function(){Ze=!0,ae.abort(),Z=Te(V.chunk)?"":Z.substring(ae.getCharIndex())},this.resume=function(){Qe.streamer._halted?(Ze=!1,Qe.streamer.parseChunk(Z,!0)):setTimeout(Qe.resume,3)},this.aborted=function(){return kt},this.abort=function(){kt=!0,ae.abort(),rt.meta.aborted=!0,Te(V.complete)&&V.complete(rt),Z=""}}function le(V){return V.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function he(V){var Z,ae=(V=V||{}).delimiter,ke=V.newline,_e=V.comments,oe=V.step,Re=V.preview,nt=V.fastMode,Qe=Z=V.quoteChar===void 0||V.quoteChar===null?'"':V.quoteChar;if(V.escapeChar!==void 0&&(Qe=V.escapeChar),(typeof ae!="string"||-1<b.BAD_DELIMITERS.indexOf(ae))&&(ae=","),_e===ae)throw new Error("Comment character same as delimiter");_e===!0?_e="#":(typeof _e!="string"||-1<b.BAD_DELIMITERS.indexOf(_e))&&(_e=!1),ke!==`
`&&ke!=="\r"&&ke!==`\r
`&&(ke=`
`);var qe=0,je=!1;this.parse=function(Ze,kt,Et){if(typeof Ze!="string")throw new Error("Input must be a string");var rt=Ze.length,At=ae.length,Pt=ke.length,Wt=_e.length,He=Te(oe),xe=[],Ke=[],Fe=[],Ge=qe=0;if(!Ze)return Nt();if(V.header&&!kt){var ft=Ze.split(ke)[0].split(ae),X=[],U={},ye=!1;for(var Le in ft){var De=ft[Le];Te(V.transformHeader)&&(De=V.transformHeader(De,Le));var Ve=De,ht=U[De]||0;for(0<ht&&(ye=!0,Ve=De+"_"+ht),U[De]=ht+1;X.includes(Ve);)Ve=Ve+"_"+ht;X.push(Ve)}if(ye){var ct=Ze.split(ke);ct[0]=X.join(ae),Ze=ct.join(ke)}}if(nt||nt!==!1&&Ze.indexOf(Z)===-1){for(var pt=Ze.split(ke),it=0;it<pt.length;it++){if(Fe=pt[it],qe+=Fe.length,it!==pt.length-1)qe+=ke.length;else if(Et)return Nt();if(!_e||Fe.substring(0,Wt)!==_e){if(He){if(xe=[],tn(Fe.split(ae)),On(),je)return Nt()}else tn(Fe.split(ae));if(Re&&Re<=it)return xe=xe.slice(0,Re),Nt(!0)}}return Nt()}for(var ut=Ze.indexOf(ae,qe),yt=Ze.indexOf(ke,qe),Lt=new RegExp(le(Qe)+le(Z),"g"),Be=Ze.indexOf(Z,qe);;)if(Ze[qe]!==Z)if(_e&&Fe.length===0&&Ze.substring(qe,qe+Wt)===_e){if(yt===-1)return Nt();qe=yt+Pt,yt=Ze.indexOf(ke,qe),ut=Ze.indexOf(ae,qe)}else if(ut!==-1&&(ut<yt||yt===-1))Fe.push(Ze.substring(qe,ut)),qe=ut+At,ut=Ze.indexOf(ae,qe);else{if(yt===-1)break;if(Fe.push(Ze.substring(qe,yt)),Ft(yt+Pt),He&&(On(),je))return Nt();if(Re&&xe.length>=Re)return Nt(!0)}else for(Be=qe,qe++;;){if((Be=Ze.indexOf(Z,Be+1))===-1)return Et||Ke.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:xe.length,index:qe}),st();if(Be===rt-1)return st(Ze.substring(qe,Be).replace(Lt,Z));if(Z!==Qe||Ze[Be+1]!==Qe){if(Z===Qe||Be===0||Ze[Be-1]!==Qe){ut!==-1&&ut<Be+1&&(ut=Ze.indexOf(ae,Be+1)),yt!==-1&&yt<Be+1&&(yt=Ze.indexOf(ke,Be+1));var jt=fn(yt===-1?ut:Math.min(ut,yt));if(Ze.substr(Be+1+jt,At)===ae){Fe.push(Ze.substring(qe,Be).replace(Lt,Z)),Ze[qe=Be+1+jt+At]!==Z&&(Be=Ze.indexOf(Z,qe)),ut=Ze.indexOf(ae,qe),yt=Ze.indexOf(ke,qe);break}var Xt=fn(yt);if(Ze.substring(Be+1+Xt,Be+1+Xt+Pt)===ke){if(Fe.push(Ze.substring(qe,Be).replace(Lt,Z)),Ft(Be+1+Xt+Pt),ut=Ze.indexOf(ae,qe),Be=Ze.indexOf(Z,qe),He&&(On(),je))return Nt();if(Re&&xe.length>=Re)return Nt(!0);break}Ke.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:xe.length,index:qe}),Be++}}else Be++}return st();function tn(qn){xe.push(qn),Ge=qe}function fn(qn){var It=0;if(qn!==-1){var Hn=Ze.substring(Be+1,qn);Hn&&Hn.trim()===""&&(It=Hn.length)}return It}function st(qn){return Et||(qn===void 0&&(qn=Ze.substring(qe)),Fe.push(qn),qe=rt,tn(Fe),He&&On()),Nt()}function Ft(qn){qe=qn,tn(Fe),Fe=[],yt=Ze.indexOf(ke,qe)}function Nt(qn){return{data:xe,errors:Ke,meta:{delimiter:ae,linebreak:ke,aborted:je,truncated:!!qn,cursor:Ge+(kt||0)}}}function On(){oe(Nt()),xe=[],Ke=[]}},this.abort=function(){je=!0},this.getCharIndex=function(){return qe}}function be(V){var Z=V.data,ae=m[Z.workerId],ke=!1;if(Z.error)ae.userError(Z.error,Z.file);else if(Z.results&&Z.results.data){var _e={abort:function(){ke=!0,ge(Z.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:Pe,resume:Pe};if(Te(ae.userStep)){for(var oe=0;oe<Z.results.data.length&&(ae.userStep({data:Z.results.data[oe],errors:Z.results.errors,meta:Z.results.meta},_e),!ke);oe++);delete Z.results}else Te(ae.userChunk)&&(ae.userChunk(Z.results,_e,Z.file),delete Z.results)}Z.finished&&!ke&&ge(Z.workerId,Z.results)}function ge(V,Z){var ae=m[V];Te(ae.userComplete)&&ae.userComplete(Z),ae.terminate(),delete m[V]}function Pe(){throw new Error("Not implemented.")}function Ue(V){if(typeof V!="object"||V===null)return V;var Z=Array.isArray(V)?[]:{};for(var ae in V)Z[ae]=Ue(V[ae]);return Z}function Oe(V,Z){return function(){V.apply(Z,arguments)}}function Te(V){return typeof V=="function"}return d&&(a.onmessage=function(V){var Z=V.data;if(b.WORKER_ID===void 0&&Z&&(b.WORKER_ID=Z.workerId),typeof Z.input=="string")a.postMessage({workerId:b.WORKER_ID,results:b.parse(Z.input,Z.config),finished:!0});else if(a.File&&Z.input instanceof File||Z.input instanceof Object){var ae=b.parse(Z.input,Z.config);ae&&a.postMessage({workerId:b.WORKER_ID,results:ae,finished:!0})}}),(k.prototype=Object.create(C.prototype)).constructor=k,(M.prototype=Object.create(C.prototype)).constructor=M,(O.prototype=Object.create(O.prototype)).constructor=O,(j.prototype=Object.create(C.prototype)).constructor=j,b})})(MT);var yB=MT.exports;class DT{static async parseFile(t){return new Promise((i,a)=>{yB.parse(t,{header:!0,delimiter:",",download:!0,skipEmptyLines:!0,complete(c){i(c.data)},error(c){a(c)}})})}static async readAssociationDb(){return(await this.parseFile(this.associationDbFileName)).map((i,a)=>{let c=Yn().thematics.map(d=>i[d.value]==="x"?d.value:null);return{id:a,updatedAt:i.maj??null,country:i.pays??null,coords:{x:parseFloat(i.coordo_x.replace(",","."))??null,y:parseFloat(i.coordo_y.replace(",","."))??null},name:i.nom??null,adress:i.adresse??null,indic:i.indic??null,tel:i.numero??null,telOther:i.autre_numero??null,emails:i.email.split(";").map(d=>d.trim())??[],websiteUrl:i.internet??null,status:i.statut??null,year:i.annee??null,budget:i.budget??null,dialog:i.dialogue??null,intervention:i.intervention??null,thematics:c.filter(d=>d!=null)}})}}Qn(DT,"associationDbFileName","https://docs.google.com/spreadsheets/d/e/2PACX-1vSvwjGskDe6C81X_mESVjkXUHQCzDWcYE-dsUXADsmOf8xbS7zg_fZn-xoztj4-3g/pub?gid=766950911&single=true&output=csv");var vB=Object.defineProperty,xB=Object.getOwnPropertyDescriptor,bB=(e,t,i,a)=>{for(var c=a>1?void 0:a?xB(t,i):t,d=e.length-1,m;d>=0;d--)(m=e[d])&&(c=(a?m(t,i,c):m(c))||c);return a&&c&&vB(t,i,c),c};let ly=class extends $r{async mounted(){const t=await DT.readAssociationDb();Ni().associations=t,Yn().countries=[...new Set(t.map(i=>i.country))].sort()}};ly=bB([Ur({components:{OSCMap:YD,AssociationBar:XL,FiltersBar:FO,AboutModal:oB,RedirectionConfirmModal:_B}})],ly);const wB=$t({...hi(),..._M({fullHeight:!0}),...es()},"VApp"),SB=En()({name:"VApp",props:wB(),setup(e,t){let{slots:i}=t;const a=Cs(e),{layoutClasses:c,layoutStyles:d,getLayoutItem:m,items:l,layoutRef:b}=vM(e),{rtlClasses:w}=yu();return Gn(()=>{var C;return ue("div",{ref:b,class:["v-application",a.themeClasses.value,c.value,w.value,e.class],style:[d.value,e.style]},[ue("div",{class:"v-application__wrap"},[(C=i.default)==null?void 0:C.call(i)])])}),{getLayoutItem:m,items:l,theme:a}}}),EB=Bt("h1",{class:"App__title"},[Vo("Cartographie des "),Bt("b",null,[Bt("span",{class:"hide-sm"},"Organisations de la Société Civile ("),Vo("OSC"),Bt("span",{class:"hide-sm"},")"),Vo(" africaines actives sur les enjeux migratoires")])],-1),TB={class:"App__content"},CB={class:"App__ctn App__ctn--right"};function IB(e,t,i,a,c,d){const m=cr("AssociationBar"),l=cr("FiltersBar"),b=cr("OSCMap"),w=cr("AboutModal"),C=cr("RedirectionConfirmModal");return un(),dm(SB,{class:"App"},{default:SS(()=>[EB,Bt("div",TB,[ue(m,{class:"App__ctn App__ctn--left"}),Bt("div",CB,[ue(l),ue(b)]),ue(w),ue(C)])]),_:1})}const kB=Vr(ly,[["render",IB]]);/*!
  * vue-router v4.2.2
  * (c) 2023 Eduardo San Martin Morote
  * @license MIT
  */const Uc=typeof window<"u";function AB(e){return e.__esModule||e[Symbol.toStringTag]==="Module"}const Un=Object.assign;function f_(e,t){const i={};for(const a in t){const c=t[a];i[a]=qs(c)?c.map(e):e(c)}return i}const Uh=()=>{},qs=Array.isArray,PB=/\/$/,RB=e=>e.replace(PB,"");function p_(e,t,i="/"){let a,c={},d="",m="";const l=t.indexOf("#");let b=t.indexOf("?");return l<b&&l>=0&&(b=-1),b>-1&&(a=t.slice(0,b),d=t.slice(b+1,l>-1?l:t.length),c=e(d)),l>-1&&(a=a||t.slice(0,l),m=t.slice(l,t.length)),a=zB(a??t,i),{fullPath:a+(d&&"?")+d+m,path:a,query:c,hash:m}}function MB(e,t){const i=t.query?e(t.query):"";return t.path+(i&&"?")+i+(t.hash||"")}function I1(e,t){return!t||!e.toLowerCase().startsWith(t.toLowerCase())?e:e.slice(t.length)||"/"}function DB(e,t,i){const a=t.matched.length-1,c=i.matched.length-1;return a>-1&&a===c&&eu(t.matched[a],i.matched[c])&&LT(t.params,i.params)&&e(t.query)===e(i.query)&&t.hash===i.hash}function eu(e,t){return(e.aliasOf||e)===(t.aliasOf||t)}function LT(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const i in e)if(!LB(e[i],t[i]))return!1;return!0}function LB(e,t){return qs(e)?k1(e,t):qs(t)?k1(t,e):e===t}function k1(e,t){return qs(t)?e.length===t.length&&e.every((i,a)=>i===t[a]):e.length===1&&e[0]===t}function zB(e,t){if(e.startsWith("/"))return e;if(!e)return t;const i=t.split("/"),a=e.split("/"),c=a[a.length-1];(c===".."||c===".")&&a.push("");let d=i.length-1,m,l;for(m=0;m<a.length;m++)if(l=a[m],l!==".")if(l==="..")d>1&&d--;else break;return i.slice(0,d).join("/")+"/"+a.slice(m-(m===a.length?1:0)).join("/")}var hd;(function(e){e.pop="pop",e.push="push"})(hd||(hd={}));var $h;(function(e){e.back="back",e.forward="forward",e.unknown=""})($h||($h={}));function OB(e){if(!e)if(Uc){const t=document.querySelector("base");e=t&&t.getAttribute("href")||"/",e=e.replace(/^\w+:\/\/[^\/]+/,"")}else e="/";return e[0]!=="/"&&e[0]!=="#"&&(e="/"+e),RB(e)}const BB=/^[^#]+#/;function FB(e,t){return e.replace(BB,"#")+t}function NB(e,t){const i=document.documentElement.getBoundingClientRect(),a=e.getBoundingClientRect();return{behavior:t.behavior,left:a.left-i.left-(t.left||0),top:a.top-i.top-(t.top||0)}}const Em=()=>({left:window.pageXOffset,top:window.pageYOffset});function UB(e){let t;if("el"in e){const i=e.el,a=typeof i=="string"&&i.startsWith("#"),c=typeof i=="string"?a?document.getElementById(i.slice(1)):document.querySelector(i):i;if(!c)return;t=NB(c,e)}else t=e;"scrollBehavior"in document.documentElement.style?window.scrollTo(t):window.scrollTo(t.left!=null?t.left:window.pageXOffset,t.top!=null?t.top:window.pageYOffset)}function A1(e,t){return(history.state?history.state.position-t:-1)+e}const cy=new Map;function $B(e,t){cy.set(e,t)}function VB(e){const t=cy.get(e);return cy.delete(e),t}let jB=()=>location.protocol+"//"+location.host;function zT(e,t){const{pathname:i,search:a,hash:c}=t,d=e.indexOf("#");if(d>-1){let l=c.includes(e.slice(d))?e.slice(d).length:1,b=c.slice(l);return b[0]!=="/"&&(b="/"+b),I1(b,"")}return I1(i,e)+a+c}function GB(e,t,i,a){let c=[],d=[],m=null;const l=({state:M})=>{const O=zT(e,location),j=i.value,W=t.value;let le=0;if(M){if(i.value=O,t.value=M,m&&m===j){m=null;return}le=W?M.position-W.position:0}else a(O);c.forEach(he=>{he(i.value,j,{delta:le,type:hd.pop,direction:le?le>0?$h.forward:$h.back:$h.unknown})})};function b(){m=i.value}function w(M){c.push(M);const O=()=>{const j=c.indexOf(M);j>-1&&c.splice(j,1)};return d.push(O),O}function C(){const{history:M}=window;M.state&&M.replaceState(Un({},M.state,{scroll:Em()}),"")}function k(){for(const M of d)M();d=[],window.removeEventListener("popstate",l),window.removeEventListener("beforeunload",C)}return window.addEventListener("popstate",l),window.addEventListener("beforeunload",C,{passive:!0}),{pauseListeners:b,listen:w,destroy:k}}function P1(e,t,i,a=!1,c=!1){return{back:e,current:t,forward:i,replaced:a,position:window.history.length,scroll:c?Em():null}}function qB(e){const{history:t,location:i}=window,a={value:zT(e,i)},c={value:t.state};c.value||d(a.value,{back:null,current:a.value,forward:null,position:t.length-1,replaced:!0,scroll:null},!0);function d(b,w,C){const k=e.indexOf("#"),M=k>-1?(i.host&&document.querySelector("base")?e:e.slice(k))+b:jB()+e+b;try{t[C?"replaceState":"pushState"](w,"",M),c.value=w}catch(O){console.error(O),i[C?"replace":"assign"](M)}}function m(b,w){const C=Un({},t.state,P1(c.value.back,b,c.value.forward,!0),w,{position:c.value.position});d(b,C,!0),a.value=b}function l(b,w){const C=Un({},c.value,t.state,{forward:b,scroll:Em()});d(C.current,C,!0);const k=Un({},P1(a.value,b,null),{position:C.position+1},w);d(b,k,!1),a.value=b}return{location:a,state:c,push:l,replace:m}}function HB(e){e=OB(e);const t=qB(e),i=GB(e,t.state,t.location,t.replace);function a(d,m=!0){m||i.pauseListeners(),history.go(d)}const c=Un({location:"",base:e,go:a,createHref:FB.bind(null,e)},t,i);return Object.defineProperty(c,"location",{enumerable:!0,get:()=>t.location.value}),Object.defineProperty(c,"state",{enumerable:!0,get:()=>t.state.value}),c}function ZB(e){return typeof e=="string"||e&&typeof e=="object"}function OT(e){return typeof e=="string"||typeof e=="symbol"}const Io={path:"/",name:void 0,params:{},query:{},hash:"",fullPath:"/",matched:[],meta:{},redirectedFrom:void 0},BT=Symbol("");var R1;(function(e){e[e.aborted=4]="aborted",e[e.cancelled=8]="cancelled",e[e.duplicated=16]="duplicated"})(R1||(R1={}));function tu(e,t){return Un(new Error,{type:e,[BT]:!0},t)}function $a(e,t){return e instanceof Error&&BT in e&&(t==null||!!(e.type&t))}const M1="[^/]+?",WB={sensitive:!1,strict:!1,start:!0,end:!0},YB=/[.+*?^${}()[\]/\\]/g;function XB(e,t){const i=Un({},WB,t),a=[];let c=i.start?"^":"";const d=[];for(const w of e){const C=w.length?[]:[90];i.strict&&!w.length&&(c+="/");for(let k=0;k<w.length;k++){const M=w[k];let O=40+(i.sensitive?.25:0);if(M.type===0)k||(c+="/"),c+=M.value.replace(YB,"\\$&"),O+=40;else if(M.type===1){const{value:j,repeatable:W,optional:le,regexp:he}=M;d.push({name:j,repeatable:W,optional:le});const be=he||M1;if(be!==M1){O+=10;try{new RegExp(`(${be})`)}catch(Pe){throw new Error(`Invalid custom RegExp for param "${j}" (${be}): `+Pe.message)}}let ge=W?`((?:${be})(?:/(?:${be}))*)`:`(${be})`;k||(ge=le&&w.length<2?`(?:/${ge})`:"/"+ge),le&&(ge+="?"),c+=ge,O+=20,le&&(O+=-8),W&&(O+=-20),be===".*"&&(O+=-50)}C.push(O)}a.push(C)}if(i.strict&&i.end){const w=a.length-1;a[w][a[w].length-1]+=.7000000000000001}i.strict||(c+="/?"),i.end?c+="$":i.strict&&(c+="(?:/|$)");const m=new RegExp(c,i.sensitive?"":"i");function l(w){const C=w.match(m),k={};if(!C)return null;for(let M=1;M<C.length;M++){const O=C[M]||"",j=d[M-1];k[j.name]=O&&j.repeatable?O.split("/"):O}return k}function b(w){let C="",k=!1;for(const M of e){(!k||!C.endsWith("/"))&&(C+="/"),k=!1;for(const O of M)if(O.type===0)C+=O.value;else if(O.type===1){const{value:j,repeatable:W,optional:le}=O,he=j in w?w[j]:"";if(qs(he)&&!W)throw new Error(`Provided param "${j}" is an array but it is not repeatable (* or + modifiers)`);const be=qs(he)?he.join("/"):he;if(!be)if(le)M.length<2&&(C.endsWith("/")?C=C.slice(0,-1):k=!0);else throw new Error(`Missing required param "${j}"`);C+=be}}return C||"/"}return{re:m,score:a,keys:d,parse:l,stringify:b}}function KB(e,t){let i=0;for(;i<e.length&&i<t.length;){const a=t[i]-e[i];if(a)return a;i++}return e.length<t.length?e.length===1&&e[0]===40+40?-1:1:e.length>t.length?t.length===1&&t[0]===40+40?1:-1:0}function JB(e,t){let i=0;const a=e.score,c=t.score;for(;i<a.length&&i<c.length;){const d=KB(a[i],c[i]);if(d)return d;i++}if(Math.abs(c.length-a.length)===1){if(D1(a))return 1;if(D1(c))return-1}return c.length-a.length}function D1(e){const t=e[e.length-1];return e.length>0&&t[t.length-1]<0}const QB={type:0,value:""},eF=/[a-zA-Z0-9_]/;function tF(e){if(!e)return[[]];if(e==="/")return[[QB]];if(!e.startsWith("/"))throw new Error(`Invalid path "${e}"`);function t(O){throw new Error(`ERR (${i})/"${w}": ${O}`)}let i=0,a=i;const c=[];let d;function m(){d&&c.push(d),d=[]}let l=0,b,w="",C="";function k(){w&&(i===0?d.push({type:0,value:w}):i===1||i===2||i===3?(d.length>1&&(b==="*"||b==="+")&&t(`A repeatable param (${w}) must be alone in its segment. eg: '/:ids+.`),d.push({type:1,value:w,regexp:C,repeatable:b==="*"||b==="+",optional:b==="*"||b==="?"})):t("Invalid state to consume buffer"),w="")}function M(){w+=b}for(;l<e.length;){if(b=e[l++],b==="\\"&&i!==2){a=i,i=4;continue}switch(i){case 0:b==="/"?(w&&k(),m()):b===":"?(k(),i=1):M();break;case 4:M(),i=a;break;case 1:b==="("?i=2:eF.test(b)?M():(k(),i=0,b!=="*"&&b!=="?"&&b!=="+"&&l--);break;case 2:b===")"?C[C.length-1]=="\\"?C=C.slice(0,-1)+b:i=3:C+=b;break;case 3:k(),i=0,b!=="*"&&b!=="?"&&b!=="+"&&l--,C="";break;default:t("Unknown state");break}}return i===2&&t(`Unfinished custom RegExp for param "${w}"`),k(),m(),c}function nF(e,t,i){const a=XB(tF(e.path),i),c=Un(a,{record:e,parent:t,children:[],alias:[]});return t&&!c.record.aliasOf==!t.record.aliasOf&&t.children.push(c),c}function iF(e,t){const i=[],a=new Map;t=O1({strict:!1,end:!0,sensitive:!1},t);function c(C){return a.get(C)}function d(C,k,M){const O=!M,j=rF(C);j.aliasOf=M&&M.record;const W=O1(t,C),le=[j];if("alias"in C){const ge=typeof C.alias=="string"?[C.alias]:C.alias;for(const Pe of ge)le.push(Un({},j,{components:M?M.record.components:j.components,path:Pe,aliasOf:M?M.record:j}))}let he,be;for(const ge of le){const{path:Pe}=ge;if(k&&Pe[0]!=="/"){const Ue=k.record.path,Oe=Ue[Ue.length-1]==="/"?"":"/";ge.path=k.record.path+(Pe&&Oe+Pe)}if(he=nF(ge,k,W),M?M.alias.push(he):(be=be||he,be!==he&&be.alias.push(he),O&&C.name&&!z1(he)&&m(C.name)),j.children){const Ue=j.children;for(let Oe=0;Oe<Ue.length;Oe++)d(Ue[Oe],he,M&&M.children[Oe])}M=M||he,(he.record.components&&Object.keys(he.record.components).length||he.record.name||he.record.redirect)&&b(he)}return be?()=>{m(be)}:Uh}function m(C){if(OT(C)){const k=a.get(C);k&&(a.delete(C),i.splice(i.indexOf(k),1),k.children.forEach(m),k.alias.forEach(m))}else{const k=i.indexOf(C);k>-1&&(i.splice(k,1),C.record.name&&a.delete(C.record.name),C.children.forEach(m),C.alias.forEach(m))}}function l(){return i}function b(C){let k=0;for(;k<i.length&&JB(C,i[k])>=0&&(C.record.path!==i[k].record.path||!FT(C,i[k]));)k++;i.splice(k,0,C),C.record.name&&!z1(C)&&a.set(C.record.name,C)}function w(C,k){let M,O={},j,W;if("name"in C&&C.name){if(M=a.get(C.name),!M)throw tu(1,{location:C});W=M.record.name,O=Un(L1(k.params,M.keys.filter(be=>!be.optional).map(be=>be.name)),C.params&&L1(C.params,M.keys.map(be=>be.name))),j=M.stringify(O)}else if("path"in C)j=C.path,M=i.find(be=>be.re.test(j)),M&&(O=M.parse(j),W=M.record.name);else{if(M=k.name?a.get(k.name):i.find(be=>be.re.test(k.path)),!M)throw tu(1,{location:C,currentLocation:k});W=M.record.name,O=Un({},k.params,C.params),j=M.stringify(O)}const le=[];let he=M;for(;he;)le.unshift(he.record),he=he.parent;return{name:W,path:j,params:O,matched:le,meta:aF(le)}}return e.forEach(C=>d(C)),{addRoute:d,resolve:w,removeRoute:m,getRoutes:l,getRecordMatcher:c}}function L1(e,t){const i={};for(const a of t)a in e&&(i[a]=e[a]);return i}function rF(e){return{path:e.path,redirect:e.redirect,name:e.name,meta:e.meta||{},aliasOf:void 0,beforeEnter:e.beforeEnter,props:sF(e),children:e.children||[],instances:{},leaveGuards:new Set,updateGuards:new Set,enterCallbacks:{},components:"components"in e?e.components||null:e.component&&{default:e.component}}}function sF(e){const t={},i=e.props||!1;if("component"in e)t.default=i;else for(const a in e.components)t[a]=typeof i=="boolean"?i:i[a];return t}function z1(e){for(;e;){if(e.record.aliasOf)return!0;e=e.parent}return!1}function aF(e){return e.reduce((t,i)=>Un(t,i.meta),{})}function O1(e,t){const i={};for(const a in e)i[a]=a in t?t[a]:e[a];return i}function FT(e,t){return t.children.some(i=>i===e||FT(e,i))}const NT=/#/g,oF=/&/g,lF=/\//g,cF=/=/g,uF=/\?/g,UT=/\+/g,hF=/%5B/g,dF=/%5D/g,$T=/%5E/g,fF=/%60/g,VT=/%7B/g,pF=/%7C/g,jT=/%7D/g,mF=/%20/g;function Gv(e){return encodeURI(""+e).replace(pF,"|").replace(hF,"[").replace(dF,"]")}function gF(e){return Gv(e).replace(VT,"{").replace(jT,"}").replace($T,"^")}function uy(e){return Gv(e).replace(UT,"%2B").replace(mF,"+").replace(NT,"%23").replace(oF,"%26").replace(fF,"`").replace(VT,"{").replace(jT,"}").replace($T,"^")}function _F(e){return uy(e).replace(cF,"%3D")}function yF(e){return Gv(e).replace(NT,"%23").replace(uF,"%3F")}function vF(e){return e==null?"":yF(e).replace(lF,"%2F")}function Vp(e){try{return decodeURIComponent(""+e)}catch{}return""+e}function xF(e){const t={};if(e===""||e==="?")return t;const a=(e[0]==="?"?e.slice(1):e).split("&");for(let c=0;c<a.length;++c){const d=a[c].replace(UT," "),m=d.indexOf("="),l=Vp(m<0?d:d.slice(0,m)),b=m<0?null:Vp(d.slice(m+1));if(l in t){let w=t[l];qs(w)||(w=t[l]=[w]),w.push(b)}else t[l]=b}return t}function B1(e){let t="";for(let i in e){const a=e[i];if(i=_F(i),a==null){a!==void 0&&(t+=(t.length?"&":"")+i);continue}(qs(a)?a.map(d=>d&&uy(d)):[a&&uy(a)]).forEach(d=>{d!==void 0&&(t+=(t.length?"&":"")+i,d!=null&&(t+="="+d))})}return t}function bF(e){const t={};for(const i in e){const a=e[i];a!==void 0&&(t[i]=qs(a)?a.map(c=>c==null?null:""+c):a==null?a:""+a)}return t}const wF=Symbol(""),F1=Symbol(""),qv=Symbol(""),GT=Symbol(""),hy=Symbol("");function kh(){let e=[];function t(a){return e.push(a),()=>{const c=e.indexOf(a);c>-1&&e.splice(c,1)}}function i(){e=[]}return{add:t,list:()=>e,reset:i}}function Ro(e,t,i,a,c){const d=a&&(a.enterCallbacks[c]=a.enterCallbacks[c]||[]);return()=>new Promise((m,l)=>{const b=k=>{k===!1?l(tu(4,{from:i,to:t})):k instanceof Error?l(k):ZB(k)?l(tu(2,{from:t,to:k})):(d&&a.enterCallbacks[c]===d&&typeof k=="function"&&d.push(k),m())},w=e.call(a&&a.instances[c],t,i,b);let C=Promise.resolve(w);e.length<3&&(C=C.then(b)),C.catch(k=>l(k))})}function m_(e,t,i,a){const c=[];for(const d of e)for(const m in d.components){let l=d.components[m];if(!(t!=="beforeRouteEnter"&&!d.instances[m]))if(SF(l)){const w=(l.__vccOpts||l)[t];w&&c.push(Ro(w,i,a,d,m))}else{let b=l();c.push(()=>b.then(w=>{if(!w)return Promise.reject(new Error(`Couldn't resolve component "${m}" at "${d.path}"`));const C=AB(w)?w.default:w;d.components[m]=C;const M=(C.__vccOpts||C)[t];return M&&Ro(M,i,a,d,m)()}))}}return c}function SF(e){return typeof e=="object"||"displayName"in e||"props"in e||"__vccOpts"in e}function N1(e){const t=Jn(qv),i=Jn(GT),a=Ie(()=>t.resolve(hr(e.to))),c=Ie(()=>{const{matched:b}=a.value,{length:w}=b,C=b[w-1],k=i.matched;if(!C||!k.length)return-1;const M=k.findIndex(eu.bind(null,C));if(M>-1)return M;const O=U1(b[w-2]);return w>1&&U1(C)===O&&k[k.length-1].path!==O?k.findIndex(eu.bind(null,b[w-2])):M}),d=Ie(()=>c.value>-1&&IF(i.params,a.value.params)),m=Ie(()=>c.value>-1&&c.value===i.matched.length-1&&LT(i.params,a.value.params));function l(b={}){return CF(b)?t[hr(e.replace)?"replace":"push"](hr(e.to)).catch(Uh):Promise.resolve()}return{route:a,href:Ie(()=>a.value.href),isActive:d,isExactActive:m,navigate:l}}const EF=cm({name:"RouterLink",compatConfig:{MODE:3},props:{to:{type:[String,Object],required:!0},replace:Boolean,activeClass:String,exactActiveClass:String,custom:Boolean,ariaCurrentValue:{type:String,default:"page"}},useLink:N1,setup(e,{slots:t}){const i=er(N1(e)),{options:a}=Jn(qv),c=Ie(()=>({[$1(e.activeClass,a.linkActiveClass,"router-link-active")]:i.isActive,[$1(e.exactActiveClass,a.linkExactActiveClass,"router-link-exact-active")]:i.isExactActive}));return()=>{const d=t.default&&t.default(i);return e.custom?d:Wo("a",{"aria-current":i.isExactActive?e.ariaCurrentValue:null,href:i.href,onClick:i.navigate,class:c.value},d)}}}),TF=EF;function CF(e){if(!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)&&!e.defaultPrevented&&!(e.button!==void 0&&e.button!==0)){if(e.currentTarget&&e.currentTarget.getAttribute){const t=e.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(t))return}return e.preventDefault&&e.preventDefault(),!0}}function IF(e,t){for(const i in t){const a=t[i],c=e[i];if(typeof a=="string"){if(a!==c)return!1}else if(!qs(c)||c.length!==a.length||a.some((d,m)=>d!==c[m]))return!1}return!0}function U1(e){return e?e.aliasOf?e.aliasOf.path:e.path:""}const $1=(e,t,i)=>e??t??i,kF=cm({name:"RouterView",inheritAttrs:!1,props:{name:{type:String,default:"default"},route:Object},compatConfig:{MODE:3},setup(e,{attrs:t,slots:i}){const a=Jn(hy),c=Ie(()=>e.route||a.value),d=Jn(F1,0),m=Ie(()=>{let w=hr(d);const{matched:C}=c.value;let k;for(;(k=C[w])&&!k.components;)w++;return w}),l=Ie(()=>c.value.matched[m.value]);Sr(F1,Ie(()=>m.value+1)),Sr(wF,l),Sr(hy,c);const b=Jt();return Sn(()=>[b.value,l.value,e.name],([w,C,k],[M,O,j])=>{C&&(C.instances[k]=w,O&&O!==C&&w&&w===M&&(C.leaveGuards.size||(C.leaveGuards=O.leaveGuards),C.updateGuards.size||(C.updateGuards=O.updateGuards))),w&&C&&(!O||!eu(C,O)||!M)&&(C.enterCallbacks[k]||[]).forEach(W=>W(w))},{flush:"post"}),()=>{const w=c.value,C=e.name,k=l.value,M=k&&k.components[C];if(!M)return V1(i.default,{Component:M,route:w});const O=k.props[C],j=O?O===!0?w.params:typeof O=="function"?O(w):O:null,le=Wo(M,Un({},j,t,{onVnodeUnmounted:he=>{he.component.isUnmounted&&(k.instances[C]=null)},ref:b}));return V1(i.default,{Component:le,route:w})||le}}});function V1(e,t){if(!e)return null;const i=e(t);return i.length===1?i[0]:i}const AF=kF;function PF(e){const t=iF(e.routes,e),i=e.parseQuery||xF,a=e.stringifyQuery||B1,c=e.history,d=kh(),m=kh(),l=kh(),b=wn(Io);let w=Io;Uc&&e.scrollBehavior&&"scrollRestoration"in history&&(history.scrollRestoration="manual");const C=f_.bind(null,xe=>""+xe),k=f_.bind(null,vF),M=f_.bind(null,Vp);function O(xe,Ke){let Fe,Ge;return OT(xe)?(Fe=t.getRecordMatcher(xe),Ge=Ke):Ge=xe,t.addRoute(Ge,Fe)}function j(xe){const Ke=t.getRecordMatcher(xe);Ke&&t.removeRoute(Ke)}function W(){return t.getRoutes().map(xe=>xe.record)}function le(xe){return!!t.getRecordMatcher(xe)}function he(xe,Ke){if(Ke=Un({},Ke||b.value),typeof xe=="string"){const ye=p_(i,xe,Ke.path),Le=t.resolve({path:ye.path},Ke),De=c.createHref(ye.fullPath);return Un(ye,Le,{params:M(Le.params),hash:Vp(ye.hash),redirectedFrom:void 0,href:De})}let Fe;if("path"in xe)Fe=Un({},xe,{path:p_(i,xe.path,Ke.path).path});else{const ye=Un({},xe.params);for(const Le in ye)ye[Le]==null&&delete ye[Le];Fe=Un({},xe,{params:k(ye)}),Ke.params=k(Ke.params)}const Ge=t.resolve(Fe,Ke),ft=xe.hash||"";Ge.params=C(M(Ge.params));const X=MB(a,Un({},xe,{hash:gF(ft),path:Ge.path})),U=c.createHref(X);return Un({fullPath:X,hash:ft,query:a===B1?bF(xe.query):xe.query||{}},Ge,{redirectedFrom:void 0,href:U})}function be(xe){return typeof xe=="string"?p_(i,xe,b.value.path):Un({},xe)}function ge(xe,Ke){if(w!==xe)return tu(8,{from:Ke,to:xe})}function Pe(xe){return Te(xe)}function Ue(xe){return Pe(Un(be(xe),{replace:!0}))}function Oe(xe){const Ke=xe.matched[xe.matched.length-1];if(Ke&&Ke.redirect){const{redirect:Fe}=Ke;let Ge=typeof Fe=="function"?Fe(xe):Fe;return typeof Ge=="string"&&(Ge=Ge.includes("?")||Ge.includes("#")?Ge=be(Ge):{path:Ge},Ge.params={}),Un({query:xe.query,hash:xe.hash,params:"path"in Ge?{}:xe.params},Ge)}}function Te(xe,Ke){const Fe=w=he(xe),Ge=b.value,ft=xe.state,X=xe.force,U=xe.replace===!0,ye=Oe(Fe);if(ye)return Te(Un(be(ye),{state:typeof ye=="object"?Un({},ft,ye.state):ft,force:X,replace:U}),Ke||Fe);const Le=Fe;Le.redirectedFrom=Ke;let De;return!X&&DB(a,Ge,Fe)&&(De=tu(16,{to:Le,from:Ge}),Et(Ge,Ge,!0,!1)),(De?Promise.resolve(De):ae(Le,Ge)).catch(Ve=>$a(Ve)?$a(Ve,2)?Ve:kt(Ve):je(Ve,Le,Ge)).then(Ve=>{if(Ve){if($a(Ve,2))return Te(Un({replace:U},be(Ve.to),{state:typeof Ve.to=="object"?Un({},ft,Ve.to.state):ft,force:X}),Ke||Le)}else Ve=_e(Le,Ge,!0,U,ft);return ke(Le,Ge,Ve),Ve})}function V(xe,Ke){const Fe=ge(xe,Ke);return Fe?Promise.reject(Fe):Promise.resolve()}function Z(xe){const Ke=Pt.values().next().value;return Ke&&typeof Ke.runWithContext=="function"?Ke.runWithContext(xe):xe()}function ae(xe,Ke){let Fe;const[Ge,ft,X]=RF(xe,Ke);Fe=m_(Ge.reverse(),"beforeRouteLeave",xe,Ke);for(const ye of Ge)ye.leaveGuards.forEach(Le=>{Fe.push(Ro(Le,xe,Ke))});const U=V.bind(null,xe,Ke);return Fe.push(U),He(Fe).then(()=>{Fe=[];for(const ye of d.list())Fe.push(Ro(ye,xe,Ke));return Fe.push(U),He(Fe)}).then(()=>{Fe=m_(ft,"beforeRouteUpdate",xe,Ke);for(const ye of ft)ye.updateGuards.forEach(Le=>{Fe.push(Ro(Le,xe,Ke))});return Fe.push(U),He(Fe)}).then(()=>{Fe=[];for(const ye of xe.matched)if(ye.beforeEnter&&!Ke.matched.includes(ye))if(qs(ye.beforeEnter))for(const Le of ye.beforeEnter)Fe.push(Ro(Le,xe,Ke));else Fe.push(Ro(ye.beforeEnter,xe,Ke));return Fe.push(U),He(Fe)}).then(()=>(xe.matched.forEach(ye=>ye.enterCallbacks={}),Fe=m_(X,"beforeRouteEnter",xe,Ke),Fe.push(U),He(Fe))).then(()=>{Fe=[];for(const ye of m.list())Fe.push(Ro(ye,xe,Ke));return Fe.push(U),He(Fe)}).catch(ye=>$a(ye,8)?ye:Promise.reject(ye))}function ke(xe,Ke,Fe){for(const Ge of l.list())Z(()=>Ge(xe,Ke,Fe))}function _e(xe,Ke,Fe,Ge,ft){const X=ge(xe,Ke);if(X)return X;const U=Ke===Io,ye=Uc?history.state:{};Fe&&(Ge||U?c.replace(xe.fullPath,Un({scroll:U&&ye&&ye.scroll},ft)):c.push(xe.fullPath,ft)),b.value=xe,Et(xe,Ke,Fe,U),kt()}let oe;function Re(){oe||(oe=c.listen((xe,Ke,Fe)=>{if(!Wt.listening)return;const Ge=he(xe),ft=Oe(Ge);if(ft){Te(Un(ft,{replace:!0}),Ge).catch(Uh);return}w=Ge;const X=b.value;Uc&&$B(A1(X.fullPath,Fe.delta),Em()),ae(Ge,X).catch(U=>$a(U,12)?U:$a(U,2)?(Te(U.to,Ge).then(ye=>{$a(ye,20)&&!Fe.delta&&Fe.type===hd.pop&&c.go(-1,!1)}).catch(Uh),Promise.reject()):(Fe.delta&&c.go(-Fe.delta,!1),je(U,Ge,X))).then(U=>{U=U||_e(Ge,X,!1),U&&(Fe.delta&&!$a(U,8)?c.go(-Fe.delta,!1):Fe.type===hd.pop&&$a(U,20)&&c.go(-1,!1)),ke(Ge,X,U)}).catch(Uh)}))}let nt=kh(),Qe=kh(),qe;function je(xe,Ke,Fe){kt(xe);const Ge=Qe.list();return Ge.length?Ge.forEach(ft=>ft(xe,Ke,Fe)):console.error(xe),Promise.reject(xe)}function Ze(){return qe&&b.value!==Io?Promise.resolve():new Promise((xe,Ke)=>{nt.add([xe,Ke])})}function kt(xe){return qe||(qe=!xe,Re(),nt.list().forEach(([Ke,Fe])=>xe?Fe(xe):Ke()),nt.reset()),xe}function Et(xe,Ke,Fe,Ge){const{scrollBehavior:ft}=e;if(!Uc||!ft)return Promise.resolve();const X=!Fe&&VB(A1(xe.fullPath,0))||(Ge||!Fe)&&history.state&&history.state.scroll||null;return Er().then(()=>ft(xe,Ke,X)).then(U=>U&&UB(U)).catch(U=>je(U,xe,Ke))}const rt=xe=>c.go(xe);let At;const Pt=new Set,Wt={currentRoute:b,listening:!0,addRoute:O,removeRoute:j,hasRoute:le,getRoutes:W,resolve:he,options:e,push:Pe,replace:Ue,go:rt,back:()=>rt(-1),forward:()=>rt(1),beforeEach:d.add,beforeResolve:m.add,afterEach:l.add,onError:Qe.add,isReady:Ze,install(xe){const Ke=this;xe.component("RouterLink",TF),xe.component("RouterView",AF),xe.config.globalProperties.$router=Ke,Object.defineProperty(xe.config.globalProperties,"$route",{enumerable:!0,get:()=>hr(b)}),Uc&&!At&&b.value===Io&&(At=!0,Pe(c.location).catch(ft=>{}));const Fe={};for(const ft in Io)Fe[ft]=Ie(()=>b.value[ft]);xe.provide(qv,Ke),xe.provide(GT,er(Fe)),xe.provide(hy,b);const Ge=xe.unmount;Pt.add(xe),xe.unmount=function(){Pt.delete(xe),Pt.size<1&&(w=Io,oe&&oe(),oe=null,b.value=Io,At=!1,qe=!1),Ge()}}};function He(xe){return xe.reduce((Ke,Fe)=>Ke.then(()=>Z(Fe)),Promise.resolve())}return Wt}function RF(e,t){const i=[],a=[],c=[],d=Math.max(t.matched.length,e.matched.length);for(let m=0;m<d;m++){const l=t.matched[m];l&&(e.matched.find(w=>eu(w,l))?a.push(l):i.push(l));const b=e.matched[m];b&&(t.matched.find(w=>eu(w,b))||c.push(b))}return[i,a,c]}const qT=PF({history:HB("./"),routes:[]}),HT=Object.prototype.toString;function ZT(e){switch(HT.call(e)){case"[object Error]":case"[object Exception]":case"[object DOMException]":return!0;default:return Ja(e,Error)}}function Eu(e,t){return HT.call(e)===`[object ${t}]`}function Hv(e){return Eu(e,"ErrorEvent")}function j1(e){return Eu(e,"DOMError")}function MF(e){return Eu(e,"DOMException")}function Go(e){return Eu(e,"String")}function WT(e){return e===null||typeof e!="object"&&typeof e!="function"}function nu(e){return Eu(e,"Object")}function Tm(e){return typeof Event<"u"&&Ja(e,Event)}function DF(e){return typeof Element<"u"&&Ja(e,Element)}function LF(e){return Eu(e,"RegExp")}function Zv(e){return!!(e&&e.then&&typeof e.then=="function")}function zF(e){return nu(e)&&"nativeEvent"in e&&"preventDefault"in e&&"stopPropagation"in e}function YT(e){return typeof e=="number"&&e!==e}function Ja(e,t){try{return e instanceof t}catch{return!1}}function Xc(e,t=0){return typeof e!="string"||t===0||e.length<=t?e:`${e.slice(0,t)}...`}function G1(e,t){if(!Array.isArray(e))return"";const i=[];for(let a=0;a<e.length;a++){const c=e[a];try{i.push(String(c))}catch{i.push("[value cannot be serialized]")}}return i.join(t)}function OF(e,t,i=!1){return Go(e)?LF(t)?t.test(e):Go(t)?i?e===t:e.includes(t):!1:!1}function Tu(e,t=[],i=!1){return t.some(a=>OF(e,a,i))}function BF(e,t,i=250,a,c,d,m){if(!d.exception||!d.exception.values||!m||!Ja(m.originalException,Error))return;const l=d.exception.values.length>0?d.exception.values[d.exception.values.length-1]:void 0;l&&(d.exception.values=FF(dy(e,t,c,m.originalException,a,d.exception.values,l,0),i))}function dy(e,t,i,a,c,d,m,l){if(d.length>=i+1)return d;let b=[...d];if(Ja(a[c],Error)){q1(m,l);const w=e(t,a[c]),C=b.length;H1(w,c,C,l),b=dy(e,t,i,a[c],c,[w,...b],w,C)}return Array.isArray(a.errors)&&a.errors.forEach((w,C)=>{if(Ja(w,Error)){q1(m,l);const k=e(t,w),M=b.length;H1(k,`errors[${C}]`,M,l),b=dy(e,t,i,w,c,[k,...b],k,M)}}),b}function q1(e,t){e.mechanism=e.mechanism||{type:"generic",handled:!0},e.mechanism={...e.mechanism,is_exception_group:!0,exception_id:t}}function H1(e,t,i,a){e.mechanism=e.mechanism||{type:"generic",handled:!0},e.mechanism={...e.mechanism,type:"chained",source:t,exception_id:i,parent_id:a}}function FF(e,t){return e.map(i=>(i.value&&(i.value=Xc(i.value,t)),i))}function Wf(e){return e&&e.Math==Math?e:void 0}const Br=typeof globalThis=="object"&&Wf(globalThis)||typeof window=="object"&&Wf(window)||typeof self=="object"&&Wf(self)||typeof global=="object"&&Wf(global)||function(){return this}()||{};function kd(){return Br}function Wv(e,t,i){const a=i||Br,c=a.__SENTRY__=a.__SENTRY__||{};return c[e]||(c[e]=t())}const gp=kd(),NF=80;function qo(e,t={}){try{let i=e;const a=5,c=[];let d=0,m=0;const l=" > ",b=l.length;let w;const C=Array.isArray(t)?t:t.keyAttrs,k=!Array.isArray(t)&&t.maxStringLength||NF;for(;i&&d++<a&&(w=UF(i,C),!(w==="html"||d>1&&m+c.length*b+w.length>=k));)c.push(w),m+=w.length,i=i.parentNode;return c.reverse().join(l)}catch{return"<unknown>"}}function UF(e,t){const i=e,a=[];let c,d,m,l,b;if(!i||!i.tagName)return"";a.push(i.tagName.toLowerCase());const w=t&&t.length?t.filter(k=>i.getAttribute(k)).map(k=>[k,i.getAttribute(k)]):null;if(w&&w.length)w.forEach(k=>{a.push(`[${k[0]}="${k[1]}"]`)});else if(i.id&&a.push(`#${i.id}`),c=i.className,c&&Go(c))for(d=c.split(/\s+/),b=0;b<d.length;b++)a.push(`.${d[b]}`);const C=["aria-label","type","name","title","alt"];for(b=0;b<C.length;b++)m=C[b],l=i.getAttribute(m),l&&a.push(`[${m}="${l}"]`);return a.join("")}function $F(){try{return gp.document.location.href}catch{return""}}function VF(e){return gp.document&&gp.document.querySelector?gp.document.querySelector(e):null}const jF="Sentry Logger ",jp=["debug","info","warn","error","log","assert","trace"];function XT(e){if(!("console"in Br))return e();const t=Br.console,i={};jp.forEach(a=>{const c=t[a]&&t[a].__sentry_original__;a in t&&c&&(i[a]=t[a],t[a]=c)});try{return e()}finally{Object.keys(i).forEach(a=>{t[a]=i[a]})}}function Z1(){let e=!1;const t={enable:()=>{e=!0},disable:()=>{e=!1}};return typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__?jp.forEach(i=>{t[i]=(...a)=>{e&&XT(()=>{Br.console[i](`${jF}[${i}]:`,...a)})}}):jp.forEach(i=>{t[i]=()=>{}}),t}let at;typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__?at=Wv("logger",Z1):at=Z1();const GF=/^(?:(\w+):)\/\/(?:(\w+)(?::(\w+)?)?@)([\w.-]+)(?::(\d+))?\/(.+)/;function qF(e){return e==="http"||e==="https"}function Cm(e,t=!1){const{host:i,path:a,pass:c,port:d,projectId:m,protocol:l,publicKey:b}=e;return`${l}://${b}${t&&c?`:${c}`:""}@${i}${d?`:${d}`:""}/${a&&`${a}/`}${m}`}function HF(e){const t=GF.exec(e);if(!t){console.error(`Invalid Sentry Dsn: ${e}`);return}const[i,a,c="",d,m="",l]=t.slice(1);let b="",w=l;const C=w.split("/");if(C.length>1&&(b=C.slice(0,-1).join("/"),w=C.pop()),w){const k=w.match(/^\d+/);k&&(w=k[0])}return KT({host:d,pass:c,path:b,projectId:w,port:m,protocol:i,publicKey:a})}function KT(e){return{protocol:e.protocol,publicKey:e.publicKey||"",pass:e.pass||"",host:e.host,port:e.port||"",path:e.path||"",projectId:e.projectId}}function ZF(e){if(!(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__))return!0;const{port:t,projectId:i,protocol:a}=e;return["protocol","publicKey","host","projectId"].find(m=>e[m]?!1:(at.error(`Invalid Sentry Dsn: ${m} missing`),!0))?!1:i.match(/^\d+$/)?qF(a)?t&&isNaN(parseInt(t,10))?(at.error(`Invalid Sentry Dsn: Invalid port ${t}`),!1):!0:(at.error(`Invalid Sentry Dsn: Invalid protocol ${a}`),!1):(at.error(`Invalid Sentry Dsn: Invalid projectId ${i}`),!1)}function WF(e){const t=typeof e=="string"?HF(e):KT(e);if(!(!t||!ZF(t)))return t}class Ns extends Error{constructor(t,i="warn"){super(t),this.message=t,this.name=new.target.prototype.constructor.name,Object.setPrototypeOf(this,new.target.prototype),this.logLevel=i}}function tr(e,t,i){if(!(t in e))return;const a=e[t],c=i(a);if(typeof c=="function")try{JT(c,a)}catch{}e[t]=c}function Yv(e,t,i){Object.defineProperty(e,t,{value:i,writable:!0,configurable:!0})}function JT(e,t){const i=t.prototype||{};e.prototype=t.prototype=i,Yv(e,"__sentry_original__",t)}function Xv(e){return e.__sentry_original__}function YF(e){return Object.keys(e).map(t=>`${encodeURIComponent(t)}=${encodeURIComponent(e[t])}`).join("&")}function QT(e){if(ZT(e))return{message:e.message,name:e.name,stack:e.stack,...Y1(e)};if(Tm(e)){const t={type:e.type,target:W1(e.target),currentTarget:W1(e.currentTarget),...Y1(e)};return typeof CustomEvent<"u"&&Ja(e,CustomEvent)&&(t.detail=e.detail),t}else return e}function W1(e){try{return DF(e)?qo(e):Object.prototype.toString.call(e)}catch{return"<unknown>"}}function Y1(e){if(typeof e=="object"&&e!==null){const t={};for(const i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}else return{}}function XF(e,t=40){const i=Object.keys(QT(e));if(i.sort(),!i.length)return"[object has no keys]";if(i[0].length>=t)return Xc(i[0],t);for(let a=i.length;a>0;a--){const c=i.slice(0,a).join(", ");if(!(c.length>t))return a===i.length?c:Xc(c,t)}return""}function ya(e){return fy(e,new Map)}function fy(e,t){if(nu(e)){const i=t.get(e);if(i!==void 0)return i;const a={};t.set(e,a);for(const c of Object.keys(e))typeof e[c]<"u"&&(a[c]=fy(e[c],t));return a}if(Array.isArray(e)){const i=t.get(e);if(i!==void 0)return i;const a=[];return t.set(e,a),e.forEach(c=>{a.push(fy(c,t))}),a}return e}const e2=50,X1=/\(error: (.*)\)/,K1=/captureMessage|captureException/;function t2(...e){const t=e.sort((i,a)=>i[0]-a[0]).map(i=>i[1]);return(i,a=0)=>{const c=[],d=i.split(`
`);for(let m=a;m<d.length;m++){const l=d[m];if(l.length>1024)continue;const b=X1.test(l)?l.replace(X1,"$1"):l;if(!b.match(/\S*Error: /)){for(const w of t){const C=w(b);if(C){c.push(C);break}}if(c.length>=e2)break}}return JF(c)}}function KF(e){return Array.isArray(e)?t2(...e):e}function JF(e){if(!e.length)return[];const t=Array.from(e);return/sentryWrapped/.test(t[t.length-1].function||"")&&t.pop(),t.reverse(),K1.test(t[t.length-1].function||"")&&(t.pop(),K1.test(t[t.length-1].function||"")&&t.pop()),t.slice(0,e2).map(i=>({...i,filename:i.filename||t[t.length-1].filename,function:i.function||"?"}))}const g_="<anonymous>";function Ho(e){try{return!e||typeof e!="function"?g_:e.name||g_}catch{return g_}}const py=kd();function n2(){if(!("fetch"in py))return!1;try{return new Headers,new Request("http://www.example.com"),new Response,!0}catch{return!1}}function my(e){return e&&/^function fetch\(\)\s+\{\s+\[native code\]\s+\}$/.test(e.toString())}function QF(){if(!n2())return!1;if(my(py.fetch))return!0;let e=!1;const t=py.document;if(t&&typeof t.createElement=="function")try{const i=t.createElement("iframe");i.hidden=!0,t.head.appendChild(i),i.contentWindow&&i.contentWindow.fetch&&(e=my(i.contentWindow.fetch)),t.head.removeChild(i)}catch(i){(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&at.warn("Could not create sandbox iframe for pure fetch check, bailing to window.fetch: ",i)}return e}const Yf=kd();function e5(){const e=Yf.chrome,t=e&&e.app&&e.app.runtime,i="history"in Yf&&!!Yf.history.pushState&&!!Yf.history.replaceState;return!t&&i}const ui=kd(),Oo="__sentry_xhr_v2__",Vh={},J1={};function t5(e){if(!J1[e])switch(J1[e]=!0,e){case"console":n5();break;case"dom":u5();break;case"xhr":s5();break;case"fetch":i5();break;case"history":a5();break;case"error":h5();break;case"unhandledrejection":d5();break;default:(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&at.warn("unknown instrumentation type:",e);return}}function ur(e,t){Vh[e]=Vh[e]||[],Vh[e].push(t),t5(e)}function Gs(e,t){if(!(!e||!Vh[e]))for(const i of Vh[e]||[])try{i(t)}catch(a){(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&at.error(`Error while triggering instrumentation handler.
Type: ${e}
Name: ${Ho(i)}
Error:`,a)}}function n5(){"console"in ui&&jp.forEach(function(e){e in ui.console&&tr(ui.console,e,function(t){return function(...i){Gs("console",{args:i,level:e}),t&&t.apply(ui.console,i)}})})}function i5(){QF()&&tr(ui,"fetch",function(e){return function(...t){const{method:i,url:a}=r5(t),c={args:t,fetchData:{method:i,url:a},startTimestamp:Date.now()};return Gs("fetch",{...c}),e.apply(ui,t).then(d=>(Gs("fetch",{...c,endTimestamp:Date.now(),response:d}),d),d=>{throw Gs("fetch",{...c,endTimestamp:Date.now(),error:d}),d})}})}function gy(e,t){return!!e&&typeof e=="object"&&!!e[t]}function Q1(e){return typeof e=="string"?e:e?gy(e,"url")?e.url:e.toString?e.toString():"":""}function r5(e){if(e.length===0)return{method:"GET",url:""};if(e.length===2){const[i,a]=e;return{url:Q1(i),method:gy(a,"method")?String(a.method).toUpperCase():"GET"}}const t=e[0];return{url:Q1(t),method:gy(t,"method")?String(t.method).toUpperCase():"GET"}}function s5(){if(!("XMLHttpRequest"in ui))return;const e=XMLHttpRequest.prototype;tr(e,"open",function(t){return function(...i){const a=i[1],c=this[Oo]={method:Go(i[0])?i[0].toUpperCase():i[0],url:i[1],request_headers:{}};Go(a)&&c.method==="POST"&&a.match(/sentry_key/)&&(this.__sentry_own_request__=!0);const d=()=>{const m=this[Oo];if(m&&this.readyState===4){try{m.status_code=this.status}catch{}Gs("xhr",{args:i,endTimestamp:Date.now(),startTimestamp:Date.now(),xhr:this})}};return"onreadystatechange"in this&&typeof this.onreadystatechange=="function"?tr(this,"onreadystatechange",function(m){return function(...l){return d(),m.apply(this,l)}}):this.addEventListener("readystatechange",d),tr(this,"setRequestHeader",function(m){return function(...l){const[b,w]=l,C=this[Oo];return C&&(C.request_headers[b.toLowerCase()]=w),m.apply(this,l)}}),t.apply(this,i)}}),tr(e,"send",function(t){return function(...i){const a=this[Oo];return a&&i[0]!==void 0&&(a.body=i[0]),Gs("xhr",{args:i,startTimestamp:Date.now(),xhr:this}),t.apply(this,i)}})}let Xf;function a5(){if(!e5())return;const e=ui.onpopstate;ui.onpopstate=function(...i){const a=ui.location.href,c=Xf;if(Xf=a,Gs("history",{from:c,to:a}),e)try{return e.apply(this,i)}catch{}};function t(i){return function(...a){const c=a.length>2?a[2]:void 0;if(c){const d=Xf,m=String(c);Xf=m,Gs("history",{from:d,to:m})}return i.apply(this,a)}}tr(ui.history,"pushState",t),tr(ui.history,"replaceState",t)}const o5=1e3;let Kf,Jf;function l5(e,t){if(!e||e.type!==t.type)return!0;try{if(e.target!==t.target)return!0}catch{}return!1}function c5(e){if(e.type!=="keypress")return!1;try{const t=e.target;if(!t||!t.tagName)return!0;if(t.tagName==="INPUT"||t.tagName==="TEXTAREA"||t.isContentEditable)return!1}catch{}return!0}function ew(e,t=!1){return i=>{if(!i||Jf===i||c5(i))return;const a=i.type==="keypress"?"input":i.type;Kf===void 0?(e({event:i,name:a,global:t}),Jf=i):l5(Jf,i)&&(e({event:i,name:a,global:t}),Jf=i),clearTimeout(Kf),Kf=ui.setTimeout(()=>{Kf=void 0},o5)}}function u5(){if(!("document"in ui))return;const e=Gs.bind(null,"dom"),t=ew(e,!0);ui.document.addEventListener("click",t,!1),ui.document.addEventListener("keypress",t,!1),["EventTarget","Node"].forEach(i=>{const a=ui[i]&&ui[i].prototype;!a||!a.hasOwnProperty||!a.hasOwnProperty("addEventListener")||(tr(a,"addEventListener",function(c){return function(d,m,l){if(d==="click"||d=="keypress")try{const b=this,w=b.__sentry_instrumentation_handlers__=b.__sentry_instrumentation_handlers__||{},C=w[d]=w[d]||{refCount:0};if(!C.handler){const k=ew(e);C.handler=k,c.call(this,d,k,l)}C.refCount++}catch{}return c.call(this,d,m,l)}}),tr(a,"removeEventListener",function(c){return function(d,m,l){if(d==="click"||d=="keypress")try{const b=this,w=b.__sentry_instrumentation_handlers__||{},C=w[d];C&&(C.refCount--,C.refCount<=0&&(c.call(this,d,C.handler,l),C.handler=void 0,delete w[d]),Object.keys(w).length===0&&delete b.__sentry_instrumentation_handlers__)}catch{}return c.call(this,d,m,l)}}))})}let Qf=null;function h5(){Qf=ui.onerror,ui.onerror=function(e,t,i,a,c){return Gs("error",{column:a,error:c,line:i,msg:e,url:t}),Qf&&!Qf.__SENTRY_LOADER__?Qf.apply(this,arguments):!1},ui.onerror.__SENTRY_INSTRUMENTED__=!0}let ep=null;function d5(){ep=ui.onunhandledrejection,ui.onunhandledrejection=function(e){return Gs("unhandledrejection",e),ep&&!ep.__SENTRY_LOADER__?ep.apply(this,arguments):!0},ui.onunhandledrejection.__SENTRY_INSTRUMENTED__=!0}function f5(){const e=typeof WeakSet=="function",t=e?new WeakSet:[];function i(c){if(e)return t.has(c)?!0:(t.add(c),!1);for(let d=0;d<t.length;d++)if(t[d]===c)return!0;return t.push(c),!1}function a(c){if(e)t.delete(c);else for(let d=0;d<t.length;d++)if(t[d]===c){t.splice(d,1);break}}return[i,a]}function Fr(){const e=Br,t=e.crypto||e.msCrypto;if(t&&t.randomUUID)return t.randomUUID().replace(/-/g,"");const i=t&&t.getRandomValues?()=>t.getRandomValues(new Uint8Array(1))[0]:()=>Math.random()*16;return([1e7]+1e3+4e3+8e3+1e11).replace(/[018]/g,a=>(a^(i()&15)>>a/4).toString(16))}function i2(e){return e.exception&&e.exception.values?e.exception.values[0]:void 0}function Lo(e){const{message:t,event_id:i}=e;if(t)return t;const a=i2(e);return a?a.type&&a.value?`${a.type}: ${a.value}`:a.type||a.value||i||"<unknown>":i||"<unknown>"}function _y(e,t,i){const a=e.exception=e.exception||{},c=a.values=a.values||[],d=c[0]=c[0]||{};d.value||(d.value=t||""),d.type||(d.type=i||"Error")}function dd(e,t){const i=i2(e);if(!i)return;const a={type:"generic",handled:!0},c=i.mechanism;if(i.mechanism={...a,...c,...t},t&&"data"in t){const d={...c&&c.data,...t.data};i.mechanism.data=d}}function tw(e){if(e&&e.__sentry_captured__)return!0;try{Yv(e,"__sentry_captured__",!0)}catch{}return!1}function Kv(e){return Array.isArray(e)?e:[e]}function p5(){return typeof __SENTRY_BROWSER_BUNDLE__<"u"&&!!__SENTRY_BROWSER_BUNDLE__}function m5(){return"npm"}function r2(){return!p5()&&Object.prototype.toString.call(typeof process<"u"?process:0)==="[object process]"}function g5(e,t){return e.require(t)}function da(e,t=100,i=1/0){try{return yy("",e,t,i)}catch(a){return{ERROR:`**non-serializable** (${a})`}}}function s2(e,t=3,i=100*1024){const a=da(e,t);return x5(a)>i?s2(e,t-1,i):a}function yy(e,t,i=1/0,a=1/0,c=f5()){const[d,m]=c;if(t==null||["number","boolean","string"].includes(typeof t)&&!YT(t))return t;const l=_5(e,t);if(!l.startsWith("[object "))return l;if(t.__sentry_skip_normalization__)return t;const b=typeof t.__sentry_override_normalization_depth__=="number"?t.__sentry_override_normalization_depth__:i;if(b===0)return l.replace("object ","");if(d(t))return"[Circular ~]";const w=t;if(w&&typeof w.toJSON=="function")try{const O=w.toJSON();return yy("",O,b-1,a,c)}catch{}const C=Array.isArray(t)?[]:{};let k=0;const M=QT(t);for(const O in M){if(!Object.prototype.hasOwnProperty.call(M,O))continue;if(k>=a){C[O]="[MaxProperties ~]";break}const j=M[O];C[O]=yy(O,j,b-1,a,c),k++}return m(t),C}function _5(e,t){try{if(e==="domain"&&t&&typeof t=="object"&&t._events)return"[Domain]";if(e==="domainEmitter")return"[DomainEmitter]";if(typeof global<"u"&&t===global)return"[Global]";if(typeof window<"u"&&t===window)return"[Window]";if(typeof document<"u"&&t===document)return"[Document]";if(zF(t))return"[SyntheticEvent]";if(typeof t=="number"&&t!==t)return"[NaN]";if(typeof t=="function")return`[Function: ${Ho(t)}]`;if(typeof t=="symbol")return`[${String(t)}]`;if(typeof t=="bigint")return`[BigInt: ${String(t)}]`;const i=y5(t);return/^HTML(\w*)Element$/.test(i)?`[HTMLElement: ${i}]`:`[object ${i}]`}catch(i){return`**non-serializable** (${i})`}}function y5(e){const t=Object.getPrototypeOf(e);return t?t.constructor.name:"null prototype"}function v5(e){return~-encodeURI(e).split(/%..|./).length}function x5(e){return v5(JSON.stringify(e))}var Ga;(function(e){e[e.PENDING=0]="PENDING";const i=1;e[e.RESOLVED=i]="RESOLVED";const a=2;e[e.REJECTED=a]="REJECTED"})(Ga||(Ga={}));function Ol(e){return new us(t=>{t(e)})}function Gp(e){return new us((t,i)=>{i(e)})}class us{constructor(t){us.prototype.__init.call(this),us.prototype.__init2.call(this),us.prototype.__init3.call(this),us.prototype.__init4.call(this),this._state=Ga.PENDING,this._handlers=[];try{t(this._resolve,this._reject)}catch(i){this._reject(i)}}then(t,i){return new us((a,c)=>{this._handlers.push([!1,d=>{if(!t)a(d);else try{a(t(d))}catch(m){c(m)}},d=>{if(!i)c(d);else try{a(i(d))}catch(m){c(m)}}]),this._executeHandlers()})}catch(t){return this.then(i=>i,t)}finally(t){return new us((i,a)=>{let c,d;return this.then(m=>{d=!1,c=m,t&&t()},m=>{d=!0,c=m,t&&t()}).then(()=>{if(d){a(c);return}i(c)})})}__init(){this._resolve=t=>{this._setResult(Ga.RESOLVED,t)}}__init2(){this._reject=t=>{this._setResult(Ga.REJECTED,t)}}__init3(){this._setResult=(t,i)=>{if(this._state===Ga.PENDING){if(Zv(i)){i.then(this._resolve,this._reject);return}this._state=t,this._value=i,this._executeHandlers()}}}__init4(){this._executeHandlers=()=>{if(this._state===Ga.PENDING)return;const t=this._handlers.slice();this._handlers=[],t.forEach(i=>{i[0]||(this._state===Ga.RESOLVED&&i[1](this._value),this._state===Ga.REJECTED&&i[2](this._value),i[0]=!0)})}}}function b5(e){const t=[];function i(){return e===void 0||t.length<e}function a(m){return t.splice(t.indexOf(m),1)[0]}function c(m){if(!i())return Gp(new Ns("Not adding Promise because buffer limit was reached."));const l=m();return t.indexOf(l)===-1&&t.push(l),l.then(()=>a(l)).then(null,()=>a(l).then(null,()=>{})),l}function d(m){return new us((l,b)=>{let w=t.length;if(!w)return l(!0);const C=setTimeout(()=>{m&&m>0&&l(!1)},m);t.forEach(k=>{Ol(k).then(()=>{--w||(clearTimeout(C),l(!0))},b)})})}return{$:t,add:c,drain:d}}function __(e){if(!e)return{};const t=e.match(/^(([^:/?#]+):)?(\/\/([^/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?$/);if(!t)return{};const i=t[6]||"",a=t[8]||"";return{host:t[4],path:t[5],protocol:t[2],search:i,hash:a,relative:t[5]+i+a}}const w5=["fatal","error","warning","log","info","debug"];function S5(e){return e==="warn"?"warning":w5.includes(e)?e:"log"}const a2=kd(),vy={nowSeconds:()=>Date.now()/1e3};function E5(){const{performance:e}=a2;if(!e||!e.now)return;const t=Date.now()-e.now();return{now:()=>e.now(),timeOrigin:t}}function T5(){try{return g5(mC,"perf_hooks").performance}catch{return}}const y_=r2()?T5():E5(),nw=y_===void 0?vy:{nowSeconds:()=>(y_.timeOrigin+y_.now())/1e3},Im=vy.nowSeconds.bind(vy),Zo=nw.nowSeconds.bind(nw),Hs=(()=>{const{performance:e}=a2;if(!e||!e.now)return;const t=3600*1e3,i=e.now(),a=Date.now(),c=e.timeOrigin?Math.abs(e.timeOrigin+i-a):t,d=c<t,m=e.timing&&e.timing.navigationStart,b=typeof m=="number"?Math.abs(m+i-a):t,w=b<t;return d||w?c<=b?e.timeOrigin:m:a})(),xy="baggage",o2="sentry-",C5=/^sentry-/,I5=8192;function k5(e){if(!Go(e)&&!Array.isArray(e))return;let t={};if(Array.isArray(e))t=e.reduce((a,c)=>{const d=iw(c);return{...a,...d}},{});else{if(!e)return;t=iw(e)}const i=Object.entries(t).reduce((a,[c,d])=>{if(c.match(C5)){const m=c.slice(o2.length);a[m]=d}return a},{});if(Object.keys(i).length>0)return i}function by(e){if(!e)return;const t=Object.entries(e).reduce((i,[a,c])=>(c&&(i[`${o2}${a}`]=c),i),{});return A5(t)}function iw(e){return e.split(",").map(t=>t.split("=").map(i=>decodeURIComponent(i.trim()))).reduce((t,[i,a])=>(t[i]=a,t),{})}function A5(e){if(Object.keys(e).length!==0)return Object.entries(e).reduce((t,[i,a],c)=>{const d=`${encodeURIComponent(i)}=${encodeURIComponent(a)}`,m=c===0?d:`${t},${d}`;return m.length>I5?((typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&at.warn(`Not adding key: ${i} with val: ${a} to baggage header due to exceeding baggage size limits.`),t):m},"")}const P5=new RegExp("^[ \\t]*([0-9a-f]{32})?-?([0-9a-f]{16})?-?([01])?[ \\t]*$");function R5(e){if(!e)return;const t=e.match(P5);if(!t)return;let i;return t[3]==="1"?i=!0:t[3]==="0"&&(i=!1),{traceId:t[1],parentSampled:i,parentSpanId:t[2]}}function M5(e,t){const i=R5(e),a=k5(t),{traceId:c,parentSpanId:d,parentSampled:m}=i||{},l={traceId:c||Fr(),spanId:Fr().substring(16),sampled:m===void 0?!1:m};return d&&(l.parentSpanId=d),a&&(l.dsc=a),{traceparentData:i,dynamicSamplingContext:a,propagationContext:l}}function Jv(e=Fr(),t=Fr().substring(16),i){let a="";return i!==void 0&&(a=i?"-1":"-0"),`${e}-${t}${a}`}function Cu(e,t=[]){return[e,t]}function D5(e,t){const[i,a]=e;return[i,[...a,t]]}function rw(e,t){const i=e[1];for(const a of i){const c=a[0].type;if(t(a,c))return!0}return!1}function wy(e,t){return(t||new TextEncoder).encode(e)}function L5(e,t){const[i,a]=e;let c=JSON.stringify(i);function d(m){typeof c=="string"?c=typeof m=="string"?c+m:[wy(c,t),m]:c.push(typeof m=="string"?wy(m,t):m)}for(const m of a){const[l,b]=m;if(d(`
${JSON.stringify(l)}
`),typeof b=="string"||b instanceof Uint8Array)d(b);else{let w;try{w=JSON.stringify(b)}catch{w=JSON.stringify(da(b))}d(w)}}return typeof c=="string"?c:z5(c)}function z5(e){const t=e.reduce((c,d)=>c+d.length,0),i=new Uint8Array(t);let a=0;for(const c of e)i.set(c,a),a+=c.length;return i}function O5(e,t){const i=typeof e.data=="string"?wy(e.data,t):e.data;return[ya({type:"attachment",length:i.length,filename:e.filename,content_type:e.contentType,attachment_type:e.attachmentType}),i]}const B5={session:"session",sessions:"session",attachment:"attachment",transaction:"transaction",event:"error",client_report:"internal",user_report:"default",profile:"profile",replay_event:"replay",replay_recording:"replay",check_in:"monitor"};function sw(e){return B5[e]}function Qv(e){if(!e||!e.sdk)return;const{name:t,version:i}=e.sdk;return{name:t,version:i}}function l2(e,t,i,a){const c=e.sdkProcessingMetadata&&e.sdkProcessingMetadata.dynamicSamplingContext;return{event_id:e.event_id,sent_at:new Date().toISOString(),...t&&{sdk:t},...!!i&&{dsn:Cm(a)},...c&&{trace:ya({...c})}}}function F5(e,t,i){const a=[{type:"client_report"},{timestamp:i||Im(),discarded_events:e}];return Cu(t?{dsn:t}:{},[a])}const N5=60*1e3;function U5(e,t=Date.now()){const i=parseInt(`${e}`,10);if(!isNaN(i))return i*1e3;const a=Date.parse(`${e}`);return isNaN(a)?N5:a-t}function $5(e,t){return e[t]||e.all||0}function V5(e,t,i=Date.now()){return $5(e,t)>i}function j5(e,{statusCode:t,headers:i},a=Date.now()){const c={...e},d=i&&i["x-sentry-rate-limits"],m=i&&i["retry-after"];if(d)for(const l of d.trim().split(",")){const[b,w]=l.split(":",2),C=parseInt(b,10),k=(isNaN(C)?60:C)*1e3;if(!w)c.all=a+k;else for(const M of w.split(";"))c[M]=a+k}else m?c.all=a+U5(m,a):t===429&&(c.all=a+60*1e3);return c}const e0="production";function G5(e){const t=Zo(),i={sid:Fr(),init:!0,timestamp:t,started:t,duration:0,status:"ok",errors:0,ignoreDuration:!1,toJSON:()=>H5(i)};return e&&iu(i,e),i}function iu(e,t={}){if(t.user&&(!e.ipAddress&&t.user.ip_address&&(e.ipAddress=t.user.ip_address),!e.did&&!t.did&&(e.did=t.user.id||t.user.email||t.user.username)),e.timestamp=t.timestamp||Zo(),t.ignoreDuration&&(e.ignoreDuration=t.ignoreDuration),t.sid&&(e.sid=t.sid.length===32?t.sid:Fr()),t.init!==void 0&&(e.init=t.init),!e.did&&t.did&&(e.did=`${t.did}`),typeof t.started=="number"&&(e.started=t.started),e.ignoreDuration)e.duration=void 0;else if(typeof t.duration=="number")e.duration=t.duration;else{const i=e.timestamp-e.started;e.duration=i>=0?i:0}t.release&&(e.release=t.release),t.environment&&(e.environment=t.environment),!e.ipAddress&&t.ipAddress&&(e.ipAddress=t.ipAddress),!e.userAgent&&t.userAgent&&(e.userAgent=t.userAgent),typeof t.errors=="number"&&(e.errors=t.errors),t.status&&(e.status=t.status)}function q5(e,t){let i={};t?i={status:t}:e.status==="ok"&&(i={status:"exited"}),iu(e,i)}function H5(e){return ya({sid:`${e.sid}`,init:e.init,started:new Date(e.started*1e3).toISOString(),timestamp:new Date(e.timestamp*1e3).toISOString(),status:e.status,errors:e.errors,did:typeof e.did=="number"||typeof e.did=="string"?`${e.did}`:void 0,duration:e.duration,attrs:{release:e.release,environment:e.environment,ip_address:e.ipAddress,user_agent:e.userAgent}})}const Z5=100;class Ml{constructor(){this._notifyingListeners=!1,this._scopeListeners=[],this._eventProcessors=[],this._breadcrumbs=[],this._attachments=[],this._user={},this._tags={},this._extra={},this._contexts={},this._sdkProcessingMetadata={},this._propagationContext=aw()}static clone(t){const i=new Ml;return t&&(i._breadcrumbs=[...t._breadcrumbs],i._tags={...t._tags},i._extra={...t._extra},i._contexts={...t._contexts},i._user=t._user,i._level=t._level,i._span=t._span,i._session=t._session,i._transactionName=t._transactionName,i._fingerprint=t._fingerprint,i._eventProcessors=[...t._eventProcessors],i._requestSession=t._requestSession,i._attachments=[...t._attachments],i._sdkProcessingMetadata={...t._sdkProcessingMetadata},i._propagationContext={...t._propagationContext}),i}addScopeListener(t){this._scopeListeners.push(t)}addEventProcessor(t){return this._eventProcessors.push(t),this}setUser(t){return this._user=t||{},this._session&&iu(this._session,{user:t}),this._notifyScopeListeners(),this}getUser(){return this._user}getRequestSession(){return this._requestSession}setRequestSession(t){return this._requestSession=t,this}setTags(t){return this._tags={...this._tags,...t},this._notifyScopeListeners(),this}setTag(t,i){return this._tags={...this._tags,[t]:i},this._notifyScopeListeners(),this}setExtras(t){return this._extra={...this._extra,...t},this._notifyScopeListeners(),this}setExtra(t,i){return this._extra={...this._extra,[t]:i},this._notifyScopeListeners(),this}setFingerprint(t){return this._fingerprint=t,this._notifyScopeListeners(),this}setLevel(t){return this._level=t,this._notifyScopeListeners(),this}setTransactionName(t){return this._transactionName=t,this._notifyScopeListeners(),this}setContext(t,i){return i===null?delete this._contexts[t]:this._contexts[t]=i,this._notifyScopeListeners(),this}setSpan(t){return this._span=t,this._notifyScopeListeners(),this}getSpan(){return this._span}getTransaction(){const t=this.getSpan();return t&&t.transaction}setSession(t){return t?this._session=t:delete this._session,this._notifyScopeListeners(),this}getSession(){return this._session}update(t){if(!t)return this;if(typeof t=="function"){const i=t(this);return i instanceof Ml?i:this}return t instanceof Ml?(this._tags={...this._tags,...t._tags},this._extra={...this._extra,...t._extra},this._contexts={...this._contexts,...t._contexts},t._user&&Object.keys(t._user).length&&(this._user=t._user),t._level&&(this._level=t._level),t._fingerprint&&(this._fingerprint=t._fingerprint),t._requestSession&&(this._requestSession=t._requestSession),t._propagationContext&&(this._propagationContext=t._propagationContext)):nu(t)&&(t=t,this._tags={...this._tags,...t.tags},this._extra={...this._extra,...t.extra},this._contexts={...this._contexts,...t.contexts},t.user&&(this._user=t.user),t.level&&(this._level=t.level),t.fingerprint&&(this._fingerprint=t.fingerprint),t.requestSession&&(this._requestSession=t.requestSession),t.propagationContext&&(this._propagationContext=t.propagationContext)),this}clear(){return this._breadcrumbs=[],this._tags={},this._extra={},this._user={},this._contexts={},this._level=void 0,this._transactionName=void 0,this._fingerprint=void 0,this._requestSession=void 0,this._span=void 0,this._session=void 0,this._notifyScopeListeners(),this._attachments=[],this._propagationContext=aw(),this}addBreadcrumb(t,i){const a=typeof i=="number"?i:Z5;if(a<=0)return this;const c={timestamp:Im(),...t};return this._breadcrumbs=[...this._breadcrumbs,c].slice(-a),this._notifyScopeListeners(),this}getLastBreadcrumb(){return this._breadcrumbs[this._breadcrumbs.length-1]}clearBreadcrumbs(){return this._breadcrumbs=[],this._notifyScopeListeners(),this}addAttachment(t){return this._attachments.push(t),this}getAttachments(){return this._attachments}clearAttachments(){return this._attachments=[],this}applyToEvent(t,i={}){if(this._extra&&Object.keys(this._extra).length&&(t.extra={...this._extra,...t.extra}),this._tags&&Object.keys(this._tags).length&&(t.tags={...this._tags,...t.tags}),this._user&&Object.keys(this._user).length&&(t.user={...this._user,...t.user}),this._contexts&&Object.keys(this._contexts).length&&(t.contexts={...this._contexts,...t.contexts}),this._level&&(t.level=this._level),this._transactionName&&(t.transaction=this._transactionName),this._span){t.contexts={trace:this._span.getTraceContext(),...t.contexts};const a=this._span.transaction;if(a){t.sdkProcessingMetadata={dynamicSamplingContext:a.getDynamicSamplingContext(),...t.sdkProcessingMetadata};const c=a.name;c&&(t.tags={transaction:c,...t.tags})}}return this._applyFingerprint(t),t.breadcrumbs=[...t.breadcrumbs||[],...this._breadcrumbs],t.breadcrumbs=t.breadcrumbs.length>0?t.breadcrumbs:void 0,t.sdkProcessingMetadata={...t.sdkProcessingMetadata,...this._sdkProcessingMetadata,propagationContext:this._propagationContext},this._notifyEventProcessors([...c2(),...this._eventProcessors],t,i)}setSDKProcessingMetadata(t){return this._sdkProcessingMetadata={...this._sdkProcessingMetadata,...t},this}setPropagationContext(t){return this._propagationContext=t,this}getPropagationContext(){return this._propagationContext}_notifyEventProcessors(t,i,a,c=0){return new us((d,m)=>{const l=t[c];if(i===null||typeof l!="function")d(i);else{const b=l({...i},a);(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&l.id&&b===null&&at.log(`Event processor "${l.id}" dropped event`),Zv(b)?b.then(w=>this._notifyEventProcessors(t,w,a,c+1).then(d)).then(null,m):this._notifyEventProcessors(t,b,a,c+1).then(d).then(null,m)}})}_notifyScopeListeners(){this._notifyingListeners||(this._notifyingListeners=!0,this._scopeListeners.forEach(t=>{t(this)}),this._notifyingListeners=!1)}_applyFingerprint(t){t.fingerprint=t.fingerprint?Kv(t.fingerprint):[],this._fingerprint&&(t.fingerprint=t.fingerprint.concat(this._fingerprint)),t.fingerprint&&!t.fingerprint.length&&delete t.fingerprint}}function c2(){return Wv("globalEventProcessors",()=>[])}function t0(e){c2().push(e)}function aw(){return{traceId:Fr(),spanId:Fr().substring(16),sampled:!1}}const u2=4,W5=100;class h2{constructor(t,i=new Ml,a=u2){this._version=a,this._stack=[{scope:i}],t&&this.bindClient(t)}isOlderThan(t){return this._version<t}bindClient(t){const i=this.getStackTop();i.client=t,t&&t.setupIntegrations&&t.setupIntegrations()}pushScope(){const t=Ml.clone(this.getScope());return this.getStack().push({client:this.getClient(),scope:t}),t}popScope(){return this.getStack().length<=1?!1:!!this.getStack().pop()}withScope(t){const i=this.pushScope();try{t(i)}finally{this.popScope()}}getClient(){return this.getStackTop().client}getScope(){return this.getStackTop().scope}getStack(){return this._stack}getStackTop(){return this._stack[this._stack.length-1]}captureException(t,i){const a=this._lastEventId=i&&i.event_id?i.event_id:Fr(),c=new Error("Sentry syntheticException");return this._withClient((d,m)=>{d.captureException(t,{originalException:t,syntheticException:c,...i,event_id:a},m)}),a}captureMessage(t,i,a){const c=this._lastEventId=a&&a.event_id?a.event_id:Fr(),d=new Error(t);return this._withClient((m,l)=>{m.captureMessage(t,i,{originalException:t,syntheticException:d,...a,event_id:c},l)}),c}captureEvent(t,i){const a=i&&i.event_id?i.event_id:Fr();return t.type||(this._lastEventId=a),this._withClient((c,d)=>{c.captureEvent(t,{...i,event_id:a},d)}),a}lastEventId(){return this._lastEventId}addBreadcrumb(t,i){const{scope:a,client:c}=this.getStackTop();if(!c)return;const{beforeBreadcrumb:d=null,maxBreadcrumbs:m=W5}=c.getOptions&&c.getOptions()||{};if(m<=0)return;const b={timestamp:Im(),...t},w=d?XT(()=>d(b,i)):b;w!==null&&(c.emit&&c.emit("beforeAddBreadcrumb",w,i),a.addBreadcrumb(w,m))}setUser(t){this.getScope().setUser(t)}setTags(t){this.getScope().setTags(t)}setExtras(t){this.getScope().setExtras(t)}setTag(t,i){this.getScope().setTag(t,i)}setExtra(t,i){this.getScope().setExtra(t,i)}setContext(t,i){this.getScope().setContext(t,i)}configureScope(t){const{scope:i,client:a}=this.getStackTop();a&&t(i)}run(t){const i=ow(this);try{t(this)}finally{ow(i)}}getIntegration(t){const i=this.getClient();if(!i)return null;try{return i.getIntegration(t)}catch{return(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&at.warn(`Cannot retrieve integration ${t.id} from the current Hub`),null}}startTransaction(t,i){const a=this._callExtensionMethod("startTransaction",t,i);return(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&!a&&console.warn(`Tracing extension 'startTransaction' has not been added. Call 'addTracingExtensions' before calling 'init':
Sentry.addTracingExtensions();
Sentry.init({...});
`),a}traceHeaders(){return this._callExtensionMethod("traceHeaders")}captureSession(t=!1){if(t)return this.endSession();this._sendSessionUpdate()}endSession(){const i=this.getStackTop().scope,a=i.getSession();a&&q5(a),this._sendSessionUpdate(),i.setSession()}startSession(t){const{scope:i,client:a}=this.getStackTop(),{release:c,environment:d=e0}=a&&a.getOptions()||{},{userAgent:m}=Br.navigator||{},l=G5({release:c,environment:d,user:i.getUser(),...m&&{userAgent:m},...t}),b=i.getSession&&i.getSession();return b&&b.status==="ok"&&iu(b,{status:"exited"}),this.endSession(),i.setSession(l),l}shouldSendDefaultPii(){const t=this.getClient(),i=t&&t.getOptions();return!!(i&&i.sendDefaultPii)}_sendSessionUpdate(){const{scope:t,client:i}=this.getStackTop(),a=t.getSession();a&&i&&i.captureSession&&i.captureSession(a)}_withClient(t){const{scope:i,client:a}=this.getStackTop();a&&t(a,i)}_callExtensionMethod(t,...i){const c=Ad().__SENTRY__;if(c&&c.extensions&&typeof c.extensions[t]=="function")return c.extensions[t].apply(this,i);(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&at.warn(`Extension method ${t} couldn't be found, doing nothing.`)}}function Ad(){return Br.__SENTRY__=Br.__SENTRY__||{extensions:{},hub:void 0},Br}function ow(e){const t=Ad(),i=Sy(t);return d2(t,e),i}function vn(){const e=Ad();if(e.__SENTRY__&&e.__SENTRY__.acs){const t=e.__SENTRY__.acs.getCurrentHub();if(t)return t}return Y5(e)}function Y5(e=Ad()){return(!X5(e)||Sy(e).isOlderThan(u2))&&d2(e,new h2),Sy(e)}function X5(e){return!!(e&&e.__SENTRY__&&e.__SENTRY__.hub)}function Sy(e){return Wv("hub",()=>new h2,e)}function d2(e,t){if(!e)return!1;const i=e.__SENTRY__=e.__SENTRY__||{};return i.hub=t,!0}function km(e){if(typeof __SENTRY_TRACING__=="boolean"&&!__SENTRY_TRACING__)return!1;const t=vn().getClient(),i=e||t&&t.getOptions();return!!i&&(i.enableTracing||"tracesSampleRate"in i||"tracesSampler"in i)}function Pd(e){return(e||vn()).getScope().getTransaction()}let lw=!1;function K5(){lw||(lw=!0,ur("error",Ey),ur("unhandledrejection",Ey))}function Ey(){const e=Pd();if(e){const t="internal_error";(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&at.log(`[Tracing] Transaction: ${t} -> Global error occured`),e.setStatus(t)}}Ey.tag="sentry_tracingErrorCallback";class f2{constructor(t=1e3){this._maxlen=t,this.spans=[]}add(t){this.spans.length>this._maxlen?t.spanRecorder=void 0:this.spans.push(t)}}class n0{constructor(t){if(this.traceId=Fr(),this.spanId=Fr().substring(16),this.startTimestamp=Zo(),this.tags={},this.data={},this.instrumenter="sentry",!t)return this;t.traceId&&(this.traceId=t.traceId),t.spanId&&(this.spanId=t.spanId),t.parentSpanId&&(this.parentSpanId=t.parentSpanId),"sampled"in t&&(this.sampled=t.sampled),t.op&&(this.op=t.op),t.description&&(this.description=t.description),t.name&&(this.description=t.name),t.data&&(this.data=t.data),t.tags&&(this.tags=t.tags),t.status&&(this.status=t.status),t.startTimestamp&&(this.startTimestamp=t.startTimestamp),t.endTimestamp&&(this.endTimestamp=t.endTimestamp),t.instrumenter&&(this.instrumenter=t.instrumenter)}startChild(t){const i=new n0({...t,parentSpanId:this.spanId,sampled:this.sampled,traceId:this.traceId});if(i.spanRecorder=this.spanRecorder,i.spanRecorder&&i.spanRecorder.add(i),i.transaction=this.transaction,(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&i.transaction){const a=t&&t.op||"< unknown op >",c=i.transaction.name||"< unknown name >",d=i.transaction.spanId,m=`[Tracing] Starting '${a}' span on transaction '${c}' (${d}).`;i.transaction.metadata.spanMetadata[i.spanId]={logMessage:m},at.log(m)}return i}setTag(t,i){return this.tags={...this.tags,[t]:i},this}setData(t,i){return this.data={...this.data,[t]:i},this}setStatus(t){return this.status=t,this}setHttpStatus(t){this.setTag("http.status_code",String(t)),this.setData("http.response.status_code",t);const i=J5(t);return i!=="unknown_error"&&this.setStatus(i),this}setName(t){this.description=t}isSuccess(){return this.status==="ok"}finish(t){if((typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&this.transaction&&this.transaction.spanId!==this.spanId){const{logMessage:i}=this.transaction.metadata.spanMetadata[this.spanId];i&&at.log(i.replace("Starting","Finishing"))}this.endTimestamp=typeof t=="number"?t:Zo()}toTraceparent(){return Jv(this.traceId,this.spanId,this.sampled)}toContext(){return ya({data:this.data,description:this.description,endTimestamp:this.endTimestamp,op:this.op,parentSpanId:this.parentSpanId,sampled:this.sampled,spanId:this.spanId,startTimestamp:this.startTimestamp,status:this.status,tags:this.tags,traceId:this.traceId})}updateWithContext(t){return this.data=t.data||{},this.description=t.description,this.endTimestamp=t.endTimestamp,this.op=t.op,this.parentSpanId=t.parentSpanId,this.sampled=t.sampled,this.spanId=t.spanId||this.spanId,this.startTimestamp=t.startTimestamp||this.startTimestamp,this.status=t.status,this.tags=t.tags||{},this.traceId=t.traceId||this.traceId,this}getTraceContext(){return ya({data:Object.keys(this.data).length>0?this.data:void 0,description:this.description,op:this.op,parent_span_id:this.parentSpanId,span_id:this.spanId,status:this.status,tags:Object.keys(this.tags).length>0?this.tags:void 0,trace_id:this.traceId})}toJSON(){return ya({data:Object.keys(this.data).length>0?this.data:void 0,description:this.description,op:this.op,parent_span_id:this.parentSpanId,span_id:this.spanId,start_timestamp:this.startTimestamp,status:this.status,tags:Object.keys(this.tags).length>0?this.tags:void 0,timestamp:this.endTimestamp,trace_id:this.traceId})}}function J5(e){if(e<400&&e>=100)return"ok";if(e>=400&&e<500)switch(e){case 401:return"unauthenticated";case 403:return"permission_denied";case 404:return"not_found";case 409:return"already_exists";case 413:return"failed_precondition";case 429:return"resource_exhausted";default:return"invalid_argument"}if(e>=500&&e<600)switch(e){case 501:return"unimplemented";case 503:return"unavailable";case 504:return"deadline_exceeded";default:return"internal_error"}return"unknown_error"}function Am(e,t,i){const a=t.getOptions(),{publicKey:c}=t.getDsn()||{},{segment:d}=i&&i.getUser()||{},m=ya({environment:a.environment||e0,release:a.release,user_segment:d,public_key:c,trace_id:e});return t.emit&&t.emit("createDsc",m),m}class p2 extends n0{constructor(t,i){super(t),delete this.description,this._measurements={},this._contexts={},this._hub=i||vn(),this._name=t.name||"",this.metadata={source:"custom",...t.metadata,spanMetadata:{}},this._trimEnd=t.trimEnd,this.transaction=this;const a=this.metadata.dynamicSamplingContext;a&&(this._frozenDynamicSamplingContext={...a})}get name(){return this._name}set name(t){this.setName(t)}setName(t,i="custom"){this._name=t,this.metadata.source=i}initSpanRecorder(t=1e3){this.spanRecorder||(this.spanRecorder=new f2(t)),this.spanRecorder.add(this)}setContext(t,i){i===null?delete this._contexts[t]:this._contexts[t]=i}setMeasurement(t,i,a=""){this._measurements[t]={value:i,unit:a}}setMetadata(t){this.metadata={...this.metadata,...t}}finish(t){if(this.endTimestamp!==void 0)return;this.name||((typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&at.warn("Transaction has no name, falling back to `<unlabeled transaction>`."),this.name="<unlabeled transaction>"),super.finish(t);const i=this._hub.getClient();if(i&&i.emit&&i.emit("finishTransaction",this),this.sampled!==!0){(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&at.log("[Tracing] Discarding transaction because its trace was not chosen to be sampled."),i&&i.recordDroppedEvent("sample_rate","transaction");return}const a=this.spanRecorder?this.spanRecorder.spans.filter(l=>l!==this&&l.endTimestamp):[];this._trimEnd&&a.length>0&&(this.endTimestamp=a.reduce((l,b)=>l.endTimestamp&&b.endTimestamp?l.endTimestamp>b.endTimestamp?l:b:l).endTimestamp);const c=this.metadata,d={contexts:{...this._contexts,trace:this.getTraceContext()},spans:a,start_timestamp:this.startTimestamp,tags:this.tags,timestamp:this.endTimestamp,transaction:this.name,type:"transaction",sdkProcessingMetadata:{...c,dynamicSamplingContext:this.getDynamicSamplingContext()},...c.source&&{transaction_info:{source:c.source}}};return Object.keys(this._measurements).length>0&&((typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&at.log("[Measurements] Adding measurements to transaction",JSON.stringify(this._measurements,void 0,2)),d.measurements=this._measurements),(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&at.log(`[Tracing] Finishing ${this.op} transaction: ${this.name}.`),this._hub.captureEvent(d)}toContext(){const t=super.toContext();return ya({...t,name:this.name,trimEnd:this._trimEnd})}updateWithContext(t){return super.updateWithContext(t),this.name=t.name||"",this._trimEnd=t.trimEnd,this}getDynamicSamplingContext(){if(this._frozenDynamicSamplingContext)return this._frozenDynamicSamplingContext;const t=this._hub||vn(),i=t.getClient();if(!i)return{};const a=t.getScope(),c=Am(this.traceId,i,a),d=this.metadata.sampleRate;d!==void 0&&(c.sample_rate=`${d}`);const m=this.metadata.source;return m&&m!=="url"&&(c.transaction=this.name),this.sampled!==void 0&&(c.sampled=String(this.sampled)),c}setHub(t){this._hub=t}}const _p={idleTimeout:1e3,finalTimeout:3e4,heartbeatInterval:5e3},Q5="finishReason",Bc=["heartbeatFailed","idleTimeout","documentHidden","finalTimeout","externalFinish","cancelled"];class eN extends f2{constructor(t,i,a,c){super(c),this._pushActivity=t,this._popActivity=i,this.transactionSpanId=a}add(t){t.spanId!==this.transactionSpanId&&(t.finish=i=>{t.endTimestamp=typeof i=="number"?i:Zo(),this._popActivity(t.spanId)},t.endTimestamp===void 0&&this._pushActivity(t.spanId)),super.add(t)}}class tN extends p2{constructor(t,i,a=_p.idleTimeout,c=_p.finalTimeout,d=_p.heartbeatInterval,m=!1){super(t,i),this._idleHub=i,this._idleTimeout=a,this._finalTimeout=c,this._heartbeatInterval=d,this._onScope=m,this.activities={},this._heartbeatCounter=0,this._finished=!1,this._idleTimeoutCanceledPermanently=!1,this._beforeFinishCallbacks=[],this._finishReason=Bc[4],m&&((typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&at.log(`Setting idle transaction on scope. Span ID: ${this.spanId}`),i.configureScope(l=>l.setSpan(this))),this._restartIdleTimeout(),setTimeout(()=>{this._finished||(this.setStatus("deadline_exceeded"),this._finishReason=Bc[3],this.finish())},this._finalTimeout)}finish(t=Zo()){if(this._finished=!0,this.activities={},this.op==="ui.action.click"&&this.setTag(Q5,this._finishReason),this.spanRecorder){(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&at.log("[Tracing] finishing IdleTransaction",new Date(t*1e3).toISOString(),this.op);for(const i of this._beforeFinishCallbacks)i(this,t);this.spanRecorder.spans=this.spanRecorder.spans.filter(i=>{if(i.spanId===this.spanId)return!0;i.endTimestamp||(i.endTimestamp=t,i.setStatus("cancelled"),(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&at.log("[Tracing] cancelling span since transaction ended early",JSON.stringify(i,void 0,2)));const a=i.startTimestamp<t,c=(this._finalTimeout+this._idleTimeout)/1e3,d=i.endTimestamp-this.startTimestamp<c;if(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__){const m=JSON.stringify(i,void 0,2);a?d||at.log("[Tracing] discarding Span since it finished after Transaction final timeout",m):at.log("[Tracing] discarding Span since it happened after Transaction was finished",m)}return a&&d}),(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&at.log("[Tracing] flushing IdleTransaction")}else(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&at.log("[Tracing] No active IdleTransaction");if(this._onScope){const i=this._idleHub.getScope();i.getTransaction()===this&&i.setSpan(void 0)}return super.finish(t)}registerBeforeFinishCallback(t){this._beforeFinishCallbacks.push(t)}initSpanRecorder(t){if(!this.spanRecorder){const i=c=>{this._finished||this._pushActivity(c)},a=c=>{this._finished||this._popActivity(c)};this.spanRecorder=new eN(i,a,this.spanId,t),(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&at.log("Starting heartbeat"),this._pingHeartbeat()}this.spanRecorder.add(this)}cancelIdleTimeout(t,{restartOnChildSpanChange:i}={restartOnChildSpanChange:!0}){this._idleTimeoutCanceledPermanently=i===!1,this._idleTimeoutID&&(clearTimeout(this._idleTimeoutID),this._idleTimeoutID=void 0,Object.keys(this.activities).length===0&&this._idleTimeoutCanceledPermanently&&(this._finishReason=Bc[5],this.finish(t)))}setFinishReason(t){this._finishReason=t}_restartIdleTimeout(t){this.cancelIdleTimeout(),this._idleTimeoutID=setTimeout(()=>{!this._finished&&Object.keys(this.activities).length===0&&(this._finishReason=Bc[1],this.finish(t))},this._idleTimeout)}_pushActivity(t){this.cancelIdleTimeout(void 0,{restartOnChildSpanChange:!this._idleTimeoutCanceledPermanently}),(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&at.log(`[Tracing] pushActivity: ${t}`),this.activities[t]=!0,(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&at.log("[Tracing] new activities count",Object.keys(this.activities).length)}_popActivity(t){if(this.activities[t]&&((typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&at.log(`[Tracing] popActivity ${t}`),delete this.activities[t],(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&at.log("[Tracing] new activities count",Object.keys(this.activities).length)),Object.keys(this.activities).length===0){const i=Zo();this._idleTimeoutCanceledPermanently?(this._finishReason=Bc[5],this.finish(i)):this._restartIdleTimeout(i+this._idleTimeout/1e3)}}_beat(){if(this._finished)return;const t=Object.keys(this.activities).join("");t===this._prevHeartbeatString?this._heartbeatCounter++:this._heartbeatCounter=1,this._prevHeartbeatString=t,this._heartbeatCounter>=3?((typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&at.log("[Tracing] Transaction finished because of no change for 3 heart beats"),this.setStatus("deadline_exceeded"),this._finishReason=Bc[0],this.finish()):this._pingHeartbeat()}_pingHeartbeat(){(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&at.log(`pinging Heartbeat -> current counter: ${this._heartbeatCounter}`),setTimeout(()=>{this._beat()},this._heartbeatInterval)}}function nN(){const t=this.getScope().getSpan();return t?{"sentry-trace":t.toTraceparent()}:{}}function m2(e,t,i){if(!km(t))return e.sampled=!1,e;if(e.sampled!==void 0)return e.setMetadata({sampleRate:Number(e.sampled)}),e;let a;return typeof t.tracesSampler=="function"?(a=t.tracesSampler(i),e.setMetadata({sampleRate:Number(a)})):i.parentSampled!==void 0?a=i.parentSampled:typeof t.tracesSampleRate<"u"?(a=t.tracesSampleRate,e.setMetadata({sampleRate:Number(a)})):(a=1,e.setMetadata({sampleRate:a})),iN(a)?a?(e.sampled=Math.random()<a,e.sampled?((typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&at.log(`[Tracing] starting ${e.op} transaction - ${e.name}`),e):((typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&at.log(`[Tracing] Discarding transaction because it's not included in the random sample (sampling rate = ${Number(a)})`),e)):((typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&at.log(`[Tracing] Discarding transaction because ${typeof t.tracesSampler=="function"?"tracesSampler returned 0 or false":"a negative sampling decision was inherited or tracesSampleRate is set to 0"}`),e.sampled=!1,e):((typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&at.warn("[Tracing] Discarding transaction because of invalid sample rate."),e.sampled=!1,e)}function iN(e){return YT(e)||!(typeof e=="number"||typeof e=="boolean")?((typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&at.warn(`[Tracing] Given sample rate is invalid. Sample rate must be a boolean or a number between 0 and 1. Got ${JSON.stringify(e)} of type ${JSON.stringify(typeof e)}.`),!1):e<0||e>1?((typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&at.warn(`[Tracing] Given sample rate is invalid. Sample rate must be between 0 and 1. Got ${e}.`),!1):!0}function rN(e,t){const i=this.getClient(),a=i&&i.getOptions()||{},c=a.instrumenter||"sentry",d=e.instrumenter||"sentry";c!==d&&((typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&at.error(`A transaction was started with instrumenter=\`${d}\`, but the SDK is configured with the \`${c}\` instrumenter.
The transaction will not be sampled. Please use the ${c} instrumentation to start transactions.`),e.sampled=!1);let m=new p2(e,this);return m=m2(m,a,{parentSampled:e.parentSampled,transactionContext:e,...t}),m.sampled&&m.initSpanRecorder(a._experiments&&a._experiments.maxSpans),i&&i.emit&&i.emit("startTransaction",m),m}function cw(e,t,i,a,c,d,m){const l=e.getClient(),b=l&&l.getOptions()||{};let w=new tN(t,e,i,a,m,c);return w=m2(w,b,{parentSampled:t.parentSampled,transactionContext:t,...d}),w.sampled&&w.initSpanRecorder(b._experiments&&b._experiments.maxSpans),l&&l.emit&&l.emit("startTransaction",w),w}function sN(){const e=Ad();e.__SENTRY__&&(e.__SENTRY__.extensions=e.__SENTRY__.extensions||{},e.__SENTRY__.extensions.startTransaction||(e.__SENTRY__.extensions.startTransaction=rN),e.__SENTRY__.extensions.traceHeaders||(e.__SENTRY__.extensions.traceHeaders=nN),K5())}function Pm(e,t){return vn().captureException(e,{captureContext:t})}function aN(e,t){vn().setContext(e,t)}function oN(e){vn().withScope(e)}const lN="7";function cN(e){const t=e.protocol?`${e.protocol}:`:"",i=e.port?`:${e.port}`:"";return`${t}//${e.host}${i}${e.path?`/${e.path}`:""}/api/`}function uN(e){return`${cN(e)}${e.projectId}/envelope/`}function hN(e,t){return YF({sentry_key:e.publicKey,sentry_version:lN,...t&&{sentry_client:`${t.name}/${t.version}`}})}function dN(e,t={}){const i=typeof t=="string"?t:t.tunnel,a=typeof t=="string"||!t._metadata?void 0:t._metadata.sdk;return i||`${uN(e)}?${hN(e,a)}`}function fN(e,t){return t&&(e.sdk=e.sdk||{},e.sdk.name=e.sdk.name||t.name,e.sdk.version=e.sdk.version||t.version,e.sdk.integrations=[...e.sdk.integrations||[],...t.integrations||[]],e.sdk.packages=[...e.sdk.packages||[],...t.packages||[]]),e}function pN(e,t,i,a){const c=Qv(i),d={sent_at:new Date().toISOString(),...c&&{sdk:c},...!!a&&{dsn:Cm(t)}},m="aggregates"in e?[{type:"sessions"},e]:[{type:"session"},e.toJSON()];return Cu(d,[m])}function mN(e,t,i,a){const c=Qv(i),d=e.type&&e.type!=="replay_event"?e.type:"event";fN(e,i&&i.sdk);const m=l2(e,c,a,t);return delete e.sdkProcessingMetadata,Cu(m,[[{type:d},e]])}const uw=[];function gN(e){const t={};return e.forEach(i=>{const{name:a}=i,c=t[a];c&&!c.isDefaultInstance&&i.isDefaultInstance||(t[a]=i)}),Object.keys(t).map(i=>t[i])}function _N(e){const t=e.defaultIntegrations||[],i=e.integrations;t.forEach(m=>{m.isDefaultInstance=!0});let a;Array.isArray(i)?a=[...t,...i]:typeof i=="function"?a=Kv(i(t)):a=t;const c=gN(a),d=vN(c,m=>m.name==="Debug");if(d!==-1){const[m]=c.splice(d,1);c.push(m)}return c}function yN(e){const t={};return e.forEach(i=>{i&&g2(i,t)}),t}function g2(e,t){t[e.name]=e,uw.indexOf(e.name)===-1&&(e.setupOnce(t0,vn),uw.push(e.name),(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&at.log(`Integration installed: ${e.name}`))}function vN(e,t){for(let i=0;i<e.length;i++)if(t(e[i])===!0)return i;return-1}function _2(e,t,i,a){const{normalizeDepth:c=3,normalizeMaxBreadth:d=1e3}=e,m={...t,event_id:t.event_id||i.event_id||Fr(),timestamp:t.timestamp||Im()},l=i.integrations||e.integrations.map(C=>C.name);xN(m,e),SN(m,l),t.type===void 0&&bN(m,e.stackParser);let b=a;i.captureContext&&(b=Ml.clone(b).update(i.captureContext));let w=Ol(m);if(b){if(b.getAttachments){const C=[...i.attachments||[],...b.getAttachments()];C.length&&(i.attachments=C)}w=b.applyToEvent(m,i)}return w.then(C=>(C&&wN(C),typeof c=="number"&&c>0?EN(C,c,d):C))}function xN(e,t){const{environment:i,release:a,dist:c,maxValueLength:d=250}=t;"environment"in e||(e.environment="environment"in t?i:e0),e.release===void 0&&a!==void 0&&(e.release=a),e.dist===void 0&&c!==void 0&&(e.dist=c),e.message&&(e.message=Xc(e.message,d));const m=e.exception&&e.exception.values&&e.exception.values[0];m&&m.value&&(m.value=Xc(m.value,d));const l=e.request;l&&l.url&&(l.url=Xc(l.url,d))}const hw=new WeakMap;function bN(e,t){const i=Br._sentryDebugIds;if(!i)return;let a;const c=hw.get(t);c?a=c:(a=new Map,hw.set(t,a));const d=Object.keys(i).reduce((m,l)=>{let b;const w=a.get(l);w?b=w:(b=t(l),a.set(l,b));for(let C=b.length-1;C>=0;C--){const k=b[C];if(k.filename){m[k.filename]=i[l];break}}return m},{});try{e.exception.values.forEach(m=>{m.stacktrace.frames.forEach(l=>{l.filename&&(l.debug_id=d[l.filename])})})}catch{}}function wN(e){const t={};try{e.exception.values.forEach(a=>{a.stacktrace.frames.forEach(c=>{c.debug_id&&(c.abs_path?t[c.abs_path]=c.debug_id:c.filename&&(t[c.filename]=c.debug_id),delete c.debug_id)})})}catch{}if(Object.keys(t).length===0)return;e.debug_meta=e.debug_meta||{},e.debug_meta.images=e.debug_meta.images||[];const i=e.debug_meta.images;Object.keys(t).forEach(a=>{i.push({type:"sourcemap",code_file:a,debug_id:t[a]})})}function SN(e,t){t.length>0&&(e.sdk=e.sdk||{},e.sdk.integrations=[...e.sdk.integrations||[],...t])}function EN(e,t,i){if(!e)return null;const a={...e,...e.breadcrumbs&&{breadcrumbs:e.breadcrumbs.map(c=>({...c,...c.data&&{data:da(c.data,t,i)}}))},...e.user&&{user:da(e.user,t,i)},...e.contexts&&{contexts:da(e.contexts,t,i)},...e.extra&&{extra:da(e.extra,t,i)}};return e.contexts&&e.contexts.trace&&a.contexts&&(a.contexts.trace=e.contexts.trace,e.contexts.trace.data&&(a.contexts.trace.data=da(e.contexts.trace.data,t,i))),e.spans&&(a.spans=e.spans.map(c=>(c.data&&(c.data=da(c.data,t,i)),c))),a}const dw="Not capturing exception because it's already been captured.";class TN{constructor(t){if(this._options=t,this._integrations={},this._integrationsInitialized=!1,this._numProcessing=0,this._outcomes={},this._hooks={},t.dsn?this._dsn=WF(t.dsn):(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&at.warn("No DSN provided, client will not do anything."),this._dsn){const i=dN(this._dsn,t);this._transport=t.transport({recordDroppedEvent:this.recordDroppedEvent.bind(this),...t.transportOptions,url:i})}}captureException(t,i,a){if(tw(t)){(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&at.log(dw);return}let c=i&&i.event_id;return this._process(this.eventFromException(t,i).then(d=>this._captureEvent(d,i,a)).then(d=>{c=d})),c}captureMessage(t,i,a,c){let d=a&&a.event_id;const m=WT(t)?this.eventFromMessage(String(t),i,a):this.eventFromException(t,a);return this._process(m.then(l=>this._captureEvent(l,a,c)).then(l=>{d=l})),d}captureEvent(t,i,a){if(i&&i.originalException&&tw(i.originalException)){(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&at.log(dw);return}let c=i&&i.event_id;return this._process(this._captureEvent(t,i,a).then(d=>{c=d})),c}captureSession(t){if(!this._isEnabled()){(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&at.warn("SDK not enabled, will not capture session.");return}typeof t.release!="string"?(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&at.warn("Discarded session because of missing or non-string release"):(this.sendSession(t),iu(t,{init:!1}))}getDsn(){return this._dsn}getOptions(){return this._options}getSdkMetadata(){return this._options._metadata}getTransport(){return this._transport}flush(t){const i=this._transport;return i?this._isClientDoneProcessing(t).then(a=>i.flush(t).then(c=>a&&c)):Ol(!0)}close(t){return this.flush(t).then(i=>(this.getOptions().enabled=!1,i))}setupIntegrations(){this._isEnabled()&&!this._integrationsInitialized&&(this._integrations=yN(this._options.integrations),this._integrationsInitialized=!0)}getIntegrationById(t){return this._integrations[t]}getIntegration(t){try{return this._integrations[t.id]||null}catch{return(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&at.warn(`Cannot retrieve integration ${t.id} from the current Client`),null}}addIntegration(t){g2(t,this._integrations)}sendEvent(t,i={}){if(this._dsn){let a=mN(t,this._dsn,this._options._metadata,this._options.tunnel);for(const d of i.attachments||[])a=D5(a,O5(d,this._options.transportOptions&&this._options.transportOptions.textEncoder));const c=this._sendEnvelope(a);c&&c.then(d=>this.emit("afterSendEvent",t,d),null)}}sendSession(t){if(this._dsn){const i=pN(t,this._dsn,this._options._metadata,this._options.tunnel);this._sendEnvelope(i)}}recordDroppedEvent(t,i,a){if(this._options.sendClientReports){const c=`${t}:${i}`;(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&at.log(`Adding outcome: "${c}"`),this._outcomes[c]=this._outcomes[c]+1||1}}on(t,i){this._hooks[t]||(this._hooks[t]=[]),this._hooks[t].push(i)}emit(t,...i){this._hooks[t]&&this._hooks[t].forEach(a=>a(...i))}_updateSessionFromEvent(t,i){let a=!1,c=!1;const d=i.exception&&i.exception.values;if(d){c=!0;for(const b of d){const w=b.mechanism;if(w&&w.handled===!1){a=!0;break}}}const m=t.status==="ok";(m&&t.errors===0||m&&a)&&(iu(t,{...a&&{status:"crashed"},errors:t.errors||Number(c||a)}),this.captureSession(t))}_isClientDoneProcessing(t){return new us(i=>{let a=0;const c=1,d=setInterval(()=>{this._numProcessing==0?(clearInterval(d),i(!0)):(a+=c,t&&a>=t&&(clearInterval(d),i(!1)))},c)})}_isEnabled(){return this.getOptions().enabled!==!1&&this._dsn!==void 0}_prepareEvent(t,i,a){const c=this.getOptions(),d=Object.keys(this._integrations);return!i.integrations&&d.length>0&&(i.integrations=d),_2(c,t,i,a).then(m=>{if(m===null)return m;const{propagationContext:l}=m.sdkProcessingMetadata||{};if(!(m.contexts&&m.contexts.trace)&&l){const{traceId:w,spanId:C,parentSpanId:k,dsc:M}=l;m.contexts={trace:{trace_id:w,span_id:C,parent_span_id:k},...m.contexts};const O=M||Am(w,this,a);m.sdkProcessingMetadata={dynamicSamplingContext:O,...m.sdkProcessingMetadata}}return m})}_captureEvent(t,i={},a){return this._processEvent(t,i,a).then(c=>c.event_id,c=>{if(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__){const d=c;d.logLevel==="log"?at.log(d.message):at.warn(d)}})}_processEvent(t,i,a){const c=this.getOptions(),{sampleRate:d}=c;if(!this._isEnabled())return Gp(new Ns("SDK not enabled, will not capture event.","log"));const m=v2(t),l=y2(t),b=t.type||"error",w=`before send for type \`${b}\``;if(l&&typeof d=="number"&&Math.random()>d)return this.recordDroppedEvent("sample_rate","error",t),Gp(new Ns(`Discarding event because it's not included in the random sample (sampling rate = ${d})`,"log"));const C=b==="replay_event"?"replay":b;return this._prepareEvent(t,i,a).then(k=>{if(k===null)throw this.recordDroppedEvent("event_processor",C,t),new Ns("An event processor returned `null`, will not send event.","log");if(i.data&&i.data.__sentry__===!0)return k;const O=IN(c,k,i);return CN(O,w)}).then(k=>{if(k===null)throw this.recordDroppedEvent("before_send",C,t),new Ns(`${w} returned \`null\`, will not send event.`,"log");const M=a&&a.getSession();!m&&M&&this._updateSessionFromEvent(M,k);const O=k.transaction_info;if(m&&O&&k.transaction!==t.transaction){const j="custom";k.transaction_info={...O,source:j}}return this.sendEvent(k,i),k}).then(null,k=>{throw k instanceof Ns?k:(this.captureException(k,{data:{__sentry__:!0},originalException:k}),new Ns(`Event processing pipeline threw an error, original event will not be sent. Details have been sent as a new event.
Reason: ${k}`))})}_process(t){this._numProcessing++,t.then(i=>(this._numProcessing--,i),i=>(this._numProcessing--,i))}_sendEnvelope(t){if(this._transport&&this._dsn)return this.emit("beforeEnvelope",t),this._transport.send(t).then(null,i=>{(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&at.error("Error while sending event:",i)});(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&at.error("Transport disabled")}_clearOutcomes(){const t=this._outcomes;return this._outcomes={},Object.keys(t).map(i=>{const[a,c]=i.split(":");return{reason:a,category:c,quantity:t[i]}})}}function CN(e,t){const i=`${t} must return \`null\` or a valid event.`;if(Zv(e))return e.then(a=>{if(!nu(a)&&a!==null)throw new Ns(i);return a},a=>{throw new Ns(`${t} rejected with ${a}`)});if(!nu(e)&&e!==null)throw new Ns(i);return e}function IN(e,t,i){const{beforeSend:a,beforeSendTransaction:c}=e;return y2(t)&&a?a(t,i):v2(t)&&c?c(t,i):t}function y2(e){return e.type===void 0}function v2(e){return e.type==="transaction"}function kN(e,t){t.debug===!0&&(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__?at.enable():console.warn("[Sentry] Cannot initialize SDK with `debug` option using a non-debug bundle."));const i=vn();i.getScope().update(t.initialScope);const c=new e(t);i.bindClient(c)}const AN=30;function x2(e,t,i=b5(e.bufferSize||AN)){let a={};const c=m=>i.drain(m);function d(m){const l=[];if(rw(m,(k,M)=>{const O=sw(M);if(V5(a,O)){const j=fw(k,M);e.recordDroppedEvent("ratelimit_backoff",O,j)}else l.push(k)}),l.length===0)return Ol();const b=Cu(m[0],l),w=k=>{rw(b,(M,O)=>{const j=fw(M,O);e.recordDroppedEvent(k,sw(O),j)})},C=()=>t({body:L5(b,e.textEncoder)}).then(k=>(k.statusCode!==void 0&&(k.statusCode<200||k.statusCode>=300)&&(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&at.warn(`Sentry responded with status code ${k.statusCode} to sent event.`),a=j5(a,k),k),k=>{throw w("network_error"),k});return i.add(C).then(k=>k,k=>{if(k instanceof Ns)return(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&at.error("Skipped sending event because buffer is full."),w("queue_overflow"),Ol();throw k})}return d.__sentry__baseTransport__=!0,{send:d,flush:c}}function fw(e,t){if(!(t!=="event"&&t!=="transaction"))return Array.isArray(e)?e[1]:void 0}const qp="7.64.0";let pw;class Rm{static __initStatic(){this.id="FunctionToString"}constructor(){this.name=Rm.id}setupOnce(){pw=Function.prototype.toString;try{Function.prototype.toString=function(...t){const i=Xv(this)||this;return pw.apply(i,t)}}catch{}}}Rm.__initStatic();const PN=[/^Script error\.?$/,/^Javascript error: Script error\.? on line 0$/],RN=[/^.*healthcheck.*$/,/^.*healthy.*$/,/^.*live.*$/,/^.*ready.*$/,/^.*heartbeat.*$/,/^.*\/health$/,/^.*\/healthz$/];class fd{static __initStatic(){this.id="InboundFilters"}constructor(t={}){this.name=fd.id,this._options=t}setupOnce(t,i){const a=c=>{const d=i();if(d){const m=d.getIntegration(fd);if(m){const l=d.getClient(),b=l?l.getOptions():{},w=MN(m._options,b);return DN(c,w)?null:c}}return c};a.id=this.name,t(a)}}fd.__initStatic();function MN(e={},t={}){return{allowUrls:[...e.allowUrls||[],...t.allowUrls||[]],denyUrls:[...e.denyUrls||[],...t.denyUrls||[]],ignoreErrors:[...e.ignoreErrors||[],...t.ignoreErrors||[],...e.disableErrorDefaults?[]:PN],ignoreTransactions:[...e.ignoreTransactions||[],...t.ignoreTransactions||[],...e.disableTransactionDefaults?[]:RN],ignoreInternal:e.ignoreInternal!==void 0?e.ignoreInternal:!0}}function DN(e,t){return t.ignoreInternal&&NN(e)?((typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&at.warn(`Event dropped due to being internal Sentry Error.
Event: ${Lo(e)}`),!0):LN(e,t.ignoreErrors)?((typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&at.warn(`Event dropped due to being matched by \`ignoreErrors\` option.
Event: ${Lo(e)}`),!0):zN(e,t.ignoreTransactions)?((typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&at.warn(`Event dropped due to being matched by \`ignoreTransactions\` option.
Event: ${Lo(e)}`),!0):ON(e,t.denyUrls)?((typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&at.warn(`Event dropped due to being matched by \`denyUrls\` option.
Event: ${Lo(e)}.
Url: ${Hp(e)}`),!0):BN(e,t.allowUrls)?!1:((typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&at.warn(`Event dropped due to not being matched by \`allowUrls\` option.
Event: ${Lo(e)}.
Url: ${Hp(e)}`),!0)}function LN(e,t){return e.type||!t||!t.length?!1:FN(e).some(i=>Tu(i,t))}function zN(e,t){if(e.type!=="transaction"||!t||!t.length)return!1;const i=e.transaction;return i?Tu(i,t):!1}function ON(e,t){if(!t||!t.length)return!1;const i=Hp(e);return i?Tu(i,t):!1}function BN(e,t){if(!t||!t.length)return!0;const i=Hp(e);return i?Tu(i,t):!0}function FN(e){if(e.message)return[e.message];if(e.exception){const{values:t}=e.exception;try{const{type:i="",value:a=""}=t&&t[t.length-1]||{};return[`${a}`,`${i}: ${a}`]}catch{return(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&at.error(`Cannot extract message for event ${Lo(e)}`),[]}}return[]}function NN(e){try{return e.exception.values[0].type==="SentryError"}catch{}return!1}function UN(e=[]){for(let t=e.length-1;t>=0;t--){const i=e[t];if(i&&i.filename!=="<anonymous>"&&i.filename!=="[native code]")return i.filename||null}return null}function Hp(e){try{let t;try{t=e.exception.values[0].stacktrace.frames}catch{}return t?UN(t):null}catch{return(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&at.error(`Cannot extract url for event ${Lo(e)}`),null}}const zn=Br;let Ty=0;function b2(){return Ty>0}function $N(){Ty++,setTimeout(()=>{Ty--})}function ru(e,t={},i){if(typeof e!="function")return e;try{const c=e.__sentry_wrapped__;if(c)return c;if(Xv(e))return e}catch{return e}const a=function(){const c=Array.prototype.slice.call(arguments);try{i&&typeof i=="function"&&i.apply(this,arguments);const d=c.map(m=>ru(m,t));return e.apply(this,d)}catch(d){throw $N(),oN(m=>{m.addEventProcessor(l=>(t.mechanism&&(_y(l,void 0,void 0),dd(l,t.mechanism)),l.extra={...l.extra,arguments:c},l)),Pm(d)}),d}};try{for(const c in e)Object.prototype.hasOwnProperty.call(e,c)&&(a[c]=e[c])}catch{}JT(a,e),Yv(e,"__sentry_wrapped__",a);try{Object.getOwnPropertyDescriptor(a,"name").configurable&&Object.defineProperty(a,"name",{get(){return e.name}})}catch{}return a}function w2(e,t){const i=i0(e,t),a={type:t&&t.name,value:qN(t)};return i.length&&(a.stacktrace={frames:i}),a.type===void 0&&a.value===""&&(a.value="Unrecoverable error caught"),a}function VN(e,t,i,a){const d=vn().getClient(),m=d&&d.getOptions().normalizeDepth,l={exception:{values:[{type:Tm(t)?t.constructor.name:a?"UnhandledRejection":"Error",value:WN(t,{isUnhandledRejection:a})}]},extra:{__serialized__:s2(t,m)}};if(i){const b=i0(e,i);b.length&&(l.exception.values[0].stacktrace={frames:b})}return l}function v_(e,t){return{exception:{values:[w2(e,t)]}}}function i0(e,t){const i=t.stacktrace||t.stack||"",a=GN(t);try{return e(i,a)}catch{}return[]}const jN=/Minified React error #\d+;/i;function GN(e){if(e){if(typeof e.framesToPop=="number")return e.framesToPop;if(jN.test(e.message))return 1}return 0}function qN(e){const t=e&&e.message;return t?t.error&&typeof t.error.message=="string"?t.error.message:t:"No error message"}function HN(e,t,i,a){const c=i&&i.syntheticException||void 0,d=r0(e,t,c,a);return dd(d),d.level="error",i&&i.event_id&&(d.event_id=i.event_id),Ol(d)}function ZN(e,t,i="info",a,c){const d=a&&a.syntheticException||void 0,m=Cy(e,t,d,c);return m.level=i,a&&a.event_id&&(m.event_id=a.event_id),Ol(m)}function r0(e,t,i,a,c){let d;if(Hv(t)&&t.error)return v_(e,t.error);if(j1(t)||MF(t)){const m=t;if("stack"in t)d=v_(e,t);else{const l=m.name||(j1(m)?"DOMError":"DOMException"),b=m.message?`${l}: ${m.message}`:l;d=Cy(e,b,i,a),_y(d,b)}return"code"in m&&(d.tags={...d.tags,"DOMException.code":`${m.code}`}),d}return ZT(t)?v_(e,t):nu(t)||Tm(t)?(d=VN(e,t,i,c),dd(d,{synthetic:!0}),d):(d=Cy(e,t,i,a),_y(d,`${t}`,void 0),dd(d,{synthetic:!0}),d)}function Cy(e,t,i,a){const c={message:t};if(a&&i){const d=i0(e,i);d.length&&(c.exception={values:[{value:t,stacktrace:{frames:d}}]})}return c}function WN(e,{isUnhandledRejection:t}){const i=XF(e),a=t?"promise rejection":"exception";return Hv(e)?`Event \`ErrorEvent\` captured as ${a} with message \`${e.message}\``:Tm(e)?`Event \`${YN(e)}\` (type=${e.type}) captured as ${a}`:`Object captured as ${a} with keys: ${i}`}function YN(e){try{const t=Object.getPrototypeOf(e);return t?t.constructor.name:void 0}catch{}}const tp=1024,S2="Breadcrumbs";class Mm{static __initStatic(){this.id=S2}constructor(t){this.name=Mm.id,this.options={console:!0,dom:!0,fetch:!0,history:!0,sentry:!0,xhr:!0,...t}}setupOnce(){this.options.console&&ur("console",KN),this.options.dom&&ur("dom",XN(this.options.dom)),this.options.xhr&&ur("xhr",JN),this.options.fetch&&ur("fetch",QN),this.options.history&&ur("history",e3)}addSentryBreadcrumb(t){this.options.sentry&&vn().addBreadcrumb({category:`sentry.${t.type==="transaction"?"transaction":"event"}`,event_id:t.event_id,level:t.level,message:Lo(t)},{event:t})}}Mm.__initStatic();function XN(e){function t(i){let a,c=typeof e=="object"?e.serializeAttribute:void 0,d=typeof e=="object"&&typeof e.maxStringLength=="number"?e.maxStringLength:void 0;d&&d>tp&&((typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&at.warn(`\`dom.maxStringLength\` cannot exceed ${tp}, but a value of ${d} was configured. Sentry will use ${tp} instead.`),d=tp),typeof c=="string"&&(c=[c]);try{const m=i.event;a=t3(m)?qo(m.target,{keyAttrs:c,maxStringLength:d}):qo(m,{keyAttrs:c,maxStringLength:d})}catch{a="<unknown>"}a.length!==0&&vn().addBreadcrumb({category:`ui.${i.name}`,message:a},{event:i.event,name:i.name,global:i.global})}return t}function KN(e){for(let i=0;i<e.args.length;i++)if(e.args[i]==="ref=Ref<"){e.args[i+1]="viewRef";break}const t={category:"console",data:{arguments:e.args,logger:"console"},level:S5(e.level),message:G1(e.args," ")};if(e.level==="assert")if(e.args[0]===!1)t.message=`Assertion failed: ${G1(e.args.slice(1)," ")||"console.assert"}`,t.data.arguments=e.args.slice(1);else return;vn().addBreadcrumb(t,{input:e.args,level:e.level})}function JN(e){const{startTimestamp:t,endTimestamp:i}=e,a=e.xhr[Oo];if(!t||!i||!a)return;const{method:c,url:d,status_code:m,body:l}=a,b={method:c,url:d,status_code:m},w={xhr:e.xhr,input:l,startTimestamp:t,endTimestamp:i};vn().addBreadcrumb({category:"xhr",data:b,type:"http"},w)}function QN(e){const{startTimestamp:t,endTimestamp:i}=e;if(i&&!(e.fetchData.url.match(/sentry_key/)&&e.fetchData.method==="POST"))if(e.error){const a=e.fetchData,c={data:e.error,input:e.args,startTimestamp:t,endTimestamp:i};vn().addBreadcrumb({category:"fetch",data:a,level:"error",type:"http"},c)}else{const a={...e.fetchData,status_code:e.response&&e.response.status},c={input:e.args,response:e.response,startTimestamp:t,endTimestamp:i};vn().addBreadcrumb({category:"fetch",data:a,type:"http"},c)}}function e3(e){let t=e.from,i=e.to;const a=__(zn.location.href);let c=__(t);const d=__(i);c.path||(c=a),a.protocol===d.protocol&&a.host===d.host&&(i=d.relative),a.protocol===c.protocol&&a.host===c.host&&(t=c.relative),vn().addBreadcrumb({category:"navigation",data:{from:t,to:i}})}function t3(e){return!!e&&!!e.target}function n3(e,{metadata:t,tunnel:i,dsn:a}){const c={event_id:e.event_id,sent_at:new Date().toISOString(),...t&&t.sdk&&{sdk:{name:t.sdk.name,version:t.sdk.version}},...!!i&&!!a&&{dsn:Cm(a)}},d=i3(e);return Cu(c,[d])}function i3(e){return[{type:"user_report"},e]}class r3 extends TN{constructor(t){const i=zn.SENTRY_SDK_SOURCE||m5();t._metadata=t._metadata||{},t._metadata.sdk=t._metadata.sdk||{name:"sentry.javascript.browser",packages:[{name:`${i}:@sentry/browser`,version:qp}],version:qp},super(t),t.sendClientReports&&zn.document&&zn.document.addEventListener("visibilitychange",()=>{zn.document.visibilityState==="hidden"&&this._flushOutcomes()})}eventFromException(t,i){return HN(this._options.stackParser,t,i,this._options.attachStacktrace)}eventFromMessage(t,i="info",a){return ZN(this._options.stackParser,t,i,a,this._options.attachStacktrace)}sendEvent(t,i){const a=this.getIntegrationById(S2);a&&a.addSentryBreadcrumb&&a.addSentryBreadcrumb(t),super.sendEvent(t,i)}captureUserFeedback(t){if(!this._isEnabled()){(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&at.warn("SDK not enabled, will not capture user feedback.");return}const i=n3(t,{metadata:this.getSdkMetadata(),dsn:this.getDsn(),tunnel:this.getOptions().tunnel});this._sendEnvelope(i)}_prepareEvent(t,i,a){return t.platform=t.platform||"javascript",super._prepareEvent(t,i,a)}_flushOutcomes(){const t=this._clearOutcomes();if(t.length===0){(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&at.log("No outcomes to send");return}if(!this._dsn){(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&at.log("No dsn provided, will not send outcomes");return}(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&at.log("Sending outcomes:",t);const i=F5(t,this._options.tunnel&&Cm(this._dsn));this._sendEnvelope(i)}}let Dh;function s3(){if(Dh)return Dh;if(my(zn.fetch))return Dh=zn.fetch.bind(zn);const e=zn.document;let t=zn.fetch;if(e&&typeof e.createElement=="function")try{const i=e.createElement("iframe");i.hidden=!0,e.head.appendChild(i);const a=i.contentWindow;a&&a.fetch&&(t=a.fetch),e.head.removeChild(i)}catch(i){(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&at.warn("Could not create sandbox iframe for pure fetch check, bailing to window.fetch: ",i)}return Dh=t.bind(zn)}function a3(){Dh=void 0}function o3(e,t=s3()){let i=0,a=0;function c(d){const m=d.body.length;i+=m,a++;const l={body:d.body,method:"POST",referrerPolicy:"origin",headers:e.headers,keepalive:i<=6e4&&a<15,...e.fetchOptions};try{return t(e.url,l).then(b=>(i-=m,a--,{statusCode:b.status,headers:{"x-sentry-rate-limits":b.headers.get("X-Sentry-Rate-Limits"),"retry-after":b.headers.get("Retry-After")}}))}catch(b){return a3(),i-=m,a--,Gp(b)}}return x2(e,c)}const l3=4;function c3(e){function t(i){return new us((a,c)=>{const d=new XMLHttpRequest;d.onerror=c,d.onreadystatechange=()=>{d.readyState===l3&&a({statusCode:d.status,headers:{"x-sentry-rate-limits":d.getResponseHeader("X-Sentry-Rate-Limits"),"retry-after":d.getResponseHeader("Retry-After")}})},d.open("POST",e.url);for(const m in e.headers)Object.prototype.hasOwnProperty.call(e.headers,m)&&d.setRequestHeader(m,e.headers[m]);d.send(i.body)})}return x2(e,t)}const Dm="?",u3=30,h3=40,d3=50;function s0(e,t,i,a){const c={filename:e,function:t,in_app:!0};return i!==void 0&&(c.lineno=i),a!==void 0&&(c.colno=a),c}const f3=/^\s*at (?:(.+?\)(?: \[.+\])?|.*?) ?\((?:address at )?)?(?:async )?((?:<anonymous>|[-a-z]+:|.*bundle|\/)?.*?)(?::(\d+))?(?::(\d+))?\)?\s*$/i,p3=/\((\S*)(?::(\d+))(?::(\d+))\)/,m3=e=>{const t=f3.exec(e);if(t){if(t[2]&&t[2].indexOf("eval")===0){const d=p3.exec(t[2]);d&&(t[2]=d[1],t[3]=d[2],t[4]=d[3])}const[a,c]=E2(t[1]||Dm,t[2]);return s0(c,a,t[3]?+t[3]:void 0,t[4]?+t[4]:void 0)}},g3=[u3,m3],_3=/^\s*(.*?)(?:\((.*?)\))?(?:^|@)?((?:[-a-z]+)?:\/.*?|\[native code\]|[^@]*(?:bundle|\d+\.js)|\/[\w\-. /=]+)(?::(\d+))?(?::(\d+))?\s*$/i,y3=/(\S+) line (\d+)(?: > eval line \d+)* > eval/i,v3=e=>{const t=_3.exec(e);if(t){if(t[3]&&t[3].indexOf(" > eval")>-1){const d=y3.exec(t[3]);d&&(t[1]=t[1]||"eval",t[3]=d[1],t[4]=d[2],t[5]="")}let a=t[3],c=t[1]||Dm;return[c,a]=E2(c,a),s0(a,c,t[4]?+t[4]:void 0,t[5]?+t[5]:void 0)}},x3=[d3,v3],b3=/^\s*at (?:((?:\[object object\])?.+) )?\(?((?:[-a-z]+):.*?):(\d+)(?::(\d+))?\)?\s*$/i,w3=e=>{const t=b3.exec(e);return t?s0(t[2],t[1]||Dm,+t[3],t[4]?+t[4]:void 0):void 0},S3=[h3,w3],E3=[g3,x3,S3],T3=t2(...E3),E2=(e,t)=>{const i=e.indexOf("safari-extension")!==-1,a=e.indexOf("safari-web-extension")!==-1;return i||a?[e.indexOf("@")!==-1?e.split("@")[0]:Dm,i?`safari-extension:${t}`:`safari-web-extension:${t}`]:[e,t]};class Iu{static __initStatic(){this.id="GlobalHandlers"}constructor(t){this.name=Iu.id,this._options={onerror:!0,onunhandledrejection:!0,...t},this._installFunc={onerror:C3,onunhandledrejection:I3}}setupOnce(){Error.stackTraceLimit=50;const t=this._options;for(const i in t){const a=this._installFunc[i];a&&t[i]&&(P3(i),a(),this._installFunc[i]=void 0)}}}Iu.__initStatic();function C3(){ur("error",e=>{const[t,i,a]=I2();if(!t.getIntegration(Iu))return;const{msg:c,url:d,line:m,column:l,error:b}=e;if(b2()||b&&b.__sentry_own_request__)return;const w=b===void 0&&Go(c)?A3(c,d,m,l):T2(r0(i,b||c,void 0,a,!1),d,m,l);w.level="error",C2(t,b,w,"onerror")})}function I3(){ur("unhandledrejection",e=>{const[t,i,a]=I2();if(!t.getIntegration(Iu))return;let c=e;try{"reason"in e?c=e.reason:"detail"in e&&"reason"in e.detail&&(c=e.detail.reason)}catch{}if(b2()||c&&c.__sentry_own_request__)return!0;const d=WT(c)?k3(c):r0(i,c,void 0,a,!0);d.level="error",C2(t,c,d,"onunhandledrejection")})}function k3(e){return{exception:{values:[{type:"UnhandledRejection",value:`Non-Error promise rejection captured with value: ${String(e)}`}]}}}function A3(e,t,i,a){const c=/^(?:[Uu]ncaught (?:exception: )?)?(?:((?:Eval|Internal|Range|Reference|Syntax|Type|URI|)Error): )?(.*)$/i;let d=Hv(e)?e.message:e,m="Error";const l=d.match(c);return l&&(m=l[1],d=l[2]),T2({exception:{values:[{type:m,value:d}]}},t,i,a)}function T2(e,t,i,a){const c=e.exception=e.exception||{},d=c.values=c.values||[],m=d[0]=d[0]||{},l=m.stacktrace=m.stacktrace||{},b=l.frames=l.frames||[],w=isNaN(parseInt(a,10))?void 0:a,C=isNaN(parseInt(i,10))?void 0:i,k=Go(t)&&t.length>0?t:$F();return b.length===0&&b.push({colno:w,filename:k,function:"?",in_app:!0,lineno:C}),e}function P3(e){(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&at.log(`Global Handler attached: ${e}`)}function C2(e,t,i,a){dd(i,{handled:!1,type:a}),e.captureEvent(i,{originalException:t})}function I2(){const e=vn(),t=e.getClient(),i=t&&t.getOptions()||{stackParser:()=>[],attachStacktrace:!1};return[e,i.stackParser,i.attachStacktrace]}const R3=["EventTarget","Window","Node","ApplicationCache","AudioTrackList","ChannelMergerNode","CryptoOperation","EventSource","FileReader","HTMLUnknownElement","IDBDatabase","IDBRequest","IDBTransaction","KeyOperation","MediaController","MessagePort","ModalWindow","Notification","SVGElementInstance","Screen","TextTrack","TextTrackCue","TextTrackList","WebSocket","WebSocketWorker","Worker","XMLHttpRequest","XMLHttpRequestEventTarget","XMLHttpRequestUpload"];class Lm{static __initStatic(){this.id="TryCatch"}constructor(t){this.name=Lm.id,this._options={XMLHttpRequest:!0,eventTarget:!0,requestAnimationFrame:!0,setInterval:!0,setTimeout:!0,...t}}setupOnce(){this._options.setTimeout&&tr(zn,"setTimeout",mw),this._options.setInterval&&tr(zn,"setInterval",mw),this._options.requestAnimationFrame&&tr(zn,"requestAnimationFrame",M3),this._options.XMLHttpRequest&&"XMLHttpRequest"in zn&&tr(XMLHttpRequest.prototype,"send",D3);const t=this._options.eventTarget;t&&(Array.isArray(t)?t:R3).forEach(L3)}}Lm.__initStatic();function mw(e){return function(...t){const i=t[0];return t[0]=ru(i,{mechanism:{data:{function:Ho(e)},handled:!0,type:"instrument"}}),e.apply(this,t)}}function M3(e){return function(t){return e.apply(this,[ru(t,{mechanism:{data:{function:"requestAnimationFrame",handler:Ho(e)},handled:!0,type:"instrument"}})])}}function D3(e){return function(...t){const i=this;return["onload","onerror","onprogress","onreadystatechange"].forEach(c=>{c in i&&typeof i[c]=="function"&&tr(i,c,function(d){const m={mechanism:{data:{function:c,handler:Ho(d)},handled:!0,type:"instrument"}},l=Xv(d);return l&&(m.mechanism.data.handler=Ho(l)),ru(d,m)})}),e.apply(this,t)}}function L3(e){const t=zn,i=t[e]&&t[e].prototype;!i||!i.hasOwnProperty||!i.hasOwnProperty("addEventListener")||(tr(i,"addEventListener",function(a){return function(c,d,m){try{typeof d.handleEvent=="function"&&(d.handleEvent=ru(d.handleEvent,{mechanism:{data:{function:"handleEvent",handler:Ho(d),target:e},handled:!0,type:"instrument"}}))}catch{}return a.apply(this,[c,ru(d,{mechanism:{data:{function:"addEventListener",handler:Ho(d),target:e},handled:!0,type:"instrument"}}),m])}}),tr(i,"removeEventListener",function(a){return function(c,d,m){const l=d;try{const b=l&&l.__sentry_wrapped__;b&&a.call(this,c,b,m)}catch{}return a.call(this,c,l,m)}}))}const z3="cause",O3=5;class pd{static __initStatic(){this.id="LinkedErrors"}constructor(t={}){this.name=pd.id,this._key=t.key||z3,this._limit=t.limit||O3}setupOnce(t,i){t((a,c)=>{const d=i(),m=d.getClient(),l=d.getIntegration(pd);if(!m||!l)return a;const b=m.getOptions();return BF(w2,b.stackParser,b.maxValueLength,l._key,l._limit,a,c),a})}}pd.__initStatic();class md{static __initStatic(){this.id="HttpContext"}constructor(){this.name=md.id}setupOnce(){t0(t=>{if(vn().getIntegration(md)){if(!zn.navigator&&!zn.location&&!zn.document)return t;const i=t.request&&t.request.url||zn.location&&zn.location.href,{referrer:a}=zn.document||{},{userAgent:c}=zn.navigator||{},d={...t.request&&t.request.headers,...a&&{Referer:a},...c&&{"User-Agent":c}},m={...t.request,...i&&{url:i},headers:d};return{...t,request:m}}return t})}}md.__initStatic();class gd{static __initStatic(){this.id="Dedupe"}constructor(){this.name=gd.id}setupOnce(t,i){const a=c=>{if(c.type)return c;const d=i().getIntegration(gd);if(d){try{if(B3(c,d._previousEvent))return(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&at.warn("Event dropped due to being a duplicate of previously captured event."),null}catch{return d._previousEvent=c}return d._previousEvent=c}return c};a.id=this.name,t(a)}}gd.__initStatic();function B3(e,t){return t?!!(F3(e,t)||N3(e,t)):!1}function F3(e,t){const i=e.message,a=t.message;return!(!i&&!a||i&&!a||!i&&a||i!==a||!A2(e,t)||!k2(e,t))}function N3(e,t){const i=gw(t),a=gw(e);return!(!i||!a||i.type!==a.type||i.value!==a.value||!A2(e,t)||!k2(e,t))}function k2(e,t){let i=_w(e),a=_w(t);if(!i&&!a)return!0;if(i&&!a||!i&&a||(i=i,a=a,a.length!==i.length))return!1;for(let c=0;c<a.length;c++){const d=a[c],m=i[c];if(d.filename!==m.filename||d.lineno!==m.lineno||d.colno!==m.colno||d.function!==m.function)return!1}return!0}function A2(e,t){let i=e.fingerprint,a=t.fingerprint;if(!i&&!a)return!0;if(i&&!a||!i&&a)return!1;i=i,a=a;try{return i.join("")===a.join("")}catch{return!1}}function gw(e){return e.exception&&e.exception.values&&e.exception.values[0]}function _w(e){const t=e.exception;if(t)try{return t.values[0].stacktrace.frames}catch{return}}const U3=[new fd,new Rm,new Lm,new Mm,new Iu,new pd,new gd,new md];function $3(e={}){e.defaultIntegrations===void 0&&(e.defaultIntegrations=U3),e.release===void 0&&(typeof __SENTRY_RELEASE__=="string"&&(e.release=__SENTRY_RELEASE__),zn.SENTRY_RELEASE&&zn.SENTRY_RELEASE.id&&(e.release=zn.SENTRY_RELEASE.id)),e.autoSessionTracking===void 0&&(e.autoSessionTracking=!0),e.sendClientReports===void 0&&(e.sendClientReports=!0);const t={...e,stackParser:KF(e.stackParser||T3),integrations:_N(e),transport:e.transport||(n2()?o3:c3)};kN(r3,t),e.autoSessionTracking&&V3()}function yw(e){e.startSession({ignoreDuration:!0}),e.captureSession()}function V3(){if(typeof zn.document>"u"){(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&at.warn("Session tracking in non-browser environment with @sentry/browser is not supported.");return}const e=vn();e.captureSession&&(yw(e),ur("history",({from:t,to:i})=>{t===void 0||t===i||yw(vn())}))}const In=Br,a0="sentryReplaySession",j3="replay_event",o0="Unable to send Replay",G3=3e5,q3=9e5,H3=36e5,Z3=5e3,W3=5500,Y3=6e4,X3=5e3,K3=3,np=15e4,ip=5e3,J3=3e3,Q3=300,l0=2e7,eU=4999,tU=15e3;var Qi;(function(e){e[e.Document=0]="Document",e[e.DocumentType=1]="DocumentType",e[e.Element=2]="Element",e[e.Text=3]="Text",e[e.CDATA=4]="CDATA",e[e.Comment=5]="Comment"})(Qi||(Qi={}));function nU(e){return e.nodeType===e.ELEMENT_NODE}function jh(e){const t=e==null?void 0:e.host;return!!(t&&t.shadowRoot&&t.shadowRoot===e)}function P2({maskInputOptions:e,tagName:t,type:i}){t.toLowerCase()==="option"&&(t="select");const a=typeof i=="string"?i.toLowerCase():void 0;return e[t.toLowerCase()]||a&&e[a]||a==="password"||t==="input"&&!i&&e.text}function iU({tagName:e,type:t,maskInputOptions:i,maskInputSelector:a}){return a||P2({maskInputOptions:i,tagName:e,type:t})}function _d({input:e,maskInputSelector:t,unmaskInputSelector:i,maskInputOptions:a,tagName:c,type:d,value:m,maskInputFn:l}){let b=m||"";return i&&e.matches(i)||(e.hasAttribute("data-rr-is-password")&&(d="password"),(P2({maskInputOptions:a,tagName:c,type:d})||t&&e.matches(t))&&(l?b=l(b):b="*".repeat(b.length))),b}const vw="__rrweb_original__";function rU(e){const t=e.getContext("2d");if(!t)return!0;const i=50;for(let a=0;a<e.width;a+=i)for(let c=0;c<e.height;c+=i){const d=t.getImageData,m=vw in d?d[vw]:d;if(new Uint32Array(m.call(t,a,c,Math.min(i,e.width-a),Math.min(i,e.height-c)).data.buffer).some(b=>b!==0))return!1}return!0}function R2(e){const t=e.type;return e.hasAttribute("data-rr-is-password")?"password":t?t.toLowerCase():null}function Iy(e,t,i){return typeof i=="string"&&i.toLowerCase(),t==="INPUT"&&(i==="radio"||i==="checkbox")?e.getAttribute("value")||"":e.value}let sU=1;const aU=new RegExp("[^a-z0-9-_:]"),yd=-2;function M2(e){return e?e.replace(/[\S]/g,"*"):""}function oU(){return sU++}function lU(e){if(e instanceof HTMLFormElement)return"form";const t=e.tagName.toLowerCase().trim();return aU.test(t)?"div":t}function ky(e){try{const t=e.rules||e.cssRules;return t?Array.from(t).map(cU).join(""):null}catch{return null}}function cU(e){let t=e.cssText;if(uU(e))try{t=ky(e.styleSheet)||t}catch{}return D2(t)}function D2(e){if(e.indexOf(":")>-1){const t=/(\[(?:[\w-]+)[^\\])(:(?:[\w-]+)\])/gm;return e.replace(t,"$1\\$2")}return e}function uU(e){return"styleSheet"in e}function hU(e){return e.cssRules?Array.from(e.cssRules).map(t=>t.cssText?D2(t.cssText):"").join(""):""}function dU(e){let t="";return e.indexOf("//")>-1?t=e.split("/").slice(0,3).join("/"):t=e.split("/")[0],t=t.split("?")[0],t}let Fc,xw;const fU=/url\((?:(')([^']*)'|(")(.*?)"|([^)]*))\)/gm,pU=/^(?!www\.|(?:http|ftp)s?:\/\/|[A-Za-z]:\\|\/\/|#).*/,mU=/^(data:)([^,]*),(.*)/i;function yp(e,t){return(e||"").replace(fU,(i,a,c,d,m,l)=>{const b=c||m||l,w=a||d||"";if(!b)return i;if(!pU.test(b))return`url(${w}${b}${w})`;if(mU.test(b))return`url(${w}${b}${w})`;if(b[0]==="/")return`url(${w}${dU(t)+b}${w})`;const C=t.split("/"),k=b.split("/");C.pop();for(const M of k)M!=="."&&(M===".."?C.pop():C.push(M));return`url(${w}${C.join("/")}${w})`})}const gU=/^[^ \t\n\r\u000c]+/,_U=/^[, \t\n\r\u000c]+/;function yU(e,t){if(t.trim()==="")return t;let i=0;function a(d){let m,l=d.exec(t.substring(i));return l?(m=l[0],i+=m.length,m):""}let c=[];for(;a(_U),!(i>=t.length);){let d=a(gU);if(d.slice(-1)===",")d=jc(e,d.substring(0,d.length-1)),c.push(d);else{let m="";d=jc(e,d);let l=!1;for(;;){let b=t.charAt(i);if(b===""){c.push((d+m).trim());break}else if(l)b===")"&&(l=!1);else if(b===","){i+=1,c.push((d+m).trim());break}else b==="("&&(l=!0);m+=b,i+=1}}}return c.join(", ")}function jc(e,t){if(!t||t.trim()==="")return t;const i=e.createElement("a");return i.href=t,i.href}function vU(e){return!!(e.tagName==="svg"||e.ownerSVGElement)}function Ay(){const e=document.createElement("a");return e.href="",e.href}function L2(e,t,i,a,c,d,m,l){if(!c)return c;const b=a.toLowerCase(),w=i.toLowerCase();return b==="src"||b==="href"||b==="xlink:href"&&c[0]!=="#"||b==="background"&&(w==="table"||w==="td"||w==="th")?jc(e,c):b==="srcset"?yU(e,c):b==="style"?yp(c,Ay()):w==="object"&&b==="data"?jc(e,c):d&&xU(t,b,w,m)?l?l(c):M2(c):c}function xU(e,t,i,a){return a&&e.matches(a)?!1:["placeholder","title","aria-label"].indexOf(t)>-1||i==="input"&&t==="value"&&e.hasAttribute("type")&&["submit","button"].indexOf(e.getAttribute("type").toLowerCase())>-1}function bU(e,t,i,a){if(a&&e.matches(a))return!1;if(typeof t=="string"){if(e.classList.contains(t))return!0}else for(let c=0;c<e.classList.length;c++){const d=e.classList[c];if(t.test(d))return!0}return i?e.matches(i):!1}function Zp(e,t,i,a,c){if(!e)return!1;if(e.nodeType!==e.ELEMENT_NODE)return Zp(e.parentNode,t,i,a,c);if(a&&(e.matches(a)||e.closest(a)))return!1;if(c)return!0;if(typeof t=="string"){if(e.classList.contains(t))return!0}else for(let d=0;d<e.classList.length;d++){const m=e.classList[d];if(t.test(m))return!0}return i&&e.matches(i)?!0:Zp(e.parentNode,t,i,a,c)}function wU(e,t,i){const a=e.contentWindow;if(!a)return;let c=!1,d;try{d=a.document.readyState}catch{return}if(d!=="complete"){const l=setTimeout(()=>{c||(t(),c=!0)},i);e.addEventListener("load",()=>{clearTimeout(l),c=!0,t()});return}const m="about:blank";if(a.location.href!==m||e.src===m||e.src===""){setTimeout(t,0);return}e.addEventListener("load",t)}function SU(e,t){var i;const{doc:a,blockClass:c,blockSelector:d,unblockSelector:m,maskTextClass:l,maskTextSelector:b,unmaskTextSelector:w,inlineStylesheet:C,maskInputSelector:k,unmaskInputSelector:M,maskAllText:O,maskInputOptions:j={},maskTextFn:W,maskInputFn:le,dataURLOptions:he={},inlineImages:be,recordCanvas:ge,keepIframeSrcFn:Pe}=t;let Ue;if(a.__sn){const Oe=a.__sn.id;Ue=Oe===1?void 0:Oe}switch(e.nodeType){case e.DOCUMENT_NODE:return e.compatMode!=="CSS1Compat"?{type:Qi.Document,childNodes:[],compatMode:e.compatMode,rootId:Ue}:{type:Qi.Document,childNodes:[],rootId:Ue};case e.DOCUMENT_TYPE_NODE:return{type:Qi.DocumentType,name:e.name,publicId:e.publicId,systemId:e.systemId,rootId:Ue};case e.ELEMENT_NODE:const Oe=bU(e,c,d,m),Te=lU(e);let V={};for(const{name:oe,value:Re}of Array.from(e.attributes))CU(Te,oe)||(V[oe]=L2(a,e,Te,oe,Re,O,w,W));if(Te==="link"&&C){const oe=Array.from(a.styleSheets).find(nt=>nt.href===e.href);let Re=null;oe&&(Re=ky(oe)),Re&&(delete V.rel,delete V.href,V._cssText=yp(Re,oe.href))}if(Te==="style"&&e.sheet&&!(e.innerText||e.textContent||"").trim().length){const oe=ky(e.sheet);oe&&(V._cssText=yp(oe,Ay()))}if(Te==="input"||Te==="textarea"||Te==="select"||Te==="option"){const oe=e,Re=R2(oe),nt=Iy(oe,Te.toUpperCase(),Re),Qe=e.checked;Re!=="submit"&&Re!=="button"&&nt&&(V.value=_d({input:oe,type:Re,tagName:Te,value:nt,maskInputSelector:k,unmaskInputSelector:M,maskInputOptions:j,maskInputFn:le})),Qe&&(V.checked=Qe)}if(Te==="option"&&(e.selected&&!j.select?V.selected=!0:delete V.selected),Te==="canvas"&&ge){if(e.__context==="2d")rU(e)||(V.rr_dataURL=e.toDataURL(he.type,he.quality));else if(!("__context"in e)){const oe=e.toDataURL(he.type,he.quality),Re=document.createElement("canvas");Re.width=e.width,Re.height=e.height;const nt=Re.toDataURL(he.type,he.quality);oe!==nt&&(V.rr_dataURL=oe)}}if(Te==="img"&&be){Fc||(Fc=a.createElement("canvas"),xw=Fc.getContext("2d"));const oe=e,Re=oe.crossOrigin;oe.crossOrigin="anonymous";const nt=()=>{try{Fc.width=oe.naturalWidth,Fc.height=oe.naturalHeight,xw.drawImage(oe,0,0),V.rr_dataURL=Fc.toDataURL(he.type,he.quality)}catch(Qe){console.warn(`Cannot inline img src=${oe.currentSrc}! Error: ${Qe}`)}Re?V.crossOrigin=Re:delete V.crossOrigin};oe.complete&&oe.naturalWidth!==0?nt():oe.onload=nt}if((Te==="audio"||Te==="video")&&(V.rr_mediaState=e.paused?"paused":"played",V.rr_mediaCurrentTime=e.currentTime),e.scrollLeft&&(V.rr_scrollLeft=e.scrollLeft),e.scrollTop&&(V.rr_scrollTop=e.scrollTop),Oe){const{width:oe,height:Re}=e.getBoundingClientRect();V={class:V.class,rr_width:`${oe}px`,rr_height:`${Re}px`}}return Te==="iframe"&&!Pe(V.src)&&(e.contentDocument||(V.rr_src=V.src),delete V.src),{type:Qi.Element,tagName:Te,attributes:V,childNodes:[],isSVG:vU(e)||void 0,needBlock:Oe,rootId:Ue};case e.TEXT_NODE:const Z=e.parentNode&&e.parentNode.tagName;let ae=e.textContent;const ke=Z==="STYLE"?!0:void 0,_e=Z==="SCRIPT"?!0:void 0;if(ke&&ae){try{e.nextSibling||e.previousSibling||!((i=e.parentNode.sheet)===null||i===void 0)&&i.cssRules&&(ae=hU(e.parentNode.sheet))}catch(oe){console.warn(`Cannot get CSS styles from text's parentNode. Error: ${oe}`,e)}ae=yp(ae,Ay())}if(_e&&(ae="SCRIPT_PLACEHOLDER"),Z==="TEXTAREA"&&ae)ae="";else if(Z==="OPTION"&&ae){const oe=e.parentNode;ae=_d({input:oe,type:null,tagName:Z,value:ae,maskInputSelector:k,unmaskInputSelector:M,maskInputOptions:j,maskInputFn:le})}else!ke&&!_e&&Zp(e,l,b,w,O)&&ae&&(ae=W?W(ae):M2(ae));return{type:Qi.Text,textContent:ae||"",isStyle:ke,rootId:Ue};case e.CDATA_SECTION_NODE:return{type:Qi.CDATA,textContent:"",rootId:Ue};case e.COMMENT_NODE:return{type:Qi.Comment,textContent:e.textContent||"",rootId:Ue};default:return!1}}function ei(e){return e==null?"":e.toLowerCase()}function EU(e,t){if(t.comment&&e.type===Qi.Comment)return!0;if(e.type===Qi.Element){if(t.script&&(e.tagName==="script"||e.tagName==="link"&&(e.attributes.rel==="preload"||e.attributes.rel==="modulepreload")&&e.attributes.as==="script"||e.tagName==="link"&&e.attributes.rel==="prefetch"&&typeof e.attributes.href=="string"&&e.attributes.href.endsWith(".js")))return!0;if(t.headFavicon&&(e.tagName==="link"&&e.attributes.rel==="shortcut icon"||e.tagName==="meta"&&(ei(e.attributes.name).match(/^msapplication-tile(image|color)$/)||ei(e.attributes.name)==="application-name"||ei(e.attributes.rel)==="icon"||ei(e.attributes.rel)==="apple-touch-icon"||ei(e.attributes.rel)==="shortcut icon")))return!0;if(e.tagName==="meta"){if(t.headMetaDescKeywords&&ei(e.attributes.name).match(/^description|keywords$/))return!0;if(t.headMetaSocial&&(ei(e.attributes.property).match(/^(og|twitter|fb):/)||ei(e.attributes.name).match(/^(og|twitter):/)||ei(e.attributes.name)==="pinterest"))return!0;if(t.headMetaRobots&&(ei(e.attributes.name)==="robots"||ei(e.attributes.name)==="googlebot"||ei(e.attributes.name)==="bingbot"))return!0;if(t.headMetaHttpEquiv&&e.attributes["http-equiv"]!==void 0)return!0;if(t.headMetaAuthorship&&(ei(e.attributes.name)==="author"||ei(e.attributes.name)==="generator"||ei(e.attributes.name)==="framework"||ei(e.attributes.name)==="publisher"||ei(e.attributes.name)==="progid"||ei(e.attributes.property).match(/^article:/)||ei(e.attributes.property).match(/^product:/)))return!0;if(t.headMetaVerification&&(ei(e.attributes.name)==="google-site-verification"||ei(e.attributes.name)==="yandex-verification"||ei(e.attributes.name)==="csrf-token"||ei(e.attributes.name)==="p:domain_verify"||ei(e.attributes.name)==="verify-v1"||ei(e.attributes.name)==="verification"||ei(e.attributes.name)==="shopify-checkout-api-token"))return!0}}return!1}function Gh(e,t){const{doc:i,map:a,blockClass:c,blockSelector:d,unblockSelector:m,maskTextClass:l,maskTextSelector:b,unmaskTextSelector:w,skipChild:C=!1,inlineStylesheet:k=!0,maskInputSelector:M,unmaskInputSelector:O,maskAllText:j,maskInputOptions:W={},maskTextFn:le,maskInputFn:he,slimDOMOptions:be,dataURLOptions:ge={},inlineImages:Pe=!1,recordCanvas:Ue=!1,onSerialize:Oe,onIframeLoad:Te,iframeLoadTimeout:V=5e3,keepIframeSrcFn:Z=()=>!1}=t;let{preserveWhiteSpace:ae=!0}=t;const ke=SU(e,{doc:i,blockClass:c,blockSelector:d,unblockSelector:m,maskTextClass:l,maskTextSelector:b,unmaskTextSelector:w,inlineStylesheet:k,maskInputSelector:M,unmaskInputSelector:O,maskAllText:j,maskInputOptions:W,maskTextFn:le,maskInputFn:he,dataURLOptions:ge,inlineImages:Pe,recordCanvas:Ue,keepIframeSrcFn:Z});if(!ke)return console.warn(e,"not serialized"),null;let _e;"__sn"in e?_e=e.__sn.id:EU(ke,be)||!ae&&ke.type===Qi.Text&&!ke.isStyle&&!ke.textContent.replace(/^\s+|\s+$/gm,"").length?_e=yd:_e=oU();const oe=Object.assign(ke,{id:_e});if(e.__sn=oe,_e===yd)return null;a[_e]=e,Oe&&Oe(e);let Re=!C;if(oe.type===Qi.Element&&(Re=Re&&!oe.needBlock,delete oe.needBlock,e.shadowRoot&&(oe.isShadowHost=!0)),(oe.type===Qi.Document||oe.type===Qi.Element)&&Re){be.headWhitespace&&ke.type===Qi.Element&&ke.tagName==="head"&&(ae=!1);const nt={doc:i,map:a,blockClass:c,blockSelector:d,unblockSelector:m,maskTextClass:l,maskTextSelector:b,unmaskTextSelector:w,skipChild:C,inlineStylesheet:k,maskInputSelector:M,unmaskInputSelector:O,maskAllText:j,maskInputOptions:W,maskTextFn:le,maskInputFn:he,slimDOMOptions:be,dataURLOptions:ge,inlineImages:Pe,recordCanvas:Ue,preserveWhiteSpace:ae,onSerialize:Oe,onIframeLoad:Te,iframeLoadTimeout:V,keepIframeSrcFn:Z};for(const Qe of Array.from(e.childNodes)){const qe=Gh(Qe,nt);qe&&oe.childNodes.push(qe)}if(nU(e)&&e.shadowRoot)for(const Qe of Array.from(e.shadowRoot.childNodes)){const qe=Gh(Qe,nt);qe&&(qe.isShadow=!0,oe.childNodes.push(qe))}}return e.parentNode&&jh(e.parentNode)&&(oe.isShadow=!0),oe.type===Qi.Element&&oe.tagName==="iframe"&&wU(e,()=>{const nt=e.contentDocument;if(nt&&Te){const Qe=Gh(nt,{doc:nt,map:a,blockClass:c,blockSelector:d,unblockSelector:m,maskTextClass:l,maskTextSelector:b,unmaskTextSelector:w,skipChild:!1,inlineStylesheet:k,maskInputSelector:M,unmaskInputSelector:O,maskAllText:j,maskInputOptions:W,maskTextFn:le,maskInputFn:he,slimDOMOptions:be,dataURLOptions:ge,inlineImages:Pe,recordCanvas:Ue,preserveWhiteSpace:ae,onSerialize:Oe,onIframeLoad:Te,iframeLoadTimeout:V,keepIframeSrcFn:Z});Qe&&Te(e,Qe)}},V),oe}function TU(e,t){const{blockClass:i="rr-block",blockSelector:a=null,unblockSelector:c=null,maskTextClass:d="rr-mask",maskTextSelector:m=null,unmaskTextSelector:l=null,inlineStylesheet:b=!0,inlineImages:w=!1,recordCanvas:C=!1,maskInputSelector:k=null,unmaskInputSelector:M=null,maskAllText:O=!1,maskAllInputs:j=!1,maskTextFn:W,maskInputFn:le,slimDOM:he=!1,dataURLOptions:be,preserveWhiteSpace:ge,onSerialize:Pe,onIframeLoad:Ue,iframeLoadTimeout:Oe,keepIframeSrcFn:Te=()=>!1}=t||{},V={};return[Gh(e,{doc:e,map:V,blockClass:i,blockSelector:a,unblockSelector:c,maskTextClass:d,maskTextSelector:m,unmaskTextSelector:l,skipChild:!1,inlineStylesheet:b,maskInputSelector:k,unmaskInputSelector:M,maskAllText:O,maskInputOptions:j===!0?{color:!0,date:!0,"datetime-local":!0,email:!0,month:!0,number:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0,textarea:!0,select:!0}:j===!1?{}:j,maskTextFn:W,maskInputFn:le,slimDOMOptions:he===!0||he==="all"?{script:!0,comment:!0,headFavicon:!0,headWhitespace:!0,headMetaDescKeywords:he==="all",headMetaSocial:!0,headMetaRobots:!0,headMetaHttpEquiv:!0,headMetaAuthorship:!0,headMetaVerification:!0}:he===!1?{}:he,dataURLOptions:be,inlineImages:w,recordCanvas:C,preserveWhiteSpace:ge,onSerialize:Pe,onIframeLoad:Ue,iframeLoadTimeout:Oe,keepIframeSrcFn:Te}),V]}function CU(e,t,i){return(e==="video"||e==="audio")&&t==="autoplay"}var Nn;(function(e){e[e.DomContentLoaded=0]="DomContentLoaded",e[e.Load=1]="Load",e[e.FullSnapshot=2]="FullSnapshot",e[e.IncrementalSnapshot=3]="IncrementalSnapshot",e[e.Meta=4]="Meta",e[e.Custom=5]="Custom",e[e.Plugin=6]="Plugin"})(Nn||(Nn={}));var lr;(function(e){e[e.Mutation=0]="Mutation",e[e.MouseMove=1]="MouseMove",e[e.MouseInteraction=2]="MouseInteraction",e[e.Scroll=3]="Scroll",e[e.ViewportResize=4]="ViewportResize",e[e.Input=5]="Input",e[e.TouchMove=6]="TouchMove",e[e.MediaInteraction=7]="MediaInteraction",e[e.StyleSheetRule=8]="StyleSheetRule",e[e.CanvasMutation=9]="CanvasMutation",e[e.Font=10]="Font",e[e.Log=11]="Log",e[e.Drag=12]="Drag",e[e.StyleDeclaration=13]="StyleDeclaration"})(lr||(lr={}));var Wp;(function(e){e[e.MouseUp=0]="MouseUp",e[e.MouseDown=1]="MouseDown",e[e.Click=2]="Click",e[e.ContextMenu=3]="ContextMenu",e[e.DblClick=4]="DblClick",e[e.Focus=5]="Focus",e[e.Blur=6]="Blur",e[e.TouchStart=7]="TouchStart",e[e.TouchMove_Departed=8]="TouchMove_Departed",e[e.TouchEnd=9]="TouchEnd",e[e.TouchCancel=10]="TouchCancel"})(Wp||(Wp={}));var su;(function(e){e[e["2D"]=0]="2D",e[e.WebGL=1]="WebGL",e[e.WebGL2=2]="WebGL2"})(su||(su={}));var bw;(function(e){e[e.Play=0]="Play",e[e.Pause=1]="Pause",e[e.Seeked=2]="Seeked",e[e.VolumeChange=3]="VolumeChange"})(bw||(bw={}));var ww;(function(e){e.Start="start",e.Pause="pause",e.Resume="resume",e.Resize="resize",e.Finish="finish",e.FullsnapshotRebuilded="fullsnapshot-rebuilded",e.LoadStylesheetStart="load-stylesheet-start",e.LoadStylesheetEnd="load-stylesheet-end",e.SkipStart="skip-start",e.SkipEnd="skip-end",e.MouseInteraction="mouse-interaction",e.EventCast="event-cast",e.CustomEvent="custom-event",e.Flush="flush",e.StateChange="state-change",e.PlayBack="play-back"})(ww||(ww={}));function fs(e,t,i=document){const a={capture:!0,passive:!0};return i.addEventListener(e,t,a),()=>i.removeEventListener(e,t,a)}function IU(){return{map:{},getId(e){return!e||!e.__sn?-1:e.__sn.id},getNode(e){return this.map[e]||null},removeNodeFromMap(e){const t=e.__sn&&e.__sn.id;delete this.map[t],e.childNodes&&e.childNodes.forEach(i=>this.removeNodeFromMap(i))},has(e){return this.map.hasOwnProperty(e)},reset(){this.map={}}}}const $c=`Please stop import mirror directly. Instead of that,\r
now you can use replayer.getMirror() to access the mirror instance of a replayer,\r
or you can use record.mirror to access the mirror instance during recording.`;let Sw={map:{},getId(){return console.error($c),-1},getNode(){return console.error($c),null},removeNodeFromMap(){console.error($c)},has(){return console.error($c),!1},reset(){console.error($c)}};typeof window<"u"&&window.Proxy&&window.Reflect&&(Sw=new Proxy(Sw,{get(e,t,i){return t==="map"&&console.error($c),Reflect.get(e,t,i)}}));function vd(e,t,i={}){let a=null,c=0;return function(d){let m=Date.now();!c&&i.leading===!1&&(c=m);let l=t-(m-c),b=this,w=arguments;l<=0||l>t?(a&&(clearTimeout(a),a=null),c=m,e.apply(b,w)):!a&&i.trailing!==!1&&(a=setTimeout(()=>{c=i.leading===!1?0:Date.now(),a=null,e.apply(b,w)},l))}}function zm(e,t,i,a,c=window){const d=c.Object.getOwnPropertyDescriptor(e,t);return c.Object.defineProperty(e,t,a?i:{set(m){setTimeout(()=>{i.set.call(this,m)},0),d&&d.set&&d.set.call(this,m)}}),()=>zm(e,t,d||{},!0)}function au(e,t,i){try{if(!(t in e))return()=>{};const a=e[t],c=i(a);return typeof c=="function"&&(c.prototype=c.prototype||{},Object.defineProperties(c,{__rrweb_original__:{enumerable:!1,value:a}})),e[t]=c,()=>{e[t]=a}}catch{return()=>{}}}function z2(){return window.innerHeight||document.documentElement&&document.documentElement.clientHeight||document.body&&document.body.clientHeight}function O2(){return window.innerWidth||document.documentElement&&document.documentElement.clientWidth||document.body&&document.body.clientWidth}function Or(e,t,i,a){if(!e)return!1;if(e.nodeType===e.ELEMENT_NODE){let c=!1;const d=a&&e.matches(a);return typeof t=="string"?e.closest!==void 0?c=!d&&e.closest("."+t)!==null:c=!d&&e.classList.contains(t):!d&&e.classList.forEach(m=>{t.test(m)&&(c=!0)}),!c&&i&&(c=e.matches(i)),!d&&c||Or(e.parentNode,t,i,a)}return e.nodeType===e.TEXT_NODE,Or(e.parentNode,t,i,a)}function x_(e){return"__sn"in e?e.__sn.id===yd:!1}function B2(e,t){if(jh(e))return!1;const i=t.getId(e);return t.has(i)?e.parentNode&&e.parentNode.nodeType===e.DOCUMENT_NODE?!1:e.parentNode?B2(e.parentNode,t):!0:!0}function F2(e){return!!e.changedTouches}function kU(e=window){"NodeList"in e&&!e.NodeList.prototype.forEach&&(e.NodeList.prototype.forEach=Array.prototype.forEach),"DOMTokenList"in e&&!e.DOMTokenList.prototype.forEach&&(e.DOMTokenList.prototype.forEach=Array.prototype.forEach),Node.prototype.contains||(Node.prototype.contains=function(i){if(!(0 in arguments))throw new TypeError("1 argument is required");do if(this===i)return!0;while(i=i&&i.parentNode);return!1})}function N2(e){return"__sn"in e?e.__sn.type===Qi.Element&&e.__sn.tagName==="iframe":!1}function U2(e){return!!(e!=null&&e.shadowRoot)}function Ew(e){return"__ln"in e}class AU{constructor(){this.length=0,this.head=null}get(t){if(t>=this.length)throw new Error("Position outside of list range");let i=this.head;for(let a=0;a<t;a++)i=(i==null?void 0:i.next)||null;return i}addNode(t){const i={value:t,previous:null,next:null};if(t.__ln=i,t.previousSibling&&Ew(t.previousSibling)){const a=t.previousSibling.__ln.next;i.next=a,i.previous=t.previousSibling.__ln,t.previousSibling.__ln.next=i,a&&(a.previous=i)}else if(t.nextSibling&&Ew(t.nextSibling)&&t.nextSibling.__ln.previous){const a=t.nextSibling.__ln.previous;i.previous=a,i.next=t.nextSibling.__ln,t.nextSibling.__ln.previous=i,a&&(a.next=i)}else this.head&&(this.head.previous=i),i.next=this.head,this.head=i;this.length++}removeNode(t){const i=t.__ln;this.head&&(i.previous?(i.previous.next=i.next,i.next&&(i.next.previous=i.previous)):(this.head=i.next,this.head&&(this.head.previous=null)),t.__ln&&delete t.__ln,this.length--)}}const Tw=(e,t)=>`${e}@${t}`;function Cw(e){return"__sn"in e}class PU{constructor(){this.frozen=!1,this.locked=!1,this.texts=[],this.attributes=[],this.removes=[],this.mapRemoves=[],this.movedMap={},this.addedSet=new Set,this.movedSet=new Set,this.droppedSet=new Set,this.processMutations=t=>{t.forEach(this.processMutation),this.emit()},this.emit=()=>{if(this.frozen||this.locked)return;const t=[],i=new AU,a=l=>{let b=l,w=yd;for(;w===yd;)b=b&&b.nextSibling,w=b&&this.mirror.getId(b);return w},c=l=>{var b,w,C,k,M;const O=l.getRootNode?(b=l.getRootNode())===null||b===void 0?void 0:b.host:null;let j=O;for(;!((C=(w=j==null?void 0:j.getRootNode)===null||w===void 0?void 0:w.call(j))===null||C===void 0)&&C.host;)j=((M=(k=j==null?void 0:j.getRootNode)===null||k===void 0?void 0:k.call(j))===null||M===void 0?void 0:M.host)||null;const W=!this.doc.contains(l)&&(!j||!this.doc.contains(j));if(!l.parentNode||W)return;const le=jh(l.parentNode)?this.mirror.getId(O):this.mirror.getId(l.parentNode),he=a(l);if(le===-1||he===-1)return i.addNode(l);let be=Gh(l,{doc:this.doc,map:this.mirror.map,blockClass:this.blockClass,blockSelector:this.blockSelector,unblockSelector:this.unblockSelector,maskTextClass:this.maskTextClass,maskTextSelector:this.maskTextSelector,unmaskTextSelector:this.unmaskTextSelector,maskInputSelector:this.maskInputSelector,unmaskInputSelector:this.unmaskInputSelector,skipChild:!0,inlineStylesheet:this.inlineStylesheet,maskAllText:this.maskAllText,maskInputOptions:this.maskInputOptions,maskTextFn:this.maskTextFn,maskInputFn:this.maskInputFn,slimDOMOptions:this.slimDOMOptions,recordCanvas:this.recordCanvas,inlineImages:this.inlineImages,onSerialize:ge=>{N2(ge)&&this.iframeManager.addIframe(ge),U2(l)&&this.shadowDomManager.addShadowRoot(l.shadowRoot,document)},onIframeLoad:(ge,Pe)=>{this.iframeManager.attachIframe(ge,Pe),this.shadowDomManager.observeAttachShadow(ge)}});be&&t.push({parentId:le,nextId:he,node:be})};for(;this.mapRemoves.length;)this.mirror.removeNodeFromMap(this.mapRemoves.shift());for(const l of this.movedSet)Ry(this.removes,l,this.mirror)&&!this.movedSet.has(l.parentNode)||c(l);for(const l of this.addedSet)!My(this.droppedSet,l)&&!Ry(this.removes,l,this.mirror)||My(this.movedSet,l)?c(l):this.droppedSet.add(l);let d=null;for(;i.length;){let l=null;if(d){const b=this.mirror.getId(d.value.parentNode),w=a(d.value);b!==-1&&w!==-1&&(l=d)}if(!l)for(let b=i.length-1;b>=0;b--){const w=i.get(b);if(w){const C=this.mirror.getId(w.value.parentNode),k=a(w.value);if(C!==-1&&k!==-1){l=w;break}}}if(!l){for(;i.head;)i.removeNode(i.head.value);break}d=l.previous,i.removeNode(l.value),c(l.value)}const m={texts:this.texts.map(l=>({id:this.mirror.getId(l.node),value:l.value})).filter(l=>this.mirror.has(l.id)),attributes:this.attributes.map(l=>({id:this.mirror.getId(l.node),attributes:l.attributes})).filter(l=>this.mirror.has(l.id)),removes:this.removes,adds:t};!m.texts.length&&!m.attributes.length&&!m.removes.length&&!m.adds.length||(this.texts=[],this.attributes=[],this.removes=[],this.addedSet=new Set,this.movedSet=new Set,this.droppedSet=new Set,this.movedMap={},this.mutationCb(m))},this.processMutation=t=>{if(!x_(t.target))switch(t.type){case"characterData":{const i=t.target.textContent;!Or(t.target,this.blockClass,this.blockSelector,this.unblockSelector)&&i!==t.oldValue&&this.texts.push({value:Zp(t.target,this.maskTextClass,this.maskTextSelector,this.unmaskTextSelector,this.maskAllText)&&i?this.maskTextFn?this.maskTextFn(i):i.replace(/[\S]/g,"*"):i,node:t.target});break}case"attributes":{const i=t.target;let a=i.getAttribute(t.attributeName);if(t.attributeName==="value"&&(a=_d({input:i,maskInputSelector:this.maskInputSelector,unmaskInputSelector:this.unmaskInputSelector,maskInputOptions:this.maskInputOptions,tagName:i.tagName,type:i.getAttribute("type"),value:a,maskInputFn:this.maskInputFn})),Or(t.target,this.blockClass,this.blockSelector,this.unblockSelector)||a===t.oldValue)return;let c=this.attributes.find(d=>d.node===t.target);if(c||(c={node:t.target,attributes:{}},this.attributes.push(c)),t.attributeName==="type"&&i.tagName==="INPUT"&&(t.oldValue||"").toLowerCase()==="password"&&i.setAttribute("data-rr-is-password","true"),t.attributeName==="style"){const d=this.doc.createElement("span");t.oldValue&&d.setAttribute("style",t.oldValue),(c.attributes.style===void 0||c.attributes.style===null)&&(c.attributes.style={});try{const m=c.attributes.style;for(const l of Array.from(i.style)){const b=i.style.getPropertyValue(l),w=i.style.getPropertyPriority(l);(b!==d.style.getPropertyValue(l)||w!==d.style.getPropertyPriority(l))&&(w===""?m[l]=b:m[l]=[b,w])}for(const l of Array.from(d.style))i.style.getPropertyValue(l)===""&&(m[l]=!1)}catch(m){console.warn("[rrweb] Error when parsing update to style attribute:",m)}}else{const d=t.target;c.attributes[t.attributeName]=L2(this.doc,d,d.tagName,t.attributeName,a,this.maskAllText,this.unmaskTextSelector,this.maskTextFn)}break}case"childList":{t.addedNodes.forEach(i=>this.genAdds(i,t.target)),t.removedNodes.forEach(i=>{const a=this.mirror.getId(i),c=jh(t.target)?this.mirror.getId(t.target.host):this.mirror.getId(t.target);Or(t.target,this.blockClass,this.blockSelector,this.unblockSelector)||x_(i)||(this.addedSet.has(i)?(Py(this.addedSet,i),this.droppedSet.add(i)):this.addedSet.has(t.target)&&a===-1||B2(t.target,this.mirror)||(this.movedSet.has(i)&&this.movedMap[Tw(a,c)]?Py(this.movedSet,i):this.removes.push({parentId:c,id:a,isShadow:jh(t.target)?!0:void 0})),this.mapRemoves.push(i))});break}}},this.genAdds=(t,i)=>{if(!(i&&Or(i,this.blockClass,this.blockSelector,this.unblockSelector))){if(Cw(t)){if(x_(t))return;this.movedSet.add(t);let a=null;i&&Cw(i)&&(a=i.__sn.id),a&&(this.movedMap[Tw(t.__sn.id,a)]=!0)}else this.addedSet.add(t),this.droppedSet.delete(t);Or(t,this.blockClass,this.blockSelector,this.unblockSelector)||t.childNodes.forEach(a=>this.genAdds(a))}}}init(t){["mutationCb","blockClass","blockSelector","unblockSelector","maskTextClass","maskTextSelector","unmaskTextSelector","maskInputSelector","unmaskInputSelector","inlineStylesheet","maskAllText","maskInputOptions","maskTextFn","maskInputFn","recordCanvas","inlineImages","slimDOMOptions","doc","mirror","iframeManager","shadowDomManager","canvasManager"].forEach(i=>{this[i]=t[i]})}freeze(){this.frozen=!0,this.canvasManager.freeze()}unfreeze(){this.frozen=!1,this.canvasManager.unfreeze(),this.emit()}isFrozen(){return this.frozen}lock(){this.locked=!0,this.canvasManager.lock()}unlock(){this.locked=!1,this.canvasManager.unlock(),this.emit()}reset(){this.shadowDomManager.reset(),this.canvasManager.reset()}}function Py(e,t){e.delete(t),t.childNodes.forEach(i=>Py(e,i))}function Ry(e,t,i){const{parentNode:a}=t;if(!a)return!1;const c=i.getId(a);return e.some(d=>d.id===c)?!0:Ry(e,a,i)}function My(e,t){const{parentNode:i}=t;return i?e.has(i)?!0:My(e,i):!1}const Mn=e=>(...i)=>{try{return e(...i)}catch(a){try{a.__rrweb__=!0}catch{}throw a}},kl=[];function Rd(e){try{if("composedPath"in e){const t=e.composedPath();if(t.length)return t[0]}else if("path"in e&&e.path.length)return e.path[0]}catch{}return e&&e.target}function $2(e,t){var i,a;const c=new PU;kl.push(c),c.init(e);let d=window.MutationObserver||window.__rrMutationObserver;const m=(a=(i=window==null?void 0:window.Zone)===null||i===void 0?void 0:i.__symbol__)===null||a===void 0?void 0:a.call(i,"MutationObserver");m&&window[m]&&(d=window[m]);const l=new d(Mn(b=>{e.onMutation&&e.onMutation(b)===!1||c.processMutations(b)}));return l.observe(t,{attributes:!0,attributeOldValue:!0,characterData:!0,characterDataOldValue:!0,childList:!0,subtree:!0}),l}function RU({mousemoveCb:e,sampling:t,doc:i,mirror:a}){if(t.mousemove===!1)return()=>{};const c=typeof t.mousemove=="number"?t.mousemove:50,d=typeof t.mousemoveCallback=="number"?t.mousemoveCallback:500;let m=[],l;const b=vd(k=>{const M=Date.now()-l;Mn(e)(m.map(O=>(O.timeOffset-=M,O)),k),m=[],l=null},d),w=vd(k=>{const M=Rd(k),{clientX:O,clientY:j}=F2(k)?k.changedTouches[0]:k;l||(l=Date.now()),m.push({x:O,y:j,id:a.getId(M),timeOffset:Date.now()-l}),b(typeof DragEvent<"u"&&k instanceof DragEvent?lr.Drag:k instanceof MouseEvent?lr.MouseMove:lr.TouchMove)},c,{trailing:!1}),C=[fs("mousemove",Mn(w),i),fs("touchmove",Mn(w),i),fs("drag",Mn(w),i)];return Mn(()=>{C.forEach(k=>k())})}function MU({mouseInteractionCb:e,doc:t,mirror:i,blockClass:a,blockSelector:c,unblockSelector:d,sampling:m}){if(m.mouseInteraction===!1)return()=>{};const l=m.mouseInteraction===!0||m.mouseInteraction===void 0?{}:m.mouseInteraction,b=[],w=C=>k=>{const M=Rd(k);if(Or(M,a,c,d))return;const O=F2(k)?k.changedTouches[0]:k;if(!O)return;const j=i.getId(M),{clientX:W,clientY:le}=O;Mn(e)({type:Wp[C],id:j,x:W,y:le})};return Object.keys(Wp).filter(C=>Number.isNaN(Number(C))&&!C.endsWith("_Departed")&&l[C]!==!1).forEach(C=>{const k=C.toLowerCase(),M=Mn(w(C));b.push(fs(k,M,t))}),Mn(()=>{b.forEach(C=>C())})}function V2({scrollCb:e,doc:t,mirror:i,blockClass:a,blockSelector:c,unblockSelector:d,sampling:m}){const l=vd(b=>{const w=Rd(b);if(!w||Or(w,a,c,d))return;const C=i.getId(w);if(w===t){const k=t.scrollingElement||t.documentElement;Mn(e)({id:C,x:k.scrollLeft,y:k.scrollTop})}else Mn(e)({id:C,x:w.scrollLeft,y:w.scrollTop})},m.scroll||100);return fs("scroll",Mn(l),t)}function DU({viewportResizeCb:e}){let t=-1,i=-1;const a=vd(()=>{const c=z2(),d=O2();(t!==c||i!==d)&&(Mn(e)({width:Number(d),height:Number(c)}),t=c,i=d)},200);return fs("resize",Mn(a),window)}function Iw(e,t){const i=Object.assign({},e);return t||delete i.userTriggered,i}const LU=["INPUT","TEXTAREA","SELECT"],kw=new WeakMap;function zU({inputCb:e,doc:t,mirror:i,blockClass:a,blockSelector:c,unblockSelector:d,ignoreClass:m,ignoreSelector:l,maskInputSelector:b,unmaskInputSelector:w,maskInputOptions:C,maskInputFn:k,sampling:M,userTriggeredOnInput:O}){function j(Pe){let Ue=Rd(Pe);const Oe=Ue&&Ue.tagName,Te=Pe.isTrusted;if(Oe==="OPTION"&&(Ue=Ue.parentElement),!Ue||!Oe||LU.indexOf(Oe)<0||Or(Ue,a,c,d))return;const V=Ue,Z=R2(V);if(V.classList.contains(m)||l&&V.matches(l))return;let ae=Iy(V,Oe,Z),ke=!1;(Z==="radio"||Z==="checkbox")&&(ke=Ue.checked),iU({maskInputOptions:C,maskInputSelector:b,tagName:Oe,type:Z})&&(ae=_d({input:V,maskInputOptions:C,maskInputSelector:b,unmaskInputSelector:w,tagName:Oe,type:Z,value:ae,maskInputFn:k})),W(Ue,Mn(Iw)({text:ae,isChecked:ke,userTriggered:Te},O));const _e=Ue.name;Z==="radio"&&_e&&ke&&t.querySelectorAll(`input[type="radio"][name="${_e}"]`).forEach(oe=>{if(oe!==Ue){const Re=_d({input:oe,maskInputOptions:C,maskInputSelector:b,unmaskInputSelector:w,tagName:Oe,type:Z,value:Iy(oe,Oe,Z),maskInputFn:k});W(oe,Mn(Iw)({text:Re,isChecked:!ke,userTriggered:!1},O))}})}function W(Pe,Ue){const Oe=kw.get(Pe);if(!Oe||Oe.text!==Ue.text||Oe.isChecked!==Ue.isChecked){kw.set(Pe,Ue);const Te=i.getId(Pe);e(Object.assign(Object.assign({},Ue),{id:Te}))}}const he=(M.input==="last"?["change"]:["input","change"]).map(Pe=>fs(Pe,Mn(j),t)),be=Object.getOwnPropertyDescriptor(HTMLInputElement.prototype,"value"),ge=[[HTMLInputElement.prototype,"value"],[HTMLInputElement.prototype,"checked"],[HTMLSelectElement.prototype,"value"],[HTMLTextAreaElement.prototype,"value"],[HTMLSelectElement.prototype,"selectedIndex"],[HTMLOptionElement.prototype,"selected"]];return be&&be.set&&he.push(...ge.map(Pe=>zm(Pe[0],Pe[1],{set(){Mn(j)({target:this})}}))),Mn(()=>{he.forEach(Pe=>Pe())})}function Yp(e){const t=[];function i(a,c){if(rp("CSSGroupingRule")&&a.parentRule instanceof CSSGroupingRule||rp("CSSMediaRule")&&a.parentRule instanceof CSSMediaRule||rp("CSSSupportsRule")&&a.parentRule instanceof CSSSupportsRule||rp("CSSConditionRule")&&a.parentRule instanceof CSSConditionRule){const m=Array.from(a.parentRule.cssRules).indexOf(a);c.unshift(m)}else{const m=Array.from(a.parentStyleSheet.cssRules).indexOf(a);c.unshift(m)}return c}return i(e,t)}function OU({styleSheetRuleCb:e,mirror:t},{win:i}){if(!i.CSSStyleSheet||!i.CSSStyleSheet.prototype)return()=>{};const a=i.CSSStyleSheet.prototype.insertRule;i.CSSStyleSheet.prototype.insertRule=new Proxy(a,{apply:Mn((l,b,w)=>{const[C,k]=w,M=t.getId(b.ownerNode);return M!==-1&&e({id:M,adds:[{rule:C,index:k}]}),l.apply(b,w)})});const c=i.CSSStyleSheet.prototype.deleteRule;i.CSSStyleSheet.prototype.deleteRule=new Proxy(c,{apply:Mn((l,b,w)=>{const[C]=w,k=t.getId(b.ownerNode);return k!==-1&&e({id:k,removes:[{index:C}]}),l.apply(b,w)})});const d={};sp("CSSGroupingRule")?d.CSSGroupingRule=i.CSSGroupingRule:(sp("CSSMediaRule")&&(d.CSSMediaRule=i.CSSMediaRule),sp("CSSConditionRule")&&(d.CSSConditionRule=i.CSSConditionRule),sp("CSSSupportsRule")&&(d.CSSSupportsRule=i.CSSSupportsRule));const m={};return Object.entries(d).forEach(([l,b])=>{m[l]={insertRule:b.prototype.insertRule,deleteRule:b.prototype.deleteRule},b.prototype.insertRule=new Proxy(m[l].insertRule,{apply:Mn((w,C,k)=>{const[M,O]=k,j=t.getId(C.parentStyleSheet.ownerNode);return j!==-1&&e({id:j,adds:[{rule:M,index:[...Yp(C),O||0]}]}),w.apply(C,k)})}),b.prototype.deleteRule=new Proxy(m[l].deleteRule,{apply:Mn((w,C,k)=>{const[M]=k,O=t.getId(C.parentStyleSheet.ownerNode);return O!==-1&&e({id:O,removes:[{index:[...Yp(C),M]}]}),w.apply(C,k)})})}),Mn(()=>{i.CSSStyleSheet.prototype.insertRule=a,i.CSSStyleSheet.prototype.deleteRule=c,Object.entries(d).forEach(([l,b])=>{b.prototype.insertRule=m[l].insertRule,b.prototype.deleteRule=m[l].deleteRule})})}function BU({styleDeclarationCb:e,mirror:t},{win:i}){const a=i.CSSStyleDeclaration.prototype.setProperty;i.CSSStyleDeclaration.prototype.setProperty=new Proxy(a,{apply:Mn((d,m,l)=>{var b,w;const[C,k,M]=l,O=t.getId((w=(b=m.parentRule)===null||b===void 0?void 0:b.parentStyleSheet)===null||w===void 0?void 0:w.ownerNode);return O!==-1&&e({id:O,set:{property:C,value:k,priority:M},index:Yp(m.parentRule)}),d.apply(m,l)})});const c=i.CSSStyleDeclaration.prototype.removeProperty;return i.CSSStyleDeclaration.prototype.removeProperty=new Proxy(c,{apply:Mn((d,m,l)=>{var b,w;const[C]=l,k=t.getId((w=(b=m.parentRule)===null||b===void 0?void 0:b.parentStyleSheet)===null||w===void 0?void 0:w.ownerNode);return k!==-1&&e({id:k,remove:{property:C},index:Yp(m.parentRule)}),d.apply(m,l)})}),Mn(()=>{i.CSSStyleDeclaration.prototype.setProperty=a,i.CSSStyleDeclaration.prototype.removeProperty=c})}function FU({mediaInteractionCb:e,blockClass:t,blockSelector:i,unblockSelector:a,mirror:c,sampling:d}){const m=b=>vd(Mn(w=>{const C=Rd(w);if(!C||Or(C,t,i,a))return;const{currentTime:k,volume:M,muted:O}=C;e({type:b,id:c.getId(C),currentTime:k,volume:M,muted:O})}),d.media||500),l=[fs("play",m(0)),fs("pause",m(1)),fs("seeked",m(2)),fs("volumechange",m(3))];return Mn(()=>{l.forEach(b=>b())})}function NU({fontCb:e,doc:t}){const i=t.defaultView;if(!i)return()=>{};const a=[],c=new WeakMap,d=i.FontFace;i.FontFace=function(b,w,C){const k=new d(b,w,C);return c.set(k,{family:b,buffer:typeof w!="string",descriptors:C,fontSource:typeof w=="string"?w:JSON.stringify(Array.from(new Uint8Array(w)))}),k};const m=au(t.fonts,"add",function(l){return function(b){return setTimeout(()=>{const w=c.get(b);w&&(e(w),c.delete(b))},0),l.apply(this,[b])}});return a.push(()=>{i.FontFace=d}),a.push(m),Mn(()=>{a.forEach(l=>l())})}function UU(e,t){const{mutationCb:i,mousemoveCb:a,mouseInteractionCb:c,scrollCb:d,viewportResizeCb:m,inputCb:l,mediaInteractionCb:b,styleSheetRuleCb:w,styleDeclarationCb:C,canvasMutationCb:k,fontCb:M}=e;e.mutationCb=(...O)=>{t.mutation&&t.mutation(...O),i(...O)},e.mousemoveCb=(...O)=>{t.mousemove&&t.mousemove(...O),a(...O)},e.mouseInteractionCb=(...O)=>{t.mouseInteraction&&t.mouseInteraction(...O),c(...O)},e.scrollCb=(...O)=>{t.scroll&&t.scroll(...O),d(...O)},e.viewportResizeCb=(...O)=>{t.viewportResize&&t.viewportResize(...O),m(...O)},e.inputCb=(...O)=>{t.input&&t.input(...O),l(...O)},e.mediaInteractionCb=(...O)=>{t.mediaInteaction&&t.mediaInteaction(...O),b(...O)},e.styleSheetRuleCb=(...O)=>{t.styleSheetRule&&t.styleSheetRule(...O),w(...O)},e.styleDeclarationCb=(...O)=>{t.styleDeclaration&&t.styleDeclaration(...O),C(...O)},e.canvasMutationCb=(...O)=>{t.canvasMutation&&t.canvasMutation(...O),k(...O)},e.fontCb=(...O)=>{t.font&&t.font(...O),M(...O)}}function $U(e,t={}){const i=e.doc.defaultView;if(!i)return()=>{};UU(e,t);const a=$2(e,e.doc),c=RU(e),d=MU(e),m=V2(e),l=DU(e),b=zU(e),w=FU(e),C=OU(e,{win:i}),k=BU(e,{win:i}),M=e.collectFonts?NU(e):()=>{},O=[];for(const j of e.plugins)O.push(j.observer(j.callback,i,j.options));return Mn(()=>{kl.forEach(j=>j.reset()),a.disconnect(),c(),d(),m(),l(),b(),w();try{C(),k()}catch{}M(),O.forEach(j=>j())})}function rp(e){return typeof window[e]<"u"}function sp(e){return!!(typeof window[e]<"u"&&window[e].prototype&&"insertRule"in window[e].prototype&&"deleteRule"in window[e].prototype)}class VU{constructor(t){this.iframes=new WeakMap,this.mutationCb=t.mutationCb}addIframe(t){this.iframes.set(t,!0)}addLoadListener(t){this.loadListener=t}attachIframe(t,i){var a;this.mutationCb({adds:[{parentId:t.__sn.id,nextId:null,node:i}],removes:[],texts:[],attributes:[],isAttachIframe:!0}),(a=this.loadListener)===null||a===void 0||a.call(this,t)}}class jU{constructor(t){this.restorePatches=[],this.mutationCb=t.mutationCb,this.scrollCb=t.scrollCb,this.bypassOptions=t.bypassOptions,this.mirror=t.mirror;const i=this;this.restorePatches.push(au(HTMLElement.prototype,"attachShadow",function(a){return function(){const c=a.apply(this,arguments);return this.shadowRoot&&i.addShadowRoot(this.shadowRoot,this.ownerDocument),c}}))}addShadowRoot(t,i){$2(Object.assign(Object.assign({},this.bypassOptions),{doc:i,mutationCb:this.mutationCb,mirror:this.mirror,shadowDomManager:this}),t),V2(Object.assign(Object.assign({},this.bypassOptions),{scrollCb:this.scrollCb,doc:t,mirror:this.mirror}))}observeAttachShadow(t){if(t.contentWindow){const i=this;this.restorePatches.push(au(t.contentWindow.HTMLElement.prototype,"attachShadow",function(a){return function(){const c=a.apply(this,arguments);return this.shadowRoot&&i.addShadowRoot(this.shadowRoot,t.contentDocument),c}}))}}reset(){this.restorePatches.forEach(t=>t())}}function GU(e,t){var i={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(i[a]=e[a]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var c=0,a=Object.getOwnPropertySymbols(e);c<a.length;c++)t.indexOf(a[c])<0&&Object.prototype.propertyIsEnumerable.call(e,a[c])&&(i[a[c]]=e[a[c]]);return i}function qU(e,t,i,a,c,d){const m=[],l=Object.getOwnPropertyNames(t.CanvasRenderingContext2D.prototype);for(const b of l)try{if(typeof t.CanvasRenderingContext2D.prototype[b]!="function")continue;const w=au(t.CanvasRenderingContext2D.prototype,b,function(C){return function(...k){return Or(this.canvas,i,c,a)||setTimeout(()=>{const M=[...k];if(b==="drawImage"&&M[0]&&M[0]instanceof HTMLCanvasElement){const O=M[0],j=O.getContext("2d");let W=j==null?void 0:j.getImageData(0,0,O.width,O.height),le=W==null?void 0:W.data;M[0]=JSON.stringify(le)}e(this.canvas,{type:su["2D"],property:b,args:M})},0),C.apply(this,k)}});m.push(w)}catch{const C=zm(t.CanvasRenderingContext2D.prototype,b,{set(k){e(this.canvas,{type:su["2D"],property:b,args:[k],setter:!0})}});m.push(C)}return()=>{m.forEach(b=>b())}}function HU(e,t,i,a){const c=[];try{const d=au(e.HTMLCanvasElement.prototype,"getContext",function(m){return function(l,...b){return Or(this,t,i,a)||"__context"in this||(this.__context=l),m.apply(this,[l,...b])}});c.push(d)}catch{console.error("failed to patch HTMLCanvasElement.prototype.getContext")}return()=>{c.forEach(d=>d())}}var Gc="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",ZU=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var ap=0;ap<Gc.length;ap++)ZU[Gc.charCodeAt(ap)]=ap;var WU=function(e){var t=new Uint8Array(e),i,a=t.length,c="";for(i=0;i<a;i+=3)c+=Gc[t[i]>>2],c+=Gc[(t[i]&3)<<4|t[i+1]>>4],c+=Gc[(t[i+1]&15)<<2|t[i+2]>>6],c+=Gc[t[i+2]&63];return a%3===2?c=c.substring(0,c.length-1)+"=":a%3===1&&(c=c.substring(0,c.length-2)+"=="),c};const Aw=new Map;function YU(e,t){let i=Aw.get(e);return i||(i=new Map,Aw.set(e,i)),i.has(t)||i.set(t,[]),i.get(t)}const j2=(e,t,i)=>{if(!e||!(G2(e,t)||typeof e=="object"))return;const a=e.constructor.name,c=YU(i,a);let d=c.indexOf(e);return d===-1&&(d=c.length,c.push(e)),d};function vp(e,t,i){if(e instanceof Array)return e.map(a=>vp(a,t,i));if(e===null)return e;if(e instanceof Float32Array||e instanceof Float64Array||e instanceof Int32Array||e instanceof Uint32Array||e instanceof Uint8Array||e instanceof Uint16Array||e instanceof Int16Array||e instanceof Int8Array||e instanceof Uint8ClampedArray)return{rr_type:e.constructor.name,args:[Object.values(e)]};if(e instanceof ArrayBuffer){const a=e.constructor.name,c=WU(e);return{rr_type:a,base64:c}}else{if(e instanceof DataView)return{rr_type:e.constructor.name,args:[vp(e.buffer,t,i),e.byteOffset,e.byteLength]};if(e instanceof HTMLImageElement){const a=e.constructor.name,{src:c}=e;return{rr_type:a,src:c}}else{if(e instanceof ImageData)return{rr_type:e.constructor.name,args:[vp(e.data,t,i),e.width,e.height]};if(G2(e,t)||typeof e=="object"){const a=e.constructor.name,c=j2(e,t,i);return{rr_type:a,index:c}}}}return e}const XU=(e,t,i)=>[...e].map(a=>vp(a,t,i)),G2=(e,t)=>!!["WebGLActiveInfo","WebGLBuffer","WebGLFramebuffer","WebGLProgram","WebGLRenderbuffer","WebGLShader","WebGLShaderPrecisionFormat","WebGLTexture","WebGLUniformLocation","WebGLVertexArrayObject","WebGLVertexArrayObjectOES"].filter(c=>typeof t[c]=="function").find(c=>e instanceof t[c]);function Pw(e,t,i,a,c,d,m,l){const b=[],w=Object.getOwnPropertyNames(e);for(const C of w)try{if(typeof e[C]!="function")continue;const k=au(e,C,function(M){return function(...O){const j=M.apply(this,O);if(j2(j,l,e),!Or(this.canvas,a,d,c)){const W=m.getId(this.canvas),le=XU([...O],l,e),he={type:t,property:C,args:le};i(this.canvas,he)}return j}});b.push(k)}catch{const M=zm(e,C,{set(O){i(this.canvas,{type:t,property:C,args:[O],setter:!0})}});b.push(M)}return b}function KU(e,t,i,a,c,d){const m=[];return m.push(...Pw(t.WebGLRenderingContext.prototype,su.WebGL,e,i,a,c,d,t)),typeof t.WebGL2RenderingContext<"u"&&m.push(...Pw(t.WebGL2RenderingContext.prototype,su.WebGL2,e,i,a,c,d,t)),()=>{m.forEach(l=>l())}}class JU{reset(){this.pendingCanvasMutations.clear(),this.resetObservers&&this.resetObservers()}freeze(){this.frozen=!0}unfreeze(){this.frozen=!1}lock(){this.locked=!0}unlock(){this.locked=!1}constructor(t){this.pendingCanvasMutations=new Map,this.rafStamps={latestId:0,invokeId:null},this.frozen=!1,this.locked=!1,this.processMutation=function(i,a){(this.rafStamps.invokeId&&this.rafStamps.latestId!==this.rafStamps.invokeId||!this.rafStamps.invokeId)&&(this.rafStamps.invokeId=this.rafStamps.latestId),this.pendingCanvasMutations.has(i)||this.pendingCanvasMutations.set(i,[]),this.pendingCanvasMutations.get(i).push(a)},this.mutationCb=t.mutationCb,this.mirror=t.mirror,t.recordCanvas===!0&&this.initCanvasMutationObserver(t.win,t.blockClass,t.blockSelector,t.unblockSelector)}initCanvasMutationObserver(t,i,a,c){this.startRAFTimestamping(),this.startPendingCanvasMutationFlusher();const d=HU(t,i,c,a),m=qU(this.processMutation.bind(this),t,i,c,a,this.mirror),l=KU(this.processMutation.bind(this),t,i,c,a,this.mirror);this.resetObservers=()=>{d(),m(),l()}}startPendingCanvasMutationFlusher(){requestAnimationFrame(()=>this.flushPendingCanvasMutations())}startRAFTimestamping(){const t=i=>{this.rafStamps.latestId=i,requestAnimationFrame(t)};requestAnimationFrame(t)}flushPendingCanvasMutations(){this.pendingCanvasMutations.forEach((t,i)=>{const a=this.mirror.getId(i);this.flushPendingCanvasMutationFor(i,a)}),requestAnimationFrame(()=>this.flushPendingCanvasMutations())}flushPendingCanvasMutationFor(t,i){if(this.frozen||this.locked)return;const a=this.pendingCanvasMutations.get(t);if(!a||i===-1)return;const c=a.map(m=>GU(m,["type"])),{type:d}=a[0];this.mutationCb({id:i,type:d,commands:c}),this.pendingCanvasMutations.delete(t)}}function ar(e){return Object.assign(Object.assign({},e),{timestamp:Date.now()})}let Vi,qh;const Lh=IU();function Bl(e={}){const{emit:t,checkoutEveryNms:i,checkoutEveryNth:a,blockClass:c="rr-block",blockSelector:d=null,unblockSelector:m=null,ignoreClass:l="rr-ignore",ignoreSelector:b=null,maskTextClass:w="rr-mask",maskTextSelector:C=null,maskInputSelector:k=null,unmaskTextSelector:M=null,unmaskInputSelector:O=null,inlineStylesheet:j=!0,maskAllText:W=!1,maskAllInputs:le,maskInputOptions:he,slimDOMOptions:be,maskInputFn:ge,maskTextFn:Pe,hooks:Ue,packFn:Oe,sampling:Te={},mousemoveWait:V,recordCanvas:Z=!1,userTriggeredOnInput:ae=!1,collectFonts:ke=!1,inlineImages:_e=!1,plugins:oe,keepIframeSrcFn:Re=()=>!1,onMutation:nt}=e;if(!t)throw new Error("emit function is required");V!==void 0&&Te.mousemove===void 0&&(Te.mousemove=V);const Qe=le===!0?{color:!0,date:!0,"datetime-local":!0,email:!0,month:!0,number:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0,textarea:!0,select:!0,radio:!0,checkbox:!0}:he!==void 0?he:{},qe=be===!0||be==="all"?{script:!0,comment:!0,headFavicon:!0,headWhitespace:!0,headMetaSocial:!0,headMetaRobots:!0,headMetaHttpEquiv:!0,headMetaVerification:!0,headMetaAuthorship:be==="all",headMetaDescKeywords:be==="all"}:be||{};kU();let je,Ze=0;const kt=xe=>{for(const Ke of oe||[])Ke.eventProcessor&&(xe=Ke.eventProcessor(xe));return Oe&&(xe=Oe(xe)),xe};Vi=(xe,Ke)=>{var Fe;if(!((Fe=kl[0])===null||Fe===void 0)&&Fe.isFrozen()&&xe.type!==Nn.FullSnapshot&&!(xe.type===Nn.IncrementalSnapshot&&xe.data.source===lr.Mutation)&&kl.forEach(Ge=>Ge.unfreeze()),t(kt(xe),Ke),xe.type===Nn.FullSnapshot)je=xe,Ze=0;else if(xe.type===Nn.IncrementalSnapshot){if(xe.data.source===lr.Mutation&&xe.data.isAttachIframe)return;Ze++;const Ge=a&&Ze>=a,ft=i&&xe.timestamp-je.timestamp>i;(Ge||ft)&&qh(!0)}};const Et=xe=>{Vi(ar({type:Nn.IncrementalSnapshot,data:Object.assign({source:lr.Mutation},xe)}))},rt=xe=>Vi(ar({type:Nn.IncrementalSnapshot,data:Object.assign({source:lr.Scroll},xe)})),At=xe=>Vi(ar({type:Nn.IncrementalSnapshot,data:Object.assign({source:lr.CanvasMutation},xe)})),Pt=new VU({mutationCb:Et}),Wt=new JU({recordCanvas:Z,mutationCb:At,win:window,blockClass:c,blockSelector:d,unblockSelector:m,mirror:Lh}),He=new jU({mutationCb:Et,scrollCb:rt,bypassOptions:{onMutation:nt,blockClass:c,blockSelector:d,unblockSelector:m,maskTextClass:w,maskTextSelector:C,unmaskTextSelector:M,maskInputSelector:k,unmaskInputSelector:O,inlineStylesheet:j,maskAllText:W,maskInputOptions:Qe,maskTextFn:Pe,maskInputFn:ge,recordCanvas:Z,inlineImages:_e,sampling:Te,slimDOMOptions:qe,iframeManager:Pt,canvasManager:Wt},mirror:Lh});qh=(xe=!1)=>{var Ke,Fe,Ge,ft;Vi(ar({type:Nn.Meta,data:{href:window.location.href,width:O2(),height:z2()}}),xe),kl.forEach(ye=>ye.lock());const[X,U]=TU(document,{blockClass:c,blockSelector:d,unblockSelector:m,maskTextClass:w,maskTextSelector:C,unmaskTextSelector:M,maskInputSelector:k,unmaskInputSelector:O,inlineStylesheet:j,maskAllText:W,maskAllInputs:Qe,maskTextFn:Pe,slimDOM:qe,recordCanvas:Z,inlineImages:_e,onSerialize:ye=>{N2(ye)&&Pt.addIframe(ye),U2(ye)&&He.addShadowRoot(ye.shadowRoot,document)},onIframeLoad:(ye,Le)=>{Pt.attachIframe(ye,Le),He.observeAttachShadow(ye)},keepIframeSrcFn:Re});if(!X)return console.warn("Failed to snapshot the document");Lh.map=U,Vi(ar({type:Nn.FullSnapshot,data:{node:X,initialOffset:{left:window.pageXOffset!==void 0?window.pageXOffset:(document==null?void 0:document.documentElement.scrollLeft)||((Fe=(Ke=document==null?void 0:document.body)===null||Ke===void 0?void 0:Ke.parentElement)===null||Fe===void 0?void 0:Fe.scrollLeft)||(document==null?void 0:document.body.scrollLeft)||0,top:window.pageYOffset!==void 0?window.pageYOffset:(document==null?void 0:document.documentElement.scrollTop)||((ft=(Ge=document==null?void 0:document.body)===null||Ge===void 0?void 0:Ge.parentElement)===null||ft===void 0?void 0:ft.scrollTop)||(document==null?void 0:document.body.scrollTop)||0}}})),kl.forEach(ye=>ye.unlock())};try{const xe=[];xe.push(fs("DOMContentLoaded",()=>{Vi(ar({type:Nn.DomContentLoaded,data:{}}))}));const Ke=Ge=>{var ft;return Mn($U)({onMutation:nt,mutationCb:Et,mousemoveCb:(X,U)=>Vi(ar({type:Nn.IncrementalSnapshot,data:{source:U,positions:X}})),mouseInteractionCb:X=>Vi(ar({type:Nn.IncrementalSnapshot,data:Object.assign({source:lr.MouseInteraction},X)})),scrollCb:rt,viewportResizeCb:X=>Vi(ar({type:Nn.IncrementalSnapshot,data:Object.assign({source:lr.ViewportResize},X)})),inputCb:X=>Vi(ar({type:Nn.IncrementalSnapshot,data:Object.assign({source:lr.Input},X)})),mediaInteractionCb:X=>Vi(ar({type:Nn.IncrementalSnapshot,data:Object.assign({source:lr.MediaInteraction},X)})),styleSheetRuleCb:X=>Vi(ar({type:Nn.IncrementalSnapshot,data:Object.assign({source:lr.StyleSheetRule},X)})),styleDeclarationCb:X=>Vi(ar({type:Nn.IncrementalSnapshot,data:Object.assign({source:lr.StyleDeclaration},X)})),canvasMutationCb:At,fontCb:X=>Vi(ar({type:Nn.IncrementalSnapshot,data:Object.assign({source:lr.Font},X)})),blockClass:c,ignoreClass:l,ignoreSelector:b,maskTextClass:w,maskTextSelector:C,unmaskTextSelector:M,maskInputSelector:k,unmaskInputSelector:O,maskInputOptions:Qe,inlineStylesheet:j,sampling:Te,recordCanvas:Z,inlineImages:_e,userTriggeredOnInput:ae,collectFonts:ke,doc:Ge,maskAllText:W,maskInputFn:ge,maskTextFn:Pe,blockSelector:d,unblockSelector:m,slimDOMOptions:qe,mirror:Lh,iframeManager:Pt,shadowDomManager:He,canvasManager:Wt,plugins:((ft=oe==null?void 0:oe.filter(X=>X.observer))===null||ft===void 0?void 0:ft.map(X=>({observer:X.observer,options:X.options,callback:U=>Vi(ar({type:Nn.Plugin,data:{plugin:X.name,payload:U}}))})))||[]},Ue)};Pt.addLoadListener(Ge=>{try{xe.push(Ke(Ge.contentDocument))}catch(ft){console.warn(ft)}});const Fe=()=>{qh(),xe.push(Ke(document))};return document.readyState==="interactive"||document.readyState==="complete"?Fe():xe.push(fs("load",()=>{Vi(ar({type:Nn.Load,data:{}})),Fe()},window)),()=>{xe.forEach(Ge=>Ge())}}catch(xe){console.warn(xe)}}Bl.addCustomEvent=(e,t)=>{if(!Vi)throw new Error("please add custom event after start recording");Vi(ar({type:Nn.Custom,data:{tag:e,payload:t}}))};Bl.freezePage=()=>{kl.forEach(e=>e.freeze())};Bl.takeFullSnapshot=e=>{if(!qh)throw new Error("please take full snapshot after start recording");qh(e)};Bl.mirror=Lh;function c0(e){return e>9999999999?e:e*1e3}function QU(e){return e>9999999999?e/1e3:e}function Om(e,t){t.category!=="sentry.transaction"&&(["ui.click","ui.input"].includes(t.category)?e.triggerUserActivity():e.checkAndHandleExpiredSession(),e.addUpdate(()=>(e.throttledAddEvent({type:Nn.Custom,timestamp:(t.timestamp||0)*1e3,data:{tag:"breadcrumb",payload:da(t,10,1e3)}}),t.category==="console")))}const e4="button,a";function u0(e){const t=q2(e);return!t||!(t instanceof Element)?t:t.closest(e4)||t}function q2(e){return t4(e)?e.target:e}function t4(e){return typeof e=="object"&&!!e&&"target"in e}let Mo;function n4(e){return Mo||(Mo=[],i4()),Mo.push(e),()=>{const t=Mo?Mo.indexOf(e):-1;t>-1&&Mo.splice(t,1)}}function i4(){tr(In,"open",function(e){return function(...t){if(Mo)try{Mo.forEach(i=>i())}catch{}return e.apply(In,t)}})}function r4(e,t,i){e.handleClick(t,i)}class s4{constructor(t,i,a=Om){this._lastMutation=0,this._lastScroll=0,this._clicks=[],this._timeout=i.timeout/1e3,this._threshold=i.threshold/1e3,this._scollTimeout=i.scrollTimeout/1e3,this._replay=t,this._ignoreSelector=i.ignoreSelector,this._addBreadcrumbEvent=a}addListeners(){const t=()=>{this._lastMutation=op()},i=()=>{this._lastScroll=op()},a=n4(()=>{this._lastMutation=op()}),c=m=>{if(!m.target)return;const l=u0(m);l&&this._handleMultiClick(l)},d=new MutationObserver(t);d.observe(In.document.documentElement,{attributes:!0,characterData:!0,childList:!0,subtree:!0}),In.addEventListener("scroll",i,{passive:!0}),In.addEventListener("click",c,{passive:!0}),this._teardown=()=>{In.removeEventListener("scroll",i),In.removeEventListener("click",c),a(),d.disconnect(),this._clicks=[],this._lastMutation=0,this._lastScroll=0}}removeListeners(){this._teardown&&this._teardown(),this._checkClickTimeout&&clearTimeout(this._checkClickTimeout)}handleClick(t,i){if(o4(i,this._ignoreSelector)||!l4(t))return;const a={timestamp:QU(t.timestamp),clickBreadcrumb:t,clickCount:0,node:i};this._clicks.some(c=>c.node===a.node&&Math.abs(c.timestamp-a.timestamp)<1)||(this._clicks.push(a),this._clicks.length===1&&this._scheduleCheckClicks())}_handleMultiClick(t){this._getClicks(t).forEach(i=>{i.clickCount++})}_getClicks(t){return this._clicks.filter(i=>i.node===t)}_checkClicks(){const t=[],i=op();this._clicks.forEach(a=>{!a.mutationAfter&&this._lastMutation&&(a.mutationAfter=a.timestamp<=this._lastMutation?this._lastMutation-a.timestamp:void 0),!a.scrollAfter&&this._lastScroll&&(a.scrollAfter=a.timestamp<=this._lastScroll?this._lastScroll-a.timestamp:void 0),a.timestamp+this._timeout<=i&&t.push(a)});for(const a of t){const c=this._clicks.indexOf(a);c>-1&&(this._generateBreadcrumbs(a),this._clicks.splice(c,1))}this._clicks.length&&this._scheduleCheckClicks()}_generateBreadcrumbs(t){const i=this._replay,a=t.scrollAfter&&t.scrollAfter<=this._scollTimeout,c=t.mutationAfter&&t.mutationAfter<=this._threshold,d=!a&&!c,{clickCount:m,clickBreadcrumb:l}=t;if(d){const b=Math.min(t.mutationAfter||this._timeout,this._timeout)*1e3,w=b<this._timeout*1e3?"mutation":"timeout",C={type:"default",message:l.message,timestamp:l.timestamp,category:"ui.slowClickDetected",data:{...l.data,url:In.location.href,route:i.getCurrentRoute(),timeAfterClickMs:b,endReason:w,clickCount:m||1}};this._addBreadcrumbEvent(i,C);return}if(m>1){const b={type:"default",message:l.message,timestamp:l.timestamp,category:"ui.multiClick",data:{...l.data,url:In.location.href,route:i.getCurrentRoute(),clickCount:m,metric:!0}};this._addBreadcrumbEvent(i,b)}}_scheduleCheckClicks(){this._checkClickTimeout&&clearTimeout(this._checkClickTimeout),this._checkClickTimeout=setTimeout(()=>this._checkClicks(),1e3)}}const a4=["A","BUTTON","INPUT"];function o4(e,t){return!!(!a4.includes(e.tagName)||e.tagName==="INPUT"&&!["submit","button"].includes(e.getAttribute("type")||"")||e.tagName==="A"&&(e.hasAttribute("download")||e.hasAttribute("target")&&e.getAttribute("target")!=="_self")||t&&e.matches(t))}function l4(e){return!!(e.data&&typeof e.data.nodeId=="number"&&e.timestamp)}function op(){return Date.now()/1e3}function Ha(e){return{timestamp:Date.now()/1e3,type:"default",...e}}var Xp;(function(e){e[e.Document=0]="Document",e[e.DocumentType=1]="DocumentType",e[e.Element=2]="Element",e[e.Text=3]="Text",e[e.CDATA=4]="CDATA",e[e.Comment=5]="Comment"})(Xp||(Xp={}));const c4=new Set(["id","class","aria-label","role","name","alt","title","data-test-id","data-testid","disabled","aria-disabled"]);function u4(e){const t={};for(const i in e)if(c4.has(i)){let a=i;(i==="data-testid"||i==="data-test-id")&&(a="testId"),t[a]=e[i]}return t}const h4=e=>t=>{if(!e.isEnabled())return;const i=d4(t);if(!i)return;const a=t.name==="click",c=a&&t.event;a&&e.clickDetector&&c&&!c.altKey&&!c.metaKey&&!c.ctrlKey&&!c.shiftKey&&r4(e.clickDetector,i,u0(t.event)),Om(e,i)};function H2(e,t){const i=e&&p4(e)&&e.__sn.type===Xp.Element?e.__sn:null;return{message:t,data:i?{nodeId:i.id,node:{id:i.id,tagName:i.tagName,textContent:e?Array.from(e.childNodes).map(a=>"__sn"in a&&a.__sn.type===Xp.Text&&a.__sn.textContent).filter(Boolean).map(a=>a.trim()).join(""):"",attributes:u4(i.attributes)}}:{}}}function d4(e){const{target:t,message:i}=f4(e);return Ha({category:`ui.${e.name}`,...H2(t,i)})}function f4(e){const t=e.name==="click";let i,a=null;try{a=t?u0(e.event):q2(e.event),i=qo(a,{maxStringLength:200})||"<unknown>"}catch{i="<unknown>"}return{target:a,message:i}}function p4(e){return"__sn"in e}function m4(e,t){if(!e.isEnabled())return;e.updateUserActivity();const i=g4(t);i&&Om(e,i)}function g4(e){const{metaKey:t,shiftKey:i,ctrlKey:a,altKey:c,key:d,target:m}=e;if(!m||_4(m)||!d)return null;const l=t||a||c,b=d.length===1;if(!l&&b)return null;const w=qo(m,{maxStringLength:200})||"<unknown>",C=H2(m,w);return Ha({category:"ui.keyDown",message:w,data:{...C.data,metaKey:t,shiftKey:i,ctrlKey:a,altKey:c,key:d}})}function _4(e){return e.tagName==="INPUT"||e.tagName==="TEXTAREA"||e.isContentEditable}const y4=["name","type","startTime","transferSize","duration"];function Rw(e){return function(t){return y4.every(i=>e[i]===t[i])}}function v4(e,t){const[i,a,c]=e.reduce((b,w)=>(w.entryType==="navigation"?b[0].push(w):w.entryType==="largest-contentful-paint"?b[1].push(w):b[2].push(w),b),[[],[],[]]),d=[],m=[];let l=a.length?a[a.length-1]:void 0;return t.forEach(b=>{if(b.entryType==="largest-contentful-paint"){(!l||l.startTime<b.startTime)&&(l=b);return}if(b.entryType==="navigation"){const w=b;b.duration>0&&!i.find(Rw(w))&&!m.find(Rw(w))&&m.push(w);return}d.push(b)}),[...l?[l]:[],...i,...c,...d,...m].sort((b,w)=>b.startTime-w.startTime)}function x4(e){const t=a=>{const c=v4(e.performanceEvents,a.getEntries());e.performanceEvents=c},i=new PerformanceObserver(t);return["element","event","first-input","largest-contentful-paint","layout-shift","longtask","navigation","paint","resource"].forEach(a=>{try{i.observe({type:a,buffered:!0})}catch{}}),i}const b4=`/*! pako 2.1.0 https://github.com/nodeca/pako @license (MIT AND Zlib) */
function t(t){let e=t.length;for(;--e>=0;)t[e]=0}const e=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),a=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),i=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),n=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),s=new Array(576);t(s);const r=new Array(60);t(r);const o=new Array(512);t(o);const l=new Array(256);t(l);const h=new Array(29);t(h);const d=new Array(30);function _(t,e,a,i,n){this.static_tree=t,this.extra_bits=e,this.extra_base=a,this.elems=i,this.max_length=n,this.has_stree=t&&t.length}let f,c,u;function w(t,e){this.dyn_tree=t,this.max_code=0,this.stat_desc=e}t(d);const m=t=>t<256?o[t]:o[256+(t>>>7)],b=(t,e)=>{t.pending_buf[t.pending++]=255&e,t.pending_buf[t.pending++]=e>>>8&255},g=(t,e,a)=>{t.bi_valid>16-a?(t.bi_buf|=e<<t.bi_valid&65535,b(t,t.bi_buf),t.bi_buf=e>>16-t.bi_valid,t.bi_valid+=a-16):(t.bi_buf|=e<<t.bi_valid&65535,t.bi_valid+=a)},p=(t,e,a)=>{g(t,a[2*e],a[2*e+1])},k=(t,e)=>{let a=0;do{a|=1&t,t>>>=1,a<<=1}while(--e>0);return a>>>1},v=(t,e,a)=>{const i=new Array(16);let n,s,r=0;for(n=1;n<=15;n++)r=r+a[n-1]<<1,i[n]=r;for(s=0;s<=e;s++){let e=t[2*s+1];0!==e&&(t[2*s]=k(i[e]++,e))}},y=t=>{let e;for(e=0;e<286;e++)t.dyn_ltree[2*e]=0;for(e=0;e<30;e++)t.dyn_dtree[2*e]=0;for(e=0;e<19;e++)t.bl_tree[2*e]=0;t.dyn_ltree[512]=1,t.opt_len=t.static_len=0,t.sym_next=t.matches=0},x=t=>{t.bi_valid>8?b(t,t.bi_buf):t.bi_valid>0&&(t.pending_buf[t.pending++]=t.bi_buf),t.bi_buf=0,t.bi_valid=0},z=(t,e,a,i)=>{const n=2*e,s=2*a;return t[n]<t[s]||t[n]===t[s]&&i[e]<=i[a]},A=(t,e,a)=>{const i=t.heap[a];let n=a<<1;for(;n<=t.heap_len&&(n<t.heap_len&&z(e,t.heap[n+1],t.heap[n],t.depth)&&n++,!z(e,i,t.heap[n],t.depth));)t.heap[a]=t.heap[n],a=n,n<<=1;t.heap[a]=i},E=(t,i,n)=>{let s,r,o,_,f=0;if(0!==t.sym_next)do{s=255&t.pending_buf[t.sym_buf+f++],s+=(255&t.pending_buf[t.sym_buf+f++])<<8,r=t.pending_buf[t.sym_buf+f++],0===s?p(t,r,i):(o=l[r],p(t,o+256+1,i),_=e[o],0!==_&&(r-=h[o],g(t,r,_)),s--,o=m(s),p(t,o,n),_=a[o],0!==_&&(s-=d[o],g(t,s,_)))}while(f<t.sym_next);p(t,256,i)},R=(t,e)=>{const a=e.dyn_tree,i=e.stat_desc.static_tree,n=e.stat_desc.has_stree,s=e.stat_desc.elems;let r,o,l,h=-1;for(t.heap_len=0,t.heap_max=573,r=0;r<s;r++)0!==a[2*r]?(t.heap[++t.heap_len]=h=r,t.depth[r]=0):a[2*r+1]=0;for(;t.heap_len<2;)l=t.heap[++t.heap_len]=h<2?++h:0,a[2*l]=1,t.depth[l]=0,t.opt_len--,n&&(t.static_len-=i[2*l+1]);for(e.max_code=h,r=t.heap_len>>1;r>=1;r--)A(t,a,r);l=s;do{r=t.heap[1],t.heap[1]=t.heap[t.heap_len--],A(t,a,1),o=t.heap[1],t.heap[--t.heap_max]=r,t.heap[--t.heap_max]=o,a[2*l]=a[2*r]+a[2*o],t.depth[l]=(t.depth[r]>=t.depth[o]?t.depth[r]:t.depth[o])+1,a[2*r+1]=a[2*o+1]=l,t.heap[1]=l++,A(t,a,1)}while(t.heap_len>=2);t.heap[--t.heap_max]=t.heap[1],((t,e)=>{const a=e.dyn_tree,i=e.max_code,n=e.stat_desc.static_tree,s=e.stat_desc.has_stree,r=e.stat_desc.extra_bits,o=e.stat_desc.extra_base,l=e.stat_desc.max_length;let h,d,_,f,c,u,w=0;for(f=0;f<=15;f++)t.bl_count[f]=0;for(a[2*t.heap[t.heap_max]+1]=0,h=t.heap_max+1;h<573;h++)d=t.heap[h],f=a[2*a[2*d+1]+1]+1,f>l&&(f=l,w++),a[2*d+1]=f,d>i||(t.bl_count[f]++,c=0,d>=o&&(c=r[d-o]),u=a[2*d],t.opt_len+=u*(f+c),s&&(t.static_len+=u*(n[2*d+1]+c)));if(0!==w){do{for(f=l-1;0===t.bl_count[f];)f--;t.bl_count[f]--,t.bl_count[f+1]+=2,t.bl_count[l]--,w-=2}while(w>0);for(f=l;0!==f;f--)for(d=t.bl_count[f];0!==d;)_=t.heap[--h],_>i||(a[2*_+1]!==f&&(t.opt_len+=(f-a[2*_+1])*a[2*_],a[2*_+1]=f),d--)}})(t,e),v(a,h,t.bl_count)},Z=(t,e,a)=>{let i,n,s=-1,r=e[1],o=0,l=7,h=4;for(0===r&&(l=138,h=3),e[2*(a+1)+1]=65535,i=0;i<=a;i++)n=r,r=e[2*(i+1)+1],++o<l&&n===r||(o<h?t.bl_tree[2*n]+=o:0!==n?(n!==s&&t.bl_tree[2*n]++,t.bl_tree[32]++):o<=10?t.bl_tree[34]++:t.bl_tree[36]++,o=0,s=n,0===r?(l=138,h=3):n===r?(l=6,h=3):(l=7,h=4))},U=(t,e,a)=>{let i,n,s=-1,r=e[1],o=0,l=7,h=4;for(0===r&&(l=138,h=3),i=0;i<=a;i++)if(n=r,r=e[2*(i+1)+1],!(++o<l&&n===r)){if(o<h)do{p(t,n,t.bl_tree)}while(0!=--o);else 0!==n?(n!==s&&(p(t,n,t.bl_tree),o--),p(t,16,t.bl_tree),g(t,o-3,2)):o<=10?(p(t,17,t.bl_tree),g(t,o-3,3)):(p(t,18,t.bl_tree),g(t,o-11,7));o=0,s=n,0===r?(l=138,h=3):n===r?(l=6,h=3):(l=7,h=4)}};let S=!1;const D=(t,e,a,i)=>{g(t,0+(i?1:0),3),x(t),b(t,a),b(t,~a),a&&t.pending_buf.set(t.window.subarray(e,e+a),t.pending),t.pending+=a};var T=(t,e,a,i)=>{let o,l,h=0;t.level>0?(2===t.strm.data_type&&(t.strm.data_type=(t=>{let e,a=4093624447;for(e=0;e<=31;e++,a>>>=1)if(1&a&&0!==t.dyn_ltree[2*e])return 0;if(0!==t.dyn_ltree[18]||0!==t.dyn_ltree[20]||0!==t.dyn_ltree[26])return 1;for(e=32;e<256;e++)if(0!==t.dyn_ltree[2*e])return 1;return 0})(t)),R(t,t.l_desc),R(t,t.d_desc),h=(t=>{let e;for(Z(t,t.dyn_ltree,t.l_desc.max_code),Z(t,t.dyn_dtree,t.d_desc.max_code),R(t,t.bl_desc),e=18;e>=3&&0===t.bl_tree[2*n[e]+1];e--);return t.opt_len+=3*(e+1)+5+5+4,e})(t),o=t.opt_len+3+7>>>3,l=t.static_len+3+7>>>3,l<=o&&(o=l)):o=l=a+5,a+4<=o&&-1!==e?D(t,e,a,i):4===t.strategy||l===o?(g(t,2+(i?1:0),3),E(t,s,r)):(g(t,4+(i?1:0),3),((t,e,a,i)=>{let s;for(g(t,e-257,5),g(t,a-1,5),g(t,i-4,4),s=0;s<i;s++)g(t,t.bl_tree[2*n[s]+1],3);U(t,t.dyn_ltree,e-1),U(t,t.dyn_dtree,a-1)})(t,t.l_desc.max_code+1,t.d_desc.max_code+1,h+1),E(t,t.dyn_ltree,t.dyn_dtree)),y(t),i&&x(t)},O={_tr_init:t=>{S||((()=>{let t,n,w,m,b;const g=new Array(16);for(w=0,m=0;m<28;m++)for(h[m]=w,t=0;t<1<<e[m];t++)l[w++]=m;for(l[w-1]=m,b=0,m=0;m<16;m++)for(d[m]=b,t=0;t<1<<a[m];t++)o[b++]=m;for(b>>=7;m<30;m++)for(d[m]=b<<7,t=0;t<1<<a[m]-7;t++)o[256+b++]=m;for(n=0;n<=15;n++)g[n]=0;for(t=0;t<=143;)s[2*t+1]=8,t++,g[8]++;for(;t<=255;)s[2*t+1]=9,t++,g[9]++;for(;t<=279;)s[2*t+1]=7,t++,g[7]++;for(;t<=287;)s[2*t+1]=8,t++,g[8]++;for(v(s,287,g),t=0;t<30;t++)r[2*t+1]=5,r[2*t]=k(t,5);f=new _(s,e,257,286,15),c=new _(r,a,0,30,15),u=new _(new Array(0),i,0,19,7)})(),S=!0),t.l_desc=new w(t.dyn_ltree,f),t.d_desc=new w(t.dyn_dtree,c),t.bl_desc=new w(t.bl_tree,u),t.bi_buf=0,t.bi_valid=0,y(t)},_tr_stored_block:D,_tr_flush_block:T,_tr_tally:(t,e,a)=>(t.pending_buf[t.sym_buf+t.sym_next++]=e,t.pending_buf[t.sym_buf+t.sym_next++]=e>>8,t.pending_buf[t.sym_buf+t.sym_next++]=a,0===e?t.dyn_ltree[2*a]++:(t.matches++,e--,t.dyn_ltree[2*(l[a]+256+1)]++,t.dyn_dtree[2*m(e)]++),t.sym_next===t.sym_end),_tr_align:t=>{g(t,2,3),p(t,256,s),(t=>{16===t.bi_valid?(b(t,t.bi_buf),t.bi_buf=0,t.bi_valid=0):t.bi_valid>=8&&(t.pending_buf[t.pending++]=255&t.bi_buf,t.bi_buf>>=8,t.bi_valid-=8)})(t)}};var F=(t,e,a,i)=>{let n=65535&t|0,s=t>>>16&65535|0,r=0;for(;0!==a;){r=a>2e3?2e3:a,a-=r;do{n=n+e[i++]|0,s=s+n|0}while(--r);n%=65521,s%=65521}return n|s<<16|0};const L=new Uint32Array((()=>{let t,e=[];for(var a=0;a<256;a++){t=a;for(var i=0;i<8;i++)t=1&t?3988292384^t>>>1:t>>>1;e[a]=t}return e})());var N=(t,e,a,i)=>{const n=L,s=i+a;t^=-1;for(let a=i;a<s;a++)t=t>>>8^n[255&(t^e[a])];return-1^t},I={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},B={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};const{_tr_init:C,_tr_stored_block:H,_tr_flush_block:M,_tr_tally:j,_tr_align:K}=O,{Z_NO_FLUSH:P,Z_PARTIAL_FLUSH:Y,Z_FULL_FLUSH:G,Z_FINISH:X,Z_BLOCK:W,Z_OK:q,Z_STREAM_END:J,Z_STREAM_ERROR:Q,Z_DATA_ERROR:V,Z_BUF_ERROR:$,Z_DEFAULT_COMPRESSION:tt,Z_FILTERED:et,Z_HUFFMAN_ONLY:at,Z_RLE:it,Z_FIXED:nt,Z_DEFAULT_STRATEGY:st,Z_UNKNOWN:rt,Z_DEFLATED:ot}=B,lt=(t,e)=>(t.msg=I[e],e),ht=t=>2*t-(t>4?9:0),dt=t=>{let e=t.length;for(;--e>=0;)t[e]=0},_t=t=>{let e,a,i,n=t.w_size;e=t.hash_size,i=e;do{a=t.head[--i],t.head[i]=a>=n?a-n:0}while(--e);e=n,i=e;do{a=t.prev[--i],t.prev[i]=a>=n?a-n:0}while(--e)};let ft=(t,e,a)=>(e<<t.hash_shift^a)&t.hash_mask;const ct=t=>{const e=t.state;let a=e.pending;a>t.avail_out&&(a=t.avail_out),0!==a&&(t.output.set(e.pending_buf.subarray(e.pending_out,e.pending_out+a),t.next_out),t.next_out+=a,e.pending_out+=a,t.total_out+=a,t.avail_out-=a,e.pending-=a,0===e.pending&&(e.pending_out=0))},ut=(t,e)=>{M(t,t.block_start>=0?t.block_start:-1,t.strstart-t.block_start,e),t.block_start=t.strstart,ct(t.strm)},wt=(t,e)=>{t.pending_buf[t.pending++]=e},mt=(t,e)=>{t.pending_buf[t.pending++]=e>>>8&255,t.pending_buf[t.pending++]=255&e},bt=(t,e,a,i)=>{let n=t.avail_in;return n>i&&(n=i),0===n?0:(t.avail_in-=n,e.set(t.input.subarray(t.next_in,t.next_in+n),a),1===t.state.wrap?t.adler=F(t.adler,e,n,a):2===t.state.wrap&&(t.adler=N(t.adler,e,n,a)),t.next_in+=n,t.total_in+=n,n)},gt=(t,e)=>{let a,i,n=t.max_chain_length,s=t.strstart,r=t.prev_length,o=t.nice_match;const l=t.strstart>t.w_size-262?t.strstart-(t.w_size-262):0,h=t.window,d=t.w_mask,_=t.prev,f=t.strstart+258;let c=h[s+r-1],u=h[s+r];t.prev_length>=t.good_match&&(n>>=2),o>t.lookahead&&(o=t.lookahead);do{if(a=e,h[a+r]===u&&h[a+r-1]===c&&h[a]===h[s]&&h[++a]===h[s+1]){s+=2,a++;do{}while(h[++s]===h[++a]&&h[++s]===h[++a]&&h[++s]===h[++a]&&h[++s]===h[++a]&&h[++s]===h[++a]&&h[++s]===h[++a]&&h[++s]===h[++a]&&h[++s]===h[++a]&&s<f);if(i=258-(f-s),s=f-258,i>r){if(t.match_start=e,r=i,i>=o)break;c=h[s+r-1],u=h[s+r]}}}while((e=_[e&d])>l&&0!=--n);return r<=t.lookahead?r:t.lookahead},pt=t=>{const e=t.w_size;let a,i,n;do{if(i=t.window_size-t.lookahead-t.strstart,t.strstart>=e+(e-262)&&(t.window.set(t.window.subarray(e,e+e-i),0),t.match_start-=e,t.strstart-=e,t.block_start-=e,t.insert>t.strstart&&(t.insert=t.strstart),_t(t),i+=e),0===t.strm.avail_in)break;if(a=bt(t.strm,t.window,t.strstart+t.lookahead,i),t.lookahead+=a,t.lookahead+t.insert>=3)for(n=t.strstart-t.insert,t.ins_h=t.window[n],t.ins_h=ft(t,t.ins_h,t.window[n+1]);t.insert&&(t.ins_h=ft(t,t.ins_h,t.window[n+3-1]),t.prev[n&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=n,n++,t.insert--,!(t.lookahead+t.insert<3)););}while(t.lookahead<262&&0!==t.strm.avail_in)},kt=(t,e)=>{let a,i,n,s=t.pending_buf_size-5>t.w_size?t.w_size:t.pending_buf_size-5,r=0,o=t.strm.avail_in;do{if(a=65535,n=t.bi_valid+42>>3,t.strm.avail_out<n)break;if(n=t.strm.avail_out-n,i=t.strstart-t.block_start,a>i+t.strm.avail_in&&(a=i+t.strm.avail_in),a>n&&(a=n),a<s&&(0===a&&e!==X||e===P||a!==i+t.strm.avail_in))break;r=e===X&&a===i+t.strm.avail_in?1:0,H(t,0,0,r),t.pending_buf[t.pending-4]=a,t.pending_buf[t.pending-3]=a>>8,t.pending_buf[t.pending-2]=~a,t.pending_buf[t.pending-1]=~a>>8,ct(t.strm),i&&(i>a&&(i=a),t.strm.output.set(t.window.subarray(t.block_start,t.block_start+i),t.strm.next_out),t.strm.next_out+=i,t.strm.avail_out-=i,t.strm.total_out+=i,t.block_start+=i,a-=i),a&&(bt(t.strm,t.strm.output,t.strm.next_out,a),t.strm.next_out+=a,t.strm.avail_out-=a,t.strm.total_out+=a)}while(0===r);return o-=t.strm.avail_in,o&&(o>=t.w_size?(t.matches=2,t.window.set(t.strm.input.subarray(t.strm.next_in-t.w_size,t.strm.next_in),0),t.strstart=t.w_size,t.insert=t.strstart):(t.window_size-t.strstart<=o&&(t.strstart-=t.w_size,t.window.set(t.window.subarray(t.w_size,t.w_size+t.strstart),0),t.matches<2&&t.matches++,t.insert>t.strstart&&(t.insert=t.strstart)),t.window.set(t.strm.input.subarray(t.strm.next_in-o,t.strm.next_in),t.strstart),t.strstart+=o,t.insert+=o>t.w_size-t.insert?t.w_size-t.insert:o),t.block_start=t.strstart),t.high_water<t.strstart&&(t.high_water=t.strstart),r?4:e!==P&&e!==X&&0===t.strm.avail_in&&t.strstart===t.block_start?2:(n=t.window_size-t.strstart,t.strm.avail_in>n&&t.block_start>=t.w_size&&(t.block_start-=t.w_size,t.strstart-=t.w_size,t.window.set(t.window.subarray(t.w_size,t.w_size+t.strstart),0),t.matches<2&&t.matches++,n+=t.w_size,t.insert>t.strstart&&(t.insert=t.strstart)),n>t.strm.avail_in&&(n=t.strm.avail_in),n&&(bt(t.strm,t.window,t.strstart,n),t.strstart+=n,t.insert+=n>t.w_size-t.insert?t.w_size-t.insert:n),t.high_water<t.strstart&&(t.high_water=t.strstart),n=t.bi_valid+42>>3,n=t.pending_buf_size-n>65535?65535:t.pending_buf_size-n,s=n>t.w_size?t.w_size:n,i=t.strstart-t.block_start,(i>=s||(i||e===X)&&e!==P&&0===t.strm.avail_in&&i<=n)&&(a=i>n?n:i,r=e===X&&0===t.strm.avail_in&&a===i?1:0,H(t,t.block_start,a,r),t.block_start+=a,ct(t.strm)),r?3:1)},vt=(t,e)=>{let a,i;for(;;){if(t.lookahead<262){if(pt(t),t.lookahead<262&&e===P)return 1;if(0===t.lookahead)break}if(a=0,t.lookahead>=3&&(t.ins_h=ft(t,t.ins_h,t.window[t.strstart+3-1]),a=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),0!==a&&t.strstart-a<=t.w_size-262&&(t.match_length=gt(t,a)),t.match_length>=3)if(i=j(t,t.strstart-t.match_start,t.match_length-3),t.lookahead-=t.match_length,t.match_length<=t.max_lazy_match&&t.lookahead>=3){t.match_length--;do{t.strstart++,t.ins_h=ft(t,t.ins_h,t.window[t.strstart+3-1]),a=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart}while(0!=--t.match_length);t.strstart++}else t.strstart+=t.match_length,t.match_length=0,t.ins_h=t.window[t.strstart],t.ins_h=ft(t,t.ins_h,t.window[t.strstart+1]);else i=j(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++;if(i&&(ut(t,!1),0===t.strm.avail_out))return 1}return t.insert=t.strstart<2?t.strstart:2,e===X?(ut(t,!0),0===t.strm.avail_out?3:4):t.sym_next&&(ut(t,!1),0===t.strm.avail_out)?1:2},yt=(t,e)=>{let a,i,n;for(;;){if(t.lookahead<262){if(pt(t),t.lookahead<262&&e===P)return 1;if(0===t.lookahead)break}if(a=0,t.lookahead>=3&&(t.ins_h=ft(t,t.ins_h,t.window[t.strstart+3-1]),a=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),t.prev_length=t.match_length,t.prev_match=t.match_start,t.match_length=2,0!==a&&t.prev_length<t.max_lazy_match&&t.strstart-a<=t.w_size-262&&(t.match_length=gt(t,a),t.match_length<=5&&(t.strategy===et||3===t.match_length&&t.strstart-t.match_start>4096)&&(t.match_length=2)),t.prev_length>=3&&t.match_length<=t.prev_length){n=t.strstart+t.lookahead-3,i=j(t,t.strstart-1-t.prev_match,t.prev_length-3),t.lookahead-=t.prev_length-1,t.prev_length-=2;do{++t.strstart<=n&&(t.ins_h=ft(t,t.ins_h,t.window[t.strstart+3-1]),a=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart)}while(0!=--t.prev_length);if(t.match_available=0,t.match_length=2,t.strstart++,i&&(ut(t,!1),0===t.strm.avail_out))return 1}else if(t.match_available){if(i=j(t,0,t.window[t.strstart-1]),i&&ut(t,!1),t.strstart++,t.lookahead--,0===t.strm.avail_out)return 1}else t.match_available=1,t.strstart++,t.lookahead--}return t.match_available&&(i=j(t,0,t.window[t.strstart-1]),t.match_available=0),t.insert=t.strstart<2?t.strstart:2,e===X?(ut(t,!0),0===t.strm.avail_out?3:4):t.sym_next&&(ut(t,!1),0===t.strm.avail_out)?1:2};function xt(t,e,a,i,n){this.good_length=t,this.max_lazy=e,this.nice_length=a,this.max_chain=i,this.func=n}const zt=[new xt(0,0,0,0,kt),new xt(4,4,8,4,vt),new xt(4,5,16,8,vt),new xt(4,6,32,32,vt),new xt(4,4,16,16,yt),new xt(8,16,32,32,yt),new xt(8,16,128,128,yt),new xt(8,32,128,256,yt),new xt(32,128,258,1024,yt),new xt(32,258,258,4096,yt)];function At(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=ot,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(1146),this.dyn_dtree=new Uint16Array(122),this.bl_tree=new Uint16Array(78),dt(this.dyn_ltree),dt(this.dyn_dtree),dt(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(16),this.heap=new Uint16Array(573),dt(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(573),dt(this.depth),this.sym_buf=0,this.lit_bufsize=0,this.sym_next=0,this.sym_end=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}const Et=t=>{if(!t)return 1;const e=t.state;return!e||e.strm!==t||42!==e.status&&57!==e.status&&69!==e.status&&73!==e.status&&91!==e.status&&103!==e.status&&113!==e.status&&666!==e.status?1:0},Rt=t=>{if(Et(t))return lt(t,Q);t.total_in=t.total_out=0,t.data_type=rt;const e=t.state;return e.pending=0,e.pending_out=0,e.wrap<0&&(e.wrap=-e.wrap),e.status=2===e.wrap?57:e.wrap?42:113,t.adler=2===e.wrap?0:1,e.last_flush=-2,C(e),q},Zt=t=>{const e=Rt(t);var a;return e===q&&((a=t.state).window_size=2*a.w_size,dt(a.head),a.max_lazy_match=zt[a.level].max_lazy,a.good_match=zt[a.level].good_length,a.nice_match=zt[a.level].nice_length,a.max_chain_length=zt[a.level].max_chain,a.strstart=0,a.block_start=0,a.lookahead=0,a.insert=0,a.match_length=a.prev_length=2,a.match_available=0,a.ins_h=0),e},Ut=(t,e,a,i,n,s)=>{if(!t)return Q;let r=1;if(e===tt&&(e=6),i<0?(r=0,i=-i):i>15&&(r=2,i-=16),n<1||n>9||a!==ot||i<8||i>15||e<0||e>9||s<0||s>nt||8===i&&1!==r)return lt(t,Q);8===i&&(i=9);const o=new At;return t.state=o,o.strm=t,o.status=42,o.wrap=r,o.gzhead=null,o.w_bits=i,o.w_size=1<<o.w_bits,o.w_mask=o.w_size-1,o.hash_bits=n+7,o.hash_size=1<<o.hash_bits,o.hash_mask=o.hash_size-1,o.hash_shift=~~((o.hash_bits+3-1)/3),o.window=new Uint8Array(2*o.w_size),o.head=new Uint16Array(o.hash_size),o.prev=new Uint16Array(o.w_size),o.lit_bufsize=1<<n+6,o.pending_buf_size=4*o.lit_bufsize,o.pending_buf=new Uint8Array(o.pending_buf_size),o.sym_buf=o.lit_bufsize,o.sym_end=3*(o.lit_bufsize-1),o.level=e,o.strategy=s,o.method=a,Zt(t)};var St={deflateInit:(t,e)=>Ut(t,e,ot,15,8,st),deflateInit2:Ut,deflateReset:Zt,deflateResetKeep:Rt,deflateSetHeader:(t,e)=>Et(t)||2!==t.state.wrap?Q:(t.state.gzhead=e,q),deflate:(t,e)=>{if(Et(t)||e>W||e<0)return t?lt(t,Q):Q;const a=t.state;if(!t.output||0!==t.avail_in&&!t.input||666===a.status&&e!==X)return lt(t,0===t.avail_out?$:Q);const i=a.last_flush;if(a.last_flush=e,0!==a.pending){if(ct(t),0===t.avail_out)return a.last_flush=-1,q}else if(0===t.avail_in&&ht(e)<=ht(i)&&e!==X)return lt(t,$);if(666===a.status&&0!==t.avail_in)return lt(t,$);if(42===a.status&&0===a.wrap&&(a.status=113),42===a.status){let e=ot+(a.w_bits-8<<4)<<8,i=-1;if(i=a.strategy>=at||a.level<2?0:a.level<6?1:6===a.level?2:3,e|=i<<6,0!==a.strstart&&(e|=32),e+=31-e%31,mt(a,e),0!==a.strstart&&(mt(a,t.adler>>>16),mt(a,65535&t.adler)),t.adler=1,a.status=113,ct(t),0!==a.pending)return a.last_flush=-1,q}if(57===a.status)if(t.adler=0,wt(a,31),wt(a,139),wt(a,8),a.gzhead)wt(a,(a.gzhead.text?1:0)+(a.gzhead.hcrc?2:0)+(a.gzhead.extra?4:0)+(a.gzhead.name?8:0)+(a.gzhead.comment?16:0)),wt(a,255&a.gzhead.time),wt(a,a.gzhead.time>>8&255),wt(a,a.gzhead.time>>16&255),wt(a,a.gzhead.time>>24&255),wt(a,9===a.level?2:a.strategy>=at||a.level<2?4:0),wt(a,255&a.gzhead.os),a.gzhead.extra&&a.gzhead.extra.length&&(wt(a,255&a.gzhead.extra.length),wt(a,a.gzhead.extra.length>>8&255)),a.gzhead.hcrc&&(t.adler=N(t.adler,a.pending_buf,a.pending,0)),a.gzindex=0,a.status=69;else if(wt(a,0),wt(a,0),wt(a,0),wt(a,0),wt(a,0),wt(a,9===a.level?2:a.strategy>=at||a.level<2?4:0),wt(a,3),a.status=113,ct(t),0!==a.pending)return a.last_flush=-1,q;if(69===a.status){if(a.gzhead.extra){let e=a.pending,i=(65535&a.gzhead.extra.length)-a.gzindex;for(;a.pending+i>a.pending_buf_size;){let n=a.pending_buf_size-a.pending;if(a.pending_buf.set(a.gzhead.extra.subarray(a.gzindex,a.gzindex+n),a.pending),a.pending=a.pending_buf_size,a.gzhead.hcrc&&a.pending>e&&(t.adler=N(t.adler,a.pending_buf,a.pending-e,e)),a.gzindex+=n,ct(t),0!==a.pending)return a.last_flush=-1,q;e=0,i-=n}let n=new Uint8Array(a.gzhead.extra);a.pending_buf.set(n.subarray(a.gzindex,a.gzindex+i),a.pending),a.pending+=i,a.gzhead.hcrc&&a.pending>e&&(t.adler=N(t.adler,a.pending_buf,a.pending-e,e)),a.gzindex=0}a.status=73}if(73===a.status){if(a.gzhead.name){let e,i=a.pending;do{if(a.pending===a.pending_buf_size){if(a.gzhead.hcrc&&a.pending>i&&(t.adler=N(t.adler,a.pending_buf,a.pending-i,i)),ct(t),0!==a.pending)return a.last_flush=-1,q;i=0}e=a.gzindex<a.gzhead.name.length?255&a.gzhead.name.charCodeAt(a.gzindex++):0,wt(a,e)}while(0!==e);a.gzhead.hcrc&&a.pending>i&&(t.adler=N(t.adler,a.pending_buf,a.pending-i,i)),a.gzindex=0}a.status=91}if(91===a.status){if(a.gzhead.comment){let e,i=a.pending;do{if(a.pending===a.pending_buf_size){if(a.gzhead.hcrc&&a.pending>i&&(t.adler=N(t.adler,a.pending_buf,a.pending-i,i)),ct(t),0!==a.pending)return a.last_flush=-1,q;i=0}e=a.gzindex<a.gzhead.comment.length?255&a.gzhead.comment.charCodeAt(a.gzindex++):0,wt(a,e)}while(0!==e);a.gzhead.hcrc&&a.pending>i&&(t.adler=N(t.adler,a.pending_buf,a.pending-i,i))}a.status=103}if(103===a.status){if(a.gzhead.hcrc){if(a.pending+2>a.pending_buf_size&&(ct(t),0!==a.pending))return a.last_flush=-1,q;wt(a,255&t.adler),wt(a,t.adler>>8&255),t.adler=0}if(a.status=113,ct(t),0!==a.pending)return a.last_flush=-1,q}if(0!==t.avail_in||0!==a.lookahead||e!==P&&666!==a.status){let i=0===a.level?kt(a,e):a.strategy===at?((t,e)=>{let a;for(;;){if(0===t.lookahead&&(pt(t),0===t.lookahead)){if(e===P)return 1;break}if(t.match_length=0,a=j(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++,a&&(ut(t,!1),0===t.strm.avail_out))return 1}return t.insert=0,e===X?(ut(t,!0),0===t.strm.avail_out?3:4):t.sym_next&&(ut(t,!1),0===t.strm.avail_out)?1:2})(a,e):a.strategy===it?((t,e)=>{let a,i,n,s;const r=t.window;for(;;){if(t.lookahead<=258){if(pt(t),t.lookahead<=258&&e===P)return 1;if(0===t.lookahead)break}if(t.match_length=0,t.lookahead>=3&&t.strstart>0&&(n=t.strstart-1,i=r[n],i===r[++n]&&i===r[++n]&&i===r[++n])){s=t.strstart+258;do{}while(i===r[++n]&&i===r[++n]&&i===r[++n]&&i===r[++n]&&i===r[++n]&&i===r[++n]&&i===r[++n]&&i===r[++n]&&n<s);t.match_length=258-(s-n),t.match_length>t.lookahead&&(t.match_length=t.lookahead)}if(t.match_length>=3?(a=j(t,1,t.match_length-3),t.lookahead-=t.match_length,t.strstart+=t.match_length,t.match_length=0):(a=j(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++),a&&(ut(t,!1),0===t.strm.avail_out))return 1}return t.insert=0,e===X?(ut(t,!0),0===t.strm.avail_out?3:4):t.sym_next&&(ut(t,!1),0===t.strm.avail_out)?1:2})(a,e):zt[a.level].func(a,e);if(3!==i&&4!==i||(a.status=666),1===i||3===i)return 0===t.avail_out&&(a.last_flush=-1),q;if(2===i&&(e===Y?K(a):e!==W&&(H(a,0,0,!1),e===G&&(dt(a.head),0===a.lookahead&&(a.strstart=0,a.block_start=0,a.insert=0))),ct(t),0===t.avail_out))return a.last_flush=-1,q}return e!==X?q:a.wrap<=0?J:(2===a.wrap?(wt(a,255&t.adler),wt(a,t.adler>>8&255),wt(a,t.adler>>16&255),wt(a,t.adler>>24&255),wt(a,255&t.total_in),wt(a,t.total_in>>8&255),wt(a,t.total_in>>16&255),wt(a,t.total_in>>24&255)):(mt(a,t.adler>>>16),mt(a,65535&t.adler)),ct(t),a.wrap>0&&(a.wrap=-a.wrap),0!==a.pending?q:J)},deflateEnd:t=>{if(Et(t))return Q;const e=t.state.status;return t.state=null,113===e?lt(t,V):q},deflateSetDictionary:(t,e)=>{let a=e.length;if(Et(t))return Q;const i=t.state,n=i.wrap;if(2===n||1===n&&42!==i.status||i.lookahead)return Q;if(1===n&&(t.adler=F(t.adler,e,a,0)),i.wrap=0,a>=i.w_size){0===n&&(dt(i.head),i.strstart=0,i.block_start=0,i.insert=0);let t=new Uint8Array(i.w_size);t.set(e.subarray(a-i.w_size,a),0),e=t,a=i.w_size}const s=t.avail_in,r=t.next_in,o=t.input;for(t.avail_in=a,t.next_in=0,t.input=e,pt(i);i.lookahead>=3;){let t=i.strstart,e=i.lookahead-2;do{i.ins_h=ft(i,i.ins_h,i.window[t+3-1]),i.prev[t&i.w_mask]=i.head[i.ins_h],i.head[i.ins_h]=t,t++}while(--e);i.strstart=t,i.lookahead=2,pt(i)}return i.strstart+=i.lookahead,i.block_start=i.strstart,i.insert=i.lookahead,i.lookahead=0,i.match_length=i.prev_length=2,i.match_available=0,t.next_in=r,t.input=o,t.avail_in=s,i.wrap=n,q},deflateInfo:"pako deflate (from Nodeca project)"};const Dt=(t,e)=>Object.prototype.hasOwnProperty.call(t,e);var Tt=function(t){const e=Array.prototype.slice.call(arguments,1);for(;e.length;){const a=e.shift();if(a){if("object"!=typeof a)throw new TypeError(a+"must be non-object");for(const e in a)Dt(a,e)&&(t[e]=a[e])}}return t},Ot=t=>{let e=0;for(let a=0,i=t.length;a<i;a++)e+=t[a].length;const a=new Uint8Array(e);for(let e=0,i=0,n=t.length;e<n;e++){let n=t[e];a.set(n,i),i+=n.length}return a};let Ft=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(t){Ft=!1}const Lt=new Uint8Array(256);for(let t=0;t<256;t++)Lt[t]=t>=252?6:t>=248?5:t>=240?4:t>=224?3:t>=192?2:1;Lt[254]=Lt[254]=1;var Nt=t=>{if("function"==typeof TextEncoder&&TextEncoder.prototype.encode)return(new TextEncoder).encode(t);let e,a,i,n,s,r=t.length,o=0;for(n=0;n<r;n++)a=t.charCodeAt(n),55296==(64512&a)&&n+1<r&&(i=t.charCodeAt(n+1),56320==(64512&i)&&(a=65536+(a-55296<<10)+(i-56320),n++)),o+=a<128?1:a<2048?2:a<65536?3:4;for(e=new Uint8Array(o),s=0,n=0;s<o;n++)a=t.charCodeAt(n),55296==(64512&a)&&n+1<r&&(i=t.charCodeAt(n+1),56320==(64512&i)&&(a=65536+(a-55296<<10)+(i-56320),n++)),a<128?e[s++]=a:a<2048?(e[s++]=192|a>>>6,e[s++]=128|63&a):a<65536?(e[s++]=224|a>>>12,e[s++]=128|a>>>6&63,e[s++]=128|63&a):(e[s++]=240|a>>>18,e[s++]=128|a>>>12&63,e[s++]=128|a>>>6&63,e[s++]=128|63&a);return e},It=(t,e)=>{const a=e||t.length;if("function"==typeof TextDecoder&&TextDecoder.prototype.decode)return(new TextDecoder).decode(t.subarray(0,e));let i,n;const s=new Array(2*a);for(n=0,i=0;i<a;){let e=t[i++];if(e<128){s[n++]=e;continue}let r=Lt[e];if(r>4)s[n++]=65533,i+=r-1;else{for(e&=2===r?31:3===r?15:7;r>1&&i<a;)e=e<<6|63&t[i++],r--;r>1?s[n++]=65533:e<65536?s[n++]=e:(e-=65536,s[n++]=55296|e>>10&1023,s[n++]=56320|1023&e)}}return((t,e)=>{if(e<65534&&t.subarray&&Ft)return String.fromCharCode.apply(null,t.length===e?t:t.subarray(0,e));let a="";for(let i=0;i<e;i++)a+=String.fromCharCode(t[i]);return a})(s,n)},Bt=(t,e)=>{(e=e||t.length)>t.length&&(e=t.length);let a=e-1;for(;a>=0&&128==(192&t[a]);)a--;return a<0||0===a?e:a+Lt[t[a]]>e?a:e};var Ct=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0};const Ht=Object.prototype.toString,{Z_NO_FLUSH:Mt,Z_SYNC_FLUSH:jt,Z_FULL_FLUSH:Kt,Z_FINISH:Pt,Z_OK:Yt,Z_STREAM_END:Gt,Z_DEFAULT_COMPRESSION:Xt,Z_DEFAULT_STRATEGY:Wt,Z_DEFLATED:qt}=B;function Jt(t){this.options=Tt({level:Xt,method:qt,chunkSize:16384,windowBits:15,memLevel:8,strategy:Wt},t||{});let e=this.options;e.raw&&e.windowBits>0?e.windowBits=-e.windowBits:e.gzip&&e.windowBits>0&&e.windowBits<16&&(e.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Ct,this.strm.avail_out=0;let a=St.deflateInit2(this.strm,e.level,e.method,e.windowBits,e.memLevel,e.strategy);if(a!==Yt)throw new Error(I[a]);if(e.header&&St.deflateSetHeader(this.strm,e.header),e.dictionary){let t;if(t="string"==typeof e.dictionary?Nt(e.dictionary):"[object ArrayBuffer]"===Ht.call(e.dictionary)?new Uint8Array(e.dictionary):e.dictionary,a=St.deflateSetDictionary(this.strm,t),a!==Yt)throw new Error(I[a]);this._dict_set=!0}}function Qt(t,e){const a=new Jt(e);if(a.push(t,!0),a.err)throw a.msg||I[a.err];return a.result}Jt.prototype.push=function(t,e){const a=this.strm,i=this.options.chunkSize;let n,s;if(this.ended)return!1;for(s=e===~~e?e:!0===e?Pt:Mt,"string"==typeof t?a.input=Nt(t):"[object ArrayBuffer]"===Ht.call(t)?a.input=new Uint8Array(t):a.input=t,a.next_in=0,a.avail_in=a.input.length;;)if(0===a.avail_out&&(a.output=new Uint8Array(i),a.next_out=0,a.avail_out=i),(s===jt||s===Kt)&&a.avail_out<=6)this.onData(a.output.subarray(0,a.next_out)),a.avail_out=0;else{if(n=St.deflate(a,s),n===Gt)return a.next_out>0&&this.onData(a.output.subarray(0,a.next_out)),n=St.deflateEnd(this.strm),this.onEnd(n),this.ended=!0,n===Yt;if(0!==a.avail_out){if(s>0&&a.next_out>0)this.onData(a.output.subarray(0,a.next_out)),a.avail_out=0;else if(0===a.avail_in)break}else this.onData(a.output)}return!0},Jt.prototype.onData=function(t){this.chunks.push(t)},Jt.prototype.onEnd=function(t){t===Yt&&(this.result=Ot(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg};var Vt={Deflate:Jt,deflate:Qt,deflateRaw:function(t,e){return(e=e||{}).raw=!0,Qt(t,e)},gzip:function(t,e){return(e=e||{}).gzip=!0,Qt(t,e)},constants:B};var $t=function(t,e){let a,i,n,s,r,o,l,h,d,_,f,c,u,w,m,b,g,p,k,v,y,x,z,A;const E=t.state;a=t.next_in,z=t.input,i=a+(t.avail_in-5),n=t.next_out,A=t.output,s=n-(e-t.avail_out),r=n+(t.avail_out-257),o=E.dmax,l=E.wsize,h=E.whave,d=E.wnext,_=E.window,f=E.hold,c=E.bits,u=E.lencode,w=E.distcode,m=(1<<E.lenbits)-1,b=(1<<E.distbits)-1;t:do{c<15&&(f+=z[a++]<<c,c+=8,f+=z[a++]<<c,c+=8),g=u[f&m];e:for(;;){if(p=g>>>24,f>>>=p,c-=p,p=g>>>16&255,0===p)A[n++]=65535&g;else{if(!(16&p)){if(0==(64&p)){g=u[(65535&g)+(f&(1<<p)-1)];continue e}if(32&p){E.mode=16191;break t}t.msg="invalid literal/length code",E.mode=16209;break t}k=65535&g,p&=15,p&&(c<p&&(f+=z[a++]<<c,c+=8),k+=f&(1<<p)-1,f>>>=p,c-=p),c<15&&(f+=z[a++]<<c,c+=8,f+=z[a++]<<c,c+=8),g=w[f&b];a:for(;;){if(p=g>>>24,f>>>=p,c-=p,p=g>>>16&255,!(16&p)){if(0==(64&p)){g=w[(65535&g)+(f&(1<<p)-1)];continue a}t.msg="invalid distance code",E.mode=16209;break t}if(v=65535&g,p&=15,c<p&&(f+=z[a++]<<c,c+=8,c<p&&(f+=z[a++]<<c,c+=8)),v+=f&(1<<p)-1,v>o){t.msg="invalid distance too far back",E.mode=16209;break t}if(f>>>=p,c-=p,p=n-s,v>p){if(p=v-p,p>h&&E.sane){t.msg="invalid distance too far back",E.mode=16209;break t}if(y=0,x=_,0===d){if(y+=l-p,p<k){k-=p;do{A[n++]=_[y++]}while(--p);y=n-v,x=A}}else if(d<p){if(y+=l+d-p,p-=d,p<k){k-=p;do{A[n++]=_[y++]}while(--p);if(y=0,d<k){p=d,k-=p;do{A[n++]=_[y++]}while(--p);y=n-v,x=A}}}else if(y+=d-p,p<k){k-=p;do{A[n++]=_[y++]}while(--p);y=n-v,x=A}for(;k>2;)A[n++]=x[y++],A[n++]=x[y++],A[n++]=x[y++],k-=3;k&&(A[n++]=x[y++],k>1&&(A[n++]=x[y++]))}else{y=n-v;do{A[n++]=A[y++],A[n++]=A[y++],A[n++]=A[y++],k-=3}while(k>2);k&&(A[n++]=A[y++],k>1&&(A[n++]=A[y++]))}break}}break}}while(a<i&&n<r);k=c>>3,a-=k,c-=k<<3,f&=(1<<c)-1,t.next_in=a,t.next_out=n,t.avail_in=a<i?i-a+5:5-(a-i),t.avail_out=n<r?r-n+257:257-(n-r),E.hold=f,E.bits=c};const te=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),ee=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),ae=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),ie=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]);var ne=(t,e,a,i,n,s,r,o)=>{const l=o.bits;let h,d,_,f,c,u,w=0,m=0,b=0,g=0,p=0,k=0,v=0,y=0,x=0,z=0,A=null;const E=new Uint16Array(16),R=new Uint16Array(16);let Z,U,S,D=null;for(w=0;w<=15;w++)E[w]=0;for(m=0;m<i;m++)E[e[a+m]]++;for(p=l,g=15;g>=1&&0===E[g];g--);if(p>g&&(p=g),0===g)return n[s++]=20971520,n[s++]=20971520,o.bits=1,0;for(b=1;b<g&&0===E[b];b++);for(p<b&&(p=b),y=1,w=1;w<=15;w++)if(y<<=1,y-=E[w],y<0)return-1;if(y>0&&(0===t||1!==g))return-1;for(R[1]=0,w=1;w<15;w++)R[w+1]=R[w]+E[w];for(m=0;m<i;m++)0!==e[a+m]&&(r[R[e[a+m]]++]=m);if(0===t?(A=D=r,u=20):1===t?(A=te,D=ee,u=257):(A=ae,D=ie,u=0),z=0,m=0,w=b,c=s,k=p,v=0,_=-1,x=1<<p,f=x-1,1===t&&x>852||2===t&&x>592)return 1;for(;;){Z=w-v,r[m]+1<u?(U=0,S=r[m]):r[m]>=u?(U=D[r[m]-u],S=A[r[m]-u]):(U=96,S=0),h=1<<w-v,d=1<<k,b=d;do{d-=h,n[c+(z>>v)+d]=Z<<24|U<<16|S|0}while(0!==d);for(h=1<<w-1;z&h;)h>>=1;if(0!==h?(z&=h-1,z+=h):z=0,m++,0==--E[w]){if(w===g)break;w=e[a+r[m]]}if(w>p&&(z&f)!==_){for(0===v&&(v=p),c+=b,k=w-v,y=1<<k;k+v<g&&(y-=E[k+v],!(y<=0));)k++,y<<=1;if(x+=1<<k,1===t&&x>852||2===t&&x>592)return 1;_=z&f,n[_]=p<<24|k<<16|c-s|0}}return 0!==z&&(n[c+z]=w-v<<24|64<<16|0),o.bits=p,0};const{Z_FINISH:se,Z_BLOCK:re,Z_TREES:oe,Z_OK:le,Z_STREAM_END:he,Z_NEED_DICT:de,Z_STREAM_ERROR:_e,Z_DATA_ERROR:fe,Z_MEM_ERROR:ce,Z_BUF_ERROR:ue,Z_DEFLATED:we}=B,me=16209,be=t=>(t>>>24&255)+(t>>>8&65280)+((65280&t)<<8)+((255&t)<<24);function ge(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const pe=t=>{if(!t)return 1;const e=t.state;return!e||e.strm!==t||e.mode<16180||e.mode>16211?1:0},ke=t=>{if(pe(t))return _e;const e=t.state;return t.total_in=t.total_out=e.total=0,t.msg="",e.wrap&&(t.adler=1&e.wrap),e.mode=16180,e.last=0,e.havedict=0,e.flags=-1,e.dmax=32768,e.head=null,e.hold=0,e.bits=0,e.lencode=e.lendyn=new Int32Array(852),e.distcode=e.distdyn=new Int32Array(592),e.sane=1,e.back=-1,le},ve=t=>{if(pe(t))return _e;const e=t.state;return e.wsize=0,e.whave=0,e.wnext=0,ke(t)},ye=(t,e)=>{let a;if(pe(t))return _e;const i=t.state;return e<0?(a=0,e=-e):(a=5+(e>>4),e<48&&(e&=15)),e&&(e<8||e>15)?_e:(null!==i.window&&i.wbits!==e&&(i.window=null),i.wrap=a,i.wbits=e,ve(t))},xe=(t,e)=>{if(!t)return _e;const a=new ge;t.state=a,a.strm=t,a.window=null,a.mode=16180;const i=ye(t,e);return i!==le&&(t.state=null),i};let ze,Ae,Ee=!0;const Re=t=>{if(Ee){ze=new Int32Array(512),Ae=new Int32Array(32);let e=0;for(;e<144;)t.lens[e++]=8;for(;e<256;)t.lens[e++]=9;for(;e<280;)t.lens[e++]=7;for(;e<288;)t.lens[e++]=8;for(ne(1,t.lens,0,288,ze,0,t.work,{bits:9}),e=0;e<32;)t.lens[e++]=5;ne(2,t.lens,0,32,Ae,0,t.work,{bits:5}),Ee=!1}t.lencode=ze,t.lenbits=9,t.distcode=Ae,t.distbits=5},Ze=(t,e,a,i)=>{let n;const s=t.state;return null===s.window&&(s.wsize=1<<s.wbits,s.wnext=0,s.whave=0,s.window=new Uint8Array(s.wsize)),i>=s.wsize?(s.window.set(e.subarray(a-s.wsize,a),0),s.wnext=0,s.whave=s.wsize):(n=s.wsize-s.wnext,n>i&&(n=i),s.window.set(e.subarray(a-i,a-i+n),s.wnext),(i-=n)?(s.window.set(e.subarray(a-i,a),0),s.wnext=i,s.whave=s.wsize):(s.wnext+=n,s.wnext===s.wsize&&(s.wnext=0),s.whave<s.wsize&&(s.whave+=n))),0};var Ue={inflateReset:ve,inflateReset2:ye,inflateResetKeep:ke,inflateInit:t=>xe(t,15),inflateInit2:xe,inflate:(t,e)=>{let a,i,n,s,r,o,l,h,d,_,f,c,u,w,m,b,g,p,k,v,y,x,z=0;const A=new Uint8Array(4);let E,R;const Z=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(pe(t)||!t.output||!t.input&&0!==t.avail_in)return _e;a=t.state,16191===a.mode&&(a.mode=16192),r=t.next_out,n=t.output,l=t.avail_out,s=t.next_in,i=t.input,o=t.avail_in,h=a.hold,d=a.bits,_=o,f=l,x=le;t:for(;;)switch(a.mode){case 16180:if(0===a.wrap){a.mode=16192;break}for(;d<16;){if(0===o)break t;o--,h+=i[s++]<<d,d+=8}if(2&a.wrap&&35615===h){0===a.wbits&&(a.wbits=15),a.check=0,A[0]=255&h,A[1]=h>>>8&255,a.check=N(a.check,A,2,0),h=0,d=0,a.mode=16181;break}if(a.head&&(a.head.done=!1),!(1&a.wrap)||(((255&h)<<8)+(h>>8))%31){t.msg="incorrect header check",a.mode=me;break}if((15&h)!==we){t.msg="unknown compression method",a.mode=me;break}if(h>>>=4,d-=4,y=8+(15&h),0===a.wbits&&(a.wbits=y),y>15||y>a.wbits){t.msg="invalid window size",a.mode=me;break}a.dmax=1<<a.wbits,a.flags=0,t.adler=a.check=1,a.mode=512&h?16189:16191,h=0,d=0;break;case 16181:for(;d<16;){if(0===o)break t;o--,h+=i[s++]<<d,d+=8}if(a.flags=h,(255&a.flags)!==we){t.msg="unknown compression method",a.mode=me;break}if(57344&a.flags){t.msg="unknown header flags set",a.mode=me;break}a.head&&(a.head.text=h>>8&1),512&a.flags&&4&a.wrap&&(A[0]=255&h,A[1]=h>>>8&255,a.check=N(a.check,A,2,0)),h=0,d=0,a.mode=16182;case 16182:for(;d<32;){if(0===o)break t;o--,h+=i[s++]<<d,d+=8}a.head&&(a.head.time=h),512&a.flags&&4&a.wrap&&(A[0]=255&h,A[1]=h>>>8&255,A[2]=h>>>16&255,A[3]=h>>>24&255,a.check=N(a.check,A,4,0)),h=0,d=0,a.mode=16183;case 16183:for(;d<16;){if(0===o)break t;o--,h+=i[s++]<<d,d+=8}a.head&&(a.head.xflags=255&h,a.head.os=h>>8),512&a.flags&&4&a.wrap&&(A[0]=255&h,A[1]=h>>>8&255,a.check=N(a.check,A,2,0)),h=0,d=0,a.mode=16184;case 16184:if(1024&a.flags){for(;d<16;){if(0===o)break t;o--,h+=i[s++]<<d,d+=8}a.length=h,a.head&&(a.head.extra_len=h),512&a.flags&&4&a.wrap&&(A[0]=255&h,A[1]=h>>>8&255,a.check=N(a.check,A,2,0)),h=0,d=0}else a.head&&(a.head.extra=null);a.mode=16185;case 16185:if(1024&a.flags&&(c=a.length,c>o&&(c=o),c&&(a.head&&(y=a.head.extra_len-a.length,a.head.extra||(a.head.extra=new Uint8Array(a.head.extra_len)),a.head.extra.set(i.subarray(s,s+c),y)),512&a.flags&&4&a.wrap&&(a.check=N(a.check,i,c,s)),o-=c,s+=c,a.length-=c),a.length))break t;a.length=0,a.mode=16186;case 16186:if(2048&a.flags){if(0===o)break t;c=0;do{y=i[s+c++],a.head&&y&&a.length<65536&&(a.head.name+=String.fromCharCode(y))}while(y&&c<o);if(512&a.flags&&4&a.wrap&&(a.check=N(a.check,i,c,s)),o-=c,s+=c,y)break t}else a.head&&(a.head.name=null);a.length=0,a.mode=16187;case 16187:if(4096&a.flags){if(0===o)break t;c=0;do{y=i[s+c++],a.head&&y&&a.length<65536&&(a.head.comment+=String.fromCharCode(y))}while(y&&c<o);if(512&a.flags&&4&a.wrap&&(a.check=N(a.check,i,c,s)),o-=c,s+=c,y)break t}else a.head&&(a.head.comment=null);a.mode=16188;case 16188:if(512&a.flags){for(;d<16;){if(0===o)break t;o--,h+=i[s++]<<d,d+=8}if(4&a.wrap&&h!==(65535&a.check)){t.msg="header crc mismatch",a.mode=me;break}h=0,d=0}a.head&&(a.head.hcrc=a.flags>>9&1,a.head.done=!0),t.adler=a.check=0,a.mode=16191;break;case 16189:for(;d<32;){if(0===o)break t;o--,h+=i[s++]<<d,d+=8}t.adler=a.check=be(h),h=0,d=0,a.mode=16190;case 16190:if(0===a.havedict)return t.next_out=r,t.avail_out=l,t.next_in=s,t.avail_in=o,a.hold=h,a.bits=d,de;t.adler=a.check=1,a.mode=16191;case 16191:if(e===re||e===oe)break t;case 16192:if(a.last){h>>>=7&d,d-=7&d,a.mode=16206;break}for(;d<3;){if(0===o)break t;o--,h+=i[s++]<<d,d+=8}switch(a.last=1&h,h>>>=1,d-=1,3&h){case 0:a.mode=16193;break;case 1:if(Re(a),a.mode=16199,e===oe){h>>>=2,d-=2;break t}break;case 2:a.mode=16196;break;case 3:t.msg="invalid block type",a.mode=me}h>>>=2,d-=2;break;case 16193:for(h>>>=7&d,d-=7&d;d<32;){if(0===o)break t;o--,h+=i[s++]<<d,d+=8}if((65535&h)!=(h>>>16^65535)){t.msg="invalid stored block lengths",a.mode=me;break}if(a.length=65535&h,h=0,d=0,a.mode=16194,e===oe)break t;case 16194:a.mode=16195;case 16195:if(c=a.length,c){if(c>o&&(c=o),c>l&&(c=l),0===c)break t;n.set(i.subarray(s,s+c),r),o-=c,s+=c,l-=c,r+=c,a.length-=c;break}a.mode=16191;break;case 16196:for(;d<14;){if(0===o)break t;o--,h+=i[s++]<<d,d+=8}if(a.nlen=257+(31&h),h>>>=5,d-=5,a.ndist=1+(31&h),h>>>=5,d-=5,a.ncode=4+(15&h),h>>>=4,d-=4,a.nlen>286||a.ndist>30){t.msg="too many length or distance symbols",a.mode=me;break}a.have=0,a.mode=16197;case 16197:for(;a.have<a.ncode;){for(;d<3;){if(0===o)break t;o--,h+=i[s++]<<d,d+=8}a.lens[Z[a.have++]]=7&h,h>>>=3,d-=3}for(;a.have<19;)a.lens[Z[a.have++]]=0;if(a.lencode=a.lendyn,a.lenbits=7,E={bits:a.lenbits},x=ne(0,a.lens,0,19,a.lencode,0,a.work,E),a.lenbits=E.bits,x){t.msg="invalid code lengths set",a.mode=me;break}a.have=0,a.mode=16198;case 16198:for(;a.have<a.nlen+a.ndist;){for(;z=a.lencode[h&(1<<a.lenbits)-1],m=z>>>24,b=z>>>16&255,g=65535&z,!(m<=d);){if(0===o)break t;o--,h+=i[s++]<<d,d+=8}if(g<16)h>>>=m,d-=m,a.lens[a.have++]=g;else{if(16===g){for(R=m+2;d<R;){if(0===o)break t;o--,h+=i[s++]<<d,d+=8}if(h>>>=m,d-=m,0===a.have){t.msg="invalid bit length repeat",a.mode=me;break}y=a.lens[a.have-1],c=3+(3&h),h>>>=2,d-=2}else if(17===g){for(R=m+3;d<R;){if(0===o)break t;o--,h+=i[s++]<<d,d+=8}h>>>=m,d-=m,y=0,c=3+(7&h),h>>>=3,d-=3}else{for(R=m+7;d<R;){if(0===o)break t;o--,h+=i[s++]<<d,d+=8}h>>>=m,d-=m,y=0,c=11+(127&h),h>>>=7,d-=7}if(a.have+c>a.nlen+a.ndist){t.msg="invalid bit length repeat",a.mode=me;break}for(;c--;)a.lens[a.have++]=y}}if(a.mode===me)break;if(0===a.lens[256]){t.msg="invalid code -- missing end-of-block",a.mode=me;break}if(a.lenbits=9,E={bits:a.lenbits},x=ne(1,a.lens,0,a.nlen,a.lencode,0,a.work,E),a.lenbits=E.bits,x){t.msg="invalid literal/lengths set",a.mode=me;break}if(a.distbits=6,a.distcode=a.distdyn,E={bits:a.distbits},x=ne(2,a.lens,a.nlen,a.ndist,a.distcode,0,a.work,E),a.distbits=E.bits,x){t.msg="invalid distances set",a.mode=me;break}if(a.mode=16199,e===oe)break t;case 16199:a.mode=16200;case 16200:if(o>=6&&l>=258){t.next_out=r,t.avail_out=l,t.next_in=s,t.avail_in=o,a.hold=h,a.bits=d,$t(t,f),r=t.next_out,n=t.output,l=t.avail_out,s=t.next_in,i=t.input,o=t.avail_in,h=a.hold,d=a.bits,16191===a.mode&&(a.back=-1);break}for(a.back=0;z=a.lencode[h&(1<<a.lenbits)-1],m=z>>>24,b=z>>>16&255,g=65535&z,!(m<=d);){if(0===o)break t;o--,h+=i[s++]<<d,d+=8}if(b&&0==(240&b)){for(p=m,k=b,v=g;z=a.lencode[v+((h&(1<<p+k)-1)>>p)],m=z>>>24,b=z>>>16&255,g=65535&z,!(p+m<=d);){if(0===o)break t;o--,h+=i[s++]<<d,d+=8}h>>>=p,d-=p,a.back+=p}if(h>>>=m,d-=m,a.back+=m,a.length=g,0===b){a.mode=16205;break}if(32&b){a.back=-1,a.mode=16191;break}if(64&b){t.msg="invalid literal/length code",a.mode=me;break}a.extra=15&b,a.mode=16201;case 16201:if(a.extra){for(R=a.extra;d<R;){if(0===o)break t;o--,h+=i[s++]<<d,d+=8}a.length+=h&(1<<a.extra)-1,h>>>=a.extra,d-=a.extra,a.back+=a.extra}a.was=a.length,a.mode=16202;case 16202:for(;z=a.distcode[h&(1<<a.distbits)-1],m=z>>>24,b=z>>>16&255,g=65535&z,!(m<=d);){if(0===o)break t;o--,h+=i[s++]<<d,d+=8}if(0==(240&b)){for(p=m,k=b,v=g;z=a.distcode[v+((h&(1<<p+k)-1)>>p)],m=z>>>24,b=z>>>16&255,g=65535&z,!(p+m<=d);){if(0===o)break t;o--,h+=i[s++]<<d,d+=8}h>>>=p,d-=p,a.back+=p}if(h>>>=m,d-=m,a.back+=m,64&b){t.msg="invalid distance code",a.mode=me;break}a.offset=g,a.extra=15&b,a.mode=16203;case 16203:if(a.extra){for(R=a.extra;d<R;){if(0===o)break t;o--,h+=i[s++]<<d,d+=8}a.offset+=h&(1<<a.extra)-1,h>>>=a.extra,d-=a.extra,a.back+=a.extra}if(a.offset>a.dmax){t.msg="invalid distance too far back",a.mode=me;break}a.mode=16204;case 16204:if(0===l)break t;if(c=f-l,a.offset>c){if(c=a.offset-c,c>a.whave&&a.sane){t.msg="invalid distance too far back",a.mode=me;break}c>a.wnext?(c-=a.wnext,u=a.wsize-c):u=a.wnext-c,c>a.length&&(c=a.length),w=a.window}else w=n,u=r-a.offset,c=a.length;c>l&&(c=l),l-=c,a.length-=c;do{n[r++]=w[u++]}while(--c);0===a.length&&(a.mode=16200);break;case 16205:if(0===l)break t;n[r++]=a.length,l--,a.mode=16200;break;case 16206:if(a.wrap){for(;d<32;){if(0===o)break t;o--,h|=i[s++]<<d,d+=8}if(f-=l,t.total_out+=f,a.total+=f,4&a.wrap&&f&&(t.adler=a.check=a.flags?N(a.check,n,f,r-f):F(a.check,n,f,r-f)),f=l,4&a.wrap&&(a.flags?h:be(h))!==a.check){t.msg="incorrect data check",a.mode=me;break}h=0,d=0}a.mode=16207;case 16207:if(a.wrap&&a.flags){for(;d<32;){if(0===o)break t;o--,h+=i[s++]<<d,d+=8}if(4&a.wrap&&h!==(4294967295&a.total)){t.msg="incorrect length check",a.mode=me;break}h=0,d=0}a.mode=16208;case 16208:x=he;break t;case me:x=fe;break t;case 16210:return ce;default:return _e}return t.next_out=r,t.avail_out=l,t.next_in=s,t.avail_in=o,a.hold=h,a.bits=d,(a.wsize||f!==t.avail_out&&a.mode<me&&(a.mode<16206||e!==se))&&Ze(t,t.output,t.next_out,f-t.avail_out),_-=t.avail_in,f-=t.avail_out,t.total_in+=_,t.total_out+=f,a.total+=f,4&a.wrap&&f&&(t.adler=a.check=a.flags?N(a.check,n,f,t.next_out-f):F(a.check,n,f,t.next_out-f)),t.data_type=a.bits+(a.last?64:0)+(16191===a.mode?128:0)+(16199===a.mode||16194===a.mode?256:0),(0===_&&0===f||e===se)&&x===le&&(x=ue),x},inflateEnd:t=>{if(pe(t))return _e;let e=t.state;return e.window&&(e.window=null),t.state=null,le},inflateGetHeader:(t,e)=>{if(pe(t))return _e;const a=t.state;return 0==(2&a.wrap)?_e:(a.head=e,e.done=!1,le)},inflateSetDictionary:(t,e)=>{const a=e.length;let i,n,s;return pe(t)?_e:(i=t.state,0!==i.wrap&&16190!==i.mode?_e:16190===i.mode&&(n=1,n=F(n,e,a,0),n!==i.check)?fe:(s=Ze(t,e,a,a),s?(i.mode=16210,ce):(i.havedict=1,le)))},inflateInfo:"pako inflate (from Nodeca project)"};var Se=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1};const De=Object.prototype.toString,{Z_NO_FLUSH:Te,Z_FINISH:Oe,Z_OK:Fe,Z_STREAM_END:Le,Z_NEED_DICT:Ne,Z_STREAM_ERROR:Ie,Z_DATA_ERROR:Be,Z_MEM_ERROR:Ce}=B;function He(t){this.options=Tt({chunkSize:65536,windowBits:15,to:""},t||{});const e=this.options;e.raw&&e.windowBits>=0&&e.windowBits<16&&(e.windowBits=-e.windowBits,0===e.windowBits&&(e.windowBits=-15)),!(e.windowBits>=0&&e.windowBits<16)||t&&t.windowBits||(e.windowBits+=32),e.windowBits>15&&e.windowBits<48&&0==(15&e.windowBits)&&(e.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Ct,this.strm.avail_out=0;let a=Ue.inflateInit2(this.strm,e.windowBits);if(a!==Fe)throw new Error(I[a]);if(this.header=new Se,Ue.inflateGetHeader(this.strm,this.header),e.dictionary&&("string"==typeof e.dictionary?e.dictionary=Nt(e.dictionary):"[object ArrayBuffer]"===De.call(e.dictionary)&&(e.dictionary=new Uint8Array(e.dictionary)),e.raw&&(a=Ue.inflateSetDictionary(this.strm,e.dictionary),a!==Fe)))throw new Error(I[a])}He.prototype.push=function(t,e){const a=this.strm,i=this.options.chunkSize,n=this.options.dictionary;let s,r,o;if(this.ended)return!1;for(r=e===~~e?e:!0===e?Oe:Te,"[object ArrayBuffer]"===De.call(t)?a.input=new Uint8Array(t):a.input=t,a.next_in=0,a.avail_in=a.input.length;;){for(0===a.avail_out&&(a.output=new Uint8Array(i),a.next_out=0,a.avail_out=i),s=Ue.inflate(a,r),s===Ne&&n&&(s=Ue.inflateSetDictionary(a,n),s===Fe?s=Ue.inflate(a,r):s===Be&&(s=Ne));a.avail_in>0&&s===Le&&a.state.wrap>0&&0!==t[a.next_in];)Ue.inflateReset(a),s=Ue.inflate(a,r);switch(s){case Ie:case Be:case Ne:case Ce:return this.onEnd(s),this.ended=!0,!1}if(o=a.avail_out,a.next_out&&(0===a.avail_out||s===Le))if("string"===this.options.to){let t=Bt(a.output,a.next_out),e=a.next_out-t,n=It(a.output,t);a.next_out=e,a.avail_out=i-e,e&&a.output.set(a.output.subarray(t,t+e),0),this.onData(n)}else this.onData(a.output.length===a.next_out?a.output:a.output.subarray(0,a.next_out));if(s!==Fe||0!==o){if(s===Le)return s=Ue.inflateEnd(this.strm),this.onEnd(s),this.ended=!0,!0;if(0===a.avail_in)break}}return!0},He.prototype.onData=function(t){this.chunks.push(t)},He.prototype.onEnd=function(t){t===Fe&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=Ot(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg};const{Deflate:Me,deflate:je,deflateRaw:Ke,gzip:Pe}=Vt;var Ye=Me,Ge=je,Xe=B;const We=new class{constructor(){this._init()}clear(){this._init()}addEvent(t){if(!t)throw new Error("Adding invalid event");const e=this._hasEvents?",":"";this.deflate.push(e+t,Xe.Z_SYNC_FLUSH),this._hasEvents=!0}finish(){if(this.deflate.push("]",Xe.Z_FINISH),this.deflate.err)throw this.deflate.err;const t=this.deflate.result;return this._init(),t}_init(){this._hasEvents=!1,this.deflate=new Ye,this.deflate.push("[",Xe.Z_NO_FLUSH)}},qe={clear:()=>{We.clear()},addEvent:t=>We.addEvent(t),finish:()=>We.finish(),compress:t=>function(t){return Ge(t)}(t)};addEventListener("message",(function(t){const e=t.data.method,a=t.data.id,i=t.data.arg;if(e in qe&&"function"==typeof qe[e])try{const t=qe[e](i);postMessage({id:a,method:e,success:!0,response:t})}catch(t){postMessage({id:a,method:e,success:!1,response:t.message}),console.error(t)}})),postMessage({id:void 0,method:"init",success:!0,response:void 0});`;function w4(){const e=new Blob([b4]);return URL.createObjectURL(e)}function br(e,t){(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&(at.info(e),t&&Z2(e))}function Dl(e,t){(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&(at.info(e),t&&setTimeout(()=>{Z2(e)},0))}function Z2(e){vn().addBreadcrumb({category:"console",data:{logger:"replay"},level:"info",message:e},{level:"info"})}class h0 extends Error{constructor(){super(`Event buffer exceeded maximum size of ${l0}.`)}}class W2{constructor(){this.events=[],this._totalSize=0,this.hasCheckout=!1}get hasEvents(){return this.events.length>0}get type(){return"sync"}destroy(){this.events=[]}async addEvent(t){const i=JSON.stringify(t).length;if(this._totalSize+=i,this._totalSize>l0)throw new h0;this.events.push(t)}finish(){return new Promise(t=>{const i=this.events;this.clear(),t(JSON.stringify(i))})}clear(){this.events=[],this._totalSize=0,this.hasCheckout=!1}getEarliestTimestamp(){const t=this.events.map(i=>i.timestamp).sort()[0];return t?c0(t):null}}class S4{constructor(t){this._worker=t,this._id=0}ensureReady(){return this._ensureReadyPromise?this._ensureReadyPromise:(this._ensureReadyPromise=new Promise((t,i)=>{this._worker.addEventListener("message",({data:a})=>{a.success?t():i()},{once:!0}),this._worker.addEventListener("error",a=>{i(a)},{once:!0})}),this._ensureReadyPromise)}destroy(){br("[Replay] Destroying compression worker"),this._worker.terminate()}postMessage(t,i){const a=this._getAndIncrementId();return new Promise((c,d)=>{const m=({data:l})=>{const b=l;if(b.method===t&&b.id===a){if(this._worker.removeEventListener("message",m),!b.success){(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&at.error("[Replay]",b.response),d(new Error("Error in compression worker"));return}c(b.response)}};this._worker.addEventListener("message",m),this._worker.postMessage({id:a,method:t,arg:i})})}_getAndIncrementId(){return this._id++}}class E4{constructor(t){this._worker=new S4(t),this._earliestTimestamp=null,this._totalSize=0,this.hasCheckout=!1}get hasEvents(){return!!this._earliestTimestamp}get type(){return"worker"}ensureReady(){return this._worker.ensureReady()}destroy(){this._worker.destroy()}addEvent(t){const i=c0(t.timestamp);(!this._earliestTimestamp||i<this._earliestTimestamp)&&(this._earliestTimestamp=i);const a=JSON.stringify(t);return this._totalSize+=a.length,this._totalSize>l0?Promise.reject(new h0):this._sendEventToWorker(a)}finish(){return this._finishRequest()}clear(){this._earliestTimestamp=null,this._totalSize=0,this.hasCheckout=!1,this._worker.postMessage("clear")}getEarliestTimestamp(){return this._earliestTimestamp}_sendEventToWorker(t){return this._worker.postMessage("addEvent",t)}async _finishRequest(){const t=await this._worker.postMessage("finish");return this._earliestTimestamp=null,this._totalSize=0,t}}class T4{constructor(t){this._fallback=new W2,this._compression=new E4(t),this._used=this._fallback,this._ensureWorkerIsLoadedPromise=this._ensureWorkerIsLoaded()}get type(){return this._used.type}get hasEvents(){return this._used.hasEvents}get hasCheckout(){return this._used.hasCheckout}set hasCheckout(t){this._used.hasCheckout=t}destroy(){this._fallback.destroy(),this._compression.destroy()}clear(){return this._used.clear()}getEarliestTimestamp(){return this._used.getEarliestTimestamp()}addEvent(t){return this._used.addEvent(t)}async finish(){return await this.ensureWorkerIsLoaded(),this._used.finish()}ensureWorkerIsLoaded(){return this._ensureWorkerIsLoadedPromise}async _ensureWorkerIsLoaded(){try{await this._compression.ensureReady()}catch{br("[Replay] Failed to load the compression worker, falling back to simple buffer");return}await this._switchToCompressionWorker()}async _switchToCompressionWorker(){const{events:t,hasCheckout:i}=this._fallback,a=[];for(const c of t)a.push(this._compression.addEvent(c));this._compression.hasCheckout=i,this._used=this._compression;try{await Promise.all(a)}catch(c){(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&at.warn("[Replay] Failed to add events when switching buffers.",c)}}}function C4({useCompression:e}){if(e&&window.Worker)try{const t=w4();br("[Replay] Using compression worker");const i=new Worker(t);return new T4(i)}catch{br("[Replay] Failed to create compression worker")}return br("[Replay] Using simple buffer"),new W2}function d0(){try{return"sessionStorage"in In&&!!In.sessionStorage}catch{return!1}}function I4(e){k4(),e.session=void 0}function k4(){if(d0())try{In.sessionStorage.removeItem(a0)}catch{}}function Dy(e,t,i=+new Date){return e===null||t===void 0||t<0?!0:t===0?!1:e+t<=i}function Y2(e,t,i=+new Date){return Dy(e.started,t.maxSessionLife,i)||Dy(e.lastActivity,t.sessionIdleExpire,i)}function X2(e){return e===void 0?!1:Math.random()<e}function f0(e){if(d0())try{In.sessionStorage.setItem(a0,JSON.stringify(e))}catch{}}function p0(e){const t=Date.now(),i=e.id||Fr(),a=e.started||t,c=e.lastActivity||t,d=e.segmentId||0,m=e.sampled,l=typeof e.shouldRefresh=="boolean"?e.shouldRefresh:!0;return{id:i,started:a,lastActivity:c,segmentId:d,sampled:m,shouldRefresh:l}}function A4(e,t){return X2(e)?"session":t?"buffer":!1}function P4({sessionSampleRate:e,allowBuffering:t,stickySession:i=!1}){const a=A4(e,t),c=p0({sampled:a});return i&&f0(c),c}function R4(e){if(!d0())return null;try{const t=In.sessionStorage.getItem(a0);if(!t)return null;const i=JSON.parse(t);return Dl("[Replay] Loading existing session",e),p0(i)}catch{return null}}function b_({timeouts:e,currentSession:t,stickySession:i,sessionSampleRate:a,allowBuffering:c,traceInternals:d}){const m=t||i&&R4(d);if(m){if(!Y2(m,e)||c&&m.shouldRefresh)return{type:"saved",session:m};if(m.shouldRefresh)Dl("[Replay] Session has expired",d);else{const w=p0({sampled:!1});return Dl("[Replay] Session should not be refreshed",d),{type:"new",session:w}}}const l=P4({stickySession:i,sessionSampleRate:a,allowBuffering:c});return Dl("[Replay] Created new session",d),{type:"new",session:l}}function M4(e){return e.type===Nn.Custom}async function Kp(e,t,i){if(!e.eventBuffer||e.isPaused())return null;const a=c0(t.timestamp);if(a+e.timeouts.sessionIdlePause<Date.now())return null;if(a>e.getContext().initialTimestamp+e.timeouts.maxSessionLife)return br(`[Replay] Skipping event with timestamp ${a} because it is after maxSessionLife`,e.getOptions()._experiments.traceInternals),null;try{i&&e.recordingMode==="buffer"&&e.eventBuffer.clear(),i&&(e.eventBuffer.hasCheckout=!0);const c=e.getOptions(),d=D4(t,c.beforeAddRecordingEvent);return d?await e.eventBuffer.addEvent(d):void 0}catch(c){const d=c&&c instanceof h0?"addEventSizeExceeded":"addEvent";(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&at.error(c),await e.stop({reason:d});const m=vn().getClient();m&&m.recordDroppedEvent("internal_sdk_error","replay")}}function D4(e,t){try{if(typeof t=="function"&&M4(e))return t(e)}catch(i){return(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&at.error("[Replay] An error occured in the `beforeAddRecordingEvent` callback, skipping the event...",i),null}return e}function K2(e){return!e.type}function Ly(e){return e.type==="transaction"}function L4(e){return e.type==="replay_event"}function J2(e){const t=B4();return(i,a)=>{if(!e.isEnabled()||!K2(i)&&!Ly(i))return;const c=a&&a.statusCode;if(!(t&&(!c||c<200||c>=300))){if(Ly(i)){z4(e,i);return}O4(e,i)}}}function z4(e,t){const i=e.getContext();t.contexts&&t.contexts.trace&&t.contexts.trace.trace_id&&i.traceIds.size<100&&i.traceIds.add(t.contexts.trace.trace_id)}function O4(e,t){const i=e.getContext();t.event_id&&i.errorIds.size<100&&i.errorIds.add(t.event_id),e.recordingMode==="buffer"&&t.tags&&t.tags.replayId&&setTimeout(()=>{e.sendBufferedReplayOrFlush()})}function B4(){const e=vn().getClient();if(!e)return!1;const t=e.getTransport();return t&&t.send.__sentry__baseTransport__||!1}function F4(e,t){return e.type||!e.exception||!e.exception.values||!e.exception.values.length?!1:t.originalException&&t.originalException.__rrweb__?!0:e.exception.values.some(i=>!i.stacktrace||!i.stacktrace.frames||!i.stacktrace.frames.length?!1:i.stacktrace.frames.some(a=>a.filename&&a.filename.includes("/rrweb/src/")))}function N4(e,t){return e.recordingMode!=="buffer"||t.message===o0||!t.exception||t.type?!1:X2(e.getOptions().errorSampleRate)}function U4(e,t=!1){const i=t?J2(e):void 0;return(a,c)=>e.isEnabled()?L4(a)?(delete a.breadcrumbs,a):!K2(a)&&!Ly(a)?a:F4(a,c)&&!e.getOptions()._experiments.captureExceptions?((typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&at.log("[Replay] Ignoring error from rrweb internals",a),null):((N4(e,a)||e.recordingMode==="session")&&(a.tags={...a.tags,replayId:e.getSessionId()}),i&&i(a,{statusCode:200}),a):a}function Bm(e,t){return t.map(({type:i,start:a,end:c,name:d,data:m})=>{const l=e.throttledAddEvent({type:Nn.Custom,timestamp:a,data:{tag:"performanceSpan",payload:{op:i,description:d,startTimestamp:a,endTimestamp:c,data:m}}});return typeof l=="string"?Promise.resolve(null):l})}function $4(e){const{from:t,to:i}=e,a=Date.now()/1e3;return{type:"navigation.push",start:a,end:a,name:i,data:{previous:t}}}function V4(e){return t=>{if(!e.isEnabled())return;const i=$4(t);i!==null&&(e.getContext().urls.push(i.name),e.triggerUserActivity(),e.addUpdate(()=>(Bm(e,[i]),!1)))}}function j4(e,t){return(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&e.getOptions()._experiments.traceInternals?!1:G4(t)}function G4(e){const t=vn().getClient(),i=t&&t.getDsn();return i?e.includes(i.host):!1}function Fm(e,t){e.isEnabled()&&t!==null&&(j4(e,t.name)||e.addUpdate(()=>(Bm(e,[t]),!0)))}function q4(e){const{startTimestamp:t,endTimestamp:i,fetchData:a,response:c}=e;if(!i)return null;const{method:d,url:m}=a;return{type:"resource.fetch",start:t/1e3,end:i/1e3,name:m,data:{method:d,statusCode:c?c.status:void 0}}}function H4(e){return t=>{if(!e.isEnabled())return;const i=q4(t);Fm(e,i)}}function Z4(e){const{startTimestamp:t,endTimestamp:i,xhr:a}=e,c=a[Oo];if(!t||!i||!c)return null;const{method:d,url:m,status_code:l}=c;return m===void 0?null:{type:"resource.xhr",name:m,start:t/1e3,end:i/1e3,data:{method:d,statusCode:l}}}function W4(e){return t=>{if(!e.isEnabled())return;const i=Z4(t);Fm(e,i)}}const Bo=10,m0=11,zy=12,Qa=13,Oy=14,ou=15,qa=20,ws=21,By=22,lu=23,Q2=["true","false","null"];function Y4(e,t){if(!t.length)return e;let i=e;const a=t.length-1,c=t[a];i=X4(i,c);for(let d=a;d>=0;d--)switch(t[d]){case Bo:i=`${i}}`;break;case qa:i=`${i}]`;break}return i}function X4(e,t){switch(t){case Bo:return`${e}"~~":"~~"`;case m0:return`${e}:"~~"`;case zy:return`${e}~~":"~~"`;case Qa:return Q4(e);case Oy:return`${e}~~"`;case ou:return`${e},"~~":"~~"`;case qa:return`${e}"~~"`;case ws:return K4(e);case By:return`${e}~~"`;case lu:return`${e},"~~"`}return e}function K4(e){const t=J4(e);if(t>-1){const i=e.slice(t+1);return Q2.includes(i.trim())?`${e},"~~"`:`${e.slice(0,t+1)}"~~"`}return e}function J4(e){for(let t=e.length-1;t>=0;t--){const i=e[t];if(i===","||i==="[")return t}return-1}function Q4(e){const t=e.lastIndexOf(":"),i=e.slice(t+1);return Q2.includes(i.trim())?`${e},"~~":"~~"`:`${e.slice(0,t+1)}"~~"`}function e6(e){const t=[];for(let i=0;i<e.length;i++)t6(t,e,i);return t}function t6(e,t,i){const a=e[e.length-1],c=t[i];if(!/\s/.test(c)){if(c==='"'&&!eC(t,i)){n6(e,a);return}switch(c){case"{":i6(e,a);break;case"[":r6(e,a);break;case":":s6(e,a);break;case",":a6(e,a);break;case"}":o6(e,a);break;case"]":l6(e,a);break}}}function n6(e,t){if(t===Oy){e.pop(),e.push(ou);return}if(t===By){e.pop(),e.push(lu);return}if(t===Qa){e.push(Oy);return}if(t===ws){e.push(By);return}if(t===Bo){e.push(zy);return}if(t===zy){e.pop(),e.push(m0);return}}function i6(e,t){if(!t){e.push(Bo);return}if(t===Qa){e.push(Bo);return}if(t===ws&&e.push(Bo),t===qa){e.push(Bo);return}}function r6(e,t){if(!t){e.push(qa),e.push(ws);return}if(t===Qa){e.push(qa),e.push(ws);return}if(t===ws&&(e.push(qa),e.push(ws)),t===qa){e.push(qa),e.push(ws);return}}function s6(e,t){t===m0&&(e.pop(),e.push(Qa))}function a6(e,t){if(t===Qa){e.pop();return}if(t===ou){e.pop(),e.pop();return}if(t!==ws&&t===lu){e.pop();return}}function o6(e,t){t===Bo&&e.pop(),t===Qa&&(e.pop(),e.pop()),t===ou&&(e.pop(),e.pop(),e.pop()),e[e.length-1]===Qa&&e.push(ou),e[e.length-1]===ws&&e.push(lu)}function l6(e,t){t===qa&&e.pop(),t===ws&&(e.pop(),e.pop()),t===lu&&(e.pop(),e.pop(),e.pop()),e[e.length-1]===Qa&&e.push(ou),e[e.length-1]===ws&&e.push(lu)}function eC(e,t){return e[t-1]==="\\"&&!eC(e,t-1)}function tC(e){const t=e6(e);return Y4(e,t)}function Jp(e,t){if(e)try{if(typeof e=="string")return t.encode(e).length;if(e instanceof URLSearchParams)return t.encode(e.toString()).length;if(e instanceof FormData){const i=sC(e);return t.encode(i).length}if(e instanceof Blob)return e.size;if(e instanceof ArrayBuffer)return e.byteLength}catch{}}function nC(e){if(!e)return;const t=parseInt(e,10);return isNaN(t)?void 0:t}function iC(e){if(typeof e=="string")return e;if(e instanceof URLSearchParams)return e.toString();if(e instanceof FormData)return sC(e)}function rC(e,t){if(!t)return null;const{startTimestamp:i,endTimestamp:a,url:c,method:d,statusCode:m,request:l,response:b}=t;return{type:e,start:i/1e3,end:a/1e3,name:c,data:ya({method:d,statusCode:m,request:l,response:b})}}function xd(e){return{headers:{},size:e,_meta:{warnings:["URL_SKIPPED"]}}}function Fo(e,t,i){if(!t&&Object.keys(e).length===0)return;if(!t)return{headers:e};if(!i)return{headers:e,size:t};const a={headers:e,size:t},{body:c,warnings:d}=c6(i);return a.body=c,d.length>0&&(a._meta={warnings:d}),a}function Fy(e,t){return Object.keys(e).reduce((i,a)=>{const c=a.toLowerCase();return t.includes(c)&&e[a]&&(i[c]=e[a]),i},{})}function sC(e){return new URLSearchParams(e).toString()}function c6(e){if(!e||typeof e!="string")return{body:e,warnings:[]};const t=e.length>np;if(u6(e))try{const i=t?tC(e.slice(0,np)):e;return{body:JSON.parse(i),warnings:t?["JSON_TRUNCATED"]:[]}}catch{return{body:t?`${e.slice(0,np)}…`:e,warnings:t?["INVALID_JSON","TEXT_TRUNCATED"]:["INVALID_JSON"]}}return{body:t?`${e.slice(0,np)}…`:e,warnings:t?["TEXT_TRUNCATED"]:[]}}function u6(e){const t=e[0],i=e[e.length-1];return t==="["&&i==="]"||t==="{"&&i==="}"}function Qp(e,t){const i=h6(e);return Tu(i,t)}function h6(e,t=In.document.baseURI){if(e.startsWith("http://")||e.startsWith("https://")||e.startsWith(In.location.origin))return e;const i=new URL(e,t);if(i.origin!==new URL(t).origin)return e;const a=i.href;return!e.endsWith("/")&&a.endsWith("/")?a.slice(0,-1):a}async function d6(e,t,i){try{const a=await p6(e,t,i),c=rC("resource.fetch",a);Fm(i.replay,c)}catch(a){(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&at.error("[Replay] Failed to capture fetch breadcrumb",a)}}function f6(e,t,i){const{input:a,response:c}=t,d=aC(a),m=Jp(d,i.textEncoder),l=c?nC(c.headers.get("content-length")):void 0;m!==void 0&&(e.data.request_body_size=m),l!==void 0&&(e.data.response_body_size=l)}async function p6(e,t,i){const{startTimestamp:a,endTimestamp:c}=t,{url:d,method:m,status_code:l=0,request_body_size:b,response_body_size:w}=e.data,C=Qp(d,i.networkDetailAllowUrls)&&!Qp(d,i.networkDetailDenyUrls),k=C?m6(i,t.input,b):xd(b),M=await g6(C,i,t.response,w);return{startTimestamp:a,endTimestamp:c,url:d,method:m,statusCode:l,request:k,response:M}}function m6({networkCaptureBodies:e,networkRequestHeaders:t},i,a){const c=y6(i,t);if(!e)return Fo(c,a,void 0);const d=aC(i),m=iC(d);return Fo(c,a,m)}async function g6(e,{networkCaptureBodies:t,textEncoder:i,networkResponseHeaders:a},c,d){if(!e&&d!==void 0)return xd(d);const m=oC(c.headers,a);if(!t&&d!==void 0)return Fo(m,d,void 0);try{const l=c.clone(),b=await _6(l),w=b&&b.length&&d===void 0?Jp(b,i):d;return e?t?Fo(m,w,b):Fo(m,w,void 0):xd(w)}catch{return Fo(m,d,void 0)}}async function _6(e){try{return await e.text()}catch{return}}function aC(e=[]){if(!(e.length!==2||typeof e[1]!="object"))return e[1].body}function oC(e,t){const i={};return t.forEach(a=>{e.get(a)&&(i[a]=e.get(a))}),i}function y6(e,t){return e.length===1&&typeof e[0]!="string"?Mw(e[0],t):e.length===2?Mw(e[1],t):{}}function Mw(e,t){if(!e)return{};const i=e.headers;return i?i instanceof Headers?oC(i,t):Array.isArray(i)?{}:Fy(i,t):{}}async function v6(e,t,i){try{const a=b6(e,t,i),c=rC("resource.xhr",a);Fm(i.replay,c)}catch(a){(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&at.error("[Replay] Failed to capture fetch breadcrumb",a)}}function x6(e,t,i){const{xhr:a,input:c}=t,d=Jp(c,i.textEncoder),m=a.getResponseHeader("content-length")?nC(a.getResponseHeader("content-length")):Jp(a.response,i.textEncoder);d!==void 0&&(e.data.request_body_size=d),m!==void 0&&(e.data.response_body_size=m)}function b6(e,t,i){const{startTimestamp:a,endTimestamp:c,input:d,xhr:m}=t,{url:l,method:b,status_code:w=0,request_body_size:C,response_body_size:k}=e.data;if(!l)return null;if(!Qp(l,i.networkDetailAllowUrls)||Qp(l,i.networkDetailDenyUrls)){const he=xd(C),be=xd(k);return{startTimestamp:a,endTimestamp:c,url:l,method:b,statusCode:w,request:he,response:be}}const M=m[Oo],O=M?Fy(M.request_headers,i.networkRequestHeaders):{},j=Fy(w6(m),i.networkResponseHeaders),W=Fo(O,C,i.networkCaptureBodies?iC(d):void 0),le=Fo(j,k,i.networkCaptureBodies?t.xhr.responseText:void 0);return{startTimestamp:a,endTimestamp:c,url:l,method:b,statusCode:w,request:W,response:le}}function w6(e){const t=e.getAllResponseHeaders();return t?t.split(`\r
`).reduce((i,a)=>{const[c,d]=a.split(": ");return i[c.toLowerCase()]=d,i},{}):{}}function S6(e){const t=vn().getClient();try{const i=new TextEncoder,{networkDetailAllowUrls:a,networkDetailDenyUrls:c,networkCaptureBodies:d,networkRequestHeaders:m,networkResponseHeaders:l}=e.getOptions(),b={replay:e,textEncoder:i,networkDetailAllowUrls:a,networkDetailDenyUrls:c,networkCaptureBodies:d,networkRequestHeaders:m,networkResponseHeaders:l};t&&t.on?t.on("beforeAddBreadcrumb",(w,C)=>E6(b,w,C)):(ur("fetch",H4(e)),ur("xhr",W4(e)))}catch{}}function E6(e,t,i){if(t.data)try{T6(t)&&I6(i)&&(x6(t,i,e),v6(t,i,e)),C6(t)&&k6(i)&&(f6(t,i,e),d6(t,i,e))}catch{(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&at.warn("Error when enriching network breadcrumb")}}function T6(e){return e.category==="xhr"}function C6(e){return e.category==="fetch"}function I6(e){return e&&e.xhr}function k6(e){return e&&e.response}let Dw=null;function A6(e){return!!e.category}const P6=e=>t=>{if(!e.isEnabled())return;const i=R6(t);i&&Om(e,i)};function R6(e){const t=e.getLastBreadcrumb&&e.getLastBreadcrumb();return Dw===t||!t||(Dw=t,!A6(t)||["fetch","xhr","sentry.event","sentry.transaction"].includes(t.category)||t.category.startsWith("ui."))?null:t.category==="console"?M6(t):Ha(t)}function M6(e){const t=e.data&&e.data.arguments;if(!Array.isArray(t)||t.length===0)return Ha(e);let i=!1;const a=t.map(c=>{if(!c)return c;if(typeof c=="string")return c.length>ip?(i=!0,`${c.slice(0,ip)}…`):c;if(typeof c=="object")try{const d=da(c,7),m=JSON.stringify(d);if(m.length>ip){const l=tC(m.slice(0,ip)),b=JSON.parse(l);return i=!0,b}return d}catch{}return c});return Ha({...e,data:{...e.data,arguments:a,...i?{_meta:{warnings:["CONSOLE_ARG_TRUNCATED"]}}:{}}})}function D6(e){const t=vn().getScope(),i=vn().getClient();t&&t.addScopeListener(P6(e)),ur("dom",h4(e)),ur("history",V4(e)),S6(e),t0(U4(e,!Lw(i))),Lw(i)&&(i.on("afterSendEvent",J2(e)),i.on("createDsc",a=>{const c=e.getSessionId();c&&e.isEnabled()&&e.recordingMode==="session"&&(a.replay_id=c)}),i.on("startTransaction",a=>{e.lastTransaction=a}),i.on("finishTransaction",a=>{e.lastTransaction=a}))}function Lw(e){return!!(e&&e.on)}async function L6(e){try{return Promise.all(Bm(e,[z6(In.performance.memory)]))}catch{return[]}}function z6(e){const{jsHeapSizeLimit:t,totalJSHeapSize:i,usedJSHeapSize:a}=e,c=Date.now()/1e3;return{type:"memory",name:"memory",start:c,end:c,data:{memory:{jsHeapSizeLimit:t,totalJSHeapSize:i,usedJSHeapSize:a}}}}const zw={resource:U6,paint:F6,navigation:N6,["largest-contentful-paint"]:$6};function O6(e){return e.map(B6).filter(Boolean)}function B6(e){return zw[e.entryType]===void 0?null:zw[e.entryType](e)}function cu(e){return((Hs||In.performance.timeOrigin)+e)/1e3}function F6(e){const{duration:t,entryType:i,name:a,startTime:c}=e,d=cu(c);return{type:i,name:a,start:d,end:d+t,data:void 0}}function N6(e){const{entryType:t,name:i,decodedBodySize:a,duration:c,domComplete:d,encodedBodySize:m,domContentLoadedEventStart:l,domContentLoadedEventEnd:b,domInteractive:w,loadEventStart:C,loadEventEnd:k,redirectCount:M,startTime:O,transferSize:j,type:W}=e;return c===0?null:{type:`${t}.${W}`,start:cu(O),end:cu(d),name:i,data:{size:j,decodedBodySize:a,encodedBodySize:m,duration:c,domInteractive:w,domContentLoadedEventStart:l,domContentLoadedEventEnd:b,loadEventStart:C,loadEventEnd:k,domComplete:d,redirectCount:M}}}function U6(e){const{entryType:t,initiatorType:i,name:a,responseEnd:c,startTime:d,decodedBodySize:m,encodedBodySize:l,responseStatus:b,transferSize:w}=e;return["fetch","xmlhttprequest"].includes(i)?null:{type:`${t}.${i}`,start:cu(d),end:cu(c),name:a,data:{size:w,statusCode:b,decodedBodySize:m,encodedBodySize:l}}}function $6(e){const{entryType:t,startTime:i,size:a}=e;let c=0;if(In.performance){const l=In.performance.getEntriesByType("navigation")[0];c=l&&l.activationStart||0}const d=Math.max(i-c,0),m=cu(c)+d/1e3;return{type:t,name:t,start:m,end:m,data:{value:d,size:a,nodeId:Bl.mirror.getId(e.element)}}}function V6(e,t,i){let a,c,d;const m=i&&i.maxWait?Math.max(i.maxWait,t):0;function l(){return b(),a=e(),a}function b(){c!==void 0&&clearTimeout(c),d!==void 0&&clearTimeout(d),c=d=void 0}function w(){return c!==void 0||d!==void 0?l():a}function C(){return c&&clearTimeout(c),c=setTimeout(l,t),m&&d===void 0&&(d=setTimeout(l,m)),a}return C.cancel=b,C.flush=w,C}function j6(e){let t=!1;return(i,a)=>{if(!e.checkAndHandleExpiredSession()){(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&at.warn("[Replay] Received replay event after session expired.");return}const c=a||!t;t=!0,e.addUpdate(()=>{if(e.recordingMode==="buffer"&&c&&e.setInitialState(),Kp(e,i,c),!c)return!1;if(q6(e,c),e.session&&e.session.previousSessionId)return!0;if(e.recordingMode==="buffer"&&e.session&&e.eventBuffer){const d=e.eventBuffer.getEarliestTimestamp();d&&(br(`[Replay] Updating session start time to earliest event in buffer to ${new Date(d)}`,e.getOptions()._experiments.traceInternals),e.session.started=d,e.getOptions().stickySession&&f0(e.session))}return e.recordingMode==="session"&&e.flush(),!0})}}function G6(e){const t=e.getOptions();return{type:Nn.Custom,timestamp:Date.now(),data:{tag:"options",payload:{sessionSampleRate:t.sessionSampleRate,errorSampleRate:t.errorSampleRate,useCompressionOption:t.useCompression,blockAllMedia:t.blockAllMedia,maskAllText:t.maskAllText,maskAllInputs:t.maskAllInputs,useCompression:e.eventBuffer?e.eventBuffer.type==="worker":!1,networkDetailHasUrls:t.networkDetailAllowUrls.length>0,networkCaptureBodies:t.networkCaptureBodies,networkRequestHasHeaders:t.networkRequestHeaders.length>0,networkResponseHasHeaders:t.networkResponseHeaders.length>0}}}}function q6(e,t){return!t||!e.session||e.session.segmentId!==0?Promise.resolve(null):Kp(e,G6(e),!1)}function H6(e,t,i,a){return Cu(l2(e,Qv(e),a,i),[[{type:"replay_event"},e],[{type:"replay_recording",length:typeof t=="string"?new TextEncoder().encode(t).length:t.length},t]])}function Z6({recordingData:e,headers:t}){let i;const a=`${JSON.stringify(t)}
`;if(typeof e=="string")i=`${a}${e}`;else{const d=new TextEncoder().encode(a);i=new Uint8Array(d.length+e.length),i.set(d),i.set(e,d.length)}return i}async function W6({client:e,scope:t,replayId:i,event:a}){const c=typeof e._integrations=="object"&&e._integrations!==null&&!Array.isArray(e._integrations)?Object.keys(e._integrations):void 0,d=await _2(e.getOptions(),a,{event_id:i,integrations:c},t);if(!d)return null;d.platform=d.platform||"javascript";const m=e.getSdkMetadata&&e.getSdkMetadata(),{name:l,version:b}=m&&m.sdk||{};return d.sdk={...d.sdk,name:l||"sentry.javascript.unknown",version:b||"0.0.0"},d}async function Y6({recordingData:e,replayId:t,segmentId:i,eventContext:a,timestamp:c,session:d}){const m=Z6({recordingData:e,headers:{segment_id:i}}),{urls:l,errorIds:b,traceIds:w,initialTimestamp:C}=a,k=vn(),M=k.getClient(),O=k.getScope(),j=M&&M.getTransport(),W=M&&M.getDsn();if(!M||!j||!W||!d.sampled)return;const le={type:j3,replay_start_timestamp:C/1e3,timestamp:c/1e3,error_ids:b,trace_ids:w,urls:l,replay_id:t,segment_id:i,replay_type:d.sampled},he=await W6({scope:O,client:M,replayId:t,event:le});if(!he){M.recordDroppedEvent("event_processor","replay",le),br("An event processor returned `null`, will not send event.");return}delete he.sdkProcessingMetadata;const be=H6(he,m,W,M.getOptions().tunnel);let ge;try{ge=await j.send(be)}catch(Pe){const Ue=new Error(o0);try{Ue.cause=Pe}catch{}throw Ue}if(!ge)return ge;if(typeof ge.statusCode=="number"&&(ge.statusCode<200||ge.statusCode>=300))throw new lC(ge.statusCode);return ge}class lC extends Error{constructor(t){super(`Transport returned status code ${t}`)}}async function cC(e,t={count:0,interval:X3}){const{recordingData:i,options:a}=e;if(i.length)try{return await Y6(e),!0}catch(c){if(c instanceof lC)throw c;if(aN("Replays",{_retryCount:t.count}),(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&a._experiments&&a._experiments.captureExceptions&&Pm(c),t.count>=K3){const d=new Error(`${o0} - max retries exceeded`);try{d.cause=c}catch{}throw d}return t.interval*=++t.count,new Promise((d,m)=>{setTimeout(async()=>{try{await cC(e,t),d(!0)}catch(l){m(l)}},t.interval)})}}const uC="__THROTTLED",X6="__SKIPPED";function K6(e,t,i){const a=new Map,c=l=>{const b=l-i;a.forEach((w,C)=>{C<b&&a.delete(C)})},d=()=>[...a.values()].reduce((l,b)=>l+b,0);let m=!1;return(...l)=>{const b=Math.floor(Date.now()/1e3);if(c(b),d()>=t){const C=m;return m=!0,C?X6:uC}m=!1;const w=a.get(b)||0;return a.set(b,w+1),e(...l)}}class Do{constructor({options:t,recordingOptions:i}){Do.prototype.__init.call(this),Do.prototype.__init2.call(this),Do.prototype.__init3.call(this),Do.prototype.__init4.call(this),Do.prototype.__init5.call(this),Do.prototype.__init6.call(this),this.eventBuffer=null,this.performanceEvents=[],this.recordingMode="session",this.timeouts={sessionIdlePause:G3,sessionIdleExpire:q3,maxSessionLife:H3},this._lastActivity=Date.now(),this._isEnabled=!1,this._isPaused=!1,this._hasInitializedCoreListeners=!1,this._context={errorIds:new Set,traceIds:new Set,urls:[],initialTimestamp:Date.now(),initialUrl:""},this._recordingOptions=i,this._options=t,this._debouncedFlush=V6(()=>this._flush(),this._options.flushMinDelay,{maxWait:this._options.flushMaxDelay}),this._throttledAddEvent=K6((m,l)=>Kp(this,m,l),300,5);const{slowClickTimeout:a,slowClickIgnoreSelectors:c}=this.getOptions(),d=a?{threshold:Math.min(J3,a),timeout:a,scrollTimeout:Q3,ignoreSelector:c?c.join(","):""}:void 0;d&&(this.clickDetector=new s4(this,d))}getContext(){return this._context}isEnabled(){return this._isEnabled}isPaused(){return this._isPaused}getOptions(){return this._options}initializeSampling(){const{errorSampleRate:t,sessionSampleRate:i}=this._options;if(!(t<=0&&i<=0||!this._loadAndCheckSession())){if(!this.session){this._handleException(new Error("Unable to initialize and create session"));return}this.session.sampled&&this.session.sampled!=="session"&&(this.recordingMode="buffer"),Dl(`[Replay] Starting replay in ${this.recordingMode} mode`,this._options._experiments.traceInternals),this._initializeRecording()}}start(){if(this._isEnabled&&this.recordingMode==="session")throw new Error("Replay recording is already in progress");if(this._isEnabled&&this.recordingMode==="buffer")throw new Error("Replay buffering is in progress, call `flush()` to save the replay");Dl("[Replay] Starting replay in session mode",this._options._experiments.traceInternals);const t=this.session&&this.session.id,{session:i}=b_({timeouts:this.timeouts,stickySession:!!this._options.stickySession,currentSession:this.session,sessionSampleRate:1,allowBuffering:!1,traceInternals:this._options._experiments.traceInternals});i.previousSessionId=t,this.session=i,this._initializeRecording()}startBuffering(){if(this._isEnabled)throw new Error("Replay recording is already in progress");Dl("[Replay] Starting replay in buffer mode",this._options._experiments.traceInternals);const t=this.session&&this.session.id,{session:i}=b_({timeouts:this.timeouts,stickySession:!!this._options.stickySession,currentSession:this.session,sessionSampleRate:0,allowBuffering:!0,traceInternals:this._options._experiments.traceInternals});i.previousSessionId=t,this.session=i,this.recordingMode="buffer",this._initializeRecording()}startRecording(){try{this._stopRecording=Bl({...this._recordingOptions,...this.recordingMode==="buffer"&&{checkoutEveryNms:Y3},emit:j6(this),onMutation:this._onMutationHandler})}catch(t){this._handleException(t)}}stopRecording(){try{return this._stopRecording&&(this._stopRecording(),this._stopRecording=void 0),!0}catch(t){return this._handleException(t),!1}}async stop({forceFlush:t=!1,reason:i}={}){if(this._isEnabled)try{br(`[Replay] Stopping Replay${i?` triggered by ${i}`:""}`,this._options._experiments.traceInternals),this._isEnabled=!1,this._removeListeners(),this.stopRecording(),this._debouncedFlush.cancel(),t&&await this._flush({force:!0}),this.eventBuffer&&this.eventBuffer.destroy(),this.eventBuffer=null,I4(this)}catch(a){this._handleException(a)}}pause(){this._isPaused||(this._isPaused=!0,this.stopRecording(),br("[Replay] Pausing replay",this._options._experiments.traceInternals))}resume(){!this._isPaused||!this._loadAndCheckSession()||(this._isPaused=!1,this.startRecording(),br("[Replay] Resuming replay",this._options._experiments.traceInternals))}async sendBufferedReplayOrFlush({continueRecording:t=!0}={}){if(this.recordingMode==="session")return this.flushImmediate();const i=Date.now();br("[Replay] Converting buffer to session",this._options._experiments.traceInternals),await this.flushImmediate();const a=this.stopRecording();!t||!a||this.recordingMode!=="session"&&(this.recordingMode="session",this.session&&(this.session.shouldRefresh=!1,this._updateUserActivity(i),this._updateSessionActivity(i),this._maybeSaveSession()),this.startRecording())}addUpdate(t){const i=t();this.recordingMode!=="buffer"&&i!==!0&&this._debouncedFlush()}triggerUserActivity(){if(this._updateUserActivity(),!this._stopRecording){if(!this._loadAndCheckSession())return;this.resume();return}this.checkAndHandleExpiredSession(),this._updateSessionActivity()}updateUserActivity(){this._updateUserActivity(),this._updateSessionActivity()}conditionalFlush(){return this.recordingMode==="buffer"?Promise.resolve():this.flushImmediate()}flush(){return this._debouncedFlush()}flushImmediate(){return this._debouncedFlush(),this._debouncedFlush.flush()}cancelFlush(){this._debouncedFlush.cancel()}getSessionId(){return this.session&&this.session.id}checkAndHandleExpiredSession(){const t=this.getSessionId();if(this._lastActivity&&Dy(this._lastActivity,this.timeouts.sessionIdlePause)&&this.session&&this.session.sampled==="session"){this.pause();return}return this._loadAndCheckSession()?t!==this.getSessionId()?(this._triggerFullSnapshot(),!1):!0:void 0}setInitialState(){const t=`${In.location.pathname}${In.location.hash}${In.location.search}`,i=`${In.location.origin}${t}`;this.performanceEvents=[],this._clearContext(),this._context.initialUrl=i,this._context.initialTimestamp=Date.now(),this._context.urls.push(i)}throttledAddEvent(t,i){const a=this._throttledAddEvent(t,i);if(a===uC){const c=Ha({category:"replay.throttled"});this.addUpdate(()=>{Kp(this,{type:Nn.Custom,timestamp:c.timestamp||0,data:{tag:"breadcrumb",payload:c,metric:!0}})})}return a}getCurrentRoute(){const t=this.lastTransaction||vn().getScope().getTransaction();if(!(!t||!["route","custom"].includes(t.metadata.source)))return t.name}_initializeRecording(){this.setInitialState(),this._updateSessionActivity(),this.eventBuffer=C4({useCompression:this._options.useCompression}),this._removeListeners(),this._addListeners(),this._isEnabled=!0,this.startRecording()}_handleException(t){(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&at.error("[Replay]",t),(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&this._options._experiments&&this._options._experiments.captureExceptions&&Pm(t)}_loadAndCheckSession(){const{type:t,session:i}=b_({timeouts:this.timeouts,stickySession:!!this._options.stickySession,currentSession:this.session,sessionSampleRate:this._options.sessionSampleRate,allowBuffering:this._options.errorSampleRate>0||this.recordingMode==="buffer",traceInternals:this._options._experiments.traceInternals});t==="new"&&this.setInitialState();const a=this.getSessionId();return i.id!==a&&(i.previousSessionId=a),this.session=i,this.session.sampled?!0:(this.stop({reason:"session not refreshed"}),!1)}_addListeners(){try{In.document.addEventListener("visibilitychange",this._handleVisibilityChange),In.addEventListener("blur",this._handleWindowBlur),In.addEventListener("focus",this._handleWindowFocus),In.addEventListener("keydown",this._handleKeyboardEvent),this.clickDetector&&this.clickDetector.addListeners(),this._hasInitializedCoreListeners||(D6(this),this._hasInitializedCoreListeners=!0)}catch(t){this._handleException(t)}"PerformanceObserver"in In&&(this._performanceObserver=x4(this))}_removeListeners(){try{In.document.removeEventListener("visibilitychange",this._handleVisibilityChange),In.removeEventListener("blur",this._handleWindowBlur),In.removeEventListener("focus",this._handleWindowFocus),In.removeEventListener("keydown",this._handleKeyboardEvent),this.clickDetector&&this.clickDetector.removeListeners(),this._performanceObserver&&(this._performanceObserver.disconnect(),this._performanceObserver=void 0)}catch(t){this._handleException(t)}}__init(){this._handleVisibilityChange=()=>{In.document.visibilityState==="visible"?this._doChangeToForegroundTasks():this._doChangeToBackgroundTasks()}}__init2(){this._handleWindowBlur=()=>{const t=Ha({category:"ui.blur"});this._doChangeToBackgroundTasks(t)}}__init3(){this._handleWindowFocus=()=>{const t=Ha({category:"ui.focus"});this._doChangeToForegroundTasks(t)}}__init4(){this._handleKeyboardEvent=t=>{m4(this,t)}}_doChangeToBackgroundTasks(t){if(!this.session)return;const i=Y2(this.session,this.timeouts);t&&!i&&this._createCustomBreadcrumb(t),this.conditionalFlush()}_doChangeToForegroundTasks(t){if(!this.session)return;if(!this.checkAndHandleExpiredSession()){br("[Replay] Document has become active, but session has expired");return}t&&this._createCustomBreadcrumb(t)}_triggerFullSnapshot(t=!0){try{br("[Replay] Taking full rrweb snapshot"),Bl.takeFullSnapshot(t)}catch(i){this._handleException(i)}}_updateUserActivity(t=Date.now()){this._lastActivity=t}_updateSessionActivity(t=Date.now()){this.session&&(this.session.lastActivity=t,this._maybeSaveSession())}_createCustomBreadcrumb(t){this.addUpdate(()=>{this.throttledAddEvent({type:Nn.Custom,timestamp:t.timestamp||0,data:{tag:"breadcrumb",payload:t}})})}_addPerformanceEntries(){const t=[...this.performanceEvents];return this.performanceEvents=[],Promise.all(Bm(this,O6(t)))}_clearContext(){this._context.errorIds.clear(),this._context.traceIds.clear(),this._context.urls=[]}_updateInitialTimestampFromEventBuffer(){const{session:t,eventBuffer:i}=this;if(!t||!i||t.segmentId)return;const a=i.getEarliestTimestamp();a&&a<this._context.initialTimestamp&&(this._context.initialTimestamp=a)}_popEventContext(){const t={initialTimestamp:this._context.initialTimestamp,initialUrl:this._context.initialUrl,errorIds:Array.from(this._context.errorIds),traceIds:Array.from(this._context.traceIds),urls:this._context.urls};return this._clearContext(),t}async _runFlush(){if(!this.session||!this.eventBuffer){(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&at.error("[Replay] No session or eventBuffer found to flush.");return}if(await this._addPerformanceEntries(),!(!this.eventBuffer||!this.eventBuffer.hasEvents)&&(await L6(this),!!this.eventBuffer))try{this._updateInitialTimestampFromEventBuffer();const t=await this.eventBuffer.finish(),i=Date.now();if(i-this._context.initialTimestamp>this.timeouts.maxSessionLife+3e4)throw new Error("Session is too long, not sending replay");const a=this.session.id,c=this._popEventContext(),d=this.session.segmentId++;this._maybeSaveSession(),await cC({replayId:a,recordingData:t,segmentId:d,eventContext:c,session:this.session,options:this.getOptions(),timestamp:i})}catch(t){this._handleException(t),this.stop({reason:"sendReplay"});const i=vn().getClient();i&&i.recordDroppedEvent("send_error","replay")}}__init5(){this._flush=async({force:t=!1}={})=>{if(!this._isEnabled&&!t)return;if(!this.checkAndHandleExpiredSession()){(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&at.error("[Replay] Attempting to finish replay event after session expired.");return}if(!this.session){(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&at.error("[Replay] No session found to flush.");return}const i=this.session.started,c=Date.now()-i;this._debouncedFlush.cancel();const d=c<this._options.minReplayDuration,m=c>this.timeouts.maxSessionLife+5e3;if(d||m){br(`[Replay] Session duration (${Math.floor(c/1e3)}s) is too ${d?"short":"long"}, not sending replay.`,this._options._experiments.traceInternals),d&&this._debouncedFlush();return}const l=this.eventBuffer;if(l&&this.session.segmentId===0&&!l.hasCheckout&&br("[Replay] Flushing initial segment without checkout.",this._options._experiments.traceInternals),!this._flushLock){this._flushLock=this._runFlush(),await this._flushLock,this._flushLock=void 0;return}try{await this._flushLock}catch(b){(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&at.error(b)}finally{this._debouncedFlush()}}}_maybeSaveSession(){this.session&&this._options.stickySession&&f0(this.session)}__init6(){this._onMutationHandler=t=>{const i=t.length,a=this._options.mutationLimit,c=this._options.mutationBreadcrumbLimit,d=a&&i>a;if(i>c||d){const m=Ha({category:"replay.mutations",data:{count:i,limit:d}});this._createCustomBreadcrumb(m)}return d?(this.stop({reason:"mutationLimit",forceFlush:this.recordingMode==="session"}),!1):!0}}}function Ah(e,t,i,a){const c=typeof a=="string"?a.split(","):[],d=[...e,...c,...t];return typeof i<"u"&&(typeof i=="string"&&d.push(`.${i}`),console.warn("[Replay] You are using a deprecated configuration item for privacy. Read the documentation on how to use the new privacy configuration.")),d.join(",")}function J6({mask:e,unmask:t,block:i,unblock:a,ignore:c,blockClass:d,blockSelector:m,maskTextClass:l,maskTextSelector:b,ignoreClass:w}){const C=['base[href="/"]'],k=Ah(e,[".sentry-mask","[data-sentry-mask]"],l,b),M=Ah(t,[".sentry-unmask","[data-sentry-unmask]"]),O={maskTextSelector:k,unmaskTextSelector:M,maskInputSelector:k,unmaskInputSelector:M,blockSelector:Ah(i,[".sentry-block","[data-sentry-block]",...C],d,m),unblockSelector:Ah(a,[".sentry-unblock","[data-sentry-unblock]"]),ignoreSelector:Ah(c,[".sentry-ignore","[data-sentry-ignore]",'input[type="file"]'],w)};return d instanceof RegExp&&(O.blockClass=d),l instanceof RegExp&&(O.maskTextClass=l),O}function Ow(){return typeof window<"u"&&(!r2()||Q6())}function Q6(){return typeof process<"u"&&process.type==="renderer"}const Bw='img,image,svg,video,object,picture,embed,map,audio,link[rel="icon"],link[rel="apple-touch-icon"]',e$=["content-length","content-type","accept"];let Fw=!1;class Nm{static __initStatic(){this.id="Replay"}constructor({flushMinDelay:t=Z3,flushMaxDelay:i=W3,minReplayDuration:a=eU,stickySession:c=!0,useCompression:d=!0,_experiments:m={},sessionSampleRate:l,errorSampleRate:b,maskAllText:w=!0,maskAllInputs:C=!0,blockAllMedia:k=!0,mutationBreadcrumbLimit:M=750,mutationLimit:O=1e4,slowClickTimeout:j=7e3,slowClickIgnoreSelectors:W=[],networkDetailAllowUrls:le=[],networkDetailDenyUrls:he=[],networkCaptureBodies:be=!0,networkRequestHeaders:ge=[],networkResponseHeaders:Pe=[],mask:Ue=[],unmask:Oe=[],block:Te=[],unblock:V=[],ignore:Z=[],maskFn:ae,beforeAddRecordingEvent:ke,blockClass:_e,blockSelector:oe,maskInputOptions:Re,maskTextClass:nt,maskTextSelector:Qe,ignoreClass:qe}={}){if(this.name=Nm.id,this._recordingOptions={maskAllInputs:C,maskAllText:w,maskInputOptions:{...Re||{},password:!0},maskTextFn:ae,maskInputFn:ae,...J6({mask:Ue,unmask:Oe,block:Te,unblock:V,ignore:Z,blockClass:_e,blockSelector:oe,maskTextClass:nt,maskTextSelector:Qe,ignoreClass:qe}),slimDOMOptions:"all",inlineStylesheet:!0,inlineImages:!1,collectFonts:!0},this._initialOptions={flushMinDelay:t,flushMaxDelay:i,minReplayDuration:Math.min(a,tU),stickySession:c,sessionSampleRate:l,errorSampleRate:b,useCompression:d,blockAllMedia:k,maskAllInputs:C,maskAllText:w,mutationBreadcrumbLimit:M,mutationLimit:O,slowClickTimeout:j,slowClickIgnoreSelectors:W,networkDetailAllowUrls:le,networkDetailDenyUrls:he,networkCaptureBodies:be,networkRequestHeaders:Nw(ge),networkResponseHeaders:Nw(Pe),beforeAddRecordingEvent:ke,_experiments:m},typeof l=="number"&&(console.warn(`[Replay] You are passing \`sessionSampleRate\` to the Replay integration.
This option is deprecated and will be removed soon.
Instead, configure \`replaysSessionSampleRate\` directly in the SDK init options, e.g.:
Sentry.init({ replaysSessionSampleRate: ${l} })`),this._initialOptions.sessionSampleRate=l),typeof b=="number"&&(console.warn(`[Replay] You are passing \`errorSampleRate\` to the Replay integration.
This option is deprecated and will be removed soon.
Instead, configure \`replaysOnErrorSampleRate\` directly in the SDK init options, e.g.:
Sentry.init({ replaysOnErrorSampleRate: ${b} })`),this._initialOptions.errorSampleRate=b),this._initialOptions.blockAllMedia&&(this._recordingOptions.blockSelector=this._recordingOptions.blockSelector?`${this._recordingOptions.blockSelector},${Bw}`:Bw),this._isInitialized&&Ow())throw new Error("Multiple Sentry Session Replay instances are not supported");this._isInitialized=!0}get _isInitialized(){return Fw}set _isInitialized(t){Fw=t}setupOnce(){Ow()&&(this._setup(),setTimeout(()=>this._initialize()))}start(){this._replay&&this._replay.start()}startBuffering(){this._replay&&this._replay.startBuffering()}stop(){return this._replay?this._replay.stop({forceFlush:this._replay.recordingMode==="session"}):Promise.resolve()}flush(t){return!this._replay||!this._replay.isEnabled()?Promise.resolve():this._replay.sendBufferedReplayOrFlush(t)}getReplayId(){if(!(!this._replay||!this._replay.isEnabled()))return this._replay.getSessionId()}_initialize(){this._replay&&this._replay.initializeSampling()}_setup(){const t=t$(this._initialOptions);this._replay=new Do({options:t,recordingOptions:this._recordingOptions})}}Nm.__initStatic();function t$(e){const t=vn().getClient(),i=t&&t.getOptions(),a={sessionSampleRate:0,errorSampleRate:0,...ya(e)};return i?(e.sessionSampleRate==null&&e.errorSampleRate==null&&i.replaysSessionSampleRate==null&&i.replaysOnErrorSampleRate==null&&console.warn("Replay is disabled because neither `replaysSessionSampleRate` nor `replaysOnErrorSampleRate` are set."),typeof i.replaysSessionSampleRate=="number"&&(a.sessionSampleRate=i.replaysSessionSampleRate),typeof i.replaysOnErrorSampleRate=="number"&&(a.errorSampleRate=i.replaysOnErrorSampleRate),a):(console.warn("SDK client is not available."),a)}function Nw(e){return[...e$,...e.map(t=>t.toLowerCase())]}const Xn=Br;function n$(){Xn&&Xn.document?Xn.document.addEventListener("visibilitychange",()=>{const e=Pd();if(Xn.document.hidden&&e){const t="cancelled";(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&at.log(`[Tracing] Transaction: ${t} -> since tab moved to the background, op: ${e.op}`),e.status||e.setStatus(t),e.setTag("visibilitychange","document.hidden"),e.finish()}}):(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&at.warn("[Tracing] Could not set up background tab detection due to lack of global document")}const g0=(e,t,i)=>{let a,c;return d=>{t.value>=0&&(d||i)&&(c=t.value-(a||0),(c||a===void 0)&&(a=t.value,t.delta=c,e(t)))}},i$=()=>`v3-${Date.now()}-${Math.floor(Math.random()*(9e12-1))+1e12}`,r$=()=>{const e=Xn.performance.timing,t=Xn.performance.navigation.type,i={entryType:"navigation",startTime:0,type:t==2?"back_forward":t===1?"reload":"navigate"};for(const a in e)a!=="navigationStart"&&a!=="toJSON"&&(i[a]=Math.max(e[a]-e.navigationStart,0));return i},hC=()=>Xn.__WEB_VITALS_POLYFILL__?Xn.performance&&(performance.getEntriesByType&&performance.getEntriesByType("navigation")[0]||r$()):Xn.performance&&performance.getEntriesByType&&performance.getEntriesByType("navigation")[0],dC=()=>{const e=hC();return e&&e.activationStart||0},_0=(e,t)=>{const i=hC();let a="navigate";return i&&(Xn.document.prerendering||dC()>0?a="prerender":a=i.type.replace(/_/g,"-")),{name:e,value:typeof t>"u"?-1:t,rating:"good",delta:0,entries:[],id:i$(),navigationType:a}},Md=(e,t,i)=>{try{if(PerformanceObserver.supportedEntryTypes.includes(e)){const a=new PerformanceObserver(c=>{t(c.getEntries())});return a.observe(Object.assign({type:e,buffered:!0},i||{})),a}}catch{}},Um=(e,t)=>{const i=a=>{(a.type==="pagehide"||Xn.document.visibilityState==="hidden")&&(e(a),t&&(removeEventListener("visibilitychange",i,!0),removeEventListener("pagehide",i,!0)))};addEventListener("visibilitychange",i,!0),addEventListener("pagehide",i,!0)},s$=e=>{const t=_0("CLS",0);let i,a=0,c=[];const d=l=>{l.forEach(b=>{if(!b.hadRecentInput){const w=c[0],C=c[c.length-1];a&&c.length!==0&&b.startTime-C.startTime<1e3&&b.startTime-w.startTime<5e3?(a+=b.value,c.push(b)):(a=b.value,c=[b]),a>t.value&&(t.value=a,t.entries=c,i&&i())}})},m=Md("layout-shift",d);if(m){i=g0(e,t);const l=()=>{d(m.takeRecords()),i(!0)};return Um(l),l}};let xp=-1;const a$=()=>Xn.document.visibilityState==="hidden"&&!Xn.document.prerendering?0:1/0,o$=()=>{Um(({timeStamp:e})=>{xp=e},!0)},y0=()=>(xp<0&&(xp=a$(),o$()),{get firstHiddenTime(){return xp}}),l$=e=>{const t=y0(),i=_0("FID");let a;const c=l=>{l.startTime<t.firstHiddenTime&&(i.value=l.processingStart-l.startTime,i.entries.push(l),a(!0))},d=l=>{l.forEach(c)},m=Md("first-input",d);a=g0(e,i),m&&Um(()=>{d(m.takeRecords()),m.disconnect()},!0)},Uw={},c$=e=>{const t=y0(),i=_0("LCP");let a;const c=m=>{const l=m[m.length-1];if(l){const b=Math.max(l.startTime-dC(),0);b<t.firstHiddenTime&&(i.value=b,i.entries=[l],a())}},d=Md("largest-contentful-paint",c);if(d){a=g0(e,i);const m=()=>{Uw[i.id]||(c(d.takeRecords()),d.disconnect(),Uw[i.id]=!0,a(!0))};return["keydown","click"].forEach(l=>{addEventListener(l,m,{once:!0,capture:!0})}),Um(m,!0),m}};function w_(e){return typeof e=="number"&&isFinite(e)}function uu(e,{startTimestamp:t,...i}){return t&&e.startTimestamp>t&&(e.startTimestamp=t),e.startChild({startTimestamp:t,...i})}function Gi(e){return e/1e3}function fC(){return Xn&&Xn.addEventListener&&Xn.performance}let $w=0,Ti={},ua,Hh;function u$(){const e=fC();if(e&&Hs){e.mark&&Xn.performance.mark("sentry-tracing-init"),m$();const t=f$(),i=p$();return()=>{t&&t(),i&&i()}}return()=>{}}function h$(){Md("longtask",t=>{for(const i of t){const a=Pd();if(!a)return;const c=Gi(Hs+i.startTime),d=Gi(i.duration);a.startChild({description:"Main UI thread blocked",op:"ui.long-task",startTimestamp:c,endTimestamp:c+d})}})}function d$(){Md("event",t=>{for(const i of t){const a=Pd();if(!a)return;if(i.name==="click"){const c=Gi(Hs+i.startTime),d=Gi(i.duration);a.startChild({description:qo(i.target),op:`ui.interaction.${i.name}`,startTimestamp:c,endTimestamp:c+d})}}},{durationThreshold:0})}function f$(){return s$(e=>{const t=e.entries.pop();t&&((typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&at.log("[Measurements] Adding CLS"),Ti.cls={value:e.value,unit:""},Hh=t)})}function p$(){return c$(e=>{const t=e.entries.pop();t&&((typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&at.log("[Measurements] Adding LCP"),Ti.lcp={value:e.value,unit:"millisecond"},ua=t)})}function m$(){l$(e=>{const t=e.entries.pop();if(!t)return;const i=Gi(Hs),a=Gi(t.startTime);(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&at.log("[Measurements] Adding FID"),Ti.fid={value:e.value,unit:"millisecond"},Ti["mark.fid"]={value:i+a,unit:"second"}})}function g$(e){const t=fC();if(!t||!Xn.performance.getEntries||!Hs)return;(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&at.log("[Tracing] Adding & adjusting spans using Performance API");const i=Gi(Hs),a=t.getEntries();let c,d;if(a.slice($w).forEach(m=>{const l=Gi(m.startTime),b=Gi(m.duration);if(!(e.op==="navigation"&&i+l<e.startTimestamp))switch(m.entryType){case"navigation":{y$(e,m,i),c=i+Gi(m.responseStart),d=i+Gi(m.requestStart);break}case"mark":case"paint":case"measure":{_$(e,m,l,b,i);const w=y0(),C=m.startTime<w.firstHiddenTime;m.name==="first-paint"&&C&&((typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&at.log("[Measurements] Adding FP"),Ti.fp={value:m.startTime,unit:"millisecond"}),m.name==="first-contentful-paint"&&C&&((typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&at.log("[Measurements] Adding FCP"),Ti.fcp={value:m.startTime,unit:"millisecond"});break}case"resource":{const w=m.name.replace(Xn.location.origin,"");x$(e,m,w,l,b,i);break}}}),$w=Math.max(a.length-1,0),b$(e),e.op==="pageload"){typeof c=="number"&&((typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&at.log("[Measurements] Adding TTFB"),Ti.ttfb={value:(c-e.startTimestamp)*1e3,unit:"millisecond"},typeof d=="number"&&d<=c&&(Ti["ttfb.requestTime"]={value:(c-d)*1e3,unit:"millisecond"})),["fcp","fp","lcp"].forEach(l=>{if(!Ti[l]||i>=e.startTimestamp)return;const b=Ti[l].value,w=i+Gi(b),C=Math.abs((w-e.startTimestamp)*1e3),k=C-b;(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&at.log(`[Measurements] Normalized ${l} from ${b} to ${C} (${k})`),Ti[l].value=C});const m=Ti["mark.fid"];m&&Ti.fid&&(uu(e,{description:"first input delay",endTimestamp:m.value+Gi(Ti.fid.value),op:"ui.action",startTimestamp:m.value}),delete Ti["mark.fid"]),"fcp"in Ti||delete Ti.cls,Object.keys(Ti).forEach(l=>{e.setMeasurement(l,Ti[l].value,Ti[l].unit)}),w$(e)}ua=void 0,Hh=void 0,Ti={}}function _$(e,t,i,a,c){const d=c+i,m=d+a;return uu(e,{description:t.name,endTimestamp:m,op:t.entryType,startTimestamp:d}),d}function y$(e,t,i){["unloadEvent","redirect","domContentLoadedEvent","loadEvent","connect"].forEach(a=>{lp(e,t,a,i)}),lp(e,t,"secureConnection",i,"TLS/SSL","connectEnd"),lp(e,t,"fetch",i,"cache","domainLookupStart"),lp(e,t,"domainLookup",i,"DNS"),v$(e,t,i)}function lp(e,t,i,a,c,d){const m=d?t[d]:t[`${i}End`],l=t[`${i}Start`];!l||!m||uu(e,{op:"browser",description:c||i,startTimestamp:a+Gi(l),endTimestamp:a+Gi(m)})}function v$(e,t,i){uu(e,{op:"browser",description:"request",startTimestamp:i+Gi(t.requestStart),endTimestamp:i+Gi(t.responseEnd)}),uu(e,{op:"browser",description:"response",startTimestamp:i+Gi(t.responseStart),endTimestamp:i+Gi(t.responseEnd)})}function x$(e,t,i,a,c,d){if(t.initiatorType==="xmlhttprequest"||t.initiatorType==="fetch")return;const m={};"transferSize"in t&&(m["http.response_transfer_size"]=t.transferSize),"encodedBodySize"in t&&(m["http.response_content_length"]=t.encodedBodySize),"decodedBodySize"in t&&(m["http.decoded_response_content_length"]=t.decodedBodySize),"renderBlockingStatus"in t&&(m["resource.render_blocking_status"]=t.renderBlockingStatus);const l=d+a,b=l+c;uu(e,{description:i,endTimestamp:b,op:t.initiatorType?`resource.${t.initiatorType}`:"resource.other",startTimestamp:l,data:m})}function b$(e){const t=Xn.navigator;if(!t)return;const i=t.connection;i&&(i.effectiveType&&e.setTag("effectiveConnectionType",i.effectiveType),i.type&&e.setTag("connectionType",i.type),w_(i.rtt)&&(Ti["connection.rtt"]={value:i.rtt,unit:"millisecond"})),w_(t.deviceMemory)&&e.setTag("deviceMemory",`${t.deviceMemory} GB`),w_(t.hardwareConcurrency)&&e.setTag("hardwareConcurrency",String(t.hardwareConcurrency))}function w$(e){ua&&((typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&at.log("[Measurements] Adding LCP Data"),ua.element&&e.setTag("lcp.element",qo(ua.element)),ua.id&&e.setTag("lcp.id",ua.id),ua.url&&e.setTag("lcp.url",ua.url.trim().slice(0,200)),e.setTag("lcp.size",ua.size)),Hh&&Hh.sources&&((typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&at.log("[Measurements] Adding CLS Data"),Hh.sources.forEach((t,i)=>e.setTag(`cls.source.${i+1}`,qo(t.node))))}const Ny=["localhost",/^\/(?!\/)/],Uy={traceFetch:!0,traceXHR:!0,enableHTTPTimings:!0,tracingOrigins:Ny,tracePropagationTargets:Ny};function S$(e){const{traceFetch:t,traceXHR:i,tracePropagationTargets:a,tracingOrigins:c,shouldCreateSpanForRequest:d,enableHTTPTimings:m}={traceFetch:Uy.traceFetch,traceXHR:Uy.traceXHR,...e},l=typeof d=="function"?d:C=>!0,b=C=>C$(C,a||c),w={};t&&ur("fetch",C=>{const k=I$(C,l,b,w);m&&k&&Vw(k)}),i&&ur("xhr",C=>{const k=A$(C,l,b,w);m&&k&&Vw(k)})}function Vw(e){const t=e.data.url,i=new PerformanceObserver(a=>{a.getEntries().forEach(d=>{(d.initiatorType==="fetch"||d.initiatorType==="xmlhttprequest")&&d.name.endsWith(t)&&(T$(d).forEach(l=>e.setData(...l)),i.disconnect())})});i.observe({entryTypes:["resource"]})}function E$(e){let t="unknown",i="unknown",a="";for(const c of e){if(c==="/"){[t,i]=e.split("/");break}if(!isNaN(Number(c))){t=a==="h"?"http":a,i=e.split(a)[1];break}a+=c}return a===e&&(t=a),{name:t,version:i}}function ca(e){return((Hs||performance.timeOrigin)+e)/1e3}function T$(e){const{name:t,version:i}=E$(e.nextHopProtocol),a=[];return a.push(["network.protocol.version",i],["network.protocol.name",t]),Hs?[...a,["http.request.redirect_start",ca(e.redirectStart)],["http.request.fetch_start",ca(e.fetchStart)],["http.request.domain_lookup_start",ca(e.domainLookupStart)],["http.request.domain_lookup_end",ca(e.domainLookupEnd)],["http.request.connect_start",ca(e.connectStart)],["http.request.secure_connection_start",ca(e.secureConnectionStart)],["http.request.connection_end",ca(e.connectEnd)],["http.request.request_start",ca(e.requestStart)],["http.request.response_start",ca(e.responseStart)],["http.request.response_end",ca(e.responseEnd)]]:a}function C$(e,t){return Tu(e,t||Ny)}function I$(e,t,i,a){if(!km()||!e.fetchData)return;const c=t(e.fetchData.url);if(e.endTimestamp&&c){const M=e.fetchData.__span;if(!M)return;const O=a[M];if(O){if(e.response){O.setHttpStatus(e.response.status);const j=e.response&&e.response.headers&&e.response.headers.get("content-length"),W=parseInt(j);W>0&&O.setData("http.response_content_length",W)}else e.error&&O.setStatus("internal_error");O.finish(),delete a[M]}return}const d=vn(),m=d.getScope(),l=d.getClient(),b=m.getSpan(),{method:w,url:C}=e.fetchData,k=c&&b?b.startChild({data:{url:C,type:"fetch","http.method":w},description:`${w} ${C}`,op:"http.client"}):void 0;if(k&&(e.fetchData.__span=k.spanId,a[k.spanId]=k),i(e.fetchData.url)&&l){const M=e.args[0];e.args[1]=e.args[1]||{};const O=e.args[1];O.headers=k$(M,l,m,O,k)}return k}function k$(e,t,i,a,c){const d=c||i.getSpan(),m=d&&d.transaction,{traceId:l,sampled:b,dsc:w}=i.getPropagationContext(),C=d?d.toTraceparent():Jv(l,void 0,b),k=m?m.getDynamicSamplingContext():w||Am(l,t,i),M=by(k),O=typeof Request<"u"&&Ja(e,Request)?e.headers:a.headers;if(O)if(typeof Headers<"u"&&Ja(O,Headers)){const j=new Headers(O);return j.append("sentry-trace",C),M&&j.append(xy,M),j}else if(Array.isArray(O)){const j=[...O,["sentry-trace",C]];return M&&j.push([xy,M]),j}else{const j="baggage"in O?O.baggage:void 0,W=[];return Array.isArray(j)?W.push(...j):j&&W.push(j),M&&W.push(M),{...O,"sentry-trace":C,baggage:W.length>0?W.join(","):void 0}}else return{"sentry-trace":C,baggage:M}}function A$(e,t,i,a){const c=e.xhr,d=c&&c[Oo];if(!km()||c&&c.__sentry_own_request__||!c||!d)return;const m=t(d.url);if(e.endTimestamp&&m){const k=c.__sentry_xhr_span_id__;if(!k)return;const M=a[k];M&&(M.setHttpStatus(d.status_code),M.finish(),delete a[k]);return}const l=vn(),b=l.getScope(),w=b.getSpan(),C=m&&w?w.startChild({data:{...d.data,type:"xhr","http.method":d.method,url:d.url},description:`${d.method} ${d.url}`,op:"http.client"}):void 0;if(C&&(c.__sentry_xhr_span_id__=C.spanId,a[c.__sentry_xhr_span_id__]=C),c.setRequestHeader&&i(d.url))if(C){const k=C&&C.transaction,M=k&&k.getDynamicSamplingContext(),O=by(M);jw(c,C.toTraceparent(),O)}else{const k=l.getClient(),{traceId:M,sampled:O,dsc:j}=b.getPropagationContext(),W=Jv(M,void 0,O),le=j||(k?Am(M,k,b):void 0),he=by(le);jw(c,W,he)}return C}function jw(e,t,i){try{e.setRequestHeader("sentry-trace",t),i&&e.setRequestHeader(xy,i)}catch{}}function P$(e,t=!0,i=!0){if(!Xn||!Xn.location){(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&at.warn("Could not initialize routing instrumentation due to invalid location");return}let a=Xn.location.href,c;t&&(c=e({name:Xn.location.pathname,startTimestamp:Hs?Hs/1e3:void 0,op:"pageload",metadata:{source:"url"}})),i&&ur("history",({to:d,from:m})=>{if(m===void 0&&a&&a.indexOf(d)!==-1){a=void 0;return}m!==d&&(a=void 0,c&&((typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&at.log(`[Tracing] Finishing current transaction with op: ${c.op}`),c.finish()),c=e({name:Xn.location.pathname,op:"navigation",metadata:{source:"url"}}))})}const R$="BrowserTracing",M$={..._p,markBackgroundTransactions:!0,routingInstrumentation:P$,startTransactionOnLocationChange:!0,startTransactionOnPageLoad:!0,enableLongTask:!0,_experiments:{},...Uy};class D${constructor(t){this.name=R$,this._hasSetTracePropagationTargets=!1,sN(),(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&(this._hasSetTracePropagationTargets=!!(t&&(t.tracePropagationTargets||t.tracingOrigins))),this.options={...M$,...t},this.options._experiments.enableLongTask!==void 0&&(this.options.enableLongTask=this.options._experiments.enableLongTask),t&&!t.tracePropagationTargets&&t.tracingOrigins&&(this.options.tracePropagationTargets=t.tracingOrigins),this._collectWebVitals=u$(),this.options.enableLongTask&&h$(),this.options._experiments.enableInteractions&&d$()}setupOnce(t,i){this._getCurrentHub=i;const c=i().getClient(),d=c&&c.getOptions(),{routingInstrumentation:m,startTransactionOnLocationChange:l,startTransactionOnPageLoad:b,markBackgroundTransactions:w,traceFetch:C,traceXHR:k,shouldCreateSpanForRequest:M,enableHTTPTimings:O,_experiments:j}=this.options,W=d&&d.tracePropagationTargets,le=W||this.options.tracePropagationTargets;(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&this._hasSetTracePropagationTargets&&W&&at.warn("[Tracing] The `tracePropagationTargets` option was set in the BrowserTracing integration and top level `Sentry.init`. The top level `Sentry.init` value is being used."),m(he=>{const be=this._createRouteTransaction(he);return this.options._experiments.onStartRouteTransaction&&this.options._experiments.onStartRouteTransaction(be,he,i),be},b,l),w&&n$(),j.enableInteractions&&this._registerInteractionListener(),S$({traceFetch:C,traceXHR:k,tracePropagationTargets:le,shouldCreateSpanForRequest:M,enableHTTPTimings:O})}_createRouteTransaction(t){if(!this._getCurrentHub){(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&at.warn(`[Tracing] Did not create ${t.op} transaction because _getCurrentHub is invalid.`);return}const i=this._getCurrentHub(),{beforeNavigate:a,idleTimeout:c,finalTimeout:d,heartbeatInterval:m}=this.options,l=t.op==="pageload",b=l?Gw("sentry-trace"):"",w=l?Gw("baggage"):"",{traceparentData:C,dynamicSamplingContext:k,propagationContext:M}=M5(b,w),O={...t,...C,metadata:{...t.metadata,dynamicSamplingContext:C&&!k?{}:k},trimEnd:!0},j=typeof a=="function"?a(O):O,W=j===void 0?{...O,sampled:!1}:j;W.metadata=W.name!==O.name?{...W.metadata,source:"custom"}:W.metadata,this._latestRouteName=W.name,this._latestRouteSource=W.metadata&&W.metadata.source,W.sampled===!1&&(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&at.log(`[Tracing] Will not send ${W.op} transaction because of beforeNavigate.`),(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&at.log(`[Tracing] Starting ${W.op} transaction on scope`);const{location:le}=Xn,he=cw(i,W,c,d,!0,{location:le},m),be=i.getScope();return l&&C?be.setPropagationContext(M):be.setPropagationContext({traceId:he.traceId,spanId:he.spanId,parentSpanId:he.parentSpanId,sampled:!!he.sampled}),he.registerBeforeFinishCallback(ge=>{this._collectWebVitals(),g$(ge)}),he}_registerInteractionListener(){let t;const i=()=>{const{idleTimeout:a,finalTimeout:c,heartbeatInterval:d}=this.options,m="ui.action.click",l=Pd();if(l&&l.op&&["navigation","pageload"].includes(l.op)){(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&at.warn(`[Tracing] Did not create ${m} transaction because a pageload or navigation transaction is in progress.`);return}if(t&&(t.setFinishReason("interactionInterrupted"),t.finish(),t=void 0),!this._getCurrentHub){(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&at.warn(`[Tracing] Did not create ${m} transaction because _getCurrentHub is invalid.`);return}if(!this._latestRouteName){(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&at.warn(`[Tracing] Did not create ${m} transaction because _latestRouteName is missing.`);return}const b=this._getCurrentHub(),{location:w}=Xn,C={name:this._latestRouteName,op:m,trimEnd:!0,metadata:{source:this._latestRouteSource||"url"}};t=cw(b,C,a,c,!0,{location:w},d)};["click"].forEach(a=>{addEventListener(a,i,{once:!1,capture:!0})})}}function Gw(e){const t=VF(`meta[name=${e}]`);return t?t.getAttribute("content"):void 0}const pC=["activate","mount","update"],L$=/(?:^|[-_])(\w)/g,z$=e=>e.replace(L$,t=>t.toUpperCase()).replace(/[-_]/g,""),O$="<Root>",S_="<Anonymous>",B$=(e,t)=>e.repeat?e.repeat(t):e,Zh=(e,t)=>{if(!e)return S_;if(e.$root===e)return O$;if(!e.$options)return S_;const i=e.$options;let a=i.name||i._componentTag;const c=i.__file;if(!a&&c){const d=c.match(/([^/\\]+)\.vue$/);d&&(a=d[1])}return(a?`<${z$(a)}>`:S_)+(c&&t!==!1?` at ${c}`:"")},F$=e=>{if(e&&(e._isVue||e.__isVue)&&e.$parent){const t=[];let i=0;for(;e;){if(t.length>0){const c=t[t.length-1];if(c.constructor===e.constructor){i++,e=e.$parent;continue}else i>0&&(t[t.length-1]=[c,i],i=0)}t.push(e),e=e.$parent}return`

found in

${t.map((c,d)=>`${(d===0?"---> ":B$(" ",5+d*2))+(Array.isArray(c)?`${Zh(c[0])}... (${c[1]} recursive calls)`:Zh(c))}`).join(`
`)}`}return`

(found in ${Zh(e)})`},N$=(e,t)=>{const{errorHandler:i,warnHandler:a,silent:c}=e.config;e.config.errorHandler=(d,m,l)=>{const b=Zh(m,!1),w=m?F$(m):"",C={componentName:b,lifecycleHook:l,trace:w};if(t.attachProps&&m&&(m.$options&&m.$options.propsData?C.propsData=m.$options.propsData:m.$props&&(C.propsData=m.$props)),setTimeout(()=>{vn().withScope(k=>{k.setContext("vue",C),vn().captureException(d)})}),typeof i=="function"&&i.call(e,d,m,l),t.logErrors){const k=typeof console<"u",M=`Error in ${l}: "${d&&d.toString()}"`;a?a.call(null,M,m,w):k&&!c&&console.error(`[Vue warn]: ${M}${w}`)}}},qw="ui.vue",U$={activate:["activated","deactivated"],create:["beforeCreate","created"],destroy:["beforeDestroy","destroyed"],mount:["beforeMount","mounted"],update:["beforeUpdate","updated"]};function $y(){return vn().getScope().getTransaction()}function $$(e,t,i){e.$_sentryRootSpanTimer&&clearTimeout(e.$_sentryRootSpanTimer),e.$_sentryRootSpanTimer=setTimeout(()=>{e.$root&&e.$root.$_sentryRootSpan&&(e.$root.$_sentryRootSpan.finish(t),e.$root.$_sentryRootSpan=void 0)},i)}const V$=e=>{const t=(e.hooks||[]).concat(pC).filter((a,c,d)=>d.indexOf(a)===c),i={};for(const a of t){const c=U$[a];if(!c){(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&at.warn(`Unknown hook: ${a}`);continue}for(const d of c)i[d]=function(){const m=this.$root===this;if(m){const w=$y();w&&(this.$_sentryRootSpan=this.$_sentryRootSpan||w.startChild({description:"Application Render",op:`${qw}.render`}))}const l=Zh(this,!1),b=Array.isArray(e.trackComponents)?e.trackComponents.indexOf(l)>-1:e.trackComponents;if(!(!m&&!b))if(this.$_sentrySpans=this.$_sentrySpans||{},d==c[0]){const w=this.$root&&this.$root.$_sentryRootSpan||$y();if(w){const C=this.$_sentrySpans[a];C&&!C.endTimestamp&&C.finish(),this.$_sentrySpans[a]=w.startChild({description:`Vue <${l}>`,op:`${qw}.${a}`})}}else{const w=this.$_sentrySpans[a];if(!w)return;w.finish(),$$(this,Zo(),e.timeout)}}}return i},j$=Br,G$={Vue:j$.Vue,attachProps:!0,logErrors:!0,hooks:pC,timeout:2e3,trackComponents:!1,_metadata:{sdk:{name:"sentry.javascript.vue",packages:[{name:"npm:@sentry/vue",version:qp}],version:qp}}};function q$(e={}){const t={...G$,...e};if($3(t),!t.Vue&&!t.app){console.warn("[@sentry/vue]: Misconfigured SDK. Vue specific errors will not be captured.\nUpdate your `Sentry.init` call with an appropriate config option:\n`app` (Application Instance - Vue 3) or `Vue` (Vue Constructor - Vue 2).");return}t.app?Kv(t.app).forEach(a=>Hw(a,t)):t.Vue&&Hw(t.Vue,t)}const Hw=(e,t)=>{const i=e;(i._instance&&i._instance.isMounted)===!0&&console.warn("[@sentry/vue]: Misconfigured SDK. Vue app is already mounted. Make sure to call `app.mount()` after `Sentry.init()`."),N$(e,t),km(t)&&e.mixin(V$({...t,...t.tracingOptions}))};function H$(e,t={}){return(i,a=!0,c=!0)=>{const d={"routing.instrumentation":"vue-router"};a&&zn&&zn.location&&i({name:zn.location.pathname,op:"pageload",tags:d,metadata:{source:"url"}}),e.onError(m=>Pm(m)),e.beforeEach((m,l,b)=>{const w=l.name==null&&l.matched.length===0,C={params:m.params,query:m.query};let k=m.path,M="url";if(m.name&&t.routeLabel!=="path"?(k=m.name.toString(),M="custom"):m.matched[0]&&m.matched[0].path&&(k=m.matched[0].path,M="route"),a&&w){const O=$y();O&&(O.metadata.source!=="custom"&&O.setName(k,M),O.setData("params",C.params),O.setData("query",C.query))}c&&!w&&i({name:k,op:"navigation",tags:d,data:C,metadata:{source:M}}),b&&b()})}}const Dd=VP(kB);Dd.use(wM);Dd.use(qP());q$({app:Dd,dsn:"https://d7f1d553a334ff1f006a7e1e323919fe@o4505765929287680.ingest.sentry.io/4505765932826624",integrations:[new D$({tracePropagationTargets:["localhost"],routingInstrumentation:H$(qT)}),new Nm],tracesSampleRate:1,replaysSessionSampleRate:.1,replaysOnErrorSampleRate:1});Dd.use(qT);Dd.mount("#app")});export default Z$();
